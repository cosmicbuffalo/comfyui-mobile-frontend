function C1(n,o){for(var s=0;s<o.length;s++){const l=o[s];if(typeof l!="string"&&!Array.isArray(l)){for(const i in l)if(i!=="default"&&!(i in n)){const c=Object.getOwnPropertyDescriptor(l,i);c&&Object.defineProperty(n,i,c.get?c:{enumerable:!0,get:()=>l[i]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))l(i);new MutationObserver(i=>{for(const c of i)if(c.type==="childList")for(const f of c.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&l(f)}).observe(document,{childList:!0,subtree:!0});function s(i){const c={};return i.integrity&&(c.integrity=i.integrity),i.referrerPolicy&&(c.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?c.credentials="include":i.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function l(i){if(i.ep)return;i.ep=!0;const c=s(i);fetch(i.href,c)}})();function k1(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var qd={exports:{}},na={};var u0;function j1(){if(u0)return na;u0=1;var n=Symbol.for("react.transitional.element"),o=Symbol.for("react.fragment");function s(l,i,c){var f=null;if(c!==void 0&&(f=""+c),i.key!==void 0&&(f=""+i.key),"key"in i){c={};for(var m in i)m!=="key"&&(c[m]=i[m])}else c=i;return i=c.ref,{$$typeof:n,type:l,key:f,ref:i!==void 0?i:null,props:c}}return na.Fragment=o,na.jsx=s,na.jsxs=s,na}var c0;function M1(){return c0||(c0=1,qd.exports=j1()),qd.exports}var u=M1(),Wd={exports:{}},Ct={};var d0;function O1(){if(d0)return Ct;d0=1;var n=Symbol.for("react.transitional.element"),o=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),l=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),c=Symbol.for("react.consumer"),f=Symbol.for("react.context"),m=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),g=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),x=Symbol.for("react.activity"),w=Symbol.iterator;function k(E){return E===null||typeof E!="object"?null:(E=w&&E[w]||E["@@iterator"],typeof E=="function"?E:null)}var N={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,j={};function C(E,A,O){this.props=E,this.context=A,this.refs=j,this.updater=O||N}C.prototype.isReactComponent={},C.prototype.setState=function(E,A){if(typeof E!="object"&&typeof E!="function"&&E!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,E,A,"setState")},C.prototype.forceUpdate=function(E){this.updater.enqueueForceUpdate(this,E,"forceUpdate")};function T(){}T.prototype=C.prototype;function V(E,A,O){this.props=E,this.context=A,this.refs=j,this.updater=O||N}var U=V.prototype=new T;U.constructor=V,S(U,C.prototype),U.isPureReactComponent=!0;var R=Array.isArray;function z(){}var L={H:null,A:null,T:null,S:null},$=Object.prototype.hasOwnProperty;function Y(E,A,O){var te=O.ref;return{$$typeof:n,type:E,key:A,ref:te!==void 0?te:null,props:O}}function ue(E,A){return Y(E.type,A,E.props)}function pe(E){return typeof E=="object"&&E!==null&&E.$$typeof===n}function fe(E){var A={"=":"=0",":":"=2"};return"$"+E.replace(/[=:]/g,function(O){return A[O]})}var Re=/\/+/g;function Ie(E,A){return typeof E=="object"&&E!==null&&E.key!=null?fe(""+E.key):A.toString(36)}function Ae(E){switch(E.status){case"fulfilled":return E.value;case"rejected":throw E.reason;default:switch(typeof E.status=="string"?E.then(z,z):(E.status="pending",E.then(function(A){E.status==="pending"&&(E.status="fulfilled",E.value=A)},function(A){E.status==="pending"&&(E.status="rejected",E.reason=A)})),E.status){case"fulfilled":return E.value;case"rejected":throw E.reason}}throw E}function _(E,A,O,te,Le){var We=typeof E;(We==="undefined"||We==="boolean")&&(E=null);var xe=!1;if(E===null)xe=!0;else switch(We){case"bigint":case"string":case"number":xe=!0;break;case"object":switch(E.$$typeof){case n:case o:xe=!0;break;case y:return xe=E._init,_(xe(E._payload),A,O,te,Le)}}if(xe)return Le=Le(E),xe=te===""?"."+Ie(E,0):te,R(Le)?(O="",xe!=null&&(O=xe.replace(Re,"$&/")+"/"),_(Le,A,O,"",function(P){return P})):Le!=null&&(pe(Le)&&(Le=ue(Le,O+(Le.key==null||E&&E.key===Le.key?"":(""+Le.key).replace(Re,"$&/")+"/")+xe)),A.push(Le)),1;xe=0;var Se=te===""?".":te+":";if(R(E))for(var H=0;H<E.length;H++)te=E[H],We=Se+Ie(te,H),xe+=_(te,A,O,We,Le);else if(H=k(E),typeof H=="function")for(E=H.call(E),H=0;!(te=E.next()).done;)te=te.value,We=Se+Ie(te,H++),xe+=_(te,A,O,We,Le);else if(We==="object"){if(typeof E.then=="function")return _(Ae(E),A,O,te,Le);throw A=String(E),Error("Objects are not valid as a React child (found: "+(A==="[object Object]"?"object with keys {"+Object.keys(E).join(", ")+"}":A)+"). If you meant to render a collection of children, use an array instead.")}return xe}function se(E,A,O){if(E==null)return E;var te=[],Le=0;return _(E,te,"","",function(We){return A.call(O,We,Le++)}),te}function ce(E){if(E._status===-1){var A=E._result;A=A(),A.then(function(O){(E._status===0||E._status===-1)&&(E._status=1,E._result=O)},function(O){(E._status===0||E._status===-1)&&(E._status=2,E._result=O)}),E._status===-1&&(E._status=0,E._result=A)}if(E._status===1)return E._result.default;throw E._result}var Ue=typeof reportError=="function"?reportError:function(E){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var A=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof E=="object"&&E!==null&&typeof E.message=="string"?String(E.message):String(E),error:E});if(!window.dispatchEvent(A))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",E);return}console.error(E)},De={map:se,forEach:function(E,A,O){se(E,function(){A.apply(this,arguments)},O)},count:function(E){var A=0;return se(E,function(){A++}),A},toArray:function(E){return se(E,function(A){return A})||[]},only:function(E){if(!pe(E))throw Error("React.Children.only expected to receive a single React element child.");return E}};return Ct.Activity=x,Ct.Children=De,Ct.Component=C,Ct.Fragment=s,Ct.Profiler=i,Ct.PureComponent=V,Ct.StrictMode=l,Ct.Suspense=p,Ct.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=L,Ct.__COMPILER_RUNTIME={__proto__:null,c:function(E){return L.H.useMemoCache(E)}},Ct.cache=function(E){return function(){return E.apply(null,arguments)}},Ct.cacheSignal=function(){return null},Ct.cloneElement=function(E,A,O){if(E==null)throw Error("The argument must be a React element, but you passed "+E+".");var te=S({},E.props),Le=E.key;if(A!=null)for(We in A.key!==void 0&&(Le=""+A.key),A)!$.call(A,We)||We==="key"||We==="__self"||We==="__source"||We==="ref"&&A.ref===void 0||(te[We]=A[We]);var We=arguments.length-2;if(We===1)te.children=O;else if(1<We){for(var xe=Array(We),Se=0;Se<We;Se++)xe[Se]=arguments[Se+2];te.children=xe}return Y(E.type,Le,te)},Ct.createContext=function(E){return E={$$typeof:f,_currentValue:E,_currentValue2:E,_threadCount:0,Provider:null,Consumer:null},E.Provider=E,E.Consumer={$$typeof:c,_context:E},E},Ct.createElement=function(E,A,O){var te,Le={},We=null;if(A!=null)for(te in A.key!==void 0&&(We=""+A.key),A)$.call(A,te)&&te!=="key"&&te!=="__self"&&te!=="__source"&&(Le[te]=A[te]);var xe=arguments.length-2;if(xe===1)Le.children=O;else if(1<xe){for(var Se=Array(xe),H=0;H<xe;H++)Se[H]=arguments[H+2];Le.children=Se}if(E&&E.defaultProps)for(te in xe=E.defaultProps,xe)Le[te]===void 0&&(Le[te]=xe[te]);return Y(E,We,Le)},Ct.createRef=function(){return{current:null}},Ct.forwardRef=function(E){return{$$typeof:m,render:E}},Ct.isValidElement=pe,Ct.lazy=function(E){return{$$typeof:y,_payload:{_status:-1,_result:E},_init:ce}},Ct.memo=function(E,A){return{$$typeof:g,type:E,compare:A===void 0?null:A}},Ct.startTransition=function(E){var A=L.T,O={};L.T=O;try{var te=E(),Le=L.S;Le!==null&&Le(O,te),typeof te=="object"&&te!==null&&typeof te.then=="function"&&te.then(z,Ue)}catch(We){Ue(We)}finally{A!==null&&O.types!==null&&(A.types=O.types),L.T=A}},Ct.unstable_useCacheRefresh=function(){return L.H.useCacheRefresh()},Ct.use=function(E){return L.H.use(E)},Ct.useActionState=function(E,A,O){return L.H.useActionState(E,A,O)},Ct.useCallback=function(E,A){return L.H.useCallback(E,A)},Ct.useContext=function(E){return L.H.useContext(E)},Ct.useDebugValue=function(){},Ct.useDeferredValue=function(E,A){return L.H.useDeferredValue(E,A)},Ct.useEffect=function(E,A){return L.H.useEffect(E,A)},Ct.useEffectEvent=function(E){return L.H.useEffectEvent(E)},Ct.useId=function(){return L.H.useId()},Ct.useImperativeHandle=function(E,A,O){return L.H.useImperativeHandle(E,A,O)},Ct.useInsertionEffect=function(E,A){return L.H.useInsertionEffect(E,A)},Ct.useLayoutEffect=function(E,A){return L.H.useLayoutEffect(E,A)},Ct.useMemo=function(E,A){return L.H.useMemo(E,A)},Ct.useOptimistic=function(E,A){return L.H.useOptimistic(E,A)},Ct.useReducer=function(E,A,O){return L.H.useReducer(E,A,O)},Ct.useRef=function(E){return L.H.useRef(E)},Ct.useState=function(E){return L.H.useState(E)},Ct.useSyncExternalStore=function(E,A,O){return L.H.useSyncExternalStore(E,A,O)},Ct.useTransition=function(){return L.H.useTransition()},Ct.version="19.2.3",Ct}var f0;function Zf(){return f0||(f0=1,Wd.exports=O1()),Wd.exports}var b=Zf();const tl=k1(b),p0=C1({__proto__:null,default:tl},[b]);var Gd={exports:{}},oa={},Pd={exports:{}},Yd={};var h0;function T1(){return h0||(h0=1,(function(n){function o(_,se){var ce=_.length;_.push(se);e:for(;0<ce;){var Ue=ce-1>>>1,De=_[Ue];if(0<i(De,se))_[Ue]=se,_[ce]=De,ce=Ue;else break e}}function s(_){return _.length===0?null:_[0]}function l(_){if(_.length===0)return null;var se=_[0],ce=_.pop();if(ce!==se){_[0]=ce;e:for(var Ue=0,De=_.length,E=De>>>1;Ue<E;){var A=2*(Ue+1)-1,O=_[A],te=A+1,Le=_[te];if(0>i(O,ce))te<De&&0>i(Le,O)?(_[Ue]=Le,_[te]=ce,Ue=te):(_[Ue]=O,_[A]=ce,Ue=A);else if(te<De&&0>i(Le,ce))_[Ue]=Le,_[te]=ce,Ue=te;else break e}}return se}function i(_,se){var ce=_.sortIndex-se.sortIndex;return ce!==0?ce:_.id-se.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var c=performance;n.unstable_now=function(){return c.now()}}else{var f=Date,m=f.now();n.unstable_now=function(){return f.now()-m}}var p=[],g=[],y=1,x=null,w=3,k=!1,N=!1,S=!1,j=!1,C=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,V=typeof setImmediate<"u"?setImmediate:null;function U(_){for(var se=s(g);se!==null;){if(se.callback===null)l(g);else if(se.startTime<=_)l(g),se.sortIndex=se.expirationTime,o(p,se);else break;se=s(g)}}function R(_){if(S=!1,U(_),!N)if(s(p)!==null)N=!0,z||(z=!0,fe());else{var se=s(g);se!==null&&Ae(R,se.startTime-_)}}var z=!1,L=-1,$=5,Y=-1;function ue(){return j?!0:!(n.unstable_now()-Y<$)}function pe(){if(j=!1,z){var _=n.unstable_now();Y=_;var se=!0;try{e:{N=!1,S&&(S=!1,T(L),L=-1),k=!0;var ce=w;try{t:{for(U(_),x=s(p);x!==null&&!(x.expirationTime>_&&ue());){var Ue=x.callback;if(typeof Ue=="function"){x.callback=null,w=x.priorityLevel;var De=Ue(x.expirationTime<=_);if(_=n.unstable_now(),typeof De=="function"){x.callback=De,U(_),se=!0;break t}x===s(p)&&l(p),U(_)}else l(p);x=s(p)}if(x!==null)se=!0;else{var E=s(g);E!==null&&Ae(R,E.startTime-_),se=!1}}break e}finally{x=null,w=ce,k=!1}se=void 0}}finally{se?fe():z=!1}}}var fe;if(typeof V=="function")fe=function(){V(pe)};else if(typeof MessageChannel<"u"){var Re=new MessageChannel,Ie=Re.port2;Re.port1.onmessage=pe,fe=function(){Ie.postMessage(null)}}else fe=function(){C(pe,0)};function Ae(_,se){L=C(function(){_(n.unstable_now())},se)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(_){_.callback=null},n.unstable_forceFrameRate=function(_){0>_||125<_?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):$=0<_?Math.floor(1e3/_):5},n.unstable_getCurrentPriorityLevel=function(){return w},n.unstable_next=function(_){switch(w){case 1:case 2:case 3:var se=3;break;default:se=w}var ce=w;w=se;try{return _()}finally{w=ce}},n.unstable_requestPaint=function(){j=!0},n.unstable_runWithPriority=function(_,se){switch(_){case 1:case 2:case 3:case 4:case 5:break;default:_=3}var ce=w;w=_;try{return se()}finally{w=ce}},n.unstable_scheduleCallback=function(_,se,ce){var Ue=n.unstable_now();switch(typeof ce=="object"&&ce!==null?(ce=ce.delay,ce=typeof ce=="number"&&0<ce?Ue+ce:Ue):ce=Ue,_){case 1:var De=-1;break;case 2:De=250;break;case 5:De=1073741823;break;case 4:De=1e4;break;default:De=5e3}return De=ce+De,_={id:y++,callback:se,priorityLevel:_,startTime:ce,expirationTime:De,sortIndex:-1},ce>Ue?(_.sortIndex=ce,o(g,_),s(p)===null&&_===s(g)&&(S?(T(L),L=-1):S=!0,Ae(R,ce-Ue))):(_.sortIndex=De,o(p,_),N||k||(N=!0,z||(z=!0,fe()))),_},n.unstable_shouldYield=ue,n.unstable_wrapCallback=function(_){var se=w;return function(){var ce=w;w=se;try{return _.apply(this,arguments)}finally{w=ce}}}})(Yd)),Yd}var m0;function E1(){return m0||(m0=1,Pd.exports=T1()),Pd.exports}var Qd={exports:{}},zn={};var g0;function I1(){if(g0)return zn;g0=1;var n=Zf();function o(p){var g="https://react.dev/errors/"+p;if(1<arguments.length){g+="?args[]="+encodeURIComponent(arguments[1]);for(var y=2;y<arguments.length;y++)g+="&args[]="+encodeURIComponent(arguments[y])}return"Minified React error #"+p+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(){}var l={d:{f:s,r:function(){throw Error(o(522))},D:s,C:s,L:s,m:s,X:s,S:s,M:s},p:0,findDOMNode:null},i=Symbol.for("react.portal");function c(p,g,y){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:x==null?null:""+x,children:p,containerInfo:g,implementation:y}}var f=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function m(p,g){if(p==="font")return"";if(typeof g=="string")return g==="use-credentials"?g:""}return zn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=l,zn.createPortal=function(p,g){var y=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!g||g.nodeType!==1&&g.nodeType!==9&&g.nodeType!==11)throw Error(o(299));return c(p,g,null,y)},zn.flushSync=function(p){var g=f.T,y=l.p;try{if(f.T=null,l.p=2,p)return p()}finally{f.T=g,l.p=y,l.d.f()}},zn.preconnect=function(p,g){typeof p=="string"&&(g?(g=g.crossOrigin,g=typeof g=="string"?g==="use-credentials"?g:"":void 0):g=null,l.d.C(p,g))},zn.prefetchDNS=function(p){typeof p=="string"&&l.d.D(p)},zn.preinit=function(p,g){if(typeof p=="string"&&g&&typeof g.as=="string"){var y=g.as,x=m(y,g.crossOrigin),w=typeof g.integrity=="string"?g.integrity:void 0,k=typeof g.fetchPriority=="string"?g.fetchPriority:void 0;y==="style"?l.d.S(p,typeof g.precedence=="string"?g.precedence:void 0,{crossOrigin:x,integrity:w,fetchPriority:k}):y==="script"&&l.d.X(p,{crossOrigin:x,integrity:w,fetchPriority:k,nonce:typeof g.nonce=="string"?g.nonce:void 0})}},zn.preinitModule=function(p,g){if(typeof p=="string")if(typeof g=="object"&&g!==null){if(g.as==null||g.as==="script"){var y=m(g.as,g.crossOrigin);l.d.M(p,{crossOrigin:y,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0})}}else g==null&&l.d.M(p)},zn.preload=function(p,g){if(typeof p=="string"&&typeof g=="object"&&g!==null&&typeof g.as=="string"){var y=g.as,x=m(y,g.crossOrigin);l.d.L(p,y,{crossOrigin:x,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0,type:typeof g.type=="string"?g.type:void 0,fetchPriority:typeof g.fetchPriority=="string"?g.fetchPriority:void 0,referrerPolicy:typeof g.referrerPolicy=="string"?g.referrerPolicy:void 0,imageSrcSet:typeof g.imageSrcSet=="string"?g.imageSrcSet:void 0,imageSizes:typeof g.imageSizes=="string"?g.imageSizes:void 0,media:typeof g.media=="string"?g.media:void 0})}},zn.preloadModule=function(p,g){if(typeof p=="string")if(g){var y=m(g.as,g.crossOrigin);l.d.m(p,{as:typeof g.as=="string"&&g.as!=="script"?g.as:void 0,crossOrigin:y,integrity:typeof g.integrity=="string"?g.integrity:void 0})}else l.d.m(p)},zn.requestFormReset=function(p){l.d.r(p)},zn.unstable_batchedUpdates=function(p,g){return p(g)},zn.useFormState=function(p,g,y){return f.H.useFormState(p,g,y)},zn.useFormStatus=function(){return f.H.useHostTransitionStatus()},zn.version="19.2.3",zn}var y0;function Py(){if(y0)return Qd.exports;y0=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(o){console.error(o)}}return n(),Qd.exports=I1(),Qd.exports}var b0;function L1(){if(b0)return oa;b0=1;var n=E1(),o=Zf(),s=Py();function l(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var r=2;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function c(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function f(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function m(e){if(e.tag===31){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function p(e){if(c(e)!==e)throw Error(l(188))}function g(e){var t=e.alternate;if(!t){if(t=c(e),t===null)throw Error(l(188));return t!==e?null:e}for(var r=e,a=t;;){var d=r.return;if(d===null)break;var h=d.alternate;if(h===null){if(a=d.return,a!==null){r=a;continue}break}if(d.child===h.child){for(h=d.child;h;){if(h===r)return p(d),e;if(h===a)return p(d),t;h=h.sibling}throw Error(l(188))}if(r.return!==a.return)r=d,a=h;else{for(var v=!1,M=d.child;M;){if(M===r){v=!0,r=d,a=h;break}if(M===a){v=!0,a=d,r=h;break}M=M.sibling}if(!v){for(M=h.child;M;){if(M===r){v=!0,r=h,a=d;break}if(M===a){v=!0,a=h,r=d;break}M=M.sibling}if(!v)throw Error(l(189))}}if(r.alternate!==a)throw Error(l(190))}if(r.tag!==3)throw Error(l(188));return r.stateNode.current===r?e:t}function y(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e;for(e=e.child;e!==null;){if(t=y(e),t!==null)return t;e=e.sibling}return null}var x=Object.assign,w=Symbol.for("react.element"),k=Symbol.for("react.transitional.element"),N=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),j=Symbol.for("react.strict_mode"),C=Symbol.for("react.profiler"),T=Symbol.for("react.consumer"),V=Symbol.for("react.context"),U=Symbol.for("react.forward_ref"),R=Symbol.for("react.suspense"),z=Symbol.for("react.suspense_list"),L=Symbol.for("react.memo"),$=Symbol.for("react.lazy"),Y=Symbol.for("react.activity"),ue=Symbol.for("react.memo_cache_sentinel"),pe=Symbol.iterator;function fe(e){return e===null||typeof e!="object"?null:(e=pe&&e[pe]||e["@@iterator"],typeof e=="function"?e:null)}var Re=Symbol.for("react.client.reference");function Ie(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===Re?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case S:return"Fragment";case C:return"Profiler";case j:return"StrictMode";case R:return"Suspense";case z:return"SuspenseList";case Y:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case N:return"Portal";case V:return e.displayName||"Context";case T:return(e._context.displayName||"Context")+".Consumer";case U:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case L:return t=e.displayName||null,t!==null?t:Ie(e.type)||"Memo";case $:t=e._payload,e=e._init;try{return Ie(e(t))}catch{}}return null}var Ae=Array.isArray,_=o.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,se=s.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ce={pending:!1,data:null,method:null,action:null},Ue=[],De=-1;function E(e){return{current:e}}function A(e){0>De||(e.current=Ue[De],Ue[De]=null,De--)}function O(e,t){De++,Ue[De]=e.current,e.current=t}var te=E(null),Le=E(null),We=E(null),xe=E(null);function Se(e,t){switch(O(We,t),O(Le,e),O(te,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?Lg(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)t=Lg(t),e=Ag(t,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}A(te),O(te,e)}function H(){A(te),A(Le),A(We)}function P(e){e.memoizedState!==null&&O(xe,e);var t=te.current,r=Ag(t,e.type);t!==r&&(O(Le,e),O(te,r))}function D(e){Le.current===e&&(A(te),A(Le)),xe.current===e&&(A(xe),Zl._currentValue=ce)}var K,Z;function q(e){if(K===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);K=t&&t[1]||"",Z=-1<r.stack.indexOf(`
    at`)?" (<anonymous>)":-1<r.stack.indexOf("@")?"@unknown:0:0":""}return`
`+K+e+Z}var Ee=!1;function je(e,t){if(!e||Ee)return"";Ee=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var a={DetermineComponentFrameRoot:function(){try{if(t){var Ve=function(){throw Error()};if(Object.defineProperty(Ve.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ve,[])}catch(Te){var ve=Te}Reflect.construct(e,[],Ve)}else{try{Ve.call()}catch(Te){ve=Te}e.call(Ve.prototype)}}else{try{throw Error()}catch(Te){ve=Te}(Ve=e())&&typeof Ve.catch=="function"&&Ve.catch(function(){})}}catch(Te){if(Te&&ve&&typeof Te.stack=="string")return[Te.stack,ve.stack]}return[null,null]}};a.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var d=Object.getOwnPropertyDescriptor(a.DetermineComponentFrameRoot,"name");d&&d.configurable&&Object.defineProperty(a.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var h=a.DetermineComponentFrameRoot(),v=h[0],M=h[1];if(v&&M){var G=v.split(`
`),ge=M.split(`
`);for(d=a=0;a<G.length&&!G[a].includes("DetermineComponentFrameRoot");)a++;for(;d<ge.length&&!ge[d].includes("DetermineComponentFrameRoot");)d++;if(a===G.length||d===ge.length)for(a=G.length-1,d=ge.length-1;1<=a&&0<=d&&G[a]!==ge[d];)d--;for(;1<=a&&0<=d;a--,d--)if(G[a]!==ge[d]){if(a!==1||d!==1)do if(a--,d--,0>d||G[a]!==ge[d]){var Be=`
`+G[a].replace(" at new "," at ");return e.displayName&&Be.includes("<anonymous>")&&(Be=Be.replace("<anonymous>",e.displayName)),Be}while(1<=a&&0<=d);break}}}finally{Ee=!1,Error.prepareStackTrace=r}return(r=e?e.displayName||e.name:"")?q(r):""}function Ne(e,t){switch(e.tag){case 26:case 27:case 5:return q(e.type);case 16:return q("Lazy");case 13:return e.child!==t&&t!==null?q("Suspense Fallback"):q("Suspense");case 19:return q("SuspenseList");case 0:case 15:return je(e.type,!1);case 11:return je(e.type.render,!1);case 1:return je(e.type,!0);case 31:return q("Activity");default:return""}}function ee(e){try{var t="",r=null;do t+=Ne(e,r),r=e,e=e.return;while(e);return t}catch(a){return`
Error generating stack: `+a.message+`
`+a.stack}}var Me=Object.prototype.hasOwnProperty,I=n.unstable_scheduleCallback,B=n.unstable_cancelCallback,W=n.unstable_shouldYield,be=n.unstable_requestPaint,me=n.unstable_now,ke=n.unstable_getCurrentPriorityLevel,F=n.unstable_ImmediatePriority,ie=n.unstable_UserBlockingPriority,_e=n.unstable_NormalPriority,$e=n.unstable_LowPriority,Ze=n.unstable_IdlePriority,Ge=n.log,nt=n.unstable_setDisableYieldValue,Ye=null,Fe=null;function st(e){if(typeof Ge=="function"&&nt(e),Fe&&typeof Fe.setStrictMode=="function")try{Fe.setStrictMode(Ye,e)}catch{}}var ft=Math.clz32?Math.clz32:Vt,Nt=Math.log,Ht=Math.LN2;function Vt(e){return e>>>=0,e===0?32:31-(Nt(e)/Ht|0)|0}var ye=256,Q=262144,re=4194304;function de(e){var t=e&42;if(t!==0)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Oe(e,t,r){var a=e.pendingLanes;if(a===0)return 0;var d=0,h=e.suspendedLanes,v=e.pingedLanes;e=e.warmLanes;var M=a&134217727;return M!==0?(a=M&~h,a!==0?d=de(a):(v&=M,v!==0?d=de(v):r||(r=M&~e,r!==0&&(d=de(r))))):(M=a&~h,M!==0?d=de(M):v!==0?d=de(v):r||(r=a&~e,r!==0&&(d=de(r)))),d===0?0:t!==0&&t!==d&&(t&h)===0&&(h=d&-d,r=t&-t,h>=r||h===32&&(r&4194048)!==0)?t:d}function Ke(e,t){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)===0}function we(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function it(){var e=re;return re<<=1,(re&62914560)===0&&(re=4194304),e}function ot(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function tt(e,t){e.pendingLanes|=t,t!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function lt(e,t,r,a,d,h){var v=e.pendingLanes;e.pendingLanes=r,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=r,e.entangledLanes&=r,e.errorRecoveryDisabledLanes&=r,e.shellSuspendCounter=0;var M=e.entanglements,G=e.expirationTimes,ge=e.hiddenUpdates;for(r=v&~r;0<r;){var Be=31-ft(r),Ve=1<<Be;M[Be]=0,G[Be]=-1;var ve=ge[Be];if(ve!==null)for(ge[Be]=null,Be=0;Be<ve.length;Be++){var Te=ve[Be];Te!==null&&(Te.lane&=-536870913)}r&=~Ve}a!==0&&wt(e,a,0),h!==0&&d===0&&e.tag!==0&&(e.suspendedLanes|=h&~(v&~t))}function wt(e,t,r){e.pendingLanes|=t,e.suspendedLanes&=~t;var a=31-ft(t);e.entangledLanes|=t,e.entanglements[a]=e.entanglements[a]|1073741824|r&261930}function pt(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var a=31-ft(r),d=1<<a;d&t|e[a]&t&&(e[a]|=t),r&=~d}}function St(e,t){var r=t&-t;return r=(r&42)!==0?1:yt(r),(r&(e.suspendedLanes|t))!==0?0:r}function yt(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function ht(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function Tt(){var e=se.p;return e!==0?e:(e=window.event,e===void 0?32:n0(e.type))}function Et(e,t){var r=se.p;try{return se.p=e,t()}finally{se.p=r}}var Yt=Math.random().toString(36).slice(2),Gt="__reactFiber$"+Yt,It="__reactProps$"+Yt,dn="__reactContainer$"+Yt,pn="__reactEvents$"+Yt,Wn="__reactListeners$"+Yt,Kn="__reactHandles$"+Yt,no="__reactResources$"+Yt,oo="__reactMarker$"+Yt;function X(e){delete e[Gt],delete e[It],delete e[pn],delete e[Wn],delete e[Kn]}function ze(e){var t=e[Gt];if(t)return t;for(var r=e.parentNode;r;){if(t=r[dn]||r[Gt]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Vg(e);e!==null;){if(r=e[Gt])return r;e=Vg(e)}return t}e=r,r=e.parentNode}return null}function oe(e){if(e=e[Gt]||e[dn]){var t=e.tag;if(t===5||t===6||t===13||t===31||t===26||t===27||t===3)return e}return null}function et(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e.stateNode;throw Error(l(33))}function Xe(e){var t=e[no];return t||(t=e[no]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function Qe(e){e[oo]=!0}var Pe=new Set,ne={};function qe(e,t){Je(e,t),Je(e+"Capture",t)}function Je(e,t){for(ne[e]=t,e=0;e<t.length;e++)Pe.add(t[e])}var at=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Lt={},Zt={};function On(e){return Me.call(Zt,e)?!0:Me.call(Lt,e)?!1:at.test(e)?Zt[e]=!0:(Lt[e]=!0,!1)}function on(e,t,r){if(On(t))if(r===null)e.removeAttribute(t);else{switch(typeof r){case"undefined":case"function":case"symbol":e.removeAttribute(t);return;case"boolean":var a=t.toLowerCase().slice(0,5);if(a!=="data-"&&a!=="aria-"){e.removeAttribute(t);return}}e.setAttribute(t,""+r)}}function Tn(e,t,r){if(r===null)e.removeAttribute(t);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttribute(t,""+r)}}function xn(e,t,r,a){if(a===null)e.removeAttribute(r);else{switch(typeof a){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(r);return}e.setAttributeNS(t,r,""+a)}}function vn(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Ea(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Uu(e,t,r){var a=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&typeof a<"u"&&typeof a.get=="function"&&typeof a.set=="function"){var d=a.get,h=a.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return d.call(this)},set:function(v){r=""+v,h.call(this,v)}}),Object.defineProperty(e,t,{enumerable:a.enumerable}),{getValue:function(){return r},setValue:function(v){r=""+v},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function fl(e){if(!e._valueTracker){var t=Ea(e)?"checked":"value";e._valueTracker=Uu(e,t,""+e[t])}}function Ia(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),a="";return e&&(a=Ea(e)?e.checked?"true":"false":e.value),e=a,e!==r?(t.setValue(e),!0):!1}function Qo(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var La=/[\n"\\]/g;function Bn(e){return e.replace(La,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function pl(e,t,r,a,d,h,v,M){e.name="",v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"?e.type=v:e.removeAttribute("type"),t!=null?v==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+vn(t)):e.value!==""+vn(t)&&(e.value=""+vn(t)):v!=="submit"&&v!=="reset"||e.removeAttribute("value"),t!=null?xs(e,v,vn(t)):r!=null?xs(e,v,vn(r)):a!=null&&e.removeAttribute("value"),d==null&&h!=null&&(e.defaultChecked=!!h),d!=null&&(e.checked=d&&typeof d!="function"&&typeof d!="symbol"),M!=null&&typeof M!="function"&&typeof M!="symbol"&&typeof M!="boolean"?e.name=""+vn(M):e.removeAttribute("name")}function Aa(e,t,r,a,d,h,v,M){if(h!=null&&typeof h!="function"&&typeof h!="symbol"&&typeof h!="boolean"&&(e.type=h),t!=null||r!=null){if(!(h!=="submit"&&h!=="reset"||t!=null)){fl(e);return}r=r!=null?""+vn(r):"",t=t!=null?""+vn(t):r,M||t===e.value||(e.value=t),e.defaultValue=t}a=a??d,a=typeof a!="function"&&typeof a!="symbol"&&!!a,e.checked=M?e.checked:!!a,e.defaultChecked=!!a,v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(e.name=v),fl(e)}function xs(e,t,r){t==="number"&&Qo(e.ownerDocument)===e||e.defaultValue===""+r||(e.defaultValue=""+r)}function ro(e,t,r,a){if(e=e.options,t){t={};for(var d=0;d<r.length;d++)t["$"+r[d]]=!0;for(r=0;r<e.length;r++)d=t.hasOwnProperty("$"+e[r].value),e[r].selected!==d&&(e[r].selected=d),d&&a&&(e[r].defaultSelected=!0)}else{for(r=""+vn(r),t=null,d=0;d<e.length;d++){if(e[d].value===r){e[d].selected=!0,a&&(e[d].defaultSelected=!0);return}t!==null||e[d].disabled||(t=e[d])}t!==null&&(t.selected=!0)}}function Ra(e,t,r){if(t!=null&&(t=""+vn(t),t!==e.value&&(e.value=t),r==null)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=r!=null?""+vn(r):""}function _a(e,t,r,a){if(t==null){if(a!=null){if(r!=null)throw Error(l(92));if(Ae(a)){if(1<a.length)throw Error(l(93));a=a[0]}r=a}r==null&&(r=""),t=r}r=vn(t),e.defaultValue=r,a=e.textContent,a===r&&a!==""&&a!==null&&(e.value=a),fl(e)}function wr(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var $u=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Ce(e,t,r){var a=t.indexOf("--")===0;r==null||typeof r=="boolean"||r===""?a?e.setProperty(t,""):t==="float"?e.cssFloat="":e[t]="":a?e.setProperty(t,r):typeof r!="number"||r===0||$u.has(t)?t==="float"?e.cssFloat=r:e[t]=(""+r).trim():e[t]=r+"px"}function rt(e,t,r){if(t!=null&&typeof t!="object")throw Error(l(62));if(e=e.style,r!=null){for(var a in r)!r.hasOwnProperty(a)||t!=null&&t.hasOwnProperty(a)||(a.indexOf("--")===0?e.setProperty(a,""):a==="float"?e.cssFloat="":e[a]="");for(var d in t)a=t[d],t.hasOwnProperty(d)&&r[d]!==a&&Ce(e,d,a)}else for(var h in t)t.hasOwnProperty(h)&&Ce(e,h,t[h])}function dt(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ln=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),wn=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function _t(e){return wn.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function yo(){}var hl=null;function Yr(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var vs=null,ws=null;function Ip(e){var t=oe(e);if(t&&(e=t.stateNode)){var r=e[It]||null;e:switch(e=t.stateNode,t.type){case"input":if(pl(e,r.value,r.defaultValue,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll('input[name="'+Bn(""+t)+'"][type="radio"]'),t=0;t<r.length;t++){var a=r[t];if(a!==e&&a.form===e.form){var d=a[It]||null;if(!d)throw Error(l(90));pl(a,d.value,d.defaultValue,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name)}}for(t=0;t<r.length;t++)a=r[t],a.form===e.form&&Ia(a)}break e;case"textarea":Ra(e,r.value,r.defaultValue);break e;case"select":t=r.value,t!=null&&ro(e,!!r.multiple,t,!1)}}}var Fu=!1;function Lp(e,t,r){if(Fu)return e(t,r);Fu=!0;try{var a=e(t);return a}finally{if(Fu=!1,(vs!==null||ws!==null)&&(Si(),vs&&(t=vs,e=ws,ws=vs=null,Ip(t),e)))for(t=0;t<e.length;t++)Ip(e[t])}}function ml(e,t){var r=e.stateNode;if(r===null)return null;var a=r[It]||null;if(a===null)return null;r=a[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(a=!a.disabled)||(e=e.type,a=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!a;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(l(231,t,typeof r));return r}var Xo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),qu=!1;if(Xo)try{var gl={};Object.defineProperty(gl,"passive",{get:function(){qu=!0}}),window.addEventListener("test",gl,gl),window.removeEventListener("test",gl,gl)}catch{qu=!1}var Sr=null,Wu=null,Da=null;function Ap(){if(Da)return Da;var e,t=Wu,r=t.length,a,d="value"in Sr?Sr.value:Sr.textContent,h=d.length;for(e=0;e<r&&t[e]===d[e];e++);var v=r-e;for(a=1;a<=v&&t[r-a]===d[h-a];a++);return Da=d.slice(e,1<a?1-a:void 0)}function Ba(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function za(){return!0}function Rp(){return!1}function Gn(e){function t(r,a,d,h,v){this._reactName=r,this._targetInst=d,this.type=a,this.nativeEvent=h,this.target=v,this.currentTarget=null;for(var M in e)e.hasOwnProperty(M)&&(r=e[M],this[M]=r?r(h):h[M]);return this.isDefaultPrevented=(h.defaultPrevented!=null?h.defaultPrevented:h.returnValue===!1)?za:Rp,this.isPropagationStopped=Rp,this}return x(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=za)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=za)},persist:function(){},isPersistent:za}),t}var Qr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ha=Gn(Qr),yl=x({},Qr,{view:0,detail:0}),Sx=Gn(yl),Gu,Pu,bl,Va=x({},yl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Qu,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==bl&&(bl&&e.type==="mousemove"?(Gu=e.screenX-bl.screenX,Pu=e.screenY-bl.screenY):Pu=Gu=0,bl=e),Gu)},movementY:function(e){return"movementY"in e?e.movementY:Pu}}),_p=Gn(Va),Nx=x({},Va,{dataTransfer:0}),Cx=Gn(Nx),kx=x({},yl,{relatedTarget:0}),Yu=Gn(kx),jx=x({},Qr,{animationName:0,elapsedTime:0,pseudoElement:0}),Mx=Gn(jx),Ox=x({},Qr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Tx=Gn(Ox),Ex=x({},Qr,{data:0}),Dp=Gn(Ex),Ix={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Lx={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ax={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Rx(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Ax[e])?!!t[e]:!1}function Qu(){return Rx}var _x=x({},yl,{key:function(e){if(e.key){var t=Ix[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Ba(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Lx[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Qu,charCode:function(e){return e.type==="keypress"?Ba(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Ba(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Dx=Gn(_x),Bx=x({},Va,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Bp=Gn(Bx),zx=x({},yl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Qu}),Hx=Gn(zx),Vx=x({},Qr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Kx=Gn(Vx),Ux=x({},Va,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),$x=Gn(Ux),Fx=x({},Qr,{newState:0,oldState:0}),qx=Gn(Fx),Wx=[9,13,27,32],Xu=Xo&&"CompositionEvent"in window,xl=null;Xo&&"documentMode"in document&&(xl=document.documentMode);var Gx=Xo&&"TextEvent"in window&&!xl,zp=Xo&&(!Xu||xl&&8<xl&&11>=xl),Hp=" ",Vp=!1;function Kp(e,t){switch(e){case"keyup":return Wx.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Up(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Ss=!1;function Px(e,t){switch(e){case"compositionend":return Up(t);case"keypress":return t.which!==32?null:(Vp=!0,Hp);case"textInput":return e=t.data,e===Hp&&Vp?null:e;default:return null}}function Yx(e,t){if(Ss)return e==="compositionend"||!Xu&&Kp(e,t)?(e=Ap(),Da=Wu=Sr=null,Ss=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return zp&&t.locale!=="ko"?null:t.data;default:return null}}var Qx={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function $p(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Qx[e.type]:t==="textarea"}function Fp(e,t,r,a){vs?ws?ws.push(a):ws=[a]:vs=a,t=Ti(t,"onChange"),0<t.length&&(r=new Ha("onChange","change",null,r,a),e.push({event:r,listeners:t}))}var vl=null,wl=null;function Xx(e){jg(e,0)}function Ka(e){var t=et(e);if(Ia(t))return e}function qp(e,t){if(e==="change")return t}var Wp=!1;if(Xo){var Zu;if(Xo){var Ju="oninput"in document;if(!Ju){var Gp=document.createElement("div");Gp.setAttribute("oninput","return;"),Ju=typeof Gp.oninput=="function"}Zu=Ju}else Zu=!1;Wp=Zu&&(!document.documentMode||9<document.documentMode)}function Pp(){vl&&(vl.detachEvent("onpropertychange",Yp),wl=vl=null)}function Yp(e){if(e.propertyName==="value"&&Ka(wl)){var t=[];Fp(t,wl,e,Yr(e)),Lp(Xx,t)}}function Zx(e,t,r){e==="focusin"?(Pp(),vl=t,wl=r,vl.attachEvent("onpropertychange",Yp)):e==="focusout"&&Pp()}function Jx(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Ka(wl)}function ev(e,t){if(e==="click")return Ka(t)}function tv(e,t){if(e==="input"||e==="change")return Ka(t)}function nv(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var so=typeof Object.is=="function"?Object.is:nv;function Sl(e,t){if(so(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),a=Object.keys(t);if(r.length!==a.length)return!1;for(a=0;a<r.length;a++){var d=r[a];if(!Me.call(t,d)||!so(e[d],t[d]))return!1}return!0}function Qp(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Xp(e,t){var r=Qp(e);e=0;for(var a;r;){if(r.nodeType===3){if(a=e+r.textContent.length,e<=t&&a>=t)return{node:r,offset:t-e};e=a}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Qp(r)}}function Zp(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Zp(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Jp(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var t=Qo(e.document);t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Qo(e.document)}return t}function ec(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}var ov=Xo&&"documentMode"in document&&11>=document.documentMode,Ns=null,tc=null,Nl=null,nc=!1;function eh(e,t,r){var a=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;nc||Ns==null||Ns!==Qo(a)||(a=Ns,"selectionStart"in a&&ec(a)?a={start:a.selectionStart,end:a.selectionEnd}:(a=(a.ownerDocument&&a.ownerDocument.defaultView||window).getSelection(),a={anchorNode:a.anchorNode,anchorOffset:a.anchorOffset,focusNode:a.focusNode,focusOffset:a.focusOffset}),Nl&&Sl(Nl,a)||(Nl=a,a=Ti(tc,"onSelect"),0<a.length&&(t=new Ha("onSelect","select",null,t,r),e.push({event:t,listeners:a}),t.target=Ns)))}function Xr(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Cs={animationend:Xr("Animation","AnimationEnd"),animationiteration:Xr("Animation","AnimationIteration"),animationstart:Xr("Animation","AnimationStart"),transitionrun:Xr("Transition","TransitionRun"),transitionstart:Xr("Transition","TransitionStart"),transitioncancel:Xr("Transition","TransitionCancel"),transitionend:Xr("Transition","TransitionEnd")},oc={},th={};Xo&&(th=document.createElement("div").style,"AnimationEvent"in window||(delete Cs.animationend.animation,delete Cs.animationiteration.animation,delete Cs.animationstart.animation),"TransitionEvent"in window||delete Cs.transitionend.transition);function Zr(e){if(oc[e])return oc[e];if(!Cs[e])return e;var t=Cs[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in th)return oc[e]=t[r];return e}var nh=Zr("animationend"),oh=Zr("animationiteration"),rh=Zr("animationstart"),rv=Zr("transitionrun"),sv=Zr("transitionstart"),lv=Zr("transitioncancel"),sh=Zr("transitionend"),lh=new Map,rc="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");rc.push("scrollEnd");function To(e,t){lh.set(e,t),qe(t,[e])}var Ua=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},bo=[],ks=0,sc=0;function $a(){for(var e=ks,t=sc=ks=0;t<e;){var r=bo[t];bo[t++]=null;var a=bo[t];bo[t++]=null;var d=bo[t];bo[t++]=null;var h=bo[t];if(bo[t++]=null,a!==null&&d!==null){var v=a.pending;v===null?d.next=d:(d.next=v.next,v.next=d),a.pending=d}h!==0&&ah(r,d,h)}}function Fa(e,t,r,a){bo[ks++]=e,bo[ks++]=t,bo[ks++]=r,bo[ks++]=a,sc|=a,e.lanes|=a,e=e.alternate,e!==null&&(e.lanes|=a)}function lc(e,t,r,a){return Fa(e,t,r,a),qa(e)}function Jr(e,t){return Fa(e,null,null,t),qa(e)}function ah(e,t,r){e.lanes|=r;var a=e.alternate;a!==null&&(a.lanes|=r);for(var d=!1,h=e.return;h!==null;)h.childLanes|=r,a=h.alternate,a!==null&&(a.childLanes|=r),h.tag===22&&(e=h.stateNode,e===null||e._visibility&1||(d=!0)),e=h,h=h.return;return e.tag===3?(h=e.stateNode,d&&t!==null&&(d=31-ft(r),e=h.hiddenUpdates,a=e[d],a===null?e[d]=[t]:a.push(t),t.lane=r|536870912),h):null}function qa(e){if(50<ql)throw ql=0,md=null,Error(l(185));for(var t=e.return;t!==null;)e=t,t=e.return;return e.tag===3?e.stateNode:null}var js={};function av(e,t,r,a){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=a,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function lo(e,t,r,a){return new av(e,t,r,a)}function ac(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Zo(e,t){var r=e.alternate;return r===null?(r=lo(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&65011712,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r.refCleanup=e.refCleanup,r}function ih(e,t){e.flags&=65011714;var r=e.alternate;return r===null?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=r.childLanes,e.lanes=r.lanes,e.child=r.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=r.memoizedProps,e.memoizedState=r.memoizedState,e.updateQueue=r.updateQueue,e.type=r.type,t=r.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Wa(e,t,r,a,d,h){var v=0;if(a=e,typeof e=="function")ac(e)&&(v=1);else if(typeof e=="string")v=f1(e,r,te.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case Y:return e=lo(31,r,t,d),e.elementType=Y,e.lanes=h,e;case S:return es(r.children,d,h,t);case j:v=8,d|=24;break;case C:return e=lo(12,r,t,d|2),e.elementType=C,e.lanes=h,e;case R:return e=lo(13,r,t,d),e.elementType=R,e.lanes=h,e;case z:return e=lo(19,r,t,d),e.elementType=z,e.lanes=h,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case V:v=10;break e;case T:v=9;break e;case U:v=11;break e;case L:v=14;break e;case $:v=16,a=null;break e}v=29,r=Error(l(130,e===null?"null":typeof e,"")),a=null}return t=lo(v,r,t,d),t.elementType=e,t.type=a,t.lanes=h,t}function es(e,t,r,a){return e=lo(7,e,a,t),e.lanes=r,e}function ic(e,t,r){return e=lo(6,e,null,t),e.lanes=r,e}function uh(e){var t=lo(18,null,null,0);return t.stateNode=e,t}function uc(e,t,r){return t=lo(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var ch=new WeakMap;function xo(e,t){if(typeof e=="object"&&e!==null){var r=ch.get(e);return r!==void 0?r:(t={value:e,source:t,stack:ee(t)},ch.set(e,t),t)}return{value:e,source:t,stack:ee(t)}}var Ms=[],Os=0,Ga=null,Cl=0,vo=[],wo=0,Nr=null,Ho=1,Vo="";function Jo(e,t){Ms[Os++]=Cl,Ms[Os++]=Ga,Ga=e,Cl=t}function dh(e,t,r){vo[wo++]=Ho,vo[wo++]=Vo,vo[wo++]=Nr,Nr=e;var a=Ho;e=Vo;var d=32-ft(a)-1;a&=~(1<<d),r+=1;var h=32-ft(t)+d;if(30<h){var v=d-d%5;h=(a&(1<<v)-1).toString(32),a>>=v,d-=v,Ho=1<<32-ft(t)+d|r<<d|a,Vo=h+e}else Ho=1<<h|r<<d|a,Vo=e}function cc(e){e.return!==null&&(Jo(e,1),dh(e,1,0))}function dc(e){for(;e===Ga;)Ga=Ms[--Os],Ms[Os]=null,Cl=Ms[--Os],Ms[Os]=null;for(;e===Nr;)Nr=vo[--wo],vo[wo]=null,Vo=vo[--wo],vo[wo]=null,Ho=vo[--wo],vo[wo]=null}function fh(e,t){vo[wo++]=Ho,vo[wo++]=Vo,vo[wo++]=Nr,Ho=t.id,Vo=t.overflow,Nr=e}var Ln=null,an=null,zt=!1,Cr=null,So=!1,fc=Error(l(519));function kr(e){var t=Error(l(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw kl(xo(t,e)),fc}function ph(e){var t=e.stateNode,r=e.type,a=e.memoizedProps;switch(t[Gt]=e,t[It]=a,r){case"dialog":Rt("cancel",t),Rt("close",t);break;case"iframe":case"object":case"embed":Rt("load",t);break;case"video":case"audio":for(r=0;r<Gl.length;r++)Rt(Gl[r],t);break;case"source":Rt("error",t);break;case"img":case"image":case"link":Rt("error",t),Rt("load",t);break;case"details":Rt("toggle",t);break;case"input":Rt("invalid",t),Aa(t,a.value,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name,!0);break;case"select":Rt("invalid",t);break;case"textarea":Rt("invalid",t),_a(t,a.value,a.defaultValue,a.children)}r=a.children,typeof r!="string"&&typeof r!="number"&&typeof r!="bigint"||t.textContent===""+r||a.suppressHydrationWarning===!0||Eg(t.textContent,r)?(a.popover!=null&&(Rt("beforetoggle",t),Rt("toggle",t)),a.onScroll!=null&&Rt("scroll",t),a.onScrollEnd!=null&&Rt("scrollend",t),a.onClick!=null&&(t.onclick=yo),t=!0):t=!1,t||kr(e,!0)}function hh(e){for(Ln=e.return;Ln;)switch(Ln.tag){case 5:case 31:case 13:So=!1;return;case 27:case 3:So=!0;return;default:Ln=Ln.return}}function Ts(e){if(e!==Ln)return!1;if(!zt)return hh(e),zt=!0,!1;var t=e.tag,r;if((r=t!==3&&t!==27)&&((r=t===5)&&(r=e.type,r=!(r!=="form"&&r!=="button")||Ed(e.type,e.memoizedProps)),r=!r),r&&an&&kr(e),hh(e),t===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(l(317));an=Hg(e)}else if(t===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(l(317));an=Hg(e)}else t===27?(t=an,Hr(e.type)?(e=_d,_d=null,an=e):an=t):an=Ln?Co(e.stateNode.nextSibling):null;return!0}function ts(){an=Ln=null,zt=!1}function pc(){var e=Cr;return e!==null&&(Xn===null?Xn=e:Xn.push.apply(Xn,e),Cr=null),e}function kl(e){Cr===null?Cr=[e]:Cr.push(e)}var hc=E(null),ns=null,er=null;function jr(e,t,r){O(hc,t._currentValue),t._currentValue=r}function tr(e){e._currentValue=hc.current,A(hc)}function mc(e,t,r){for(;e!==null;){var a=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,a!==null&&(a.childLanes|=t)):a!==null&&(a.childLanes&t)!==t&&(a.childLanes|=t),e===r)break;e=e.return}}function gc(e,t,r,a){var d=e.child;for(d!==null&&(d.return=e);d!==null;){var h=d.dependencies;if(h!==null){var v=d.child;h=h.firstContext;e:for(;h!==null;){var M=h;h=d;for(var G=0;G<t.length;G++)if(M.context===t[G]){h.lanes|=r,M=h.alternate,M!==null&&(M.lanes|=r),mc(h.return,r,e),a||(v=null);break e}h=M.next}}else if(d.tag===18){if(v=d.return,v===null)throw Error(l(341));v.lanes|=r,h=v.alternate,h!==null&&(h.lanes|=r),mc(v,r,e),v=null}else v=d.child;if(v!==null)v.return=d;else for(v=d;v!==null;){if(v===e){v=null;break}if(d=v.sibling,d!==null){d.return=v.return,v=d;break}v=v.return}d=v}}function Es(e,t,r,a){e=null;for(var d=t,h=!1;d!==null;){if(!h){if((d.flags&524288)!==0)h=!0;else if((d.flags&262144)!==0)break}if(d.tag===10){var v=d.alternate;if(v===null)throw Error(l(387));if(v=v.memoizedProps,v!==null){var M=d.type;so(d.pendingProps.value,v.value)||(e!==null?e.push(M):e=[M])}}else if(d===xe.current){if(v=d.alternate,v===null)throw Error(l(387));v.memoizedState.memoizedState!==d.memoizedState.memoizedState&&(e!==null?e.push(Zl):e=[Zl])}d=d.return}e!==null&&gc(t,e,r,a),t.flags|=262144}function Pa(e){for(e=e.firstContext;e!==null;){if(!so(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function os(e){ns=e,er=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function An(e){return mh(ns,e)}function Ya(e,t){return ns===null&&os(e),mh(e,t)}function mh(e,t){var r=t._currentValue;if(t={context:t,memoizedValue:r,next:null},er===null){if(e===null)throw Error(l(308));er=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else er=er.next=t;return r}var iv=typeof AbortController<"u"?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(r,a){e.push(a)}};this.abort=function(){t.aborted=!0,e.forEach(function(r){return r()})}},uv=n.unstable_scheduleCallback,cv=n.unstable_NormalPriority,Sn={$$typeof:V,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function yc(){return{controller:new iv,data:new Map,refCount:0}}function jl(e){e.refCount--,e.refCount===0&&uv(cv,function(){e.controller.abort()})}var Ml=null,bc=0,Is=0,Ls=null;function dv(e,t){if(Ml===null){var r=Ml=[];bc=0,Is=wd(),Ls={status:"pending",value:void 0,then:function(a){r.push(a)}}}return bc++,t.then(gh,gh),t}function gh(){if(--bc===0&&Ml!==null){Ls!==null&&(Ls.status="fulfilled");var e=Ml;Ml=null,Is=0,Ls=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function fv(e,t){var r=[],a={status:"pending",value:null,reason:null,then:function(d){r.push(d)}};return e.then(function(){a.status="fulfilled",a.value=t;for(var d=0;d<r.length;d++)(0,r[d])(t)},function(d){for(a.status="rejected",a.reason=d,d=0;d<r.length;d++)(0,r[d])(void 0)}),a}var yh=_.S;_.S=function(e,t){eg=me(),typeof t=="object"&&t!==null&&typeof t.then=="function"&&dv(e,t),yh!==null&&yh(e,t)};var rs=E(null);function xc(){var e=rs.current;return e!==null?e:rn.pooledCache}function Qa(e,t){t===null?O(rs,rs.current):O(rs,t.pool)}function bh(){var e=xc();return e===null?null:{parent:Sn._currentValue,pool:e}}var As=Error(l(460)),vc=Error(l(474)),Xa=Error(l(542)),Za={then:function(){}};function xh(e){return e=e.status,e==="fulfilled"||e==="rejected"}function vh(e,t,r){switch(r=e[r],r===void 0?e.push(t):r!==t&&(t.then(yo,yo),t=r),t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,Sh(e),e;default:if(typeof t.status=="string")t.then(yo,yo);else{if(e=rn,e!==null&&100<e.shellSuspendCounter)throw Error(l(482));e=t,e.status="pending",e.then(function(a){if(t.status==="pending"){var d=t;d.status="fulfilled",d.value=a}},function(a){if(t.status==="pending"){var d=t;d.status="rejected",d.reason=a}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,Sh(e),e}throw ls=t,As}}function ss(e){try{var t=e._init;return t(e._payload)}catch(r){throw r!==null&&typeof r=="object"&&typeof r.then=="function"?(ls=r,As):r}}var ls=null;function wh(){if(ls===null)throw Error(l(459));var e=ls;return ls=null,e}function Sh(e){if(e===As||e===Xa)throw Error(l(483))}var Rs=null,Ol=0;function Ja(e){var t=Ol;return Ol+=1,Rs===null&&(Rs=[]),vh(Rs,e,t)}function Tl(e,t){t=t.props.ref,e.ref=t!==void 0?t:null}function ei(e,t){throw t.$$typeof===w?Error(l(525)):(e=Object.prototype.toString.call(t),Error(l(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)))}function Nh(e){function t(le,J){if(e){var he=le.deletions;he===null?(le.deletions=[J],le.flags|=16):he.push(J)}}function r(le,J){if(!e)return null;for(;J!==null;)t(le,J),J=J.sibling;return null}function a(le){for(var J=new Map;le!==null;)le.key!==null?J.set(le.key,le):J.set(le.index,le),le=le.sibling;return J}function d(le,J){return le=Zo(le,J),le.index=0,le.sibling=null,le}function h(le,J,he){return le.index=he,e?(he=le.alternate,he!==null?(he=he.index,he<J?(le.flags|=67108866,J):he):(le.flags|=67108866,J)):(le.flags|=1048576,J)}function v(le){return e&&le.alternate===null&&(le.flags|=67108866),le}function M(le,J,he,He){return J===null||J.tag!==6?(J=ic(he,le.mode,He),J.return=le,J):(J=d(J,he),J.return=le,J)}function G(le,J,he,He){var mt=he.type;return mt===S?Be(le,J,he.props.children,He,he.key):J!==null&&(J.elementType===mt||typeof mt=="object"&&mt!==null&&mt.$$typeof===$&&ss(mt)===J.type)?(J=d(J,he.props),Tl(J,he),J.return=le,J):(J=Wa(he.type,he.key,he.props,null,le.mode,He),Tl(J,he),J.return=le,J)}function ge(le,J,he,He){return J===null||J.tag!==4||J.stateNode.containerInfo!==he.containerInfo||J.stateNode.implementation!==he.implementation?(J=uc(he,le.mode,He),J.return=le,J):(J=d(J,he.children||[]),J.return=le,J)}function Be(le,J,he,He,mt){return J===null||J.tag!==7?(J=es(he,le.mode,He,mt),J.return=le,J):(J=d(J,he),J.return=le,J)}function Ve(le,J,he){if(typeof J=="string"&&J!==""||typeof J=="number"||typeof J=="bigint")return J=ic(""+J,le.mode,he),J.return=le,J;if(typeof J=="object"&&J!==null){switch(J.$$typeof){case k:return he=Wa(J.type,J.key,J.props,null,le.mode,he),Tl(he,J),he.return=le,he;case N:return J=uc(J,le.mode,he),J.return=le,J;case $:return J=ss(J),Ve(le,J,he)}if(Ae(J)||fe(J))return J=es(J,le.mode,he,null),J.return=le,J;if(typeof J.then=="function")return Ve(le,Ja(J),he);if(J.$$typeof===V)return Ve(le,Ya(le,J),he);ei(le,J)}return null}function ve(le,J,he,He){var mt=J!==null?J.key:null;if(typeof he=="string"&&he!==""||typeof he=="number"||typeof he=="bigint")return mt!==null?null:M(le,J,""+he,He);if(typeof he=="object"&&he!==null){switch(he.$$typeof){case k:return he.key===mt?G(le,J,he,He):null;case N:return he.key===mt?ge(le,J,he,He):null;case $:return he=ss(he),ve(le,J,he,He)}if(Ae(he)||fe(he))return mt!==null?null:Be(le,J,he,He,null);if(typeof he.then=="function")return ve(le,J,Ja(he),He);if(he.$$typeof===V)return ve(le,J,Ya(le,he),He);ei(le,he)}return null}function Te(le,J,he,He,mt){if(typeof He=="string"&&He!==""||typeof He=="number"||typeof He=="bigint")return le=le.get(he)||null,M(J,le,""+He,mt);if(typeof He=="object"&&He!==null){switch(He.$$typeof){case k:return le=le.get(He.key===null?he:He.key)||null,G(J,le,He,mt);case N:return le=le.get(He.key===null?he:He.key)||null,ge(J,le,He,mt);case $:return He=ss(He),Te(le,J,he,He,mt)}if(Ae(He)||fe(He))return le=le.get(he)||null,Be(J,le,He,mt,null);if(typeof He.then=="function")return Te(le,J,he,Ja(He),mt);if(He.$$typeof===V)return Te(le,J,he,Ya(J,He),mt);ei(J,He)}return null}function ut(le,J,he,He){for(var mt=null,Kt=null,ct=J,Ot=J=0,Bt=null;ct!==null&&Ot<he.length;Ot++){ct.index>Ot?(Bt=ct,ct=null):Bt=ct.sibling;var Ut=ve(le,ct,he[Ot],He);if(Ut===null){ct===null&&(ct=Bt);break}e&&ct&&Ut.alternate===null&&t(le,ct),J=h(Ut,J,Ot),Kt===null?mt=Ut:Kt.sibling=Ut,Kt=Ut,ct=Bt}if(Ot===he.length)return r(le,ct),zt&&Jo(le,Ot),mt;if(ct===null){for(;Ot<he.length;Ot++)ct=Ve(le,he[Ot],He),ct!==null&&(J=h(ct,J,Ot),Kt===null?mt=ct:Kt.sibling=ct,Kt=ct);return zt&&Jo(le,Ot),mt}for(ct=a(ct);Ot<he.length;Ot++)Bt=Te(ct,le,Ot,he[Ot],He),Bt!==null&&(e&&Bt.alternate!==null&&ct.delete(Bt.key===null?Ot:Bt.key),J=h(Bt,J,Ot),Kt===null?mt=Bt:Kt.sibling=Bt,Kt=Bt);return e&&ct.forEach(function(Fr){return t(le,Fr)}),zt&&Jo(le,Ot),mt}function xt(le,J,he,He){if(he==null)throw Error(l(151));for(var mt=null,Kt=null,ct=J,Ot=J=0,Bt=null,Ut=he.next();ct!==null&&!Ut.done;Ot++,Ut=he.next()){ct.index>Ot?(Bt=ct,ct=null):Bt=ct.sibling;var Fr=ve(le,ct,Ut.value,He);if(Fr===null){ct===null&&(ct=Bt);break}e&&ct&&Fr.alternate===null&&t(le,ct),J=h(Fr,J,Ot),Kt===null?mt=Fr:Kt.sibling=Fr,Kt=Fr,ct=Bt}if(Ut.done)return r(le,ct),zt&&Jo(le,Ot),mt;if(ct===null){for(;!Ut.done;Ot++,Ut=he.next())Ut=Ve(le,Ut.value,He),Ut!==null&&(J=h(Ut,J,Ot),Kt===null?mt=Ut:Kt.sibling=Ut,Kt=Ut);return zt&&Jo(le,Ot),mt}for(ct=a(ct);!Ut.done;Ot++,Ut=he.next())Ut=Te(ct,le,Ot,Ut.value,He),Ut!==null&&(e&&Ut.alternate!==null&&ct.delete(Ut.key===null?Ot:Ut.key),J=h(Ut,J,Ot),Kt===null?mt=Ut:Kt.sibling=Ut,Kt=Ut);return e&&ct.forEach(function(N1){return t(le,N1)}),zt&&Jo(le,Ot),mt}function tn(le,J,he,He){if(typeof he=="object"&&he!==null&&he.type===S&&he.key===null&&(he=he.props.children),typeof he=="object"&&he!==null){switch(he.$$typeof){case k:e:{for(var mt=he.key;J!==null;){if(J.key===mt){if(mt=he.type,mt===S){if(J.tag===7){r(le,J.sibling),He=d(J,he.props.children),He.return=le,le=He;break e}}else if(J.elementType===mt||typeof mt=="object"&&mt!==null&&mt.$$typeof===$&&ss(mt)===J.type){r(le,J.sibling),He=d(J,he.props),Tl(He,he),He.return=le,le=He;break e}r(le,J);break}else t(le,J);J=J.sibling}he.type===S?(He=es(he.props.children,le.mode,He,he.key),He.return=le,le=He):(He=Wa(he.type,he.key,he.props,null,le.mode,He),Tl(He,he),He.return=le,le=He)}return v(le);case N:e:{for(mt=he.key;J!==null;){if(J.key===mt)if(J.tag===4&&J.stateNode.containerInfo===he.containerInfo&&J.stateNode.implementation===he.implementation){r(le,J.sibling),He=d(J,he.children||[]),He.return=le,le=He;break e}else{r(le,J);break}else t(le,J);J=J.sibling}He=uc(he,le.mode,He),He.return=le,le=He}return v(le);case $:return he=ss(he),tn(le,J,he,He)}if(Ae(he))return ut(le,J,he,He);if(fe(he)){if(mt=fe(he),typeof mt!="function")throw Error(l(150));return he=mt.call(he),xt(le,J,he,He)}if(typeof he.then=="function")return tn(le,J,Ja(he),He);if(he.$$typeof===V)return tn(le,J,Ya(le,he),He);ei(le,he)}return typeof he=="string"&&he!==""||typeof he=="number"||typeof he=="bigint"?(he=""+he,J!==null&&J.tag===6?(r(le,J.sibling),He=d(J,he),He.return=le,le=He):(r(le,J),He=ic(he,le.mode,He),He.return=le,le=He),v(le)):r(le,J)}return function(le,J,he,He){try{Ol=0;var mt=tn(le,J,he,He);return Rs=null,mt}catch(ct){if(ct===As||ct===Xa)throw ct;var Kt=lo(29,ct,null,le.mode);return Kt.lanes=He,Kt.return=le,Kt}}}var as=Nh(!0),Ch=Nh(!1),Mr=!1;function wc(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Sc(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function Or(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function Tr(e,t,r){var a=e.updateQueue;if(a===null)return null;if(a=a.shared,(Ft&2)!==0){var d=a.pending;return d===null?t.next=t:(t.next=d.next,d.next=t),a.pending=t,t=qa(e),ah(e,null,r),t}return Fa(e,a,t,r),qa(e)}function El(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194048)!==0)){var a=t.lanes;a&=e.pendingLanes,r|=a,t.lanes=r,pt(e,r)}}function Nc(e,t){var r=e.updateQueue,a=e.alternate;if(a!==null&&(a=a.updateQueue,r===a)){var d=null,h=null;if(r=r.firstBaseUpdate,r!==null){do{var v={lane:r.lane,tag:r.tag,payload:r.payload,callback:null,next:null};h===null?d=h=v:h=h.next=v,r=r.next}while(r!==null);h===null?d=h=t:h=h.next=t}else d=h=t;r={baseState:a.baseState,firstBaseUpdate:d,lastBaseUpdate:h,shared:a.shared,callbacks:a.callbacks},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}var Cc=!1;function Il(){if(Cc){var e=Ls;if(e!==null)throw e}}function Ll(e,t,r,a){Cc=!1;var d=e.updateQueue;Mr=!1;var h=d.firstBaseUpdate,v=d.lastBaseUpdate,M=d.shared.pending;if(M!==null){d.shared.pending=null;var G=M,ge=G.next;G.next=null,v===null?h=ge:v.next=ge,v=G;var Be=e.alternate;Be!==null&&(Be=Be.updateQueue,M=Be.lastBaseUpdate,M!==v&&(M===null?Be.firstBaseUpdate=ge:M.next=ge,Be.lastBaseUpdate=G))}if(h!==null){var Ve=d.baseState;v=0,Be=ge=G=null,M=h;do{var ve=M.lane&-536870913,Te=ve!==M.lane;if(Te?(Dt&ve)===ve:(a&ve)===ve){ve!==0&&ve===Is&&(Cc=!0),Be!==null&&(Be=Be.next={lane:0,tag:M.tag,payload:M.payload,callback:null,next:null});e:{var ut=e,xt=M;ve=t;var tn=r;switch(xt.tag){case 1:if(ut=xt.payload,typeof ut=="function"){Ve=ut.call(tn,Ve,ve);break e}Ve=ut;break e;case 3:ut.flags=ut.flags&-65537|128;case 0:if(ut=xt.payload,ve=typeof ut=="function"?ut.call(tn,Ve,ve):ut,ve==null)break e;Ve=x({},Ve,ve);break e;case 2:Mr=!0}}ve=M.callback,ve!==null&&(e.flags|=64,Te&&(e.flags|=8192),Te=d.callbacks,Te===null?d.callbacks=[ve]:Te.push(ve))}else Te={lane:ve,tag:M.tag,payload:M.payload,callback:M.callback,next:null},Be===null?(ge=Be=Te,G=Ve):Be=Be.next=Te,v|=ve;if(M=M.next,M===null){if(M=d.shared.pending,M===null)break;Te=M,M=Te.next,Te.next=null,d.lastBaseUpdate=Te,d.shared.pending=null}}while(!0);Be===null&&(G=Ve),d.baseState=G,d.firstBaseUpdate=ge,d.lastBaseUpdate=Be,h===null&&(d.shared.lanes=0),Rr|=v,e.lanes=v,e.memoizedState=Ve}}function kh(e,t){if(typeof e!="function")throw Error(l(191,e));e.call(t)}function jh(e,t){var r=e.callbacks;if(r!==null)for(e.callbacks=null,e=0;e<r.length;e++)kh(r[e],t)}var _s=E(null),ti=E(0);function Mh(e,t){e=cr,O(ti,e),O(_s,t),cr=e|t.baseLanes}function kc(){O(ti,cr),O(_s,_s.current)}function jc(){cr=ti.current,A(_s),A(ti)}var ao=E(null),No=null;function Er(e){var t=e.alternate;O(yn,yn.current&1),O(ao,e),No===null&&(t===null||_s.current!==null||t.memoizedState!==null)&&(No=e)}function Mc(e){O(yn,yn.current),O(ao,e),No===null&&(No=e)}function Oh(e){e.tag===22?(O(yn,yn.current),O(ao,e),No===null&&(No=e)):Ir()}function Ir(){O(yn,yn.current),O(ao,ao.current)}function io(e){A(ao),No===e&&(No=null),A(yn)}var yn=E(0);function ni(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||Ad(r)||Rd(r)))return t}else if(t.tag===19&&(t.memoizedProps.revealOrder==="forwards"||t.memoizedProps.revealOrder==="backwards"||t.memoizedProps.revealOrder==="unstable_legacy-backwards"||t.memoizedProps.revealOrder==="together")){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var nr=0,jt=null,Jt=null,Nn=null,oi=!1,Ds=!1,is=!1,ri=0,Al=0,Bs=null,pv=0;function hn(){throw Error(l(321))}function Oc(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!so(e[r],t[r]))return!1;return!0}function Tc(e,t,r,a,d,h){return nr=h,jt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,_.H=e===null||e.memoizedState===null?dm:Fc,is=!1,h=r(a,d),is=!1,Ds&&(h=Eh(t,r,a,d)),Th(e),h}function Th(e){_.H=Dl;var t=Jt!==null&&Jt.next!==null;if(nr=0,Nn=Jt=jt=null,oi=!1,Al=0,Bs=null,t)throw Error(l(300));e===null||Cn||(e=e.dependencies,e!==null&&Pa(e)&&(Cn=!0))}function Eh(e,t,r,a){jt=e;var d=0;do{if(Ds&&(Bs=null),Al=0,Ds=!1,25<=d)throw Error(l(301));if(d+=1,Nn=Jt=null,e.updateQueue!=null){var h=e.updateQueue;h.lastEffect=null,h.events=null,h.stores=null,h.memoCache!=null&&(h.memoCache.index=0)}_.H=fm,h=t(r,a)}while(Ds);return h}function hv(){var e=_.H,t=e.useState()[0];return t=typeof t.then=="function"?Rl(t):t,e=e.useState()[0],(Jt!==null?Jt.memoizedState:null)!==e&&(jt.flags|=1024),t}function Ec(){var e=ri!==0;return ri=0,e}function Ic(e,t,r){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r}function Lc(e){if(oi){for(e=e.memoizedState;e!==null;){var t=e.queue;t!==null&&(t.pending=null),e=e.next}oi=!1}nr=0,Nn=Jt=jt=null,Ds=!1,Al=ri=0,Bs=null}function Un(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Nn===null?jt.memoizedState=Nn=e:Nn=Nn.next=e,Nn}function bn(){if(Jt===null){var e=jt.alternate;e=e!==null?e.memoizedState:null}else e=Jt.next;var t=Nn===null?jt.memoizedState:Nn.next;if(t!==null)Nn=t,Jt=e;else{if(e===null)throw jt.alternate===null?Error(l(467)):Error(l(310));Jt=e,e={memoizedState:Jt.memoizedState,baseState:Jt.baseState,baseQueue:Jt.baseQueue,queue:Jt.queue,next:null},Nn===null?jt.memoizedState=Nn=e:Nn=Nn.next=e}return Nn}function si(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Rl(e){var t=Al;return Al+=1,Bs===null&&(Bs=[]),e=vh(Bs,e,t),t=jt,(Nn===null?t.memoizedState:Nn.next)===null&&(t=t.alternate,_.H=t===null||t.memoizedState===null?dm:Fc),e}function li(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return Rl(e);if(e.$$typeof===V)return An(e)}throw Error(l(438,String(e)))}function Ac(e){var t=null,r=jt.updateQueue;if(r!==null&&(t=r.memoCache),t==null){var a=jt.alternate;a!==null&&(a=a.updateQueue,a!==null&&(a=a.memoCache,a!=null&&(t={data:a.data.map(function(d){return d.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),r===null&&(r=si(),jt.updateQueue=r),r.memoCache=t,r=t.data[t.index],r===void 0)for(r=t.data[t.index]=Array(e),a=0;a<e;a++)r[a]=ue;return t.index++,r}function or(e,t){return typeof t=="function"?t(e):t}function ai(e){var t=bn();return Rc(t,Jt,e)}function Rc(e,t,r){var a=e.queue;if(a===null)throw Error(l(311));a.lastRenderedReducer=r;var d=e.baseQueue,h=a.pending;if(h!==null){if(d!==null){var v=d.next;d.next=h.next,h.next=v}t.baseQueue=d=h,a.pending=null}if(h=e.baseState,d===null)e.memoizedState=h;else{t=d.next;var M=v=null,G=null,ge=t,Be=!1;do{var Ve=ge.lane&-536870913;if(Ve!==ge.lane?(Dt&Ve)===Ve:(nr&Ve)===Ve){var ve=ge.revertLane;if(ve===0)G!==null&&(G=G.next={lane:0,revertLane:0,gesture:null,action:ge.action,hasEagerState:ge.hasEagerState,eagerState:ge.eagerState,next:null}),Ve===Is&&(Be=!0);else if((nr&ve)===ve){ge=ge.next,ve===Is&&(Be=!0);continue}else Ve={lane:0,revertLane:ge.revertLane,gesture:null,action:ge.action,hasEagerState:ge.hasEagerState,eagerState:ge.eagerState,next:null},G===null?(M=G=Ve,v=h):G=G.next=Ve,jt.lanes|=ve,Rr|=ve;Ve=ge.action,is&&r(h,Ve),h=ge.hasEagerState?ge.eagerState:r(h,Ve)}else ve={lane:Ve,revertLane:ge.revertLane,gesture:ge.gesture,action:ge.action,hasEagerState:ge.hasEagerState,eagerState:ge.eagerState,next:null},G===null?(M=G=ve,v=h):G=G.next=ve,jt.lanes|=Ve,Rr|=Ve;ge=ge.next}while(ge!==null&&ge!==t);if(G===null?v=h:G.next=M,!so(h,e.memoizedState)&&(Cn=!0,Be&&(r=Ls,r!==null)))throw r;e.memoizedState=h,e.baseState=v,e.baseQueue=G,a.lastRenderedState=h}return d===null&&(a.lanes=0),[e.memoizedState,a.dispatch]}function _c(e){var t=bn(),r=t.queue;if(r===null)throw Error(l(311));r.lastRenderedReducer=e;var a=r.dispatch,d=r.pending,h=t.memoizedState;if(d!==null){r.pending=null;var v=d=d.next;do h=e(h,v.action),v=v.next;while(v!==d);so(h,t.memoizedState)||(Cn=!0),t.memoizedState=h,t.baseQueue===null&&(t.baseState=h),r.lastRenderedState=h}return[h,a]}function Ih(e,t,r){var a=jt,d=bn(),h=zt;if(h){if(r===void 0)throw Error(l(407));r=r()}else r=t();var v=!so((Jt||d).memoizedState,r);if(v&&(d.memoizedState=r,Cn=!0),d=d.queue,zc(Rh.bind(null,a,d,e),[e]),d.getSnapshot!==t||v||Nn!==null&&Nn.memoizedState.tag&1){if(a.flags|=2048,zs(9,{destroy:void 0},Ah.bind(null,a,d,r,t),null),rn===null)throw Error(l(349));h||(nr&127)!==0||Lh(a,t,r)}return r}function Lh(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=jt.updateQueue,t===null?(t=si(),jt.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function Ah(e,t,r,a){t.value=r,t.getSnapshot=a,_h(t)&&Dh(e)}function Rh(e,t,r){return r(function(){_h(t)&&Dh(e)})}function _h(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!so(e,r)}catch{return!0}}function Dh(e){var t=Jr(e,2);t!==null&&Zn(t,e,2)}function Dc(e){var t=Un();if(typeof e=="function"){var r=e;if(e=r(),is){st(!0);try{r()}finally{st(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:or,lastRenderedState:e},t}function Bh(e,t,r,a){return e.baseState=r,Rc(e,Jt,typeof a=="function"?a:or)}function mv(e,t,r,a,d){if(ci(e))throw Error(l(485));if(e=t.action,e!==null){var h={payload:d,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(v){h.listeners.push(v)}};_.T!==null?r(!0):h.isTransition=!1,a(h),r=t.pending,r===null?(h.next=t.pending=h,zh(t,h)):(h.next=r.next,t.pending=r.next=h)}}function zh(e,t){var r=t.action,a=t.payload,d=e.state;if(t.isTransition){var h=_.T,v={};_.T=v;try{var M=r(d,a),G=_.S;G!==null&&G(v,M),Hh(e,t,M)}catch(ge){Bc(e,t,ge)}finally{h!==null&&v.types!==null&&(h.types=v.types),_.T=h}}else try{h=r(d,a),Hh(e,t,h)}catch(ge){Bc(e,t,ge)}}function Hh(e,t,r){r!==null&&typeof r=="object"&&typeof r.then=="function"?r.then(function(a){Vh(e,t,a)},function(a){return Bc(e,t,a)}):Vh(e,t,r)}function Vh(e,t,r){t.status="fulfilled",t.value=r,Kh(t),e.state=r,t=e.pending,t!==null&&(r=t.next,r===t?e.pending=null:(r=r.next,t.next=r,zh(e,r)))}function Bc(e,t,r){var a=e.pending;if(e.pending=null,a!==null){a=a.next;do t.status="rejected",t.reason=r,Kh(t),t=t.next;while(t!==a)}e.action=null}function Kh(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function Uh(e,t){return t}function $h(e,t){if(zt){var r=rn.formState;if(r!==null){e:{var a=jt;if(zt){if(an){t:{for(var d=an,h=So;d.nodeType!==8;){if(!h){d=null;break t}if(d=Co(d.nextSibling),d===null){d=null;break t}}h=d.data,d=h==="F!"||h==="F"?d:null}if(d){an=Co(d.nextSibling),a=d.data==="F!";break e}}kr(a)}a=!1}a&&(t=r[0])}}return r=Un(),r.memoizedState=r.baseState=t,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Uh,lastRenderedState:t},r.queue=a,r=im.bind(null,jt,a),a.dispatch=r,a=Dc(!1),h=$c.bind(null,jt,!1,a.queue),a=Un(),d={state:t,dispatch:null,action:e,pending:null},a.queue=d,r=mv.bind(null,jt,d,h,r),d.dispatch=r,a.memoizedState=e,[t,r,!1]}function Fh(e){var t=bn();return qh(t,Jt,e)}function qh(e,t,r){if(t=Rc(e,t,Uh)[0],e=ai(or)[0],typeof t=="object"&&t!==null&&typeof t.then=="function")try{var a=Rl(t)}catch(v){throw v===As?Xa:v}else a=t;t=bn();var d=t.queue,h=d.dispatch;return r!==t.memoizedState&&(jt.flags|=2048,zs(9,{destroy:void 0},gv.bind(null,d,r),null)),[a,h,e]}function gv(e,t){e.action=t}function Wh(e){var t=bn(),r=Jt;if(r!==null)return qh(t,r,e);bn(),t=t.memoizedState,r=bn();var a=r.queue.dispatch;return r.memoizedState=e,[t,a,!1]}function zs(e,t,r,a){return e={tag:e,create:r,deps:a,inst:t,next:null},t=jt.updateQueue,t===null&&(t=si(),jt.updateQueue=t),r=t.lastEffect,r===null?t.lastEffect=e.next=e:(a=r.next,r.next=e,e.next=a,t.lastEffect=e),e}function Gh(){return bn().memoizedState}function ii(e,t,r,a){var d=Un();jt.flags|=e,d.memoizedState=zs(1|t,{destroy:void 0},r,a===void 0?null:a)}function ui(e,t,r,a){var d=bn();a=a===void 0?null:a;var h=d.memoizedState.inst;Jt!==null&&a!==null&&Oc(a,Jt.memoizedState.deps)?d.memoizedState=zs(t,h,r,a):(jt.flags|=e,d.memoizedState=zs(1|t,h,r,a))}function Ph(e,t){ii(8390656,8,e,t)}function zc(e,t){ui(2048,8,e,t)}function yv(e){jt.flags|=4;var t=jt.updateQueue;if(t===null)t=si(),jt.updateQueue=t,t.events=[e];else{var r=t.events;r===null?t.events=[e]:r.push(e)}}function Yh(e){var t=bn().memoizedState;return yv({ref:t,nextImpl:e}),function(){if((Ft&2)!==0)throw Error(l(440));return t.impl.apply(void 0,arguments)}}function Qh(e,t){return ui(4,2,e,t)}function Xh(e,t){return ui(4,4,e,t)}function Zh(e,t){if(typeof t=="function"){e=e();var r=t(e);return function(){typeof r=="function"?r():t(null)}}if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Jh(e,t,r){r=r!=null?r.concat([e]):null,ui(4,4,Zh.bind(null,t,e),r)}function Hc(){}function em(e,t){var r=bn();t=t===void 0?null:t;var a=r.memoizedState;return t!==null&&Oc(t,a[1])?a[0]:(r.memoizedState=[e,t],e)}function tm(e,t){var r=bn();t=t===void 0?null:t;var a=r.memoizedState;if(t!==null&&Oc(t,a[1]))return a[0];if(a=e(),is){st(!0);try{e()}finally{st(!1)}}return r.memoizedState=[a,t],a}function Vc(e,t,r){return r===void 0||(nr&1073741824)!==0&&(Dt&261930)===0?e.memoizedState=t:(e.memoizedState=r,e=ng(),jt.lanes|=e,Rr|=e,r)}function nm(e,t,r,a){return so(r,t)?r:_s.current!==null?(e=Vc(e,r,a),so(e,t)||(Cn=!0),e):(nr&42)===0||(nr&1073741824)!==0&&(Dt&261930)===0?(Cn=!0,e.memoizedState=r):(e=ng(),jt.lanes|=e,Rr|=e,t)}function om(e,t,r,a,d){var h=se.p;se.p=h!==0&&8>h?h:8;var v=_.T,M={};_.T=M,$c(e,!1,t,r);try{var G=d(),ge=_.S;if(ge!==null&&ge(M,G),G!==null&&typeof G=="object"&&typeof G.then=="function"){var Be=fv(G,a);_l(e,t,Be,fo(e))}else _l(e,t,a,fo(e))}catch(Ve){_l(e,t,{then:function(){},status:"rejected",reason:Ve},fo())}finally{se.p=h,v!==null&&M.types!==null&&(v.types=M.types),_.T=v}}function bv(){}function Kc(e,t,r,a){if(e.tag!==5)throw Error(l(476));var d=rm(e).queue;om(e,d,t,ce,r===null?bv:function(){return sm(e),r(a)})}function rm(e){var t=e.memoizedState;if(t!==null)return t;t={memoizedState:ce,baseState:ce,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:or,lastRenderedState:ce},next:null};var r={};return t.next={memoizedState:r,baseState:r,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:or,lastRenderedState:r},next:null},e.memoizedState=t,e=e.alternate,e!==null&&(e.memoizedState=t),t}function sm(e){var t=rm(e);t.next===null&&(t=e.alternate.memoizedState),_l(e,t.next.queue,{},fo())}function Uc(){return An(Zl)}function lm(){return bn().memoizedState}function am(){return bn().memoizedState}function xv(e){for(var t=e.return;t!==null;){switch(t.tag){case 24:case 3:var r=fo();e=Or(r);var a=Tr(t,e,r);a!==null&&(Zn(a,t,r),El(a,t,r)),t={cache:yc()},e.payload=t;return}t=t.return}}function vv(e,t,r){var a=fo();r={lane:a,revertLane:0,gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null},ci(e)?um(t,r):(r=lc(e,t,r,a),r!==null&&(Zn(r,e,a),cm(r,t,a)))}function im(e,t,r){var a=fo();_l(e,t,r,a)}function _l(e,t,r,a){var d={lane:a,revertLane:0,gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null};if(ci(e))um(t,d);else{var h=e.alternate;if(e.lanes===0&&(h===null||h.lanes===0)&&(h=t.lastRenderedReducer,h!==null))try{var v=t.lastRenderedState,M=h(v,r);if(d.hasEagerState=!0,d.eagerState=M,so(M,v))return Fa(e,t,d,0),rn===null&&$a(),!1}catch{}if(r=lc(e,t,d,a),r!==null)return Zn(r,e,a),cm(r,t,a),!0}return!1}function $c(e,t,r,a){if(a={lane:2,revertLane:wd(),gesture:null,action:a,hasEagerState:!1,eagerState:null,next:null},ci(e)){if(t)throw Error(l(479))}else t=lc(e,r,a,2),t!==null&&Zn(t,e,2)}function ci(e){var t=e.alternate;return e===jt||t!==null&&t===jt}function um(e,t){Ds=oi=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function cm(e,t,r){if((r&4194048)!==0){var a=t.lanes;a&=e.pendingLanes,r|=a,t.lanes=r,pt(e,r)}}var Dl={readContext:An,use:li,useCallback:hn,useContext:hn,useEffect:hn,useImperativeHandle:hn,useLayoutEffect:hn,useInsertionEffect:hn,useMemo:hn,useReducer:hn,useRef:hn,useState:hn,useDebugValue:hn,useDeferredValue:hn,useTransition:hn,useSyncExternalStore:hn,useId:hn,useHostTransitionStatus:hn,useFormState:hn,useActionState:hn,useOptimistic:hn,useMemoCache:hn,useCacheRefresh:hn};Dl.useEffectEvent=hn;var dm={readContext:An,use:li,useCallback:function(e,t){return Un().memoizedState=[e,t===void 0?null:t],e},useContext:An,useEffect:Ph,useImperativeHandle:function(e,t,r){r=r!=null?r.concat([e]):null,ii(4194308,4,Zh.bind(null,t,e),r)},useLayoutEffect:function(e,t){return ii(4194308,4,e,t)},useInsertionEffect:function(e,t){ii(4,2,e,t)},useMemo:function(e,t){var r=Un();t=t===void 0?null:t;var a=e();if(is){st(!0);try{e()}finally{st(!1)}}return r.memoizedState=[a,t],a},useReducer:function(e,t,r){var a=Un();if(r!==void 0){var d=r(t);if(is){st(!0);try{r(t)}finally{st(!1)}}}else d=t;return a.memoizedState=a.baseState=d,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:d},a.queue=e,e=e.dispatch=vv.bind(null,jt,e),[a.memoizedState,e]},useRef:function(e){var t=Un();return e={current:e},t.memoizedState=e},useState:function(e){e=Dc(e);var t=e.queue,r=im.bind(null,jt,t);return t.dispatch=r,[e.memoizedState,r]},useDebugValue:Hc,useDeferredValue:function(e,t){var r=Un();return Vc(r,e,t)},useTransition:function(){var e=Dc(!1);return e=om.bind(null,jt,e.queue,!0,!1),Un().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,r){var a=jt,d=Un();if(zt){if(r===void 0)throw Error(l(407));r=r()}else{if(r=t(),rn===null)throw Error(l(349));(Dt&127)!==0||Lh(a,t,r)}d.memoizedState=r;var h={value:r,getSnapshot:t};return d.queue=h,Ph(Rh.bind(null,a,h,e),[e]),a.flags|=2048,zs(9,{destroy:void 0},Ah.bind(null,a,h,r,t),null),r},useId:function(){var e=Un(),t=rn.identifierPrefix;if(zt){var r=Vo,a=Ho;r=(a&~(1<<32-ft(a)-1)).toString(32)+r,t="_"+t+"R_"+r,r=ri++,0<r&&(t+="H"+r.toString(32)),t+="_"}else r=pv++,t="_"+t+"r_"+r.toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:Uc,useFormState:$h,useActionState:$h,useOptimistic:function(e){var t=Un();t.memoizedState=t.baseState=e;var r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=r,t=$c.bind(null,jt,!0,r),r.dispatch=t,[e,t]},useMemoCache:Ac,useCacheRefresh:function(){return Un().memoizedState=xv.bind(null,jt)},useEffectEvent:function(e){var t=Un(),r={impl:e};return t.memoizedState=r,function(){if((Ft&2)!==0)throw Error(l(440));return r.impl.apply(void 0,arguments)}}},Fc={readContext:An,use:li,useCallback:em,useContext:An,useEffect:zc,useImperativeHandle:Jh,useInsertionEffect:Qh,useLayoutEffect:Xh,useMemo:tm,useReducer:ai,useRef:Gh,useState:function(){return ai(or)},useDebugValue:Hc,useDeferredValue:function(e,t){var r=bn();return nm(r,Jt.memoizedState,e,t)},useTransition:function(){var e=ai(or)[0],t=bn().memoizedState;return[typeof e=="boolean"?e:Rl(e),t]},useSyncExternalStore:Ih,useId:lm,useHostTransitionStatus:Uc,useFormState:Fh,useActionState:Fh,useOptimistic:function(e,t){var r=bn();return Bh(r,Jt,e,t)},useMemoCache:Ac,useCacheRefresh:am};Fc.useEffectEvent=Yh;var fm={readContext:An,use:li,useCallback:em,useContext:An,useEffect:zc,useImperativeHandle:Jh,useInsertionEffect:Qh,useLayoutEffect:Xh,useMemo:tm,useReducer:_c,useRef:Gh,useState:function(){return _c(or)},useDebugValue:Hc,useDeferredValue:function(e,t){var r=bn();return Jt===null?Vc(r,e,t):nm(r,Jt.memoizedState,e,t)},useTransition:function(){var e=_c(or)[0],t=bn().memoizedState;return[typeof e=="boolean"?e:Rl(e),t]},useSyncExternalStore:Ih,useId:lm,useHostTransitionStatus:Uc,useFormState:Wh,useActionState:Wh,useOptimistic:function(e,t){var r=bn();return Jt!==null?Bh(r,Jt,e,t):(r.baseState=e,[e,r.queue.dispatch])},useMemoCache:Ac,useCacheRefresh:am};fm.useEffectEvent=Yh;function qc(e,t,r,a){t=e.memoizedState,r=r(a,t),r=r==null?t:x({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Wc={enqueueSetState:function(e,t,r){e=e._reactInternals;var a=fo(),d=Or(a);d.payload=t,r!=null&&(d.callback=r),t=Tr(e,d,a),t!==null&&(Zn(t,e,a),El(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var a=fo(),d=Or(a);d.tag=1,d.payload=t,r!=null&&(d.callback=r),t=Tr(e,d,a),t!==null&&(Zn(t,e,a),El(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=fo(),a=Or(r);a.tag=2,t!=null&&(a.callback=t),t=Tr(e,a,r),t!==null&&(Zn(t,e,r),El(t,e,r))}};function pm(e,t,r,a,d,h,v){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(a,h,v):t.prototype&&t.prototype.isPureReactComponent?!Sl(r,a)||!Sl(d,h):!0}function hm(e,t,r,a){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,a),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,a),t.state!==e&&Wc.enqueueReplaceState(t,t.state,null)}function us(e,t){var r=t;if("ref"in t){r={};for(var a in t)a!=="ref"&&(r[a]=t[a])}if(e=e.defaultProps){r===t&&(r=x({},r));for(var d in e)r[d]===void 0&&(r[d]=e[d])}return r}function mm(e){Ua(e)}function gm(e){console.error(e)}function ym(e){Ua(e)}function di(e,t){try{var r=e.onUncaughtError;r(t.value,{componentStack:t.stack})}catch(a){setTimeout(function(){throw a})}}function bm(e,t,r){try{var a=e.onCaughtError;a(r.value,{componentStack:r.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(d){setTimeout(function(){throw d})}}function Gc(e,t,r){return r=Or(r),r.tag=3,r.payload={element:null},r.callback=function(){di(e,t)},r}function xm(e){return e=Or(e),e.tag=3,e}function vm(e,t,r,a){var d=r.type.getDerivedStateFromError;if(typeof d=="function"){var h=a.value;e.payload=function(){return d(h)},e.callback=function(){bm(t,r,a)}}var v=r.stateNode;v!==null&&typeof v.componentDidCatch=="function"&&(e.callback=function(){bm(t,r,a),typeof d!="function"&&(_r===null?_r=new Set([this]):_r.add(this));var M=a.stack;this.componentDidCatch(a.value,{componentStack:M!==null?M:""})})}function wv(e,t,r,a,d){if(r.flags|=32768,a!==null&&typeof a=="object"&&typeof a.then=="function"){if(t=r.alternate,t!==null&&Es(t,r,d,!0),r=ao.current,r!==null){switch(r.tag){case 31:case 13:return No===null?Ni():r.alternate===null&&mn===0&&(mn=3),r.flags&=-257,r.flags|=65536,r.lanes=d,a===Za?r.flags|=16384:(t=r.updateQueue,t===null?r.updateQueue=new Set([a]):t.add(a),bd(e,a,d)),!1;case 22:return r.flags|=65536,a===Za?r.flags|=16384:(t=r.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([a])},r.updateQueue=t):(r=t.retryQueue,r===null?t.retryQueue=new Set([a]):r.add(a)),bd(e,a,d)),!1}throw Error(l(435,r.tag))}return bd(e,a,d),Ni(),!1}if(zt)return t=ao.current,t!==null?((t.flags&65536)===0&&(t.flags|=256),t.flags|=65536,t.lanes=d,a!==fc&&(e=Error(l(422),{cause:a}),kl(xo(e,r)))):(a!==fc&&(t=Error(l(423),{cause:a}),kl(xo(t,r))),e=e.current.alternate,e.flags|=65536,d&=-d,e.lanes|=d,a=xo(a,r),d=Gc(e.stateNode,a,d),Nc(e,d),mn!==4&&(mn=2)),!1;var h=Error(l(520),{cause:a});if(h=xo(h,r),Fl===null?Fl=[h]:Fl.push(h),mn!==4&&(mn=2),t===null)return!0;a=xo(a,r),r=t;do{switch(r.tag){case 3:return r.flags|=65536,e=d&-d,r.lanes|=e,e=Gc(r.stateNode,a,e),Nc(r,e),!1;case 1:if(t=r.type,h=r.stateNode,(r.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||h!==null&&typeof h.componentDidCatch=="function"&&(_r===null||!_r.has(h))))return r.flags|=65536,d&=-d,r.lanes|=d,d=xm(d),vm(d,e,r,a),Nc(r,d),!1}r=r.return}while(r!==null);return!1}var Pc=Error(l(461)),Cn=!1;function Rn(e,t,r,a){t.child=e===null?Ch(t,null,r,a):as(t,e.child,r,a)}function wm(e,t,r,a,d){r=r.render;var h=t.ref;if("ref"in a){var v={};for(var M in a)M!=="ref"&&(v[M]=a[M])}else v=a;return os(t),a=Tc(e,t,r,v,h,d),M=Ec(),e!==null&&!Cn?(Ic(e,t,d),rr(e,t,d)):(zt&&M&&cc(t),t.flags|=1,Rn(e,t,a,d),t.child)}function Sm(e,t,r,a,d){if(e===null){var h=r.type;return typeof h=="function"&&!ac(h)&&h.defaultProps===void 0&&r.compare===null?(t.tag=15,t.type=h,Nm(e,t,h,a,d)):(e=Wa(r.type,null,a,t,t.mode,d),e.ref=t.ref,e.return=t,t.child=e)}if(h=e.child,!nd(e,d)){var v=h.memoizedProps;if(r=r.compare,r=r!==null?r:Sl,r(v,a)&&e.ref===t.ref)return rr(e,t,d)}return t.flags|=1,e=Zo(h,a),e.ref=t.ref,e.return=t,t.child=e}function Nm(e,t,r,a,d){if(e!==null){var h=e.memoizedProps;if(Sl(h,a)&&e.ref===t.ref)if(Cn=!1,t.pendingProps=a=h,nd(e,d))(e.flags&131072)!==0&&(Cn=!0);else return t.lanes=e.lanes,rr(e,t,d)}return Yc(e,t,r,a,d)}function Cm(e,t,r,a){var d=a.children,h=e!==null?e.memoizedState:null;if(e===null&&t.stateNode===null&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.mode==="hidden"){if((t.flags&128)!==0){if(h=h!==null?h.baseLanes|r:r,e!==null){for(a=t.child=e.child,d=0;a!==null;)d=d|a.lanes|a.childLanes,a=a.sibling;a=d&~h}else a=0,t.child=null;return km(e,t,h,r,a)}if((r&536870912)!==0)t.memoizedState={baseLanes:0,cachePool:null},e!==null&&Qa(t,h!==null?h.cachePool:null),h!==null?Mh(t,h):kc(),Oh(t);else return a=t.lanes=536870912,km(e,t,h!==null?h.baseLanes|r:r,r,a)}else h!==null?(Qa(t,h.cachePool),Mh(t,h),Ir(),t.memoizedState=null):(e!==null&&Qa(t,null),kc(),Ir());return Rn(e,t,d,r),t.child}function Bl(e,t){return e!==null&&e.tag===22||t.stateNode!==null||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function km(e,t,r,a,d){var h=xc();return h=h===null?null:{parent:Sn._currentValue,pool:h},t.memoizedState={baseLanes:r,cachePool:h},e!==null&&Qa(t,null),kc(),Oh(t),e!==null&&Es(e,t,a,!0),t.childLanes=d,null}function fi(e,t){return t=hi({mode:t.mode,children:t.children},e.mode),t.ref=e.ref,e.child=t,t.return=e,t}function jm(e,t,r){return as(t,e.child,null,r),e=fi(t,t.pendingProps),e.flags|=2,io(t),t.memoizedState=null,e}function Sv(e,t,r){var a=t.pendingProps,d=(t.flags&128)!==0;if(t.flags&=-129,e===null){if(zt){if(a.mode==="hidden")return e=fi(t,a),t.lanes=536870912,Bl(null,e);if(Mc(t),(e=an)?(e=zg(e,So),e=e!==null&&e.data==="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:Nr!==null?{id:Ho,overflow:Vo}:null,retryLane:536870912,hydrationErrors:null},r=uh(e),r.return=t,t.child=r,Ln=t,an=null)):e=null,e===null)throw kr(t);return t.lanes=536870912,null}return fi(t,a)}var h=e.memoizedState;if(h!==null){var v=h.dehydrated;if(Mc(t),d)if(t.flags&256)t.flags&=-257,t=jm(e,t,r);else if(t.memoizedState!==null)t.child=e.child,t.flags|=128,t=null;else throw Error(l(558));else if(Cn||Es(e,t,r,!1),d=(r&e.childLanes)!==0,Cn||d){if(a=rn,a!==null&&(v=St(a,r),v!==0&&v!==h.retryLane))throw h.retryLane=v,Jr(e,v),Zn(a,e,v),Pc;Ni(),t=jm(e,t,r)}else e=h.treeContext,an=Co(v.nextSibling),Ln=t,zt=!0,Cr=null,So=!1,e!==null&&fh(t,e),t=fi(t,a),t.flags|=4096;return t}return e=Zo(e.child,{mode:a.mode,children:a.children}),e.ref=t.ref,t.child=e,e.return=t,e}function pi(e,t){var r=t.ref;if(r===null)e!==null&&e.ref!==null&&(t.flags|=4194816);else{if(typeof r!="function"&&typeof r!="object")throw Error(l(284));(e===null||e.ref!==r)&&(t.flags|=4194816)}}function Yc(e,t,r,a,d){return os(t),r=Tc(e,t,r,a,void 0,d),a=Ec(),e!==null&&!Cn?(Ic(e,t,d),rr(e,t,d)):(zt&&a&&cc(t),t.flags|=1,Rn(e,t,r,d),t.child)}function Mm(e,t,r,a,d,h){return os(t),t.updateQueue=null,r=Eh(t,a,r,d),Th(e),a=Ec(),e!==null&&!Cn?(Ic(e,t,h),rr(e,t,h)):(zt&&a&&cc(t),t.flags|=1,Rn(e,t,r,h),t.child)}function Om(e,t,r,a,d){if(os(t),t.stateNode===null){var h=js,v=r.contextType;typeof v=="object"&&v!==null&&(h=An(v)),h=new r(a,h),t.memoizedState=h.state!==null&&h.state!==void 0?h.state:null,h.updater=Wc,t.stateNode=h,h._reactInternals=t,h=t.stateNode,h.props=a,h.state=t.memoizedState,h.refs={},wc(t),v=r.contextType,h.context=typeof v=="object"&&v!==null?An(v):js,h.state=t.memoizedState,v=r.getDerivedStateFromProps,typeof v=="function"&&(qc(t,r,v,a),h.state=t.memoizedState),typeof r.getDerivedStateFromProps=="function"||typeof h.getSnapshotBeforeUpdate=="function"||typeof h.UNSAFE_componentWillMount!="function"&&typeof h.componentWillMount!="function"||(v=h.state,typeof h.componentWillMount=="function"&&h.componentWillMount(),typeof h.UNSAFE_componentWillMount=="function"&&h.UNSAFE_componentWillMount(),v!==h.state&&Wc.enqueueReplaceState(h,h.state,null),Ll(t,a,h,d),Il(),h.state=t.memoizedState),typeof h.componentDidMount=="function"&&(t.flags|=4194308),a=!0}else if(e===null){h=t.stateNode;var M=t.memoizedProps,G=us(r,M);h.props=G;var ge=h.context,Be=r.contextType;v=js,typeof Be=="object"&&Be!==null&&(v=An(Be));var Ve=r.getDerivedStateFromProps;Be=typeof Ve=="function"||typeof h.getSnapshotBeforeUpdate=="function",M=t.pendingProps!==M,Be||typeof h.UNSAFE_componentWillReceiveProps!="function"&&typeof h.componentWillReceiveProps!="function"||(M||ge!==v)&&hm(t,h,a,v),Mr=!1;var ve=t.memoizedState;h.state=ve,Ll(t,a,h,d),Il(),ge=t.memoizedState,M||ve!==ge||Mr?(typeof Ve=="function"&&(qc(t,r,Ve,a),ge=t.memoizedState),(G=Mr||pm(t,r,G,a,ve,ge,v))?(Be||typeof h.UNSAFE_componentWillMount!="function"&&typeof h.componentWillMount!="function"||(typeof h.componentWillMount=="function"&&h.componentWillMount(),typeof h.UNSAFE_componentWillMount=="function"&&h.UNSAFE_componentWillMount()),typeof h.componentDidMount=="function"&&(t.flags|=4194308)):(typeof h.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=a,t.memoizedState=ge),h.props=a,h.state=ge,h.context=v,a=G):(typeof h.componentDidMount=="function"&&(t.flags|=4194308),a=!1)}else{h=t.stateNode,Sc(e,t),v=t.memoizedProps,Be=us(r,v),h.props=Be,Ve=t.pendingProps,ve=h.context,ge=r.contextType,G=js,typeof ge=="object"&&ge!==null&&(G=An(ge)),M=r.getDerivedStateFromProps,(ge=typeof M=="function"||typeof h.getSnapshotBeforeUpdate=="function")||typeof h.UNSAFE_componentWillReceiveProps!="function"&&typeof h.componentWillReceiveProps!="function"||(v!==Ve||ve!==G)&&hm(t,h,a,G),Mr=!1,ve=t.memoizedState,h.state=ve,Ll(t,a,h,d),Il();var Te=t.memoizedState;v!==Ve||ve!==Te||Mr||e!==null&&e.dependencies!==null&&Pa(e.dependencies)?(typeof M=="function"&&(qc(t,r,M,a),Te=t.memoizedState),(Be=Mr||pm(t,r,Be,a,ve,Te,G)||e!==null&&e.dependencies!==null&&Pa(e.dependencies))?(ge||typeof h.UNSAFE_componentWillUpdate!="function"&&typeof h.componentWillUpdate!="function"||(typeof h.componentWillUpdate=="function"&&h.componentWillUpdate(a,Te,G),typeof h.UNSAFE_componentWillUpdate=="function"&&h.UNSAFE_componentWillUpdate(a,Te,G)),typeof h.componentDidUpdate=="function"&&(t.flags|=4),typeof h.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof h.componentDidUpdate!="function"||v===e.memoizedProps&&ve===e.memoizedState||(t.flags|=4),typeof h.getSnapshotBeforeUpdate!="function"||v===e.memoizedProps&&ve===e.memoizedState||(t.flags|=1024),t.memoizedProps=a,t.memoizedState=Te),h.props=a,h.state=Te,h.context=G,a=Be):(typeof h.componentDidUpdate!="function"||v===e.memoizedProps&&ve===e.memoizedState||(t.flags|=4),typeof h.getSnapshotBeforeUpdate!="function"||v===e.memoizedProps&&ve===e.memoizedState||(t.flags|=1024),a=!1)}return h=a,pi(e,t),a=(t.flags&128)!==0,h||a?(h=t.stateNode,r=a&&typeof r.getDerivedStateFromError!="function"?null:h.render(),t.flags|=1,e!==null&&a?(t.child=as(t,e.child,null,d),t.child=as(t,null,r,d)):Rn(e,t,r,d),t.memoizedState=h.state,e=t.child):e=rr(e,t,d),e}function Tm(e,t,r,a){return ts(),t.flags|=256,Rn(e,t,r,a),t.child}var Qc={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Xc(e){return{baseLanes:e,cachePool:bh()}}function Zc(e,t,r){return e=e!==null?e.childLanes&~r:0,t&&(e|=co),e}function Em(e,t,r){var a=t.pendingProps,d=!1,h=(t.flags&128)!==0,v;if((v=h)||(v=e!==null&&e.memoizedState===null?!1:(yn.current&2)!==0),v&&(d=!0,t.flags&=-129),v=(t.flags&32)!==0,t.flags&=-33,e===null){if(zt){if(d?Er(t):Ir(),(e=an)?(e=zg(e,So),e=e!==null&&e.data!=="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:Nr!==null?{id:Ho,overflow:Vo}:null,retryLane:536870912,hydrationErrors:null},r=uh(e),r.return=t,t.child=r,Ln=t,an=null)):e=null,e===null)throw kr(t);return Rd(e)?t.lanes=32:t.lanes=536870912,null}var M=a.children;return a=a.fallback,d?(Ir(),d=t.mode,M=hi({mode:"hidden",children:M},d),a=es(a,d,r,null),M.return=t,a.return=t,M.sibling=a,t.child=M,a=t.child,a.memoizedState=Xc(r),a.childLanes=Zc(e,v,r),t.memoizedState=Qc,Bl(null,a)):(Er(t),Jc(t,M))}var G=e.memoizedState;if(G!==null&&(M=G.dehydrated,M!==null)){if(h)t.flags&256?(Er(t),t.flags&=-257,t=ed(e,t,r)):t.memoizedState!==null?(Ir(),t.child=e.child,t.flags|=128,t=null):(Ir(),M=a.fallback,d=t.mode,a=hi({mode:"visible",children:a.children},d),M=es(M,d,r,null),M.flags|=2,a.return=t,M.return=t,a.sibling=M,t.child=a,as(t,e.child,null,r),a=t.child,a.memoizedState=Xc(r),a.childLanes=Zc(e,v,r),t.memoizedState=Qc,t=Bl(null,a));else if(Er(t),Rd(M)){if(v=M.nextSibling&&M.nextSibling.dataset,v)var ge=v.dgst;v=ge,a=Error(l(419)),a.stack="",a.digest=v,kl({value:a,source:null,stack:null}),t=ed(e,t,r)}else if(Cn||Es(e,t,r,!1),v=(r&e.childLanes)!==0,Cn||v){if(v=rn,v!==null&&(a=St(v,r),a!==0&&a!==G.retryLane))throw G.retryLane=a,Jr(e,a),Zn(v,e,a),Pc;Ad(M)||Ni(),t=ed(e,t,r)}else Ad(M)?(t.flags|=192,t.child=e.child,t=null):(e=G.treeContext,an=Co(M.nextSibling),Ln=t,zt=!0,Cr=null,So=!1,e!==null&&fh(t,e),t=Jc(t,a.children),t.flags|=4096);return t}return d?(Ir(),M=a.fallback,d=t.mode,G=e.child,ge=G.sibling,a=Zo(G,{mode:"hidden",children:a.children}),a.subtreeFlags=G.subtreeFlags&65011712,ge!==null?M=Zo(ge,M):(M=es(M,d,r,null),M.flags|=2),M.return=t,a.return=t,a.sibling=M,t.child=a,Bl(null,a),a=t.child,M=e.child.memoizedState,M===null?M=Xc(r):(d=M.cachePool,d!==null?(G=Sn._currentValue,d=d.parent!==G?{parent:G,pool:G}:d):d=bh(),M={baseLanes:M.baseLanes|r,cachePool:d}),a.memoizedState=M,a.childLanes=Zc(e,v,r),t.memoizedState=Qc,Bl(e.child,a)):(Er(t),r=e.child,e=r.sibling,r=Zo(r,{mode:"visible",children:a.children}),r.return=t,r.sibling=null,e!==null&&(v=t.deletions,v===null?(t.deletions=[e],t.flags|=16):v.push(e)),t.child=r,t.memoizedState=null,r)}function Jc(e,t){return t=hi({mode:"visible",children:t},e.mode),t.return=e,e.child=t}function hi(e,t){return e=lo(22,e,null,t),e.lanes=0,e}function ed(e,t,r){return as(t,e.child,null,r),e=Jc(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Im(e,t,r){e.lanes|=t;var a=e.alternate;a!==null&&(a.lanes|=t),mc(e.return,t,r)}function td(e,t,r,a,d,h){var v=e.memoizedState;v===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:a,tail:r,tailMode:d,treeForkCount:h}:(v.isBackwards=t,v.rendering=null,v.renderingStartTime=0,v.last=a,v.tail=r,v.tailMode=d,v.treeForkCount=h)}function Lm(e,t,r){var a=t.pendingProps,d=a.revealOrder,h=a.tail;a=a.children;var v=yn.current,M=(v&2)!==0;if(M?(v=v&1|2,t.flags|=128):v&=1,O(yn,v),Rn(e,t,a,r),a=zt?Cl:0,!M&&e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Im(e,r,t);else if(e.tag===19)Im(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(d){case"forwards":for(r=t.child,d=null;r!==null;)e=r.alternate,e!==null&&ni(e)===null&&(d=r),r=r.sibling;r=d,r===null?(d=t.child,t.child=null):(d=r.sibling,r.sibling=null),td(t,!1,d,r,h,a);break;case"backwards":case"unstable_legacy-backwards":for(r=null,d=t.child,t.child=null;d!==null;){if(e=d.alternate,e!==null&&ni(e)===null){t.child=d;break}e=d.sibling,d.sibling=r,r=d,d=e}td(t,!0,r,null,h,a);break;case"together":td(t,!1,null,null,void 0,a);break;default:t.memoizedState=null}return t.child}function rr(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Rr|=t.lanes,(r&t.childLanes)===0)if(e!==null){if(Es(e,t,r,!1),(r&t.childLanes)===0)return null}else return null;if(e!==null&&t.child!==e.child)throw Error(l(153));if(t.child!==null){for(e=t.child,r=Zo(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Zo(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function nd(e,t){return(e.lanes&t)!==0?!0:(e=e.dependencies,!!(e!==null&&Pa(e)))}function Nv(e,t,r){switch(t.tag){case 3:Se(t,t.stateNode.containerInfo),jr(t,Sn,e.memoizedState.cache),ts();break;case 27:case 5:P(t);break;case 4:Se(t,t.stateNode.containerInfo);break;case 10:jr(t,t.type,t.memoizedProps.value);break;case 31:if(t.memoizedState!==null)return t.flags|=128,Mc(t),null;break;case 13:var a=t.memoizedState;if(a!==null)return a.dehydrated!==null?(Er(t),t.flags|=128,null):(r&t.child.childLanes)!==0?Em(e,t,r):(Er(t),e=rr(e,t,r),e!==null?e.sibling:null);Er(t);break;case 19:var d=(e.flags&128)!==0;if(a=(r&t.childLanes)!==0,a||(Es(e,t,r,!1),a=(r&t.childLanes)!==0),d){if(a)return Lm(e,t,r);t.flags|=128}if(d=t.memoizedState,d!==null&&(d.rendering=null,d.tail=null,d.lastEffect=null),O(yn,yn.current),a)break;return null;case 22:return t.lanes=0,Cm(e,t,r,t.pendingProps);case 24:jr(t,Sn,e.memoizedState.cache)}return rr(e,t,r)}function Am(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps)Cn=!0;else{if(!nd(e,r)&&(t.flags&128)===0)return Cn=!1,Nv(e,t,r);Cn=(e.flags&131072)!==0}else Cn=!1,zt&&(t.flags&1048576)!==0&&dh(t,Cl,t.index);switch(t.lanes=0,t.tag){case 16:e:{var a=t.pendingProps;if(e=ss(t.elementType),t.type=e,typeof e=="function")ac(e)?(a=us(e,a),t.tag=1,t=Om(null,t,e,a,r)):(t.tag=0,t=Yc(null,t,e,a,r));else{if(e!=null){var d=e.$$typeof;if(d===U){t.tag=11,t=wm(null,t,e,a,r);break e}else if(d===L){t.tag=14,t=Sm(null,t,e,a,r);break e}}throw t=Ie(e)||e,Error(l(306,t,""))}}return t;case 0:return Yc(e,t,t.type,t.pendingProps,r);case 1:return a=t.type,d=us(a,t.pendingProps),Om(e,t,a,d,r);case 3:e:{if(Se(t,t.stateNode.containerInfo),e===null)throw Error(l(387));a=t.pendingProps;var h=t.memoizedState;d=h.element,Sc(e,t),Ll(t,a,null,r);var v=t.memoizedState;if(a=v.cache,jr(t,Sn,a),a!==h.cache&&gc(t,[Sn],r,!0),Il(),a=v.element,h.isDehydrated)if(h={element:a,isDehydrated:!1,cache:v.cache},t.updateQueue.baseState=h,t.memoizedState=h,t.flags&256){t=Tm(e,t,a,r);break e}else if(a!==d){d=xo(Error(l(424)),t),kl(d),t=Tm(e,t,a,r);break e}else for(e=t.stateNode.containerInfo,e.nodeType===9?e=e.body:e=e.nodeName==="HTML"?e.ownerDocument.body:e,an=Co(e.firstChild),Ln=t,zt=!0,Cr=null,So=!0,r=Ch(t,null,a,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(ts(),a===d){t=rr(e,t,r);break e}Rn(e,t,a,r)}t=t.child}return t;case 26:return pi(e,t),e===null?(r=Fg(t.type,null,t.pendingProps,null))?t.memoizedState=r:zt||(r=t.type,e=t.pendingProps,a=Ei(We.current).createElement(r),a[Gt]=t,a[It]=e,_n(a,r,e),Qe(a),t.stateNode=a):t.memoizedState=Fg(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return P(t),e===null&&zt&&(a=t.stateNode=Kg(t.type,t.pendingProps,We.current),Ln=t,So=!0,d=an,Hr(t.type)?(_d=d,an=Co(a.firstChild)):an=d),Rn(e,t,t.pendingProps.children,r),pi(e,t),e===null&&(t.flags|=4194304),t.child;case 5:return e===null&&zt&&((d=a=an)&&(a=Jv(a,t.type,t.pendingProps,So),a!==null?(t.stateNode=a,Ln=t,an=Co(a.firstChild),So=!1,d=!0):d=!1),d||kr(t)),P(t),d=t.type,h=t.pendingProps,v=e!==null?e.memoizedProps:null,a=h.children,Ed(d,h)?a=null:v!==null&&Ed(d,v)&&(t.flags|=32),t.memoizedState!==null&&(d=Tc(e,t,hv,null,null,r),Zl._currentValue=d),pi(e,t),Rn(e,t,a,r),t.child;case 6:return e===null&&zt&&((e=r=an)&&(r=e1(r,t.pendingProps,So),r!==null?(t.stateNode=r,Ln=t,an=null,e=!0):e=!1),e||kr(t)),null;case 13:return Em(e,t,r);case 4:return Se(t,t.stateNode.containerInfo),a=t.pendingProps,e===null?t.child=as(t,null,a,r):Rn(e,t,a,r),t.child;case 11:return wm(e,t,t.type,t.pendingProps,r);case 7:return Rn(e,t,t.pendingProps,r),t.child;case 8:return Rn(e,t,t.pendingProps.children,r),t.child;case 12:return Rn(e,t,t.pendingProps.children,r),t.child;case 10:return a=t.pendingProps,jr(t,t.type,a.value),Rn(e,t,a.children,r),t.child;case 9:return d=t.type._context,a=t.pendingProps.children,os(t),d=An(d),a=a(d),t.flags|=1,Rn(e,t,a,r),t.child;case 14:return Sm(e,t,t.type,t.pendingProps,r);case 15:return Nm(e,t,t.type,t.pendingProps,r);case 19:return Lm(e,t,r);case 31:return Sv(e,t,r);case 22:return Cm(e,t,r,t.pendingProps);case 24:return os(t),a=An(Sn),e===null?(d=xc(),d===null&&(d=rn,h=yc(),d.pooledCache=h,h.refCount++,h!==null&&(d.pooledCacheLanes|=r),d=h),t.memoizedState={parent:a,cache:d},wc(t),jr(t,Sn,d)):((e.lanes&r)!==0&&(Sc(e,t),Ll(t,null,null,r),Il()),d=e.memoizedState,h=t.memoizedState,d.parent!==a?(d={parent:a,cache:a},t.memoizedState=d,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=d),jr(t,Sn,a)):(a=h.cache,jr(t,Sn,a),a!==d.cache&&gc(t,[Sn],r,!0))),Rn(e,t,t.pendingProps.children,r),t.child;case 29:throw t.pendingProps}throw Error(l(156,t.tag))}function sr(e){e.flags|=4}function od(e,t,r,a,d){if((t=(e.mode&32)!==0)&&(t=!1),t){if(e.flags|=16777216,(d&335544128)===d)if(e.stateNode.complete)e.flags|=8192;else if(lg())e.flags|=8192;else throw ls=Za,vc}else e.flags&=-16777217}function Rm(e,t){if(t.type!=="stylesheet"||(t.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!Yg(t))if(lg())e.flags|=8192;else throw ls=Za,vc}function mi(e,t){t!==null&&(e.flags|=4),e.flags&16384&&(t=e.tag!==22?it():536870912,e.lanes|=t,Us|=t)}function zl(e,t){if(!zt)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var a=null;r!==null;)r.alternate!==null&&(a=r),r=r.sibling;a===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:a.sibling=null}}function un(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,a=0;if(t)for(var d=e.child;d!==null;)r|=d.lanes|d.childLanes,a|=d.subtreeFlags&65011712,a|=d.flags&65011712,d.return=e,d=d.sibling;else for(d=e.child;d!==null;)r|=d.lanes|d.childLanes,a|=d.subtreeFlags,a|=d.flags,d.return=e,d=d.sibling;return e.subtreeFlags|=a,e.childLanes=r,t}function Cv(e,t,r){var a=t.pendingProps;switch(dc(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return un(t),null;case 1:return un(t),null;case 3:return r=t.stateNode,a=null,e!==null&&(a=e.memoizedState.cache),t.memoizedState.cache!==a&&(t.flags|=2048),tr(Sn),H(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(Ts(t)?sr(t):e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,pc())),un(t),null;case 26:var d=t.type,h=t.memoizedState;return e===null?(sr(t),h!==null?(un(t),Rm(t,h)):(un(t),od(t,d,null,a,r))):h?h!==e.memoizedState?(sr(t),un(t),Rm(t,h)):(un(t),t.flags&=-16777217):(e=e.memoizedProps,e!==a&&sr(t),un(t),od(t,d,e,a,r)),null;case 27:if(D(t),r=We.current,d=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==a&&sr(t);else{if(!a){if(t.stateNode===null)throw Error(l(166));return un(t),null}e=te.current,Ts(t)?ph(t):(e=Kg(d,a,r),t.stateNode=e,sr(t))}return un(t),null;case 5:if(D(t),d=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==a&&sr(t);else{if(!a){if(t.stateNode===null)throw Error(l(166));return un(t),null}if(h=te.current,Ts(t))ph(t);else{var v=Ei(We.current);switch(h){case 1:h=v.createElementNS("http://www.w3.org/2000/svg",d);break;case 2:h=v.createElementNS("http://www.w3.org/1998/Math/MathML",d);break;default:switch(d){case"svg":h=v.createElementNS("http://www.w3.org/2000/svg",d);break;case"math":h=v.createElementNS("http://www.w3.org/1998/Math/MathML",d);break;case"script":h=v.createElement("div"),h.innerHTML="<script><\/script>",h=h.removeChild(h.firstChild);break;case"select":h=typeof a.is=="string"?v.createElement("select",{is:a.is}):v.createElement("select"),a.multiple?h.multiple=!0:a.size&&(h.size=a.size);break;default:h=typeof a.is=="string"?v.createElement(d,{is:a.is}):v.createElement(d)}}h[Gt]=t,h[It]=a;e:for(v=t.child;v!==null;){if(v.tag===5||v.tag===6)h.appendChild(v.stateNode);else if(v.tag!==4&&v.tag!==27&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===t)break e;for(;v.sibling===null;){if(v.return===null||v.return===t)break e;v=v.return}v.sibling.return=v.return,v=v.sibling}t.stateNode=h;e:switch(_n(h,d,a),d){case"button":case"input":case"select":case"textarea":a=!!a.autoFocus;break e;case"img":a=!0;break e;default:a=!1}a&&sr(t)}}return un(t),od(t,t.type,e===null?null:e.memoizedProps,t.pendingProps,r),null;case 6:if(e&&t.stateNode!=null)e.memoizedProps!==a&&sr(t);else{if(typeof a!="string"&&t.stateNode===null)throw Error(l(166));if(e=We.current,Ts(t)){if(e=t.stateNode,r=t.memoizedProps,a=null,d=Ln,d!==null)switch(d.tag){case 27:case 5:a=d.memoizedProps}e[Gt]=t,e=!!(e.nodeValue===r||a!==null&&a.suppressHydrationWarning===!0||Eg(e.nodeValue,r)),e||kr(t,!0)}else e=Ei(e).createTextNode(a),e[Gt]=t,t.stateNode=e}return un(t),null;case 31:if(r=t.memoizedState,e===null||e.memoizedState!==null){if(a=Ts(t),r!==null){if(e===null){if(!a)throw Error(l(318));if(e=t.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(l(557));e[Gt]=t}else ts(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;un(t),e=!1}else r=pc(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=r),e=!0;if(!e)return t.flags&256?(io(t),t):(io(t),null);if((t.flags&128)!==0)throw Error(l(558))}return un(t),null;case 13:if(a=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(d=Ts(t),a!==null&&a.dehydrated!==null){if(e===null){if(!d)throw Error(l(318));if(d=t.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(l(317));d[Gt]=t}else ts(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;un(t),d=!1}else d=pc(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=d),d=!0;if(!d)return t.flags&256?(io(t),t):(io(t),null)}return io(t),(t.flags&128)!==0?(t.lanes=r,t):(r=a!==null,e=e!==null&&e.memoizedState!==null,r&&(a=t.child,d=null,a.alternate!==null&&a.alternate.memoizedState!==null&&a.alternate.memoizedState.cachePool!==null&&(d=a.alternate.memoizedState.cachePool.pool),h=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(h=a.memoizedState.cachePool.pool),h!==d&&(a.flags|=2048)),r!==e&&r&&(t.child.flags|=8192),mi(t,t.updateQueue),un(t),null);case 4:return H(),e===null&&kd(t.stateNode.containerInfo),un(t),null;case 10:return tr(t.type),un(t),null;case 19:if(A(yn),a=t.memoizedState,a===null)return un(t),null;if(d=(t.flags&128)!==0,h=a.rendering,h===null)if(d)zl(a,!1);else{if(mn!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(h=ni(e),h!==null){for(t.flags|=128,zl(a,!1),e=h.updateQueue,t.updateQueue=e,mi(t,e),t.subtreeFlags=0,e=r,r=t.child;r!==null;)ih(r,e),r=r.sibling;return O(yn,yn.current&1|2),zt&&Jo(t,a.treeForkCount),t.child}e=e.sibling}a.tail!==null&&me()>vi&&(t.flags|=128,d=!0,zl(a,!1),t.lanes=4194304)}else{if(!d)if(e=ni(h),e!==null){if(t.flags|=128,d=!0,e=e.updateQueue,t.updateQueue=e,mi(t,e),zl(a,!0),a.tail===null&&a.tailMode==="hidden"&&!h.alternate&&!zt)return un(t),null}else 2*me()-a.renderingStartTime>vi&&r!==536870912&&(t.flags|=128,d=!0,zl(a,!1),t.lanes=4194304);a.isBackwards?(h.sibling=t.child,t.child=h):(e=a.last,e!==null?e.sibling=h:t.child=h,a.last=h)}return a.tail!==null?(e=a.tail,a.rendering=e,a.tail=e.sibling,a.renderingStartTime=me(),e.sibling=null,r=yn.current,O(yn,d?r&1|2:r&1),zt&&Jo(t,a.treeForkCount),e):(un(t),null);case 22:case 23:return io(t),jc(),a=t.memoizedState!==null,e!==null?e.memoizedState!==null!==a&&(t.flags|=8192):a&&(t.flags|=8192),a?(r&536870912)!==0&&(t.flags&128)===0&&(un(t),t.subtreeFlags&6&&(t.flags|=8192)):un(t),r=t.updateQueue,r!==null&&mi(t,r.retryQueue),r=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(r=e.memoizedState.cachePool.pool),a=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(a=t.memoizedState.cachePool.pool),a!==r&&(t.flags|=2048),e!==null&&A(rs),null;case 24:return r=null,e!==null&&(r=e.memoizedState.cache),t.memoizedState.cache!==r&&(t.flags|=2048),tr(Sn),un(t),null;case 25:return null;case 30:return null}throw Error(l(156,t.tag))}function kv(e,t){switch(dc(t),t.tag){case 1:return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return tr(Sn),H(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 26:case 27:case 5:return D(t),null;case 31:if(t.memoizedState!==null){if(io(t),t.alternate===null)throw Error(l(340));ts()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 13:if(io(t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(l(340));ts()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return A(yn),null;case 4:return H(),null;case 10:return tr(t.type),null;case 22:case 23:return io(t),jc(),e!==null&&A(rs),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 24:return tr(Sn),null;case 25:return null;default:return null}}function _m(e,t){switch(dc(t),t.tag){case 3:tr(Sn),H();break;case 26:case 27:case 5:D(t);break;case 4:H();break;case 31:t.memoizedState!==null&&io(t);break;case 13:io(t);break;case 19:A(yn);break;case 10:tr(t.type);break;case 22:case 23:io(t),jc(),e!==null&&A(rs);break;case 24:tr(Sn)}}function Hl(e,t){try{var r=t.updateQueue,a=r!==null?r.lastEffect:null;if(a!==null){var d=a.next;r=d;do{if((r.tag&e)===e){a=void 0;var h=r.create,v=r.inst;a=h(),v.destroy=a}r=r.next}while(r!==d)}}catch(M){Xt(t,t.return,M)}}function Lr(e,t,r){try{var a=t.updateQueue,d=a!==null?a.lastEffect:null;if(d!==null){var h=d.next;a=h;do{if((a.tag&e)===e){var v=a.inst,M=v.destroy;if(M!==void 0){v.destroy=void 0,d=t;var G=r,ge=M;try{ge()}catch(Be){Xt(d,G,Be)}}}a=a.next}while(a!==h)}}catch(Be){Xt(t,t.return,Be)}}function Dm(e){var t=e.updateQueue;if(t!==null){var r=e.stateNode;try{jh(t,r)}catch(a){Xt(e,e.return,a)}}}function Bm(e,t,r){r.props=us(e.type,e.memoizedProps),r.state=e.memoizedState;try{r.componentWillUnmount()}catch(a){Xt(e,t,a)}}function Vl(e,t){try{var r=e.ref;if(r!==null){switch(e.tag){case 26:case 27:case 5:var a=e.stateNode;break;case 30:a=e.stateNode;break;default:a=e.stateNode}typeof r=="function"?e.refCleanup=r(a):r.current=a}}catch(d){Xt(e,t,d)}}function Ko(e,t){var r=e.ref,a=e.refCleanup;if(r!==null)if(typeof a=="function")try{a()}catch(d){Xt(e,t,d)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof r=="function")try{r(null)}catch(d){Xt(e,t,d)}else r.current=null}function zm(e){var t=e.type,r=e.memoizedProps,a=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":r.autoFocus&&a.focus();break e;case"img":r.src?a.src=r.src:r.srcSet&&(a.srcset=r.srcSet)}}catch(d){Xt(e,e.return,d)}}function rd(e,t,r){try{var a=e.stateNode;Gv(a,e.type,r,t),a[It]=t}catch(d){Xt(e,e.return,d)}}function Hm(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&Hr(e.type)||e.tag===4}function sd(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Hm(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&Hr(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function ld(e,t,r){var a=e.tag;if(a===5||a===6)e=e.stateNode,t?(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r).insertBefore(e,t):(t=r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,t.appendChild(e),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=yo));else if(a!==4&&(a===27&&Hr(e.type)&&(r=e.stateNode,t=null),e=e.child,e!==null))for(ld(e,t,r),e=e.sibling;e!==null;)ld(e,t,r),e=e.sibling}function gi(e,t,r){var a=e.tag;if(a===5||a===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(a!==4&&(a===27&&Hr(e.type)&&(r=e.stateNode),e=e.child,e!==null))for(gi(e,t,r),e=e.sibling;e!==null;)gi(e,t,r),e=e.sibling}function Vm(e){var t=e.stateNode,r=e.memoizedProps;try{for(var a=e.type,d=t.attributes;d.length;)t.removeAttributeNode(d[0]);_n(t,a,r),t[Gt]=e,t[It]=r}catch(h){Xt(e,e.return,h)}}var lr=!1,kn=!1,ad=!1,Km=typeof WeakSet=="function"?WeakSet:Set,In=null;function jv(e,t){if(e=e.containerInfo,Od=Bi,e=Jp(e),ec(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var a=r.getSelection&&r.getSelection();if(a&&a.rangeCount!==0){r=a.anchorNode;var d=a.anchorOffset,h=a.focusNode;a=a.focusOffset;try{r.nodeType,h.nodeType}catch{r=null;break e}var v=0,M=-1,G=-1,ge=0,Be=0,Ve=e,ve=null;t:for(;;){for(var Te;Ve!==r||d!==0&&Ve.nodeType!==3||(M=v+d),Ve!==h||a!==0&&Ve.nodeType!==3||(G=v+a),Ve.nodeType===3&&(v+=Ve.nodeValue.length),(Te=Ve.firstChild)!==null;)ve=Ve,Ve=Te;for(;;){if(Ve===e)break t;if(ve===r&&++ge===d&&(M=v),ve===h&&++Be===a&&(G=v),(Te=Ve.nextSibling)!==null)break;Ve=ve,ve=Ve.parentNode}Ve=Te}r=M===-1||G===-1?null:{start:M,end:G}}else r=null}r=r||{start:0,end:0}}else r=null;for(Td={focusedElem:e,selectionRange:r},Bi=!1,In=t;In!==null;)if(t=In,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,In=e;else for(;In!==null;){switch(t=In,h=t.alternate,e=t.flags,t.tag){case 0:if((e&4)!==0&&(e=t.updateQueue,e=e!==null?e.events:null,e!==null))for(r=0;r<e.length;r++)d=e[r],d.ref.impl=d.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&h!==null){e=void 0,r=t,d=h.memoizedProps,h=h.memoizedState,a=r.stateNode;try{var ut=us(r.type,d);e=a.getSnapshotBeforeUpdate(ut,h),a.__reactInternalSnapshotBeforeUpdate=e}catch(xt){Xt(r,r.return,xt)}}break;case 3:if((e&1024)!==0){if(e=t.stateNode.containerInfo,r=e.nodeType,r===9)Ld(e);else if(r===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Ld(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(l(163))}if(e=t.sibling,e!==null){e.return=t.return,In=e;break}In=t.return}}function Um(e,t,r){var a=r.flags;switch(r.tag){case 0:case 11:case 15:ir(e,r),a&4&&Hl(5,r);break;case 1:if(ir(e,r),a&4)if(e=r.stateNode,t===null)try{e.componentDidMount()}catch(v){Xt(r,r.return,v)}else{var d=us(r.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(d,t,e.__reactInternalSnapshotBeforeUpdate)}catch(v){Xt(r,r.return,v)}}a&64&&Dm(r),a&512&&Vl(r,r.return);break;case 3:if(ir(e,r),a&64&&(e=r.updateQueue,e!==null)){if(t=null,r.child!==null)switch(r.child.tag){case 27:case 5:t=r.child.stateNode;break;case 1:t=r.child.stateNode}try{jh(e,t)}catch(v){Xt(r,r.return,v)}}break;case 27:t===null&&a&4&&Vm(r);case 26:case 5:ir(e,r),t===null&&a&4&&zm(r),a&512&&Vl(r,r.return);break;case 12:ir(e,r);break;case 31:ir(e,r),a&4&&qm(e,r);break;case 13:ir(e,r),a&4&&Wm(e,r),a&64&&(e=r.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(r=_v.bind(null,r),t1(e,r))));break;case 22:if(a=r.memoizedState!==null||lr,!a){t=t!==null&&t.memoizedState!==null||kn,d=lr;var h=kn;lr=a,(kn=t)&&!h?ur(e,r,(r.subtreeFlags&8772)!==0):ir(e,r),lr=d,kn=h}break;case 30:break;default:ir(e,r)}}function $m(e){var t=e.alternate;t!==null&&(e.alternate=null,$m(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&X(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var fn=null,Pn=!1;function ar(e,t,r){for(r=r.child;r!==null;)Fm(e,t,r),r=r.sibling}function Fm(e,t,r){if(Fe&&typeof Fe.onCommitFiberUnmount=="function")try{Fe.onCommitFiberUnmount(Ye,r)}catch{}switch(r.tag){case 26:kn||Ko(r,t),ar(e,t,r),r.memoizedState?r.memoizedState.count--:r.stateNode&&(r=r.stateNode,r.parentNode.removeChild(r));break;case 27:kn||Ko(r,t);var a=fn,d=Pn;Hr(r.type)&&(fn=r.stateNode,Pn=!1),ar(e,t,r),Yl(r.stateNode),fn=a,Pn=d;break;case 5:kn||Ko(r,t);case 6:if(a=fn,d=Pn,fn=null,ar(e,t,r),fn=a,Pn=d,fn!==null)if(Pn)try{(fn.nodeType===9?fn.body:fn.nodeName==="HTML"?fn.ownerDocument.body:fn).removeChild(r.stateNode)}catch(h){Xt(r,t,h)}else try{fn.removeChild(r.stateNode)}catch(h){Xt(r,t,h)}break;case 18:fn!==null&&(Pn?(e=fn,Dg(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,r.stateNode),Qs(e)):Dg(fn,r.stateNode));break;case 4:a=fn,d=Pn,fn=r.stateNode.containerInfo,Pn=!0,ar(e,t,r),fn=a,Pn=d;break;case 0:case 11:case 14:case 15:Lr(2,r,t),kn||Lr(4,r,t),ar(e,t,r);break;case 1:kn||(Ko(r,t),a=r.stateNode,typeof a.componentWillUnmount=="function"&&Bm(r,t,a)),ar(e,t,r);break;case 21:ar(e,t,r);break;case 22:kn=(a=kn)||r.memoizedState!==null,ar(e,t,r),kn=a;break;default:ar(e,t,r)}}function qm(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{Qs(e)}catch(r){Xt(t,t.return,r)}}}function Wm(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{Qs(e)}catch(r){Xt(t,t.return,r)}}function Mv(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return t===null&&(t=e.stateNode=new Km),t;case 22:return e=e.stateNode,t=e._retryCache,t===null&&(t=e._retryCache=new Km),t;default:throw Error(l(435,e.tag))}}function yi(e,t){var r=Mv(e);t.forEach(function(a){if(!r.has(a)){r.add(a);var d=Dv.bind(null,e,a);a.then(d,d)}})}function Yn(e,t){var r=t.deletions;if(r!==null)for(var a=0;a<r.length;a++){var d=r[a],h=e,v=t,M=v;e:for(;M!==null;){switch(M.tag){case 27:if(Hr(M.type)){fn=M.stateNode,Pn=!1;break e}break;case 5:fn=M.stateNode,Pn=!1;break e;case 3:case 4:fn=M.stateNode.containerInfo,Pn=!0;break e}M=M.return}if(fn===null)throw Error(l(160));Fm(h,v,d),fn=null,Pn=!1,h=d.alternate,h!==null&&(h.return=null),d.return=null}if(t.subtreeFlags&13886)for(t=t.child;t!==null;)Gm(t,e),t=t.sibling}var Eo=null;function Gm(e,t){var r=e.alternate,a=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Yn(t,e),Qn(e),a&4&&(Lr(3,e,e.return),Hl(3,e),Lr(5,e,e.return));break;case 1:Yn(t,e),Qn(e),a&512&&(kn||r===null||Ko(r,r.return)),a&64&&lr&&(e=e.updateQueue,e!==null&&(a=e.callbacks,a!==null&&(r=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=r===null?a:r.concat(a))));break;case 26:var d=Eo;if(Yn(t,e),Qn(e),a&512&&(kn||r===null||Ko(r,r.return)),a&4){var h=r!==null?r.memoizedState:null;if(a=e.memoizedState,r===null)if(a===null)if(e.stateNode===null){e:{a=e.type,r=e.memoizedProps,d=d.ownerDocument||d;t:switch(a){case"title":h=d.getElementsByTagName("title")[0],(!h||h[oo]||h[Gt]||h.namespaceURI==="http://www.w3.org/2000/svg"||h.hasAttribute("itemprop"))&&(h=d.createElement(a),d.head.insertBefore(h,d.querySelector("head > title"))),_n(h,a,r),h[Gt]=e,Qe(h),a=h;break e;case"link":var v=Gg("link","href",d).get(a+(r.href||""));if(v){for(var M=0;M<v.length;M++)if(h=v[M],h.getAttribute("href")===(r.href==null||r.href===""?null:r.href)&&h.getAttribute("rel")===(r.rel==null?null:r.rel)&&h.getAttribute("title")===(r.title==null?null:r.title)&&h.getAttribute("crossorigin")===(r.crossOrigin==null?null:r.crossOrigin)){v.splice(M,1);break t}}h=d.createElement(a),_n(h,a,r),d.head.appendChild(h);break;case"meta":if(v=Gg("meta","content",d).get(a+(r.content||""))){for(M=0;M<v.length;M++)if(h=v[M],h.getAttribute("content")===(r.content==null?null:""+r.content)&&h.getAttribute("name")===(r.name==null?null:r.name)&&h.getAttribute("property")===(r.property==null?null:r.property)&&h.getAttribute("http-equiv")===(r.httpEquiv==null?null:r.httpEquiv)&&h.getAttribute("charset")===(r.charSet==null?null:r.charSet)){v.splice(M,1);break t}}h=d.createElement(a),_n(h,a,r),d.head.appendChild(h);break;default:throw Error(l(468,a))}h[Gt]=e,Qe(h),a=h}e.stateNode=a}else Pg(d,e.type,e.stateNode);else e.stateNode=Wg(d,a,e.memoizedProps);else h!==a?(h===null?r.stateNode!==null&&(r=r.stateNode,r.parentNode.removeChild(r)):h.count--,a===null?Pg(d,e.type,e.stateNode):Wg(d,a,e.memoizedProps)):a===null&&e.stateNode!==null&&rd(e,e.memoizedProps,r.memoizedProps)}break;case 27:Yn(t,e),Qn(e),a&512&&(kn||r===null||Ko(r,r.return)),r!==null&&a&4&&rd(e,e.memoizedProps,r.memoizedProps);break;case 5:if(Yn(t,e),Qn(e),a&512&&(kn||r===null||Ko(r,r.return)),e.flags&32){d=e.stateNode;try{wr(d,"")}catch(ut){Xt(e,e.return,ut)}}a&4&&e.stateNode!=null&&(d=e.memoizedProps,rd(e,d,r!==null?r.memoizedProps:d)),a&1024&&(ad=!0);break;case 6:if(Yn(t,e),Qn(e),a&4){if(e.stateNode===null)throw Error(l(162));a=e.memoizedProps,r=e.stateNode;try{r.nodeValue=a}catch(ut){Xt(e,e.return,ut)}}break;case 3:if(Ai=null,d=Eo,Eo=Ii(t.containerInfo),Yn(t,e),Eo=d,Qn(e),a&4&&r!==null&&r.memoizedState.isDehydrated)try{Qs(t.containerInfo)}catch(ut){Xt(e,e.return,ut)}ad&&(ad=!1,Pm(e));break;case 4:a=Eo,Eo=Ii(e.stateNode.containerInfo),Yn(t,e),Qn(e),Eo=a;break;case 12:Yn(t,e),Qn(e);break;case 31:Yn(t,e),Qn(e),a&4&&(a=e.updateQueue,a!==null&&(e.updateQueue=null,yi(e,a)));break;case 13:Yn(t,e),Qn(e),e.child.flags&8192&&e.memoizedState!==null!=(r!==null&&r.memoizedState!==null)&&(xi=me()),a&4&&(a=e.updateQueue,a!==null&&(e.updateQueue=null,yi(e,a)));break;case 22:d=e.memoizedState!==null;var G=r!==null&&r.memoizedState!==null,ge=lr,Be=kn;if(lr=ge||d,kn=Be||G,Yn(t,e),kn=Be,lr=ge,Qn(e),a&8192)e:for(t=e.stateNode,t._visibility=d?t._visibility&-2:t._visibility|1,d&&(r===null||G||lr||kn||cs(e)),r=null,t=e;;){if(t.tag===5||t.tag===26){if(r===null){G=r=t;try{if(h=G.stateNode,d)v=h.style,typeof v.setProperty=="function"?v.setProperty("display","none","important"):v.display="none";else{M=G.stateNode;var Ve=G.memoizedProps.style,ve=Ve!=null&&Ve.hasOwnProperty("display")?Ve.display:null;M.style.display=ve==null||typeof ve=="boolean"?"":(""+ve).trim()}}catch(ut){Xt(G,G.return,ut)}}}else if(t.tag===6){if(r===null){G=t;try{G.stateNode.nodeValue=d?"":G.memoizedProps}catch(ut){Xt(G,G.return,ut)}}}else if(t.tag===18){if(r===null){G=t;try{var Te=G.stateNode;d?Bg(Te,!0):Bg(G.stateNode,!1)}catch(ut){Xt(G,G.return,ut)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;r===t&&(r=null),t=t.return}r===t&&(r=null),t.sibling.return=t.return,t=t.sibling}a&4&&(a=e.updateQueue,a!==null&&(r=a.retryQueue,r!==null&&(a.retryQueue=null,yi(e,r))));break;case 19:Yn(t,e),Qn(e),a&4&&(a=e.updateQueue,a!==null&&(e.updateQueue=null,yi(e,a)));break;case 30:break;case 21:break;default:Yn(t,e),Qn(e)}}function Qn(e){var t=e.flags;if(t&2){try{for(var r,a=e.return;a!==null;){if(Hm(a)){r=a;break}a=a.return}if(r==null)throw Error(l(160));switch(r.tag){case 27:var d=r.stateNode,h=sd(e);gi(e,h,d);break;case 5:var v=r.stateNode;r.flags&32&&(wr(v,""),r.flags&=-33);var M=sd(e);gi(e,M,v);break;case 3:case 4:var G=r.stateNode.containerInfo,ge=sd(e);ld(e,ge,G);break;default:throw Error(l(161))}}catch(Be){Xt(e,e.return,Be)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Pm(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var t=e;Pm(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),e=e.sibling}}function ir(e,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)Um(e,t.alternate,t),t=t.sibling}function cs(e){for(e=e.child;e!==null;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:Lr(4,t,t.return),cs(t);break;case 1:Ko(t,t.return);var r=t.stateNode;typeof r.componentWillUnmount=="function"&&Bm(t,t.return,r),cs(t);break;case 27:Yl(t.stateNode);case 26:case 5:Ko(t,t.return),cs(t);break;case 22:t.memoizedState===null&&cs(t);break;case 30:cs(t);break;default:cs(t)}e=e.sibling}}function ur(e,t,r){for(r=r&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var a=t.alternate,d=e,h=t,v=h.flags;switch(h.tag){case 0:case 11:case 15:ur(d,h,r),Hl(4,h);break;case 1:if(ur(d,h,r),a=h,d=a.stateNode,typeof d.componentDidMount=="function")try{d.componentDidMount()}catch(ge){Xt(a,a.return,ge)}if(a=h,d=a.updateQueue,d!==null){var M=a.stateNode;try{var G=d.shared.hiddenCallbacks;if(G!==null)for(d.shared.hiddenCallbacks=null,d=0;d<G.length;d++)kh(G[d],M)}catch(ge){Xt(a,a.return,ge)}}r&&v&64&&Dm(h),Vl(h,h.return);break;case 27:Vm(h);case 26:case 5:ur(d,h,r),r&&a===null&&v&4&&zm(h),Vl(h,h.return);break;case 12:ur(d,h,r);break;case 31:ur(d,h,r),r&&v&4&&qm(d,h);break;case 13:ur(d,h,r),r&&v&4&&Wm(d,h);break;case 22:h.memoizedState===null&&ur(d,h,r),Vl(h,h.return);break;case 30:break;default:ur(d,h,r)}t=t.sibling}}function id(e,t){var r=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(r=e.memoizedState.cachePool.pool),e=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(e=t.memoizedState.cachePool.pool),e!==r&&(e!=null&&e.refCount++,r!=null&&jl(r))}function ud(e,t){e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&jl(e))}function Io(e,t,r,a){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)Ym(e,t,r,a),t=t.sibling}function Ym(e,t,r,a){var d=t.flags;switch(t.tag){case 0:case 11:case 15:Io(e,t,r,a),d&2048&&Hl(9,t);break;case 1:Io(e,t,r,a);break;case 3:Io(e,t,r,a),d&2048&&(e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&jl(e)));break;case 12:if(d&2048){Io(e,t,r,a),e=t.stateNode;try{var h=t.memoizedProps,v=h.id,M=h.onPostCommit;typeof M=="function"&&M(v,t.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(G){Xt(t,t.return,G)}}else Io(e,t,r,a);break;case 31:Io(e,t,r,a);break;case 13:Io(e,t,r,a);break;case 23:break;case 22:h=t.stateNode,v=t.alternate,t.memoizedState!==null?h._visibility&2?Io(e,t,r,a):Kl(e,t):h._visibility&2?Io(e,t,r,a):(h._visibility|=2,Hs(e,t,r,a,(t.subtreeFlags&10256)!==0||!1)),d&2048&&id(v,t);break;case 24:Io(e,t,r,a),d&2048&&ud(t.alternate,t);break;default:Io(e,t,r,a)}}function Hs(e,t,r,a,d){for(d=d&&((t.subtreeFlags&10256)!==0||!1),t=t.child;t!==null;){var h=e,v=t,M=r,G=a,ge=v.flags;switch(v.tag){case 0:case 11:case 15:Hs(h,v,M,G,d),Hl(8,v);break;case 23:break;case 22:var Be=v.stateNode;v.memoizedState!==null?Be._visibility&2?Hs(h,v,M,G,d):Kl(h,v):(Be._visibility|=2,Hs(h,v,M,G,d)),d&&ge&2048&&id(v.alternate,v);break;case 24:Hs(h,v,M,G,d),d&&ge&2048&&ud(v.alternate,v);break;default:Hs(h,v,M,G,d)}t=t.sibling}}function Kl(e,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var r=e,a=t,d=a.flags;switch(a.tag){case 22:Kl(r,a),d&2048&&id(a.alternate,a);break;case 24:Kl(r,a),d&2048&&ud(a.alternate,a);break;default:Kl(r,a)}t=t.sibling}}var Ul=8192;function Vs(e,t,r){if(e.subtreeFlags&Ul)for(e=e.child;e!==null;)Qm(e,t,r),e=e.sibling}function Qm(e,t,r){switch(e.tag){case 26:Vs(e,t,r),e.flags&Ul&&e.memoizedState!==null&&p1(r,Eo,e.memoizedState,e.memoizedProps);break;case 5:Vs(e,t,r);break;case 3:case 4:var a=Eo;Eo=Ii(e.stateNode.containerInfo),Vs(e,t,r),Eo=a;break;case 22:e.memoizedState===null&&(a=e.alternate,a!==null&&a.memoizedState!==null?(a=Ul,Ul=16777216,Vs(e,t,r),Ul=a):Vs(e,t,r));break;default:Vs(e,t,r)}}function Xm(e){var t=e.alternate;if(t!==null&&(e=t.child,e!==null)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(e!==null)}}function $l(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var r=0;r<t.length;r++){var a=t[r];In=a,Jm(a,e)}Xm(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)Zm(e),e=e.sibling}function Zm(e){switch(e.tag){case 0:case 11:case 15:$l(e),e.flags&2048&&Lr(9,e,e.return);break;case 3:$l(e);break;case 12:$l(e);break;case 22:var t=e.stateNode;e.memoizedState!==null&&t._visibility&2&&(e.return===null||e.return.tag!==13)?(t._visibility&=-3,bi(e)):$l(e);break;default:$l(e)}}function bi(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var r=0;r<t.length;r++){var a=t[r];In=a,Jm(a,e)}Xm(e)}for(e=e.child;e!==null;){switch(t=e,t.tag){case 0:case 11:case 15:Lr(8,t,t.return),bi(t);break;case 22:r=t.stateNode,r._visibility&2&&(r._visibility&=-3,bi(t));break;default:bi(t)}e=e.sibling}}function Jm(e,t){for(;In!==null;){var r=In;switch(r.tag){case 0:case 11:case 15:Lr(8,r,t);break;case 23:case 22:if(r.memoizedState!==null&&r.memoizedState.cachePool!==null){var a=r.memoizedState.cachePool.pool;a!=null&&a.refCount++}break;case 24:jl(r.memoizedState.cache)}if(a=r.child,a!==null)a.return=r,In=a;else e:for(r=e;In!==null;){a=In;var d=a.sibling,h=a.return;if($m(a),a===r){In=null;break e}if(d!==null){d.return=h,In=d;break e}In=h}}}var Ov={getCacheForType:function(e){var t=An(Sn),r=t.data.get(e);return r===void 0&&(r=e(),t.data.set(e,r)),r},cacheSignal:function(){return An(Sn).controller.signal}},Tv=typeof WeakMap=="function"?WeakMap:Map,Ft=0,rn=null,At=null,Dt=0,Qt=0,uo=null,Ar=!1,Ks=!1,cd=!1,cr=0,mn=0,Rr=0,ds=0,dd=0,co=0,Us=0,Fl=null,Xn=null,fd=!1,xi=0,eg=0,vi=1/0,wi=null,_r=null,En=0,Dr=null,$s=null,dr=0,pd=0,hd=null,tg=null,ql=0,md=null;function fo(){return(Ft&2)!==0&&Dt!==0?Dt&-Dt:_.T!==null?wd():Tt()}function ng(){if(co===0)if((Dt&536870912)===0||zt){var e=Q;Q<<=1,(Q&3932160)===0&&(Q=262144),co=e}else co=536870912;return e=ao.current,e!==null&&(e.flags|=32),co}function Zn(e,t,r){(e===rn&&(Qt===2||Qt===9)||e.cancelPendingCommit!==null)&&(Fs(e,0),Br(e,Dt,co,!1)),tt(e,r),((Ft&2)===0||e!==rn)&&(e===rn&&((Ft&2)===0&&(ds|=r),mn===4&&Br(e,Dt,co,!1)),Uo(e))}function og(e,t,r){if((Ft&6)!==0)throw Error(l(327));var a=!r&&(t&127)===0&&(t&e.expiredLanes)===0||Ke(e,t),d=a?Lv(e,t):yd(e,t,!0),h=a;do{if(d===0){Ks&&!a&&Br(e,t,0,!1);break}else{if(r=e.current.alternate,h&&!Ev(r)){d=yd(e,t,!1),h=!1;continue}if(d===2){if(h=t,e.errorRecoveryDisabledLanes&h)var v=0;else v=e.pendingLanes&-536870913,v=v!==0?v:v&536870912?536870912:0;if(v!==0){t=v;e:{var M=e;d=Fl;var G=M.current.memoizedState.isDehydrated;if(G&&(Fs(M,v).flags|=256),v=yd(M,v,!1),v!==2){if(cd&&!G){M.errorRecoveryDisabledLanes|=h,ds|=h,d=4;break e}h=Xn,Xn=d,h!==null&&(Xn===null?Xn=h:Xn.push.apply(Xn,h))}d=v}if(h=!1,d!==2)continue}}if(d===1){Fs(e,0),Br(e,t,0,!0);break}e:{switch(a=e,h=d,h){case 0:case 1:throw Error(l(345));case 4:if((t&4194048)!==t)break;case 6:Br(a,t,co,!Ar);break e;case 2:Xn=null;break;case 3:case 5:break;default:throw Error(l(329))}if((t&62914560)===t&&(d=xi+300-me(),10<d)){if(Br(a,t,co,!Ar),Oe(a,0,!0)!==0)break e;dr=t,a.timeoutHandle=Rg(rg.bind(null,a,r,Xn,wi,fd,t,co,ds,Us,Ar,h,"Throttled",-0,0),d);break e}rg(a,r,Xn,wi,fd,t,co,ds,Us,Ar,h,null,-0,0)}}break}while(!0);Uo(e)}function rg(e,t,r,a,d,h,v,M,G,ge,Be,Ve,ve,Te){if(e.timeoutHandle=-1,Ve=t.subtreeFlags,Ve&8192||(Ve&16785408)===16785408){Ve={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:yo},Qm(t,h,Ve);var ut=(h&62914560)===h?xi-me():(h&4194048)===h?eg-me():0;if(ut=h1(Ve,ut),ut!==null){dr=h,e.cancelPendingCommit=ut(fg.bind(null,e,t,h,r,a,d,v,M,G,Be,Ve,null,ve,Te)),Br(e,h,v,!ge);return}}fg(e,t,h,r,a,d,v,M,G)}function Ev(e){for(var t=e;;){var r=t.tag;if((r===0||r===11||r===15)&&t.flags&16384&&(r=t.updateQueue,r!==null&&(r=r.stores,r!==null)))for(var a=0;a<r.length;a++){var d=r[a],h=d.getSnapshot;d=d.value;try{if(!so(h(),d))return!1}catch{return!1}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Br(e,t,r,a){t&=~dd,t&=~ds,e.suspendedLanes|=t,e.pingedLanes&=~t,a&&(e.warmLanes|=t),a=e.expirationTimes;for(var d=t;0<d;){var h=31-ft(d),v=1<<h;a[h]=-1,d&=~v}r!==0&&wt(e,r,t)}function Si(){return(Ft&6)===0?(Wl(0),!1):!0}function gd(){if(At!==null){if(Qt===0)var e=At.return;else e=At,er=ns=null,Lc(e),Rs=null,Ol=0,e=At;for(;e!==null;)_m(e.alternate,e),e=e.return;At=null}}function Fs(e,t){var r=e.timeoutHandle;r!==-1&&(e.timeoutHandle=-1,Qv(r)),r=e.cancelPendingCommit,r!==null&&(e.cancelPendingCommit=null,r()),dr=0,gd(),rn=e,At=r=Zo(e.current,null),Dt=t,Qt=0,uo=null,Ar=!1,Ks=Ke(e,t),cd=!1,Us=co=dd=ds=Rr=mn=0,Xn=Fl=null,fd=!1,(t&8)!==0&&(t|=t&32);var a=e.entangledLanes;if(a!==0)for(e=e.entanglements,a&=t;0<a;){var d=31-ft(a),h=1<<d;t|=e[d],a&=~h}return cr=t,$a(),r}function sg(e,t){jt=null,_.H=Dl,t===As||t===Xa?(t=wh(),Qt=3):t===vc?(t=wh(),Qt=4):Qt=t===Pc?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,uo=t,At===null&&(mn=1,di(e,xo(t,e.current)))}function lg(){var e=ao.current;return e===null?!0:(Dt&4194048)===Dt?No===null:(Dt&62914560)===Dt||(Dt&536870912)!==0?e===No:!1}function ag(){var e=_.H;return _.H=Dl,e===null?Dl:e}function ig(){var e=_.A;return _.A=Ov,e}function Ni(){mn=4,Ar||(Dt&4194048)!==Dt&&ao.current!==null||(Ks=!0),(Rr&134217727)===0&&(ds&134217727)===0||rn===null||Br(rn,Dt,co,!1)}function yd(e,t,r){var a=Ft;Ft|=2;var d=ag(),h=ig();(rn!==e||Dt!==t)&&(wi=null,Fs(e,t)),t=!1;var v=mn;e:do try{if(Qt!==0&&At!==null){var M=At,G=uo;switch(Qt){case 8:gd(),v=6;break e;case 3:case 2:case 9:case 6:ao.current===null&&(t=!0);var ge=Qt;if(Qt=0,uo=null,qs(e,M,G,ge),r&&Ks){v=0;break e}break;default:ge=Qt,Qt=0,uo=null,qs(e,M,G,ge)}}Iv(),v=mn;break}catch(Be){sg(e,Be)}while(!0);return t&&e.shellSuspendCounter++,er=ns=null,Ft=a,_.H=d,_.A=h,At===null&&(rn=null,Dt=0,$a()),v}function Iv(){for(;At!==null;)ug(At)}function Lv(e,t){var r=Ft;Ft|=2;var a=ag(),d=ig();rn!==e||Dt!==t?(wi=null,vi=me()+500,Fs(e,t)):Ks=Ke(e,t);e:do try{if(Qt!==0&&At!==null){t=At;var h=uo;t:switch(Qt){case 1:Qt=0,uo=null,qs(e,t,h,1);break;case 2:case 9:if(xh(h)){Qt=0,uo=null,cg(t);break}t=function(){Qt!==2&&Qt!==9||rn!==e||(Qt=7),Uo(e)},h.then(t,t);break e;case 3:Qt=7;break e;case 4:Qt=5;break e;case 7:xh(h)?(Qt=0,uo=null,cg(t)):(Qt=0,uo=null,qs(e,t,h,7));break;case 5:var v=null;switch(At.tag){case 26:v=At.memoizedState;case 5:case 27:var M=At;if(v?Yg(v):M.stateNode.complete){Qt=0,uo=null;var G=M.sibling;if(G!==null)At=G;else{var ge=M.return;ge!==null?(At=ge,Ci(ge)):At=null}break t}}Qt=0,uo=null,qs(e,t,h,5);break;case 6:Qt=0,uo=null,qs(e,t,h,6);break;case 8:gd(),mn=6;break e;default:throw Error(l(462))}}Av();break}catch(Be){sg(e,Be)}while(!0);return er=ns=null,_.H=a,_.A=d,Ft=r,At!==null?0:(rn=null,Dt=0,$a(),mn)}function Av(){for(;At!==null&&!W();)ug(At)}function ug(e){var t=Am(e.alternate,e,cr);e.memoizedProps=e.pendingProps,t===null?Ci(e):At=t}function cg(e){var t=e,r=t.alternate;switch(t.tag){case 15:case 0:t=Mm(r,t,t.pendingProps,t.type,void 0,Dt);break;case 11:t=Mm(r,t,t.pendingProps,t.type.render,t.ref,Dt);break;case 5:Lc(t);default:_m(r,t),t=At=ih(t,cr),t=Am(r,t,cr)}e.memoizedProps=e.pendingProps,t===null?Ci(e):At=t}function qs(e,t,r,a){er=ns=null,Lc(t),Rs=null,Ol=0;var d=t.return;try{if(wv(e,d,t,r,Dt)){mn=1,di(e,xo(r,e.current)),At=null;return}}catch(h){if(d!==null)throw At=d,h;mn=1,di(e,xo(r,e.current)),At=null;return}t.flags&32768?(zt||a===1?e=!0:Ks||(Dt&536870912)!==0?e=!1:(Ar=e=!0,(a===2||a===9||a===3||a===6)&&(a=ao.current,a!==null&&a.tag===13&&(a.flags|=16384))),dg(t,e)):Ci(t)}function Ci(e){var t=e;do{if((t.flags&32768)!==0){dg(t,Ar);return}e=t.return;var r=Cv(t.alternate,t,cr);if(r!==null){At=r;return}if(t=t.sibling,t!==null){At=t;return}At=t=e}while(t!==null);mn===0&&(mn=5)}function dg(e,t){do{var r=kv(e.alternate,e);if(r!==null){r.flags&=32767,At=r;return}if(r=e.return,r!==null&&(r.flags|=32768,r.subtreeFlags=0,r.deletions=null),!t&&(e=e.sibling,e!==null)){At=e;return}At=e=r}while(e!==null);mn=6,At=null}function fg(e,t,r,a,d,h,v,M,G){e.cancelPendingCommit=null;do ki();while(En!==0);if((Ft&6)!==0)throw Error(l(327));if(t!==null){if(t===e.current)throw Error(l(177));if(h=t.lanes|t.childLanes,h|=sc,lt(e,r,h,v,M,G),e===rn&&(At=rn=null,Dt=0),$s=t,Dr=e,dr=r,pd=h,hd=d,tg=a,(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,Bv(_e,function(){return yg(),null})):(e.callbackNode=null,e.callbackPriority=0),a=(t.flags&13878)!==0,(t.subtreeFlags&13878)!==0||a){a=_.T,_.T=null,d=se.p,se.p=2,v=Ft,Ft|=4;try{jv(e,t,r)}finally{Ft=v,se.p=d,_.T=a}}En=1,pg(),hg(),mg()}}function pg(){if(En===1){En=0;var e=Dr,t=$s,r=(t.flags&13878)!==0;if((t.subtreeFlags&13878)!==0||r){r=_.T,_.T=null;var a=se.p;se.p=2;var d=Ft;Ft|=4;try{Gm(t,e);var h=Td,v=Jp(e.containerInfo),M=h.focusedElem,G=h.selectionRange;if(v!==M&&M&&M.ownerDocument&&Zp(M.ownerDocument.documentElement,M)){if(G!==null&&ec(M)){var ge=G.start,Be=G.end;if(Be===void 0&&(Be=ge),"selectionStart"in M)M.selectionStart=ge,M.selectionEnd=Math.min(Be,M.value.length);else{var Ve=M.ownerDocument||document,ve=Ve&&Ve.defaultView||window;if(ve.getSelection){var Te=ve.getSelection(),ut=M.textContent.length,xt=Math.min(G.start,ut),tn=G.end===void 0?xt:Math.min(G.end,ut);!Te.extend&&xt>tn&&(v=tn,tn=xt,xt=v);var le=Xp(M,xt),J=Xp(M,tn);if(le&&J&&(Te.rangeCount!==1||Te.anchorNode!==le.node||Te.anchorOffset!==le.offset||Te.focusNode!==J.node||Te.focusOffset!==J.offset)){var he=Ve.createRange();he.setStart(le.node,le.offset),Te.removeAllRanges(),xt>tn?(Te.addRange(he),Te.extend(J.node,J.offset)):(he.setEnd(J.node,J.offset),Te.addRange(he))}}}}for(Ve=[],Te=M;Te=Te.parentNode;)Te.nodeType===1&&Ve.push({element:Te,left:Te.scrollLeft,top:Te.scrollTop});for(typeof M.focus=="function"&&M.focus(),M=0;M<Ve.length;M++){var He=Ve[M];He.element.scrollLeft=He.left,He.element.scrollTop=He.top}}Bi=!!Od,Td=Od=null}finally{Ft=d,se.p=a,_.T=r}}e.current=t,En=2}}function hg(){if(En===2){En=0;var e=Dr,t=$s,r=(t.flags&8772)!==0;if((t.subtreeFlags&8772)!==0||r){r=_.T,_.T=null;var a=se.p;se.p=2;var d=Ft;Ft|=4;try{Um(e,t.alternate,t)}finally{Ft=d,se.p=a,_.T=r}}En=3}}function mg(){if(En===4||En===3){En=0,be();var e=Dr,t=$s,r=dr,a=tg;(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?En=5:(En=0,$s=Dr=null,gg(e,e.pendingLanes));var d=e.pendingLanes;if(d===0&&(_r=null),ht(r),t=t.stateNode,Fe&&typeof Fe.onCommitFiberRoot=="function")try{Fe.onCommitFiberRoot(Ye,t,void 0,(t.current.flags&128)===128)}catch{}if(a!==null){t=_.T,d=se.p,se.p=2,_.T=null;try{for(var h=e.onRecoverableError,v=0;v<a.length;v++){var M=a[v];h(M.value,{componentStack:M.stack})}}finally{_.T=t,se.p=d}}(dr&3)!==0&&ki(),Uo(e),d=e.pendingLanes,(r&261930)!==0&&(d&42)!==0?e===md?ql++:(ql=0,md=e):ql=0,Wl(0)}}function gg(e,t){(e.pooledCacheLanes&=t)===0&&(t=e.pooledCache,t!=null&&(e.pooledCache=null,jl(t)))}function ki(){return pg(),hg(),mg(),yg()}function yg(){if(En!==5)return!1;var e=Dr,t=pd;pd=0;var r=ht(dr),a=_.T,d=se.p;try{se.p=32>r?32:r,_.T=null,r=hd,hd=null;var h=Dr,v=dr;if(En=0,$s=Dr=null,dr=0,(Ft&6)!==0)throw Error(l(331));var M=Ft;if(Ft|=4,Zm(h.current),Ym(h,h.current,v,r),Ft=M,Wl(0,!1),Fe&&typeof Fe.onPostCommitFiberRoot=="function")try{Fe.onPostCommitFiberRoot(Ye,h)}catch{}return!0}finally{se.p=d,_.T=a,gg(e,t)}}function bg(e,t,r){t=xo(r,t),t=Gc(e.stateNode,t,2),e=Tr(e,t,2),e!==null&&(tt(e,2),Uo(e))}function Xt(e,t,r){if(e.tag===3)bg(e,e,r);else for(;t!==null;){if(t.tag===3){bg(t,e,r);break}else if(t.tag===1){var a=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof a.componentDidCatch=="function"&&(_r===null||!_r.has(a))){e=xo(r,e),r=xm(2),a=Tr(t,r,2),a!==null&&(vm(r,a,t,e),tt(a,2),Uo(a));break}}t=t.return}}function bd(e,t,r){var a=e.pingCache;if(a===null){a=e.pingCache=new Tv;var d=new Set;a.set(t,d)}else d=a.get(t),d===void 0&&(d=new Set,a.set(t,d));d.has(r)||(cd=!0,d.add(r),e=Rv.bind(null,e,t,r),t.then(e,e))}function Rv(e,t,r){var a=e.pingCache;a!==null&&a.delete(t),e.pingedLanes|=e.suspendedLanes&r,e.warmLanes&=~r,rn===e&&(Dt&r)===r&&(mn===4||mn===3&&(Dt&62914560)===Dt&&300>me()-xi?(Ft&2)===0&&Fs(e,0):dd|=r,Us===Dt&&(Us=0)),Uo(e)}function xg(e,t){t===0&&(t=it()),e=Jr(e,t),e!==null&&(tt(e,t),Uo(e))}function _v(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),xg(e,r)}function Dv(e,t){var r=0;switch(e.tag){case 31:case 13:var a=e.stateNode,d=e.memoizedState;d!==null&&(r=d.retryLane);break;case 19:a=e.stateNode;break;case 22:a=e.stateNode._retryCache;break;default:throw Error(l(314))}a!==null&&a.delete(t),xg(e,r)}function Bv(e,t){return I(e,t)}var ji=null,Ws=null,xd=!1,Mi=!1,vd=!1,zr=0;function Uo(e){e!==Ws&&e.next===null&&(Ws===null?ji=Ws=e:Ws=Ws.next=e),Mi=!0,xd||(xd=!0,Hv())}function Wl(e,t){if(!vd&&Mi){vd=!0;do for(var r=!1,a=ji;a!==null;){if(e!==0){var d=a.pendingLanes;if(d===0)var h=0;else{var v=a.suspendedLanes,M=a.pingedLanes;h=(1<<31-ft(42|e)+1)-1,h&=d&~(v&~M),h=h&201326741?h&201326741|1:h?h|2:0}h!==0&&(r=!0,Ng(a,h))}else h=Dt,h=Oe(a,a===rn?h:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),(h&3)===0||Ke(a,h)||(r=!0,Ng(a,h));a=a.next}while(r);vd=!1}}function zv(){vg()}function vg(){Mi=xd=!1;var e=0;zr!==0&&Yv()&&(e=zr);for(var t=me(),r=null,a=ji;a!==null;){var d=a.next,h=wg(a,t);h===0?(a.next=null,r===null?ji=d:r.next=d,d===null&&(Ws=r)):(r=a,(e!==0||(h&3)!==0)&&(Mi=!0)),a=d}En!==0&&En!==5||Wl(e),zr!==0&&(zr=0)}function wg(e,t){for(var r=e.suspendedLanes,a=e.pingedLanes,d=e.expirationTimes,h=e.pendingLanes&-62914561;0<h;){var v=31-ft(h),M=1<<v,G=d[v];G===-1?((M&r)===0||(M&a)!==0)&&(d[v]=we(M,t)):G<=t&&(e.expiredLanes|=M),h&=~M}if(t=rn,r=Dt,r=Oe(e,e===t?r:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),a=e.callbackNode,r===0||e===t&&(Qt===2||Qt===9)||e.cancelPendingCommit!==null)return a!==null&&a!==null&&B(a),e.callbackNode=null,e.callbackPriority=0;if((r&3)===0||Ke(e,r)){if(t=r&-r,t===e.callbackPriority)return t;switch(a!==null&&B(a),ht(r)){case 2:case 8:r=ie;break;case 32:r=_e;break;case 268435456:r=Ze;break;default:r=_e}return a=Sg.bind(null,e),r=I(r,a),e.callbackPriority=t,e.callbackNode=r,t}return a!==null&&a!==null&&B(a),e.callbackPriority=2,e.callbackNode=null,2}function Sg(e,t){if(En!==0&&En!==5)return e.callbackNode=null,e.callbackPriority=0,null;var r=e.callbackNode;if(ki()&&e.callbackNode!==r)return null;var a=Dt;return a=Oe(e,e===rn?a:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),a===0?null:(og(e,a,t),wg(e,me()),e.callbackNode!=null&&e.callbackNode===r?Sg.bind(null,e):null)}function Ng(e,t){if(ki())return null;og(e,t,!0)}function Hv(){Xv(function(){(Ft&6)!==0?I(F,zv):vg()})}function wd(){if(zr===0){var e=Is;e===0&&(e=ye,ye<<=1,(ye&261888)===0&&(ye=256)),zr=e}return zr}function Cg(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:_t(""+e)}function kg(e,t){var r=t.ownerDocument.createElement("input");return r.name=t.name,r.value=t.value,e.id&&r.setAttribute("form",e.id),t.parentNode.insertBefore(r,t),e=new FormData(e),r.parentNode.removeChild(r),e}function Vv(e,t,r,a,d){if(t==="submit"&&r&&r.stateNode===d){var h=Cg((d[It]||null).action),v=a.submitter;v&&(t=(t=v[It]||null)?Cg(t.formAction):v.getAttribute("formAction"),t!==null&&(h=t,v=null));var M=new Ha("action","action",null,a,d);e.push({event:M,listeners:[{instance:null,listener:function(){if(a.defaultPrevented){if(zr!==0){var G=v?kg(d,v):new FormData(d);Kc(r,{pending:!0,data:G,method:d.method,action:h},null,G)}}else typeof h=="function"&&(M.preventDefault(),G=v?kg(d,v):new FormData(d),Kc(r,{pending:!0,data:G,method:d.method,action:h},h,G))},currentTarget:d}]})}}for(var Sd=0;Sd<rc.length;Sd++){var Nd=rc[Sd],Kv=Nd.toLowerCase(),Uv=Nd[0].toUpperCase()+Nd.slice(1);To(Kv,"on"+Uv)}To(nh,"onAnimationEnd"),To(oh,"onAnimationIteration"),To(rh,"onAnimationStart"),To("dblclick","onDoubleClick"),To("focusin","onFocus"),To("focusout","onBlur"),To(rv,"onTransitionRun"),To(sv,"onTransitionStart"),To(lv,"onTransitionCancel"),To(sh,"onTransitionEnd"),Je("onMouseEnter",["mouseout","mouseover"]),Je("onMouseLeave",["mouseout","mouseover"]),Je("onPointerEnter",["pointerout","pointerover"]),Je("onPointerLeave",["pointerout","pointerover"]),qe("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),qe("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),qe("onBeforeInput",["compositionend","keypress","textInput","paste"]),qe("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),qe("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),qe("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Gl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),$v=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Gl));function jg(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var a=e[r],d=a.event;a=a.listeners;e:{var h=void 0;if(t)for(var v=a.length-1;0<=v;v--){var M=a[v],G=M.instance,ge=M.currentTarget;if(M=M.listener,G!==h&&d.isPropagationStopped())break e;h=M,d.currentTarget=ge;try{h(d)}catch(Be){Ua(Be)}d.currentTarget=null,h=G}else for(v=0;v<a.length;v++){if(M=a[v],G=M.instance,ge=M.currentTarget,M=M.listener,G!==h&&d.isPropagationStopped())break e;h=M,d.currentTarget=ge;try{h(d)}catch(Be){Ua(Be)}d.currentTarget=null,h=G}}}}function Rt(e,t){var r=t[pn];r===void 0&&(r=t[pn]=new Set);var a=e+"__bubble";r.has(a)||(Mg(t,e,2,!1),r.add(a))}function Cd(e,t,r){var a=0;t&&(a|=4),Mg(r,e,a,t)}var Oi="_reactListening"+Math.random().toString(36).slice(2);function kd(e){if(!e[Oi]){e[Oi]=!0,Pe.forEach(function(r){r!=="selectionchange"&&($v.has(r)||Cd(r,!1,e),Cd(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Oi]||(t[Oi]=!0,Cd("selectionchange",!1,t))}}function Mg(e,t,r,a){switch(n0(t)){case 2:var d=y1;break;case 8:d=b1;break;default:d=Vd}r=d.bind(null,t,r,e),d=void 0,!qu||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(d=!0),a?d!==void 0?e.addEventListener(t,r,{capture:!0,passive:d}):e.addEventListener(t,r,!0):d!==void 0?e.addEventListener(t,r,{passive:d}):e.addEventListener(t,r,!1)}function jd(e,t,r,a,d){var h=a;if((t&1)===0&&(t&2)===0&&a!==null)e:for(;;){if(a===null)return;var v=a.tag;if(v===3||v===4){var M=a.stateNode.containerInfo;if(M===d)break;if(v===4)for(v=a.return;v!==null;){var G=v.tag;if((G===3||G===4)&&v.stateNode.containerInfo===d)return;v=v.return}for(;M!==null;){if(v=ze(M),v===null)return;if(G=v.tag,G===5||G===6||G===26||G===27){a=h=v;continue e}M=M.parentNode}}a=a.return}Lp(function(){var ge=h,Be=Yr(r),Ve=[];e:{var ve=lh.get(e);if(ve!==void 0){var Te=Ha,ut=e;switch(e){case"keypress":if(Ba(r)===0)break e;case"keydown":case"keyup":Te=Dx;break;case"focusin":ut="focus",Te=Yu;break;case"focusout":ut="blur",Te=Yu;break;case"beforeblur":case"afterblur":Te=Yu;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Te=_p;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Te=Cx;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Te=Hx;break;case nh:case oh:case rh:Te=Mx;break;case sh:Te=Kx;break;case"scroll":case"scrollend":Te=Sx;break;case"wheel":Te=$x;break;case"copy":case"cut":case"paste":Te=Tx;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Te=Bp;break;case"toggle":case"beforetoggle":Te=qx}var xt=(t&4)!==0,tn=!xt&&(e==="scroll"||e==="scrollend"),le=xt?ve!==null?ve+"Capture":null:ve;xt=[];for(var J=ge,he;J!==null;){var He=J;if(he=He.stateNode,He=He.tag,He!==5&&He!==26&&He!==27||he===null||le===null||(He=ml(J,le),He!=null&&xt.push(Pl(J,He,he))),tn)break;J=J.return}0<xt.length&&(ve=new Te(ve,ut,null,r,Be),Ve.push({event:ve,listeners:xt}))}}if((t&7)===0){e:{if(ve=e==="mouseover"||e==="pointerover",Te=e==="mouseout"||e==="pointerout",ve&&r!==hl&&(ut=r.relatedTarget||r.fromElement)&&(ze(ut)||ut[dn]))break e;if((Te||ve)&&(ve=Be.window===Be?Be:(ve=Be.ownerDocument)?ve.defaultView||ve.parentWindow:window,Te?(ut=r.relatedTarget||r.toElement,Te=ge,ut=ut?ze(ut):null,ut!==null&&(tn=c(ut),xt=ut.tag,ut!==tn||xt!==5&&xt!==27&&xt!==6)&&(ut=null)):(Te=null,ut=ge),Te!==ut)){if(xt=_p,He="onMouseLeave",le="onMouseEnter",J="mouse",(e==="pointerout"||e==="pointerover")&&(xt=Bp,He="onPointerLeave",le="onPointerEnter",J="pointer"),tn=Te==null?ve:et(Te),he=ut==null?ve:et(ut),ve=new xt(He,J+"leave",Te,r,Be),ve.target=tn,ve.relatedTarget=he,He=null,ze(Be)===ge&&(xt=new xt(le,J+"enter",ut,r,Be),xt.target=he,xt.relatedTarget=tn,He=xt),tn=He,Te&&ut)t:{for(xt=Fv,le=Te,J=ut,he=0,He=le;He;He=xt(He))he++;He=0;for(var mt=J;mt;mt=xt(mt))He++;for(;0<he-He;)le=xt(le),he--;for(;0<He-he;)J=xt(J),He--;for(;he--;){if(le===J||J!==null&&le===J.alternate){xt=le;break t}le=xt(le),J=xt(J)}xt=null}else xt=null;Te!==null&&Og(Ve,ve,Te,xt,!1),ut!==null&&tn!==null&&Og(Ve,tn,ut,xt,!0)}}e:{if(ve=ge?et(ge):window,Te=ve.nodeName&&ve.nodeName.toLowerCase(),Te==="select"||Te==="input"&&ve.type==="file")var Kt=qp;else if($p(ve))if(Wp)Kt=tv;else{Kt=Jx;var ct=Zx}else Te=ve.nodeName,!Te||Te.toLowerCase()!=="input"||ve.type!=="checkbox"&&ve.type!=="radio"?ge&&dt(ge.elementType)&&(Kt=qp):Kt=ev;if(Kt&&(Kt=Kt(e,ge))){Fp(Ve,Kt,r,Be);break e}ct&&ct(e,ve,ge),e==="focusout"&&ge&&ve.type==="number"&&ge.memoizedProps.value!=null&&xs(ve,"number",ve.value)}switch(ct=ge?et(ge):window,e){case"focusin":($p(ct)||ct.contentEditable==="true")&&(Ns=ct,tc=ge,Nl=null);break;case"focusout":Nl=tc=Ns=null;break;case"mousedown":nc=!0;break;case"contextmenu":case"mouseup":case"dragend":nc=!1,eh(Ve,r,Be);break;case"selectionchange":if(ov)break;case"keydown":case"keyup":eh(Ve,r,Be)}var Ot;if(Xu)e:{switch(e){case"compositionstart":var Bt="onCompositionStart";break e;case"compositionend":Bt="onCompositionEnd";break e;case"compositionupdate":Bt="onCompositionUpdate";break e}Bt=void 0}else Ss?Kp(e,r)&&(Bt="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(Bt="onCompositionStart");Bt&&(zp&&r.locale!=="ko"&&(Ss||Bt!=="onCompositionStart"?Bt==="onCompositionEnd"&&Ss&&(Ot=Ap()):(Sr=Be,Wu="value"in Sr?Sr.value:Sr.textContent,Ss=!0)),ct=Ti(ge,Bt),0<ct.length&&(Bt=new Dp(Bt,e,null,r,Be),Ve.push({event:Bt,listeners:ct}),Ot?Bt.data=Ot:(Ot=Up(r),Ot!==null&&(Bt.data=Ot)))),(Ot=Gx?Px(e,r):Yx(e,r))&&(Bt=Ti(ge,"onBeforeInput"),0<Bt.length&&(ct=new Dp("onBeforeInput","beforeinput",null,r,Be),Ve.push({event:ct,listeners:Bt}),ct.data=Ot)),Vv(Ve,e,ge,r,Be)}jg(Ve,t)})}function Pl(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Ti(e,t){for(var r=t+"Capture",a=[];e!==null;){var d=e,h=d.stateNode;if(d=d.tag,d!==5&&d!==26&&d!==27||h===null||(d=ml(e,r),d!=null&&a.unshift(Pl(e,d,h)),d=ml(e,t),d!=null&&a.push(Pl(e,d,h))),e.tag===3)return a;e=e.return}return[]}function Fv(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function Og(e,t,r,a,d){for(var h=t._reactName,v=[];r!==null&&r!==a;){var M=r,G=M.alternate,ge=M.stateNode;if(M=M.tag,G!==null&&G===a)break;M!==5&&M!==26&&M!==27||ge===null||(G=ge,d?(ge=ml(r,h),ge!=null&&v.unshift(Pl(r,ge,G))):d||(ge=ml(r,h),ge!=null&&v.push(Pl(r,ge,G)))),r=r.return}v.length!==0&&e.push({event:t,listeners:v})}var qv=/\r\n?/g,Wv=/\u0000|\uFFFD/g;function Tg(e){return(typeof e=="string"?e:""+e).replace(qv,`
`).replace(Wv,"")}function Eg(e,t){return t=Tg(t),Tg(e)===t}function en(e,t,r,a,d,h){switch(r){case"children":typeof a=="string"?t==="body"||t==="textarea"&&a===""||wr(e,a):(typeof a=="number"||typeof a=="bigint")&&t!=="body"&&wr(e,""+a);break;case"className":Tn(e,"class",a);break;case"tabIndex":Tn(e,"tabindex",a);break;case"dir":case"role":case"viewBox":case"width":case"height":Tn(e,r,a);break;case"style":rt(e,a,h);break;case"data":if(t!=="object"){Tn(e,"data",a);break}case"src":case"href":if(a===""&&(t!=="a"||r!=="href")){e.removeAttribute(r);break}if(a==null||typeof a=="function"||typeof a=="symbol"||typeof a=="boolean"){e.removeAttribute(r);break}a=_t(""+a),e.setAttribute(r,a);break;case"action":case"formAction":if(typeof a=="function"){e.setAttribute(r,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof h=="function"&&(r==="formAction"?(t!=="input"&&en(e,t,"name",d.name,d,null),en(e,t,"formEncType",d.formEncType,d,null),en(e,t,"formMethod",d.formMethod,d,null),en(e,t,"formTarget",d.formTarget,d,null)):(en(e,t,"encType",d.encType,d,null),en(e,t,"method",d.method,d,null),en(e,t,"target",d.target,d,null)));if(a==null||typeof a=="symbol"||typeof a=="boolean"){e.removeAttribute(r);break}a=_t(""+a),e.setAttribute(r,a);break;case"onClick":a!=null&&(e.onclick=yo);break;case"onScroll":a!=null&&Rt("scroll",e);break;case"onScrollEnd":a!=null&&Rt("scrollend",e);break;case"dangerouslySetInnerHTML":if(a!=null){if(typeof a!="object"||!("__html"in a))throw Error(l(61));if(r=a.__html,r!=null){if(d.children!=null)throw Error(l(60));e.innerHTML=r}}break;case"multiple":e.multiple=a&&typeof a!="function"&&typeof a!="symbol";break;case"muted":e.muted=a&&typeof a!="function"&&typeof a!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(a==null||typeof a=="function"||typeof a=="boolean"||typeof a=="symbol"){e.removeAttribute("xlink:href");break}r=_t(""+a),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",r);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":a!=null&&typeof a!="function"&&typeof a!="symbol"?e.setAttribute(r,""+a):e.removeAttribute(r);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":a&&typeof a!="function"&&typeof a!="symbol"?e.setAttribute(r,""):e.removeAttribute(r);break;case"capture":case"download":a===!0?e.setAttribute(r,""):a!==!1&&a!=null&&typeof a!="function"&&typeof a!="symbol"?e.setAttribute(r,a):e.removeAttribute(r);break;case"cols":case"rows":case"size":case"span":a!=null&&typeof a!="function"&&typeof a!="symbol"&&!isNaN(a)&&1<=a?e.setAttribute(r,a):e.removeAttribute(r);break;case"rowSpan":case"start":a==null||typeof a=="function"||typeof a=="symbol"||isNaN(a)?e.removeAttribute(r):e.setAttribute(r,a);break;case"popover":Rt("beforetoggle",e),Rt("toggle",e),on(e,"popover",a);break;case"xlinkActuate":xn(e,"http://www.w3.org/1999/xlink","xlink:actuate",a);break;case"xlinkArcrole":xn(e,"http://www.w3.org/1999/xlink","xlink:arcrole",a);break;case"xlinkRole":xn(e,"http://www.w3.org/1999/xlink","xlink:role",a);break;case"xlinkShow":xn(e,"http://www.w3.org/1999/xlink","xlink:show",a);break;case"xlinkTitle":xn(e,"http://www.w3.org/1999/xlink","xlink:title",a);break;case"xlinkType":xn(e,"http://www.w3.org/1999/xlink","xlink:type",a);break;case"xmlBase":xn(e,"http://www.w3.org/XML/1998/namespace","xml:base",a);break;case"xmlLang":xn(e,"http://www.w3.org/XML/1998/namespace","xml:lang",a);break;case"xmlSpace":xn(e,"http://www.w3.org/XML/1998/namespace","xml:space",a);break;case"is":on(e,"is",a);break;case"innerText":case"textContent":break;default:(!(2<r.length)||r[0]!=="o"&&r[0]!=="O"||r[1]!=="n"&&r[1]!=="N")&&(r=ln.get(r)||r,on(e,r,a))}}function Md(e,t,r,a,d,h){switch(r){case"style":rt(e,a,h);break;case"dangerouslySetInnerHTML":if(a!=null){if(typeof a!="object"||!("__html"in a))throw Error(l(61));if(r=a.__html,r!=null){if(d.children!=null)throw Error(l(60));e.innerHTML=r}}break;case"children":typeof a=="string"?wr(e,a):(typeof a=="number"||typeof a=="bigint")&&wr(e,""+a);break;case"onScroll":a!=null&&Rt("scroll",e);break;case"onScrollEnd":a!=null&&Rt("scrollend",e);break;case"onClick":a!=null&&(e.onclick=yo);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ne.hasOwnProperty(r))e:{if(r[0]==="o"&&r[1]==="n"&&(d=r.endsWith("Capture"),t=r.slice(2,d?r.length-7:void 0),h=e[It]||null,h=h!=null?h[r]:null,typeof h=="function"&&e.removeEventListener(t,h,d),typeof a=="function")){typeof h!="function"&&h!==null&&(r in e?e[r]=null:e.hasAttribute(r)&&e.removeAttribute(r)),e.addEventListener(t,a,d);break e}r in e?e[r]=a:a===!0?e.setAttribute(r,""):on(e,r,a)}}}function _n(e,t,r){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Rt("error",e),Rt("load",e);var a=!1,d=!1,h;for(h in r)if(r.hasOwnProperty(h)){var v=r[h];if(v!=null)switch(h){case"src":a=!0;break;case"srcSet":d=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(l(137,t));default:en(e,t,h,v,r,null)}}d&&en(e,t,"srcSet",r.srcSet,r,null),a&&en(e,t,"src",r.src,r,null);return;case"input":Rt("invalid",e);var M=h=v=d=null,G=null,ge=null;for(a in r)if(r.hasOwnProperty(a)){var Be=r[a];if(Be!=null)switch(a){case"name":d=Be;break;case"type":v=Be;break;case"checked":G=Be;break;case"defaultChecked":ge=Be;break;case"value":h=Be;break;case"defaultValue":M=Be;break;case"children":case"dangerouslySetInnerHTML":if(Be!=null)throw Error(l(137,t));break;default:en(e,t,a,Be,r,null)}}Aa(e,h,M,G,ge,v,d,!1);return;case"select":Rt("invalid",e),a=v=h=null;for(d in r)if(r.hasOwnProperty(d)&&(M=r[d],M!=null))switch(d){case"value":h=M;break;case"defaultValue":v=M;break;case"multiple":a=M;default:en(e,t,d,M,r,null)}t=h,r=v,e.multiple=!!a,t!=null?ro(e,!!a,t,!1):r!=null&&ro(e,!!a,r,!0);return;case"textarea":Rt("invalid",e),h=d=a=null;for(v in r)if(r.hasOwnProperty(v)&&(M=r[v],M!=null))switch(v){case"value":a=M;break;case"defaultValue":d=M;break;case"children":h=M;break;case"dangerouslySetInnerHTML":if(M!=null)throw Error(l(91));break;default:en(e,t,v,M,r,null)}_a(e,a,d,h);return;case"option":for(G in r)r.hasOwnProperty(G)&&(a=r[G],a!=null)&&(G==="selected"?e.selected=a&&typeof a!="function"&&typeof a!="symbol":en(e,t,G,a,r,null));return;case"dialog":Rt("beforetoggle",e),Rt("toggle",e),Rt("cancel",e),Rt("close",e);break;case"iframe":case"object":Rt("load",e);break;case"video":case"audio":for(a=0;a<Gl.length;a++)Rt(Gl[a],e);break;case"image":Rt("error",e),Rt("load",e);break;case"details":Rt("toggle",e);break;case"embed":case"source":case"link":Rt("error",e),Rt("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ge in r)if(r.hasOwnProperty(ge)&&(a=r[ge],a!=null))switch(ge){case"children":case"dangerouslySetInnerHTML":throw Error(l(137,t));default:en(e,t,ge,a,r,null)}return;default:if(dt(t)){for(Be in r)r.hasOwnProperty(Be)&&(a=r[Be],a!==void 0&&Md(e,t,Be,a,r,void 0));return}}for(M in r)r.hasOwnProperty(M)&&(a=r[M],a!=null&&en(e,t,M,a,r,null))}function Gv(e,t,r,a){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var d=null,h=null,v=null,M=null,G=null,ge=null,Be=null;for(Te in r){var Ve=r[Te];if(r.hasOwnProperty(Te)&&Ve!=null)switch(Te){case"checked":break;case"value":break;case"defaultValue":G=Ve;default:a.hasOwnProperty(Te)||en(e,t,Te,null,a,Ve)}}for(var ve in a){var Te=a[ve];if(Ve=r[ve],a.hasOwnProperty(ve)&&(Te!=null||Ve!=null))switch(ve){case"type":h=Te;break;case"name":d=Te;break;case"checked":ge=Te;break;case"defaultChecked":Be=Te;break;case"value":v=Te;break;case"defaultValue":M=Te;break;case"children":case"dangerouslySetInnerHTML":if(Te!=null)throw Error(l(137,t));break;default:Te!==Ve&&en(e,t,ve,Te,a,Ve)}}pl(e,v,M,G,ge,Be,h,d);return;case"select":Te=v=M=ve=null;for(h in r)if(G=r[h],r.hasOwnProperty(h)&&G!=null)switch(h){case"value":break;case"multiple":Te=G;default:a.hasOwnProperty(h)||en(e,t,h,null,a,G)}for(d in a)if(h=a[d],G=r[d],a.hasOwnProperty(d)&&(h!=null||G!=null))switch(d){case"value":ve=h;break;case"defaultValue":M=h;break;case"multiple":v=h;default:h!==G&&en(e,t,d,h,a,G)}t=M,r=v,a=Te,ve!=null?ro(e,!!r,ve,!1):!!a!=!!r&&(t!=null?ro(e,!!r,t,!0):ro(e,!!r,r?[]:"",!1));return;case"textarea":Te=ve=null;for(M in r)if(d=r[M],r.hasOwnProperty(M)&&d!=null&&!a.hasOwnProperty(M))switch(M){case"value":break;case"children":break;default:en(e,t,M,null,a,d)}for(v in a)if(d=a[v],h=r[v],a.hasOwnProperty(v)&&(d!=null||h!=null))switch(v){case"value":ve=d;break;case"defaultValue":Te=d;break;case"children":break;case"dangerouslySetInnerHTML":if(d!=null)throw Error(l(91));break;default:d!==h&&en(e,t,v,d,a,h)}Ra(e,ve,Te);return;case"option":for(var ut in r)ve=r[ut],r.hasOwnProperty(ut)&&ve!=null&&!a.hasOwnProperty(ut)&&(ut==="selected"?e.selected=!1:en(e,t,ut,null,a,ve));for(G in a)ve=a[G],Te=r[G],a.hasOwnProperty(G)&&ve!==Te&&(ve!=null||Te!=null)&&(G==="selected"?e.selected=ve&&typeof ve!="function"&&typeof ve!="symbol":en(e,t,G,ve,a,Te));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var xt in r)ve=r[xt],r.hasOwnProperty(xt)&&ve!=null&&!a.hasOwnProperty(xt)&&en(e,t,xt,null,a,ve);for(ge in a)if(ve=a[ge],Te=r[ge],a.hasOwnProperty(ge)&&ve!==Te&&(ve!=null||Te!=null))switch(ge){case"children":case"dangerouslySetInnerHTML":if(ve!=null)throw Error(l(137,t));break;default:en(e,t,ge,ve,a,Te)}return;default:if(dt(t)){for(var tn in r)ve=r[tn],r.hasOwnProperty(tn)&&ve!==void 0&&!a.hasOwnProperty(tn)&&Md(e,t,tn,void 0,a,ve);for(Be in a)ve=a[Be],Te=r[Be],!a.hasOwnProperty(Be)||ve===Te||ve===void 0&&Te===void 0||Md(e,t,Be,ve,a,Te);return}}for(var le in r)ve=r[le],r.hasOwnProperty(le)&&ve!=null&&!a.hasOwnProperty(le)&&en(e,t,le,null,a,ve);for(Ve in a)ve=a[Ve],Te=r[Ve],!a.hasOwnProperty(Ve)||ve===Te||ve==null&&Te==null||en(e,t,Ve,ve,a,Te)}function Ig(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Pv(){if(typeof performance.getEntriesByType=="function"){for(var e=0,t=0,r=performance.getEntriesByType("resource"),a=0;a<r.length;a++){var d=r[a],h=d.transferSize,v=d.initiatorType,M=d.duration;if(h&&M&&Ig(v)){for(v=0,M=d.responseEnd,a+=1;a<r.length;a++){var G=r[a],ge=G.startTime;if(ge>M)break;var Be=G.transferSize,Ve=G.initiatorType;Be&&Ig(Ve)&&(G=G.responseEnd,v+=Be*(G<M?1:(M-ge)/(G-ge)))}if(--a,t+=8*(h+v)/(d.duration/1e3),e++,10<e)break}}if(0<e)return t/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var Od=null,Td=null;function Ei(e){return e.nodeType===9?e:e.ownerDocument}function Lg(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Ag(e,t){if(e===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&t==="foreignObject"?0:e}function Ed(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Id=null;function Yv(){var e=window.event;return e&&e.type==="popstate"?e===Id?!1:(Id=e,!0):(Id=null,!1)}var Rg=typeof setTimeout=="function"?setTimeout:void 0,Qv=typeof clearTimeout=="function"?clearTimeout:void 0,_g=typeof Promise=="function"?Promise:void 0,Xv=typeof queueMicrotask=="function"?queueMicrotask:typeof _g<"u"?function(e){return _g.resolve(null).then(e).catch(Zv)}:Rg;function Zv(e){setTimeout(function(){throw e})}function Hr(e){return e==="head"}function Dg(e,t){var r=t,a=0;do{var d=r.nextSibling;if(e.removeChild(r),d&&d.nodeType===8)if(r=d.data,r==="/$"||r==="/&"){if(a===0){e.removeChild(d),Qs(t);return}a--}else if(r==="$"||r==="$?"||r==="$~"||r==="$!"||r==="&")a++;else if(r==="html")Yl(e.ownerDocument.documentElement);else if(r==="head"){r=e.ownerDocument.head,Yl(r);for(var h=r.firstChild;h;){var v=h.nextSibling,M=h.nodeName;h[oo]||M==="SCRIPT"||M==="STYLE"||M==="LINK"&&h.rel.toLowerCase()==="stylesheet"||r.removeChild(h),h=v}}else r==="body"&&Yl(e.ownerDocument.body);r=d}while(r);Qs(t)}function Bg(e,t){var r=e;e=0;do{var a=r.nextSibling;if(r.nodeType===1?t?(r._stashedDisplay=r.style.display,r.style.display="none"):(r.style.display=r._stashedDisplay||"",r.getAttribute("style")===""&&r.removeAttribute("style")):r.nodeType===3&&(t?(r._stashedText=r.nodeValue,r.nodeValue=""):r.nodeValue=r._stashedText||""),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(e===0)break;e--}else r!=="$"&&r!=="$?"&&r!=="$~"&&r!=="$!"||e++;r=a}while(r)}function Ld(e){var t=e.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var r=t;switch(t=t.nextSibling,r.nodeName){case"HTML":case"HEAD":case"BODY":Ld(r),X(r);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(r.rel.toLowerCase()==="stylesheet")continue}e.removeChild(r)}}function Jv(e,t,r,a){for(;e.nodeType===1;){var d=r;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!a&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(a){if(!e[oo])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(h=e.getAttribute("rel"),h==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(h!==d.rel||e.getAttribute("href")!==(d.href==null||d.href===""?null:d.href)||e.getAttribute("crossorigin")!==(d.crossOrigin==null?null:d.crossOrigin)||e.getAttribute("title")!==(d.title==null?null:d.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(h=e.getAttribute("src"),(h!==(d.src==null?null:d.src)||e.getAttribute("type")!==(d.type==null?null:d.type)||e.getAttribute("crossorigin")!==(d.crossOrigin==null?null:d.crossOrigin))&&h&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(t==="input"&&e.type==="hidden"){var h=d.name==null?null:""+d.name;if(d.type==="hidden"&&e.getAttribute("name")===h)return e}else return e;if(e=Co(e.nextSibling),e===null)break}return null}function e1(e,t,r){if(t==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!r||(e=Co(e.nextSibling),e===null))return null;return e}function zg(e,t){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!t||(e=Co(e.nextSibling),e===null))return null;return e}function Ad(e){return e.data==="$?"||e.data==="$~"}function Rd(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function t1(e,t){var r=e.ownerDocument;if(e.data==="$~")e._reactRetry=t;else if(e.data!=="$?"||r.readyState!=="loading")t();else{var a=function(){t(),r.removeEventListener("DOMContentLoaded",a)};r.addEventListener("DOMContentLoaded",a),e._reactRetry=a}}function Co(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?"||t==="$~"||t==="&"||t==="F!"||t==="F")break;if(t==="/$"||t==="/&")return null}}return e}var _d=null;function Hg(e){e=e.nextSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"||r==="/&"){if(t===0)return Co(e.nextSibling);t--}else r!=="$"&&r!=="$!"&&r!=="$?"&&r!=="$~"&&r!=="&"||t++}e=e.nextSibling}return null}function Vg(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"){if(t===0)return e;t--}else r!=="/$"&&r!=="/&"||t++}e=e.previousSibling}return null}function Kg(e,t,r){switch(t=Ei(r),e){case"html":if(e=t.documentElement,!e)throw Error(l(452));return e;case"head":if(e=t.head,!e)throw Error(l(453));return e;case"body":if(e=t.body,!e)throw Error(l(454));return e;default:throw Error(l(451))}}function Yl(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);X(e)}var ko=new Map,Ug=new Set;function Ii(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var fr=se.d;se.d={f:n1,r:o1,D:r1,C:s1,L:l1,m:a1,X:u1,S:i1,M:c1};function n1(){var e=fr.f(),t=Si();return e||t}function o1(e){var t=oe(e);t!==null&&t.tag===5&&t.type==="form"?sm(t):fr.r(e)}var Gs=typeof document>"u"?null:document;function $g(e,t,r){var a=Gs;if(a&&typeof t=="string"&&t){var d=Bn(t);d='link[rel="'+e+'"][href="'+d+'"]',typeof r=="string"&&(d+='[crossorigin="'+r+'"]'),Ug.has(d)||(Ug.add(d),e={rel:e,crossOrigin:r,href:t},a.querySelector(d)===null&&(t=a.createElement("link"),_n(t,"link",e),Qe(t),a.head.appendChild(t)))}}function r1(e){fr.D(e),$g("dns-prefetch",e,null)}function s1(e,t){fr.C(e,t),$g("preconnect",e,t)}function l1(e,t,r){fr.L(e,t,r);var a=Gs;if(a&&e&&t){var d='link[rel="preload"][as="'+Bn(t)+'"]';t==="image"&&r&&r.imageSrcSet?(d+='[imagesrcset="'+Bn(r.imageSrcSet)+'"]',typeof r.imageSizes=="string"&&(d+='[imagesizes="'+Bn(r.imageSizes)+'"]')):d+='[href="'+Bn(e)+'"]';var h=d;switch(t){case"style":h=Ps(e);break;case"script":h=Ys(e)}ko.has(h)||(e=x({rel:"preload",href:t==="image"&&r&&r.imageSrcSet?void 0:e,as:t},r),ko.set(h,e),a.querySelector(d)!==null||t==="style"&&a.querySelector(Ql(h))||t==="script"&&a.querySelector(Xl(h))||(t=a.createElement("link"),_n(t,"link",e),Qe(t),a.head.appendChild(t)))}}function a1(e,t){fr.m(e,t);var r=Gs;if(r&&e){var a=t&&typeof t.as=="string"?t.as:"script",d='link[rel="modulepreload"][as="'+Bn(a)+'"][href="'+Bn(e)+'"]',h=d;switch(a){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":h=Ys(e)}if(!ko.has(h)&&(e=x({rel:"modulepreload",href:e},t),ko.set(h,e),r.querySelector(d)===null)){switch(a){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(r.querySelector(Xl(h)))return}a=r.createElement("link"),_n(a,"link",e),Qe(a),r.head.appendChild(a)}}}function i1(e,t,r){fr.S(e,t,r);var a=Gs;if(a&&e){var d=Xe(a).hoistableStyles,h=Ps(e);t=t||"default";var v=d.get(h);if(!v){var M={loading:0,preload:null};if(v=a.querySelector(Ql(h)))M.loading=5;else{e=x({rel:"stylesheet",href:e,"data-precedence":t},r),(r=ko.get(h))&&Dd(e,r);var G=v=a.createElement("link");Qe(G),_n(G,"link",e),G._p=new Promise(function(ge,Be){G.onload=ge,G.onerror=Be}),G.addEventListener("load",function(){M.loading|=1}),G.addEventListener("error",function(){M.loading|=2}),M.loading|=4,Li(v,t,a)}v={type:"stylesheet",instance:v,count:1,state:M},d.set(h,v)}}}function u1(e,t){fr.X(e,t);var r=Gs;if(r&&e){var a=Xe(r).hoistableScripts,d=Ys(e),h=a.get(d);h||(h=r.querySelector(Xl(d)),h||(e=x({src:e,async:!0},t),(t=ko.get(d))&&Bd(e,t),h=r.createElement("script"),Qe(h),_n(h,"link",e),r.head.appendChild(h)),h={type:"script",instance:h,count:1,state:null},a.set(d,h))}}function c1(e,t){fr.M(e,t);var r=Gs;if(r&&e){var a=Xe(r).hoistableScripts,d=Ys(e),h=a.get(d);h||(h=r.querySelector(Xl(d)),h||(e=x({src:e,async:!0,type:"module"},t),(t=ko.get(d))&&Bd(e,t),h=r.createElement("script"),Qe(h),_n(h,"link",e),r.head.appendChild(h)),h={type:"script",instance:h,count:1,state:null},a.set(d,h))}}function Fg(e,t,r,a){var d=(d=We.current)?Ii(d):null;if(!d)throw Error(l(446));switch(e){case"meta":case"title":return null;case"style":return typeof r.precedence=="string"&&typeof r.href=="string"?(t=Ps(r.href),r=Xe(d).hoistableStyles,a=r.get(t),a||(a={type:"style",instance:null,count:0,state:null},r.set(t,a)),a):{type:"void",instance:null,count:0,state:null};case"link":if(r.rel==="stylesheet"&&typeof r.href=="string"&&typeof r.precedence=="string"){e=Ps(r.href);var h=Xe(d).hoistableStyles,v=h.get(e);if(v||(d=d.ownerDocument||d,v={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},h.set(e,v),(h=d.querySelector(Ql(e)))&&!h._p&&(v.instance=h,v.state.loading=5),ko.has(e)||(r={rel:"preload",as:"style",href:r.href,crossOrigin:r.crossOrigin,integrity:r.integrity,media:r.media,hrefLang:r.hrefLang,referrerPolicy:r.referrerPolicy},ko.set(e,r),h||d1(d,e,r,v.state))),t&&a===null)throw Error(l(528,""));return v}if(t&&a!==null)throw Error(l(529,""));return null;case"script":return t=r.async,r=r.src,typeof r=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=Ys(r),r=Xe(d).hoistableScripts,a=r.get(t),a||(a={type:"script",instance:null,count:0,state:null},r.set(t,a)),a):{type:"void",instance:null,count:0,state:null};default:throw Error(l(444,e))}}function Ps(e){return'href="'+Bn(e)+'"'}function Ql(e){return'link[rel="stylesheet"]['+e+"]"}function qg(e){return x({},e,{"data-precedence":e.precedence,precedence:null})}function d1(e,t,r,a){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?a.loading=1:(t=e.createElement("link"),a.preload=t,t.addEventListener("load",function(){return a.loading|=1}),t.addEventListener("error",function(){return a.loading|=2}),_n(t,"link",r),Qe(t),e.head.appendChild(t))}function Ys(e){return'[src="'+Bn(e)+'"]'}function Xl(e){return"script[async]"+e}function Wg(e,t,r){if(t.count++,t.instance===null)switch(t.type){case"style":var a=e.querySelector('style[data-href~="'+Bn(r.href)+'"]');if(a)return t.instance=a,Qe(a),a;var d=x({},r,{"data-href":r.href,"data-precedence":r.precedence,href:null,precedence:null});return a=(e.ownerDocument||e).createElement("style"),Qe(a),_n(a,"style",d),Li(a,r.precedence,e),t.instance=a;case"stylesheet":d=Ps(r.href);var h=e.querySelector(Ql(d));if(h)return t.state.loading|=4,t.instance=h,Qe(h),h;a=qg(r),(d=ko.get(d))&&Dd(a,d),h=(e.ownerDocument||e).createElement("link"),Qe(h);var v=h;return v._p=new Promise(function(M,G){v.onload=M,v.onerror=G}),_n(h,"link",a),t.state.loading|=4,Li(h,r.precedence,e),t.instance=h;case"script":return h=Ys(r.src),(d=e.querySelector(Xl(h)))?(t.instance=d,Qe(d),d):(a=r,(d=ko.get(h))&&(a=x({},r),Bd(a,d)),e=e.ownerDocument||e,d=e.createElement("script"),Qe(d),_n(d,"link",a),e.head.appendChild(d),t.instance=d);case"void":return null;default:throw Error(l(443,t.type))}else t.type==="stylesheet"&&(t.state.loading&4)===0&&(a=t.instance,t.state.loading|=4,Li(a,r.precedence,e));return t.instance}function Li(e,t,r){for(var a=r.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),d=a.length?a[a.length-1]:null,h=d,v=0;v<a.length;v++){var M=a[v];if(M.dataset.precedence===t)h=M;else if(h!==d)break}h?h.parentNode.insertBefore(e,h.nextSibling):(t=r.nodeType===9?r.head:r,t.insertBefore(e,t.firstChild))}function Dd(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.title==null&&(e.title=t.title)}function Bd(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.integrity==null&&(e.integrity=t.integrity)}var Ai=null;function Gg(e,t,r){if(Ai===null){var a=new Map,d=Ai=new Map;d.set(r,a)}else d=Ai,a=d.get(r),a||(a=new Map,d.set(r,a));if(a.has(e))return a;for(a.set(e,null),r=r.getElementsByTagName(e),d=0;d<r.length;d++){var h=r[d];if(!(h[oo]||h[Gt]||e==="link"&&h.getAttribute("rel")==="stylesheet")&&h.namespaceURI!=="http://www.w3.org/2000/svg"){var v=h.getAttribute(t)||"";v=e+v;var M=a.get(v);M?M.push(h):a.set(v,[h])}}return a}function Pg(e,t,r){e=e.ownerDocument||e,e.head.insertBefore(r,t==="title"?e.querySelector("head > title"):null)}function f1(e,t,r){if(r===1||t.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;return t.rel==="stylesheet"?(e=t.disabled,typeof t.precedence=="string"&&e==null):!0;case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function Yg(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function p1(e,t,r,a){if(r.type==="stylesheet"&&(typeof a.media!="string"||matchMedia(a.media).matches!==!1)&&(r.state.loading&4)===0){if(r.instance===null){var d=Ps(a.href),h=t.querySelector(Ql(d));if(h){t=h._p,t!==null&&typeof t=="object"&&typeof t.then=="function"&&(e.count++,e=Ri.bind(e),t.then(e,e)),r.state.loading|=4,r.instance=h,Qe(h);return}h=t.ownerDocument||t,a=qg(a),(d=ko.get(d))&&Dd(a,d),h=h.createElement("link"),Qe(h);var v=h;v._p=new Promise(function(M,G){v.onload=M,v.onerror=G}),_n(h,"link",a),r.instance=h}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(r,t),(t=r.state.preload)&&(r.state.loading&3)===0&&(e.count++,r=Ri.bind(e),t.addEventListener("load",r),t.addEventListener("error",r))}}var zd=0;function h1(e,t){return e.stylesheets&&e.count===0&&Di(e,e.stylesheets),0<e.count||0<e.imgCount?function(r){var a=setTimeout(function(){if(e.stylesheets&&Di(e,e.stylesheets),e.unsuspend){var h=e.unsuspend;e.unsuspend=null,h()}},6e4+t);0<e.imgBytes&&zd===0&&(zd=62500*Pv());var d=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&Di(e,e.stylesheets),e.unsuspend)){var h=e.unsuspend;e.unsuspend=null,h()}},(e.imgBytes>zd?50:800)+t);return e.unsuspend=r,function(){e.unsuspend=null,clearTimeout(a),clearTimeout(d)}}:null}function Ri(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Di(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var _i=null;function Di(e,t){e.stylesheets=null,e.unsuspend!==null&&(e.count++,_i=new Map,t.forEach(m1,e),_i=null,Ri.call(e))}function m1(e,t){if(!(t.state.loading&4)){var r=_i.get(e);if(r)var a=r.get(null);else{r=new Map,_i.set(e,r);for(var d=e.querySelectorAll("link[data-precedence],style[data-precedence]"),h=0;h<d.length;h++){var v=d[h];(v.nodeName==="LINK"||v.getAttribute("media")!=="not all")&&(r.set(v.dataset.precedence,v),a=v)}a&&r.set(null,a)}d=t.instance,v=d.getAttribute("data-precedence"),h=r.get(v)||a,h===a&&r.set(null,d),r.set(v,d),this.count++,a=Ri.bind(this),d.addEventListener("load",a),d.addEventListener("error",a),h?h.parentNode.insertBefore(d,h.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(d,e.firstChild)),t.state.loading|=4}}var Zl={$$typeof:V,Provider:null,Consumer:null,_currentValue:ce,_currentValue2:ce,_threadCount:0};function g1(e,t,r,a,d,h,v,M,G){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ot(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ot(0),this.hiddenUpdates=ot(null),this.identifierPrefix=a,this.onUncaughtError=d,this.onCaughtError=h,this.onRecoverableError=v,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=G,this.incompleteTransitions=new Map}function Qg(e,t,r,a,d,h,v,M,G,ge,Be,Ve){return e=new g1(e,t,r,v,G,ge,Be,Ve,M),t=1,h===!0&&(t|=24),h=lo(3,null,null,t),e.current=h,h.stateNode=e,t=yc(),t.refCount++,e.pooledCache=t,t.refCount++,h.memoizedState={element:a,isDehydrated:r,cache:t},wc(h),e}function Xg(e){return e?(e=js,e):js}function Zg(e,t,r,a,d,h){d=Xg(d),a.context===null?a.context=d:a.pendingContext=d,a=Or(t),a.payload={element:r},h=h===void 0?null:h,h!==null&&(a.callback=h),r=Tr(e,a,t),r!==null&&(Zn(r,e,t),El(r,e,t))}function Jg(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Hd(e,t){Jg(e,t),(e=e.alternate)&&Jg(e,t)}function e0(e){if(e.tag===13||e.tag===31){var t=Jr(e,67108864);t!==null&&Zn(t,e,67108864),Hd(e,67108864)}}function t0(e){if(e.tag===13||e.tag===31){var t=fo();t=yt(t);var r=Jr(e,t);r!==null&&Zn(r,e,t),Hd(e,t)}}var Bi=!0;function y1(e,t,r,a){var d=_.T;_.T=null;var h=se.p;try{se.p=2,Vd(e,t,r,a)}finally{se.p=h,_.T=d}}function b1(e,t,r,a){var d=_.T;_.T=null;var h=se.p;try{se.p=8,Vd(e,t,r,a)}finally{se.p=h,_.T=d}}function Vd(e,t,r,a){if(Bi){var d=Kd(a);if(d===null)jd(e,t,a,zi,r),o0(e,a);else if(v1(d,e,t,r,a))a.stopPropagation();else if(o0(e,a),t&4&&-1<x1.indexOf(e)){for(;d!==null;){var h=oe(d);if(h!==null)switch(h.tag){case 3:if(h=h.stateNode,h.current.memoizedState.isDehydrated){var v=de(h.pendingLanes);if(v!==0){var M=h;for(M.pendingLanes|=2,M.entangledLanes|=2;v;){var G=1<<31-ft(v);M.entanglements[1]|=G,v&=~G}Uo(h),(Ft&6)===0&&(vi=me()+500,Wl(0))}}break;case 31:case 13:M=Jr(h,2),M!==null&&Zn(M,h,2),Si(),Hd(h,2)}if(h=Kd(a),h===null&&jd(e,t,a,zi,r),h===d)break;d=h}d!==null&&a.stopPropagation()}else jd(e,t,a,null,r)}}function Kd(e){return e=Yr(e),Ud(e)}var zi=null;function Ud(e){if(zi=null,e=ze(e),e!==null){var t=c(e);if(t===null)e=null;else{var r=t.tag;if(r===13){if(e=f(t),e!==null)return e;e=null}else if(r===31){if(e=m(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return zi=e,null}function n0(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ke()){case F:return 2;case ie:return 8;case _e:case $e:return 32;case Ze:return 268435456;default:return 32}default:return 32}}var $d=!1,Vr=null,Kr=null,Ur=null,Jl=new Map,ea=new Map,$r=[],x1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function o0(e,t){switch(e){case"focusin":case"focusout":Vr=null;break;case"dragenter":case"dragleave":Kr=null;break;case"mouseover":case"mouseout":Ur=null;break;case"pointerover":case"pointerout":Jl.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":ea.delete(t.pointerId)}}function ta(e,t,r,a,d,h){return e===null||e.nativeEvent!==h?(e={blockedOn:t,domEventName:r,eventSystemFlags:a,nativeEvent:h,targetContainers:[d]},t!==null&&(t=oe(t),t!==null&&e0(t)),e):(e.eventSystemFlags|=a,t=e.targetContainers,d!==null&&t.indexOf(d)===-1&&t.push(d),e)}function v1(e,t,r,a,d){switch(t){case"focusin":return Vr=ta(Vr,e,t,r,a,d),!0;case"dragenter":return Kr=ta(Kr,e,t,r,a,d),!0;case"mouseover":return Ur=ta(Ur,e,t,r,a,d),!0;case"pointerover":var h=d.pointerId;return Jl.set(h,ta(Jl.get(h)||null,e,t,r,a,d)),!0;case"gotpointercapture":return h=d.pointerId,ea.set(h,ta(ea.get(h)||null,e,t,r,a,d)),!0}return!1}function r0(e){var t=ze(e.target);if(t!==null){var r=c(t);if(r!==null){if(t=r.tag,t===13){if(t=f(r),t!==null){e.blockedOn=t,Et(e.priority,function(){t0(r)});return}}else if(t===31){if(t=m(r),t!==null){e.blockedOn=t,Et(e.priority,function(){t0(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Hi(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Kd(e.nativeEvent);if(r===null){r=e.nativeEvent;var a=new r.constructor(r.type,r);hl=a,r.target.dispatchEvent(a),hl=null}else return t=oe(r),t!==null&&e0(t),e.blockedOn=r,!1;t.shift()}return!0}function s0(e,t,r){Hi(e)&&r.delete(t)}function w1(){$d=!1,Vr!==null&&Hi(Vr)&&(Vr=null),Kr!==null&&Hi(Kr)&&(Kr=null),Ur!==null&&Hi(Ur)&&(Ur=null),Jl.forEach(s0),ea.forEach(s0)}function Vi(e,t){e.blockedOn===t&&(e.blockedOn=null,$d||($d=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,w1)))}var Ki=null;function l0(e){Ki!==e&&(Ki=e,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Ki===e&&(Ki=null);for(var t=0;t<e.length;t+=3){var r=e[t],a=e[t+1],d=e[t+2];if(typeof a!="function"){if(Ud(a||r)===null)continue;break}var h=oe(r);h!==null&&(e.splice(t,3),t-=3,Kc(h,{pending:!0,data:d,method:r.method,action:a},a,d))}}))}function Qs(e){function t(G){return Vi(G,e)}Vr!==null&&Vi(Vr,e),Kr!==null&&Vi(Kr,e),Ur!==null&&Vi(Ur,e),Jl.forEach(t),ea.forEach(t);for(var r=0;r<$r.length;r++){var a=$r[r];a.blockedOn===e&&(a.blockedOn=null)}for(;0<$r.length&&(r=$r[0],r.blockedOn===null);)r0(r),r.blockedOn===null&&$r.shift();if(r=(e.ownerDocument||e).$$reactFormReplay,r!=null)for(a=0;a<r.length;a+=3){var d=r[a],h=r[a+1],v=d[It]||null;if(typeof h=="function")v||l0(r);else if(v){var M=null;if(h&&h.hasAttribute("formAction")){if(d=h,v=h[It]||null)M=v.formAction;else if(Ud(d)!==null)continue}else M=v.action;typeof M=="function"?r[a+1]=M:(r.splice(a,3),a-=3),l0(r)}}}function a0(){function e(h){h.canIntercept&&h.info==="react-transition"&&h.intercept({handler:function(){return new Promise(function(v){return d=v})},focusReset:"manual",scroll:"manual"})}function t(){d!==null&&(d(),d=null),a||setTimeout(r,20)}function r(){if(!a&&!navigation.transition){var h=navigation.currentEntry;h&&h.url!=null&&navigation.navigate(h.url,{state:h.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var a=!1,d=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(r,100),function(){a=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),d!==null&&(d(),d=null)}}}function Fd(e){this._internalRoot=e}Ui.prototype.render=Fd.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(l(409));var r=t.current,a=fo();Zg(r,a,e,t,null,null)},Ui.prototype.unmount=Fd.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Zg(e.current,2,null,e,null,null),Si(),t[dn]=null}};function Ui(e){this._internalRoot=e}Ui.prototype.unstable_scheduleHydration=function(e){if(e){var t=Tt();e={blockedOn:null,target:e,priority:t};for(var r=0;r<$r.length&&t!==0&&t<$r[r].priority;r++);$r.splice(r,0,e),r===0&&r0(e)}};var i0=o.version;if(i0!=="19.2.3")throw Error(l(527,i0,"19.2.3"));se.findDOMNode=function(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(l(188)):(e=Object.keys(e).join(","),Error(l(268,e)));return e=g(t),e=e!==null?y(e):null,e=e===null?null:e.stateNode,e};var S1={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:_,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var $i=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!$i.isDisabled&&$i.supportsFiber)try{Ye=$i.inject(S1),Fe=$i}catch{}}return oa.createRoot=function(e,t){if(!i(e))throw Error(l(299));var r=!1,a="",d=mm,h=gm,v=ym;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(a=t.identifierPrefix),t.onUncaughtError!==void 0&&(d=t.onUncaughtError),t.onCaughtError!==void 0&&(h=t.onCaughtError),t.onRecoverableError!==void 0&&(v=t.onRecoverableError)),t=Qg(e,1,!1,null,null,r,a,null,d,h,v,a0),e[dn]=t.current,kd(e),new Fd(t)},oa.hydrateRoot=function(e,t,r){if(!i(e))throw Error(l(299));var a=!1,d="",h=mm,v=gm,M=ym,G=null;return r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(d=r.identifierPrefix),r.onUncaughtError!==void 0&&(h=r.onUncaughtError),r.onCaughtError!==void 0&&(v=r.onCaughtError),r.onRecoverableError!==void 0&&(M=r.onRecoverableError),r.formState!==void 0&&(G=r.formState)),t=Qg(e,1,!0,t,r??null,a,d,G,h,v,M,a0),t.context=Xg(null),r=t.current,a=fo(),a=yt(a),d=Or(a),d.callback=null,Tr(r,d,a),r=a,t.current.lanes=r,tt(t,r),Uo(t),e[dn]=t.current,kd(e),new Ui(t)},oa.version="19.2.3",oa}var x0;function A1(){if(x0)return Gd.exports;x0=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(o){console.error(o)}}return n(),Gd.exports=L1(),Gd.exports}var R1=A1();const v0=n=>{let o;const s=new Set,l=(g,y)=>{const x=typeof g=="function"?g(o):g;if(!Object.is(x,o)){const w=o;o=y??(typeof x!="object"||x===null)?x:Object.assign({},o,x),s.forEach(k=>k(o,w))}},i=()=>o,m={setState:l,getState:i,getInitialState:()=>p,subscribe:g=>(s.add(g),()=>s.delete(g))},p=o=n(l,i,m);return m},_1=(n=>n?v0(n):v0),D1=n=>n;function B1(n,o=D1){const s=tl.useSyncExternalStore(n.subscribe,tl.useCallback(()=>o(n.getState()),[n,o]),tl.useCallback(()=>o(n.getInitialState()),[n,o]));return tl.useDebugValue(s),s}const w0=n=>{const o=_1(n),s=l=>B1(o,l);return Object.assign(s,o),s},Oo=(n=>n?w0(n):w0);function br(n,o){let s;try{s=n()}catch{return}return{getItem:i=>{var c;const f=p=>p===null?null:JSON.parse(p,void 0),m=(c=s.getItem(i))!=null?c:null;return m instanceof Promise?m.then(f):f(m)},setItem:(i,c)=>s.setItem(i,JSON.stringify(c,void 0)),removeItem:i=>s.removeItem(i)}}const kf=n=>o=>{try{const s=n(o);return s instanceof Promise?s:{then(l){return kf(l)(s)},catch(l){return this}}}catch(s){return{then(l){return this},catch(l){return kf(l)(s)}}}},z1=(n,o)=>(s,l,i)=>{let c={storage:br(()=>localStorage),partialize:S=>S,version:0,merge:(S,j)=>({...j,...S}),...o},f=!1;const m=new Set,p=new Set;let g=c.storage;if(!g)return n((...S)=>{console.warn(`[zustand persist middleware] Unable to update item '${c.name}', the given storage is currently unavailable.`),s(...S)},l,i);const y=()=>{const S=c.partialize({...l()});return g.setItem(c.name,{state:S,version:c.version})},x=i.setState;i.setState=(S,j)=>(x(S,j),y());const w=n((...S)=>(s(...S),y()),l,i);i.getInitialState=()=>w;let k;const N=()=>{var S,j;if(!g)return;f=!1,m.forEach(T=>{var V;return T((V=l())!=null?V:w)});const C=((j=c.onRehydrateStorage)==null?void 0:j.call(c,(S=l())!=null?S:w))||void 0;return kf(g.getItem.bind(g))(c.name).then(T=>{if(T)if(typeof T.version=="number"&&T.version!==c.version){if(c.migrate){const V=c.migrate(T.state,T.version);return V instanceof Promise?V.then(U=>[!0,U]):[!0,V]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,T.state];return[!1,void 0]}).then(T=>{var V;const[U,R]=T;if(k=c.merge(R,(V=l())!=null?V:w),s(k,!0),U)return y()}).then(()=>{C?.(k,void 0),k=l(),f=!0,p.forEach(T=>T(k))}).catch(T=>{C?.(void 0,T)})};return i.persist={setOptions:S=>{c={...c,...S},S.storage&&(g=S.storage)},clearStorage:()=>{g?.removeItem(c.name)},getOptions:()=>c,rehydrate:()=>N(),hasHydrated:()=>f,onHydrate:S=>(m.add(S),()=>{m.delete(S)}),onFinishHydration:S=>(p.add(S),()=>{p.delete(S)})},c.skipHydration||N(),k||w},xr=z1,Mo=Oo()(n=>({viewerOpen:!1,viewerImages:[],viewerIndex:0,viewerScale:1,viewerTranslate:{x:0,y:0},setViewerState:o=>{n(s=>{const l={viewerOpen:o.viewerOpen??s.viewerOpen,viewerImages:o.viewerImages??s.viewerImages,viewerIndex:o.viewerIndex??s.viewerIndex,viewerScale:o.viewerScale??s.viewerScale,viewerTranslate:o.viewerTranslate??s.viewerTranslate};return l.viewerOpen===s.viewerOpen&&l.viewerIndex===s.viewerIndex&&l.viewerScale===s.viewerScale&&l.viewerTranslate.x===s.viewerTranslate.x&&l.viewerTranslate.y===s.viewerTranslate.y&&l.viewerImages===s.viewerImages?s:{...s,...l}})}})),sn=Oo()(xr(n=>({error:null,nodeErrors:{},errorCycleIndex:0,errorsDismissed:!1,setError:o=>{n({error:o,errorsDismissed:!1})},setNodeErrors:o=>{n({nodeErrors:o,errorCycleIndex:0,errorsDismissed:!1})},clearNodeErrors:()=>{n({error:null,nodeErrors:{},errorCycleIndex:0,errorsDismissed:!1})},clearNodeError:o=>{n(s=>{const l={...s.nodeErrors};return delete l[String(o)],{nodeErrors:l}})},setErrorCycleIndex:o=>{n({errorCycleIndex:o})},setErrorsDismissed:o=>{n({errorsDismissed:o})}}),{name:"workflow-errors-storage",storage:br(()=>localStorage),partialize:n=>({error:n.error,nodeErrors:n.nodeErrors,errorCycleIndex:n.errorCycleIndex,errorsDismissed:n.errorsDismissed}),onRehydrateStorage:()=>n=>{if(!n)return;const o=Object.values(n.nodeErrors||{}).reduce((s,l)=>s+l.length,0);o>0&&!n.error&&n.setError(`Workflow load error: ${o} input${o===1?"":"s"} reference missing options.`),o>0&&n.setErrorCycleIndex(0)}}));function Yy(n){return!!n&&typeof n=="object"&&!Array.isArray(n)}function H1(n){if(!(!String(n.type||"").startsWith("Primitive")&&n.type!=="PrimitiveNode")){if(Array.isArray(n.widgets_values))return n.widgets_values[0];if(Yy(n.widgets_values)){const s=n.widgets_values.value;return s!==void 0?s:n.widgets_values[0]}}}function da(n,o,s){const l=n.widgets_values;if(Array.isArray(l))return s===void 0||s<0||s>=l.length?void 0:l[s];if(Yy(l)){if(l[o]!==void 0)return l[o];if(n.type==="VHS_VideoCombine"&&o==="save_image"&&l.save_output!==void 0)return l.save_output}}function Jf(n,o){const s=n.widget_idx_map?.[String(o)];return s||(n.extra?.widget_idx_map?.[String(o)]??null)}function Iu(n){if(Array.isArray(n))return!0;const o=String(n).toUpperCase();return o==="INT"||o==="FLOAT"||o==="BOOLEAN"||o==="STRING"}function ep(n,o,s){if(Array.isArray(o)){if(s?.comboIndexToValue&&typeof n=="number"&&Number.isFinite(n)){const l=Math.trunc(n);return o[l]??n}return n}if(o==="INT"&&typeof n=="string"&&n.trim()!==""&&!Number.isNaN(Number(n)))return Math.trunc(Number(n));if(o==="FLOAT"&&typeof n=="string"&&n.trim()!==""&&!Number.isNaN(Number(n)))return Number(n);if(o==="BOOLEAN"&&typeof n=="string"){if(n.toLowerCase()==="true")return!0;if(n.toLowerCase()==="false")return!1}return n}function V1(n,o,s){if(o.length===0)return n;const l=ep(n,o,{comboIndexToValue:!0}),i=String(l),c=i.split(/[\\/]/).pop()??i,f=o.find(p=>String(p)===i);if(f!==void 0)return f;const m=o.find(p=>String(p)===c);return m!==void 0?m:s!==void 0&&o.some(p=>String(p)===String(s))?s:o[0]}function Qy(n,o){const s=n.links.find(f=>f[0]===o);if(!s)return null;const l=s[1],i=s[2],c=n.nodes.find(f=>f.id===l);if(!c)return null;if(c.mode===4||c.type==="Reroute"){const f=c.outputs[i];if(!f)return null;const m=c.inputs.find(p=>{if(p.link===null)return!1;const g=String(p.type).toUpperCase(),y=String(f.type).toUpperCase();return g===y||g==="*"||y==="*"});return m?.link!=null?Qy(n,m.link):null}return{nodeId:l,slotIndex:i}}function K1(n,o,s,l,i,c,f){const m={};for(const N of s.inputs)if(N.link!=null){const S=Qy(n,N.link);if(S)if(i.has(S.nodeId))m[N.name]=[String(S.nodeId),S.slotIndex];else{const j=n.nodes.find(C=>C.id===S.nodeId);if(j){const C=H1(j);C!==void 0?m[N.name]=C:console.warn(`[workflowInputs] Missing source node for input '${N.name}' on node ${s.id} (${s.type}).`,{sourceNodeId:S.nodeId,sourceNodeType:j.type,sourceAllowed:!1})}}}const p=o[l];if(!p?.input)return m;const g=p.input_order?.required||Object.keys(p.input.required||{}),y=p.input_order?.optional||Object.keys(p.input.optional||{}),x=[...g,...y];let w=0;const k=Array.isArray(s.widgets_values)?s.widgets_values:null;for(const N of x)try{const S=p.input.required?.[N]||p.input.optional?.[N];if(!S)continue;const[j]=S,C=s.inputs.find(Y=>Y.name===N),T=C?.link!=null,V=!!C?.widget&&!T,U=!!C,R=S[1]?.default,z=Object.prototype.hasOwnProperty.call(S[1]??{},"default");if(Iu(j)||V||!U){let Y=c?.[N];if(Y===void 0&&(Y=w),N==="seed"&&f?.[s.id]!==void 0&&!(N in m))m[N]=f[s.id];else if(Y!==void 0&&!T&&!(N in m)){const ue=da(s,N,Y);ue!==void 0&&(Array.isArray(j)?m[N]=V1(ue,j,R):m[N]=ep(ue,j))}else!T&&z&&!(N in m)&&(m[N]=R);Y!==void 0&&(w=Math.max(w,Y+1)),String(j)==="INT"&&(N==="seed"||N==="noise_seed")&&(Y!==void 0?w=Math.max(w,Y+2):w=Math.max(w,w+1))}}catch(S){console.error(`Error processing input '${N}' for node ${s.id} (${s.type}):`,S)}if(c)for(const[N,S]of Object.entries(c)){if(!(N in m)&&k&&S<k.length){const j=k[S];j!=null&&(m[N]=j)}if(!(N in m)&&!k){const j=da(s,N,S);j!=null&&(m[N]=j)}}return(l==="Power Lora Loader (rgthree)"||s.type==="Power Lora Loader (rgthree)")&&k&&k.forEach((N,S)=>{if(typeof N=="object"&&N!==null&&"lora"in N&&!(Object.values(c||{}).some(C=>C===S)||c===null&&S<w)){const C=`lora_${S}`;C in m||(m[C]=N)}}),f?.[s.id]!==void 0&&!("seed"in m)&&!("noise_seed"in m)&&(m.seed=f[s.id]),m}const nn="";function U1(){const n="comfyui-mobile-client-id";let o=localStorage.getItem(n);return o||(o="mobile-"+Math.random().toString(36).substring(2,15),localStorage.setItem(n,o)),o}const Xy=U1();async function tp(){const n=await fetch(`${nn}/api/object_info`);if(!n.ok)throw new Error("Failed to fetch node types");return n.json()}async function $1(){const n=await fetch(`${nn}/api/queue`);if(!n.ok)throw new Error("Failed to fetch queue");return n.json()}async function F1(n){const o=`${nn}/api/history?max_items=${n}`,s=await fetch(o);if(!s.ok)throw new Error("Failed to fetch history");return s.json()}async function q1(){const n=await fetch(`${nn}/api/v2/userdata?path=workflows`);if(!n.ok){if(n.status===404)return[];throw new Error("Failed to list user workflows")}return(await n.json()).filter(s=>s.type==="file"&&s.name.endsWith(".json"))}function Zy(n){return encodeURIComponent(n)}async function np(n){const o=await fetch(`${nn}/api/userdata/${Zy("workflows/"+n)}`);if(!o.ok)throw new Error("Failed to load workflow");return o.json()}async function Jy(n,o){if(!(await fetch(`${nn}/api/userdata/${Zy("workflows/"+n)}?overwrite=true`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)})).ok)throw new Error("Failed to save workflow")}async function W1(){const n=await fetch(`${nn}/api/workflow_templates`);if(!n.ok)throw new Error("Failed to fetch templates");return n.json()}async function op(n,o){const s=await fetch(`${nn}/api/workflow_templates/${encodeURIComponent(n)}/${encodeURIComponent(o)}`);if(!s.ok)throw new Error("Failed to load template");return s.json()}async function G1(){await fetch(`${nn}/api/interrupt`,{method:"POST"})}async function P1(){await fetch(`${nn}/api/queue`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({clear:!0})})}async function Y1(n){await fetch(`${nn}/api/queue`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({delete:[n]})})}async function eb(n,o){const s=new FormData;s.append("image",n),o?.type&&s.append("type",o.type),o?.subfolder&&s.append("subfolder",o.subfolder),o?.overwrite!==void 0&&s.append("overwrite",o.overwrite?"true":"false");const l=await fetch(`${nn}/upload/image`,{method:"POST",body:s});if(!l.ok)throw new Error("Failed to upload image");return l.json()}async function Q1(n){await fetch(`${nn}/api/history`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({delete:[n]})})}async function S0(n){n.length!==0&&await fetch(`${nn}/api/history`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({delete:n})})}async function X1(){await fetch(`${nn}/api/history`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({clear:!0})})}function mo(n,o,s){return`${nn}/view?filename=${encodeURIComponent(n)}&subfolder=${encodeURIComponent(o)}&type=${encodeURIComponent(s)}`}function Z1(n,o,s,l,i){const f=`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}/ws?clientId=${n}`,m=new WebSocket(f);return m.onopen=()=>{s?.()},m.onmessage=p=>{try{const g=JSON.parse(p.data);o(g)}catch(g){console.error("[WS] Failed to parse message:",g)}},m.onclose=()=>{l?.()},m.onerror=p=>{console.error("[WS] Error:",p),i?.(p)},m}async function jf(n="",o=!1,s="output",l){const i=new URLSearchParams;n&&i.set("path",n),o&&i.set("recursive","true"),s&&i.set("source",s),l&&i.set("showHidden","true");const c=await fetch(`${nn}/mobile/api/files?${i}`);if(!c.ok)throw new Error("Failed to fetch files");return c.json()}async function J1(n){const o=await jf("",!1,"output",n),s=await jf("",!1,"input",n),l=o.files.filter(c=>c.type==="dir").map(c=>c.name);return{input:s.files.filter(c=>c.type==="dir").map(c=>c.name),output:l}}async function Mf(n,o=1e3,s=0,l="modified",i=!1,c=null,f){return(await jf(c||"",i,n,f)).files.map(p=>{if(p.type==="dir")return{id:`${n}/${p.path}`,name:p.name,type:"folder",date:p.date,size:p.size};const g=p.folder||(p.path.includes("/")?p.path.substring(0,p.path.lastIndexOf("/")):"");return{id:`${n}/${p.path}`,name:p.name,type:p.type,previewUrl:`${nn}/mobile/api/thumbnail?filename=${encodeURIComponent(p.name)}&subfolder=${encodeURIComponent(g)}&source=${n}`,fullUrl:`${nn}/view?filename=${encodeURIComponent(p.name)}&type=${n}&subfolder=${encodeURIComponent(g)}`,date:p.date,size:p.size}})}async function Of(n,o="output"){const s=await fetch(`${nn}/mobile/api/files`,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:n,source:o})});if(!s.ok){const l=await s.json();throw new Error(l.error||"Failed to delete file")}}async function ew(n,o="output"){const s=new URLSearchParams({path:n,source:o}),l=await fetch(`${nn}/mobile/api/file-metadata?${s.toString()}`);if(!l.ok){const c=await l.json().catch(()=>({}));throw new Error(c.error||"Failed to load file metadata")}const i=await l.json();if(!i.workflow)throw new Error("No workflow metadata found");return i.workflow}async function tw(n,o="output"){const s=new URLSearchParams({path:n,source:o}),l=await fetch(`${nn}/mobile/api/image-metadata?${s.toString()}`);if(!l.ok){const i=await l.json().catch(()=>({}));throw new Error(i.error||"Failed to load image metadata")}return l.json()}async function nw(n,o,s="output"){const l=await fetch(`${nn}/mobile/api/files/move`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sources:n,destination:o??"",source:s})});if(!l.ok){const i=await l.json().catch(()=>({}));throw new Error(i.error||"Failed to move files")}}async function N0(n,o="output"){const s=await fetch(`${nn}/mobile/api/files/mkdir`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:n,source:o})});if(!s.ok){const l=await s.json().catch(()=>({}));throw new Error(l.error||"Failed to create folder")}}async function ow(n,o,s="output"){const l=await fetch(`${nn}/mobile/api/files/rename`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:n,newName:o,source:s})});if(!l.ok){const i=await l.json().catch(()=>({}));throw new Error(i.error||"Failed to rename file")}}const Mt=Oo()(xr((n,o)=>({running:[],pending:[],isLoading:!1,lastExecutedId:null,queueItemExpanded:{},queueItemUserToggled:{},queueItemHideImages:{},showQueueMetadata:!1,previewVisibility:{},previewVisibilityDefault:!1,fetchQueue:async()=>{const{running:s}=o();n({isLoading:!0});try{const l=await $1(),i=l.queue_running.map(f=>({number:f[0],prompt_id:f[1],prompt:f[2],extra:f[3],outputs_to_execute:f[4]})),c=l.queue_pending.map(f=>({number:f[0],prompt_id:f[1],prompt:f[2],extra:f[3],outputs_to_execute:f[4]}));s.length>0&&i.length===0&&(n({lastExecutedId:s[0].prompt_id}),setTimeout(()=>n({lastExecutedId:null}),100)),n({running:i,pending:c})}catch(l){console.error("Failed to fetch queue:",l)}finally{n({isLoading:!1})}},clearQueue:async()=>{try{await P1(),n({pending:[]})}catch(s){console.error("Failed to clear queue:",s)}},deleteItem:async s=>{try{await Y1(s),n(l=>({pending:l.pending.filter(i=>i.prompt_id!==s)}))}catch(l){console.error("Failed to delete queue item:",l)}},interrupt:async()=>{try{await G1()}catch(s){console.error("Failed to interrupt execution:",s)}},updateFromStatus:s=>{const{pending:l}=o();s!==l.length&&o().fetchQueue()},setQueueItemExpanded:(s,l)=>{n(i=>({queueItemExpanded:{...i.queueItemExpanded,[s]:l}}))},setQueueItemUserToggled:(s,l)=>{n(i=>({queueItemUserToggled:{...i.queueItemUserToggled,[s]:l}}))},setQueueItemHideImages:(s,l)=>{n(i=>({queueItemHideImages:{...i.queueItemHideImages,[s]:l}}))},toggleQueueItemHideImages:s=>{n(l=>({queueItemHideImages:{...l.queueItemHideImages,[s]:!l.queueItemHideImages[s]}}))},setShowQueueMetadata:s=>{n({showQueueMetadata:s})},toggleShowQueueMetadata:()=>{n(s=>({showQueueMetadata:!s.showQueueMetadata}))},setPreviewVisibility:(s,l)=>{n(i=>({previewVisibility:{...i.previewVisibility,[s]:l}}))},togglePreviewVisibility:s=>{n(l=>({previewVisibility:{...l.previewVisibility,[s]:!l.previewVisibility[s]}}))},setPreviewVisibilityDefault:s=>{n({previewVisibilityDefault:s})}}),{name:"queue-storage",storage:br(()=>localStorage),partialize:n=>({queueItemExpanded:n.queueItemExpanded,queueItemUserToggled:n.queueItemUserToggled,queueItemHideImages:n.queueItemHideImages,showQueueMetadata:n.showQueueMetadata,previewVisibility:n.previewVisibility,previewVisibilityDefault:n.previewVisibilityDefault})})),eo=Oo()(xr(n=>({currentPanel:"workflow",setCurrentPanel:o=>{n({currentPanel:o})}}),{name:"navigation-storage",storage:br(()=>localStorage),partialize:n=>({currentPanel:n.currentPanel})})),ho=Oo()(xr((n,o)=>({pinnedWidgets:{},pinnedWidget:null,pinOverlayOpen:!1,setPinnedWidget:(s,l)=>{const{pinnedWidgets:i}=o();if(l&&s)n({pinnedWidget:s,pinnedWidgets:{...i,[l]:s}});else if(l&&!s){const c={...i};delete c[l],n({pinnedWidget:null,pinnedWidgets:c})}else n({pinnedWidget:s})},setPinOverlayOpen:s=>{n({pinOverlayOpen:s})},togglePinOverlay:()=>{n(s=>({pinOverlayOpen:!s.pinOverlayOpen}))},clearPinnedWidgetForKey:s=>{if(!s){n({pinnedWidget:null,pinOverlayOpen:!1});return}n(l=>{const i={...l.pinnedWidgets};return delete i[s],{pinnedWidgets:i,pinnedWidget:null,pinOverlayOpen:!1}})},restorePinnedWidgetForWorkflow:(s,l)=>{if(!s){n({pinnedWidget:null,pinOverlayOpen:!1});return}const i=o().pinnedWidgets[s];if(!i){n({pinnedWidget:null,pinOverlayOpen:!1});return}const c=l.nodes.some(f=>f.id===i.nodeId);n({pinnedWidget:c?i:null,pinOverlayOpen:!1})},clearCurrentPin:()=>{n({pinnedWidget:null,pinOverlayOpen:!1})}}),{name:"pinned-widget-storage",storage:br(()=>localStorage),partialize:n=>({pinnedWidgets:n.pinnedWidgets,pinnedWidget:n.pinnedWidget,pinOverlayOpen:n.pinOverlayOpen})})),rp=-1,Lu=-2,Au=-3,Fi=0x4000000000000,mu=new Set([rp,Lu,Au]);function sp(n){return mu.has(n)}function tb(n){return n===rp?"randomize":n===Lu?"increment":n===Au?"decrement":null}function rw(n){return n==="randomize"?rp:n==="increment"?Lu:n==="decrement"?Au:null}function Wr(n,o,s,l){if(!o)return null;const c=Jf(n,s.id)?.[l];if(c!==void 0)return c;const f=o[s.type];if(!f?.input)return null;const m=f.input_order?.required||Object.keys(f.input.required||{}),p=f.input_order?.optional||Object.keys(f.input.optional||{}),g=[...m,...p];let y=0;for(const x of g){const w=f.input.required?.[x]||f.input.optional?.[x];if(!w)continue;const[k]=w,N=s.inputs.find(U=>U.name===x),S=N?.link!=null,j=!!N?.widget&&!S,C=!!N;if(Iu(k)||j||!C){if(x===l)return y;y+=1,String(k)==="INT"&&(x==="seed"||x==="noise_seed")&&(y+=1)}}return null}function rl(n,o,s){const l=Wr(n,o,s,"seed")??Wr(n,o,s,"noise_seed");if(l!==null)return l;if(!o)return s.outputs?.some(x=>String(x.name||"").toLowerCase().includes("seed")&&String(x.type||"").toUpperCase().includes("INT"))&&Array.isArray(s.widgets_values)&&s.widgets_values.length>0?0:null;const i=o[s.type];if(!i?.input)return s.outputs?.some(x=>String(x.name||"").toLowerCase().includes("seed")&&String(x.type||"").toUpperCase().includes("INT"))&&Array.isArray(s.widgets_values)&&s.widgets_values.length>0?0:null;const c=Jf(n,s.id),f=i.input_order?.required||Object.keys(i.input.required||{}),m=i.input_order?.optional||Object.keys(i.input.optional||{}),p=[...f,...m];let g=0;for(const y of p){const x=i.input.required?.[y]||i.input.optional?.[y];if(!x)continue;const[w]=x,k=s.inputs.find(T=>T.name===y),N=k?.link!=null,S=!!k?.widget&&!N,j=!!k;if(Iu(w)||S||!j){const V=c?.[y]??g;if(String(w)==="INT"&&y.toLowerCase().includes("seed"))return V;g+=1,String(w)==="INT"&&(y==="seed"||y==="noise_seed")&&(g+=1)}}return null}function sw(n,o){const s=n[o.type];if(!s?.input)return 1;const i=(s.input.required?.seed||s.input.optional?.seed)?.[1],c=typeof i?.step=="number"?i.step:1;return c>0?c:1}function lw(n){const o=Number(n.properties?.randomMin??0),s=Number(n.properties?.randomMax??Fi),l=Number.isFinite(o)?Math.max(-Fi,o):0,i=Number.isFinite(s)?Math.min(Fi,s):Fi;return l<=i?{min:l,max:i}:{min:i,max:l}}function fa(n,o){const s=sw(n,o),{min:l,max:i}=lw(o),c=s>0?s/10:1,f=i-l;let m=l+Math.random()*f;return c>0&&(m=Math.round((m-l)/c)*c+l),m>i&&(m=i),m<l&&(m=l),mu.has(m)&&(m=0),m}function aw(n,o,s,l){if(mu.has(n)){if(typeof o=="number"&&!mu.has(o)){if(n===Lu)return o+1;if(n===Au)return o-1}return fa(s,l)}return Number.isFinite(n)?n:0}const $n=Oo()(xr((n,o)=>({seedModes:{},seedLastValues:{},setSeedMode:(s,l,i)=>{const{seedModes:c,seedLastValues:f}=o();if(i?.workflow&&i.nodeTypes){const{workflow:m,nodeTypes:p,updateNodeWidgets:g}=i,y=m.nodes.find(x=>x.id===s);if(y){const x=rl(m,p,y);if(x!==null&&Array.isArray(y.widgets_values)){const w=x+1,k=typeof y.widgets_values[w]=="string",N={};if(k)N[w]=l;else{const S=rw(l);if(S!==null&&l!=="fixed")N[x]=S;else if(l==="fixed"){const j=Number(y.widgets_values[x]);if(sp(j)){const C=f[s],T=typeof C=="number"?C:fa(p,y);N[x]=T}}}Object.keys(N).length>0&&g(s,N)}}}n({seedModes:{...c,[s]:l}})},setSeedModes:s=>{n({seedModes:s})},setSeedLastValues:s=>{n({seedLastValues:s})},clearSeedState:()=>{n({seedModes:{},seedLastValues:{}})}}),{name:"seed-storage",storage:br(()=>localStorage),partialize:n=>({seedModes:n.seedModes,seedLastValues:n.seedLastValues})}));function C0(n,o){return n&&n[o]||null}function nb(n,o){try{if(o.type==="PrimitiveNode"){const p=o.outputs?.[0]?.type;if(!p)return[];const g=String(p).toUpperCase(),y=Array.isArray(o.widgets_values)?o.widgets_values[0]:void 0;return[{name:o.outputs?.[0]?.name||"value",type:g,options:void 0,value:y,widgetIndex:0,isCombo:!1,connected:!1,inputIndex:-1}]}if(o.type==="Power Lora Loader (rgthree)"){const p=[],g=o.properties?.["Show Strengths"]==="Separate Model & Clip";let y=[];if(n){const x=C0(n,"LoraLoader");if(x?.input?.required?.lora_name){const[w]=x.input.required.lora_name;Array.isArray(w)&&(y=w)}}if(Array.isArray(o.widgets_values)){const x=o.widgets_values,w=[];x.forEach((k,N)=>{typeof k=="object"&&k!==null&&"lora"in k&&"strength"in k&&w.push(N)}),w.length>0&&(p.push({name:"Loras",type:"POWER_LORA_HEADER",options:{loraIndices:w},value:null,widgetIndex:-1,isCombo:!1,connected:!1,inputIndex:-1}),w.forEach(k=>{const N=x[k];p.push({name:"Lora",type:"POWER_LORA",options:{choices:y.length>0?y:void 0,showSeparate:g},value:N,widgetIndex:k,isCombo:!1,connected:!1,inputIndex:-1})})),p.push({name:"Add Lora",type:"POWER_LORA_ADD",options:void 0,value:null,widgetIndex:o.widgets_values.length,isCombo:!1,connected:!1,inputIndex:-1})}return p}const s=C0(n,o.type);if(!s?.input)return o.outputs?.some(g=>String(g.name||"").toLowerCase().includes("seed")&&String(g.type||"").toUpperCase().includes("INT"))&&Array.isArray(o.widgets_values)&&o.widgets_values.length>0?[{name:"seed",type:"INT",options:void 0,value:o.widgets_values[0],widgetIndex:0,isCombo:!1,connected:!1,inputIndex:-1}]:[];const l=s.input_order?.required||Object.keys(s.input.required||{}),i=s.input_order?.optional||Object.keys(s.input.optional||{}),c=[];let f=0;const m=(p,g)=>{if(!g)return;const[y,x]=g,w=o.inputs.findIndex(R=>R.name===p),k=w>=0?o.inputs[w]:void 0,N=k?.link!=null,S=!!k?.widget&&!N,j=!!k,C=Object.prototype.hasOwnProperty.call(x??{},"default"),T=Iu(y)||S||!j||C,V=Array.isArray(y),U=V?{...x??{},options:y}:x;if(T){const R=da(o,p,f);c.push({name:p,type:V?"COMBO":String(y),options:U,value:R,widgetIndex:f,isCombo:V,connected:!!N,inputIndex:w})}T&&(f+=1,String(y)==="INT"&&(p==="seed"||p==="noise_seed")&&(f+=1))};for(const p of l){const g=s.input.required?.[p];g&&m(p,g)}for(const p of i){const g=s.input.optional?.[p];g&&m(p,g)}return c}catch(s){return console.error(`Error collecting widget definitions for node ${o.id} (${o.type}):`,s),[]}}function lp(n,o){return nb(n,o).filter(s=>!s.isCombo).map(s=>({name:s.name,type:s.type,options:s.options,value:s.value,widgetIndex:s.widgetIndex,connected:s.connected,inputIndex:s.inputIndex}))}function ap(n,o){return nb(n,o).filter(s=>s.isCombo).map(s=>({name:s.name,type:s.type,value:s.value,options:s.options,widgetIndex:s.widgetIndex,connected:s.connected,inputIndex:s.inputIndex}))}function iw(n){let o=5381;for(let s=0;s<n.length;s+=1)o=(o<<5)+o+n.charCodeAt(s),o&=4294967295;return(o>>>0).toString(16).padStart(8,"0")}function uw(n,o){if(!n)return!1;const s=lp(n,o).filter(i=>!i.connected),l=ap(n,o).filter(i=>!i.connected);return s.length===0&&l.length===0}function cw(n){const o=n.nodes??[],s=n.definitions?.subgraphs?.flatMap(l=>l.nodes??[])??[];return[...o,...s]}function Xd(n,o){const i=cw(n).filter(c=>!uw(o,c)).map(c=>c.type).sort().join("|");return`wf_${iw(i)}`}const k0="__mobile_origin",qi="__mobile_subgraph_group_map";function Zd(n,o,s){const l={...n.properties??{}};return s&&l[k0]===void 0&&(l[k0]=s),{...n,id:o,inputs:(n.inputs??[]).map(i=>({...i,link:null})),outputs:(n.outputs??[]).map(i=>({...i,links:[]})),widgets_values:n.widgets_values??[],flags:n.flags??{},properties:l,mode:n.mode??0,order:n.order??0}}function dw(n,o){if(!o||o.length===0)return null;const s=[...o].sort((g,y)=>g.id-y.id),[l,i]=n.pos,[c,f]=n.size,m=l+c/2,p=i+f/2;for(const g of s){const[y,x,w,k]=g.bounding;if(m>=y&&m<=y+w&&p>=x&&p<=x+k)return g.id}return null}function j0(n,o){const s=new Map,l=new Map;return o.forEach((i,c)=>{i?.name&&l.set(i.name,c)}),n.forEach((i,c)=>{const f=i?.name;if(f&&l.has(f)){s.set(c,l.get(f));return}c<o.length&&s.set(c,c)}),s}function fw(n,o){const s=new Map;for(const l of n)l.inputs=(l.inputs??[]).map(i=>({...i,link:null})),l.outputs=(l.outputs??[]).map(i=>({...i,links:[]})),s.set(l.id,l);for(const l of o){const[i,c,f,m,p]=l,g=s.get(c),y=s.get(m),x=g?.outputs?.[f],w=y?.inputs?.[p];x&&(x.links||(x.links=[]),x.links.push(i)),w&&(w.link=i)}return n}function pw(n,o){const s=n.nodes.filter(N=>o.has(N.type));if(s.length===0)return{workflow:n,changed:!1};const l=new Set(s.map(N=>N.id));let i=Math.max(0,...n.nodes.map(N=>N.id))+1;const c=[],f=n.groups??[],m=n.extra??{},p=typeof m[qi]=="object"&&m[qi]!==null?m[qi]:{},g={};for(const[N,S]of Object.entries(p))(typeof S=="number"||S===null)&&(g[N]=S);const y=new Map;for(const N of n.nodes){if(!l.has(N.id)){c.push(Zd(N,N.id,{scope:"root",nodeId:N.id}));continue}const S=o.get(N.type);if(!S){c.push(Zd(N,N.id,{scope:"root",nodeId:N.id}));continue}const j=dw(N,f);g[S.id]=j??null;const C=j0(N.inputs??[],S.inputs??[]),T=j0(N.outputs??[],S.outputs??[]),V=new Map,U=new Map,R=new Map,z=[];for(const L of S.nodes??[]){const $=i++;V.set(L.id,$),c.push(Zd(L,$,{scope:"subgraph",subgraphId:S.id,nodeId:L.id}))}for(const L of S.links??[]){const $=L.origin_id,Y=L.target_id;if($===-10){const fe=V.get(Y);if(fe!==void 0){const Re=U.get(L.origin_slot)??[];Re.push({origin_id:-10,origin_slot:L.origin_slot,target_id:fe,target_slot:L.target_slot,type:L.type}),U.set(L.origin_slot,Re)}continue}if(Y===-20){const fe=V.get($);if(fe!==void 0){const Re=R.get(L.target_slot)??[];Re.push({origin_id:fe,origin_slot:L.origin_slot,target_id:-20,target_slot:L.target_slot,type:L.type}),R.set(L.target_slot,Re)}continue}const ue=V.get($),pe=V.get(Y);ue!==void 0&&pe!==void 0&&z.push({origin_id:ue,origin_slot:L.origin_slot,target_id:pe,target_slot:L.target_slot,type:L.type})}y.set(N.id,{inputSlotMap:C,outputSlotMap:T,inputTargets:U,outputSources:R,internalLinks:z})}const x=[],w=n.links??[];for(const N of w){const[,S,j,C,T,V]=N,U=l.has(S),R=l.has(C);if(!U&&!R){x.push({origin_id:S,origin_slot:j,target_id:C,target_slot:T,type:V});continue}if(U&&R){const z=y.get(S),L=y.get(C),$=z?.outputSlotMap.get(j),Y=L?.inputSlotMap.get(T);if($===void 0||Y===void 0)continue;const ue=z?.outputSources.get($)??[],pe=L?.inputTargets.get(Y)??[];for(const fe of ue)for(const Re of pe)x.push({origin_id:fe.origin_id,origin_slot:fe.origin_slot,target_id:Re.target_id,target_slot:Re.target_slot,type:fe.type});continue}if(U){const z=y.get(S),L=z?.outputSlotMap.get(j);if(L===void 0)continue;const $=z?.outputSources.get(L)??[];for(const Y of $)x.push({origin_id:Y.origin_id,origin_slot:Y.origin_slot,target_id:C,target_slot:T,type:Y.type});continue}if(R){const z=y.get(C),L=z?.inputSlotMap.get(T);if(L===void 0)continue;const $=z?.inputTargets.get(L)??[];for(const Y of $)x.push({origin_id:S,origin_slot:j,target_id:Y.target_id,target_slot:Y.target_slot,type:Y.type})}}for(const N of y.values())x.push(...N.internalLinks);const k=x.map((N,S)=>[S+1,N.origin_id,N.origin_slot,N.target_id,N.target_slot,N.type]);return fw(c,k),{workflow:{...n,extra:{...m,[qi]:g},nodes:c,links:k,last_node_id:Math.max(0,...c.map(N=>N.id)),last_link_id:k.length},changed:!0}}function hw(n){const o=n.definitions?.subgraphs??[];if(o.length===0)return n;const s=new Map;for(const i of o)i?.id&&s.set(i.id,i);let l=n;for(let i=0;i<o.length+4;i+=1){const{workflow:c,changed:f}=pw(l,s);if(!f)break;l=c}return l}function mw(n){const o=new Map,s=new Map,l=new Map;for(const i of n.nodes)o.set(i.id,i),s.set(i.id,[]),l.set(i.id,[]);for(const i of n.links){const[,c,,f]=i,m=s.get(f);m&&!m.includes(c)&&m.push(c);const p=l.get(c);p&&!p.includes(f)&&p.push(f)}return{nodes:o,dependencies:s,dependents:l}}function gw(n){return["SaveImage","PreviewImage","SaveAnimatedWEBP","SaveAnimatedPNG","SaveVideo","SaveAudio"].some(s=>n.type.includes(s))||n.outputs.length===0||n.outputs.every(s=>!s.links||s.links.length===0)}function yw(n){if(n.nodes.length===0)return[];const o=mw(n),s=new Set,l=[];function i(f){if(s.has(f))return;s.add(f);const m=o.nodes.get(f);if(!m)return;const p=o.dependencies.get(f)||[];for(const g of p)i(g);l.push(m)}const c=n.nodes.filter(gw);if(c.length===0)for(const f of n.nodes)(o.dependents.get(f.id)||[]).length===0&&c.push(f);for(const f of c)i(f.id);for(const f of n.nodes)s.has(f.id)||i(f.id);return l}function ll(n,o,s){const l=n.nodes.find(g=>g.id===o);if(!l||!l.inputs[s])return null;const i=l.inputs[s].link;if(i===null)return null;const c=n.links.find(g=>g[0]===i);if(!c)return null;const[,f,m]=c,p=n.nodes.find(g=>g.id===f);return p?{node:p,outputIndex:m}:null}function pa(n,o,s){const l=n.nodes.find(f=>f.id===o);if(!l||!l.outputs[s])return[];const i=l.outputs[s].links||[],c=[];for(const f of i){const m=n.links.find(x=>x[0]===f);if(!m)continue;const[,,,p,g]=m,y=n.nodes.find(x=>x.id===p);y&&c.push({node:y,inputIndex:g})}return c}function ha(n){if(n==null)return[];if(Array.isArray(n))return n.flatMap(s=>ha(s)).filter(Boolean);const o=String(n);return o?o.split(",").map(s=>s.trim().toUpperCase()).filter(Boolean):[]}function M0(n){return!(n==="*"||n==="OPT_CONNECTION")}function O0(n,o){const s=ha(n),l=ha(o);return s.length===0||l.length===0?!1:s.includes("*")||l.includes("*")?!0:s.some(i=>l.includes(i))}function Ru(n,o){const s=ha(n).filter(M0),l=ha(o).filter(M0);return s.length===0||l.length===0?!1:s.some(i=>l.includes(i))}function bw(n,o,s,l){const i=n.nodes.find(m=>m.id===s);if(!i)return[];const c=i.inputs[l];if(!c)return[];const f=[];for(const m of n.nodes)if(m.id!==s&&m.mode!==4)for(let p=0;p<m.outputs.length;p++){const g=m.outputs[p];if(Ru(g.type,c.type)){f.push({node:m,outputIndex:p});break}}return f}function xw(n,o){const s=[];for(const[l,i]of Object.entries(n)){const c=i.output??[];for(let f=0;f<c.length;f++)if(Ru(c[f],o)){s.push({typeName:l,def:i,outputIndex:f});break}}return s}function vw(n){const o=n.input?.required??{},s=n.input?.optional??{},l=n.input_order?.required??Object.keys(o),i=n.input_order?.optional??Object.keys(s),c=[],f=(m,p)=>{if(!Array.isArray(p)||p.length===0)return;const[g]=p;if(Array.isArray(g))return;const y=String(g).toUpperCase();["INT","FLOAT","BOOLEAN","STRING"].includes(y)||c.push({inputIndex:c.length,inputName:m,inputType:String(g)})};for(const m of l)f(m,o[m]);for(const m of i)f(m,s[m]);return c}function ww(n,o){const s=[];for(const[l,i]of Object.entries(n)){const c=vw(i);for(const f of c)if(Ru(o,f.inputType)){s.push({typeName:l,def:i,inputIndex:f.inputIndex,inputName:f.inputName,inputType:f.inputType});break}}return s}function Sw(n,o,s){const l=n.nodes.find(f=>f.id===o);if(!l)return[];const i=l.outputs?.[s];if(!i)return[];const c=[];for(const f of n.nodes)if(f.id!==o&&f.mode!==4)for(let m=0;m<(f.inputs?.length??0);m+=1){const p=f.inputs[m];Ru(i.type,p.type)&&c.push({node:f,inputIndex:m})}return c}function ma(n,o){const s=new Map;if(!o||o.length===0)return s;const l=[...o].sort((i,c)=>{const f=i.bounding[2]*i.bounding[3],m=c.bounding[2]*c.bounding[3];return f!==m?f-m:i.id-c.id});for(const i of n){const[c,f]=i.pos,[m,p]=i.size,g=c+m/2,y=f+p/2;for(const x of l){const[w,k,N,S]=x.bounding;if(g>=w&&g<=w+N&&y>=k&&y<=k+S){s.set(i.id,x.id);break}}}return s}function iu(){return{root:[],groups:{},groupParents:{},subgraphs:{},hiddenBlocks:{}}}function ip(n){const o=n.split("/").filter(Boolean);if(o.length===0||o[0]!=="root")return null;const s=o.slice(1);if(s.length===0)return null;const l=m=>{const p=m.indexOf(":");if(p<=0)return null;const g=m.slice(0,p),y=m.slice(p+1);return g!=="node"&&g!=="group"&&g!=="subgraph"||y.length===0?null:{type:g,rawId:y}};let i=null;for(let m=0;m<s.length-1;m+=1){const p=l(s[m]);if(!p||p.type==="node")return null;p.type==="subgraph"&&(i=p.rawId)}const c=l(s[s.length-1]);if(!c)return null;if(c.type==="subgraph")return{type:"subgraph",subgraphId:c.rawId};const f=Number(c.rawId);return Number.isFinite(f)?c.type==="group"?{type:"group",groupId:f,subgraphId:i}:{type:"node",nodeId:f,subgraphId:i}:null}function cn(n){if(n.type==="group"&&n.groupKey)return n.groupKey;const o=n.subgraphId==null?"root":`root/subgraph:${n.subgraphId}`;return n.type==="group"?`${o}/group:${n.groupId}`:n.type==="node"?`${o}/node:${n.nodeId}`:`root/subgraph:${n.subgraphId}`}function Nw(n,o){return n.type!==o.type?!1:n.type==="node"&&o.type==="node"?n.id===o.id:n.type==="group"&&o.type==="group"?n.stableKey===o.stableKey:n.type==="subgraph"&&o.type==="subgraph"?n.id===o.id:n.type==="hiddenBlock"&&o.type==="hiddenBlock"?n.blockId===o.blockId:!1}function Cw(n){const s=n.properties?.__mobile_origin;if(!s||typeof s!="object")return null;const l=s.scope;if(l==="root")return{scope:"root"};if(l==="subgraph"){const i=s.subgraphId;if(typeof i=="string")return{scope:"subgraph",subgraphId:i}}return null}function kw(n,o,s){const l=o.groups??[],i=o.definitions?.subgraphs??[],c=new Map;for(const z of n){const L=Cw(z);L?.scope==="subgraph"&&L.subgraphId&&c.set(z.id,L.subgraphId)}const f=n.filter(z=>!c.has(z.id)),m=ma(f,l),p=new Map;for(const z of i){const L=n.filter(Y=>c.get(Y.id)===z.id),$=z.groups??[];$.length>0&&p.set(z.id,ma(L,$))}const g=o.extra?.__mobile_subgraph_group_map,y=new Map;if(g&&typeof g=="object")for(const[z,L]of Object.entries(g))(typeof L=="number"||L===null)&&y.set(z,L);const x=iu();for(const z of i)x.subgraphs[z.id]=[];const w=z=>{const L=new Map;for(const $ of z){const[Y,ue,pe,fe]=$.bounding,Re=Y+pe/2,Ie=ue+fe/2,Ae=pe*fe;let _=null,se=Number.POSITIVE_INFINITY;for(const ce of z){if(ce.id===$.id)continue;const[Ue,De,E,A]=ce.bounding,O=E*A;if(O<=Ae)continue;const te=Y>=Ue&&ue>=De&&Y+pe<=Ue+E&&ue+fe<=De+A,Le=Re>=Ue&&Re<=Ue+E&&Ie>=De&&Ie<=De+A;!te&&!Le||O<se&&(se=O,_=ce.id)}L.set($.id,_)}return L};function k(z,L,$){const Y=[];let ue=[],pe=0;const fe=()=>{if(ue.length===0)return;const Re=`hidden-${L}-${pe}`;pe++,x.hiddenBlocks[Re]=[...ue],Y.push({type:"hiddenBlock",blockId:Re}),ue=[]};for(const Re of z)Re.type==="node"&&s[cn({type:"node",nodeId:Re.id,subgraphId:$})]?ue.push(Re.id):(fe(),Y.push(Re));return fe(),Y}for(const z of i){const L=n.filter(se=>c.get(se.id)===z.id),$=p.get(z.id),Y=z.groups??[],ue=w(Y),pe=new Map,fe=new Map((z.groups??[]).map(se=>[se.id,se])),Re=new Set,Ie=[],Ae=se=>pe.get(se)??`legacy-group-${z.id}-${se}`,_=se=>{const ce=[],Ue=new Set;let De=se;for(;De!=null&&!Ue.has(De);)ce.push(De),Ue.add(De),De=ue.get(De)??null;ce.reverse();for(const E of ce){if(Re.has(E))continue;const A=ue.get(E)??null,O=fe.get(E)?.stableKey??`legacy-group-${z.id}-${E}`;pe.set(E,O);const te={type:"group",id:E,subgraphId:z.id,stableKey:O};if(A==null)Ie.push(te),x.groupParents[O]={scope:"subgraph",subgraphId:z.id};else{const Le=Ae(A);x.groups[Le]??=[],x.groups[Le].push(te),x.groupParents[O]={scope:"group",groupKey:Le}}Re.add(E)}};for(const se of L){const ce=$?.get(se.id);if(ce===void 0){Ie.push({type:"node",id:se.id});continue}_(ce),x.groups[Ae(ce)]??=[],x.groups[Ae(ce)].push({type:"node",id:se.id})}for(const se of Y)_(se.id);for(const se of Y){const ce=Ae(se.id);x.groups[ce]=k(x.groups[ce]??[],`group-${ce}`,z.id)}x.subgraphs[z.id]=k(Ie,`subgraph-${z.id}`,z.id)}const N=w(l),S=new Set,j=new Set,C=[],T=new Map,V=new Map(l.map(z=>[z.id,z])),U=z=>T.get(z)??`legacy-group-root-${z}`,R=z=>{const L=[],$=new Set;let Y=z;for(;Y!=null&&!$.has(Y);)L.push(Y),$.add(Y),Y=N.get(Y)??null;L.reverse();for(const ue of L){if(S.has(ue))continue;const pe=N.get(ue)??null,fe=V.get(ue)?.stableKey??`legacy-group-root-${ue}`;T.set(ue,fe);const Re={type:"group",id:ue,subgraphId:null,stableKey:fe};if(pe==null)C.push(Re),x.groupParents[fe]={scope:"root"};else{const Ie=U(pe);x.groups[Ie]??=[],x.groups[Ie].push(Re),x.groupParents[fe]={scope:"group",groupKey:Ie}}S.add(ue)}};for(const z of f){const L=m.get(z.id);if(L===void 0){C.push({type:"node",id:z.id});continue}R(L),x.groups[U(L)]??=[],x.groups[U(L)].push({type:"node",id:z.id})}for(const z of i){if(j.has(z.id))continue;const L=y.get(z.id);L!=null?(R(L),x.groups[U(L)]??=[],x.groups[U(L)].push({type:"subgraph",id:z.id})):C.push({type:"subgraph",id:z.id}),j.add(z.id)}for(const z of l)R(z.id);for(const z of l){const L=U(z.id);x.groups[L]=k(x.groups[L]??[],`group-${L}`,null)}return x.root=k(C,"root",null),x}function T0(n,o){const s=f=>{const m=[];for(const p of f)if(!(p.type==="node"&&p.id===o)){if(p.type==="hiddenBlock"){const g=n.hiddenBlocks[p.blockId];if(g&&g.filter(x=>x!==o).length===0)continue}m.push(p)}return m},l={};for(const[f,m]of Object.entries(n.hiddenBlocks)){const p=m.filter(g=>g!==o);p.length>0&&(l[f]=p)}const i={};for(const[f,m]of Object.entries(n.groups))i[f]=s(m);const c={};for(const[f,m]of Object.entries(n.subgraphs))c[f]=s(m);return{root:s(n.root),groups:i,groupParents:n.groupParents??{},subgraphs:c,hiddenBlocks:l}}function jw(n,o,s){const l={type:"node",id:o},i=(c,f)=>{const m=(p,g)=>{for(const y of p){if(y.type==="group"&&y.id===c&&g===f)return y.stableKey;if(y.type==="group"){const x=m(n.groups[y.stableKey]??[],g);if(x)return x;continue}if(y.type==="subgraph"){const x=m(n.subgraphs[y.id]??[],y.id);if(x)return x}}return null};return m(n.root,null)};if(s?.subgraphId){const c=n.subgraphs[s.subgraphId]??[];if(s.groupId!=null){const f=i(s.groupId,s.subgraphId);if(!f)return{...n,subgraphs:{...n.subgraphs,[s.subgraphId]:[...c,l]}};const m=n.groups[f]??[];return{...n,groups:{...n.groups,[f]:[...m,l]}}}return{...n,subgraphs:{...n.subgraphs,[s.subgraphId]:[...c,l]}}}if(s?.groupId!=null){const c=i(s.groupId,s.subgraphId??null);if(!c)return{...n,root:[...n.root,l]};const f=n.groups[c]??[];return{...n,groups:{...n.groups,[c]:[...f,l]}}}return{...n,root:[...n.root,l]}}function Mw(n,o){const s=n.groups[o]??[],l=g=>{const y=[];for(const x of g)x.type==="group"&&x.stableKey===o?y.push(...s):y.push(x);return y},i={...n.groups},c={...n.groupParents??{}},f=c[o];delete i[o],delete c[o];let m=n.root;n.root.some(g=>g.type==="group"&&g.stableKey===o)&&(m=l(n.root));for(const[g,y]of Object.entries(i))y.some(x=>x.type==="group"&&x.stableKey===o)&&(i[g]=l(y));const p={...n.subgraphs};for(const[g,y]of Object.entries(p))y.some(x=>x.type==="group"&&x.stableKey===o)&&(p[g]=l(y));for(const g of s)g.type==="group"&&(f?c[g.stableKey]=f:delete c[g.stableKey]);return{root:m,groups:i,groupParents:c,subgraphs:p,hiddenBlocks:n.hiddenBlocks}}function Ow(n,o,s,l,i,c){const f=n.groupParents??{},m=(N,S)=>S.scope==="root"?N.root:S.scope==="group"?N.groups[S.groupKey]??[]:N.subgraphs[S.subgraphId]??[],p=(N,S,j)=>S.scope==="root"?{...N,root:j}:S.scope==="group"?{...N,groups:{...N.groups,[S.groupKey]:j}}:{...N,subgraphs:{...N.subgraphs,[S.subgraphId]:j}},g=N=>N.scope==="root"?{scope:"root"}:N.scope==="group"?{scope:"group",groupKey:N.groupKey}:{scope:"subgraph",subgraphId:N.subgraphId};if(s.scope===i.scope&&(s.scope==="root"||s.scope==="group"&&i.scope==="group"&&s.groupKey===i.groupKey||s.scope==="subgraph"&&i.scope==="subgraph"&&s.subgraphId===i.subgraphId)){const N=[...m(n,s)],[S]=N.splice(l,1);if(!S)return n;const j=c>l?c-1:c;return N.splice(j,0,S),p(n,s,N)}const x=[...m(n,s)];x.splice(l,1);let w=p(n,s,x);const k=[...m(w,i)];return k.splice(c,0,o),w=p(w,i,k),o.type==="group"&&(w={...w,groupParents:{...w.groupParents??f,[o.stableKey]:g(i)}}),w}function ob(n){const o=[],s=l=>{for(const i of l)if(i.type==="node")o.push(i.id);else if(i.type==="group"){const c=n.groups[i.stableKey];c&&s(c)}else if(i.type==="subgraph"){const c=n.subgraphs[i.id];c&&s(c)}else if(i.type==="hiddenBlock"){const c=n.hiddenBlocks[i.blockId];c&&o.push(...c)}};return s(n.root),o}function Tw(n,o){return o.scope==="root"?n.root:o.scope==="group"?n.groups[o.groupKey]??[]:n.subgraphs[o.subgraphId]??[]}function rb(n,o){const s=(i,c)=>{const f=i.findIndex(m=>Nw(m,o));return f>=0?{containerId:c,index:f}:null},l=s(n.root,{scope:"root"});if(l)return l;for(const[i,c]of Object.entries(n.groups)){const f=s(c,{scope:"group",groupKey:i});if(f)return f}for(const[i,c]of Object.entries(n.subgraphs)){const f=s(c,{scope:"subgraph",subgraphId:i});if(f)return f}return null}function Ew(n,o,s=250){const l=n.nodes.find(i=>i.id===o);return l?[l.pos[0]+s,l.pos[1]]:null}function E0(n){return n.nodes.length===0?[0,0]:[0,Math.max(...n.nodes.map(s=>s.pos[1]+(s.size?.[1]??100)))+80]}function Iw(n,o,s,l=24){const[i,c,f,m]=o.bounding,[p,g]=s,y=i+l,x=c+48,w=Math.max(y,i+f-p-l),k=Math.max(x,c+m-g-l);return[Math.min(Math.max(n[0],y),w),Math.min(Math.max(n[1],x),k)]}function sb(n,o){const s=(l,i,c,f)=>{for(const m of l){if(o({ref:m,groupKeys:i,subgraphIds:c,currentSubgraphId:f}))return{groupKeys:i,subgraphIds:c,currentSubgraphId:f};if(m.type==="group"){const p=s(n.groups[m.stableKey]??[],[...i,m.stableKey],c,f);if(p)return p;continue}if(m.type==="subgraph"){const p=s(n.subgraphs[m.id]??[],i,[...c,m.id],m.id);if(p)return p}}return null};return s(n.root,[],[],null)}const Tf="__mobile_origin",qr="__mobile_subgraph_group_map";let Lw=0;function fs(n,o){return kw(yw(n),n,o)}function Aw(){return typeof crypto<"u"&&typeof crypto.randomUUID=="function"?`sk_${crypto.randomUUID()}`:`sk_${Math.random().toString(36).slice(2)}_${Date.now().toString(36)}`}function Rw(n){const o=[],s=new Set,l=new Set,i=(c,f)=>{for(const m of c){if(m.type==="node"){o.push(cn({type:"node",nodeId:m.id,subgraphId:f}));continue}if(m.type==="group"){if(o.push(m.stableKey),s.has(m.stableKey))continue;s.add(m.stableKey),i(n.groups[m.stableKey]??[],f);continue}if(m.type==="subgraph"){const p=cn({type:"subgraph",subgraphId:m.id});if(o.push(p),l.has(m.id))continue;l.add(m.id),i(n.subgraphs[m.id]??[],m.id)}}};return i(n.root,null),o}function I0(n){const o=ip(n);return o?o.type==="node"?`node:${o.nodeId}`:o.type==="group"?`group:${o.subgraphId??"root"}:${o.groupId}`:`subgraph:${o.subgraphId}`:`unknown:${n}`}function Lo(n,o,s){const l=Rw(n),i=new Map;for(const[p,g]of Object.entries(s)){const y=I0(g),x=i.get(y)??[];x.push(p),i.set(y,x)}const c=new Set,f={},m={};for(const p of l){let g=o[p];if(g&&c.has(g)&&(g=void 0),!g){const y=I0(p),x=i.get(y)??[];for(;x.length>0;){const w=x.shift();if(!(!w||c.has(w))){g=w;break}}i.set(y,x)}g||(g=Aw()),c.add(g),f[p]=g,m[g]=p}return{layoutToStable:f,stableToLayout:m}}function _w(n,o){const s=new Set(o.nodes.map(i=>i.id)),l=new Set(ob(n));if(s.size!==l.size)return!1;for(const i of s)if(!l.has(i))return!1;return!0}function ga(n,o=null){return cn({type:"node",nodeId:n,subgraphId:o})}function Dw(n){const o=po(n);return ga(n.id,o?.scope==="subgraph"?o.subgraphId:null)}const L0=new WeakMap;function Bw(n){const o=L0.get(n);if(o)return o;const s=new Map;for(const l of n.nodes){const i=Dw(l),c=s.get(l.id);c?c.includes(i)||c.push(i):s.set(l.id,[i])}return L0.set(n,s),s}function ua(n,o,s=null){if(s!=null)return[ga(o,s)];const l=Bw(n).get(o)??[];return l.length>0?[...l]:[ga(o,null)]}function Jd(n,o){if(!o)return{};const s={};for(const[l,i]of Object.entries(o)){if(!i)continue;if(l.includes(":node:")||l.includes("/node:")){const f=ip(l);if(f?.type==="node"){s[ga(f.nodeId,f.subgraphId)]=!0;continue}const m=l.match(/^(root|subgraph:(.*)):node:(\d+)$/);if(!m)continue;const p=Number(m[3]);if(!Number.isFinite(p))continue;s[ga(p,m[1]==="root"?null:m[2]??null)]=!0;continue}const c=Number(l);if(Number.isFinite(c))for(const f of ua(n,c))s[f]=!0}return s}function A0(n){const o=i=>i.map(c=>c.type!=="group"?c:{...c}),s={};for(const[i,c]of Object.entries(n.groups)){const f=i,m=o(c);s[f]?s[f]=[...s[f],...m]:s[f]=m}const l={};for(const[i,c]of Object.entries(n.subgraphs))l[i]=o(c);return{...n,root:o(n.root),groups:s,subgraphs:l}}function Wi(n,o,s=null){const l=new Set,i=(c,f)=>{for(const m of c)m.type==="group"?(m.id===o&&f===s&&l.add(m.stableKey),i(n.groups[m.stableKey]??[],f)):m.type==="subgraph"&&i(n.subgraphs[m.id]??[],m.id)};return i(n.root,null),[...l]}function up(n,o){return o[n]??null}function zw(n,o){const s=new Set,l=[];for(const i of n){const c=up(i,o);!c||s.has(c)||(s.add(c),l.push(c))}return l}function Hw(n,o,s=null){const l=[],i=new Set;for(const[c,f]of Object.entries(n)){if(i.has(f))continue;const m=ip(c);m?.type==="node"&&m.nodeId===o&&(s!==null&&m.subgraphId!==s||(i.add(f),l.push(f)))}return l}function ps(n,o,s,l=null){const i=Hw(o,s,l);return i.length>0?i:zw(ua(n,s,l),o)}function Hn(n,o,s){const l=n.nodes.find(i=>i.stableKey===o);if(l){const i=po(l);return{nodeId:l.id,subgraphId:i?.scope==="subgraph"?i.subgraphId:null}}return null}function Gi(n,o,s){const l=(n.groups??[]).find(i=>i.stableKey===o);if(l)return{type:"group",groupId:l.id,subgraphId:null,stableKey:o};for(const i of n.definitions?.subgraphs??[]){if(i.stableKey===o)return{type:"subgraph",subgraphId:i.id,stableKey:o};const c=(i.groups??[]).find(f=>f.stableKey===o);if(c)return{type:"group",groupId:c.id,subgraphId:i.id,stableKey:o}}return null}function Pi(n,o){return(n.definitions?.subgraphs??[]).find(l=>l.id===o)?.stableKey??null}function lb(n,o){const s=n.groupParents?.[o];return s?s.scope==="subgraph"?s.subgraphId:s.scope==="root"?null:lb(n,s.groupKey):null}function ef(n,o){if(!n)return{};const s={};for(const[l,i]of Object.entries(n)){if(!i)continue;const c=up(l,o);c&&(s[c]=!0)}return s}function Vw(n,o){if(!n)return{};const s={};for(const[l,i]of Object.entries(n)){if(i!==!0)continue;const c=up(l,o);c&&(s[c]=!0)}return s}function Yi(n,o,s){if(!n)return{};const l={};for(const[i,c]of Object.entries(n)){if(!c)continue;if(s[i]){l[i]=!0;continue}const f=o[i];f&&(l[f]=!0)}return l}function tf(n,o,s){if(!n)return{};const l={};for(const[i,c]of Object.entries(n)){if(c!==!0)continue;if(s[i]){l[i]=!0;continue}const f=o[i];f&&(l[f]=!0)}return l}function Qi(n,o){if(!n)return{};const s={};for(const[l,i]of Object.entries(n)){if(!i)continue;const c=o[l];c&&(s[c]=!0)}return s}function Ef(n){return n.map(o=>({...o,widgets_values:o.widgets_values??[],inputs:o.inputs??[],outputs:o.outputs??[],flags:o.flags??{},properties:o.properties??{},mode:o.mode??0,order:o.order??0}))}function R0(n){const o=JSON.parse(JSON.stringify(n));return o.nodes=Ef(o.nodes??[]),o.links=o.links??[],o.groups=o.groups??[],o.config=o.config??{},o.definitions?.subgraphs&&(o.definitions.subgraphs=o.definitions.subgraphs.map(s=>({...s,nodes:Ef(s.nodes??[]),links:s.links??[]}))),o.last_node_id=o.last_node_id??Math.max(0,...o.nodes.map(s=>s.id)),o.last_link_id=o.last_link_id??0,o.version=o.version??.4,o}function _0(n){if(!("stableKey"in n))return n;const{stableKey:o,...s}=n;return s}function D0(n){if(!("stableKey"in n))return n;const{stableKey:o,...s}=n;return s}function gu(n){const o=n.nodes.map(_0),s=(n.groups??[]).map(D0),l=o.some((m,p)=>m!==n.nodes[p])||s.some((m,p)=>m!==(n.groups??[])[p]),i=n.definitions?.subgraphs;if(!i)return l?{...n,nodes:o,groups:s}:n;let c=!1;const f=i.map(m=>{const p=m.nodes.map(_0),g=(m.groups??[]).map(D0);let y=p.some((k,N)=>k!==m.nodes[N])||g.some((k,N)=>k!==(m.groups??[])[N]);if(m.stableKey!=null&&(y=!0),!y)return m;c=!0;const{stableKey:x,...w}=m;return{...w,nodes:p,groups:g}});return!l&&!c?n:{...n,nodes:o,groups:s,definitions:{...n.definitions??{},subgraphs:f}}}function po(n){if(!n)return null;const s=n.properties?.[Tf];if(!s||typeof s!="object")return null;const l=s.scope;if(l==="root"){const i=s.nodeId;return typeof i=="number"?{scope:"root",nodeId:i}:null}if(l==="subgraph"){const i=s.nodeId,c=s.subgraphId;if(typeof i=="number"&&typeof c=="string")return{scope:"subgraph",subgraphId:c,nodeId:i}}return null}function Kw(n){const o=po(n);return cn({type:"node",nodeId:n.id,subgraphId:o?.scope==="subgraph"?o.subgraphId:null})}function B0(n,o,s=null){return n.map(l=>{const i=s===null?Kw(l):cn({type:"node",nodeId:l.id,subgraphId:s}),c=o[i];return!c||l.stableKey===c?l:{...l,stableKey:c}})}function z0(n,o,s){return n.map(l=>{const i=cn({type:"group",groupId:l.id,subgraphId:s}),c=o[i];return!c||l.stableKey===c?l:{...l,stableKey:c}})}function jo(n,o){const s=B0(n.nodes,o),l=z0(n.groups??[],o,null),i=s.some((g,y)=>g!==n.nodes[y]),c=l.some((g,y)=>g!==(n.groups??[])[y]),f=n.definitions?.subgraphs;if(!f)return i||c?{...n,nodes:s,groups:l}:n;let m=!1;const p=f.map(g=>{const y=B0(g.nodes??[],o,g.id),x=z0(g.groups??[],o,g.id),w=cn({type:"subgraph",subgraphId:g.id}),k=o[w];return y.some((S,j)=>S!==(g.nodes??[])[j])||x.some((S,j)=>S!==(g.groups??[])[j])||k!=null&&g.stableKey!==k?(m=!0,{...g,stableKey:k??g.stableKey,nodes:y,groups:x}):g});return!i&&!c&&!m?n:{...n,nodes:s,groups:l,definitions:{...n.definitions??{},subgraphs:p}}}function yu(n,o){const s=new Set,l=Array.from(n);for(;l.length>0;){const i=l.pop();if(!i||s.has(i))continue;s.add(i);const c=o.get(i);if(c)for(const f of c)s.has(f)||l.push(f)}return s}function Uw(n){const o=new Set(n.map(l=>l.id)),s=new Map;for(const l of n)for(const i of l.nodes??[]){if(!o.has(i.type))continue;const c=s.get(i.type)??[];c.push({parentId:l.id,nodeId:i.id}),s.set(i.type,c)}return s}function ra(n,o,s){return!s||s.length===0?null:ma(o,s).get(n)??null}function $w(n,o){const s=sb(n,({ref:l,currentSubgraphId:i})=>l.type==="node"&&o.type==="node"?l.id===o.id:l.type==="group"&&o.type==="group"?o.id===l.id&&(o.subgraphId??null)===i:l.type==="subgraph"&&o.type==="subgraph"?o.id===l.id:!1);return s?{groupKeys:s.groupKeys,subgraphIds:s.subgraphIds}:null}function If(n,o,s=null){const l=n.nodes??[],i=n.groups??[],c=n.definitions?.subgraphs??[],f=new Map(c.map(w=>[w.id,w])),m=new Set(c.map(w=>w.id)),p=new Map,g=[];for(const w of l){const k=po(w);if(k?.scope==="subgraph"){const N=p.get(k.subgraphId);N?N.push(w):p.set(k.subgraphId,[w])}else g.push(w)}const y=new Map;for(const w of c){const k=new Set;for(const N of w.nodes??[])m.has(N.type)&&k.add(N.type);k.size>0&&y.set(w.id,k)}const x=new Set;if(s){const w=f.get(s);if(!w)return x;const k=w.groups??[];if(!k.find(R=>R.id===o))return x;const S=w.nodes??[],j=ma(S,k),C=new Set,T=new Set;for(const R of S)j.get(R.id)===o&&(m.has(R.type)?C.add(R.type):T.add(R.id));const V=p.get(s)??[];for(const R of V){const z=po(R);z?.scope==="subgraph"&&T.has(z.nodeId)&&x.add(R.id)}const U=yu(C,y);for(const R of U){const z=p.get(R)??[];for(const L of z)x.add(L.id)}}else{if(!i.find(C=>C.id===o))return x;const k=ma(g,i);for(const C of g)k.get(C.id)===o&&x.add(C.id);const N=n.extra?.[qr],S=new Set;if(N&&typeof N=="object")for(const[C,T]of Object.entries(N))T===o&&S.add(C);const j=yu(S,y);for(const C of j){const T=p.get(C)??[];for(const V of T)x.add(V.id)}}return x}function ab(n){const o=n.definitions?.subgraphs??[],s=new Set(o.map(i=>i.id)),l=new Map;for(const i of o){const c=new Set;for(const f of i.nodes??[])s.has(f.type)&&c.add(f.type);c.size>0&&l.set(i.id,c)}return l}function H0(n,o){const s=ab(n),l=yu([o],s),i=new Set;for(const c of n.nodes??[]){const f=po(c);f?.scope==="subgraph"&&l.has(f.subgraphId)&&i.add(c.id)}return i}function Fw(n,o){return n.scope==="subgraph"?n.subgraphId:n.scope==="root"?null:lb(o,n.groupKey)}function qw(n,o){const s=new Map;let l=Math.max(0,...o.map(c=>c.id))+1;const i=n.map(c=>{const f=l++;return s.set(c.id,f),{...c,id:f}});return{idMap:s,promotedGroups:i}}function V0(n,o){if(o.size===0)return n;const s=new Set;for(const c of n.links??[])(o.has(c[1])||o.has(c[3]))&&s.add(c[0]);const l=(n.links??[]).filter(c=>!s.has(c[0])),i=(n.nodes??[]).filter(c=>!o.has(c.id)).map(c=>{const f=(c.inputs??[]).map(p=>p.link!=null&&s.has(p.link)?{...p,link:null}:p),m=(c.outputs??[]).map(p=>{const g=(p.links??[]).filter(y=>!s.has(y));return{...p,links:g.length>0?g:null}});return{...c,inputs:f,outputs:m}});return{...n,nodes:i,links:l}}function Ww(n,o,s,l){if(!Array.isArray(n.widgets_values)){const c={...n.widgets_values||{}};return l?(c[l]=s,n.type==="VHS_VideoCombine"&&l==="save_image"&&"save_output"in c&&(c.save_output=s)):o>=0&&(c[String(o)]=s),{...n,widgets_values:c}}let i=[...n.widgets_values];return o>=i.length?i.push(s):i[o]=s,n.type==="Power Lora Loader (rgthree)"&&(i=i.filter(c=>c!==null)),{...n,widgets_values:i}}function Gw(n,o){if(!Array.isArray(n.widgets_values))return n;const s=[...n.widgets_values];for(const[l,i]of Object.entries(o)){const c=parseInt(l,10);s[c]=i}return{...n,widgets_values:s}}function Xi(n,o){const s=po(o)??{scope:"root",nodeId:o.id};if(s.scope==="root"){const c=n.nodes.map(f=>f.id===s.nodeId?{...f,widgets_values:o.widgets_values??[]}:f);return{...n,nodes:c}}const l=n.definitions?.subgraphs;if(!l)return n;const i=l.map(c=>{if(c.id!==s.subgraphId)return c;const f=c.nodes.map(m=>m.id===s.nodeId?{...m,widgets_values:o.widgets_values??[]}:m);return{...c,nodes:f}});return{...n,definitions:{...n.definitions,subgraphs:i}}}function nf(n,o,s){const l=["fixed","randomize","increment","decrement"];if(Array.isArray(s.widgets_values)){const c=s.widgets_values.find(f=>typeof f=="string"&&l.includes(f.toLowerCase()));if(typeof c=="string"){const f=c.toLowerCase();if(l.includes(f))return f}}const i=rl(n,o,s);if(i!==null&&Array.isArray(s.widgets_values)){const c=Number(s.widgets_values[i]),f=tb(c);if(f)return f;const p=(s.outputs??[]).some(w=>String(w.name||"").toLowerCase().includes("seed")&&String(w.type||"").toUpperCase().includes("INT")),g=s.widgets_values.slice(i+1),y=g.length>0&&g.every(w=>w===""||w===null||w===void 0),x=s.properties&&("randomMin"in s.properties||"randomMax"in s.properties);if(p&&y&&x)return"randomize"}return"fixed"}function Pw(n,o){const s={};for(const l of n.nodes){const i=o[l.type];if(!i?.input)continue;const c=i.input_order?.required||Object.keys(i.input.required||{}),f=i.input_order?.optional||Object.keys(i.input.optional||{}),m=[...c,...f];for(const p of m){const g=i.input.required?.[p]||i.input.optional?.[p];if(!g)continue;const[y]=g;if(!Array.isArray(y)||y.length===0||l.inputs.find(T=>T.name===p)?.link!=null)continue;const w=Wr(n,o,l,p);if(w===null)continue;const k=da(l,p,w);if(k==null)continue;const N=ep(k,y,{comboIndexToValue:!0}),S=String(N),j=S.split(/[\\/]/).pop()??S;if(!y.some(T=>{const V=String(T);return V===S||V===j})){const T=String(l.id);s[T]||(s[T]=[]),s[T].push({type:"workflow_load",message:`Missing value: ${S}`,details:"Not found on server.",inputName:p})}}}return s}const ae=Oo()(xr((n,o)=>{const s=H=>{const{hiddenItems:P,workflow:D,stableKeyByPointer:K}=o();if(!D){sn.getState().setNodeErrors(H);return}const q=Object.keys(H).filter(Ee=>{const je=Number(Ee);return Number.isFinite(je)?ps(D,K,je).some(Ne=>!!P[Ne]):!1});if(q.length>0){const Ee={...P};for(const je of q){const Ne=Number(je);if(Number.isFinite(Ne))for(const ee of ps(D,K,Ne))delete Ee[ee]}n({hiddenItems:Ee})}sn.getState().setNodeErrors(H)},l=(H,P)=>{const{workflow:D,hiddenItems:K,connectionHighlightModes:Z,mobileLayout:q,stableKeyByPointer:Ee,pointerByStableKey:je}=o();if(!D)return;const Ne=Hn(D,H);if(!Ne)return;const{nodeId:ee,subgraphId:Me}=Ne;if(!D.nodes.some(Fe=>{if(Fe.id!==ee)return!1;const st=po(Fe);return Me==null?st?.scope!=="subgraph":st?.scope==="subgraph"&&st.subgraphId===Me}))return;const I=new Set,B=D.links.filter(Fe=>{const st=Fe[3]===ee;return st&&I.add(Fe[0]),st}),W=D.links.filter(Fe=>{const st=Fe[1]===ee;return st&&I.add(Fe[0]),st});let be=D.last_link_id;const me=new Map,ke=new Map,F=[];if(P)for(const Fe of W){const[,,,st,ft,Nt]=Fe,Ht=B.find(Ke=>O0(Ke[5],Nt));if(!Ht)continue;const[,Vt,ye]=Ht;be+=1;const Q=[be,Vt,ye,st,ft,Nt];F.push(Q);const re=`${st}:${ft}`;me.set(re,Q[0]);const de=`${Vt}:${ye}`,Oe=ke.get(de)??[];Oe.push(Q[0]),ke.set(de,Oe)}const ie=[...D.links.filter(Fe=>!I.has(Fe[0])),...F],_e=D.nodes.filter(Fe=>Fe.id!==ee).map(Fe=>{const st=Fe.inputs.map((Nt,Ht)=>{const Vt=`${Fe.id}:${Ht}`,ye=me.get(Vt);return ye!=null?{...Nt,link:ye}:Nt.link!=null&&I.has(Nt.link)?{...Nt,link:null}:Nt}),ft=Fe.outputs.map((Nt,Ht)=>{const ye=(Nt.links??[]).filter(Oe=>!I.has(Oe)),Q=`${Fe.id}:${Ht}`,re=ke.get(Q)??[],de=[...ye,...re];return{...Nt,links:de.length>0?de:null}});return{...Fe,inputs:st,outputs:ft}}),$e={...K};for(const Fe of ps(D,Ee,ee,Me))delete $e[Fe];for(const Fe of ua(D,ee,Me))delete $e[Fe];const Ze={...Z};delete Ze[ee];const Ge=T0(q,ee),nt=Lo(Ge,Ee,je),Ye=jo({...D,nodes:_e,links:ie,last_link_id:be},nt.layoutToStable);n({workflow:Ye,hiddenItems:$e,connectionHighlightModes:Ze,mobileLayout:Ge,stableKeyByPointer:nt.layoutToStable,pointerByStableKey:nt.stableToLayout})},i=(H,P,D,K,Z)=>{const{workflow:q,pointerByStableKey:Ee}=o();if(!q)return;const je=Hn(q,H),Ne=Hn(q,D);if(!je||!Ne)return;const ee=je.nodeId,Me=Ne.nodeId,I=q.nodes.find(_e=>_e.id===ee),B=q.nodes.find(_e=>_e.id===Me);if(!I||!B)return;let W=[...q.links],be=q.last_link_id;const me=B.inputs[K]?.link;me!=null&&(W=W.filter(_e=>_e[0]!==me)),be++;const ke=be,F=[ke,ee,P,Me,K,Z];W.push(F);const ie=q.nodes.map(_e=>{if(_e.id===Me){const $e=[..._e.inputs];return $e[K]={...$e[K],link:ke},{..._e,inputs:$e}}if(_e.id===ee){const $e=[..._e.outputs],nt=[...($e[P]?.links??[]).filter(Ye=>Ye!==me),ke];return $e[P]={...$e[P],links:nt},{..._e,outputs:$e}}if(me!=null&&_e.id!==ee&&_e.outputs.some(Ze=>Ze.links?.includes(me))){const Ze=_e.outputs.map(Ge=>{if(Ge.links?.includes(me)){const nt=Ge.links.filter(Ye=>Ye!==me);return{...Ge,links:nt.length>0?nt:null}}return Ge});return{..._e,outputs:Ze}}return _e});n({workflow:{...q,nodes:ie,links:W,last_link_id:be}})},c=(H,P)=>{const{workflow:D,pointerByStableKey:K}=o();if(!D)return;const Z=Hn(D,H);if(!Z)return;const q=Z.nodeId,Ee=D.nodes.find(Me=>Me.id===q);if(!Ee)return;const je=Ee.inputs[P]?.link;if(je==null)return;const Ne=D.links.filter(Me=>Me[0]!==je),ee=D.nodes.map(Me=>{if(Me.id===q){const B=[...Me.inputs];return B[P]={...B[P],link:null},{...Me,inputs:B}}if(Me.outputs.some(B=>B.links?.includes(je))){const B=Me.outputs.map(W=>{if(W.links?.includes(je)){const be=W.links.filter(me=>me!==je);return{...W,links:be.length>0?be:null}}return W});return{...Me,outputs:B}}return Me});n({workflow:{...D,nodes:ee,links:Ne}})},f=(H,P)=>{const{workflow:D,nodeTypes:K,mobileLayout:Z}=o();if(!D||!K)return null;const q=K[H];if(!q)return null;const Ee=D.last_node_id+1,je=[],Ne=q.input?.required??{},ee=q.input?.optional??{},Me=q.input_order?.required??Object.keys(Ne),I=q.input_order?.optional??Object.keys(ee);for(const Ge of Me){const nt=Ne[Ge];if(!nt)continue;const[Ye]=nt;if(Array.isArray(Ye))continue;const Fe=String(Ye).toUpperCase();["INT","FLOAT","BOOLEAN","STRING"].includes(Fe)||je.push({name:Ge,type:String(Ye),link:null})}for(const Ge of I){const nt=ee[Ge];if(!nt)continue;const[Ye]=nt;if(Array.isArray(Ye))continue;const Fe=String(Ye).toUpperCase();["INT","FLOAT","BOOLEAN","STRING"].includes(Fe)||je.push({name:Ge,type:String(Ye),link:null})}const B=(q.output??[]).map((Ge,nt)=>({name:q.output_name?.[nt]??Ge,type:Ge,links:null,slot_index:nt})),W=[];for(const Ge of Me){const nt=Ne[Ge];if(!nt)continue;const[Ye,Fe]=nt;if(Array.isArray(Ye)){W.push(Ye[0]??"");continue}const st=String(Ye).toUpperCase();st==="INT"||st==="FLOAT"?W.push(Fe?.default??0):st==="STRING"?W.push(Fe?.default??""):st==="BOOLEAN"&&W.push(Fe?.default??!1)}for(const Ge of I){const nt=ee[Ge];if(!nt)continue;const[Ye,Fe]=nt;if(Array.isArray(Ye)){W.push(Ye[0]??"");continue}const st=String(Ye).toUpperCase();st==="INT"||st==="FLOAT"?W.push(Fe?.default??0):st==="STRING"?W.push(Fe?.default??""):st==="BOOLEAN"&&W.push(Fe?.default??!1)}let be=[0,0];if(P?.nearNodeStableKey){const Ge=Hn(D,P.nearNodeStableKey,o().pointerByStableKey);Ge&&(be=Ew(D,Ge.nodeId)??be)}else if(P?.inSubgraphId){const Ge=D.nodes.filter(nt=>{const Ye=po(nt);return Ye?.scope==="subgraph"&&Ye.subgraphId===P.inSubgraphId});if(Ge.length>0){const nt=Math.max(...Ge.map(Fe=>Fe.pos[1]+(Fe.size?.[1]??100)));be=[Math.min(...Ge.map(Fe=>Fe.pos[0])),nt+80]}else be=E0(D)}else be=E0(D);if(P?.inGroupId!=null){const nt=[...D.groups??[],...(D.definitions?.subgraphs??[]).flatMap(Ye=>Ye.groups??[])].find(Ye=>Ye.id===P.inGroupId);nt&&(be=Iw(be,nt,[200,100]))}const me={};P?.inSubgraphId&&(me[Tf]={scope:"subgraph",subgraphId:P.inSubgraphId,nodeId:Ee});const ke={id:Ee,type:H,pos:be,size:[200,100],flags:{},order:0,mode:0,inputs:je,outputs:B,properties:me,widgets_values:W},F=jw(Z,Ee,{groupId:P?.inGroupId??void 0,subgraphId:P?.inSubgraphId??void 0}),{stableKeyByPointer:ie,pointerByStableKey:_e}=o(),$e=Lo(F,ie,_e),Ze=jo({...D,nodes:[...D.nodes,ke],last_node_id:Ee},$e.layoutToStable);return n({workflow:Ze,mobileLayout:F,stableKeyByPointer:$e.layoutToStable,pointerByStableKey:$e.stableToLayout}),Ee},m=(H,P,D)=>{const{workflow:K,nodeTypes:Z,pointerByStableKey:q}=o();if(!K||!Z)return null;const Ee=Hn(K,P);if(!Ee)return null;const je=Ee.nodeId,Ne=K.nodes.find(ke=>ke.id===je);if(!Ne)return null;const ee=Ne.inputs[D];if(!ee)return null;const Me=Z[H];if(!Me)return null;const I=ee.type.toUpperCase(),B=(Me.output??[]).findIndex(ke=>O0(String(ke),I));if(B<0)return null;const W=o().addNode(H,{nearNodeStableKey:P});if(W===null)return null;const be=cn({type:"node",nodeId:W,subgraphId:Ee.subgraphId}),me=o().stableKeyByPointer[be];return me?(o().connectNodes(me,B,P,D,ee.type),W):null},p=(H,P)=>{n(D=>({...(()=>{const K=D.workflow?Hn(D.workflow,H,D.pointerByStableKey):null;if(!K)return{};const Z=String(K.nodeId);return{nodeOutputs:{...D.nodeOutputs,[Z]:P}}})()}))},g=H=>{n(P=>{const D=P.workflow?Hn(P.workflow,H,P.pointerByStableKey):null;if(!D)return{};const K=D.nodeId,Z=P.connectionHighlightModes[K]??"off",q=Z==="off"?"inputs":Z==="inputs"?"outputs":Z==="outputs"?"both":"off";return{connectionHighlightModes:{...P.connectionHighlightModes,[K]:q}}})},y=(H,P)=>{n(D=>({...(()=>{const K=D.workflow?Hn(D.workflow,H,D.pointerByStableKey):null;return K?{connectionHighlightModes:{...D.connectionHighlightModes,[K.nodeId]:P}}:{}})()}))},x=(H,P)=>{H&&n(D=>{const K={...D.hiddenItems};return P?K[H]=!0:delete K[H],{hiddenItems:K}})},w=H=>{const{workflow:P,pointerByStableKey:D}=o();if(!P)return;const K=Hn(P,H);if(!K)return;const Z=P.definitions?.subgraphs??[],q=K.subgraphId??null,Ee=P.nodes.find(me=>{if(me.id!==K.nodeId)return!1;const ke=po(me);return q===null?ke?.scope!=="subgraph":ke?.scope==="subgraph"&&ke.subgraphId===q});if(!Ee)return;const je=new Map(Z.map(me=>[me.id,me])),Ne=Uw(Z),ee=po(Ee),Me=P.nodes.filter(me=>po(me)?.scope!=="subgraph"),I=ee?.scope==="subgraph"?ee.nodeId:Ee.id,W=(()=>{const me=new Set,ke=[I];if(ee?.scope==="subgraph"){const F=je.get(ee.subgraphId),ie=new Map;for(F?.links?.forEach(_e=>{const $e=ie.get(_e.target_id)??[];$e.push(_e.origin_id),ie.set(_e.target_id,$e)});ke.length>0;){const _e=ke.pop();if(_e===void 0)continue;(ie.get(_e)??[]).forEach(Ze=>{me.has(Ze)||(me.add(Ze),ke.push(Ze))})}return me}for(;ke.length>0;){const F=ke.pop();if(F===void 0)continue;const ie=P.nodes.find(_e=>_e.id===F);ie&&ie.inputs?.forEach((_e,$e)=>{if(_e.link===null)return;const Ze=ll(P,F,$e);if(!Ze)return;const Ge=Ze.node.id;me.has(Ge)||(me.add(Ge),ke.push(Ge))})}return me})(),be=ee?.scope==="subgraph"?ee.subgraphId:null;n(me=>{const ke={...me.hiddenItems};for(const $e of ps(P,me.stableKeyByPointer,K.nodeId,q))delete ke[$e];W.forEach($e=>{for(const Ze of ps(P,me.stableKeyByPointer,$e,be))delete ke[Ze]});const F={...me.collapsedItems},ie=($e,Ze=null)=>{if($e!=null)for(const Ge of Wi(me.mobileLayout,$e,Ze))delete ke[Ge],delete F[Ge]},_e=$e=>{if(!$e)return;const Ze=Pi(P,$e);Ze&&(delete F[Ze],delete ke[Ze])};if(!ee||ee.scope==="root"){const $e=ra(Ee.id,Me,P.groups??[]);ie($e,null),W.forEach(Ze=>{const Ge=ra(Ze,Me,P.groups??[]);ie(Ge,null)})}else{_e(ee.subgraphId);const $e=je.get(ee.subgraphId);if($e){const Fe=ra(ee.nodeId,$e.nodes??[],$e.groups??[]);ie(Fe,ee.subgraphId)}const Ze=P.extra?.[qr],Ge=Ze&&typeof Ze=="object"?Ze[ee.subgraphId]:void 0;typeof Ge=="number"&&ie(Ge,null),$e&&W.forEach(Fe=>{const st=ra(Fe,$e.nodes??[],$e.groups??[]);ie(st,ee.subgraphId)});const nt=[ee.subgraphId],Ye=new Set;for(;nt.length>0;){const Fe=nt.pop();if(!Fe||Ye.has(Fe))continue;Ye.add(Fe);const st=Ne.get(Fe)??[];for(const ft of st){_e(ft.parentId);const Nt=je.get(ft.parentId);if(Nt){const Ht=ra(ft.nodeId,Nt.nodes??[],Nt.groups??[]);ie(Ht,ft.parentId)}Ye.has(ft.parentId)||nt.push(ft.parentId)}}}return{hiddenItems:ke,collapsedItems:F}})},k=(H,P,D,K)=>{const{workflow:Z,embedWorkflow:q,pointerByStableKey:Ee}=o();if(!Z)return;const je=Hn(Z,H);if(!je)return;const Ne=je.nodeId,ee=Z.nodes.map(B=>B.id===Ne?Ww(B,P,D,K):B),Me=ee.find(B=>B.id===Ne),I=q&&Me?Xi(q,Me):q;n({workflow:{...Z,nodes:ee},embedWorkflow:I}),sn.getState().clearNodeError(Ne)},N=(H,P)=>{const{workflow:D,embedWorkflow:K,pointerByStableKey:Z}=o();if(!D)return;const q=Hn(D,H);if(!q)return;const Ee=q.nodeId,je=D.nodes.map(Me=>Me.id===Ee?Gw(Me,P):Me),Ne=je.find(Me=>Me.id===Ee),ee=K&&Ne?Xi(K,Ne):K;n({workflow:{...D,nodes:je},embedWorkflow:ee}),sn.getState().clearNodeError(Ee)},S=(H,P)=>{const{workflow:D,pointerByStableKey:K}=o();if(!D)return;const Z=Hn(D,H);if(!Z)return;const q=Z.nodeId,Ee=P?.trim()??"",je=D.nodes.map(Ne=>{if(Ne.id!==q)return Ne;const ee={...Ne.properties??{}},Me={...Ne,properties:ee};return Ee?(Me.title=Ee,ee.title=Ee):(delete Me.title,delete ee.title),Me});n({workflow:{...D,nodes:je}})},j=H=>{const{workflow:P,pointerByStableKey:D}=o();if(!P)return;const K=Hn(P,H);if(!K)return;const Z=K.nodeId,q=P.nodes.map(Ee=>{if(Ee.id===Z){const Ne=(Ee.mode||0)===4?0:4;return{...Ee,mode:Ne}}return Ee});n({workflow:{...P,nodes:q}})},C=(H,P)=>{const{hiddenItems:D,workflow:K,pointerByStableKey:Z}=o();if(!K)return;const q=Hn(K,H);if(!q)return;const Ee=q.nodeId;if(D[H]&&o().setItemHidden(H,!1),document.body.dataset.textareaFocus==="true")return;o().setItemCollapsed(H,!1);const Ne=(ee,Me)=>{const I=document.getElementById(`node-anchor-${Ee}`)??document.getElementById(`node-${Ee}`),B=document.getElementById(`node-card-${Ee}`)??document.getElementById(`node-${Ee}`);if(!I||!B){ee>0?requestAnimationFrame(()=>Ne(ee-1,Me)):Me>0&&setTimeout(()=>Ne(10,Me-1),200);return}const W=I.closest('[data-node-list="true"]');if(W){const _e=I.getBoundingClientRect(),$e=W.getBoundingClientRect(),Ze=_e.top-$e.top,Ge=Math.max(0,W.scrollTop+Ze);W.scrollTo({top:Ge,behavior:"smooth"})}else I.scrollIntoView({behavior:"smooth",block:"start"});const be=W||window;let me=null;const ke=()=>{document.querySelectorAll(".highlight-pulse").forEach(_e=>_e.classList.remove("highlight-pulse")),B.classList.add("highlight-pulse"),setTimeout(()=>B.classList.remove("highlight-pulse"),1200),"vibrate"in navigator&&navigator.vibrate(10),P&&window.dispatchEvent(new CustomEvent("node-show-label",{detail:{nodeId:Ee,label:P}}))},F=()=>{me&&clearTimeout(me),me=setTimeout(()=>{ie(),ke()},120)},ie=()=>{me&&(clearTimeout(me),me=null),be.removeEventListener("scroll",F)};be.addEventListener("scroll",F,{passive:!0}),me=setTimeout(()=>{ie(),ke()},200)};Ne(10,2)},T=(H,P,D,K)=>{n(Z=>{const q=Date.now(),Ee=H&&P&&Z.workflow?(()=>{const W=Hn(Z.workflow,P,Z.pointerByStableKey);return W?String(W.nodeId):null})():null,je=H?D??Z.executingPromptId:null,Ne=H?Ee??Z.executingNodeId:null,ee={isExecuting:H,executingNodeId:Ne,executingPromptId:je,progress:K},Me=(W,be)=>{if(!W||be<=0||Z.workflow?.nodes.find($e=>String($e.id)===W)?.mode===4)return Z.nodeDurationStats;const ke=String(W),F=Z.nodeDurationStats[ke],ie=(F?.count??0)+1,_e=F?(F.avgMs*F.count+be)/ie:be;return{...Z.nodeDurationStats,[ke]:{avgMs:_e,count:ie}}};if(!H){if(Z.currentNodeStartTime&&Z.executingNodeId){const W=q-Z.currentNodeStartTime;ee.nodeDurationStats=Me(Z.executingNodeId,W)}if(Z.executionStartTime&&Z.workflow){const W=q-Z.executionStartTime,be=bu(Z.workflow),me=Z.workflowDurationStats[be],ke=(me?.count??0)+1,F=me?(me.avgMs*me.count+W)/ke:W;ee.workflowDurationStats={...Z.workflowDurationStats,[be]:{avgMs:F,count:ke}}}return ee.executionStartTime=null,ee.currentNodeStartTime=null,ee}const I=je&&je!==Z.executingPromptId,B=Ne&&Ne!==Z.executingNodeId;if(I&&(ee.executionStartTime=q,ee.currentNodeStartTime=q),B&&Z.currentNodeStartTime&&Z.executingNodeId){const W=q-Z.currentNodeStartTime;ee.nodeDurationStats=Me(Z.executingNodeId,W),ee.currentNodeStartTime=q}else Z.currentNodeStartTime||(ee.currentNodeStartTime=q);return ee})},V=H=>{n(P=>{const D=A0(H),K=Lo(D,P.stableKeyByPointer,P.pointerByStableKey);return{workflow:P.workflow?jo(P.workflow,K.layoutToStable):P.workflow,mobileLayout:D,stableKeyByPointer:K.layoutToStable,pointerByStableKey:K.stableToLayout}})},U=(H,P,D)=>{const{currentFilename:K,savedWorkflowStates:Z,nodeTypes:q}=o(),Ee=D?.fresh??!1,je=D?.source??{type:"other"};sn.getState().clearNodeErrors();const Ne=hw(H),ee=R0(H),Me=Ef(Ne.nodes),I={...Ne,nodes:Me,links:Ne.links??[],groups:Ne.groups??[],config:Ne.config??{},last_node_id:Ne.last_node_id??Math.max(0,...Me.map(ie=>ie.id)),last_link_id:Ne.last_link_id??0,version:Ne.version??.4},B=Xd(I,q),W=ho.getState(),be=P?W.pinnedWidgets[P]:void 0;if(be&&!W.pinnedWidgets[B]&&W.setPinnedWidget(be,B),W.restorePinnedWidgetForWorkflow(B,I),K&&o().saveCurrentWorkflowState(),Ee&&Z[B]){const ie={...Z};delete ie[B],n({savedWorkflowStates:ie})}const me={};if(q)for(const ie of I.nodes)rl(I,q,ie)!==null&&(me[ie.id]=nf(I,q,ie));let ke=Ee?null:Z[B];!ke&&!Ee&&P&&Z[P]&&(ke=Z[P],n({savedWorkflowStates:{...Z,[B]:Z[P]}}));let F=I;if(ke){const ie=I.nodes.map(re=>{const de=ke.nodes[re.id];return de?{...re,mode:de.mode??re.mode,flags:de.flags??re.flags,widgets_values:de.widgets_values??re.widgets_values}:re}),_e={...I,nodes:ie},$e=Jd(_e,o().hiddenItems),Ze={...ke.collapsedItems??{}},Ge={...ke.hiddenItems??{}},nt=fs(_e,$e),Ye=Lo(nt,o().stableKeyByPointer,o().pointerByStableKey),Fe=ef($e,Ye.layoutToStable),st=Vw(Ze,Ye.layoutToStable),ft=ef(Ge,Ye.layoutToStable),Nt=tf({...Ze,...st},Ye.layoutToStable,Ye.stableToLayout),Ht=Yi({...Ge,...ft},Ye.layoutToStable,Ye.stableToLayout),Vt={},ye=jo(_e,Ye.layoutToStable);F=ye;let Q=ee;if(Q)for(const re of ye.nodes)Q=Xi(Q,re);n({workflowSource:je,workflow:ye,embedWorkflow:Q,originalWorkflow:JSON.parse(JSON.stringify(ye)),currentFilename:P||null,currentWorkflowKey:B,collapsedItems:{...Vt,...Nt},hiddenItems:{...Ht,...Fe},mobileLayout:nt,stableKeyByPointer:Ye.layoutToStable,pointerByStableKey:Ye.stableToLayout,runCount:1,followQueue:!1,workflowLoadedAt:Date.now()}),$n.getState().setSeedModes({...me,...ke.seedModes}),$n.getState().setSeedLastValues({}),eo.getState().setCurrentPanel("workflow"),Mo.getState().setViewerState({viewerOpen:!1,viewerImages:[],viewerIndex:0,viewerScale:1,viewerTranslate:{x:0,y:0}})}else{const ie=o(),_e=ie.currentWorkflowKey===B,$e=Jd(I,o().hiddenItems),Ze=fs(I,$e),Ge=Lo(Ze,o().stableKeyByPointer,o().pointerByStableKey),nt=jo(I,Ge.layoutToStable),Ye=ef($e,Ge.layoutToStable),Fe={},st=_e?tf(ie.collapsedItems,Ge.layoutToStable,Ge.stableToLayout):{};sn.getState().setError(null),n({workflowSource:je,workflow:nt,embedWorkflow:ee,originalWorkflow:JSON.parse(JSON.stringify(nt)),currentFilename:P||null,currentWorkflowKey:B,collapsedItems:{...Fe,...st},mobileLayout:Ze,stableKeyByPointer:Ge.layoutToStable,pointerByStableKey:Ge.stableToLayout,hiddenItems:Ye,runCount:1,followQueue:!1,workflowLoadedAt:Date.now()}),$n.getState().setSeedModes(me),$n.getState().setSeedLastValues({}),eo.getState().setCurrentPanel("workflow"),Mo.getState().setViewerState({viewerOpen:!1,viewerImages:[],viewerIndex:0,viewerScale:1,viewerTranslate:{x:0,y:0}})}if(q){const ie=Pw(F,q),_e=Object.values(ie).reduce(($e,Ze)=>$e+Ze.length,0);_e>0?(s(ie),sn.getState().setError(`Workflow load error: ${_e} input${_e===1?"":"s"} reference missing options.`)):sn.getState().clearNodeErrors()}},R=()=>{const{currentWorkflowKey:H,savedWorkflowStates:P}=o();if(H){const D={...P};delete D[H],n({savedWorkflowStates:D})}sn.getState().clearNodeErrors(),n({workflowSource:null,workflow:null,embedWorkflow:null,originalWorkflow:null,currentFilename:null,currentWorkflowKey:null,collapsedItems:{},hiddenItems:{},mobileLayout:iu(),stableKeyByPointer:{},pointerByStableKey:{},runCount:1,nodeOutputs:{},promptOutputs:{},followQueue:!1,workflowLoadedAt:Date.now(),connectionHighlightModes:{}}),$n.getState().clearSeedState(),ho.getState().clearCurrentPin(),eo.getState().setCurrentPanel("workflow"),Mo.getState().setViewerState({viewerOpen:!1,viewerImages:[],viewerIndex:0,viewerScale:1,viewerTranslate:{x:0,y:0}})},z=(H,P)=>{sn.getState().setError(null);const D=Xd(H,o().nodeTypes),K=fs(H,Qi(o().hiddenItems,o().pointerByStableKey)),Z=Lo(K,o().stableKeyByPointer,o().pointerByStableKey),q=jo(H,Z.layoutToStable);n({workflow:q,embedWorkflow:R0(q),originalWorkflow:JSON.parse(JSON.stringify(q)),currentFilename:P,currentWorkflowKey:D,mobileLayout:K,stableKeyByPointer:Z.layoutToStable,pointerByStableKey:Z.stableToLayout})},L=H=>{n({nodeTypes:H});const{workflow:P,currentWorkflowKey:D,currentFilename:K,savedWorkflowStates:Z}=o();if(!P)return;const q=Xd(P,H);if(D===q)return;const Ee={...Z};D&&Ee[D]&&!Ee[q]?(Ee[q]=Ee[D],delete Ee[D]):!D&&K&&Ee[K]&&!Ee[q]&&(Ee[q]=Ee[K]);const je=ho.getState(),Ne=K?je.pinnedWidgets[K]:void 0,ee=D?je.pinnedWidgets[D]:void 0;Ne&&!je.pinnedWidgets[q]?je.setPinnedWidget(Ne,q):ee&&!je.pinnedWidgets[q]&&je.setPinnedWidget(ee,q),n({currentWorkflowKey:q,savedWorkflowStates:Ee}),je.restorePinnedWidgetForWorkflow(q,P)},$=()=>{const{workflow:H,currentWorkflowKey:P,savedWorkflowStates:D,collapsedItems:K,hiddenItems:Z}=o(),q=$n.getState().seedModes;if(!H||!P)return;const Ee=D[P]?.bookmarkedItems??[],je={};for(const Ne of H.nodes)je[Ne.id]={mode:Ne.mode,flags:Ne.flags?{collapsed:!!Ne.flags.collapsed}:void 0,widgets_values:Ne.widgets_values};n({savedWorkflowStates:{...D,[P]:{nodes:je,seedModes:{...q},collapsedItems:{...K},hiddenItems:{...Z},bookmarkedItems:[...Ee]}}})},Y=()=>{n({nodeOutputs:{}})},ue=(H,P)=>{!H||P.length===0||n(D=>({promptOutputs:{...D.promptOutputs,[H]:[...D.promptOutputs[H]??[],...P]}}))},pe=H=>{if(!H){n({promptOutputs:{}});return}n(P=>{if(!P.promptOutputs[H])return P;const D={...P.promptOutputs};return delete D[H],{promptOutputs:D}})},fe=H=>{n({runCount:Math.max(1,Math.floor(H))})},Re=H=>{n({followQueue:H})},Ie=()=>{n(H=>({connectionButtonsVisible:!H.connectionButtonsVisible}))},Ae=()=>{n({hiddenItems:{}})},_=(H,P)=>{n(D=>{const K={...D.collapsedItems};return P?K[H]=!0:delete K[H],{collapsedItems:K}})},se=(H,P)=>{const{workflow:D,pointerByStableKey:K}=o();if(!D)return;const Z=Gi(D,H);if(!Z)return;if(Z.type==="group"){const Ne=If(D,Z.groupId,Z.subgraphId);if(Ne.size===0)return;const ee=P?4:0,Me=(D.nodes??[]).map(I=>Ne.has(I.id)?{...I,mode:ee}:I);n({workflow:{...D,nodes:Me}});return}if(Z.type!=="subgraph")return;const q=H0(D,Z.subgraphId);if(q.size===0)return;const Ee=P?4:0,je=(D.nodes??[]).map(Ne=>q.has(Ne.id)?{...Ne,mode:Ee}:Ne);n({workflow:{...D,nodes:je}})},ce=(H,P)=>{const{workflow:D,stableKeyByPointer:K,pointerByStableKey:Z}=o();if(!D)return;const q=Gi(D,H);if(!q)return;if(q.type==="group"){const{hiddenItems:re,connectionHighlightModes:de,mobileLayout:Oe,collapsedItems:Ke}=o(),we=q.groupId,it=q.subgraphId??null,ot=Wi(Oe,we,it),tt=new Set(ot);tt.add(q.stableKey);const lt=tt.size>0?[...tt]:[q.stableKey],pt=P?.deleteNodes??!1?If(D,we,it):new Set;let St=D;if(it){const dn=(D.definitions?.subgraphs??[]).map(pn=>pn.id!==it?pn:{...pn,groups:(pn.groups??[]).filter(Wn=>Wn.id!==we)});St={...D,definitions:{...D.definitions??{},subgraphs:dn}}}else{let It=D.extra;const dn=D.extra?.[qr];if(dn&&typeof dn=="object"){let pn=!1;const Wn={};for(const[Kn,no]of Object.entries(dn))no===we?(Wn[Kn]=null,pn=!0):Wn[Kn]=no;pn&&(It={...D.extra??{},[qr]:Wn})}St={...D,groups:(D.groups??[]).filter(pn=>pn.id!==we),extra:It}}pt.size>0&&(St=V0(St,pt));const yt={...re},ht={...de};for(const It of pt){for(const dn of ps(D,K,It))delete yt[dn];for(const dn of ua(D,It))delete yt[dn];delete ht[It]}let Tt=Oe;for(const It of pt)Tt=T0(Tt,It);for(const It of lt)Tt=Mw(Tt,It);const Et={...Ke};for(const It of lt)delete Et[It],delete yt[It];const Yt=Lo(Tt,K,Z),Gt=jo(St,Yt.layoutToStable);n({workflow:Gt,hiddenItems:yt,connectionHighlightModes:ht,mobileLayout:Tt,stableKeyByPointer:Yt.layoutToStable,pointerByStableKey:Yt.stableToLayout,collapsedItems:Et});return}if(q.type!=="subgraph")return;const{hiddenItems:Ee,connectionHighlightModes:je,mobileLayout:Ne,collapsedItems:ee}=o(),Me=P?.deleteNodes??!1,I=q.subgraphId,B=D.definitions?.subgraphs??[],W=B.find(re=>re.id===I);if(!W)return;const me=rb(Ne,{type:"subgraph",id:I}),ke=me?Fw(me.containerId,Ne):null;if(Me){const re=ab(D),de=yu([I],re),Oe=H0(D,I),Ke={...Ee},we={...je};for(const Et of Oe){for(const Yt of ps(D,K,Et))delete Ke[Yt];for(const Yt of ua(D,Et))delete Ke[Yt];delete we[Et]}const it=B.filter(Et=>!de.has(Et.id));let ot=D.extra;const tt=D.extra?.[qr];if(tt&&typeof tt=="object"){const Et={};for(const[Yt,Gt]of Object.entries(tt))de.has(Yt)||(Et[Yt]=Gt);ot={...D.extra??{},[qr]:Et}}let lt=V0(D,Oe);lt={...lt,definitions:{...lt.definitions??{},subgraphs:it},extra:ot};const wt=fs(lt,Qi(Ke,Z)),pt=Lo(wt,K,Z),St=jo(lt,pt.layoutToStable),yt={...ee},ht={...Ke},Tt=new Set(B.filter(Et=>de.has(Et.id)).map(Et=>Et.stableKey).filter(Et=>typeof Et=="string"));for(const Et of Tt)delete yt[Et],delete ht[Et];n({workflow:St,hiddenItems:ht,connectionHighlightModes:we,mobileLayout:wt,stableKeyByPointer:pt.layoutToStable,pointerByStableKey:pt.stableToLayout,collapsedItems:yt});return}const F=ke==null?D.groups??[]:B.find(re=>re.id===ke)?.groups??[],{idMap:ie,promotedGroups:_e}=qw(W.groups??[],F),$e=(D.nodes??[]).map(re=>{const de=po(re);if(de?.scope!=="subgraph"||de.subgraphId!==I)return re;const Oe={...re.properties??{}};return Oe[Tf]=ke==null?{scope:"root",nodeId:de.nodeId}:{scope:"subgraph",subgraphId:ke,nodeId:de.nodeId},{...re,properties:Oe}}),Ze=B.filter(re=>re.id!==I).map(re=>ke!=null&&re.id===ke?{...re,groups:[...re.groups??[],..._e]}:re);let Ge=D.groups??[];ke==null&&_e.length>0&&(Ge=[...Ge,..._e]);let nt=D.extra;const Ye=D.extra?.[qr];if(Ye&&typeof Ye=="object"){const re={};for(const[de,Oe]of Object.entries(Ye))de!==I&&(re[de]=Oe);nt={...D.extra??{},[qr]:re}}const Fe={...D,nodes:$e,groups:Ge,definitions:{...D.definitions??{},subgraphs:Ze},extra:nt},st=fs(Fe,Qi(Ee,Z)),ft=Lo(st,K,Z),Nt={...ee},Ht={...Ee},Vt=W.stableKey??Pi(D,I);Vt&&(delete Nt[Vt],delete Ht[Vt]);const ye=re=>{const de={};for(const[Oe,Ke]of Object.entries(re)){if(!Ke)continue;const we=Gi(D,Oe);if(we?.type==="group"&&we.subgraphId===I){const it=ie.get(we.groupId);if(it==null)continue;const ot=Wi(st,it,ke);for(const tt of ot)de[tt]=!0;continue}de[Oe]=!0}return de},Q=jo(Fe,ft.layoutToStable);n(()=>({workflow:Q,mobileLayout:st,stableKeyByPointer:ft.layoutToStable,pointerByStableKey:ft.stableToLayout,collapsedItems:ye(Nt),hiddenItems:Ht}))},Ue=(H,P)=>{const{workflow:D,pointerByStableKey:K}=o();if(!D)return;const Z=Gi(D,H);if(!Z)return;const q=P.trim();if(Z.type==="group"){const{groupId:Ee,subgraphId:je}=Z;if(je){const Me=(D.definitions?.subgraphs??[]).map(I=>{if(I.id!==je)return I;const W=(I.groups??[]).map(be=>be.id===Ee?{...be,title:q}:be);return{...I,groups:W}});sn.getState().setError(null),n({workflow:{...D,definitions:{...D.definitions??{},subgraphs:Me}}});return}const Ne=(D.groups??[]).map(ee=>ee.id===Ee?{...ee,title:q}:ee);n({workflow:{...D,groups:Ne}});return}if(Z.type==="subgraph"){const Ee=Z.subgraphId,Ne=(D.definitions?.subgraphs??[]).map(ee=>ee.id===Ee?{...ee,name:q}:ee);n({workflow:{...D,definitions:{...D.definitions??{},subgraphs:Ne}}})}},De=H=>{n({searchQuery:H})},E=H=>{n({searchOpen:H})},A=H=>{n({addNodeModalRequest:{id:++Lw,groupId:H?.groupId??null,subgraphId:H?.subgraphId??null}})},O=()=>{n({addNodeModalRequest:null})},te=H=>{n(P=>{const D=$w(P.mobileLayout,H);if(!D)return{};const K={...P.collapsedItems};for(const Z of D.groupKeys)delete K[Z];for(const Z of D.subgraphIds){const q=P.workflow?Pi(P.workflow,Z):null;q&&delete K[q]}if(H.type==="group")for(const Z of Wi(P.mobileLayout,H.id,H.subgraphId??null))K[Z]=!0;else if(H.type==="subgraph"){const Z=P.workflow?Pi(P.workflow,H.id):null;Z&&(K[Z]=!0)}return{collapsedItems:K}})},Le=(H,P)=>{!H||P<=0||n(D=>{const K=D.workflowDurationStats[H],Z=(K?.count??0)+1,q=K?(K.avgMs*K.count+P)/Z:P;return{workflowDurationStats:{...D.workflowDurationStats,[H]:{avgMs:q,count:Z}}}})},We=()=>{const{currentWorkflowKey:H,savedWorkflowStates:P,originalWorkflow:D,nodeTypes:K}=o(),Z={...P};if(H?(delete Z[H],ho.getState().clearPinnedWidgetForKey(H)):ho.getState().clearCurrentPin(),!D){$n.getState().setSeedModes({}),$n.getState().setSeedLastValues({}),n({savedWorkflowStates:Z});return}const q={};if(K)for(const je of D.nodes)rl(D,K,je)!==null&&(q[je.id]=nf(D,K,je));const Ee=JSON.parse(JSON.stringify(D));$n.getState().setSeedModes(q),$n.getState().setSeedLastValues({}),sn.getState().setError(null),n({savedWorkflowStates:Z,...(()=>{const je=fs(Ee,Qi(o().hiddenItems,o().pointerByStableKey)),Ne=Lo(je,{},{});return{workflow:jo(Ee,Ne.layoutToStable),mobileLayout:je,stableKeyByPointer:Ne.layoutToStable,pointerByStableKey:Ne.stableToLayout}})(),runCount:1,workflowLoadedAt:Date.now()})},xe=()=>{const{workflow:H}=o();if(!H)return;let P=!1;const D=H.nodes.map(K=>{if(K.type==="PrimitiveNode"){if(!Array.isArray(K.widgets_values))return K;const Z=K.outputs?.[0]?.type,q=String(Z).toUpperCase();if(q!=="INT"&&q!=="FLOAT")return K;const Ee=K.widgets_values?.[1];if(!Ee||Ee==="fixed")return K;const je=K.widgets_values?.[0];if(typeof je!="number")return K;let Ne=je;if(Ee==="increment"?Ne=q==="INT"?je+1:je+.01:Ee==="decrement"?Ne=q==="INT"?je-1:je-.01:Ee==="randomize"&&(Ne=q==="INT"?Math.floor(Math.random()*0xffffffffffff):Math.random()),Ne!==je){P=!0;const ee=[...K.widgets_values];return ee[0]=Ne,{...K,widgets_values:ee}}}return K});P&&n({workflow:{...H,nodes:D}})},Se=async H=>{const P=$n.getState(),D=P.seedModes,K=P.seedLastValues,{workflow:Z,nodeTypes:q,embedWorkflow:Ee}=o();if(!Z||!q){sn.getState().setError("Node types are still loading. Try again in a moment.");return}sn.getState().setError(null),n({isLoading:!0});try{let je=Z,Ne=Ee,ee={...K};for(let Me=0;Me<H;Me++){const I={},B=je.nodes.map(F=>{const ie=rl(je,q,F);if(ie===null||!Array.isArray(F.widgets_values))return F;const _e=D[F.id]??nf(je,q,F),$e=ie+1;if(typeof F.widgets_values[$e]=="string"){if(!_e||_e==="fixed")return F;const st=Number(F.widgets_values[ie])||0;let ft;switch(_e){case"randomize":ft=fa(q,F);break;case"increment":ft=st+1;break;case"decrement":ft=st-1;break;default:return F}const Nt=[...F.widgets_values];return Nt[ie]=ft,{...F,widgets_values:Nt}}const nt=Number(F.widgets_values[ie]),Ye=ee[F.id]??null;let Fe=null;return sp(nt)?Fe=aw(nt,Ye,q,F):_e&&_e!=="fixed"&&(_e==="randomize"?Fe=fa(q,F):_e==="increment"?Fe=(typeof Ye=="number"?Ye:nt)+1:_e==="decrement"&&(Fe=(typeof Ye=="number"?Ye:nt)-1)),Fe===null||(I[F.id]=Fe,ee={...ee,[F.id]:Fe}),F});if(je={...je,nodes:B},Ne){let F=Ne;for(const ie of B)F=Xi(F,ie);Ne=F}P.setSeedLastValues(ee),n({workflow:je,embedWorkflow:Ne});const W={},be=new Set,me=new Map;for(const F of je.nodes){if(F.mode===4)continue;let ie=null;if(q[F.type])ie=F.type;else{const _e=Object.entries(q).find(([,$e])=>$e.display_name===F.type||$e.name===F.type);_e&&(ie=_e[0])}ie&&(be.add(F.id),me.set(F.id,ie))}for(const F of je.nodes){if(F.mode===4)continue;const ie=me.get(F.id);if(!ie)continue;const _e=K1(je,q,F,ie,be,Jf(je,F.id),I);W[String(F.id)]={class_type:ie,inputs:_e}}const ke=await fetch(`${nn}/api/prompt`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:W,client_id:Xy,extra_data:{extra_pnginfo:{workflow:gu(Ne??je)}}})});if(!ke.ok){const F=await ke.json(),ie={};if(F.node_errors)for(const[_e,$e]of Object.entries(F.node_errors)){const Ze=$e.errors;Ze&&Ze.length>0&&(ie[_e]=Ze.map(Ge=>({type:Ge.type,message:Ge.message,details:Ge.details,inputName:Ge.extra_info?.input_name})))}throw Object.keys(ie).length>0&&s(ie),new Error(F.error?.message||"Failed to queue prompt")}sn.getState().clearNodeErrors()}}catch(je){sn.getState().setError(je instanceof Error?je.message:"Failed to queue workflow")}finally{Mt.getState().fetchQueue(),n({isLoading:!1})}};return{workflowSource:null,workflow:null,embedWorkflow:null,originalWorkflow:null,currentFilename:null,currentWorkflowKey:null,nodeTypes:null,isLoading:!1,savedWorkflowStates:{},isExecuting:!1,executingNodeId:null,executingPromptId:null,progress:0,executionStartTime:null,currentNodeStartTime:null,nodeDurationStats:{},workflowDurationStats:{},nodeOutputs:{},promptOutputs:{},runCount:1,followQueue:!1,workflowLoadedAt:0,connectionHighlightModes:{},connectionButtonsVisible:!0,searchQuery:"",searchOpen:!1,addNodeModalRequest:null,collapsedItems:{},hiddenItems:{},stableKeyByPointer:{},pointerByStableKey:{},mobileLayout:iu(),setMobileLayout:V,addNode:f,addNodeAndConnect:m,deleteNode:l,deleteContainer:ce,connectNodes:i,disconnectInput:c,setNodeOutput:p,clearNodeOutputs:Y,requestAddNodeModal:A,clearAddNodeModalRequest:O,toggleBypass:j,bypassAllInContainer:se,updateNodeWidget:k,updateNodeWidgets:N,updateNodeTitle:S,updateContainerTitle:Ue,setExecutionState:T,addPromptOutputs:ue,clearPromptOutputs:pe,queueWorkflow:Se,applyControlAfterGenerate:xe,setRunCount:fe,setFollowQueue:Re,cycleConnectionHighlight:g,setConnectionHighlightMode:y,toggleConnectionButtonsVisible:Ie,setSearchQuery:De,setSearchOpen:E,prepareRepositionScrollTarget:te,scrollToNode:C,setItemHidden:x,revealNodeWithParents:w,showAllHiddenNodes:Ae,setItemCollapsed:_,setNodeTypes:L,loadWorkflow:U,unloadWorkflow:R,setSavedWorkflow:z,clearWorkflowCache:We,updateWorkflowDuration:Le,saveCurrentWorkflowState:$}},{name:"workflow-storage",storage:br(()=>localStorage),partialize:n=>({workflow:n.workflow,embedWorkflow:n.embedWorkflow,originalWorkflow:n.originalWorkflow,currentFilename:n.currentFilename,currentWorkflowKey:n.currentWorkflowKey,savedWorkflowStates:n.savedWorkflowStates,runCount:n.runCount,hiddenItems:n.hiddenItems,collapsedItems:n.collapsedItems,stableKeyByPointer:n.stableKeyByPointer,pointerByStableKey:n.pointerByStableKey,connectionButtonsVisible:n.connectionButtonsVisible,mobileLayout:n.mobileLayout,isExecuting:n.isExecuting,executingNodeId:n.executingNodeId,executingPromptId:n.executingPromptId,progress:n.progress,executionStartTime:n.executionStartTime,currentNodeStartTime:n.currentNodeStartTime,nodeDurationStats:n.nodeDurationStats,workflowDurationStats:n.workflowDurationStats}),onRehydrateStorage:()=>n=>{if(n)if(n.workflow){const o=n.mobileLayout?A0(n.mobileLayout):null,s=Jd(n.workflow,n.hiddenItems??{});n.mobileLayout=o&&_w(o,n.workflow)?o:fs(n.workflow,s);const l=Lo(n.mobileLayout,n.stableKeyByPointer??{},n.pointerByStableKey??{});n.workflow=jo(n.workflow,l.layoutToStable),n.originalWorkflow&&(n.originalWorkflow=jo(n.originalWorkflow,l.layoutToStable)),n.stableKeyByPointer=l.layoutToStable,n.pointerByStableKey=l.stableToLayout,n.hiddenItems=Yi(n.hiddenItems,l.layoutToStable,l.stableToLayout),n.collapsedItems=tf(n.collapsedItems,l.layoutToStable,l.stableToLayout),n.hiddenItems=Yi(n.hiddenItems,l.layoutToStable,l.stableToLayout),n.hiddenItems=Yi(n.hiddenItems,l.layoutToStable,l.stableToLayout)}else n.mobileLayout=iu(),n.stableKeyByPointer={},n.pointerByStableKey={}}}));function bu(n){const o=[...n.nodes].sort((s,l)=>s.id-l.id).map(s=>({id:s.id,type:s.type,mode:s.mode,inputs:s.inputs?.map(l=>l.link??null)??[],outputs:s.outputs?.map(l=>l.links??[])??[]}));return JSON.stringify({nodes:o,links:n.links??[]})}const Lf=Oo(n=>({appMenuOpen:!1,setAppMenuOpen:o=>n({appMenuOpen:o})})),qn=Oo((n,o)=>({history:[],isLoading:!1,addHistoryEntry:s=>{n(i=>i.history.some(c=>c.prompt_id===s.prompt_id)?i:{history:[s,...i.history]});const l=Mt.getState();if(l.queueItemExpanded[s.prompt_id]===void 0&&l.setQueueItemExpanded(s.prompt_id,!0),s.workflow&&s.durationSeconds){const i=bu(s.workflow);ae.getState().updateWorkflowDuration(i,s.durationSeconds*1e3)}},fetchHistory:async()=>{n({isLoading:!0});try{const s=await F1(50),l=Object.entries(s).map(([c,f])=>{const m=[];for(const j of Object.values(f.outputs))j.images&&m.push(...j.images),j.gifs&&m.push(...j.gifs),j.videos&&m.push(...j.videos);let p=Date.now(),g=null,y=null,x=!1;if(f.status?.messages)for(const[j,C]of f.status.messages)j==="execution_start"&&C.timestamp&&(p=C.timestamp,g=C.timestamp),(j==="execution_end"||j==="execution_success")&&C.timestamp&&(y=C.timestamp),j==="execution_error"&&(x=!0);g===null&&p&&(g=p);const w=g!==null&&y!==null&&y>=g?(y-g)/1e3:void 0,k=f.status?.status_str?.toLowerCase()||"",N=!x&&f.status?.completed!==!1&&!k.includes("error"),S=f.prompt?.[3]?.extra_pnginfo?.workflow;return{prompt_id:c,timestamp:p,durationSeconds:w,success:N,outputs:{images:m},prompt:f.prompt[2],workflow:S}});l.sort((c,f)=>f.timestamp-c.timestamp),n({history:l});const i=Mt.getState();for(const c of l)if(i.queueItemExpanded[c.prompt_id]===void 0&&i.setQueueItemExpanded(c.prompt_id,!0),c.workflow&&c.durationSeconds){const f=bu(c.workflow);ae.getState().updateWorkflowDuration(f,c.durationSeconds*1e3)}}catch(s){console.error("Failed to fetch history:",s)}finally{n({isLoading:!1})}},deleteItem:async s=>{try{await Q1(s),n(l=>({history:l.history.filter(i=>i.prompt_id!==s)}))}catch(l){console.error("Failed to delete history item:",l)}},clearHistory:async()=>{try{await X1()}catch(s){console.error("Failed to clear history:",s);try{const l=o().history.map(i=>i.prompt_id);await S0(l)}catch(l){console.error("Failed to delete history items:",l)}}finally{n({history:[]})}},clearEmptyItems:async()=>{const s=o().history.filter(l=>l.outputs.images.length===0).map(l=>l.prompt_id);if(s.length!==0)try{await S0(s),n(l=>({history:l.history.filter(i=>!s.includes(i.prompt_id))}))}catch(l){console.error("Failed to delete empty history items:",l)}}})),$t=Oo()(xr((n,o)=>({source:"output",currentFolder:null,folders:[],files:[],isLoading:!1,error:null,viewMode:"grid",showHidden:!1,filter:{search:"",favoritesOnly:!1,type:"all"},sort:{mode:"modified"},favorites:[],selectionMode:!1,selectedIds:[],selectionActionOpen:!1,filterModalOpen:!1,newFolderModalOpen:!1,outputsViewerOpen:!1,setSource:s=>{n({source:s,currentFolder:null,files:[],folders:[],selectionMode:!1,selectedIds:[]}),o().fetchFolders(),o().fetchFiles()},setCurrentFolder:s=>{const{currentFolder:l}=o(),i=l?`${l}/${s}`:s;n({currentFolder:i,files:[],selectionMode:!1,selectedIds:[]}),o().fetchFiles()},navigateToPath:s=>{n({currentFolder:s,files:[],selectionMode:!1,selectedIds:[]}),o().fetchFiles()},navigateUp:()=>{const{currentFolder:s}=o();if(!s)return;const l=s.split("/");l.pop();const i=l.length>0?l.join("/"):null;n({currentFolder:i,files:[],selectionMode:!1,selectedIds:[]}),o().fetchFiles()},fetchFolders:async()=>{try{const{showHidden:s}=o(),l=await J1(s),{source:i}=o();n({folders:i==="output"?l.output:l.input})}catch(s){console.error("Failed to fetch folders:",s)}},fetchFiles:async()=>{const{source:s,currentFolder:l,sort:i,showHidden:c}=o();n({isLoading:!0,error:null});try{const f=await Mf(s,1e3,0,i.mode,!1,l,c);n({files:f,isLoading:!1})}catch(f){n({error:f.message,isLoading:!1})}},setFilter:s=>{n(l=>({filter:{...l.filter,...s}}))},setSort:s=>{n({sort:s}),o().fetchFiles()},setViewMode:s=>{n({viewMode:s})},toggleShowHidden:()=>{n(s=>({showHidden:!s.showHidden})),o().fetchFolders(),o().fetchFiles()},toggleFavorite:s=>{n(l=>({favorites:l.favorites.includes(s)?l.favorites.filter(c=>c!==s):[...l.favorites,s]}))},toggleSelectionMode:()=>{n(s=>({selectionMode:!s.selectionMode,selectedIds:[],selectionActionOpen:!1}))},toggleSelection:s=>{n(l=>({selectedIds:l.selectedIds.includes(s)?l.selectedIds.filter(c=>c!==s):[...l.selectedIds,s]}))},selectAll:()=>{const s=o().getDisplayedFiles();n({selectedIds:s.map(l=>l.id)})},selectIds:(s,l="add")=>{n(i=>{if(l==="replace")return{selectedIds:[...s]};const c=new Set(i.selectedIds);return s.forEach(f=>c.add(f)),{selectedIds:Array.from(c)}})},clearSelection:()=>{n({selectedIds:[],selectionActionOpen:!1})},setSelectionActionOpen:s=>{n({selectionActionOpen:s})},setFilterModalOpen:s=>{n({filterModalOpen:s})},setNewFolderModalOpen:s=>{n({newFolderModalOpen:s})},setOutputsViewerOpen:s=>{n({outputsViewerOpen:s})},addFavorites:s=>{n(l=>{const i=new Set(l.favorites);return s.forEach(c=>i.add(c)),{favorites:Array.from(i)}})},removeFavorites:s=>{n(l=>({favorites:l.favorites.filter(i=>!s.includes(i))}))},refresh:()=>{o().fetchFolders(),o().fetchFiles()},getDisplayedFiles:()=>{const{files:s,filter:l,favorites:i,showHidden:c,sort:f}=o();let m=[...s];if(c||(m=m.filter(g=>!g.name.startsWith("."))),l.search){const g=l.search.toLowerCase();m=m.filter(y=>y.name.toLowerCase().includes(g))}l.favoritesOnly&&(m=m.filter(g=>i.includes(g.id))),l.type!=="all"&&(m=m.filter(g=>g.type==="folder"||g.type===l.type));const p=f.mode.endsWith("-reverse")?-1:1;return f.mode.startsWith("name")?m.sort((g,y)=>g.name.localeCompare(y.name)*p):f.mode.startsWith("size")?m.sort((g,y)=>((g.size??0)-(y.size??0))*p):m.sort((g,y)=>((g.date??0)-(y.date??0))*p),m}}),{name:"outputs-storage",version:1,migrate:(n,o)=>{if(o===0){if(n.sort&&!n.sort.mode){const{field:s,order:l}=n.sort;s==="name"?n.sort={mode:l==="asc"?"name":"name-reverse"}:n.sort={mode:l==="desc"?"modified":"modified-reverse"}}n.filter&&!n.filter.type&&(n.filter.type="all")}return n},partialize:n=>({source:n.source,viewMode:n.viewMode,showHidden:n.showHidden,sort:n.sort,filter:n.filter,favorites:n.favorites})}));var Mn=Py();function Yw({open:n,onClose:o,side:s,title:l,children:i}){const c=b.useRef(null);return b.useEffect(()=>{if(!n)return;const f=m=>{m.key==="Escape"&&o()};return document.addEventListener("keydown",f),()=>document.removeEventListener("keydown",f)},[n,o]),b.useEffect(()=>(n?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[n]),n?Mn.createPortal(u.jsxs("div",{className:"fixed inset-0 z-[2300]",children:[u.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm",onClick:o}),u.jsxs("div",{ref:c,className:`
          absolute top-0 bottom-0 w-[85%] max-w-sm bg-white shadow-xl
          flex flex-col overflow-hidden
          ${s==="left"?"left-0 animate-slide-in-left":"right-0 animate-slide-in-right"}
        `,style:{animation:`${s==="left"?"slideInLeft":"slideInRight"} 0.2s ease-out`},children:[l&&u.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[u.jsx("h2",{className:"text-xl font-bold text-gray-900",children:l}),u.jsx("button",{onClick:o,className:`w-10 h-10 flex items-center justify-center rounded-full
                         text-gray-500 hover:bg-gray-100 text-2xl`,children:""})]}),u.jsx("div",{className:"flex-1 overflow-auto p-4 overscroll-contain scroll-container",children:i})]}),u.jsx("style",{children:`
        @keyframes slideInLeft {
          from { transform: translateX(-100%); }
          to { transform: translateX(0); }
        }
        @keyframes slideInRight {
          from { transform: translateX(100%); }
          to { transform: translateX(0); }
        }
      `})]}),document.body):null}function Qw(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",...n,children:u.jsx("path",{d:"M12 11V16M12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12C21 16.9706 16.9706 21 12 21ZM12.0498 8V8.1L11.9502 8.1002V8H12.0498Z"})})}function ib({className:n}){return u.jsx(Qw,{className:n})}function Xw(n){return u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",...n,children:[u.jsx("path",{d:"M19 4H5L10.5 10.5V17L13.5 19V10.5L19 4Z"}),u.jsx("path",{d:"M2.5 9L4.5 7L6.5 9"}),u.jsx("path",{d:"M4.5 7V17"}),u.jsx("path",{d:"M2.5 15L4.5 17L6.5 15"})]})}function Zw(n){return u.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...n,children:[u.jsx("path",{d:"M6 4h9l3 3v13a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2Z",stroke:"currentColor",strokeWidth:"1.5",fill:"none"}),u.jsx("path",{d:"M9 10h6M9 14h6",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]})}function Jw(n){return u.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...n,children:[u.jsx("path",{d:"M6 4h9l3 3v13a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2Z",stroke:"currentColor",strokeWidth:"1.5",fill:"none"}),u.jsx("path",{d:"M9 10h6M9 14h6M9 18h4",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]})}function e2(n){return u.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...n,children:u.jsx("path",{d:"M4 20h16M6 16l4-4m0 0l4-4m-4 4l4 4",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none"})})}function t2(n){return u.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...n,children:[u.jsx("path",{d:"M3 7h18v10a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V7Z",stroke:"currentColor",strokeWidth:"1.5",fill:"none"}),u.jsx("path",{d:"M3 7l9 6 9-6",stroke:"currentColor",strokeWidth:"1.5",fill:"none"})]})}function n2(n){return u.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...n,style:{transform:"rotate(90deg)",...n.style??{}},children:[u.jsx("circle",{cx:"12",cy:"5",r:"2",fill:"currentColor"}),u.jsx("circle",{cx:"12",cy:"12",r:"2",fill:"currentColor"}),u.jsx("circle",{cx:"12",cy:"19",r:"2",fill:"currentColor"})]})}function gs(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",...n,children:u.jsx("path",{d:"M10 17l5-5-5-5v10z"})})}function Jn(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",...n,children:u.jsx("path",{d:"M7 10l5 5 5-5H7z"})})}function xu(n){return u.jsx("svg",{viewBox:"0 0 20 20","aria-hidden":"true",...n,children:u.jsx("g",{transform:"translate(-164 -6319)",fill:"currentColor",children:u.jsx("path",{d:"M170.673,6324.726 L170.669,6324.729 C170.266,6325.104 170.244,6325.735 170.62,6326.137 L171.577,6327.158 C171.876,6327.478 171.649,6328 171.212,6328 L165,6328 C164.447,6328 164,6328.448 164,6329 C164,6329.552 164.447,6330 165,6330 L171.197,6330 C171.637,6330 171.862,6330.527 171.558,6330.845 L170.63,6331.819 C170.248,6332.218 170.266,6332.852 170.669,6333.229 C171.068,6333.603 171.695,6333.584 172.071,6333.186 L174.76,6330.338 C175.49,6329.564 175.487,6328.354 174.753,6327.585 L172.067,6324.769 C171.692,6324.376 171.071,6324.357 170.673,6324.726 M182.222,6319 L175.777,6319 C174.8,6319 174,6319.68 174,6321.111 L174,6322.007 C174,6322.555 174.444,6323 174.993,6323 L175.006,6323 C175.555,6323 176,6322.555 176,6322.007 L176,6321.993 C176,6321.445 176.444,6321 176.993,6321 L181.006,6321 C181.555,6321 182,6321.445 182,6321.993 L182,6336.007 C182,6336.555 181.555,6337 181.006,6337 L176.993,6337 C176.444,6337 176,6336.555 176,6336.007 L176,6335.993 C176,6335.445 175.555,6335 175.006,6335 L174.993,6335 C174.444,6335 174,6335.445 174,6335.993 L174,6337.111 C174,6338.293 174.847,6339 175.777,6339 L182.222,6339 C183.204,6339 184,6338.204 184,6337.222 L184,6337.111 L184,6320.778 C184,6319.796 183.204,6319 182.222,6319"})})})}function cp(n){return u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",...n,children:[u.jsx("path",{d:"M18.4101 3.6512L20.5315 5.77252C21.4101 6.6512 21.4101 8.07582 20.5315 8.9545L9.54019 19.9458C9.17774 20.3082 8.70239 20.536 8.19281 20.5915L4.57509 20.9856C3.78097 21.072 3.11061 20.4017 3.1971 19.6076L3.59111 15.9898C3.64661 15.4803 3.87444 15.0049 4.23689 14.6425L15.2282 3.6512C16.1068 2.77252 17.5315 2.77252 18.4101 3.6512Z",stroke:"currentColor",strokeWidth:"1.5"}),u.jsx("path",{d:"M15.2282 3.6512C16.1068 2.77252 17.5315 2.77252 18.4101 3.6512L20.5315 5.77252C21.4101 6.6512 21.4101 8.07582 20.5315 8.9545L18.7283 10.7576L13.425 5.45432L15.2282 3.6512Z",stroke:"currentColor",strokeWidth:"1.5"})]})}function Na(n){return u.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...n,children:u.jsx("path",{d:"M6 6l12 12M18 6l-12 12",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round"})})}function Do(n){return u.jsx("svg",{viewBox:"0 0 16 16","aria-hidden":"true",...n,children:u.jsx("path",{d:"M6.4 11.2L3.2 8l1.1-1.1 2.1 2.1 5-5L12.5 5l-6.1 6.2Z",fill:"currentColor"})})}function o2(n){return u.jsx("svg",{viewBox:"0 0 16 16","aria-hidden":"true",...n,children:u.jsx("path",{d:"M4.2 4.2l7.6 7.6m0-7.6l-7.6 7.6",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"})})}function r2(n){return u.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...n,children:[u.jsx("path",{d:"M7 18a4 4 0 0 1 0-8 6 6 0 0 1 11.3-2.2A4.5 4.5 0 0 1 18 18H7Z",fill:"none",stroke:"currentColor",strokeWidth:"1.5"}),u.jsx("path",{d:"M12 10v7m0 0l-3-3m3 3l3-3",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]})}function pr(n){return u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2","aria-hidden":"true",...n,children:[u.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),u.jsx("circle",{cx:"12",cy:"12",r:"3"})]})}function Go(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2","aria-hidden":"true",...n,children:u.jsx("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24M1 1l22 22"})})}function Bo(n){return u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2","aria-hidden":"true",...n,children:[u.jsx("path",{d:"M3 6h18M8 6V4h8v2M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),u.jsx("path",{d:"M10 11v6M14 11v6"})]})}function s2(n){return u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2","aria-hidden":"true",...n,children:[u.jsx("circle",{cx:"12",cy:"12",r:"10"}),u.jsx("path",{d:"M15 9l-6 6M9 9l6 6"})]})}function dp(n){return u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2","aria-hidden":"true",...n,children:[u.jsx("path",{d:"M23 4v6h-6M1 20v-6h6"}),u.jsx("path",{d:"M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"})]})}function l2(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2","aria-hidden":"true",...n,children:u.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4M16 17l5-5-5-5M21 12H9"})})}function bs(n){return u.jsx("svg",{viewBox:"0 0 16 16",fill:"none","aria-hidden":"true",...n,children:u.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeWidth:"1.3",d:"M9.18613 3.09999H6.81377M9.18613 12.9H7.55288c-3.08678 0-5.35171-2.99581-4.60305-6.08843l.3054-1.26158M14.7486 2.1721l-.5931 2.45c-.132.54533-.6065.92789-1.1508.92789h-2.2993c-.77173 0-1.33797-.74895-1.1508-1.5221l.5931-2.45c.132-.54533.6065-.9279 1.1508-.9279h2.2993c.7717 0 1.3379.74896 1.1508 1.52211Zm-8.3033 0-.59309 2.45c-.13201.54533-.60646.92789-1.15076.92789H2.4021c-.7717 0-1.33793-.74895-1.15077-1.5221l.59309-2.45c.13201-.54533.60647-.9279 1.15077-.9279h2.29935c.77169 0 1.33792.74896 1.15076 1.52211Zm8.3033 9.8-.5931 2.45c-.132.5453-.6065.9279-1.1508.9279h-2.2993c-.77173 0-1.33797-.749-1.1508-1.5221l.5931-2.45c.132-.5453.6065-.9279 1.1508-.9279h2.2993c.7717 0 1.3379.7489 1.1508 1.5221Z"})})}function ub(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",...n,children:u.jsx("path",{d:"M13 20.74C12.9039 20.7541 12.8062 20.7541 12.71 20.74C12.5724 20.6823 12.4551 20.5849 12.3732 20.4602C12.2912 20.3355 12.2484 20.1892 12.25 20.04V16.7H3.00001C2.81189 16.6956 2.63208 16.6216 2.49538 16.4923C2.35868 16.363 2.27481 16.1876 2.26001 16V8.00002C2.25463 7.89856 2.26965 7.79706 2.30417 7.7015C2.3387 7.60595 2.39204 7.51829 2.46103 7.44371C2.53002 7.36913 2.61326 7.30913 2.70584 7.26727C2.79841 7.22542 2.89844 7.20255 3.00001 7.20002H12.25V4.01002C12.2498 3.86106 12.2946 3.71551 12.3784 3.59241C12.4623 3.4693 12.5813 3.37436 12.72 3.32002C12.8551 3.26039 13.0053 3.24376 13.1502 3.27238C13.2951 3.301 13.4277 3.37349 13.53 3.48002L21.53 11.48C21.6705 11.6206 21.7493 11.8113 21.7493 12.01C21.7493 12.2088 21.6705 12.3994 21.53 12.54L13.53 20.54C13.4601 20.6079 13.377 20.6608 13.2858 20.6952C13.1946 20.7296 13.0973 20.7448 13 20.74ZM3.76001 15.2H13C13.1981 15.2026 13.3874 15.2825 13.5275 15.4226C13.6676 15.5626 13.7474 15.7519 13.75 15.95V18.18L19.93 12L13.75 5.83002V8.00002C13.7477 8.19843 13.6689 8.3883 13.53 8.53002C13.3817 8.65257 13.1919 8.71343 13 8.70002H3.76001V15.2Z",fill:"currentColor"})})}function a2(n){return u.jsxs("svg",{viewBox:"0 0 16 16",fill:"none","aria-hidden":"true",...n,children:[u.jsx("path",{d:"M10.667 2.667c1.45.008 2.235.072 2.748.585C14 3.837 14 4.78 14 6.666v4c0 1.885 0 2.828-.585 3.414-.586.585-1.529.585-3.415.585H6c-1.886 0-2.829 0-3.414-.585C2 13.494 2 12.55 2 10.666v-4c0-1.886 0-2.829.586-3.414.512-.513 1.297-.577 2.747-.585",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round"}),u.jsx("path",{d:"M5.333 2.333c0-.552.448-1 1-1h3.334c.552 0 1 .448 1 1v.667c0 .553-.448 1-1 1H6.333c-.552 0-1-.447-1-1v-.667Z",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round"})]})}function i2(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2","aria-hidden":"true",...n,children:u.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M7 10l5 5 5-5M12 15V3"})})}function u2(n){return u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",...n,children:[u.jsx("rect",{x:"9",y:"9",width:"10",height:"12",rx:"2"}),u.jsx("path",{d:"M5 15V5a2 2 0 0 1 2-2h8"})]})}function c2(n){return u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",...n,children:[u.jsx("circle",{cx:"12",cy:"12",r:"9"}),u.jsx("path",{d:"M7 12h10"})]})}function vu(n){return u.jsx("svg",{viewBox:"0 0 20 20",fill:"none","aria-hidden":"true",...n,children:u.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M6 8l4 4 4-4"})})}function Gr(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"currentColor",strokeWidth:"2","aria-hidden":"true",...n,children:u.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})})}function cb({showSlash:n=!1,...o}){return u.jsxs("svg",{viewBox:"0 0 32 32","aria-hidden":"true",overflow:"visible",...o,children:[u.jsx("path",{d:"M28 28H4a2.002 2.002 0 0 1-2-2V21h2v5h24v-5h2v5a2.002 2.002 0 0 1-2 2Z",fill:"currentColor"}),u.jsx("rect",{x:"7",y:"21",width:"18",height:"2",fill:"currentColor"}),u.jsx("rect",{x:"7",y:"16",width:"18",height:"2",fill:"currentColor"}),u.jsx("rect",{x:"7",y:"11",width:"18",height:"2",fill:"currentColor"}),u.jsx("rect",{x:"7",y:"6",width:"18",height:"2",fill:"currentColor"}),u.jsx("path",{d:"M16 -3l5 4H11l5-4Z",fill:"currentColor"}),n&&u.jsx("line",{x1:"2",y1:"30",x2:"28",y2:"4",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round"})]})}const kt={transparent:"transparent",transparentBlack:"rgba(0, 0, 0, 0)",surface:{white:"#ffffff",darkPanel:"#151a23",gray100:"#f3f4f6",gray200:"#e5e7eb"},text:{primary:"#111827",secondary:"#6b7280",onDark:"#e5e7eb"},border:{gray200:"#e5e7eb",focusBlue:"#3b82f6"},status:{success:"#22c55e",successStrong:"rgba(34,197,94,0.9)",warning:"#facc15",danger:"#f97316"},brand:{blue500:"#3b82f6",subgraphBackground08:"rgba(59, 130, 246, 0.08)",subgraphBackground10:"rgba(59, 130, 246, 0.10)",subgraphBackground14:"rgba(59, 130, 246, 0.14)",subgraphBorder20:"rgba(59, 130, 246, 0.20)",subgraphBorder25:"rgba(59, 130, 246, 0.25)"},workflow:{defaultGroupDot:"#9ca3af",fastGroupBypassColors:{nocolor:"#353535",red:"#553333",brown:"#593930",green:"#335533",blue:"#333355",pale_blue:"#3f5159",cyan:"#335555",purple:"#553355",yellow:"#665533",black:"#000000"}}};function d2({progress:n,radius:o=11,...s}){const l=Math.min(100,Math.max(0,n)),i=2*Math.PI*o,c=i*(1-l/100);return u.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...s,children:u.jsx("circle",{cx:"12",cy:"12",r:o,fill:"none",stroke:kt.status.successStrong,strokeWidth:"2",strokeLinecap:"round",strokeDasharray:i,strokeDashoffset:c})})}function fp(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","aria-hidden":"true",...n,children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}function zo(n){return u.jsx("svg",{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",...n,children:u.jsx("path",{fillRule:"evenodd",d:"M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z",clipRule:"evenodd"})})}function f2(n){return u.jsx("svg",{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",...n,children:u.jsx("path",{fillRule:"evenodd",d:"M4 10a1 1 0 011-1h10a1 1 0 110 2H5a1 1 0 01-1-1z",clipRule:"evenodd"})})}function db(n){return u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",...n,children:[u.jsx("circle",{cx:"11",cy:"11",r:"7"}),u.jsx("path",{d:"M20 20l-3.5-3.5"})]})}function p2(n){return u.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...n,children:[u.jsx("rect",{x:"4",y:"4",width:"16",height:"16",rx:"3",stroke:"currentColor",strokeWidth:"1.5",fill:"none"}),u.jsx("circle",{cx:"9",cy:"9",r:"1.5",fill:"currentColor"}),u.jsx("circle",{cx:"15",cy:"15",r:"1.5",fill:"currentColor"}),u.jsx("circle",{cx:"15",cy:"9",r:"1.5",fill:"currentColor"}),u.jsx("circle",{cx:"9",cy:"15",r:"1.5",fill:"currentColor"}),u.jsx("circle",{cx:"12",cy:"12",r:"1.5",fill:"currentColor"})]})}function fb(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","aria-hidden":"true",...n,children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}function pb(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",...n,children:u.jsx("path",{d:"M12 2L1 21h22L12 2zm0 3.5L19.5 19h-15L12 5.5zM11 10v4h2v-4h-2zm0 6v2h2v-2h-2z"})})}function _u(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2","aria-hidden":"true",...n,children:u.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})})}function K0(n){return u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",...n,children:[u.jsx("rect",{x:"3",y:"7",width:"12",height:"10",rx:"2"}),u.jsx("path",{d:"M15 10l5-3v10l-5-3z"})]})}function ya(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",...n,children:u.jsx("path",{d:"M19.1835 7.80516L16.2188 4.83755C14.1921 2.8089 13.1788 1.79457 12.0904 2.03468C11.0021 2.2748 10.5086 3.62155 9.5217 6.31506L8.85373 8.1381C8.59063 8.85617 8.45908 9.2152 8.22239 9.49292C8.11619 9.61754 7.99536 9.72887 7.86251 9.82451C7.56644 10.0377 7.19811 10.1392 6.46145 10.3423C4.80107 10.8 3.97088 11.0289 3.65804 11.5721C3.5228 11.8069 3.45242 12.0735 3.45413 12.3446C3.45809 12.9715 4.06698 13.581 5.28476 14.8L6.69935 16.2163L2.22345 20.6964C1.92552 20.9946 1.92552 21.4782 2.22345 21.7764C2.52138 22.0746 3.00443 22.0746 3.30236 21.7764L7.77841 17.2961L9.24441 18.7635C10.4699 19.9902 11.0827 20.6036 11.7134 20.6045C11.9792 20.6049 12.2404 20.5358 12.4713 20.4041C13.0192 20.0914 13.2493 19.2551 13.7095 17.5825C13.9119 16.8472 14.013 16.4795 14.2254 16.1835C14.3184 16.054 14.4262 15.9358 14.5468 15.8314C14.8221 15.593 15.1788 15.459 15.8922 15.191L17.7362 14.4981C20.4 13.4973 21.7319 12.9969 21.9667 11.9115C22.2014 10.826 21.1954 9.81905 19.1835 7.80516Z"})})}function Af(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",...n,children:u.jsx("path",{d:"M15.9894 4.9502L16.52 4.42014L15.9894 4.9502ZM19.0716 8.03562L18.541 8.56568L19.0716 8.03562ZM8.73837 19.429L8.20777 19.9591L8.73837 19.429ZM4.62169 15.3081L5.15229 14.7781L4.62169 15.3081ZM17.5669 14.9943L17.3032 14.2922L17.5669 14.9943ZM15.6498 15.7146L15.9136 16.4167H15.9136L15.6498 15.7146ZM8.3322 8.38177L7.62798 8.12375L8.3322 8.38177ZM9.02665 6.48636L9.73087 6.74438V6.74438L9.02665 6.48636ZM5.84504 10.6735L6.04438 11.3965L5.84504 10.6735ZM7.30167 10.1351L6.86346 9.52646L6.86346 9.52646L7.30167 10.1351ZM7.67582 9.79038L8.24665 10.2768H8.24665L7.67582 9.79038ZM14.251 16.3805L14.742 16.9475L14.742 16.9475L14.251 16.3805ZM13.3806 18.2012L12.6574 18.0022V18.0022L13.3806 18.2012ZM13.9169 16.7466L13.3075 16.3094L13.3075 16.3094L13.9169 16.7466ZM2.71846 12.7552L1.96848 12.76L1.96848 12.76L2.71846 12.7552ZM2.93045 11.9521L2.28053 11.5778H2.28053L2.93045 11.9521ZM11.3052 21.3431L11.3064 20.5931H11.3064L11.3052 21.3431ZM12.0933 21.1347L11.7215 20.4833L11.7215 20.4833L12.0933 21.1347ZM11.6973 2.03606L11.8588 2.76845L11.6973 2.03606ZM1.4694 21.4699C1.17666 21.763 1.1769 22.2379 1.46994 22.5306C1.76298 22.8233 2.23786 22.8231 2.5306 22.5301L1.4694 21.4699ZM7.18383 17.8721C7.47657 17.5791 7.47633 17.1042 7.18329 16.8114C6.89024 16.5187 6.41537 16.5189 6.12263 16.812L7.18383 17.8721ZM15.4588 5.48026L18.541 8.56568L19.6022 7.50556L16.52 4.42014L15.4588 5.48026ZM9.26897 18.8989L5.15229 14.7781L4.09109 15.8382L8.20777 19.9591L9.26897 18.8989ZM17.3032 14.2922L15.386 15.0125L15.9136 16.4167L17.8307 15.6964L17.3032 14.2922ZM9.03642 8.63979L9.73087 6.74438L8.32243 6.22834L7.62798 8.12375L9.03642 8.63979ZM6.04438 11.3965C6.75583 11.2003 7.29719 11.0625 7.73987 10.7438L6.86346 9.52646C6.69053 9.65097 6.46601 9.72428 5.6457 9.95044L6.04438 11.3965ZM7.62798 8.12375C7.33502 8.92332 7.24338 9.14153 7.10499 9.30391L8.24665 10.2768C8.60041 9.86175 8.7823 9.33337 9.03642 8.63979L7.62798 8.12375ZM7.73987 10.7438C7.92696 10.6091 8.09712 10.4523 8.24665 10.2768L7.10499 9.30391C7.0337 9.38757 6.9526 9.46229 6.86346 9.52646L7.73987 10.7438ZM15.386 15.0125C14.697 15.2714 14.1716 15.4571 13.76 15.8135L14.742 16.9475C14.9028 16.8082 15.1192 16.7152 15.9136 16.4167L15.386 15.0125ZM14.1037 18.4001C14.329 17.5813 14.4021 17.3569 14.5263 17.1838L13.3075 16.3094C12.9902 16.7517 12.8529 17.2919 12.6574 18.0022L14.1037 18.4001ZM13.76 15.8135C13.5903 15.9605 13.4384 16.1269 13.3075 16.3094L14.5263 17.1838C14.5887 17.0968 14.6611 17.0175 14.742 16.9475L13.76 15.8135ZM5.15229 14.7781C4.50615 14.1313 4.06799 13.691 3.78366 13.3338C3.49835 12.9753 3.46889 12.8201 3.46845 12.7505L1.96848 12.76C1.97215 13.3422 2.26127 13.8297 2.61002 14.2679C2.95976 14.7073 3.47115 15.2176 4.09109 15.8382L5.15229 14.7781ZM5.6457 9.95044C4.80048 10.1835 4.10396 10.3743 3.58296 10.5835C3.06341 10.792 2.57116 11.0732 2.28053 11.5778L3.58038 12.3264C3.615 12.2663 3.71693 12.146 4.1418 11.9755C4.56523 11.8055 5.16337 11.6394 6.04438 11.3965L5.6457 9.95044ZM3.46845 12.7505C3.46751 12.6016 3.50616 12.4553 3.58038 12.3264L2.28053 11.5778C2.07354 11.9372 1.96586 12.3452 1.96848 12.76L3.46845 12.7505ZM8.20777 19.9591C8.83164 20.5836 9.34464 21.0987 9.78647 21.4506C10.227 21.8015 10.7179 22.0922 11.3041 22.0931L11.3064 20.5931C11.2369 20.593 11.0814 20.5644 10.721 20.2773C10.3618 19.9912 9.91923 19.5499 9.26897 18.8989L8.20777 19.9591ZM12.6574 18.0022C12.4133 18.8897 12.2462 19.4924 12.0751 19.9188C11.9033 20.3467 11.7821 20.4487 11.7215 20.4833L12.465 21.7861C12.974 21.4956 13.2573 21.0004 13.4671 20.4775C13.6776 19.9532 13.8694 19.2516 14.1037 18.4001L12.6574 18.0022ZM11.3041 22.0931C11.7112 22.0937 12.1114 21.9879 12.465 21.7861L11.7215 20.4833C11.595 20.5555 11.4519 20.5933 11.3064 20.5931L11.3041 22.0931ZM18.541 8.56568C19.6045 9.63022 20.3403 10.3695 20.7917 10.9788C21.2353 11.5774 21.2863 11.8959 21.2321 12.1464L22.6982 12.4634C22.8881 11.5854 22.5382 10.8162 21.9969 10.0857C21.4635 9.36592 20.6305 8.53486 19.6022 7.50556L18.541 8.56568ZM17.8307 15.6964C19.1921 15.1849 20.294 14.773 21.0771 14.3384C21.8718 13.8973 22.5083 13.3416 22.6982 12.4634L21.2321 12.1464C21.178 12.3968 21.0001 12.6655 20.3491 13.0268C19.6865 13.3946 18.7112 13.7632 17.3032 14.2922L17.8307 15.6964ZM16.52 4.42014C15.4841 3.3832 14.6481 2.54353 13.9246 2.00638C13.1908 1.46165 12.4175 1.10912 11.5357 1.30367L11.8588 2.76845C12.1086 2.71335 12.4277 2.7633 13.0304 3.21075C13.6433 3.66579 14.3876 4.40801 15.4588 5.48026L16.52 4.42014ZM9.73087 6.74438C10.2525 5.32075 10.6161 4.33403 10.9812 3.66315C11.3402 3.00338 11.609 2.82357 11.8588 2.76845L11.5357 1.30367C10.654 1.49819 10.1005 2.14332 9.66362 2.94618C9.23278 3.73793 8.82688 4.85154 8.32243 6.22834L9.73087 6.74438ZM2.5306 22.5301L7.18383 17.8721L6.12263 16.812L1.4694 21.4699L2.5306 22.5301Z"})})}function pp(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2","aria-hidden":"true",...n,children:u.jsx("path",{d:"M9 6l6 6-6 6"})})}function h2(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",...n,children:u.jsx("path",{d:"M15 19l-7-7 7-7"})})}function Rf({isBypassed:n,...o}){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2","aria-hidden":"true",...o,children:n?u.jsxs(u.Fragment,{children:[u.jsx("path",{d:"M5 12h14"}),u.jsx("path",{d:"M12 5l7 7-7 7"})]}):u.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})}function hb({nodeId:n,connectionHighlightMode:o,leftLineCount:s,rightLineCount:l,inactiveColor:i=kt.text.secondary,inputHighlightColor:c=kt.status.danger,outputHighlightColor:f=kt.status.danger,offLineColor:m=i,...p}){const g=o==="inputs"||o==="both",y=o==="outputs"||o==="both",x=g?c:m,w=y?f:m;return u.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...p,children:[u.jsxs("defs",{children:[u.jsx("clipPath",{id:`node-rect-left-${n}`,children:u.jsx("rect",{x:"0",y:"0",width:"12",height:"24"})}),u.jsx("clipPath",{id:`node-rect-right-${n}`,children:u.jsx("rect",{x:"12",y:"0",width:"12",height:"24"})})]}),u.jsxs(u.Fragment,{children:[u.jsx("rect",{x:"7",y:"7",width:"10",height:"10",rx:"2",stroke:x,strokeWidth:"1.6",fill:"none",strokeLinejoin:"round",clipPath:`url(#node-rect-left-${n})`}),u.jsx("rect",{x:"7",y:"7",width:"10",height:"10",rx:"2",stroke:w,strokeWidth:"1.6",fill:"none",strokeLinejoin:"round",clipPath:`url(#node-rect-right-${n})`})]}),u.jsxs("g",{style:{color:x},children:[s===1&&u.jsx("line",{x1:"7",y1:"12",x2:"-4.25",y2:"12",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"}),s===2&&u.jsxs(u.Fragment,{children:[u.jsx("line",{x1:"7",y1:"12",x2:"-4.25",y2:"8.625",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"}),u.jsx("line",{x1:"7",y1:"12",x2:"-4.25",y2:"15.375",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"})]}),s>=3&&u.jsxs(u.Fragment,{children:[u.jsx("line",{x1:"7",y1:"12",x2:"-4.25",y2:"12",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"}),u.jsx("line",{x1:"7",y1:"12",x2:"-2.743",y2:"6.375",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"}),u.jsx("line",{x1:"7",y1:"12",x2:"-2.743",y2:"17.625",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"})]})]}),u.jsxs("g",{style:{color:w},children:[l===1&&u.jsx("line",{x1:"17",y1:"12",x2:"28.25",y2:"12",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"}),l===2&&u.jsxs(u.Fragment,{children:[u.jsx("line",{x1:"17",y1:"12",x2:"28.25",y2:"8.625",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"}),u.jsx("line",{x1:"17",y1:"12",x2:"28.25",y2:"15.375",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"})]}),l>=3&&u.jsxs(u.Fragment,{children:[u.jsx("line",{x1:"17",y1:"12",x2:"28.25",y2:"12",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"}),u.jsx("line",{x1:"17",y1:"12",x2:"26.743",y2:"6.375",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"}),u.jsx("line",{x1:"17",y1:"12",x2:"26.743",y2:"17.625",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"})]})]})]})}function m2(n){return u.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...n,children:[u.jsxs("defs",{children:[u.jsx("clipPath",{id:"legend-trace-left",children:u.jsx("rect",{x:"0",y:"0",width:"12",height:"24"})}),u.jsx("clipPath",{id:"legend-trace-right",children:u.jsx("rect",{x:"12",y:"0",width:"12",height:"24"})})]}),u.jsx("rect",{x:"7",y:"7",width:"10",height:"10",rx:"2",stroke:"currentColor",strokeWidth:"1.6",fill:"none",clipPath:"url(#legend-trace-left)",className:"text-gray-400"}),u.jsx("rect",{x:"7",y:"7",width:"10",height:"10",rx:"2",stroke:"currentColor",strokeWidth:"1.6",fill:"none",clipPath:"url(#legend-trace-right)",className:"text-orange-500"}),u.jsx("line",{x1:"7",y1:"12",x2:"-4.25",y2:"12",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round",className:"text-gray-400"}),u.jsx("line",{x1:"17",y1:"12",x2:"28.25",y2:"12",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round",className:"text-orange-500"})]})}function mb(n){return u.jsx("svg",{viewBox:"0 0 16 16",fill:"none","aria-hidden":"true",...n,children:u.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeWidth:"1.3",d:"m14.6685 5.7416.6425-2.57c.2028-.811-.4106-1.5967-1.2466-1.5967H2.5782a1.285 1.285 0 0 0-1.2467.9733l-.6425 2.57c-.2027.8111.4107 1.5968 1.2467 1.5968h11.4861a1.285 1.285 0 0 0 1.2467-.9734Zm0 7.7102.6425-2.5701c.2028-.811-.4106-1.5967-1.2466-1.5967h-5.061a1.285 1.285 0 0 0-1.2467.9734l-.6425 2.5701c-.2028.811.4106 1.5966 1.2466 1.5966h5.061a1.285 1.285 0 0 0 1.2467-.9733Zm-10.2802 0 .6425-2.5701c.2027-.811-.4107-1.5967-1.2467-1.5967H2.5782a1.285 1.285 0 0 0-1.2467.9734L.689 12.8285c-.2027.811.4107 1.5966 1.2467 1.5966h1.206a1.285 1.285 0 0 0 1.2466-.9733Z"})})}function g2(n){return u.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...n,children:u.jsx("path",{d:"M12 3v10m0 0l-4-4m4 4l4-4M5 19h14",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none"})})}function y2(n){return u.jsxs("svg",{viewBox:"0 0 16 16",fill:"none","aria-hidden":"true",...n,children:[u.jsx("path",{d:"M10.667 2.667c1.45.008 2.235.072 2.748.585C14 3.837 14 4.78 14 6.666v4c0 1.885 0 2.828-.585 3.414-.586.585-1.529.585-3.415.585H6c-1.886 0-2.829 0-3.414-.585C2 13.494 2 12.55 2 10.666v-4c0-1.886 0-2.829.586-3.414.512-.513 1.297-.577 2.747-.585",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round"}),u.jsx("path",{d:"M5.333 2.333c0-.552.448-1 1-1h3.334c.552 0 1 .448 1 1v.667c0 .553-.448 1-1 1H6.333c-.552 0-1-.447-1-1v-.667Z",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round"}),u.jsx("path",{d:"M8 6.667v4.666m0 0L5.667 9m2.333 2.333L10.333 9",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round"})]})}function hr(n){return u.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...n,children:[u.jsx("path",{d:"M3 7a2 2 0 0 1 2-2h4l2 2h8a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V7Z",stroke:"currentColor",strokeWidth:"1.5",fill:"none"}),u.jsx("path",{d:"M3 9h18",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]})}function gb(n){return u.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...n,children:[u.jsx("path",{d:"M5 4h12l3 3v13H4V5a1 1 0 0 1 1-1Z",stroke:"currentColor",strokeWidth:"1.5",fill:"none"}),u.jsx("rect",{x:"7",y:"4",width:"8",height:"4",fill:"currentColor"}),u.jsx("rect",{x:"7",y:"13",width:"10",height:"6",rx:"1",stroke:"currentColor",strokeWidth:"1.5",fill:"none"})]})}function yb(n){return u.jsxs("svg",{viewBox:"0 0 16 16",fill:"none","aria-hidden":"true",...n,children:[u.jsx("path",{d:"M12.667 14H3.333C2.597 14 2 13.403 2 12.667V3.333C2 2.597 2.597 2 3.333 2h7.334L14 5.333v7.334c0 .736-.597 1.333-1.333 1.333Z",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round"}),u.jsx("path",{d:"M11.333 14v-4H4.667v4M4.667 2v3.333h5.333",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round"})]})}function b2(n){return u.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...n,children:[u.jsx("circle",{cx:"12",cy:"12",r:"4",fill:"currentColor"}),u.jsx("path",{d:"M12 2v3M12 19v3M4.22 4.22l2.12 2.12M17.66 17.66l2.12 2.12M2 12h3M19 12h3M4.22 19.78l2.12-2.12M17.66 6.34l2.12-2.12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",fill:"none"})]})}function x2(n){return u.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...n,children:u.jsx("path",{d:"M21 14.5A9 9 0 0 1 9.5 3a7 7 0 1 0 11.5 11.5Z",fill:"currentColor"})})}function v2(n){return u.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",fill:"currentColor",...n,children:u.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z"})})}function U0(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","aria-hidden":"true",...n,children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})}function w2(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","aria-hidden":"true",...n,children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}function S2(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","aria-hidden":"true",...n,children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})}function N2(n){return u.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...n,children:u.jsx("path",{d:"M8 4h8M8 20h8M9 6h6l-1 4 1 4H9l1-4-1-4Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none"})})}function bb(n){return u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",...n,children:[u.jsx("path",{d:"M12 3v18"}),u.jsx("path",{d:"m8 7 4-4 4 4"}),u.jsx("path",{d:"m8 17 4 4 4-4"})]})}function C2({progress:n,radius:o=10,trackColor:s=kt.border.gray200,progressColor:l=kt.brand.blue500,...i}){const c=Math.min(100,Math.max(0,n)),f=2*Math.PI*o,m=f*(1-c/100);return u.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...i,children:[u.jsx("circle",{cx:"12",cy:"12",r:o,fill:"none",stroke:s,strokeWidth:"2"}),u.jsx("circle",{cx:"12",cy:"12",r:o,fill:"none",stroke:l,strokeWidth:"2",strokeLinecap:"round",strokeDasharray:f,strokeDashoffset:m})]})}function Ca({title:n,onBack:o,rightElement:s}){return u.jsxs("div",{className:"flex items-center mb-3",children:[u.jsxs("button",{onClick:o,className:"flex items-center gap-2 text-sm font-semibold text-gray-500 uppercase tracking-wide",children:[u.jsx(h2,{className:"w-5 h-5 text-gray-400"}),u.jsx("span",{children:n})]}),s&&u.jsx("div",{className:"ml-auto",children:s})]})}function k2({icon:n,title:o,description:s}){return u.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 bg-white border border-gray-100 rounded-lg shadow-sm",children:[n,u.jsxs("div",{children:[u.jsx("p",{className:"text-sm font-medium text-gray-900",children:o}),u.jsx("p",{className:"text-xs text-gray-500",children:s})]})]})}function j2(){return[{icon:u.jsx("div",{className:"w-8 h-8 flex items-center justify-center bg-blue-500 text-white rounded-lg font-bold text-xs shadow-sm",children:"Run"}),title:"Run",description:"Execute current workflow"},{icon:u.jsx("div",{className:"w-10 h-10 flex items-center justify-center bg-white border border-gray-200 rounded-lg text-gray-700 shadow-sm overflow-hidden",children:u.jsx(cb,{className:"w-5 h-5"})}),title:"Queue / Follow",description:"View queue & follow execution"},{icon:u.jsx("div",{className:"w-10 h-10 flex items-center justify-center bg-yellow-500 text-white rounded-lg shadow-sm",children:u.jsx(ya,{className:"w-5 h-5"})}),title:"Pinned Widget",description:"Quick access to pinned parameter"},{icon:u.jsx("div",{className:"w-8 h-8 flex items-center justify-center bg-gray-100 rounded-full border border-gray-200 text-gray-700 font-bold",children:""}),title:"Input",description:"Node input connection point"},{icon:u.jsx("div",{className:"w-8 h-8 flex items-center justify-center bg-gray-100 rounded-full border border-gray-200 text-gray-700 font-bold",children:""}),title:"Output",description:"Node output connection point"},{icon:u.jsx("div",{className:"w-8 h-8 flex items-center justify-center text-gray-700",children:u.jsx(m2,{className:"w-6 h-6 overflow-visible"})}),title:"Trace Connections",description:"Highlight connected nodes"},{icon:u.jsx("div",{className:"w-8 h-8 flex items-center justify-center text-gray-500",children:u.jsx(Jn,{className:"w-6 h-6"})}),title:"Fold / Unfold",description:"Collapse or expand node card"},{icon:u.jsx("div",{className:"w-8 h-8 flex items-center justify-center text-gray-700",children:u.jsx(fb,{className:"w-5 h-5"})}),title:"Bypass",description:"Skip node execution"},{icon:u.jsx("div",{className:"w-8 h-8 flex items-center justify-center text-gray-700",children:u.jsx(Go,{className:"w-5 h-5"})}),title:"Hide",description:"Hide node from view"},{icon:u.jsx("div",{className:"w-8 h-8 flex items-center justify-center text-gray-700",children:u.jsx(pr,{className:"w-5 h-5"})}),title:"Show",description:"Make node visible again"},{icon:u.jsx("div",{className:"w-8 h-8 flex items-center justify-center text-gray-700",children:u.jsx(Af,{className:"w-5 h-5"})}),title:"Pin widget",description:"Pin widget to bottom bar"}]}function M2({onBack:n}){const o=j2();return u.jsxs("div",{className:"flex flex-col h-full",children:[u.jsx(Ca,{title:"Icon Legend",onBack:n}),u.jsx("div",{className:"space-y-3 overflow-y-auto flex-1 pb-4",children:o.map(s=>u.jsx(k2,{icon:s.icon,title:s.title,description:s.description},s.title))})]})}function ka({error:n,onDismiss:o}){return n?u.jsxs("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:[n,u.jsx("button",{onClick:o,className:"ml-2 text-red-500 font-medium",children:"Dismiss"})]}):null}function O2({error:n,workflow:o,currentFilename:s,isDirty:l,loading:i,theme:c,menuSectionsOpen:f,fileInputRef:m,loadSectionRef:p,saveSectionRef:g,appearanceSectionRef:y,infoSectionRef:x,onDismissError:w,onFileChange:k,onLoadFromFile:N,onToggleSection:S,onOpenUserWorkflows:j,onOpenTemplates:C,onOpenPasteJson:T,onSave:V,onOpenSaveAs:U,onToggleTheme:R,onOpenLegend:z}){return u.jsxs(u.Fragment,{children:[u.jsx("input",{ref:m,type:"file",accept:".json",onChange:k,className:"hidden"}),u.jsx(ka,{error:n,onDismiss:w}),u.jsxs("section",{ref:p,className:"mb-6",children:[u.jsxs("button",{type:"button",onClick:()=>S("load"),className:"w-full flex items-center justify-between text-sm font-semibold text-gray-500 uppercase tracking-wide mb-3","aria-expanded":f.load,children:[u.jsx("span",{children:"Load Workflow"}),u.jsx(Jn,{className:`w-5 h-5 text-gray-400 transition-transform ${f.load?"rotate-0":"-rotate-90"}`})]}),f.load&&u.jsxs("div",{className:"space-y-2",children:[u.jsxs("button",{onClick:j,className:`w-full flex items-center gap-3 p-4 bg-white border border-gray-200
                         rounded-xl text-left hover:bg-gray-50 min-h-[56px]`,children:[u.jsx(bs,{className:"w-6 h-6 text-gray-600"}),u.jsx("span",{className:"font-medium text-gray-900",children:"My Workflows"}),u.jsx("span",{className:"ml-auto text-gray-400",children:""})]}),u.jsxs("button",{onClick:C,className:`w-full flex items-center gap-3 p-4 bg-white border border-gray-200
                         rounded-xl text-left hover:bg-gray-50 min-h-[56px]`,children:[u.jsx(mb,{className:"w-6 h-6 text-gray-600"}),u.jsx("span",{className:"font-medium text-gray-900",children:"Templates"}),u.jsx("span",{className:"ml-auto text-gray-400",children:""})]}),u.jsxs("button",{onClick:T,className:`w-full flex items-center gap-3 p-4 bg-white border border-gray-200
                         rounded-xl text-left hover:bg-gray-50 min-h-[56px]`,children:[u.jsx(y2,{className:"w-6 h-6 text-gray-600"}),u.jsx("span",{className:"font-medium text-gray-900",children:"Paste JSON"}),u.jsx("span",{className:"ml-auto text-gray-400",children:""})]}),u.jsxs("button",{onClick:N,className:`w-full flex items-center gap-3 p-4 bg-white border border-gray-200
                         rounded-xl text-left hover:bg-gray-50 min-h-[56px]`,children:[u.jsx(hr,{className:"w-6 h-6 text-gray-600"}),u.jsx("span",{className:"font-medium text-gray-900",children:"From Device"})]})]})]}),u.jsxs("section",{ref:g,className:"mb-6",children:[u.jsxs("button",{type:"button",onClick:()=>S("save"),className:"w-full flex items-center justify-between text-sm font-semibold text-gray-500 uppercase tracking-wide mb-3","aria-expanded":f.save,children:[u.jsx("span",{children:"Save Workflow"}),u.jsx(Jn,{className:`w-5 h-5 text-gray-400 transition-transform ${f.save?"rotate-0":"-rotate-90"}`})]}),f.save&&u.jsxs("div",{className:"space-y-2",children:[s&&u.jsxs("button",{onClick:V,disabled:!o||!l||i,className:`w-full flex items-center gap-3 p-4 bg-white border border-gray-200
                           rounded-xl text-left hover:bg-gray-50 min-h-[56px]
                           disabled:opacity-50 disabled:cursor-not-allowed`,children:[u.jsx(gb,{className:"w-6 h-6 text-gray-600 shrink-0"}),u.jsxs("span",{className:"font-medium text-gray-900 truncate",children:["Save ",s.replace(".json","")]})]}),u.jsxs("button",{onClick:U,disabled:!o,className:`w-full flex items-center gap-3 p-4 bg-white border border-gray-200
                         rounded-xl text-left hover:bg-gray-50 min-h-[56px]`,children:[u.jsx(yb,{className:"w-6 h-6 text-gray-600"}),u.jsx("span",{className:"font-medium text-gray-900",children:"Save As..."}),u.jsx("span",{className:"ml-auto text-gray-400",children:""})]})]})]}),u.jsx("div",{className:"border-t border-gray-200 mb-6"}),u.jsxs("section",{ref:y,className:"mb-6",children:[u.jsxs("button",{type:"button",onClick:()=>S("appearance"),className:"w-full flex items-center justify-between text-sm font-semibold text-gray-500 uppercase tracking-wide mb-3","aria-expanded":f.appearance,children:[u.jsx("span",{children:"Appearance"}),u.jsx(Jn,{className:`w-5 h-5 text-gray-400 transition-transform ${f.appearance?"rotate-0":"-rotate-90"}`})]}),f.appearance&&u.jsx("div",{className:"space-y-2",children:u.jsxs("button",{onClick:R,className:`w-full flex items-center gap-3 p-4 bg-white border border-gray-200
                         rounded-xl text-left hover:bg-gray-50 min-h-[56px]`,children:[c==="dark"?u.jsx(x2,{className:"w-6 h-6 text-gray-600"}):u.jsx(b2,{className:"w-6 h-6 text-gray-600"}),u.jsx("span",{className:"font-medium text-gray-900",children:c==="dark"?"Dark mode":"Light mode"})]})})]}),u.jsxs("section",{ref:x,className:"mt-auto pt-6 border-t border-gray-200",children:[u.jsxs("button",{type:"button",onClick:()=>S("info"),className:"w-full flex items-center justify-between text-sm font-semibold text-gray-500 uppercase tracking-wide mb-3","aria-expanded":f.info,children:[u.jsx("span",{children:"About"}),u.jsx(Jn,{className:`w-5 h-5 text-gray-400 transition-transform ${f.info?"rotate-0":"-rotate-90"}`})]}),f.info&&u.jsxs("div",{className:"space-y-2 pb-4",children:[u.jsxs("a",{href:"https://github.com/cosmicbuffalo/comfyui-mobile-frontend",target:"_blank",rel:"noopener noreferrer",className:`w-full flex items-center gap-3 p-4 bg-white border border-gray-200
                         rounded-xl text-left hover:bg-gray-50 min-h-[56px]`,children:[u.jsx(v2,{className:"w-6 h-6 text-gray-600"}),u.jsx("span",{className:"font-medium text-gray-900",children:"Open in GitHub"}),u.jsx(U0,{className:"w-4 h-4 ml-auto text-gray-400"})]}),u.jsxs("button",{onClick:z,className:`w-full flex items-center gap-3 p-4 bg-white border border-gray-200
                         rounded-xl text-left hover:bg-gray-50 min-h-[56px]`,children:[u.jsx(w2,{className:"w-6 h-6 text-gray-600"}),u.jsx("span",{className:"font-medium text-gray-900",children:"Icon Legend"}),u.jsx("span",{className:"ml-auto text-gray-400",children:""})]}),u.jsxs("a",{href:"https://github.com/cosmicbuffalo/comfyui-mobile-frontend/blob/main/USER_GUIDE.md",target:"_blank",rel:"noopener noreferrer",className:`w-full flex items-center gap-3 p-4 bg-white border border-gray-200
                         rounded-xl text-left hover:bg-gray-50 min-h-[56px]`,children:[u.jsx(S2,{className:"w-6 h-6 text-gray-600"}),u.jsx("span",{className:"font-medium text-gray-900",children:"User Manual"}),u.jsx(U0,{className:"w-4 h-4 ml-auto text-gray-400"})]})]})]})]})}async function T2(n){if(navigator.clipboard?.writeText)try{await navigator.clipboard.writeText(n);return}catch{}const o=document.createElement("textarea");o.value=n,o.readOnly=!0,o.style.position="fixed",o.style.top="0",o.style.left="0",o.style.opacity="0",document.body.appendChild(o),o.focus(),o.select(),o.setSelectionRange(0,o.value.length),document.execCommand("copy"),document.body.removeChild(o)}function $0(n,o,s){const l=n.current;if(l){if(l.focus(),o)l.setSelectionRange(o.start,o.end);else if(s!==void 0){const i=s.length;l.setSelectionRange(i,i)}}}function E2(n){const o=n.current;if(!o)return;const l=o.closest('[data-textarea-root="true"]')?.querySelector('[data-textarea-header="true"]');l?l.scrollIntoView({block:"nearest",behavior:"auto"}):o.scrollIntoView({block:"nearest",behavior:"auto"})}function ca({value:n,onChange:o,textareaRef:s,className:l=""}){const[i,c]=b.useState(!1),f=b.useRef(null),m=b.useRef(null),p=()=>{c(!0),f.current&&clearTimeout(f.current),f.current=setTimeout(()=>c(!1),900)},g=w=>{w.preventDefault()},y=async()=>{const w=s.current;w&&(m.current={start:w.selectionStart??0,end:w.selectionEnd??0});const k=s.current?.value??n;await T2(k),requestAnimationFrame(()=>$0(s,m.current||void 0)),p()},x=()=>{o(""),requestAnimationFrame(()=>{$0(s,void 0,""),E2(s)})};return u.jsxs("div",{className:`flex items-center text-[11px] text-gray-500 ${l}`,children:[u.jsxs("button",{type:"button",className:"inline-flex items-center gap-1 px-1 py-0.5 text-gray-600",onMouseDown:g,onClick:y,"aria-label":"Copy to clipboard",children:[i?u.jsx(Do,{className:"w-3.5 h-3.5 text-green-500"}):u.jsx(u2,{className:"w-3.5 h-3.5"}),u.jsx("span",{children:"Copy"})]}),u.jsx("span",{className:"text-gray-500/50",children:"|"}),u.jsxs("button",{type:"button",className:"inline-flex items-center gap-1 px-1 py-0.5 text-red-600",onMouseDown:g,onClick:x,"aria-label":"Clear text",children:[u.jsx(c2,{className:"w-3.5 h-3.5"}),u.jsx("span",{children:"Clear"})]})]})}function I2({error:n,pastedJson:o,pasteTextareaRef:s,onBack:l,onDismissError:i,onChangeJson:c,onLoad:f}){return u.jsxs("div",{className:"flex flex-col h-full",children:[u.jsx(Ca,{title:"Paste JSON",onBack:l}),u.jsx(ka,{error:n,onDismiss:i}),u.jsxs("div",{className:"flex-1 flex flex-col space-y-4",children:[u.jsx("p",{className:"text-sm text-gray-600",children:"Paste your workflow JSON below."}),u.jsxs("div",{className:"group","data-textarea-root":"true",children:[u.jsxs("div",{className:"flex items-center justify-between mb-1","data-textarea-header":"true",children:[u.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Workflow JSON"}),u.jsx(ca,{value:o,onChange:c,textareaRef:s,className:"opacity-70 transition-opacity group-focus-within:opacity-100"})]}),u.jsx("textarea",{ref:s,value:o,onChange:m=>c(m.target.value),placeholder:'{"last_node_id": ...}',className:"w-full flex-1 p-3 border border-gray-300 rounded-lg font-mono text-xs resize-none outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),u.jsxs("div",{className:"flex gap-3 pt-2",children:[u.jsx("button",{onClick:l,className:"flex-1 py-3 bg-gray-100 text-gray-700 rounded-lg font-medium hover:bg-gray-200 min-h-[48px]",children:"Cancel"}),u.jsx("button",{onClick:f,disabled:!o.trim(),className:`flex-1 py-3 bg-blue-500 text-white rounded-lg font-medium hover:bg-blue-600
                       disabled:opacity-50 disabled:cursor-not-allowed min-h-[48px]`,children:"Load"})]})]})]})}function L2({error:n,loading:o,workflow:s,saveFilenameInput:l,onBack:i,onDismissError:c,onSaveFilenameChange:f,onSaveAs:m,onDownload:p}){return u.jsxs("div",{className:"flex flex-col h-full",children:[u.jsx(Ca,{title:"Save Workflow",onBack:i}),u.jsx(ka,{error:n,onDismiss:c}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"p-4 bg-white border border-gray-200 rounded-xl",children:[u.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Save to ComfyUI server:"}),u.jsx("input",{type:"text",value:l,onChange:g=>f(g.target.value),placeholder:"Enter filename (e.g., my_workflow.json)",className:"w-full p-3 border border-gray-300 rounded-lg mb-3"}),u.jsx("button",{onClick:m,disabled:!s||!l.trim()||o,className:`w-full py-3 bg-blue-500 text-white rounded-lg font-medium
                       disabled:opacity-50 disabled:cursor-not-allowed min-h-[48px]`,children:o?"Saving...":"Save As"})]}),u.jsxs("button",{onClick:p,disabled:!s,className:`w-full flex items-center gap-3 px-4 py-3 bg-white border border-gray-200
                     rounded-xl text-left hover:bg-gray-50 min-h-[56px]
                     disabled:opacity-50 disabled:cursor-not-allowed`,children:[u.jsx(g2,{className:"w-6 h-6 text-gray-600"}),u.jsx("span",{className:"font-medium text-gray-900",children:"Download to Device"})]})]})]})}function ja({value:n,onChange:o,onClear:s,placeholder:l="Search...",autoFocus:i=!1,className:c="",inputClassName:f="",disabled:m=!1,readOnly:p=!1,inputRef:g,showClearButton:y=!0}){const x=y&&n.trim().length>0&&!m&&!p;return u.jsxs("div",{className:`relative ${c}`.trim(),children:[u.jsx(db,{className:"w-4 h-4 text-gray-400 absolute left-3 top-1/2 -translate-y-1/2 pointer-events-none"}),u.jsx("input",{ref:g,value:n,onChange:w=>o(w.target.value),placeholder:l,className:`w-full rounded-lg border border-gray-200 pl-9 pr-9 py-2 text-sm text-gray-900 placeholder:text-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent ${f}`.trim(),autoFocus:i,disabled:m,readOnly:p}),x&&u.jsx("button",{type:"button",onClick:()=>{if(s){s();return}o("")},className:"absolute right-2 top-1/2 -translate-y-1/2 p-1 text-gray-400 hover:text-gray-600","aria-label":"Clear search",children:u.jsx(Na,{className:"w-4 h-4"})})]})}const A2={sm:"w-4 h-4 border-2",md:"w-6 h-6 border-2",lg:"w-10 h-10 border-4"},R2={blue:"border-blue-500 border-t-transparent",gray:"border-gray-200 border-t-gray-500"};function hp({size:n="md",color:o="blue",className:s=""}){return u.jsx("div",{className:`animate-spin rounded-full ${A2[n]} ${R2[o]} ${s}`})}function _2({error:n,loading:o,templates:s,onBack:l,onDismissError:i,onLoadTemplate:c}){const[f,m]=b.useState(""),p=Object.entries(s),g=f.toLowerCase(),y=p.map(([w,k])=>[w,k.filter(N=>N.toLowerCase().includes(g))]).filter(([,w])=>w.length>0),x=p.length>0;return u.jsxs("div",{className:"flex flex-col h-full",children:[u.jsx(Ca,{title:"Templates",onBack:l}),u.jsx(ka,{error:n,onDismiss:i}),!o&&x&&u.jsx("div",{className:"py-2",children:u.jsx(ja,{value:f,onChange:m,placeholder:"Search",inputClassName:"bg-white"})}),o?u.jsx("div",{className:"flex items-center justify-center py-8",children:u.jsx(hp,{})}):x?y.length===0?u.jsx("p",{className:"text-gray-500 text-center py-8",children:"No matching templates"}):u.jsx("div",{className:"space-y-4 overflow-y-auto flex-1",children:y.map(([w,k])=>u.jsxs("div",{children:[u.jsx("h4",{className:"text-sm font-semibold text-gray-600 mb-2",children:w}),u.jsx("div",{className:"space-y-2",children:k.map(N=>u.jsxs("button",{onClick:()=>c(w,N),className:`w-full flex items-center gap-3 px-4 py-3 bg-white border border-gray-200
                               rounded-xl text-left hover:bg-gray-50 min-h-[56px]`,children:[u.jsx(mb,{className:"w-5 h-5 text-gray-600"}),u.jsx("span",{className:"font-medium text-gray-900 truncate",children:N.replace(/\.json$/,"")})]},N))})]},w))}):u.jsx("p",{className:"text-gray-500 text-center py-8",children:"No templates available"})]})}function D2(n){const o=new Date,s=new Date(n*1e3),l=o.getTime()-s.getTime(),i=Math.floor(l/(1e3*60*60*24)),c=String(s.getMonth()+1),f=String(s.getDate()),m=String(s.getFullYear()).slice(-2),p=`${c}/${f}/${m}`;return i===0?`${p} (Today)`:i===1?`${p} (Yesterday)`:`${p} (${i} days ago)`}function B2({error:n,loading:o,userWorkflows:s,onBack:l,onDismissError:i,onLoadWorkflow:c}){const[f,m]=b.useState(""),[p,g]=b.useState("name"),y=s.filter(w=>w.name.toLowerCase().includes(f.toLowerCase())).sort((w,k)=>p==="name"?w.name.localeCompare(k.name):(k.modified??0)-(w.modified??0)),x=u.jsxs("button",{onClick:()=>g(p==="name"?"date":"name"),className:"flex items-center gap-0.5 text-xs font-semibold text-blue-500",children:[u.jsx("span",{children:p==="name"?"NAME":"DATE"}),u.jsx("span",{children:""})]});return u.jsxs("div",{className:"flex flex-col h-full",children:[u.jsx(Ca,{title:"My Workflows",onBack:l,rightElement:x}),u.jsx(ka,{error:n,onDismiss:i}),!o&&s.length>0&&u.jsx("div",{className:"py-2",children:u.jsx(ja,{value:f,onChange:m,placeholder:"Search",inputClassName:"bg-white"})}),o?u.jsx("div",{className:"flex items-center justify-center py-8",children:u.jsx(hp,{})}):s.length===0?u.jsx("p",{className:"text-gray-500 text-center py-8",children:"No saved workflows yet"}):y.length===0?u.jsx("p",{className:"text-gray-500 text-center py-8",children:"No matching workflows"}):u.jsx("div",{className:"space-y-2 overflow-y-auto flex-1",children:y.map(w=>u.jsxs("button",{onClick:()=>c(w.name),className:`w-full flex items-center gap-3 px-4 py-3 bg-white border border-gray-200
                         rounded-xl text-left hover:bg-gray-50 min-h-[56px]`,children:[u.jsx(bs,{className:"w-5 h-5 text-gray-600"}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("p",{className:"font-medium text-gray-900 truncate",children:w.name.replace(/\.json$/,"")}),w.modified&&u.jsx("p",{className:"text-xs text-gray-500",children:D2(w.modified)})]})]},w.path))})]})}const al=Oo()(xr(n=>({theme:"dark",setTheme:o=>{n({theme:o})},toggleTheme:()=>{n(o=>({theme:o.theme==="dark"?"light":"dark"}))}}),{name:"theme-storage",storage:br(()=>localStorage)}));function z2({open:n,onClose:o}){const s=ae(Se=>Se.loadWorkflow),l=ae(Se=>Se.workflow),i=ae(Se=>Se.currentFilename),c=ae(Se=>Se.originalWorkflow),f=ae(Se=>Se.setSavedWorkflow),m=al(Se=>Se.theme),p=al(Se=>Se.toggleTheme),g=b.useRef(null),y=!!(l&&c&&JSON.stringify(l)!==JSON.stringify(c)),x=b.useRef(null),[w,k]=b.useState(null),[N,S]=b.useState("menu"),[j,C]=b.useState([]),[T,V]=b.useState({}),[U,R]=b.useState(!1),[z,L]=b.useState(i||""),[$,Y]=b.useState(""),[ue,pe]=b.useState({load:!0,save:!0,appearance:!0,info:!0}),fe=b.useRef(null),Re=b.useRef(null),Ie=b.useRef(null),Ae=b.useRef(null),_=b.useRef(ue);b.useEffect(()=>{const Se=_.current,H=ue;!Se.load&&H.load?setTimeout(()=>fe.current?.scrollIntoView({behavior:"smooth",block:"nearest"}),100):!Se.save&&H.save?setTimeout(()=>Re.current?.scrollIntoView({behavior:"smooth",block:"nearest"}),100):!Se.appearance&&H.appearance?setTimeout(()=>Ie.current?.scrollIntoView({behavior:"smooth",block:"nearest"}),100):!Se.info&&H.info&&setTimeout(()=>Ae.current?.scrollIntoView({behavior:"smooth",block:"nearest"}),100),_.current=H},[ue]),b.useEffect(()=>{n||(S("menu"),k(null),L(i||""),Y(""),pe({load:!0,save:!0,appearance:!0,info:!0}))},[n,i]),b.useEffect(()=>{N==="userWorkflows"&&(R(!0),q1().then(C).catch(Se=>k(Se.message)).finally(()=>R(!1)))},[N]),b.useEffect(()=>{N==="templates"&&(R(!0),W1().then(V).catch(Se=>k(Se.message)).finally(()=>R(!1)))},[N]);const se=Se=>{"vibrate"in navigator&&navigator.vibrate(Se)},ce=()=>{x.current?.click()},Ue=async Se=>{const H=Se.target.files?.[0];if(H){try{const P=await H.text(),D=JSON.parse(P);if(!D.nodes||!Array.isArray(D.nodes))throw new Error("Invalid workflow: missing nodes array");s(D,H.name),k(null),o(),se(10)}catch(P){k(P instanceof Error?P.message:"Failed to load workflow")}x.current&&(x.current.value="")}},De=async Se=>{try{R(!0);const H=await np(Se);s(H,Se,{fresh:!0,source:{type:"user",filename:Se}}),k(null),o(),se(10)}catch(H){k(H instanceof Error?H.message:"Failed to load workflow")}finally{R(!1)}},E=async(Se,H)=>{try{R(!0);const P=await op(Se,H);s(P,`${Se}/${H}`,{fresh:!0,source:{type:"template",moduleName:Se,templateName:H}}),k(null),o(),se(10)}catch(P){k(P instanceof Error?P.message:"Failed to load template")}finally{R(!1)}},A=async Se=>{if(!l)return;const H=Se.endsWith(".json")?Se:`${Se}.json`;try{R(!0),await Jy(H,gu(l)),f(l,H),k(null),o(),se(10)}catch(P){k(P instanceof Error?P.message:"Failed to save workflow")}finally{R(!1)}},O=()=>{i?A(i):S("save")},te=()=>{L(i||""),S("save")},Le=()=>{z.trim()?A(z):k("Please enter a filename.")},We=()=>{if(!l)return;const Se=JSON.stringify(gu(l),null,2),H=new Blob([Se],{type:"application/json"}),P=URL.createObjectURL(H),D=document.createElement("a");D.href=P,D.download=`${i||`workflow-${Date.now()}`}.json`,D.click(),URL.revokeObjectURL(P),se(10),o()},xe=()=>{try{const Se=JSON.parse($);if(!Se.nodes||!Array.isArray(Se.nodes))throw new Error("Invalid workflow: missing nodes array");const H=new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"});s(Se,`Pasted workflow (${H})`),k(null),o(),se(10),Y("")}catch(Se){k(Se instanceof Error?Se.message:"Failed to parse JSON")}};return u.jsxs(Yw,{open:n,onClose:o,side:"left",title:"ComfyUI Mobile",children:[N==="menu"&&u.jsx(O2,{error:w,workflow:l,currentFilename:i,isDirty:y,loading:U,theme:m,menuSectionsOpen:ue,fileInputRef:x,loadSectionRef:fe,saveSectionRef:Re,appearanceSectionRef:Ie,infoSectionRef:Ae,onDismissError:()=>k(null),onFileChange:Ue,onLoadFromFile:ce,onToggleSection:Se=>pe(H=>({...H,[Se]:!H[Se]})),onOpenUserWorkflows:()=>S("userWorkflows"),onOpenTemplates:()=>S("templates"),onOpenPasteJson:()=>S("pasteJson"),onSave:O,onOpenSaveAs:te,onToggleTheme:p,onOpenLegend:()=>S("aboutLegend")}),N==="userWorkflows"&&u.jsx(B2,{error:w,loading:U,userWorkflows:j,onBack:()=>S("menu"),onDismissError:()=>k(null),onLoadWorkflow:De}),N==="templates"&&u.jsx(_2,{error:w,loading:U,templates:T,onBack:()=>S("menu"),onDismissError:()=>k(null),onLoadTemplate:E}),N==="save"&&u.jsx(L2,{error:w,loading:U,workflow:l,saveFilenameInput:z,onBack:()=>S("menu"),onDismissError:()=>k(null),onSaveFilenameChange:L,onSaveAs:Le,onDownload:We}),N==="pasteJson"&&u.jsx(I2,{error:w,pastedJson:$,pasteTextareaRef:g,onBack:()=>S("menu"),onDismissError:()=>k(null),onChangeJson:Y,onLoad:xe}),N==="aboutLegend"&&u.jsx(M2,{onBack:()=>S("menu")})]})}function cl({open:n,onDismiss:o,triggerRef:s,contentRef:l,ignoreScrollWithinContent:i=!1}){b.useEffect(()=>{if(!n)return;const c=m=>{const p=m.target;s.current&&p&&s.current.contains(p)||l.current&&p&&l.current.contains(p)||o()},f=m=>{if(i){const p=m.target;if(l.current&&p&&l.current.contains(p))return}o()};return document.addEventListener("mousedown",c),document.addEventListener("scroll",f,!0),()=>{document.removeEventListener("mousedown",c),document.removeEventListener("scroll",f,!0)}},[n,o,s,l,i])}function Po({onClose:n,title:o,description:s,actions:l,actionsLayout:i="inline",zIndex:c=2200}){const f=m=>m==="danger"?"px-3 py-2 rounded-lg text-sm font-medium text-white bg-red-600 hover:bg-red-700":m==="primary"?"px-3 py-2 rounded-lg text-sm font-medium text-white bg-blue-600 hover:bg-blue-700":"px-3 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-100";return u.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4",style:{zIndex:c},onClick:n,role:"dialog","aria-modal":"true",children:u.jsxs("div",{className:"w-full max-w-sm bg-white border border-gray-200 rounded-xl shadow-lg p-4",onClick:m=>m.stopPropagation(),children:[u.jsx("div",{className:"text-gray-900 text-base font-semibold",children:o}),s&&u.jsx("div",{className:"text-gray-600 text-sm mt-1",children:s}),u.jsx("div",{className:i==="stack"?"mt-4 flex flex-col gap-2":"mt-4 flex justify-end gap-2",children:l.map(m=>u.jsx("button",{className:`${f(m.variant)} ${m.className??""}`.trim(),onClick:m.onClick,children:m.label},m.label))})]})})}function Pr({onClick:n,ariaLabel:o,buttonRef:s,icon:l,buttonSize:i=10,iconSize:c=5}){return u.jsx("button",{type:"button",onClick:n,"aria-label":o,className:`w-${i} h-${i} flex items-center justify-center rounded-lg bg-transparent hover:bg-transparent text-inherit`,ref:s,children:l??u.jsx(n2,{className:`w-${c} h-${c}`})})}const H2={default:{row:"text-gray-900 hover:bg-gray-50",icon:"text-gray-500"},muted:{row:"text-gray-600 hover:bg-gray-50",icon:"text-gray-500"},danger:{row:"text-red-600 hover:bg-red-50",icon:"text-red-500"},primary:{row:"text-blue-600 hover:bg-blue-50",icon:"text-blue-500"}};function gr({items:n,className:o,itemClassName:s}){return u.jsx("div",{className:`bg-white border border-gray-200 rounded-lg shadow-lg overflow-hidden ${o??""}`.trim(),children:n.map(l=>{if(l.type==="divider")return u.jsx("div",{className:`border-t border-gray-200 my-1 ${l.className??""}`.trim()},l.key);if(l.type==="custom")return l.hidden?null:u.jsx("div",{children:typeof l.render=="function"?l.render():l.render},l.key);if(l.hidden)return null;const i=H2[l.color??"default"];return u.jsxs("button",{type:"button",className:["w-full flex items-center gap-2 text-left px-3 py-2 text-sm",l.rightSlot?"justify-between":"",i.row,l.disabled?"opacity-50 cursor-not-allowed":"",s??"",l.className??""].join(" ").trim(),onClick:l.onClick,disabled:l.disabled,children:[u.jsxs("span",{className:"flex items-center gap-2 min-w-0",children:[l.icon?u.jsx("span",{className:i.icon,children:l.icon}):null,u.jsx("span",{className:"truncate",children:l.label})]}),l.rightSlot?u.jsx("span",{className:"shrink-0",children:l.rightSlot}):null]},l.key)})})}function V2({open:n,buttonRef:o,menuRef:s,onToggle:l,onClose:i,onGoToWorkflow:c,onOpenClearHistoryConfirm:f}){const m=Mt(A=>A.setQueueItemExpanded),p=Mt(A=>A.queueItemExpanded),g=Mt(A=>A.showQueueMetadata),y=Mt(A=>A.toggleShowQueueMetadata),x=Mt(A=>A.previewVisibility),w=Mt(A=>A.setPreviewVisibility),k=Mt(A=>A.previewVisibilityDefault),N=Mt(A=>A.setPreviewVisibilityDefault),S=Mt(A=>A.pending),j=Mt(A=>A.running),C=Mt(A=>A.clearQueue),T=qn(A=>A.history),V=qn(A=>A.clearEmptyItems),U=S.length>0,R=T.length>0,z=T.some(A=>A.outputs.images.length===0),L=S.length+j.length+T.length>0,$=b.useMemo(()=>{const A=new Set;return S.forEach(O=>A.add(O.prompt_id)),j.forEach(O=>A.add(O.prompt_id)),T.forEach(O=>{O.prompt_id&&A.add(String(O.prompt_id))}),Array.from(A)},[S,j,T]),Y=b.useMemo(()=>$.some(A=>p[A]===!1),[$,p]),ue=b.useMemo(()=>$.some(A=>p[A]!==!1),[$,p]),pe=b.useMemo(()=>{const A=new Set;return T.forEach(O=>{(O.outputs?.images??[]).some(We=>We.type!=="output")&&O.prompt_id&&A.add(String(O.prompt_id))}),Array.from(A)},[T]),fe=L||pe.length>0||k,Re=pe.length>0?pe.every(A=>x[A]??k):k,Ie=()=>{c(),i()},Ae=async()=>{await C(),i()},_=()=>{$.forEach(A=>m(A,!1)),i()},se=()=>{$.forEach(A=>m(A,!0)),i()},ce=()=>{y(),i()},Ue=()=>{const A=!Re;N(A),pe.forEach(O=>w(O,A)),i()},De=async()=>{await V(),i()},E=()=>{i(),f()};return u.jsxs("div",{id:"queue-menu-container",className:"relative",children:[u.jsx(Pr,{buttonRef:o,onClick:l,ariaLabel:"Queue options"}),n?u.jsx("div",{id:"queue-options-dropdown",ref:s,className:"absolute right-0 top-11 z-50 w-48",children:u.jsx(gr,{items:[{key:"go-to-workflow",label:"Go to workflow",icon:u.jsx(xu,{className:"w-3 h-3 rotate-180"}),onClick:Ie},{key:"cancel-pending",label:"Cancel all pending",icon:u.jsx(s2,{className:"w-4 h-4"}),onClick:Ae,hidden:!U},{key:"fold-all",label:"Fold all",icon:u.jsx(gs,{className:"w-7 h-7 -ml-1"}),onClick:_,hidden:!ue},{key:"unfold-all",label:"Unfold all",icon:u.jsx(Jn,{className:"w-7 h-7 -ml-1"}),onClick:se,hidden:!Y},{key:"toggle-metadata",label:g?"Hide metadata":"Show metadata",icon:u.jsx(ib,{className:"w-4 h-4"}),onClick:ce,hidden:!R},{key:"toggle-previews",label:Re?"Hide previews":"Show previews",icon:Re?u.jsx(Go,{className:"w-4 h-4"}):u.jsx(pr,{className:"w-4 h-4"}),onClick:Ue,hidden:!fe},{key:"clear-empty",label:"Clear empty items",icon:u.jsx(Bo,{className:"w-4 h-4"}),onClick:De,color:"muted",hidden:!z},{key:"clear-history",label:"Clear history",icon:u.jsx(Bo,{className:"w-4 h-4"}),onClick:E,color:"danger",hidden:!R}]})}):null]})}function K2(){const[n,o]=b.useState(!1),[s,l]=b.useState(!1),i=eo(p=>p.setCurrentPanel),c=qn(p=>p.clearHistory),f=b.useRef(null),m=b.useRef(null);return cl({open:n,onDismiss:()=>o(!1),triggerRef:f,contentRef:m}),u.jsxs(u.Fragment,{children:[u.jsx(V2,{open:n,buttonRef:f,menuRef:m,onToggle:()=>o(p=>!p),onClose:()=>o(!1),onGoToWorkflow:()=>i("workflow"),onOpenClearHistoryConfirm:()=>l(!0)}),s&&Mn.createPortal(u.jsx(Po,{onClose:()=>l(!1),title:"Clear history?",description:"This will permanently remove all completed generations from history. Generated files will still be present in your server's output folder.",actions:[{label:"Cancel",onClick:()=>l(!1),variant:"secondary"},{label:"Clear history",onClick:()=>{(async()=>(await c(),l(!1)))()},variant:"danger"}]}),document.body)]})}function U2({open:n,buttonRef:o,menuRef:s,onToggle:l,onClose:i,onGoToWorkflow:c}){const f=$t(U=>U.source),m=$t(U=>U.viewMode),p=$t(U=>U.showHidden),g=$t(U=>U.setSource),y=$t(U=>U.setViewMode),x=$t(U=>U.toggleShowHidden),w=$t(U=>U.toggleSelectionMode),k=$t(U=>U.setNewFolderModalOpen),N=()=>{k(!0),i()},S=()=>{g(f==="output"?"input":"output"),i()},j=()=>{c(),i()},C=()=>{w(),i()},T=()=>{x(),i()},V=()=>{y(m==="grid"?"list":"grid"),i()};return u.jsxs("div",{id:"outputs-topbar-actions",className:"relative flex items-center gap-1",children:[u.jsx(Pr,{buttonRef:o,onClick:l,ariaLabel:"Outputs options"}),n?u.jsx("div",{id:"outputs-options-dropdown",ref:s,className:"absolute right-0 top-11 z-50 w-48",children:u.jsx(gr,{items:[{key:"toggle-source",label:f==="output"?"Switch to inputs":"Switch to outputs",icon:u.jsx(dp,{className:"w-4 h-4"}),onClick:S},{key:"go-to-workflow",label:"Go to workflow",icon:u.jsx(xu,{className:"w-3 h-3"}),onClick:j},{key:"select",label:"Select",icon:u.jsx(Do,{className:"w-4 h-4"}),onClick:C},{key:"new-folder",label:"New folder",icon:u.jsx(hr,{className:"w-4 h-4"}),onClick:N},{key:"toggle-hidden",label:p?"Hide hidden files":"Show hidden files",icon:p?u.jsx(Go,{className:"w-4 h-4"}):u.jsx(pr,{className:"w-4 h-4"}),onClick:T},{key:"toggle-view",label:m==="grid"?"List view":"Grid view",icon:m==="grid"?u.jsx(Jw,{className:"w-4 h-4"}):u.jsx(p2,{className:"w-4 h-4"}),onClick:V}]})}):null]})}function $2(){const[n,o]=b.useState(!1),s=eo(c=>c.setCurrentPanel),l=b.useRef(null),i=b.useRef(null);return cl({open:n,onDismiss:()=>o(!1),triggerRef:l,contentRef:i}),u.jsx(U2,{open:n,buttonRef:l,menuRef:i,onToggle:()=>o(c=>!c),onClose:()=>o(!1),onGoToWorkflow:()=>s("workflow")})}const F2=5;function q2(n){const o={};for(const s of n)o[s.id]={mode:s.mode,flags:s.flags?{collapsed:!!s.flags.collapsed}:void 0,widgets_values:s.widgets_values};return o}function W2(n,o,s,l){return{nodes:q2(n.nodes),seedModes:{...o},collapsedItems:{...s},hiddenItems:{...l}}}function F0(n,o){if(n===o)return!0;if(n.length!==o.length)return!1;for(let s=0;s<n.length;s+=1)if(n[s]!==o[s])return!1;return!0}function q0(n){const{workflow:o}=ae.getState();if(!o)return[];const s=new Set;for(const c of o.nodes??[])c.stableKey&&s.add(c.stableKey);for(const c of o.groups??[])c.stableKey&&s.add(c.stableKey);for(const c of o.definitions?.subgraphs??[]){c.stableKey&&s.add(c.stableKey);for(const f of c.groups??[])f.stableKey&&s.add(f.stableKey)}const l=[],i=new Set;for(const c of n)!c||i.has(c)||s.has(c)&&(i.add(c),l.push(c));return l}const Fn=Oo()(xr((n,o)=>({bookmarkedItems:[],bookmarkBarSide:"right",bookmarkBarTop:null,bookmarkRepositioningActive:!1,toggleBookmark:s=>{if(!s)return;const{bookmarkedItems:l}=o(),{currentWorkflowKey:i,savedWorkflowStates:c,workflow:f,collapsedItems:m,hiddenItems:p}=ae.getState(),g=$n.getState().seedModes,x=l.includes(s)?l.filter(w=>w!==s):l.length>=F2?l:[...l,s];if(x!==l){if(i){let k=c[i];!k&&f&&(k=W2(f,g,m,p)),k&&ae.setState({savedWorkflowStates:{...c,[i]:{...k,bookmarkedItems:[...x]}}})}n({bookmarkedItems:x})}},clearBookmarks:()=>{const{currentWorkflowKey:s,savedWorkflowStates:l}=ae.getState();if(s&&l[s]){const i=l[s];ae.setState({savedWorkflowStates:{...l,[s]:{...i,bookmarkedItems:[]}}})}n({bookmarkedItems:[]})},setBookmarkBarPosition:s=>{n(l=>({bookmarkBarSide:s.side??l.bookmarkBarSide,bookmarkBarTop:s.top??l.bookmarkBarTop}))},setBookmarkRepositioningActive:s=>{n({bookmarkRepositioningActive:s})}}),{name:"bookmark-bar-storage",storage:br(()=>localStorage),partialize:n=>({bookmarkBarSide:n.bookmarkBarSide,bookmarkBarTop:n.bookmarkBarTop})}));function G2(){const{workflow:n,currentWorkflowKey:o,savedWorkflowStates:s}=ae.getState(),{bookmarkedItems:l}=Fn.getState();if(!n){l.length>0&&Fn.setState({bookmarkedItems:[]});return}if(!o){const f=q0(l);F0(l,f)||Fn.setState({bookmarkedItems:f});return}const i=s[o],c=q0(i?.bookmarkedItems??[]);F0(l,c)||Fn.setState({bookmarkedItems:c})}ae.subscribe(()=>{G2()});function P2({open:n,buttonRef:o,menuRef:s,onToggle:l,onClose:i,onGoToQueue:c,onGoToOutputs:f,onAddNode:m,onOpenWorkflowActions:p}){const g=ae(F=>F.workflow),y=ae(F=>F.nodeTypes),x=ae(F=>F.setItemCollapsed),w=ae(F=>F.setItemHidden),k=ae(F=>F.showAllHiddenNodes),N=ae(F=>F.hiddenItems),S=Fn(F=>F.bookmarkedItems),j=Fn(F=>F.clearBookmarks),C=ae(F=>F.collapsedItems),T=ae(F=>F.workflowSource),V=ae(F=>F.loadWorkflow),U=ae(F=>F.searchOpen),R=ae(F=>F.setSearchOpen),z=ae(F=>F.setSearchQuery),L=ae(F=>F.connectionButtonsVisible),$=ae(F=>F.toggleConnectionButtonsVisible),Y=qn(F=>F.history),ue=b.useCallback((F,ie)=>!!F[ie],[]),pe=!!g,fe=b.useMemo(()=>g?.nodes.map(F=>F.stableKey??null).filter(F=>F!=null)??[],[g]),Re=b.useMemo(()=>[...g?.groups??[],...(g?.definitions?.subgraphs??[]).flatMap(ie=>ie.groups??[])].map(ie=>ie.stableKey??null).filter(ie=>ie!=null),[g]),Ie=b.useMemo(()=>(g?.definitions?.subgraphs?.map(F=>F.stableKey??null)??[]).filter(F=>F!=null),[g]),Ae=b.useMemo(()=>g?.nodes.filter(F=>F.mode===4)??[],[g]),_=b.useMemo(()=>!g||!y?[]:g.nodes.filter(F=>{if(F.type==="Fast Groups Bypasser (rgthree)")return!1;const ie=lp(y,F).filter($e=>!$e.connected),_e=ap(y,F).filter($e=>!$e.connected);return ie.length===0&&_e.length===0}),[g,y]),se=Ae.length,ce=_.length,Ue=b.useMemo(()=>Object.values(N).filter(Boolean).length,[N]),De=b.useMemo(()=>Ae.filter(F=>(()=>{const ie=F.stableKey;return ie?N[ie]:!1})()).length,[Ae,N]),E=b.useMemo(()=>_.filter(F=>(()=>{const ie=F.stableKey;return ie?N[ie]:!1})()).length,[_,N]),A=b.useMemo(()=>g?g.nodes.filter(F=>(()=>{const ie=F.stableKey;return ie?!N[ie]:!0})()):[],[g,N]),O=b.useMemo(()=>A.some(F=>{const ie=F.stableKey??null;return ie?C[ie]===!0:!1}),[C,A]),te=b.useMemo(()=>A.some(F=>{const ie=F.stableKey??null;return ie?C[ie]!==!0:!0}),[C,A]),Le=b.useMemo(()=>Re.some(F=>C[F]===!0),[Re,C]),We=b.useMemo(()=>Re.some(F=>(C[F]??!1)===!1),[Re,C]),xe=b.useMemo(()=>Ie.some(F=>C[F]??!1),[Ie,C]),Se=b.useMemo(()=>Ie.some(F=>(C[F]??!1)===!1),[Ie,C]),H=O||Le||xe,P=te||We||Se,D=b.useMemo(()=>Ue>0||Re.some(ie=>ue(N,ie))?!0:Ie.some(ie=>N[ie]===!0),[Ue,N,Re,Ie,ue]),[K,Z]=b.useState(!1),q=()=>{i()},Ee=()=>{c(),q()},je=()=>{f(),q()},Ne=()=>{z(""),R(!0),q()},ee=()=>{m(),q()},Me=()=>{fe.forEach(F=>x(F,!0)),Re.forEach(F=>x(F,!0)),Ie.forEach(F=>x(F,!0)),q()},I=()=>{fe.forEach(F=>x(F,!1)),Re.forEach(F=>x(F,!1)),Ie.forEach(F=>x(F,!1)),q()},B=()=>{k(),Re.forEach(F=>w(F,!1)),Ie.forEach(F=>w(F,!1))},W=()=>{j(),q()},be=async()=>{if(!(!T||T.type!=="user")){try{const F=await np(T.filename);V(F,T.filename,{fresh:!0,source:T})}catch(F){console.error("Failed to reload workflow:",F)}q()}},me=async()=>{if(!(!T||T.type!=="template")){try{const F=await op(T.moduleName,T.templateName);V(F,`${T.moduleName}/${T.templateName}`,{fresh:!0,source:T})}catch(F){console.error("Failed to reload template:",F)}q()}},ke=()=>{if(!T||T.type!=="history")return;const F=Y.find(ie=>ie.prompt_id===T.promptId);F?.workflow&&V(F.workflow,`history-${T.promptId}.json`,{source:T}),q()};return u.jsxs("div",{id:"workflow-menu-container",className:"relative",children:[u.jsx(Pr,{buttonRef:o,onClick:l,ariaLabel:"Workflow options"}),n?u.jsx("div",{id:"workflow-options-dropdown",ref:s,className:"absolute right-0 top-11 z-50 w-52",children:u.jsx(gr,{items:[{key:"go-to-queue",label:"Go to queue",icon:u.jsx(xu,{className:"w-3 h-3"}),onClick:Ee},{key:"go-to-outputs",label:"Go to outputs",icon:u.jsx(xu,{className:"w-3 h-3 rotate-180"}),onClick:je},{key:"search",label:"Search",icon:u.jsx(db,{className:"w-4 h-4"}),onClick:Ne,hidden:U},{key:"add-node",label:"Add node",icon:u.jsx(zo,{className:"w-4 h-4"}),onClick:ee,hidden:!pe},{key:"hide-show",label:"Hide / Show",icon:u.jsx(pr,{className:"w-4 h-4"}),onClick:()=>{Z(!0),q()}},{key:"fold-all",label:"Fold all",icon:u.jsx(gs,{className:"w-6 h-6 -ml-1"}),onClick:Me,hidden:!P},{key:"unfold-all",label:"Unfold all",icon:u.jsx(Jn,{className:"w-6 h-6 -ml-1"}),onClick:I,hidden:!H},{key:"clear-bookmarks",label:"Clear bookmarks",icon:u.jsx(Bo,{className:"w-4 h-4"}),onClick:W,hidden:S.length===0},{key:"reload-workflow",label:"Reload workflow",icon:u.jsx(dp,{className:"w-4 h-4"}),onClick:T?.type==="user"?be:T?.type==="template"?me:T?.type==="history"&&Y.find(F=>F.prompt_id===T.promptId)?.workflow?ke:void 0,hidden:!T||T.type==="history"&&!Y.find(F=>F.prompt_id===T.promptId)?.workflow},{key:"workflow-actions",label:"Workflow actions",icon:u.jsx(bs,{className:"w-4 h-4"}),onClick:()=>{p(),q()}}]})}):null,K&&u.jsx("div",{className:"fixed inset-0 z-[2150] bg-black/50 flex items-center justify-center p-4",onClick:()=>Z(!1),role:"dialog","aria-modal":"true",children:u.jsxs("div",{className:"w-full max-w-sm bg-white border border-gray-200 rounded-xl shadow-lg overflow-hidden",onClick:F=>F.stopPropagation(),children:[u.jsx("div",{className:"px-4 py-3 text-sm font-semibold text-gray-700 border-b border-gray-100",children:"Hide / Show"}),u.jsx("div",{className:"max-h-[50vh] overflow-y-auto",children:u.jsx(gr,{itemClassName:"px-4 py-3",items:[{key:"static-nodes",label:E<ce?`Hide static nodes (${ce})`:`Show static nodes (${ce})`,icon:E<ce?u.jsx(Go,{className:"w-4 h-4"}):u.jsx(pr,{className:"w-4 h-4"}),onClick:()=>{E<ce?_.forEach(F=>{const ie=F.stableKey??null;ie&&w(ie,!0)}):_.forEach(F=>{const ie=F.stableKey??null;ie&&w(ie,!1)})},hidden:ce===0},{key:"bypassed-nodes",label:De>0?`Show bypassed nodes (${se})`:`Hide bypassed nodes (${se})`,icon:De>0?u.jsx(pr,{className:"w-4 h-4"}):u.jsx(Go,{className:"w-4 h-4"}),onClick:()=>{De>0?Ae.forEach(F=>{const ie=F.stableKey??null;ie&&w(ie,!1)}):Ae.forEach(F=>{const ie=F.stableKey??null;ie&&w(ie,!0)})},hidden:se===0},{key:"toggle-connection-buttons",label:L?"Hide connection buttons":"Show connection buttons",icon:L?u.jsx(Go,{className:"w-4 h-4"}):u.jsx(pr,{className:"w-4 h-4"}),onClick:$},{key:"show-all-hidden",label:"Show all hidden nodes",icon:u.jsx(pr,{className:"w-4 h-4"}),onClick:B,hidden:!D}]})}),u.jsx("div",{className:"px-4 py-3 border-t border-gray-100 flex justify-end",children:u.jsx("button",{className:"px-3 py-2 text-sm font-medium text-gray-600 hover:bg-gray-100 rounded-lg",onClick:()=>Z(!1),children:"Cancel"})})]})})]})}function Xs({icon:n,label:o,onClick:s,disabled:l,description:i,tone:c="default"}){const f=c==="danger";return u.jsxs("button",{className:`w-full flex items-start gap-3 text-left px-4 py-3 disabled:opacity-50 ${f?"text-red-600 hover:bg-red-50":"hover:bg-gray-50"}`,onClick:s,disabled:l,children:[u.jsx("span",{className:"shrink-0 self-start mt-[3px]",children:n}),u.jsxs("span",{className:"flex flex-col min-w-0",children:[u.jsx("span",{className:`text-sm ${f?"text-red-600":"text-gray-900"}`,children:o}),i?u.jsx("span",{className:"text-xs text-gray-500",children:i}):null]})]})}function Y2(){const[n,o]=b.useState(null),[s,l]=b.useState(null),[i,c]=b.useState(!1),[f,m]=b.useState(!1),[p,g]=b.useState(""),[y,x]=b.useState(null),[w,k]=b.useState(!1),N=ae(E=>E.workflow),S=ae(E=>E.originalWorkflow),j=ae(E=>E.currentFilename),C=ae(E=>E.workflowSource),T=ae(E=>E.loadWorkflow),V=ae(E=>E.setSavedWorkflow),U=ae(E=>E.clearWorkflowCache),R=ae(E=>E.unloadWorkflow),z=ae(E=>E.requestAddNodeModal),L=eo(E=>E.setCurrentPanel),$=ae(E=>E.workflowLoadedAt),Y=qn(E=>E.history),ue=b.useRef(null),pe=b.useRef(null),fe=n!==null&&n===$,Re=b.useMemo(()=>!!(N&&S&&JSON.stringify(N)!==JSON.stringify(S)),[N,S]);cl({open:fe,onDismiss:()=>o(null),triggerRef:ue,contentRef:pe});const Ie=async()=>{if(localStorage.clear(),sessionStorage.clear(),"caches"in window){const E=await caches.keys();await Promise.all(E.map(A=>caches.delete(A)))}document.cookie.split(";").forEach(E=>{const[A]=E.split("=");document.cookie=`${A.trim()}=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/`}),window.location.reload()},Ae=async E=>{if(!N)return;const A=E.endsWith(".json")?E:`${E}.json`;try{k(!0),await Jy(A,gu(N)),V(N,A),x(null),m(!1),c(!1)}catch(O){x(O instanceof Error?O.message:"Failed to save workflow")}finally{k(!1)}},_=async()=>{if(!C){S&&T(S,j??void 0,{fresh:!0,source:{type:"other"}});return}if(C.type==="user"){const E=await np(C.filename);T(E,C.filename,{fresh:!0,source:C});return}if(C.type==="template"){const E=await op(C.moduleName,C.templateName);T(E,`${C.moduleName}/${C.templateName}`,{fresh:!0,source:C});return}if(C.type==="history"){const E=Y.find(A=>A.prompt_id===C.promptId);E?.workflow&&T(E.workflow,`history-${C.promptId}.json`,{fresh:!0,source:C});return}S&&T(S,j??void 0,{fresh:!0,source:C})},se=E=>{if(Re){l(E);return}E==="unload"?R():E==="clearWorkflowCache"?U():E==="clearAllCache"?Ie():_(),c(!1)},ce=async E=>{l(null);try{k(!0),E==="unload"?R():E==="clearWorkflowCache"?U():E==="clearAllCache"?await Ie():await _(),c(!1)}catch(A){x(A instanceof Error?A.message:"Failed to complete action")}finally{k(!1)}},Ue=()=>{o(null),x(null),c(!0)},De=()=>{z({groupId:null,subgraphId:null})};return u.jsxs(u.Fragment,{children:[u.jsx(P2,{open:fe,buttonRef:ue,menuRef:pe,onToggle:()=>o(fe?null:$),onClose:()=>o(null),onGoToQueue:()=>L("queue"),onGoToOutputs:()=>L("outputs"),onAddNode:De,onOpenWorkflowActions:Ue}),i&&u.jsx("div",{className:"fixed inset-0 z-[1450] bg-black/50 flex items-center justify-center p-4",onClick:()=>c(!1),role:"dialog","aria-modal":"true",children:u.jsxs("div",{className:"w-full max-w-sm bg-white border border-gray-200 rounded-xl shadow-lg overflow-hidden",onClick:E=>E.stopPropagation(),children:[u.jsx("div",{className:"px-4 py-3 text-sm font-semibold text-gray-700 border-b border-gray-100",children:"Workflow actions"}),y&&u.jsx("div",{className:"px-4 py-2 text-sm text-red-700 bg-red-50 border-b border-red-100",children:y}),u.jsxs("div",{className:"max-h-[60vh] overflow-y-auto",children:[u.jsx(Xs,{icon:u.jsx(gb,{className:"w-4 h-4 text-gray-500"}),label:"Save",onClick:()=>{if(N){if(!j){g(j??""),m(!0);return}Ae(j)}},disabled:!N||!Re||w}),u.jsx(Xs,{icon:u.jsx(yb,{className:"w-4 h-4 text-gray-500"}),label:"Save as",onClick:()=>{g(j??""),m(!0)},disabled:!N||w}),Re&&u.jsx(Xs,{icon:u.jsx(dp,{className:"w-4 h-4 text-red-500"}),label:"Discard changes",tone:"danger",onClick:()=>se("discardChanges"),disabled:w}),u.jsx("div",{className:"border-t border-gray-200"}),u.jsx(Xs,{icon:u.jsx(Bo,{className:"w-5 h-5 text-gray-500"}),label:"Clear workflow cache",description:"(hidden nodes, folds, etc.)",onClick:()=>se("clearWorkflowCache"),disabled:!N||w}),u.jsx(Xs,{icon:u.jsx(l2,{className:"w-5 h-5 text-red-500"}),label:"Unload workflow",description:"Close the current workflow panel state",tone:"danger",onClick:()=>se("unload"),disabled:!N||w}),u.jsx(Xs,{icon:u.jsx(Bo,{className:"w-5 h-5 text-red-500"}),label:"Clear device cache",description:"Reset local storage and reload app",tone:"danger",onClick:()=>se("clearAllCache"),disabled:w})]}),u.jsx("div",{className:"border-t border-gray-100 p-3",children:u.jsx("button",{className:"w-full px-4 py-2.5 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200",onClick:()=>c(!1),children:"Close"})})]})}),f&&u.jsx("div",{className:"fixed inset-0 z-[1460] bg-black/50 flex items-center justify-center p-4",onClick:()=>m(!1),role:"dialog","aria-modal":"true",children:u.jsxs("div",{className:"w-full max-w-sm bg-white border border-gray-200 rounded-xl shadow-lg p-4",onClick:E=>E.stopPropagation(),children:[u.jsx("div",{className:"text-base font-semibold text-gray-900 mb-3",children:"Save as"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"text",value:p,onChange:E=>g(E.target.value),className:"w-full border border-gray-300 rounded-lg px-3 pr-9 py-2 text-sm text-gray-900 focus:outline-none focus:border-2 focus:border-blue-500",placeholder:"workflow.json",autoFocus:!0}),p.length>0&&u.jsx("button",{type:"button",className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700",onClick:()=>g(""),"aria-label":"Clear filename",children:u.jsx(Na,{className:"w-4 h-4"})})]}),u.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[u.jsx("button",{className:"px-3 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-100",onClick:()=>m(!1),children:"Cancel"}),u.jsx("button",{className:"px-3 py-2 rounded-lg text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 disabled:opacity-50",onClick:()=>{const E=p.trim();if(!E){x("Please enter a filename.");return}Ae(E)},disabled:!N||w,children:"Save"})]})]})}),s&&Mn.createPortal(u.jsx(Po,{onClose:()=>l(null),title:"Unsaved changes",description:"You have unsaved changes in the current workflow. Continue without saving?",actions:[{label:"Cancel",onClick:()=>l(null),className:"px-3 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-100"},{label:s==="discardChanges"?"Discard changes":"Continue",onClick:()=>{ce(s)},className:"px-3 py-2 rounded-lg text-sm font-medium text-white bg-red-600 hover:bg-red-700"}]}),document.body)]})}function Q2({onClick:n}){return u.jsx("button",{type:"button",onClick:n,"aria-label":"Menu",className:"w-10 h-10 flex items-center justify-center rounded-lg text-gray-700 hover:bg-gray-100",children:u.jsx(fp,{className:"w-6 h-6"})})}function X2({title:n,mode:o,isDirty:s,hasWorkflow:l,nodeCountLabel:i,historyLength:c,pendingLength:f,onTap:m}){return u.jsxs("div",{id:"top-bar-title-container",className:"flex-1 text-center min-w-0 px-2 cursor-pointer",onClick:m,children:[u.jsxs("h1",{id:"top-bar-title",className:"font-semibold text-gray-900 text-lg truncate flex items-center justify-center",children:[u.jsx("span",{className:"truncate",children:n}),o==="workflow"&&s&&u.jsx("span",{id:"dirty-indicator",className:"text-blue-500 ml-1 font-bold",children:"*"})]}),o==="workflow"&&l&&u.jsx("p",{className:"node-count-display text-xs text-gray-500",children:i}),o==="queue"&&u.jsxs("p",{className:"run-count-display text-xs text-gray-500",children:[c," ",c===1?"run":"runs",f>0&&` (${f} pending)`]})]})}function Z2(n){return n==="queue"?['[data-queue-list="true"]','[data-node-list="true"]']:['[data-node-list="true"]','[data-queue-list="true"]']}function J2({mode:n="workflow"}){const o=b.useRef(null),s=b.useRef(0),l=Lf(C=>C.appMenuOpen),i=Lf(C=>C.setAppMenuOpen),c=b.useCallback(()=>{const C=Date.now(),T=C-s.current;if(s.current=C,T<300){if(n==="workflow"){window.dispatchEvent(new Event("workflow-scroll-to-top")),"vibrate"in navigator&&navigator.vibrate(10);return}if(n==="outputs"){const U=document.querySelector("#outputs-content-container");U&&(U.scrollTo({top:0,behavior:"auto"}),"vibrate"in navigator&&navigator.vibrate(10));return}const V=Z2(n);for(const U of V){const R=document.querySelector(U);if(R&&R.scrollHeight>0&&!R.closest(".pointer-events-none")){R.scrollTo({top:0,behavior:"smooth"}),"vibrate"in navigator&&navigator.vibrate(10);break}}}},[n]),f=ae(C=>C.workflow),m=ae(C=>C.originalWorkflow),p=ae(C=>C.currentFilename),g=ae(C=>C.hiddenItems),y=Mt(C=>C.pending),x=qn(C=>C.history),w=$t(C=>C.source),k=f&&m&&JSON.stringify(f)!==JSON.stringify(m),N=b.useMemo(()=>{if(!f)return"";const C=f.nodes.length,T=Object.keys(g).length,V=Object.values(g).some(Boolean);if(T===0&&!V)return`${C} nodes ${k?"[Unsaved]":""}`.trim();const U=V?f.nodes.reduce((z,L)=>{const Y=L.properties?.__mobile_origin;if(!Y||typeof Y!="object"||Y.scope!=="subgraph")return z;const pe=Y.subgraphId,fe=pe?f.definitions?.subgraphs?.find(Re=>Re.id===pe)?.stableKey:null;return fe&&g[fe]?z+1:z},0):0,R=T+U;return`${C} nodes (${R} hidden) ${k?"[Unsaved]":""}`.trim()},[f,g,k]);b.useEffect(()=>{const C=o.current;if(!C)return;const T=()=>{const U=C.getBoundingClientRect();document.documentElement.style.setProperty("--top-bar-offset",`${U.height}px`)};T();const V=new ResizeObserver(T);return V.observe(C),()=>V.disconnect()},[]);const S=b.useMemo(()=>{switch(n){case"queue":return"Queue";case"outputs":return w==="output"?"Outputs":"Inputs";default:return p?p.replace(".json",""):f?"Untitled":"ComfyUI Mobile"}},[n,w,p,f]),j=b.useMemo(()=>{switch(n){case"queue":return u.jsx(K2,{});case"outputs":return u.jsx($2,{});default:return u.jsx(Y2,{})}},[n]);return u.jsxs("div",{id:"top-bar-root",ref:o,className:"fixed top-0 left-0 right-0 bg-white border-b border-gray-200 z-[2000] safe-area-top","data-top-bar":"true",children:[u.jsxs("div",{id:"top-bar-content",className:"flex items-center justify-between px-4 py-3",children:[u.jsx(Q2,{onClick:()=>i(!0)}),u.jsx(X2,{title:S,mode:n,isDirty:!!k,hasWorkflow:!!f,nodeCountLabel:N,historyLength:x.length,pendingLength:y.length,onTap:c}),u.jsx("div",{id:"top-bar-right-slot",className:"w-10 h-10 flex items-center justify-center",children:j})]}),u.jsx(z2,{open:l,onClose:()=>i(!1)})]})}function eS(){const n=ae(k=>k.setMobileLayout),o=ae(k=>k.mobileLayout),s=ae(k=>k.prepareRepositionScrollTarget),[l,i]=b.useState(!1),[c,f]=b.useState(null),[m,p]=b.useState(null),g=b.useCallback((k,N)=>{const S=(j,C)=>{for(const T of j){if(T.type==="group"){if(T.id===k&&C===N)return T.stableKey;const V=S(o.groups[T.stableKey]??[],C);if(V)return V;continue}if(T.type==="subgraph"){const V=S(o.subgraphs[T.id]??[],T.id);if(V)return V}}return null};return S(o.root,null)},[o]),y=b.useCallback(k=>{let N;if(k.type==="node")N=`[data-reposition-item="node-${k.id}"]`;else if(k.type==="group"){const j=g(k.id,k.subgraphId??null);if(!j)return;N=`[data-reposition-item="group-${j}"]`}else N=`[data-reposition-item="subgraph-${k.id}"]`;const S=document.querySelector(N);p(S?{viewportTop:S.getBoundingClientRect().top}:null),f(k),i(!0)},[g]),x=b.useCallback((k,N,S)=>{n(k),i(!1),f(null),p(null),s(N),requestAnimationFrame(()=>{requestAnimationFrame(()=>{let j;if(N.type==="node")j=`[data-reposition-item="node-${N.id}"]`;else if(N.type==="group"){const C=g(N.id,N.subgraphId??null);if(!C)return;j=`[data-reposition-item="group-${C}"]`}else j=`[data-reposition-item="subgraph-${N.id}"]`;if(j){const C=document.querySelector(j);if(!C)return;if(S){const T=document.querySelector('[data-node-list="true"]');if(T){const U=C.getBoundingClientRect().top-S.viewportTop;Math.abs(U)>.5&&(T.scrollTop+=U);return}}C.scrollIntoView({behavior:"auto",block:"center"})}})})},[s,g,n]),w=b.useCallback(()=>{i(!1),f(null),p(null)},[]);return{overlayOpen:l,initialTarget:c,initialViewportAnchor:m,openOverlay:y,commitAndClose:x,cancelOverlay:w}}function ba(n){const o=n.replace("#","").trim();return/^[0-9a-f]{3}$/i.test(o)?`#${o.replace(/(.)/g,"$1$1").toLowerCase()}`:/^[0-9a-f]{6}$/i.test(o)?`#${o.toLowerCase()}`:null}function xb(n){if(typeof document>"u"||!document.body)return null;const o=document.createElement("span");o.style.color=n,document.body.appendChild(o);const s=getComputedStyle(o).color;document.body.removeChild(o);const l=s.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)/i);if(!l)return null;const[,i,c,f]=l.map(Number);return[i,c,f].some(m=>Number.isNaN(m))?null:`#${[i,c,f].map(m=>m.toString(16).padStart(2,"0")).join("")}`}function W0(n,o){const s=new Set,l=n.trim().toLowerCase();if(l&&(s.add(l),o)){const f=o[l.replace(/\s+/g,"")]??o[l];f&&s.add(f)}const i=ba(n);if(i)return s.add(i),[...s];const c=xb(n);return c&&s.add(c),[...s]}function G0(n){const o=ba(n);if(!o)return null;const s=parseInt(o.slice(1,3),16)/255,l=parseInt(o.slice(3,5),16)/255,i=parseInt(o.slice(5,7),16)/255,c=Math.max(s,l,i),f=Math.min(s,l,i),m=c-f;let p=0;m!==0&&(c===s?p=(l-i)/m%6:c===l?p=(i-s)/m+2:p=(s-l)/m+4,p=Math.round(p*60),p<0&&(p+=360));const g=(c+f)/2,y=m===0?0:m/(1-Math.abs(2*g-1));return{h:p,s:y,l:g}}function tS(n,o,s,l={},i={}){const c=(S,j)=>{const C=i[j];return C?!!S[C]:!!S[j]},f=(S,j,C)=>{const T=i[j];return T?S[T]??C:S[j]??C},m=new Map(o.nodes.map(S=>[S.id,S])),p=o.groups??[],g=o.definitions?.subgraphs??[],y=new Map(g.map(S=>[S.id,S])),x=new Map(p.map(S=>[S.id,S])),w=new Map;for(const S of g){const j=new Map;for(const C of S.groups??[])j.set(C.id,C);w.set(S.id,j)}const k=(S,j,C=new Set,T=new Set)=>{let V=0;for(const U of S)if(U.type==="node"){const R=cn({type:"node",nodeId:U.id,subgraphId:j});c(l,R)||(V+=1)}else if(U.type==="hiddenBlock"){const R=n.hiddenBlocks[U.blockId]??[];V+=R.filter(z=>{const L=cn({type:"node",nodeId:z,subgraphId:j});return!c(l,L)}).length}else if(U.type==="group"){if(C.has(U.stableKey))continue;C.add(U.stableKey),V+=k(n.groups[U.stableKey]??[],j,C,T),C.delete(U.stableKey)}else if(U.type==="subgraph"){if(T.has(U.id))continue;T.add(U.id),V+=k(n.subgraphs[U.id]??[],U.id,C,T),T.delete(U.id)}return V},N=(S,j,C,T=new Set,V=new Set)=>{const U=[];for(const R of S){if(R.type==="hiddenBlock"){const ue=n.hiddenBlocks[R.blockId]??[];if(ue.length===0)continue;U.push({type:"hiddenBlock",blockId:R.blockId,nodeIds:ue,count:ue.length});continue}if(R.type==="node"){const ue=cn({type:"node",nodeId:R.id,subgraphId:C});if(c(l,ue))continue;const pe=m.get(R.id);if(!pe)continue;U.push({type:"node",node:pe,groupId:j,subgraphId:C});continue}if(R.type==="group"){if(c(l,R.stableKey)||T.has(R.stableKey))continue;let ue;if(C&&(ue=w.get(C)?.get(R.id)),ue??=x.get(R.id),!ue)for(const Ie of w.values()){const Ae=Ie.get(R.id);if(Ae){ue=Ae;break}}if(!ue)continue;const pe=n.groups[R.stableKey]??[],fe=f(s,R.stableKey,!1);T.add(R.stableKey);const Re=fe?[]:N(pe,R.id,C,T,V);T.delete(R.stableKey),U.push({type:"group",group:ue,stableKey:R.stableKey,nodeCount:k(pe,C),isCollapsed:fe,subgraphId:C,children:Re});continue}if(c(l,cn({type:"subgraph",subgraphId:R.id}))||V.has(R.id))continue;const z=y.get(R.id);if(!z)continue;const L=n.subgraphs[R.id]??[],$=f(s,cn({type:"subgraph",subgraphId:R.id}),!1);V.add(R.id);const Y=$?[]:N(L,null,R.id,T,V);V.delete(R.id),U.push({type:"subgraph",subgraph:z,nodeCount:k(L,R.id),isCollapsed:$,groupId:j,children:Y})}return U};return N(n.root,null,null)}function Ro(n,o){const s=ba(n);if(!s)return kt.transparentBlack;const l=s.slice(1),i=parseInt(l.slice(0,2),16),c=parseInt(l.slice(2,4),16),f=parseInt(l.slice(4,6),16);return`rgba(${i}, ${c}, ${f}, ${o})`}function P0({containerKey:n,indexLabel:o,targetKey:s,height:l}){return u.jsx("div",{"data-reposition-placeholder":"true",className:"mb-3",style:{height:`${l}px`}},`placeholder-${n}-${o}-${s}`)}function Y0({containerType:n,containerDataKey:o,dataKey:s,title:l,nodeCount:i,isTarget:c,isCollapsed:f,canToggleCollapse:m,isDragging:p,isDropTarget:g,isHighlighted:y,backgroundColor:x,borderColor:w,headerBackgroundColor:k,onToggleCollapse:N,childrenContent:S}){const j=`${i} node${i!==1?"s":""}${n==="subgraph"?" (subgraph)":""}`;return u.jsxs("div",{"data-container-type":n,className:`rounded-xl mb-3 shadow-md ${p?"overflow-visible":"overflow-hidden"} transition-shadow ${c?"border-blue-500 border-2 ring-2 ring-blue-400":"border"} ${y&&!c?"ring-2 ring-blue-500 transition-all":""} ${g?"ring-2 ring-blue-300 ring-dashed":""}`,style:{backgroundColor:x,borderColor:w,...c?{touchAction:"none"}:{},...c?{animation:p?"none":"node-card-wiggle 180ms ease-in-out infinite alternate"}:{}},"data-reposition-item":s,children:[u.jsxs("div",{"data-reposition-header":o,className:`flex items-center justify-between cursor-pointer gap-1 px-3 py-2 ${f?"rounded-xl":"rounded-t-xl mb-2"}`,style:{backgroundColor:k,borderColor:w},onClick:C=>{m&&(C.stopPropagation(),N())},children:[u.jsx("span",{"data-reposition-handle":s,className:"touch-none w-8 h-8 -ml-2 flex items-center justify-center shrink-0",children:u.jsx(fp,{className:`w-5 h-5 ${c?"text-blue-500":"text-gray-500"}`})}),u.jsx("span",{className:"font-semibold text-gray-900 flex-1 min-w-0 truncate",children:l}),u.jsx("span",{className:"ml-auto text-sm shrink-0 text-gray-500",children:j}),f?u.jsx(gs,{className:`w-6 h-6 shrink-0 ${m?"text-gray-500":"text-gray-500 opacity-50"}`}):u.jsx(Jn,{className:"w-6 h-6 shrink-0 text-gray-500"})]}),S,!f&&u.jsx("div",{"data-reposition-footer":o,className:`px-3 py-1.5 rounded-b-xl select-none ${m?"cursor-pointer":""}`,style:{backgroundColor:k,borderColor:w},onClick:C=>{m&&(C.stopPropagation(),N())},children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{className:"text-xs flex-1 min-w-0 truncate text-gray-500",children:l}),u.jsxs("div",{className:"ml-auto flex items-center gap-1",children:[u.jsx("span",{className:"text-xs shrink-0 text-gray-500",children:j}),u.jsx(Jn,{className:`w-6 h-6 shrink-0 rotate-180 ${m?"text-gray-500":"text-gray-500 opacity-50"}`})]})]})})]})}function nS({blockId:n,nodeCount:o}){return u.jsxs("div",{className:"bg-gray-200 rounded-lg px-3 py-2 mb-3 text-sm text-gray-500 text-center","data-reposition-item":`hidden-${n}`,children:[o," hidden node",o!==1?"s":""]},`hidden-${n}`)}function oS({dataKey:n,nodeId:o,displayName:s,isTarget:l,isBypassed:i,isDragging:c,borderClass:f,borderStyle:m,isHighlighted:p}){return u.jsxs("div",{className:`flex min-h-10 items-center gap-1 rounded-xl border-2 px-3 py-1 mb-3 shadow-md select-none ${f} ${i?"bg-purple-200":"bg-white"} ${p&&!l?"ring-2 ring-blue-500 transition-all":""}`,style:l?{...m??{},touchAction:"none",animation:c?"none":"node-card-wiggle 180ms ease-in-out infinite alternate"}:m,"data-reposition-item":n,children:[u.jsx("span",{"data-reposition-handle":n,className:"touch-none flex h-8 w-8 items-center justify-center -ml-2 shrink-0",children:u.jsx(fp,{className:`w-5 h-5 ${l?"text-blue-500":"text-gray-300"}`})}),u.jsx("span",{className:"font-semibold min-w-0 flex-1 truncate text-gray-900",children:s}),u.jsxs("span",{className:"text-xs text-gray-400 shrink-0",children:["#",o]})]},n)}const rS={secondary:"bg-white border border-gray-300 text-gray-700",primary:"bg-blue-600 text-white",danger:"bg-red-600 text-white"};function vb({actions:n,zIndex:o}){return u.jsx("div",{className:"fixed bottom-6 left-0 right-0 flex justify-center gap-4 px-4",style:{zIndex:o,paddingBottom:"env(safe-area-inset-bottom)"},children:n.map(s=>{const l=s.variant??"secondary";return u.jsx("button",{type:"button",className:`px-5 py-2.5 rounded-full text-sm font-medium shadow-lg disabled:opacity-50 disabled:cursor-not-allowed ${rS[l]}`,onClick:s.onClick,disabled:s.disabled,children:s.label},s.key)})})}function sS({nodeId:n,canShowConnectionsToggle:o,connectionHighlightEnabled:s,onToggleConnections:l,connectionMode:i,leftLineCount:c,rightLineCount:f,inputHighlightColor:m,outputHighlightColor:p}){return u.jsx("div",{className:"bg-white border-b border-gray-200",style:{height:"var(--top-bar-offset, 69px)"},children:u.jsxs("div",{className:"h-full px-4 flex items-center justify-between",children:[u.jsx("div",{className:"w-10 h-10"}),u.jsx("h2",{className:"text-lg font-semibold text-gray-900 text-center",children:"Reposition Nodes"}),u.jsx("div",{className:"w-10 h-10 flex items-center justify-center",children:o&&u.jsx("button",{type:"button",className:"w-8 h-8 flex items-center justify-center","aria-label":"Highlight node connections","aria-pressed":s,onClick:l,children:u.jsx(hb,{className:"w-6 h-6 overflow-visible",nodeId:n,connectionHighlightMode:i,leftLineCount:c,rightLineCount:f,inactiveColor:kt.text.secondary,offLineColor:kt.text.secondary,inputHighlightColor:m,outputHighlightColor:p})})})]})})}function lS({scrollContainerRef:n,isDragging:o,isPointerArmedForDrag:s,onPointerDown:l,onPointerMove:i,onPointerUp:c,onPointerCancel:f,children:m}){return u.jsx("div",{ref:n,className:"flex-1 overflow-auto px-4 pt-4 pb-40",style:{touchAction:o||s?"none":"pan-y"},onPointerDown:l,onPointerMove:i,onPointerUp:c,onPointerCancel:f,children:m})}function uu(n,o,s){const l=(i,c)=>{for(const f of i){if(f.type==="group"){if(f.id===o&&c===s)return f.stableKey;const m=l(n.groups[f.stableKey]??[],c);if(m)return m;continue}if(f.type==="subgraph"){const m=l(n.subgraphs[f.id]??[],f.id);if(m)return m}}return null};return l(n.root,null)}function of(n,o){if(n.type==="node")return`node-${n.id}`;if(n.type==="group"){const s=o?uu(o,n.id,n.subgraphId??null):null;return s?`group-${s}`:`group-${cn({type:"group",groupId:n.id,subgraphId:n.subgraphId??null})}`}return`subgraph-${n.id}`}function aS(n){return n.type==="node"?`node-${n.id}`:n.type==="group"?`group-${n.stableKey}`:n.type==="subgraph"?`subgraph-${n.id}`:`hidden-${n.blockId}`}function Zs(n,o){return n.scope!==o.scope?!1:n.scope==="root"?!0:n.scope==="group"&&o.scope==="group"?n.groupKey===o.groupKey:n.scope==="subgraph"&&o.scope==="subgraph"?n.subgraphId===o.subgraphId:!1}function Zi(n){return n.scope==="root"?"root":n.scope==="group"?`group-${n.groupKey}`:`subgraph-${n.subgraphId}`}function iS(n){return{groupKeys:Object.keys(n.groups),subgraphIds:Object.keys(n.subgraphs)}}function Q0(n,o,s){const l=[];return o.forEach((i,c)=>{if(i===s)return;const f=n.querySelector(`[data-reposition-item="${i}"]`);if(!f)return;const m=f.getBoundingClientRect();l.push({idx:c,top:m.top,bottom:m.bottom,height:m.height})}),l}function uS(n,o,s){const l=Math.max(n.top,o.top),i=Math.min(n.bottom,o.bottom);return Math.max(0,i-l)>=n.height*s}function X0(n,o,s,l,i,c){if(!(n.bottom>=o.top&&n.top<=o.bottom))return!1;if(!s||!l)return uS(n,o,c);if(i){const g=n.bottom>s.top+s.height*c,y=n.bottom>l.top+l.height*c;return g&&!y}const m=n.top<l.bottom-l.height*c,p=n.top<s.bottom-s.height*c;return m&&!p}function Z0(n,o,s,l,i){if(n.length===0)return 0;if(o){let f=0;for(const m of n){const p=m.top+m.height*i;if(l>p){f=m.idx+1;continue}break}return f}let c=n.length;for(let f=n.length-1;f>=0;f-=1){const m=n[f],p=m.bottom-m.height*i;if(s<p){c=m.idx;continue}break}return c}const J0=5,Ji=.625,rf=kt.status.success,sf=kt.status.warning,cS=kt.status.danger,eu=kt.brand.blue500;function dS({mobileLayout:n,initialTarget:o,initialViewportAnchor:s=null,onDone:l,onCancel:i}){const c=ae(ye=>ye.workflow),f=ae(ye=>ye.nodeTypes),m=ae(ye=>ye.executingNodeId),p=ae(ye=>ye.collapsedItems),g=ae(ye=>ye.stableKeyByPointer),y=sn(ye=>ye.nodeErrors),x=b.useCallback(ye=>g[ye]??ye,[g]),[w,k]=b.useState(()=>JSON.parse(JSON.stringify(n))),[N,S]=b.useState(!1),[j,C]=b.useState(o),[T,V]=b.useState(null),[U,R]=b.useState(null),[z,L]=b.useState(!1),$=b.useRef(null),Y=b.useRef(0),ue=b.useRef(0),pe=b.useRef(0),fe=b.useRef(!0),Re=b.useRef(-1),Ie=b.useRef(null),Ae=b.useRef(0),_=b.useRef(0),se=b.useRef(0),ce=b.useRef(null),Ue=b.useRef(null),De=b.useRef(null),E=b.useRef(null),A=b.useRef(!1),O=b.useRef(!1),te=b.useRef(!1),Le=b.useRef(null),[We,xe]=b.useState(null),[Se,H]=b.useState(()=>{const ye={...p??{}};if(o.type==="group"){const Q=uu(n,o.id,o.subgraphId??null);Q&&(ye[Q]=!0)}return o.type==="subgraph"&&(ye[x(cn({type:"subgraph",subgraphId:o.id}))]=!0),ye}),[P,D]=b.useState(null),[K,Z]=b.useState(null),q=b.useMemo(()=>of(j,w),[j,w]),Ee=P===q,je=b.useMemo(()=>{const ye=j.type==="node"?{type:"node",id:j.id}:j.type==="group"?(()=>{const de=uu(w,j.id,j.subgraphId??null);return de?{type:"group",id:j.id,subgraphId:j.subgraphId??null,stableKey:de}:null})():{type:"subgraph",id:j.id};if(!ye)return{groupIds:new Set,subgraphIds:new Set};const Q=(de,Oe)=>de.type!==Oe.type?!1:de.type==="node"&&Oe.type==="node"?de.id===Oe.id:de.type==="group"&&Oe.type==="group"?de.stableKey===Oe.stableKey:de.type==="subgraph"&&Oe.type==="subgraph"?de.id===Oe.id:de.type==="hiddenBlock"&&Oe.type==="hiddenBlock"?de.blockId===Oe.blockId:!1,re=(de,Oe,Ke)=>{for(const we of de){if(Q(we,ye))return{groupIds:new Set(Oe),subgraphIds:new Set(Ke)};if(we.type==="group"){const it=re(w.groups[we.stableKey]??[],[...Oe,we.stableKey],Ke);if(it)return it}else if(we.type==="subgraph"){const it=re(w.subgraphs[we.id]??[],Oe,[...Ke,we.id]);if(it)return it}}return null};return re(w.root,[],[])??{groupIds:new Set,subgraphIds:new Set}},[w,j]),Ne=b.useMemo(()=>{if(!c||j.type!=="node")return{hasConnections:!1,hasUpstream:!1,hasDownstream:!1,leftLineCount:0,rightLineCount:0,upstreamNodeIds:new Set,downstreamNodeIds:new Set};const ye=c.nodes.find(Ke=>Ke.id===j.id);if(!ye)return{hasConnections:!1,hasUpstream:!1,hasDownstream:!1,leftLineCount:0,rightLineCount:0,upstreamNodeIds:new Set,downstreamNodeIds:new Set};const Q=new Set;ye.inputs.forEach((Ke,we)=>{if(Ke.link==null)return;const it=ll(c,ye.id,we);it&&Q.add(it.node.id)});const re=new Set;ye.outputs.forEach((Ke,we)=>{if(!Ke.links||Ke.links.length===0)return;const it=pa(c,ye.id,we);for(const ot of it)re.add(ot.node.id)}),Q.delete(ye.id),re.delete(ye.id);const de=ye.inputs.filter(Ke=>Ke.link!=null).length,Oe=ye.outputs.reduce((Ke,we)=>Ke+(we.links?.length??0),0);return{hasConnections:de>0||Oe>0,hasUpstream:Q.size>0,hasDownstream:re.size>0,leftLineCount:Math.min(3,de),rightLineCount:Math.min(3,Oe),upstreamNodeIds:Q,downstreamNodeIds:re}},[c,j]),ee=b.useMemo(()=>new Map((c?.nodes??[]).map(ye=>[ye.id,ye])),[c]),Me=b.useMemo(()=>{const ye=new Map;for(const re of c?.groups??[])ye.set(re.id,re);const Q=new Map;for(const re of c?.definitions?.subgraphs??[]){const de=new Map;for(const Oe of re.groups??[])de.set(Oe.id,Oe);Q.set(re.id,de)}return{rootMap:ye,bySubgraph:Q}},[c]),I=b.useMemo(()=>new Map((c?.definitions?.subgraphs??[]).map(ye=>[ye.id,ye])),[c]),B=b.useMemo(()=>{const ye=new Map,Q=new Set,re=new Set,de=(Oe,Ke)=>{for(const we of Oe){if(we.type==="group"){if(ye.set(we.stableKey,{id:we.id,subgraphId:Ke}),Q.has(we.stableKey))continue;Q.add(we.stableKey),de(w.groups[we.stableKey]??[],Ke);continue}if(we.type==="subgraph"){if(re.has(we.id))continue;re.add(we.id),de(w.subgraphs[we.id]??[],we.id)}}};return de(w.root,null),ye},[w]);b.useEffect(()=>{const ye=of(j,w);let Q=null;return A.current?A.current=!1:requestAnimationFrame(()=>{const re=E.current,de=re?.querySelector(`[data-reposition-item="${ye}"]`);if(!de)return;const Oe=!O.current;if(Oe&&!te.current&&s&&re){const it=de.getBoundingClientRect().top-s.viewportTop;Math.abs(it)>.5&&(re.scrollTop+=it),te.current=!0,O.current=!0;return}const Ke=Oe?"auto":"smooth";de.scrollIntoView({behavior:Ke,block:"center"}),O.current=!0}),Q=requestAnimationFrame(()=>{xe(ye)}),Le.current!=null&&window.clearTimeout(Le.current),Le.current=window.setTimeout(()=>{xe(null),Le.current=null},1500),()=>{Q!=null&&window.cancelAnimationFrame(Q),Le.current!=null&&window.clearTimeout(Le.current)}},[j,s,w]);const W=b.useCallback(ye=>{if(ye.startsWith("node-")){const Q=parseInt(ye.slice(5),10);return Number.isFinite(Q)?{target:{type:"node",id:Q},itemRef:{type:"node",id:Q}}:null}if(ye.startsWith("group-")){const Q=ye.slice(6),re=B.get(Q);if(!re)return null;const{id:de,subgraphId:Oe}=re;return{target:{type:"group",id:de,subgraphId:Oe},itemRef:{type:"group",id:de,subgraphId:Oe,stableKey:Q}}}if(ye.startsWith("subgraph-")){const Q=ye.slice(9);return{target:{type:"subgraph",id:Q},itemRef:{type:"subgraph",id:Q}}}return null},[B]),be=b.useCallback(ye=>{const re=ye.target.closest("[data-reposition-item]")?.dataset.repositionItem??null,Ke=ye.target.closest("[data-reposition-handle]")?.dataset.repositionHandle??null??(re===q?q:null);if(!Ke)return;const we=W(Ke);if(!we)return;const it=rb(w,we.itemRef);if(!it)return;if(ye.preventDefault(),Ke!==q){const pt=we.target;if(pt.type==="group"){const St=uu(w,pt.id,pt.subgraphId??null);if(!St)return;H(yt=>({...yt,[St]:!0}))}else if(pt.type==="subgraph"){const St=pt.id;H(yt=>({...yt,[x(cn({type:"subgraph",subgraphId:St}))]:!0}))}A.current=!0,C(we.target)}const ot=we.itemRef.type==="node"||we.itemRef.type==="group",tt=ot?iS(w):{groupKeys:[],subgraphIds:[]},lt=new Set,wt=new Set;if(we.itemRef.type==="group"){const pt=St=>{for(const yt of St){if(yt.type==="group"){lt.has(yt.stableKey)||(lt.add(yt.stableKey),pt(w.groups[yt.stableKey]??[]));continue}yt.type==="subgraph"&&(wt.has(yt.id)||(wt.add(yt.id),pt(w.subgraphs[yt.id]??[])))}};lt.add(we.itemRef.stableKey),pt(w.groups[we.itemRef.stableKey]??[])}$.current={pointerId:ye.pointerId,startX:ye.clientX,startY:ye.clientY,origIndex:it.index,containerId:it.containerId,targetKey:Ke,targetRef:we.itemRef,target:we.target,allGroupKeys:tt.groupKeys,allSubgraphIds:tt.subgraphIds,crossContainerEnabled:ot,disallowedGroupKeys:lt,disallowedSubgraphIds:wt},Y.current=0,Re.current=it.index,Ie.current=it.containerId,pe.current=ye.clientY,fe.current=!0,L(!0),E.current&&(E.current.style.touchAction="none")},[w,q,W,x]),me=b.useCallback((ye,Q,re,de)=>{if(!Q.crossContainerEnabled)return Q.containerId;let Oe={scope:"root"},Ke=1/0;for(const we of Q.allGroupKeys){if(Q.targetRef.type==="group"&&Q.targetRef.stableKey===we||Q.disallowedGroupKeys.has(we)||(Se[we]??!1))continue;const it=`group-${we}`,ot=ye.querySelector(`[data-reposition-item="${it}"]`);if(!ot)continue;const tt=ot.getBoundingClientRect(),lt=ot.querySelector(`[data-reposition-header="${it}"]`),wt=ot.querySelector(`[data-reposition-footer="${it}"]`),pt=lt?.getBoundingClientRect()??null,St=wt?.getBoundingClientRect()??null;if(!X0(re,tt,pt,St,de,Ji))continue;const yt=tt.width*tt.height;yt<Ke&&(Ke=yt,Oe={scope:"group",groupKey:we})}for(const we of Q.allSubgraphIds){if(Q.targetRef.type==="subgraph"&&Q.targetRef.id===we||Q.disallowedSubgraphIds.has(we)||(Se[x(cn({type:"subgraph",subgraphId:we}))]??!1))continue;const it=ye.querySelector(`[data-reposition-item="subgraph-${we}"]`);if(!it)continue;const ot=it.getBoundingClientRect(),tt=it.querySelector(`[data-reposition-header="subgraph-${we}"]`),lt=it.querySelector(`[data-reposition-footer="subgraph-${we}"]`),wt=tt?.getBoundingClientRect()??null,pt=lt?.getBoundingClientRect()??null;if(!X0(re,ot,wt,pt,de,Ji))continue;const St=ot.width*ot.height;St<Ke&&(Ke=St,Oe={scope:"subgraph",subgraphId:we})}return Oe},[Se,x]),ke=b.useCallback((ye,Q,re,de,Oe)=>{const we=Tw(w,re).map(aS);if(Zs(re,Q.containerId)){const tt=we.filter(pt=>pt!==Q.targetKey),lt=Q0(ye,tt),wt=Z0(lt,Oe,de.top,de.bottom,Ji);return wt<=Q.origIndex?wt:wt+1}const ot=Q0(ye,we);return Z0(ot,Oe,de.top,de.bottom,Ji)},[w]),F=b.useCallback((ye,Q,re,de)=>{Z(Oe=>{const Ke={targetKey:ye.targetKey,sourceContainer:ye.containerId,sourceIndex:ye.origIndex,hoverContainer:Q,insertIndex:re,placeholderHeight:de};return Oe&&Oe.targetKey===Ke.targetKey&&Zs(Oe.sourceContainer,Ke.sourceContainer)&&Oe.sourceIndex===Ke.sourceIndex&&Zs(Oe.hoverContainer,Ke.hoverContainer)&&Oe.insertIndex===Ke.insertIndex&&Oe.placeholderHeight===Ke.placeholderHeight?Oe:Ke})},[]),ie=b.useCallback(ye=>{const Q=$.current;if(!Q||ye.pointerId!==Q.pointerId)return;const re=ye.clientY-Q.startY,de=ye.clientX-Q.startX;if(!N){if(Math.abs(de)>Math.abs(re)&&Math.abs(de)>J0){$.current=null,L(!1),E.current&&(E.current.style.touchAction="");return}if(Math.abs(re)<J0)return;S(!0);const yt=E.current;if(yt){const ht=yt.querySelector(`[data-reposition-item="${Q.targetKey}"]`);if(ht){const Tt=ht.getBoundingClientRect();Ae.current=Tt.top,_.current=Tt.left,se.current=ht.offsetHeight||Tt.height,ht.style.position="fixed",ht.style.top=`${Tt.top}px`,ht.style.left=`${Tt.left}px`,ht.style.width=`${Tt.width}px`,ht.style.zIndex="70",ht.style.pointerEvents="none",Z({targetKey:Q.targetKey,sourceContainer:Q.containerId,sourceIndex:Q.origIndex,hoverContainer:Q.containerId,insertIndex:Q.origIndex,placeholderHeight:se.current})}}try{E.current?.setPointerCapture(ye.pointerId)}catch{}pe.current=ye.clientY,fe.current=re>=0;return}Y.current=re,ue.current=de;const Oe=E.current;if(!Oe)return;const Ke=Oe.querySelector(`[data-reposition-item="${Q.targetKey}"]`);Ke&&(Ke.style.top=`${Ae.current+re}px`,Ke.style.left=`${_.current}px`);const we=Ke?.getBoundingClientRect();if(!we)return;const it=se.current||Ke?.offsetHeight||we.height,ot=ye.clientY-pe.current;ot!==0&&(fe.current=ot>0);const tt=fe.current;pe.current=ye.clientY;const lt=me(Oe,Q,we,tt);Ie.current=lt;const wt=Zs(lt,Q.containerId),pt=lt.scope==="group"?`group-${lt.groupKey}`:lt.scope==="subgraph"?`subgraph-${lt.subgraphId}`:null,St=lt.scope==="group"?Se[lt.groupKey]??!1:lt.scope==="subgraph"?Se[x(cn({type:"subgraph",subgraphId:lt.subgraphId}))]??!1:!1;pt&&St&&!wt?Ue.current!==pt&&(ce.current!=null&&window.clearTimeout(ce.current),Ue.current=pt,ce.current=window.setTimeout(()=>{const yt=Ie.current;yt&&(yt.scope==="group"?H(ht=>({...ht,[yt.groupKey]:!1})):yt.scope==="subgraph"&&H(ht=>({...ht,[x(cn({type:"subgraph",subgraphId:yt.subgraphId}))]:!1})),ce.current=null)},350)):ce.current!=null&&(window.clearTimeout(ce.current),ce.current=null,Ue.current=null),V(!wt&&lt.scope==="group"?lt.groupKey:null),R(!wt&&lt.scope==="subgraph"?lt.subgraphId:null),Re.current=ke(Oe,Q,lt,we,tt),F(Q,lt,Re.current,it)},[N,me,ke,F,Se,x]),_e=b.useCallback(()=>{const ye=E.current;if(!ye)return;ye.querySelectorAll("[data-reposition-item]").forEach(re=>{re.style.transform="",re.style.zIndex="",re.style.position="",re.style.top="",re.style.left="",re.style.width="",re.style.pointerEvents="",re.style.transition="",re.style.marginTop=""})},[]),$e=b.useCallback(ye=>{const Q=$.current;if(Q&&ye.pointerId===Q.pointerId){if(N){try{E.current?.releasePointerCapture(ye.pointerId)}catch{}_e(),ce.current!=null&&(window.clearTimeout(ce.current),ce.current=null),Ue.current=null;const re=Ie.current??Q.containerId,de=Re.current;if(!Zs(re,Q.containerId)||de!==Q.origIndex){const Ke=Ow(w,Q.targetRef,Q.containerId,Q.origIndex,re,de);k(Ke),De.current=Q.target}S(!1),V(null),R(null),Z(null)}$.current=null,Y.current=0,ue.current=0,Re.current=-1,Ie.current=null,Ae.current=0,_.current=0,se.current=0,pe.current=0,fe.current=!0,L(!1),E.current&&(E.current.style.touchAction="")}},[N,w,_e]),Ze=b.useCallback(ye=>{if($.current){if(N){try{E.current?.releasePointerCapture(ye.pointerId)}catch{}_e(),ce.current!=null&&(window.clearTimeout(ce.current),ce.current=null),Ue.current=null,S(!1),V(null),R(null),Z(null)}$.current=null,Y.current=0,ue.current=0,Re.current=-1,Ie.current=null,Ae.current=0,_.current=0,se.current=0,pe.current=0,fe.current=!0,L(!1),E.current&&(E.current.style.touchAction="")}},[N,_e]);b.useEffect(()=>()=>{ce.current!=null&&window.clearTimeout(ce.current)},[]);const Ge=()=>{const ye=De.current??j,Q=E.current?.querySelector(`[data-reposition-item="${of(ye,w)}"]`),re=Q?{viewportTop:Q.getBoundingClientRect().top}:null;l(w,ye,re)},nt=ye=>{H(Q=>{const re=Q[ye]??!1;return{...Q,[ye]:!re}})},Ye=ye=>{const Q=x(cn({type:"subgraph",subgraphId:ye}));H(re=>{const de=re[Q]??!1;return{...re,[Q]:!de}})},Fe=ye=>{const Q=ee.get(ye);return Q?(typeof Q.title=="string"&&Q.title.trim()?Q.title.trim():null)||f?.[Q.type]?.display_name||Q.type:`Node #${ye}`},st=ye=>{if(q===`node-${ye}`)return"";const Q=ee.get(ye);return Q?y[String(ye)]?.length>0?"border-red-700 shadow-red-200":m===String(ye)?"border-green-500 shadow-green-200":Q.mode===4?"border-purple-300":"border-transparent":"border-transparent"},ft=ye=>ee.get(ye)?.mode===4;function Nt(ye){let Q=0;for(const re of ye)re.type==="node"?Q+=1:re.type==="hiddenBlock"?Q+=w.hiddenBlocks[re.blockId]?.length??0:re.type==="group"?Q+=Nt(w.groups[re.stableKey]??[]):re.type==="subgraph"&&(Q+=Nt(w.subgraphs[re.id]??[]));return Q}const Ht=(ye,Q)=>{const re=[],de=K!=null&&Zs(Q,K.hoverContainer);let Oe=-1;de&&K&&(Oe=K.insertIndex,Oe<0&&(Oe=0),Oe>ye.length&&(Oe=ye.length));const Ke=we=>{!de||!K||Oe===we&&re.push(u.jsx(P0,{containerKey:Zi(Q),indexLabel:String(we),targetKey:K.targetKey,height:K.placeholderHeight},`placeholder-${Zi(Q)}-${we}-${K.targetKey}`))};return ye.forEach((we,it)=>{if(Ke(it),we.type==="hiddenBlock"){const ot=w.hiddenBlocks[we.blockId]??[];re.push(u.jsx(nS,{blockId:we.blockId,nodeCount:ot.length},`hidden-${we.blockId}`));return}if(we.type==="node"){const ot=`node-${we.id}`,tt=ot===q,lt=ft(we.id),wt=Ee&&Ne.hasConnections,pt=wt&&Ne.upstreamNodeIds.has(we.id),St=wt&&Ne.downstreamNodeIds.has(we.id),yt=tt?"border-blue-500 ring-2 ring-blue-400":pt||St?"":st(we.id),ht={},Tt="7px";wt&&(tt?(ht.borderTopColor=eu,ht.borderBottomColor=eu,ht.borderLeftColor=Ne.hasUpstream?rf:eu,ht.borderRightColor=Ne.hasDownstream?sf:eu,Ne.hasUpstream&&(ht.borderLeftWidth=Tt),Ne.hasDownstream&&(ht.borderRightWidth=Tt)):(pt||St)&&(ht.borderColor=cS,pt&&(ht.borderRightColor=rf,ht.borderRightWidth=Tt),St&&(ht.borderLeftColor=sf,ht.borderLeftWidth=Tt))),re.push(u.jsx(oS,{dataKey:ot,nodeId:we.id,displayName:Fe(we.id),isTarget:tt,isBypassed:lt,isDragging:N,borderClass:yt,borderStyle:Object.keys(ht).length>0?ht:void 0,isHighlighted:We===ot},ot));return}if(we.type==="group"){const ot=B.get(we.stableKey),tt=ot?.subgraphId==null?Me.rootMap.get(we.id):Me.bySubgraph.get(ot.subgraphId)?.get(we.id);if(!tt)return null;const lt=`group-${we.stableKey}`,wt=lt===q,pt=Se[we.stableKey]??!1,St=je.groupIds.has(we.stableKey),yt=!wt&&!St,ht=Ro(tt.color,.15),Tt=wt?void 0:Ro(tt.color,.4),Et=tt.title?.trim()||`Group ${we.id}`,Yt=w.groups[we.stableKey]??[],Gt=Nt(Yt),It=T===we.stableKey;re.push(u.jsx(Y0,{containerType:"group",containerDataKey:lt,dataKey:lt,title:Et,nodeCount:Gt,isTarget:wt,isCollapsed:pt,canToggleCollapse:yt,isDragging:N,isDropTarget:It,isHighlighted:We===lt,backgroundColor:ht,borderColor:Tt,headerBackgroundColor:Ro(tt.color,.22),onToggleCollapse:()=>nt(we.stableKey),childrenContent:!pt&&Yt.length>0?u.jsx("div",{className:"px-1",children:Ht(Yt,{scope:"group",groupKey:we.stableKey})}):null},lt));return}if(we.type==="subgraph"){const ot=I.get(we.id);if(!ot)return null;const tt=`subgraph-${we.id}`,lt=tt===q,wt=Se[x(cn({type:"subgraph",subgraphId:we.id}))]??!1,pt=je.subgraphIds.has(we.id),St=!lt&&!pt,yt=ot.name||ot.id,ht=w.subgraphs[we.id]??[],Tt=Nt(ht),Et=U===we.id;re.push(u.jsx(Y0,{containerType:"subgraph",containerDataKey:`subgraph-${we.id}`,dataKey:tt,title:yt,nodeCount:Tt,isTarget:lt,isCollapsed:wt,canToggleCollapse:St,isDragging:N,isDropTarget:Et,isHighlighted:We===tt,backgroundColor:kt.brand.subgraphBackground08,borderColor:lt?void 0:kt.brand.subgraphBorder25,headerBackgroundColor:kt.brand.subgraphBackground14,onToggleCollapse:()=>Ye(we.id),childrenContent:!wt&&ht.length>0?u.jsx("div",{className:"px-1",children:Ht(ht,{scope:"subgraph",subgraphId:we.id})}):null},tt));return}}),de&&K&&Oe===ye.length&&re.push(u.jsx(P0,{containerKey:Zi(Q),indexLabel:"end",targetKey:K.targetKey,height:K.placeholderHeight},`placeholder-${Zi(Q)}-end-${K.targetKey}`)),re},Vt=b.useRef(null);return b.useEffect(()=>{const ye=Vt.current;if(!ye)return;const Q=re=>re.stopPropagation();return ye.addEventListener("touchstart",Q,!0),ye.addEventListener("touchmove",Q,!0),ye.addEventListener("touchend",Q,!0),ye.addEventListener("touchcancel",Q,!0),()=>{ye.removeEventListener("touchstart",Q,!0),ye.removeEventListener("touchmove",Q,!0),ye.removeEventListener("touchend",Q,!0),ye.removeEventListener("touchcancel",Q,!0)}},[]),Mn.createPortal(u.jsxs("div",{ref:Vt,className:"fixed inset-0 z-[2300] bg-gray-100 flex flex-col",children:[u.jsx(sS,{nodeId:j.type==="node"?j.id:0,canShowConnectionsToggle:j.type==="node"&&Ne.hasConnections,connectionHighlightEnabled:Ee,onToggleConnections:()=>D(ye=>ye===q?null:q),connectionMode:Ee?Ne.hasUpstream&&Ne.hasDownstream?"both":Ne.hasUpstream?"inputs":"outputs":"off",leftLineCount:Ne.leftLineCount,rightLineCount:Ne.rightLineCount,inputHighlightColor:rf,outputHighlightColor:sf}),u.jsxs(lS,{scrollContainerRef:E,isDragging:N,isPointerArmedForDrag:z,onPointerDown:be,onPointerMove:ie,onPointerUp:$e,onPointerCancel:Ze,children:[Ht(w.root,{scope:"root"}),u.jsx("div",{"data-reposition-footer":"root",className:"h-10"})]}),u.jsx(vb,{zIndex:2301,actions:[{key:"cancel",label:"Cancel",onClick:i,variant:"secondary"},{key:"done",label:"Done",onClick:Ge,variant:"primary"}]})]}),document.body)}function _f(n,o,s){const l=s?.parentHidden??!1,i=s?.parentSubgraphId??null,c=s?.visitedGroups??new Set,f=s?.visitedSubgraphs??new Set,m=s?.hiddenNodeKeys??new Set,p=s?.hiddenGroupKeys??new Set,g=s?.hiddenSubgraphIds??new Set,{layout:y,hiddenItems:x,stableKeyByPointer:w}=o,k=(S,j)=>{const C=w[j];return C?!!S[C]:!!S[j]};let N=0;for(const S of n){if(S.type==="node"){const V=cn({type:"node",nodeId:S.id,subgraphId:i});(l||k(x,V))&&(N+=1),k(x,V)&&m.add(V);continue}if(S.type==="hiddenBlock"){const V=y.hiddenBlocks[S.blockId]??[];for(const U of V){const R=cn({type:"node",nodeId:U,subgraphId:i});(l||k(x,R))&&(N+=1),k(x,R)&&m.add(R)}continue}if(S.type==="group"){if(c.has(S.stableKey))continue;const V=l||k(x,S.stableKey);k(x,S.stableKey)&&p.add(S.stableKey),c.add(S.stableKey);const U=_f(y.groups[S.stableKey]??[],o,{parentHidden:V,parentSubgraphId:i,visitedGroups:c,visitedSubgraphs:f,hiddenNodeKeys:m,hiddenGroupKeys:p,hiddenSubgraphIds:g});N+=U.hiddenNodeCount,c.delete(S.stableKey);continue}if(f.has(S.id))continue;const j=cn({type:"subgraph",subgraphId:S.id}),C=l||k(x,j);k(x,j)&&g.add(S.id),f.add(S.id);const T=_f(y.subgraphs[S.id]??[],o,{parentHidden:C,parentSubgraphId:S.id,visitedGroups:c,visitedSubgraphs:f,hiddenNodeKeys:m,hiddenGroupKeys:p,hiddenSubgraphIds:g});N+=T.hiddenNodeCount,f.delete(S.id)}return{hiddenNodeKeys:m,hiddenGroupKeys:p,hiddenSubgraphIds:g,hiddenNodeCount:N}}function Ma({workflow:n,runKey:o,isRunning:s,workflowDurationStats:l}){const[i,c]=b.useState(null),f=b.useRef(null),m=b.useRef(null),p=b.useRef(null),g=b.useRef(null),y=b.useRef(null),x=b.useRef(0),w=b.useRef(null);return b.useEffect(()=>{let k=null,N=null;const S=()=>{if(!n){w.current!==null&&(w.current=null,c(null)),p.current=null,g.current=null,y.current=null,f.current=null,x.current=0,m.current=null;return}const j=250,C=Date.now();let T=null;if(!o)m.current?(p.current=C+j,m.current=null,x.current=100,T=100):p.current&&C<p.current?T=100:(p.current=null,g.current=null,y.current=null,f.current=null,x.current=0,T=null);else if(p.current&&C<p.current)g.current=o,T=100;else if(g.current&&C>=(p.current??0)&&(m.current=g.current,g.current=null,f.current=C-j,x.current=0,p.current=null),m.current&&o!==m.current)y.current!==o&&(y.current=o,p.current=C+j,x.current=100),T=100;else{m.current!==o&&(f.current=C,m.current=o,x.current=0,p.current=null);const V=Math.max(0,C-(f.current??C)),U=bu(n),R=l[U]?.avgMs??null;let z;if(R){const $=V/R*100;z=Math.min(99,Math.max(0,$))}else{const $=V/1e3;$<=50?z=$:z=50+($-50)*.5,z=Math.min(90,z)}const L=Math.max(x.current,z);x.current=L,T=Math.round(L)}w.current!==T&&(w.current=T,c(T))};return n?(k=setTimeout(S,0),(s||p.current||o)&&(N=setInterval(S,200))):k=setTimeout(S,0),()=>{k&&clearTimeout(k),N&&clearInterval(N)}},[n,o,s,l]),i}function fS(){const n=ae(f=>f.workflowLoadedAt),[o,s]=b.useState(null),l=o===n,i=b.useCallback(f=>{s(f?n:null)},[n]),c=b.useCallback(()=>{s(null)},[]);return{errorPopoverOpen:l,setErrorPopoverOpen:i,resetErrorPopover:c}}const pS=new Set(["mp4","webm","mkv","mov","avi","m4v"]);function Oa(n){const o=n.split(".").pop()?.toLowerCase()??"";return pS.has(o)?"video":"image"}function el(n){return Oa(n)==="video"}function mp({open:n,buttonRef:o,menuRef:s,repositionToken:l,menuWidth:i=176,horizontalAnchorOffset:c=160,viewportPadding:f=8,bottomBarReserve:m=104}){const[p,g]=b.useState(null),y=b.useCallback(()=>{g(null)},[]);return b.useLayoutEffect(()=>{if(!n)return;const x=()=>{const N=o.current,S=s.current;if(!N||!S)return;const j=N.getBoundingClientRect(),C=S.getBoundingClientRect().height,T=j.bottom,V=j.top-C,U=window.innerHeight-m,R=T+C<=U,z=V>=f,$=Math.max(f,Math.min(R?T:z?V:T,U-C)),Y=Math.max(f,Math.min(j.right-c,window.innerWidth-i-f));g({top:$,left:Y})};x();const w=requestAnimationFrame(x),k=requestAnimationFrame(x);return window.addEventListener("resize",x),()=>{cancelAnimationFrame(w),cancelAnimationFrame(k),window.removeEventListener("resize",x)}},[n,o,s,i,c,f,m,l]),{menuPosition:p,menuStyle:{top:p?.top??-9999,left:p?.left??-9999,visibility:p?"visible":"hidden"},resetMenuPosition:y}}function hS({nodeId:n,nodeStableKey:o,isBypassed:s,onEditLabel:l,pinnableWidgets:i,singlePinnableWidget:c,isSingleWidgetPinned:f,hasPinnedWidget:m,toggleWidgetPin:p,setPinnedWidget:g,isNodeBookmarked:y,canAddNodeBookmark:x,onToggleNodeBookmark:w,toggleBypass:k,setItemHidden:N,onDeleteNode:S,onMoveNode:j,connectionHighlightMode:C,setConnectionHighlightMode:T,leftLineCount:V,rightLineCount:U}){const[R,z]=b.useState(!1),[L,$]=b.useState(!1),Y=b.useRef(null),ue=b.useRef(null),pe=()=>{z(!1),$(!1),Re()},{menuStyle:fe,resetMenuPosition:Re}=mp({open:R,buttonRef:ue,menuRef:Y,repositionToken:L});cl({open:R,onDismiss:pe,triggerRef:ue,contentRef:Y,ignoreScrollWithinContent:!0});const Ie=V>0||U>0,Ae=te=>{if(te.stopPropagation(),!o)return;const Le=V>0,We=U>0;if(!Le&&!We)return;const xe=Le&&We?["off","inputs","outputs","both"]:Le?["off","inputs"]:["off","outputs"],Se=xe.indexOf(C),H=xe[(Se+1)%xe.length];T(o,H)},_=te=>{te.stopPropagation(),Re(),z(Le=>!Le)},se=te=>{te.stopPropagation(),l(),pe()},ce=te=>{te.stopPropagation(),o&&(k(o),pe())},Ue=te=>{te.stopPropagation(),o&&(N(o,!0),pe())},De=te=>{te.stopPropagation(),c&&(p(c.widgetIndex,c.name,c.type,c.options),pe())},E=te=>{te.stopPropagation(),g(null),pe()},A=te=>{te.stopPropagation(),$(!L)},O=te=>Le=>{Le.stopPropagation(),g({nodeId:n,widgetIndex:te.widgetIndex,widgetName:te.name,widgetType:te.type,options:te.options}),pe()};return u.jsxs("div",{className:"flex items-center gap-1 relative",onClick:te=>te.stopPropagation(),children:[Ie&&u.jsx("button",{type:"button",className:"w-8 h-8 flex items-center justify-center","aria-pressed":C!=="off","aria-label":"Highlight connected nodes",onClick:Ae,children:u.jsx(hb,{className:"w-6 h-6 overflow-visible",nodeId:n,connectionHighlightMode:C,leftLineCount:V,rightLineCount:U})}),u.jsx(Pr,{onClick:_,buttonRef:ue,ariaLabel:"Node options",buttonSize:8,iconSize:5,icon:y?u.jsx(Gr,{className:"w-5 h-5 text-yellow-500"}):void 0}),R&&Mn.createPortal(u.jsx("div",{ref:Y,className:"fixed z-[1000] w-44",style:fe,children:u.jsx(gr,{items:[{key:"edit-label",label:"Edit Label",icon:u.jsx(cp,{className:"w-4 h-4"}),onClick:se},{key:"toggle-bookmark",label:y?"Remove bookmark":"Bookmark node",icon:y?u.jsx(_u,{className:"w-4 h-4"}):u.jsx(Gr,{className:"w-4 h-4 text-yellow-500"}),onClick:te=>{te.stopPropagation(),w(),pe()},hidden:!(y||x)},{type:"divider",key:"divider-node-actions"},{key:"toggle-bypass",label:s?"Engage node":"Bypass node",icon:u.jsx(Rf,{className:"w-4 h-4",isBypassed:s}),onClick:ce},{key:"hide-node",label:"Hide node",icon:u.jsx(Go,{className:"w-4 h-4"}),onClick:Ue},{key:"move-node",label:"Move",icon:u.jsx(bb,{className:"w-4 h-4"}),onClick:te=>{te.stopPropagation(),j(),pe()}},{type:"divider",key:"divider-pin",className:i.length>0?"":"hidden"},{key:"pin-single-widget",label:f?"Remove pin":"Pin widget",icon:f?u.jsx(ya,{className:"w-4 h-4 text-fuchsia-500"}):u.jsx(Af,{className:"w-4 h-4"}),onClick:De,hidden:!(i.length>0&&c)},{key:"remove-pin",label:"Remove pin",icon:u.jsx(ya,{className:"w-4 h-4 text-fuchsia-500"}),onClick:E,hidden:!(i.length>0&&!c&&m)},{key:"pin-widget-submenu",label:"Pin widget",icon:u.jsx(Af,{className:"w-4 h-4"}),rightSlot:u.jsx(pp,{className:`w-4 h-4 text-gray-400 transition-transform ${L?"rotate-90":""}`}),onClick:A,hidden:!(i.length>0&&!c)},{type:"custom",key:"pin-widget-items",hidden:!(i.length>0&&!c&&L),render:u.jsx("div",{className:"border-t border-gray-100 bg-gray-50 max-h-48 overflow-auto",children:i.map(te=>u.jsx("button",{className:"w-full text-left px-4 py-2 text-sm hover:bg-gray-100 text-gray-700",onClick:O(te),children:te.name},te.widgetIndex))})},{type:"divider",key:"divider-delete"},{key:"delete-node",label:"Delete node",icon:u.jsx(Bo,{className:"w-4 h-4"}),color:"danger",onClick:te=>{te.stopPropagation(),S(),pe()}}]})}),document.body)]})}function mS({nodeId:n,open:o,errors:s,anchorRef:l,onClose:i}){const c=y=>{y.stopPropagation(),i()},[f,m]=b.useState(null),p=b.useRef(null),g=eo(y=>y.currentPanel);return b.useEffect(()=>{o&&g!=="workflow"&&i()},[o,g,i]),b.useEffect(()=>{if(!o)return;const y=()=>{const k=l.current;if(!k)return;const N=k.getBoundingClientRect();m({top:N.bottom+8,left:Math.max(16,Math.min(N.left+N.width/2-140,window.innerWidth-296))})};y();const x=k=>{k.target&&(l.current?.contains(k.target)||p.current?.contains(k.target)||i())},w=()=>{i()};return document.addEventListener("pointerdown",x),document.addEventListener("scroll",w,!0),window.addEventListener("resize",y),()=>{document.removeEventListener("pointerdown",x),document.removeEventListener("scroll",w,!0),window.removeEventListener("resize",y)}},[o,n,i,l]),!o||s.length===0||!f?null:Mn.createPortal(u.jsxs("div",{ref:p,id:`error-popover-${n}`,className:"error-popover-root fixed z-[2000] bg-red-50 border border-red-700 rounded-lg shadow-lg w-72 max-h-64 overflow-hidden",style:{top:f.top,left:f.left},children:[u.jsxs("div",{id:`error-popover-header-${n}`,className:"popover-header flex items-center justify-between px-3 py-2 border-b border-red-200 bg-red-700",children:[u.jsxs("span",{id:`error-popover-title-${n}`,className:"popover-title text-sm font-semibold text-white",children:[s.length," ",s.length===1?"Error":"Errors"]}),u.jsx("button",{type:"button",onClick:c,className:"w-6 h-6 flex items-center justify-center text-red-200 hover:text-white rounded","aria-label":"Close",children:u.jsx(fb,{className:"w-4 h-4"})})]}),u.jsx("div",{id:`error-popover-body-${n}`,className:"popover-body p-3 space-y-2 bg-red-100",children:s.map((y,x)=>{const w=y.details?.toLowerCase().replace(/[_\s]/g,"")||"",k=y.inputName?.toLowerCase().replace(/[_\s]/g,"")||"",N=!y.details||y.details===y.message||y.inputName&&w===k;return u.jsxs("div",{className:"error-item flex items-start gap-2 text-sm",children:[u.jsx("span",{className:"error-dot mt-1.5 h-1.5 w-1.5 rounded-full bg-red-700 shrink-0","aria-hidden":"true"}),u.jsxs("div",{className:"error-content-wrapper min-w-0",children:[y.inputName&&u.jsx("div",{className:"error-input-name font-medium text-red-800 mb-0.5",children:y.inputName}),u.jsx("div",{className:"error-message-text text-red-800",children:y.message}),!N&&u.jsx("div",{className:"error-details-text text-xs text-red-700 mt-0.5 break-words",children:y.details})]})]},x)})})]}),document.body)}function gS({noteText:n,noteLinkified:o,noteWidgetIndex:s,isEditingNote:l,setIsEditingNote:i,onUpdateNote:c,noteTextareaRef:f,onNoteTap:m}){const p=y=>{s!==null&&c(y)},g=y=>{s!==null&&c(y.target.value)};return u.jsxs("div",{className:"mb-3 group","data-textarea-root":"true",children:[u.jsxs("div",{className:"flex items-center justify-between mb-1.5","data-textarea-header":"true",children:[u.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Note"}),l&&u.jsx(ca,{value:n,onChange:p,textareaRef:f,className:"opacity-70 transition-opacity group-focus-within:opacity-100"})]}),l?u.jsx("textarea",{ref:f,value:n,onChange:g,onBlur:()=>i(!1),className:"w-full p-3 border rounded-lg text-base resize-none note-display",rows:Math.min(8,Math.max(3,n.split(`
`).length))}):u.jsx("div",{className:"w-full p-3 border rounded-lg text-base whitespace-pre-wrap break-words note-display",onDoubleClick:()=>i(!0),onTouchEnd:m,children:o})]})}function yS({show:n,previewImage:o,displayName:s,onImageClick:l,isExecuting:i,overallProgress:c,displayNodeProgress:f}){return!n||!o?null:u.jsxs("div",{className:"mb-3",children:[u.jsx("div",{className:"text-xs text-gray-500 mb-1.5 uppercase tracking-wide",children:"Output Preview"}),u.jsxs("div",{className:"relative",children:[u.jsx("img",{src:mo(o.filename,o.subfolder,o.type),alt:`${s} output`,className:"w-full h-auto rounded-lg border border-gray-100",loading:"lazy",onClick:l},"preview"),i&&c!==null&&u.jsx("div",{className:"absolute inset-0 bg-black/40 rounded-lg flex items-end p-3",children:u.jsxs("div",{className:"w-full",children:[u.jsxs("div",{className:"flex items-center justify-between text-xs text-white/90 mb-1",children:[u.jsx("span",{children:"Progress"}),u.jsxs("span",{children:[f,"%"]})]}),u.jsx("div",{className:"h-2 rounded-full bg-white/30 overflow-hidden",children:u.jsx("div",{className:"h-full bg-green-500 transition-none",style:{width:`${Math.min(100,Math.max(0,f))}%`}})}),u.jsxs("div",{className:"flex items-center justify-between text-xs text-white/90 mt-2 mb-1",children:[u.jsx("span",{children:"Overall"}),u.jsxs("span",{children:[c,"%"]})]}),u.jsx("div",{className:"h-2 rounded-full bg-white/30 overflow-hidden",children:u.jsx("div",{className:"h-full bg-blue-500 transition-none",style:{width:`${Math.min(100,Math.max(0,c))}%`}})})]})})]})]})}function bS({nodeId:n,displayName:o,isEditingLabel:s,labelValue:l,labelInputRef:i,onLabelChange:c,onLabelBlur:f,isCollapsed:m,isBypassed:p,isExecuting:g,overallProgress:y,hasErrors:x,errorIconRef:w,errorPopoverOpen:k,setErrorPopoverOpen:N,toggleNodeFold:S,rightSlot:j}){const C=()=>{s||S()},T=U=>{U.stopPropagation(),S()},V=U=>{U.stopPropagation(),N(!k)};return u.jsxs("div",{id:`node-header-${n}`,className:`node-header flex items-center justify-between cursor-pointer gap-3 ${m?"":"mb-3 pb-2 border-b"} ${p?`bg-purple-200 border-purple-300 px-3 -mx-3 -mt-1 pt-1 rounded-t-xl ${m?"pb-1 -mb-1 rounded-b-xl":""}`:m?"":"border-gray-100"}`,onClick:C,children:[u.jsxs("div",{id:`node-title-container-${n}`,className:"flex items-center gap-1 min-w-0",children:[u.jsx("button",{onClick:T,className:"w-8 h-8 -ml-2 flex items-center justify-center text-gray-400 hover:text-gray-600 shrink-0",children:m?u.jsx(gs,{className:"w-6 h-6"}):u.jsx(Jn,{className:"w-6 h-6"})}),s?u.jsx("input",{ref:i,value:l,onChange:U=>c(U.target.value),onBlur:f,onKeyDown:U=>{(U.key==="Enter"||U.key==="Escape")&&U.currentTarget.blur()},onClick:U=>U.stopPropagation(),className:"font-semibold text-gray-900 flex-1 min-w-0 text-sm bg-white border border-gray-200 rounded px-2 py-1"}):u.jsx("h3",{id:`node-display-name-${n}`,className:`font-semibold text-gray-900 select-none flex-1 min-w-0 ${m?"whitespace-nowrap overflow-hidden text-ellipsis":"whitespace-normal break-words"}`,children:o}),u.jsxs("span",{id:`node-id-badge-${n}`,className:"text-xs text-gray-400 min-w-[2ch] text-right",children:["#",n]}),x&&u.jsx("button",{ref:w,type:"button",onClick:V,className:"w-5 h-5 flex items-center justify-center text-red-500 hover:text-red-600 shrink-0","aria-label":"View errors",children:u.jsx(pb,{className:"w-4 h-4"})}),g&&m&&y!==null?u.jsxs("div",{id:`node-progress-indicator-${n}`,className:"relative w-6 h-6 flex items-center justify-center",children:[u.jsx(C2,{className:"absolute",width:"24",height:"24",style:{transform:"rotate(-90deg)"},progress:y,radius:10}),u.jsx("span",{id:`node-progress-text-${n}`,className:"text-[8px] font-bold text-blue-600",children:y})]}):null,g&&!m?u.jsx("span",{id:`node-executing-pulse-${n}`,className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}):null]}),u.jsx("div",{id:`node-header-right-slot-${n}`,className:"header-right-slot",children:j})]})}function xS({nodeId:n,displayName:o,hasConnections:s,onCancel:l,onDelete:i}){const c=[s?{label:"Delete & Reconnect",onClick:()=>i(!0),className:"w-full px-4 py-2.5 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700 active:bg-red-800"}:null,{label:s?"Delete & Disconnect":"Delete",onClick:()=>i(!1),className:s?"w-full px-4 py-2.5 text-sm font-medium text-red-700 bg-red-50 rounded-lg hover:bg-red-100 active:bg-red-200":"w-full px-4 py-2.5 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700 active:bg-red-800"},{label:"Cancel",onClick:l,className:"w-full px-4 py-2.5 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 active:bg-gray-300"}].filter(f=>f!==null);return Mn.createPortal(u.jsx(Po,{onClose:l,title:"Delete node",description:u.jsxs(u.Fragment,{children:["Delete ",u.jsx("span",{className:"font-medium text-gray-700",children:o})," (#",n,")?"]}),actionsLayout:"stack",actions:c}),document.body)}function vS({label:n}){return u.jsx("div",{className:"absolute -top-6 left-1/2 -translate-x-1/2 z-[100] animate-in fade-in slide-in-from-bottom-2 duration-200",children:u.jsx("div",{className:"bg-red-600 text-white text-[10px] font-black px-2 py-0.5 rounded-full shadow-lg whitespace-nowrap uppercase tracking-tighter ring-2 ring-white",children:n})})}function Wo(n){return n.toLowerCase().replace(/[_-]+/g," ").replace(/\s+/g," ").trim()}function Df(n,o){if(!n.trim())return!0;const s=Wo(o);return Wo(n).split(" ").filter(Boolean).every(l=>s.includes(l))}function wu(n,o){if(!n)return!0;let s=0;for(const l of o)if(l===n[s]&&(s+=1),s>=n.length)return!0;return!1}function Ao(n,o){if(!n)return 0;const s=Wo(n),l=Wo(o);return l?l===s?120:l.startsWith(s)?90:l.includes(s)?70:wu(s,l)?40:0:0}function hs(n){return n.replace(/^custom_nodes\./,"").replace(/[._-]+/g," ").replace(/\s+/g," ").trim()}function wb(n){const o=String(n).split(",")[0].trim().toUpperCase();return["IMAGE","LATENT","MODEL","CLIP","VAE","CONDITIONING","INT","FLOAT","STRING","BOOLEAN","MASK"].includes(o)?`type-${o}`:"type-default"}function lf(n){if(n==null)return null;const o=String(n).trim();if(!o)return null;const s=o.toLowerCase();return s==="null"||s==="undefined"?null:o}function ms(n,o){return lf(n?.display_name)??lf(n?.name)??lf(o)??o}function Bf(n,o,s,l){const i=o.trim(),c=n.map(f=>{const{displayName:m,typeName:p,category:g="",pack:y=""}=s(f),x=`${m} ${p} ${g} ${y}`;if(!(!i||Df(i,x)||wu(Wo(i),Wo(x))))return null;const k=i?Ao(i,m)*10+Ao(i,p)*4:0;return{item:f,score:k}}).filter(f=>f!==null);return c.sort((f,m)=>m.score!==f.score?m.score-f.score:l(f.item)-l(m.item)),c.map(f=>f.item)}function wS({nodeId:n,displayName:o,pack:s,outputName:l,outputType:i,inputName:c,isConnected:f,onSelect:m}){return u.jsx("button",{type:"button",className:`w-full text-left rounded-xl border px-4 py-3 shadow-sm transition ${f?"border-blue-300 bg-white":"border-gray-200 bg-white hover:border-gray-300 active:scale-[0.998]"}`,onClick:m,children:u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsxs("div",{className:"text-sm font-semibold text-gray-900 flex items-center gap-2 min-w-0",children:[u.jsxs("span",{className:"truncate",children:[o," ",u.jsxs("span",{className:"text-gray-400",children:["#",n]})]}),f&&u.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-blue-100 text-blue-700 text-[10px] font-medium shrink-0",children:[u.jsx(Do,{className:"w-3 h-3"}),"Currently connected"]})]}),u.jsx("div",{className:"text-xs text-gray-500 truncate mt-0.5",children:s||"Core"}),u.jsxs("div",{className:"text-xs text-gray-700 mt-1 inline-flex items-center gap-1.5",children:[u.jsx("span",{className:`inline-flex h-5 w-5 items-center justify-center rounded-full text-[11px] font-bold ${wb(i)}`,children:""}),u.jsxs("span",{className:"truncate",children:[l," -> ",c]})]})]})})}function xa({onClick:n,ariaLabel:o="Close",variant:s="default",buttonSize:l=10,iconSize:i=6,isIdle:c,zIndex:f}){const m=typeof c=="boolean"||typeof f=="number",p=m?"viewer":s;return u.jsx("button",{onClick:n,className:`transition-colors flex items-center justify-center rounded-full ${p==="viewer"?`absolute top-3 right-3 w-${l} h-${l} text-white ${c?"bg-transparent":"bg-black/60"}`:p==="plain"?`w-${l} h-${l} text-gray-500 bg-transparent hover:bg-transparent`:`w-${l} h-${l} bg-gray-100 dark:bg-gray-800 text-gray-500 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700`}`.trim(),style:m&&typeof f=="number"?{zIndex:f}:void 0,"aria-label":o,children:u.jsx(Na,{className:`w-${i} h-${i}`})})}function Sb({isOpen:n,onClose:o,title:s,searchQuery:l,onSearchQueryChange:i,searchPlaceholder:c,onBack:f,backLabel:m="Back",children:p,footer:g,zIndex:y=2200}){return n?Mn.createPortal(u.jsx("div",{className:"fixed inset-0 bg-gray-400/40 backdrop-blur-sm",style:{zIndex:y},onClick:o,children:u.jsxs("div",{className:"w-full h-full flex flex-col",onClick:x=>x.stopPropagation(),children:[u.jsxs("div",{className:"bg-white border-b border-gray-200 px-4 py-3 flex items-center justify-between safe-area-inset-top",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[f&&u.jsx("button",{type:"button",className:"text-sm text-blue-600 font-medium",onClick:f,children:m}),u.jsx("h2",{className:"text-base font-semibold text-gray-900",children:s})]}),u.jsx(xa,{onClick:o,variant:"plain",buttonSize:8,iconSize:5})]}),u.jsx("div",{className:"bg-white px-4 py-2 border-b border-gray-100",children:u.jsx(ja,{value:l,onChange:i,placeholder:c,autoFocus:!0})}),p,g??u.jsx("div",{className:"flex-shrink-0 h-12 bg-white border-t border-gray-200 flex items-center justify-center",children:u.jsx("button",{type:"button",className:"text-sm text-gray-500 font-medium",onClick:o,children:"Cancel"})})]})}),document.body):null}function zf({title:n,subtitle:o,onSelect:s,outputType:l,outputName:i,inputName:c,titleClassName:f="text-sm font-semibold text-gray-900 truncate"}){return u.jsx("button",{type:"button",className:"w-full text-left rounded-xl border border-gray-200 bg-white px-4 py-3 shadow-sm hover:border-gray-300 active:scale-[0.998] transition",onClick:s,children:u.jsxs("div",{className:"min-w-0",children:[u.jsx("div",{className:f,children:n}),u.jsx("div",{className:"text-xs text-gray-500 truncate mt-0.5",children:o||"Core"}),l&&i&&c&&u.jsxs("div",{className:"text-xs text-gray-700 mt-1 inline-flex items-center gap-1.5",children:[u.jsx("span",{className:`inline-flex h-5 w-5 items-center justify-center rounded-full text-[11px] font-bold ${wb(l)}`,children:""}),u.jsxs("span",{className:"truncate",children:[String(i)," -> ",c]})]})]})})}function aa({query:n,message:o}){return n.trim()?u.jsx("div",{className:"px-4 py-8 text-center text-sm text-gray-500",children:o}):null}function $o(n,o){return`${n}:${o}`}function SS(n,o){if(n.size!==o.size)return!1;for(const s of n)if(!o.has(s))return!1;return!0}function ey(n){const{isOpen:o,onClose:s,nodeId:l,mode:i}=n,c=ae(I=>I.workflow),f=ae(I=>I.nodeTypes),m=ae(I=>I.connectNodes),p=ae(I=>I.disconnectInput),g=ae(I=>I.addNode),y=ae(I=>I.addNodeAndConnect),x=ae(I=>I.scrollToNode),[w,k]=b.useState(""),[N,S]=b.useState("pick"),[j,C]=b.useState(()=>{if(i!=="output"||!c)return new Set;const I=new Set;for(const B of c.links){const[,W,be,me,ke]=B;W===l&&be===n.outputIndex&&I.add($o(me,ke))}return I}),[T,V]=b.useState(!1),[U,R]=b.useState(null),[z,L]=b.useState(new Set),$=b.useMemo(()=>c?c.nodes.find(B=>B.id===l)?.stableKey??null:null,[l,c]),Y=I=>{const B=ae.getState().workflow;return B?B.nodes.find(be=>be.id===I)?.stableKey??null:null},ue=b.useMemo(()=>i!=="input"||!c||!f?[]:bw(c,f,l,n.inputIndex),[i,c,f,l,n]),pe=b.useMemo(()=>{if(i!=="input")return[];const I=w.trim(),B=ue.map(W=>{const{node:be}=W,me=f?.[be.type],ke=be.title,F=typeof ke=="string"&&ke.trim()?ke.trim():me?.display_name||be.type,ie=`${F} ${me?.display_name??""} ${be.type} ${String(be.id)}`;if(!(!I||Df(I,ie)||wu(Wo(I),Wo(ie))))return null;const $e=Ao(I,F)*4+Ao(I,me?.display_name??"")*3+Ao(I,be.type)*2+Ao(I,String(be.id));return{...W,score:$e}}).filter(Boolean);return B.sort((W,be)=>be.score-W.score||W.node.id-be.node.id),B},[i,ue,w,f]),fe=b.useMemo(()=>i!=="input"||!f?[]:xw(f,n.inputType).map((I,B)=>({...I,index:B})),[i,f,n]),Re=b.useMemo(()=>i!=="output"||!f?[]:ww(f,n.outputType).map((I,B)=>({...I,index:B})),[i,f,n]),Ie=b.useMemo(()=>i!=="input"?[]:Bf(fe,w,I=>{const B=ms(I.def,I.typeName),W=ms({display_name:I.def.name,name:I.typeName},I.typeName),be=hs(I.def.python_module||I.def.category?.split("/")[0]||"Core");return{displayName:B,typeName:W,category:String(I.def.category??""),pack:be}},I=>I.index),[i,fe,w]),Ae=b.useMemo(()=>i!=="output"?[]:Bf(Re,w,I=>{const B=ms(I.def,I.typeName),W=ms({display_name:I.def.name,name:I.typeName},I.typeName),be=hs(I.def.python_module||I.def.category?.split("/")[0]||"Core");return{displayName:B,typeName:W,category:String(I.def.category??""),pack:be}},I=>I.index),[i,Re,w]),_=b.useMemo(()=>{if(i!=="output"||!c||!f)return[];const I=Sw(c,l,n.outputIndex),B=new Set;for(const ke of c.links){const[,F,ie,_e,$e]=ke;F===l&&ie===n.outputIndex&&B.add($o(_e,$e))}const W=w.trim(),me=I.map(({node:ke,inputIndex:F})=>{const ie=f[ke.type],_e=ke.title,$e=typeof _e=="string"&&_e.trim()?_e.trim():ie?.display_name||ke.type,Ze=hs(String(ie?.python_module??ie?.category?.split("/")[0]??"Core")),Ge=ke.inputs?.[F];if(!Ge)return null;const nt=Ge.localized_name||Ge.name||`Input ${F+1}`,Ye=String(Ge.type),Fe=$o(ke.id,F),st=B.has(Fe);let ft=!1,Nt=null;const Ht=Ge.link;if(Ht!=null&&!st){const re=c.links.find(de=>de[0]===Ht);if(re){ft=!0;const[,de]=re,Oe=c.nodes.find(Ke=>Ke.id===de);Oe&&(Nt=`${f[Oe.type]?.display_name||Oe.type} #${Oe.id}`)}}const Vt=`${$e} ${ie?.display_name??""} ${ke.type} ${String(ke.id)} ${nt}`;if(!(!W||Df(W,Vt)||wu(Wo(W),Wo(Vt))))return null;const Q=Ao(W,$e)*4+Ao(W,nt)*3+Ao(W,ie?.display_name??"")*2+Ao(W,ke.type)*2+Ao(W,String(ke.id));return{nodeId:ke.id,inputIndex:F,displayName:$e,pack:Ze,inputName:nt,inputType:Ye,currentlyConnectedFromThisOutput:st,hasExistingLink:ft,existingSourceLabel:Nt,score:Q}}).filter(ke=>ke!==null);return me.sort((ke,F)=>F.score-ke.score||ke.nodeId-F.nodeId),me},[i,c,f,l,n,w]),se=b.useMemo(()=>i!=="output"?new Set:new Set(_.filter(I=>I.currentlyConnectedFromThisOutput).map(I=>$o(I.nodeId,I.inputIndex))),[i,_]),ce=b.useMemo(()=>{const I=new Map;for(const B of _)I.set($o(B.nodeId,B.inputIndex),B);return I},[_]),Ue=b.useMemo(()=>{if(i!=="output")return[];const I=new Map;for(const B of _){const W=I.get(B.nodeId);if(W){W.inputs.push(B),B.score>W.score&&(W.score=B.score);continue}I.set(B.nodeId,{nodeId:B.nodeId,displayName:B.displayName,pack:B.pack,score:B.score,inputs:[B]})}return Array.from(I.values()).sort((B,W)=>W.score-B.score||B.nodeId-W.nodeId)},[i,_]),De=b.useMemo(()=>i!=="output"?!1:!SS(j,se),[i,j,se]),E=b.useMemo(()=>{if(i!=="output")return[];const I=[];for(const B of j){if(se.has(B))continue;const W=ce.get(B);W?.hasExistingLink&&I.push(W)}return I},[i,j,se,ce]),A=(I,B)=>{if(i!=="input")return;const W=Y(I);!W||!$||(m(W,B,$,n.inputIndex,n.inputType),s(),x(W))},O=()=>{i==="input"&&$&&(p($,n.inputIndex),s())},te=I=>{if(i!=="input"||!$)return;const B=y(I,$,n.inputIndex);if(s(),B!==null){const W=Y(B);W&&x(W)}},Le=(I,B,W)=>{if(i!=="output"||!$)return;const be=g(I,{nearNodeStableKey:$});if(be===null)return;const me=Y(be);if(!me)return;const F=ae.getState().workflow?.nodes.find(Ze=>Ze.id===be);if(!F||!$)return;const ie=F.inputs.findIndex(Ze=>Ze.type.toUpperCase()===W.toUpperCase()),_e=ie>=0?ie:B,$e=F.inputs[_e]?.type;$e!=null&&(m($,n.outputIndex,me,_e,$e),s(),x(me))},We=(I,B)=>{const W=$o(I,B);C(be=>{const me=new Set(be);return me.has(W)?me.delete(W):me.add(W),me})},xe=I=>{const B=new Set;for(const W of I.inputs){const be=$o(W.nodeId,W.inputIndex);j.has(be)&&B.add(be)}R(I.nodeId),L(B)},Se=()=>{R(null),L(new Set)},H=I=>{L(B=>{const W=new Set(B);return W.has(I)?W.delete(I):W.add(I),W})},P=()=>{if(U==null)return;const I=Ue.find(W=>W.nodeId===U);if(!I){Se();return}const B=I.inputs.map(W=>$o(W.nodeId,W.inputIndex));C(W=>{const be=new Set(W);for(const me of B)be.delete(me);for(const me of z)be.add(me);return be}),Se()},D=I=>{if(I.inputs.length>1){xe(I);return}const B=I.inputs[0];B&&We(B.nodeId,B.inputIndex)},K=()=>{if(i==="output"){for(const I of se){if(j.has(I))continue;const B=ce.get(I);if(!B)continue;const W=Y(B.nodeId);W&&p(W,B.inputIndex)}for(const I of j){if(se.has(I))continue;const B=ce.get(I);if(!B)continue;const W=Y(B.nodeId);!W||!$||m($,n.outputIndex,W,B.inputIndex,B.inputType)}s()}},Z=()=>{if(i==="output"){if(E.length>0){V(!0);return}K()}},q=i==="input"?N==="pick"?`Connect ${n.inputName}`:"Add new node":N==="pick"?`Connect ${n.outputName}`:"Add new node",Ee=i==="input"?N==="pick"?"Search existing nodes...":"Search node types...":N==="pick"?"Search target nodes...":"Search node types...",je=()=>{if(i!=="input")return null;const I=n;return u.jsxs("div",{className:"px-3 pt-3 pb-20 flex flex-col gap-2",children:[pe.map(({node:B,outputIndex:W})=>{const be=f?.[B.type],me=B.title,ke=typeof me=="string"&&me.trim()?me.trim():be?.display_name||B.type,F=hs(String(be?.python_module??be?.category?.split("/")[0]??"Core")),ie=B.outputs?.[W],_e=ie?.localized_name||ie?.name||`Output ${W+1}`,$e=String(ie?.type??I.inputType),Ze=B.id===I.currentlyConnectedNodeId;return u.jsx(wS,{nodeId:B.id,displayName:ke,pack:F,outputName:_e,outputType:$e,inputName:I.inputName,isConnected:Ze,onSelect:()=>A(B.id,W)},B.id)}),pe.length===0&&u.jsx(aa,{query:w,message:"No matching nodes found"}),u.jsxs("button",{type:"button",className:"w-full text-left rounded-xl border-2 border-gray-700 bg-white px-4 py-3 flex items-center gap-3 hover:bg-gray-100 active:scale-[0.998] transition shadow-sm",onClick:()=>{S("addNew"),k("")},children:[u.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-800 flex items-center justify-center flex-shrink-0",children:u.jsx(zo,{className:"w-4 h-4 text-white"})}),u.jsx("span",{className:"text-sm font-semibold text-gray-900",children:"Add new node..."})]}),I.currentlyConnectedNodeId!==null&&u.jsx("button",{type:"button",className:"w-full text-left rounded-xl border border-red-200 bg-red-50 px-4 py-3 text-sm font-semibold text-red-600 hover:bg-red-100 active:scale-[0.998] transition",onClick:O,children:"Disconnect"})]})},Ne=()=>{if(i!=="input")return null;const I=n;return u.jsxs("div",{className:"px-3 pt-3 pb-20 flex flex-col gap-2",children:[Ie.length===0&&u.jsx(aa,{query:w,message:"No matching node types found"}),Ie.map(({typeName:B,def:W,outputIndex:be})=>{const me=hs(String(W.python_module??W.category?.split("/")[0]??"Core")),ke=String(W.output?.[be]??I.inputType),F=W.output_name?.[be]??W.output?.[be]??"Output";return u.jsx(zf,{title:ms(W,B),subtitle:me||"Core",outputType:ke,outputName:String(F),inputName:I.inputName,titleClassName:"text-sm font-medium text-gray-900 truncate",onSelect:()=>te(B)},B)})]})},ee=()=>{if(i!=="output")return null;const I=n;return u.jsxs("div",{className:"px-3 pt-3 pb-20 flex flex-col gap-2",children:[Ue.map(B=>{const be=B.inputs.filter(ie=>j.has($o(ie.nodeId,ie.inputIndex))).length>0,me=B.inputs.some(ie=>ie.hasExistingLink),ke=B.inputs.some(ie=>ie.currentlyConnectedFromThisOutput),F=B.inputs.length>1?`${B.inputs.length} compatible inputs`:`${I.outputName} -> ${B.inputs[0]?.inputName??"Input"}`;return u.jsx("button",{type:"button",className:`w-full text-left rounded-xl border px-4 py-3 shadow-sm transition ${be?"border-blue-300 bg-blue-50":"border-gray-200 bg-white hover:border-gray-300 active:scale-[0.998]"}`,onClick:()=>D(B),children:u.jsxs("div",{className:"flex items-start justify-between gap-3",children:[u.jsxs("div",{className:"min-w-0 flex-1",children:[u.jsxs("div",{className:"text-sm font-semibold text-gray-900 flex items-center gap-2 min-w-0",children:[u.jsxs("span",{className:"truncate",children:[B.displayName," ",u.jsxs("span",{className:"text-gray-400",children:["#",B.nodeId]})]}),ke&&u.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-blue-100 text-blue-700 text-[10px] font-medium shrink-0",children:[u.jsx(Do,{className:"w-3 h-3"}),"Connected"]}),me&&u.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full bg-amber-100 text-amber-700 text-[10px] font-medium shrink-0",children:"Already linked"})]}),u.jsx("div",{className:"text-xs text-gray-500 truncate mt-0.5",children:B.pack||"Core"}),u.jsx("div",{className:"text-xs text-gray-700 mt-1 truncate",children:F})]}),u.jsx("div",{className:`w-5 h-5 rounded border flex items-center justify-center ${be?"bg-blue-600 border-blue-600":"bg-white border-gray-300"}`,children:be&&u.jsx(Do,{className:"w-3 h-3 text-white"})})]})},`output-node-${B.nodeId}`)}),Ue.length===0&&u.jsx(aa,{query:w,message:"No matching target nodes found"}),u.jsxs("button",{type:"button",className:"w-full text-left rounded-xl border-2 border-gray-700 bg-white px-4 py-3 flex items-center gap-3 hover:bg-gray-100 active:scale-[0.998] transition shadow-sm",onClick:()=>{S("addNew"),k("")},children:[u.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-800 flex items-center justify-center flex-shrink-0",children:u.jsx(zo,{className:"w-4 h-4 text-white"})}),u.jsx("span",{className:"text-sm font-semibold text-gray-900",children:"Add new node..."})]})]})},Me=()=>{if(i!=="output")return null;const I=n;return u.jsxs("div",{className:"px-3 pt-3 pb-20 flex flex-col gap-2",children:[Ae.length===0&&u.jsx(aa,{query:w,message:"No matching node types found"}),Ae.map(({typeName:B,def:W,inputIndex:be,inputType:me,inputName:ke})=>{const F=hs(String(W.python_module??W.category?.split("/")[0]??"Core"));return u.jsx(zf,{title:ms(W,B),subtitle:F||"Core",outputType:I.outputType,outputName:I.outputName,inputName:String(ke),titleClassName:"text-sm font-medium text-gray-900 truncate",onSelect:()=>Le(B,be,me)},B)})]})};return u.jsxs(Sb,{isOpen:o,onClose:s,title:q,searchQuery:w,onSearchQueryChange:k,searchPlaceholder:Ee,onBack:N==="addNew"?()=>{S("pick"),k("")}:void 0,footer:u.jsx(vb,{zIndex:2201,actions:[{key:"cancel",label:"Cancel",onClick:s,variant:"secondary"},...i==="output"&&N==="pick"?[{key:"apply",label:"Apply",onClick:Z,variant:"primary",disabled:!De}]:[]]}),children:[u.jsx("div",{className:"flex-1 overflow-auto bg-white",children:i==="input"?N==="pick"?je():Ne():N==="pick"?ee():Me()}),i==="output"&&U!=null&&u.jsx("div",{className:"fixed inset-0 z-[2250] bg-black/40 flex items-center justify-center p-4",onClick:Se,role:"dialog","aria-modal":"true",children:u.jsxs("div",{className:"w-full max-w-sm bg-white border border-gray-200 rounded-xl shadow-lg overflow-hidden",onClick:I=>I.stopPropagation(),children:[u.jsx("div",{className:"px-4 py-3 text-sm font-semibold text-gray-700 border-b border-gray-100",children:"Select compatible inputs"}),u.jsx("div",{className:"max-h-[45vh] overflow-y-auto",children:Ue.find(I=>I.nodeId===U)?.inputs.map(I=>{const B=$o(I.nodeId,I.inputIndex),W=z.has(B);return u.jsxs("button",{type:"button",className:`w-full flex items-center justify-between gap-3 text-left px-4 py-3 text-sm ${W?"bg-blue-50":"hover:bg-gray-50"}`,onClick:()=>H(B),children:[u.jsxs("span",{className:"min-w-0",children:[u.jsx("span",{className:"block text-gray-900 truncate",children:I.inputName}),u.jsx("span",{className:"block text-xs text-gray-500 truncate",children:I.inputType})]}),u.jsx("span",{className:`w-5 h-5 rounded border flex items-center justify-center shrink-0 ${W?"bg-blue-600 border-blue-600":"bg-white border-gray-300"}`,children:W?u.jsx(Do,{className:"w-3 h-3 text-white"}):null})]},`input-picker-${B}`)})}),u.jsxs("div",{className:"px-3 py-3 border-t border-gray-100 flex justify-end gap-2",children:[u.jsx("button",{type:"button",className:"px-3 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-100",onClick:Se,children:"Cancel"}),u.jsx("button",{type:"button",className:"px-3 py-2 rounded-lg text-sm font-medium text-white bg-blue-600 hover:bg-blue-700",onClick:P,children:"Apply"})]})]})}),i==="output"&&T&&u.jsx(Po,{onClose:()=>V(!1),title:"Overwrite existing connections?",description:"Some selected inputs are already connected. Continuing will disconnect their current source and reconnect to this output.",actions:[{label:"Cancel",onClick:()=>V(!1),className:"px-3 py-1.5 rounded-lg text-sm text-gray-700 border border-gray-300 hover:bg-gray-50"},{label:"Overwrite",onClick:()=>{V(!1),K()},className:"px-3 py-1.5 rounded-lg text-sm text-white bg-red-600 hover:bg-red-700"}]})]})}function NS(n,o,s,l){const i=n.nodes.find(y=>y.id===o);if(!i||i.type!=="Reroute")return l;let c=null;const f=[],m=new Set,p=i.inputs[0]?.link;if(p!=null){const y=n.links.find(x=>x[0]===p);if(y){const x=y[1],w=y[2],N=n.nodes.find(S=>S.id===x)?.outputs[w];c=N?.localized_name||N?.name||null}}for(const y of i.outputs){const x=y.links??[];for(const w of x){const k=n.links.find(V=>V[0]===w);if(!k)continue;const N=k[3],S=k[4],C=n.nodes.find(V=>V.id===N)?.inputs[S],T=C?.localized_name||C?.name||null;T&&!m.has(T)&&(m.add(T),f.push(T))}}const g=f.map((y,x)=>x<f.length-1?`${y}/`:y).join(`
`);return f.length>1?g:s==="input"?c||g||l:g||c||l}function CS({direction:n,hasConnection:o,isEmptyRequiredInput:s=!1,hideLabel:l,resolvedLabel:i,shouldWrapResolvedLabel:c,sizeClass:f,arrowClass:m,typeClass:p,buttonRef:g,connectionCount:y,onClick:x,onPointerDown:w,onPointerMove:k,onPointerUp:N}){const S=n==="input",j=S?!o&&!s:!1,C=!S&&!o,T=f.includes("w-7")?"w-3 h-3":"w-3.5 h-3.5";return u.jsxs(u.Fragment,{children:[S?null:!l&&u.jsx("span",{className:`text-sm text-gray-700 flex-1 min-w-0 ${c?"whitespace-pre-line break-words leading-tight text-right":"truncate"}`,children:i}),!S&&y>1&&u.jsx("span",{className:"bg-gray-200 text-gray-700 rounded-full px-2 py-0.5 text-xs font-medium flex-shrink-0",children:y}),u.jsx("button",{onClick:x,onPointerDown:w,onPointerMove:k,onPointerUp:N,onPointerCancel:N,disabled:j,ref:g,className:`
          flex items-center justify-center rounded-full font-medium box-border
          border-2
          ${f} flex-shrink-0
          transition-opacity
          ${p}
          ${S&&s?"opacity-100 cursor-pointer border-red-500":"border-transparent"}
          ${!S&&C?"border-dashed border-gray-400/70":""}
          ${j?"opacity-40 cursor-not-allowed":""}
          ${!j&&C?"opacity-50 cursor-pointer active:scale-95":""}
          ${!j&&!C?"opacity-100 cursor-pointer active:scale-95":""}
        `,children:S?u.jsxs(u.Fragment,{children:[o&&u.jsx("span",{className:m,children:""}),!o&&u.jsx(zo,{className:T})]}):o?u.jsx("span",{className:m,children:""}):u.jsx(zo,{className:T})}),!S&&l?null:S&&!l&&u.jsx("span",{className:`text-sm flex-1 min-w-0 ${c?"whitespace-pre-line break-words leading-tight":"truncate"} ${s?"text-red-600 font-medium":"text-gray-700"}`,children:i})]})}function kS(n){const o=String(n).split(",")[0].trim();return["IMAGE","LATENT","MODEL","CLIP","VAE","CONDITIONING","INT","FLOAT","STRING","BOOLEAN","MASK"].includes(o)?`type-${o}`:"type-default"}function ty(n){return String(n).split(",").map(o=>o.trim().toUpperCase()).filter(Boolean)}const ny=b.memo(function({slot:o,nodeId:s,direction:l,slotIndex:i,compact:c=!1,hideLabel:f=!1,isRequired:m=!1}){const p=ae(H=>H.workflow),g=ae(H=>H.scrollToNode),y=ae(H=>H.revealNodeWithParents),x=ae(H=>H.nodeTypes),w=ae(H=>H.hiddenItems),[k,N]=b.useState(!1),[S,j]=b.useState(!1),C=b.useRef(null),T=b.useRef(null),[V,U]=b.useState(null),R=b.useRef(null),z=b.useRef(null),L=b.useRef(null),$=b.useRef(!1),Y=b.useMemo(()=>{const H=o.localized_name||o.name;return p?NS(p,s,l,H):H},[p,l,o.localized_name,o.name,s]),ue=b.useMemo(()=>{if(!p)return[];const H=[];if(l==="input"){if(o.link!=null){const D=ll(p,s,i);D&&H.push(D.node)}}else{const P=pa(p,s,i);for(const D of P)H.push(D.node)}return H},[p,s,l,o,i]),{effectiveNodes:pe,directNodes:fe,bypassedTargets:Re}=b.useMemo(()=>{if(!p)return{effectiveNodes:[],directNodes:[],bypassedTargets:[]};if(Object.keys(w).length===0)return{effectiveNodes:ue,directNodes:ue,bypassedTargets:[]};const H=new Map(p.nodes.map(Me=>[Me.id,Me])),P=Me=>!!(Me.stableKey&&w[Me.stableKey]),D=new Set,K=Me=>{if(D.has(Me))return[];D.add(Me);const I=H.get(Me);if(!I)return[];const B=[];return I.outputs?.forEach((W,be)=>{pa(p,Me,be).forEach(ke=>{const F=ke.node;P(F)?B.push(...K(F.id)):B.push(F)})}),B},Z=Me=>{if(D.has(Me))return[];D.add(Me);const I=H.get(Me);if(!I)return[];const B=[];return I.inputs?.forEach((W,be)=>{if(W.link===null)return;const me=ll(p,Me,be);me&&(P(me.node)?B.push(...Z(me.node.id)):B.push(me.node))}),B},q=[],Ee=[];ue.forEach(Me=>{P(Me)?l==="input"?Ee.push(...Z(Me.id)):Ee.push(...K(Me.id)):q.push(Me)});const je=new Set(q.map(Me=>Me.id));let ee=(Me=>{const I=[],B=new Set;return Me.forEach(W=>{je.has(W.id)||B.has(W.id)||(B.add(W.id),I.push(W))}),I})(Ee);if(l==="input"&&ee.length>1){const Me=new Set(ty(o.type)),I=ee.filter(B=>B.outputs?.some(W=>ty(W.type).some(be=>Me.has(be))));I.length>0&&(ee=I)}return{effectiveNodes:[...q,...ee],directNodes:q,bypassedTargets:ee}},[ue,p,l,o.type,w]),Ie=pe.length,Ae=Ie===1?pe[0].id:null,_=Ie>0,se=l==="input"&&!_&&m,ce=b.useCallback(()=>{z.current!=null&&(window.clearTimeout(z.current),z.current=null)},[]),Ue=b.useCallback(H=>H.stableKey??null,[]),De=()=>{if($.current){$.current=!1;return}if(l==="output"&&!_){j(!0);return}if(se){j(!0);return}if(_){if(Ie===1&&Ae!==null){const H=pe[0],P=H?Ue(H):null;P&&(y(P),g(P));return}N(H=>!H)}},E=b.useCallback(H=>{(l!=="input"||_)&&(L.current={x:H.clientX,y:H.clientY},$.current=!1,z.current=window.setTimeout(()=>{z.current=null,$.current=!0,j(!0)},500))},[l,_]),A=b.useCallback(H=>{if(!L.current)return;const P=H.clientX-L.current.x,D=H.clientY-L.current.y;Math.hypot(P,D)>8&&ce()},[ce]),O=b.useCallback(()=>{ce(),L.current=null},[ce]),te=H=>P=>{P.stopPropagation();const D=pe.find(Z=>Z.id===H),K=D?Ue(D):null;K&&(y(K),g(K)),N(!1)};b.useLayoutEffect(()=>{if(!k)return;const H=()=>{const P=T.current;if(!P)return;const D=P.getBoundingClientRect(),K=8;U({top:D.bottom+6,...l==="input"?{left:Math.min(D.left,window.innerWidth-K)}:{right:Math.max(K,window.innerWidth-D.right)}})};return R.current=H,H(),()=>{}},[k,Ie,l]),b.useEffect(()=>{if(!k)return;const H=()=>R.current?.(),P=K=>{!C.current||!K.target||T.current?.contains(K.target)||C.current.contains(K.target)||N(!1)},D=K=>{const Z=K.target;C.current&&Z&&C.current.contains(Z)||N(!1)};return document.addEventListener("mousedown",P),document.addEventListener("scroll",D,!0),window.addEventListener("resize",H),()=>{document.removeEventListener("mousedown",P),document.removeEventListener("scroll",D,!0),window.removeEventListener("resize",H)}},[k]),b.useEffect(()=>()=>ce(),[ce]);const Le=c?"w-7 h-7":"w-10 h-10",We=c?"text-sm":"text-base";if(!p)return null;const xe=l==="input"&&_&&Ae!==null?Ae:null,Se=Y.includes("/")||Y.includes(`
`);return u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(CS,{direction:l,hasConnection:_,isEmptyRequiredInput:se,hideLabel:f,resolvedLabel:Y,shouldWrapResolvedLabel:Se,sizeClass:Le,arrowClass:We,typeClass:kS(o.type),buttonRef:T,connectionCount:Ie,onClick:De,onPointerDown:E,onPointerMove:A,onPointerUp:O}),k&&V&&Mn.createPortal(u.jsx("div",{ref:C,className:"fixed z-[1000]",style:{top:V.top,right:V.right,left:V.left,maxWidth:"calc(100vw - 16px)"},children:u.jsx(gr,{items:[...fe.map(H=>{const D=x?.[H.type]?.display_name||H.type;return{key:`direct-${H.id}`,label:`${D} #${H.id}`,onClick:te(H.id)}}),{type:"custom",key:"bypassed-label",hidden:!(fe.length>0&&Re.length>0),render:u.jsx("div",{className:"px-3 py-1",children:u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("div",{className:"h-px flex-1 bg-gray-200"}),u.jsx("span",{className:"text-[10px] text-gray-400",children:"(via bypassed)"}),u.jsx("div",{className:"h-px flex-1 bg-gray-200"})]})})},...Re.map(H=>{const D=x?.[H.type]?.display_name||H.type;return{key:`bypassed-${H.id}`,label:`${D} #${H.id}`,onClick:te(H.id)}})]})}),document.body),S&&(l==="input"?u.jsx(ey,{mode:"input",isOpen:S,onClose:()=>j(!1),nodeId:s,inputIndex:i,inputType:o.type,inputName:Y,currentlyConnectedNodeId:xe}):u.jsx(ey,{mode:"output",isOpen:S,onClose:()=>j(!1),nodeId:s,outputIndex:i,outputType:o.type,outputName:Y}))]})});function jS({nodeId:n,nodeType:o,inputs:s,outputs:l,allInputs:i,allOutputs:c}){const f=ae(g=>g.connectionButtonsVisible),m=ae(g=>g.nodeTypes),p=b.useMemo(()=>{if(!o||!m)return new Set;const g=m[o];return g?.input?.required?new Set(Object.keys(g.input.required)):new Set},[o,m]);return!f||s.length===0&&l.length===0?null:u.jsxs("div",{className:"node-connections mb-3 grid grid-cols-2 gap-3",children:[u.jsx("div",{children:s.length>0&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"text-xs text-gray-500 mb-1.5 uppercase tracking-wide",children:"Inputs"}),u.jsx("div",{className:"flex flex-col gap-1.5",children:s.map((g,y)=>{const x=i.indexOf(g),w=x>=0?x:y;return u.jsx(ny,{slot:g,nodeId:n,direction:"input",slotIndex:w,isRequired:p.has(g.name)},`input-${w}`)})})]})}),u.jsx("div",{className:"flex flex-col items-end",children:l.length>0&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"text-xs text-gray-500 mb-1.5 uppercase tracking-wide text-right w-full",children:"Outputs"}),u.jsx("div",{className:"flex flex-col gap-1.5 w-full items-end",children:l.map((g,y)=>{const x=c.indexOf(g),w=x>=0?x:y;return u.jsx(ny,{slot:g,nodeId:n,direction:"output",slotIndex:w},`output-${w}`)})})]})})]})}function MS({nodeId:n,nodeType:o,inputs:s,outputs:l,allInputs:i,allOutputs:c}){return u.jsx(jS,{nodeId:n,nodeType:o,inputs:s,outputs:l,allInputs:i,allOutputs:c})}function OS({title:n,onClose:o,headerActions:s,isDark:l}){return u.jsx("div",{className:"bg-white p-4 border-b border-gray-200 dark:border-gray-800 shadow-sm relative z-50 min-h-0 overflow-y-auto shrink-0",style:{maxHeight:"var(--top-bar-offset)",...l?{backgroundColor:kt.surface.darkPanel}:{}},children:u.jsxs("div",{className:"flex justify-between items-start mb-2",children:[u.jsx("span",{className:"font-semibold text-gray-700 dark:text-gray-200 truncate pr-4 pt-1 flex-1",children:n}),u.jsxs("div",{className:"flex items-center gap-2",children:[s,u.jsx(xa,{onClick:o})]})]})})}function gp({isOpen:n,title:o,onClose:s,children:l,headerActions:i}){const f=al(m=>m.theme)==="dark";return b.useEffect(()=>{if(n){const m=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=m}}},[n]),n?Mn.createPortal(u.jsx("div",{className:"fixed inset-0 z-[2100] bg-gray-400/40 dark:bg-black/50 backdrop-blur-sm safe-area-top",onClick:s,children:u.jsxs("div",{className:"w-full h-full flex flex-col",style:{paddingTop:"env(--top-bar-offset, 0px)",paddingBottom:"var(--bottom-bar-offset, 0px)"},onClick:m=>m.stopPropagation(),children:[u.jsx(OS,{title:o,onClose:s,headerActions:i,isDark:f}),u.jsx("div",{className:"mt-2 px-4 pb-4",children:l}),u.jsx("div",{className:"flex-1",onClick:s})]})}),document.body):null}function nl({isPinned:n,onToggle:o}){if(!n||!o)return null;const s=l=>{l.preventDefault(),l.stopPropagation(),o()};return u.jsx("button",{type:"button",onClick:s,className:"flex items-center justify-center transition-colors text-fuchsia-500 hover:text-fuchsia-600","aria-label":"Remove pin",children:u.jsx(ya,{className:"w-5 h-5"})})}function Nb(){return typeof window>"u"?!1:window.matchMedia("(pointer: coarse)").matches}function oy({containerClass:n,name:o,value:s,options:l,onChange:i,disabled:c=!1,hideLabel:f=!1,hasPin:m,isPinned:p=!1,onTogglePin:g,hasError:y=!1,forceModalOpen:x=!1,onModalClose:w}){const k=fe=>{if(!Array.isArray(l))return l?.[fe]},N=k("multiline"),S=k("placeholder"),j=String(s??""),C=fe=>{i(fe.target.value)},[T,V]=b.useState(!1),U=x||T,z=al(fe=>fe.theme)==="dark",L=Nb(),$=x||L,Y=b.useRef(null),ue=b.useRef(null);b.useLayoutEffect(()=>{if(!N)return;const fe=Y.current;fe&&(fe.style.height="0px",fe.style.height=`${fe.scrollHeight}px`)},[s,U,N]);const pe=()=>{V(!1),w?.()};return $?u.jsxs("div",{className:n,children:[N?u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"flex items-center justify-between mb-1 min-h-[18px]",children:[f?u.jsx("span",{className:"block text-sm font-medium text-gray-700"}):u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:o}),u.jsx(ca,{value:j,onChange:i,textareaRef:Y,className:"opacity-100"})]}),u.jsxs("div",{className:`relative w-full p-3 comfy-input min-h-[100px] text-base group cursor-text ${c?"opacity-60 cursor-not-allowed":""} ${m?"pr-10":""} ${y?"border-red-700 ring-1 ring-red-700":""}`,onClick:()=>!c&&V(!0),children:[u.jsx("div",{className:"whitespace-pre-wrap break-words text-gray-900",style:z?{color:kt.text.onDark}:void 0,children:j||u.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:S})}),m&&u.jsx("div",{className:"absolute right-2 top-2 pointer-events-none",children:u.jsx("div",{className:"pointer-events-auto",children:u.jsx(nl,{isPinned:p,onToggle:g})})})]})]}):u.jsxs(u.Fragment,{children:[!f&&u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:o}),u.jsxs("div",{className:`relative w-full p-3 comfy-input text-base min-h-[46px] flex items-center cursor-text ${c?"opacity-60 cursor-not-allowed":""} ${m?"pr-16":"pr-6"} ${y?"border-red-700 ring-1 ring-red-700":""}`,onClick:()=>!c&&V(!0),children:[u.jsx("div",{className:"truncate min-w-0 flex-1 text-gray-900",style:z?{color:kt.text.onDark}:void 0,children:j||u.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:S})}),m&&u.jsx("div",{className:"absolute right-0 top-0 bottom-0 flex items-center pointer-events-none",children:u.jsx("div",{className:"pointer-events-auto px-3",children:u.jsx(nl,{isPinned:p,onToggle:g})})})]})]}),u.jsx(gp,{title:o,isOpen:U,onClose:pe,headerActions:N?u.jsx(ca,{value:j,onChange:i,textareaRef:Y,className:"mr-2"}):null,children:N?u.jsx("textarea",{ref:Y,value:j,onChange:fe=>i(fe.target.value),placeholder:S,className:"w-full p-3 border border-gray-300 rounded-lg min-h-[150px] text-base resize-none outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500",autoFocus:!x,disabled:c}):u.jsx("input",{ref:ue,type:"text",value:j,onChange:fe=>i(fe.target.value),placeholder:S,className:"w-full p-3 border border-gray-300 rounded-lg text-base outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500",autoFocus:!x,disabled:c})})]}):N?u.jsxs("div",{className:`${n} group`,"data-textarea-root":"true",children:[u.jsxs("div",{className:"flex items-center justify-between mb-1 min-h-[18px]","data-textarea-header":"true",children:[f?u.jsx("span",{className:"block text-sm font-medium text-gray-700"}):u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:o}),u.jsx(ca,{value:j,onChange:i,textareaRef:Y,className:"opacity-70 transition-opacity group-focus-within:opacity-100"})]}),u.jsxs("div",{className:"relative",children:[u.jsx("textarea",{ref:Y,value:j,onChange:C,placeholder:S,className:`w-full p-3 comfy-input min-h-[100px] text-base resize-none overflow-hidden ${c?"opacity-60 cursor-not-allowed":""} ${m?"pr-10":""} ${y?"border-red-700 ring-1 ring-red-700":""}`,style:{overflowAnchor:"none"},disabled:c}),m&&u.jsx("div",{className:"absolute right-2 top-2",children:u.jsx(nl,{isPinned:p,onToggle:g})})]})]}):u.jsxs("div",{className:n,children:[!f&&u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:o}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"text",value:String(s??""),onChange:fe=>i(fe.target.value),placeholder:S,className:`w-full p-3 comfy-input text-base ${c?"opacity-60 cursor-not-allowed":""} ${m?"pr-16":""} ${y?"border-red-700 ring-1 ring-red-700":""}`,disabled:c}),m&&u.jsx("div",{className:"absolute right-0 top-0 bottom-0 flex items-center pointer-events-none",children:u.jsx("div",{className:"pointer-events-auto px-3",children:u.jsx(nl,{isPinned:p,onToggle:g})})})]})]})}function Hf({containerClass:n,name:o,value:s,options:l,onChange:i,disabled:c,type:f,min:m,max:p,step:g,isInt:y,hasError:x=!1}){const[w,k]=b.useState(String(s||0)),N=y??(f?f.toUpperCase()==="INT":Number.isInteger(s)),S=g??l?.step??(N?1:.1),j=m??(l?.min!==void 0?l.min:-1/0),C=p??(l?.max!==void 0?l.max:1/0);b.useEffect(()=>{k(String(s))},[s]);const T=L=>{k(L.target.value)},V=()=>{let L=N?parseInt(w,10):parseFloat(w);isNaN(L)&&(L=s),L=Math.max(j,Math.min(C,L)),i(L),k(String(L))},U=L=>{const $=(N?parseInt(w,10):parseFloat(w))||0,Y=Math.max(j,Math.min(C,$+L));i(Y)},R=[`number-input-field-${o}`,"w-full p-3 comfy-input text-base text-gray-900",c?"opacity-60 cursor-not-allowed":"",x?"border-red-700 ring-1 ring-red-700":""].filter(Boolean).join(" "),z=["w-10 h-10 flex items-center justify-center rounded-full bg-gray-100 text-gray-700 flex-shrink-0",c?"opacity-60 cursor-not-allowed":"active:scale-95 transition-all"].filter(Boolean).join(" ");return u.jsxs("div",{className:`${n??""} number-control-${o}`,children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:o}),u.jsxs("div",{className:`number-stepper-container-${o} flex items-center gap-2`,children:[u.jsx("input",{className:R,type:"number",value:w,onChange:T,onBlur:V,disabled:c,"aria-label":f?`${o} ${f}`:o}),u.jsx("button",{type:"button",onClick:()=>U(-S),className:z,"aria-label":"Decrease value",disabled:c,children:u.jsx(f2,{className:"w-4 h-4"})}),u.jsx("button",{type:"button",onClick:()=>U(S),className:z,"aria-label":"Increase value",disabled:c,children:u.jsx(zo,{className:"w-4 h-4"})})]})]})}function ys(n){"@babel/helpers - typeof";return ys=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(o){return typeof o}:function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},ys(n)}function TS(n,o){if(ys(n)!="object"||!n)return n;var s=n[Symbol.toPrimitive];if(s!==void 0){var l=s.call(n,o);if(ys(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(o==="string"?String:Number)(n)}function Cb(n){var o=TS(n,"string");return ys(o)=="symbol"?o:o+""}function ia(n,o,s){return(o=Cb(o))in n?Object.defineProperty(n,o,{value:s,enumerable:!0,configurable:!0,writable:!0}):n[o]=s,n}function ry(n,o){var s=Object.keys(n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(n);o&&(l=l.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),s.push.apply(s,l)}return s}function bt(n){for(var o=1;o<arguments.length;o++){var s=arguments[o]!=null?arguments[o]:{};o%2?ry(Object(s),!0).forEach(function(l){ia(n,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(s)):ry(Object(s)).forEach(function(l){Object.defineProperty(n,l,Object.getOwnPropertyDescriptor(s,l))})}return n}function ES(n){if(Array.isArray(n))return n}function IS(n,o){var s=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(s!=null){var l,i,c,f,m=[],p=!0,g=!1;try{if(c=(s=s.call(n)).next,o===0){if(Object(s)!==s)return;p=!1}else for(;!(p=(l=c.call(s)).done)&&(m.push(l.value),m.length!==o);p=!0);}catch(y){g=!0,i=y}finally{try{if(!p&&s.return!=null&&(f=s.return(),Object(f)!==f))return}finally{if(g)throw i}}return m}}function Vf(n,o){(o==null||o>n.length)&&(o=n.length);for(var s=0,l=Array(o);s<o;s++)l[s]=n[s];return l}function kb(n,o){if(n){if(typeof n=="string")return Vf(n,o);var s={}.toString.call(n).slice(8,-1);return s==="Object"&&n.constructor&&(s=n.constructor.name),s==="Map"||s==="Set"?Array.from(n):s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?Vf(n,o):void 0}}function LS(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mr(n,o){return ES(n)||IS(n,o)||kb(n,o)||LS()}function AS(n,o){if(n==null)return{};var s={};for(var l in n)if({}.hasOwnProperty.call(n,l)){if(o.indexOf(l)!==-1)continue;s[l]=n[l]}return s}function vr(n,o){if(n==null)return{};var s,l,i=AS(n,o);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(n);for(l=0;l<c.length;l++)s=c[l],o.indexOf(s)===-1&&{}.propertyIsEnumerable.call(n,s)&&(i[s]=n[s])}return i}var RS=["defaultInputValue","defaultMenuIsOpen","defaultValue","inputValue","menuIsOpen","onChange","onInputChange","onMenuClose","onMenuOpen","value"];function _S(n){var o=n.defaultInputValue,s=o===void 0?"":o,l=n.defaultMenuIsOpen,i=l===void 0?!1:l,c=n.defaultValue,f=c===void 0?null:c,m=n.inputValue,p=n.menuIsOpen,g=n.onChange,y=n.onInputChange,x=n.onMenuClose,w=n.onMenuOpen,k=n.value,N=vr(n,RS),S=b.useState(m!==void 0?m:s),j=mr(S,2),C=j[0],T=j[1],V=b.useState(p!==void 0?p:i),U=mr(V,2),R=U[0],z=U[1],L=b.useState(k!==void 0?k:f),$=mr(L,2),Y=$[0],ue=$[1],pe=b.useCallback(function(ce,Ue){typeof g=="function"&&g(ce,Ue),ue(ce)},[g]),fe=b.useCallback(function(ce,Ue){var De;typeof y=="function"&&(De=y(ce,Ue)),T(De!==void 0?De:ce)},[y]),Re=b.useCallback(function(){typeof w=="function"&&w(),z(!0)},[w]),Ie=b.useCallback(function(){typeof x=="function"&&x(),z(!1)},[x]),Ae=m!==void 0?m:C,_=p!==void 0?p:R,se=k!==void 0?k:Y;return bt(bt({},N),{},{inputValue:Ae,menuIsOpen:_,onChange:pe,onInputChange:fe,onMenuClose:Ie,onMenuOpen:Re,value:se})}function vt(){return vt=Object.assign?Object.assign.bind():function(n){for(var o=1;o<arguments.length;o++){var s=arguments[o];for(var l in s)({}).hasOwnProperty.call(s,l)&&(n[l]=s[l])}return n},vt.apply(null,arguments)}function DS(n,o){if(!(n instanceof o))throw new TypeError("Cannot call a class as a function")}function sy(n,o){for(var s=0;s<o.length;s++){var l=o[s];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(n,Cb(l.key),l)}}function BS(n,o,s){return o&&sy(n.prototype,o),s&&sy(n,s),Object.defineProperty(n,"prototype",{writable:!1}),n}function Kf(n,o){return Kf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,l){return s.__proto__=l,s},Kf(n,o)}function zS(n,o){if(typeof o!="function"&&o!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(o&&o.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),o&&Kf(n,o)}function Su(n){return Su=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(o){return o.__proto__||Object.getPrototypeOf(o)},Su(n)}function jb(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(jb=function(){return!!n})()}function HS(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function VS(n,o){if(o&&(ys(o)=="object"||typeof o=="function"))return o;if(o!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return HS(n)}function KS(n){var o=jb();return function(){var s,l=Su(n);if(o){var i=Su(this).constructor;s=Reflect.construct(l,arguments,i)}else s=l.apply(this,arguments);return VS(this,s)}}function US(n){if(Array.isArray(n))return Vf(n)}function $S(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function FS(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yp(n){return US(n)||$S(n)||kb(n)||FS()}function qS(n){if(n.sheet)return n.sheet;for(var o=0;o<document.styleSheets.length;o++)if(document.styleSheets[o].ownerNode===n)return document.styleSheets[o]}function WS(n){var o=document.createElement("style");return o.setAttribute("data-emotion",n.key),n.nonce!==void 0&&o.setAttribute("nonce",n.nonce),o.appendChild(document.createTextNode("")),o.setAttribute("data-s",""),o}var GS=(function(){function n(s){var l=this;this._insertTag=function(i){var c;l.tags.length===0?l.insertionPoint?c=l.insertionPoint.nextSibling:l.prepend?c=l.container.firstChild:c=l.before:c=l.tags[l.tags.length-1].nextSibling,l.container.insertBefore(i,c),l.tags.push(i)},this.isSpeedy=s.speedy===void 0?!0:s.speedy,this.tags=[],this.ctr=0,this.nonce=s.nonce,this.key=s.key,this.container=s.container,this.prepend=s.prepend,this.insertionPoint=s.insertionPoint,this.before=null}var o=n.prototype;return o.hydrate=function(l){l.forEach(this._insertTag)},o.insert=function(l){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(WS(this));var i=this.tags[this.tags.length-1];if(this.isSpeedy){var c=qS(i);try{c.insertRule(l,c.cssRules.length)}catch{}}else i.appendChild(document.createTextNode(l));this.ctr++},o.flush=function(){this.tags.forEach(function(l){var i;return(i=l.parentNode)==null?void 0:i.removeChild(l)}),this.tags=[],this.ctr=0},n})(),Vn="-ms-",Nu="-moz-",qt="-webkit-",Mb="comm",bp="rule",xp="decl",PS="@import",Ob="@keyframes",YS="@layer",QS=Math.abs,Du=String.fromCharCode,XS=Object.assign;function ZS(n,o){return Dn(n,0)^45?(((o<<2^Dn(n,0))<<2^Dn(n,1))<<2^Dn(n,2))<<2^Dn(n,3):0}function Tb(n){return n.trim()}function JS(n,o){return(n=o.exec(n))?n[0]:n}function Wt(n,o,s){return n.replace(o,s)}function Uf(n,o){return n.indexOf(o)}function Dn(n,o){return n.charCodeAt(o)|0}function va(n,o,s){return n.slice(o,s)}function Fo(n){return n.length}function vp(n){return n.length}function tu(n,o){return o.push(n),n}function eN(n,o){return n.map(o).join("")}var Bu=1,il=1,Eb=0,to=0,jn=0,dl="";function zu(n,o,s,l,i,c,f){return{value:n,root:o,parent:s,type:l,props:i,children:c,line:Bu,column:il,length:f,return:""}}function sa(n,o){return XS(zu("",null,null,"",null,null,0),n,{length:-n.length},o)}function tN(){return jn}function nN(){return jn=to>0?Dn(dl,--to):0,il--,jn===10&&(il=1,Bu--),jn}function go(){return jn=to<Eb?Dn(dl,to++):0,il++,jn===10&&(il=1,Bu++),jn}function Yo(){return Dn(dl,to)}function cu(){return to}function Ta(n,o){return va(dl,n,o)}function wa(n){switch(n){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function Ib(n){return Bu=il=1,Eb=Fo(dl=n),to=0,[]}function Lb(n){return dl="",n}function du(n){return Tb(Ta(to-1,$f(n===91?n+2:n===40?n+1:n)))}function oN(n){for(;(jn=Yo())&&jn<33;)go();return wa(n)>2||wa(jn)>3?"":" "}function rN(n,o){for(;--o&&go()&&!(jn<48||jn>102||jn>57&&jn<65||jn>70&&jn<97););return Ta(n,cu()+(o<6&&Yo()==32&&go()==32))}function $f(n){for(;go();)switch(jn){case n:return to;case 34:case 39:n!==34&&n!==39&&$f(jn);break;case 40:n===41&&$f(n);break;case 92:go();break}return to}function sN(n,o){for(;go()&&n+jn!==57;)if(n+jn===84&&Yo()===47)break;return"/*"+Ta(o,to-1)+"*"+Du(n===47?n:go())}function lN(n){for(;!wa(Yo());)go();return Ta(n,to)}function aN(n){return Lb(fu("",null,null,null,[""],n=Ib(n),0,[0],n))}function fu(n,o,s,l,i,c,f,m,p){for(var g=0,y=0,x=f,w=0,k=0,N=0,S=1,j=1,C=1,T=0,V="",U=i,R=c,z=l,L=V;j;)switch(N=T,T=go()){case 40:if(N!=108&&Dn(L,x-1)==58){Uf(L+=Wt(du(T),"&","&\f"),"&\f")!=-1&&(C=-1);break}case 34:case 39:case 91:L+=du(T);break;case 9:case 10:case 13:case 32:L+=oN(N);break;case 92:L+=rN(cu()-1,7);continue;case 47:switch(Yo()){case 42:case 47:tu(iN(sN(go(),cu()),o,s),p);break;default:L+="/"}break;case 123*S:m[g++]=Fo(L)*C;case 125*S:case 59:case 0:switch(T){case 0:case 125:j=0;case 59+y:C==-1&&(L=Wt(L,/\f/g,"")),k>0&&Fo(L)-x&&tu(k>32?ay(L+";",l,s,x-1):ay(Wt(L," ","")+";",l,s,x-2),p);break;case 59:L+=";";default:if(tu(z=ly(L,o,s,g,y,i,m,V,U=[],R=[],x),c),T===123)if(y===0)fu(L,o,z,z,U,c,x,m,R);else switch(w===99&&Dn(L,3)===110?100:w){case 100:case 108:case 109:case 115:fu(n,z,z,l&&tu(ly(n,z,z,0,0,i,m,V,i,U=[],x),R),i,R,x,m,l?U:R);break;default:fu(L,z,z,z,[""],R,0,m,R)}}g=y=k=0,S=C=1,V=L="",x=f;break;case 58:x=1+Fo(L),k=N;default:if(S<1){if(T==123)--S;else if(T==125&&S++==0&&nN()==125)continue}switch(L+=Du(T),T*S){case 38:C=y>0?1:(L+="\f",-1);break;case 44:m[g++]=(Fo(L)-1)*C,C=1;break;case 64:Yo()===45&&(L+=du(go())),w=Yo(),y=x=Fo(V=L+=lN(cu())),T++;break;case 45:N===45&&Fo(L)==2&&(S=0)}}return c}function ly(n,o,s,l,i,c,f,m,p,g,y){for(var x=i-1,w=i===0?c:[""],k=vp(w),N=0,S=0,j=0;N<l;++N)for(var C=0,T=va(n,x+1,x=QS(S=f[N])),V=n;C<k;++C)(V=Tb(S>0?w[C]+" "+T:Wt(T,/&\f/g,w[C])))&&(p[j++]=V);return zu(n,o,s,i===0?bp:m,p,g,y)}function iN(n,o,s){return zu(n,o,s,Mb,Du(tN()),va(n,2,-2),0)}function ay(n,o,s,l){return zu(n,o,s,xp,va(n,0,l),va(n,l+1,-1),l)}function sl(n,o){for(var s="",l=vp(n),i=0;i<l;i++)s+=o(n[i],i,n,o)||"";return s}function uN(n,o,s,l){switch(n.type){case YS:if(n.children.length)break;case PS:case xp:return n.return=n.return||n.value;case Mb:return"";case Ob:return n.return=n.value+"{"+sl(n.children,l)+"}";case bp:n.value=n.props.join(",")}return Fo(s=sl(n.children,l))?n.return=n.value+"{"+s+"}":""}function cN(n){var o=vp(n);return function(s,l,i,c){for(var f="",m=0;m<o;m++)f+=n[m](s,l,i,c)||"";return f}}function dN(n){return function(o){o.root||(o=o.return)&&n(o)}}function fN(n){var o=Object.create(null);return function(s){return o[s]===void 0&&(o[s]=n(s)),o[s]}}var pN=function(o,s,l){for(var i=0,c=0;i=c,c=Yo(),i===38&&c===12&&(s[l]=1),!wa(c);)go();return Ta(o,to)},hN=function(o,s){var l=-1,i=44;do switch(wa(i)){case 0:i===38&&Yo()===12&&(s[l]=1),o[l]+=pN(to-1,s,l);break;case 2:o[l]+=du(i);break;case 4:if(i===44){o[++l]=Yo()===58?"&\f":"",s[l]=o[l].length;break}default:o[l]+=Du(i)}while(i=go());return o},mN=function(o,s){return Lb(hN(Ib(o),s))},iy=new WeakMap,gN=function(o){if(!(o.type!=="rule"||!o.parent||o.length<1)){for(var s=o.value,l=o.parent,i=o.column===l.column&&o.line===l.line;l.type!=="rule";)if(l=l.parent,!l)return;if(!(o.props.length===1&&s.charCodeAt(0)!==58&&!iy.get(l))&&!i){iy.set(o,!0);for(var c=[],f=mN(s,c),m=l.props,p=0,g=0;p<f.length;p++)for(var y=0;y<m.length;y++,g++)o.props[g]=c[p]?f[p].replace(/&\f/g,m[y]):m[y]+" "+f[p]}}},yN=function(o){if(o.type==="decl"){var s=o.value;s.charCodeAt(0)===108&&s.charCodeAt(2)===98&&(o.return="",o.value="")}};function Ab(n,o){switch(ZS(n,o)){case 5103:return qt+"print-"+n+n;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return qt+n+n;case 5349:case 4246:case 4810:case 6968:case 2756:return qt+n+Nu+n+Vn+n+n;case 6828:case 4268:return qt+n+Vn+n+n;case 6165:return qt+n+Vn+"flex-"+n+n;case 5187:return qt+n+Wt(n,/(\w+).+(:[^]+)/,qt+"box-$1$2"+Vn+"flex-$1$2")+n;case 5443:return qt+n+Vn+"flex-item-"+Wt(n,/flex-|-self/,"")+n;case 4675:return qt+n+Vn+"flex-line-pack"+Wt(n,/align-content|flex-|-self/,"")+n;case 5548:return qt+n+Vn+Wt(n,"shrink","negative")+n;case 5292:return qt+n+Vn+Wt(n,"basis","preferred-size")+n;case 6060:return qt+"box-"+Wt(n,"-grow","")+qt+n+Vn+Wt(n,"grow","positive")+n;case 4554:return qt+Wt(n,/([^-])(transform)/g,"$1"+qt+"$2")+n;case 6187:return Wt(Wt(Wt(n,/(zoom-|grab)/,qt+"$1"),/(image-set)/,qt+"$1"),n,"")+n;case 5495:case 3959:return Wt(n,/(image-set\([^]*)/,qt+"$1$`$1");case 4968:return Wt(Wt(n,/(.+:)(flex-)?(.*)/,qt+"box-pack:$3"+Vn+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+qt+n+n;case 4095:case 3583:case 4068:case 2532:return Wt(n,/(.+)-inline(.+)/,qt+"$1$2")+n;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Fo(n)-1-o>6)switch(Dn(n,o+1)){case 109:if(Dn(n,o+4)!==45)break;case 102:return Wt(n,/(.+:)(.+)-([^]+)/,"$1"+qt+"$2-$3$1"+Nu+(Dn(n,o+3)==108?"$3":"$2-$3"))+n;case 115:return~Uf(n,"stretch")?Ab(Wt(n,"stretch","fill-available"),o)+n:n}break;case 4949:if(Dn(n,o+1)!==115)break;case 6444:switch(Dn(n,Fo(n)-3-(~Uf(n,"!important")&&10))){case 107:return Wt(n,":",":"+qt)+n;case 101:return Wt(n,/(.+:)([^;!]+)(;|!.+)?/,"$1"+qt+(Dn(n,14)===45?"inline-":"")+"box$3$1"+qt+"$2$3$1"+Vn+"$2box$3")+n}break;case 5936:switch(Dn(n,o+11)){case 114:return qt+n+Vn+Wt(n,/[svh]\w+-[tblr]{2}/,"tb")+n;case 108:return qt+n+Vn+Wt(n,/[svh]\w+-[tblr]{2}/,"tb-rl")+n;case 45:return qt+n+Vn+Wt(n,/[svh]\w+-[tblr]{2}/,"lr")+n}return qt+n+Vn+n+n}return n}var bN=function(o,s,l,i){if(o.length>-1&&!o.return)switch(o.type){case xp:o.return=Ab(o.value,o.length);break;case Ob:return sl([sa(o,{value:Wt(o.value,"@","@"+qt)})],i);case bp:if(o.length)return eN(o.props,function(c){switch(JS(c,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return sl([sa(o,{props:[Wt(c,/:(read-\w+)/,":"+Nu+"$1")]})],i);case"::placeholder":return sl([sa(o,{props:[Wt(c,/:(plac\w+)/,":"+qt+"input-$1")]}),sa(o,{props:[Wt(c,/:(plac\w+)/,":"+Nu+"$1")]}),sa(o,{props:[Wt(c,/:(plac\w+)/,Vn+"input-$1")]})],i)}return""})}},xN=[bN],vN=function(o){var s=o.key;if(s==="css"){var l=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(l,function(S){var j=S.getAttribute("data-emotion");j.indexOf(" ")!==-1&&(document.head.appendChild(S),S.setAttribute("data-s",""))})}var i=o.stylisPlugins||xN,c={},f,m=[];f=o.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+s+' "]'),function(S){for(var j=S.getAttribute("data-emotion").split(" "),C=1;C<j.length;C++)c[j[C]]=!0;m.push(S)});var p,g=[gN,yN];{var y,x=[uN,dN(function(S){y.insert(S)})],w=cN(g.concat(i,x)),k=function(j){return sl(aN(j),w)};p=function(j,C,T,V){y=T,k(j?j+"{"+C.styles+"}":C.styles),V&&(N.inserted[C.name]=!0)}}var N={key:s,sheet:new GS({key:s,container:f,nonce:o.nonce,speedy:o.speedy,prepend:o.prepend,insertionPoint:o.insertionPoint}),nonce:o.nonce,inserted:c,registered:{},insert:p};return N.sheet.hydrate(m),N},af={exports:{}},Pt={};var uy;function wN(){if(uy)return Pt;uy=1;var n=typeof Symbol=="function"&&Symbol.for,o=n?Symbol.for("react.element"):60103,s=n?Symbol.for("react.portal"):60106,l=n?Symbol.for("react.fragment"):60107,i=n?Symbol.for("react.strict_mode"):60108,c=n?Symbol.for("react.profiler"):60114,f=n?Symbol.for("react.provider"):60109,m=n?Symbol.for("react.context"):60110,p=n?Symbol.for("react.async_mode"):60111,g=n?Symbol.for("react.concurrent_mode"):60111,y=n?Symbol.for("react.forward_ref"):60112,x=n?Symbol.for("react.suspense"):60113,w=n?Symbol.for("react.suspense_list"):60120,k=n?Symbol.for("react.memo"):60115,N=n?Symbol.for("react.lazy"):60116,S=n?Symbol.for("react.block"):60121,j=n?Symbol.for("react.fundamental"):60117,C=n?Symbol.for("react.responder"):60118,T=n?Symbol.for("react.scope"):60119;function V(R){if(typeof R=="object"&&R!==null){var z=R.$$typeof;switch(z){case o:switch(R=R.type,R){case p:case g:case l:case c:case i:case x:return R;default:switch(R=R&&R.$$typeof,R){case m:case y:case N:case k:case f:return R;default:return z}}case s:return z}}}function U(R){return V(R)===g}return Pt.AsyncMode=p,Pt.ConcurrentMode=g,Pt.ContextConsumer=m,Pt.ContextProvider=f,Pt.Element=o,Pt.ForwardRef=y,Pt.Fragment=l,Pt.Lazy=N,Pt.Memo=k,Pt.Portal=s,Pt.Profiler=c,Pt.StrictMode=i,Pt.Suspense=x,Pt.isAsyncMode=function(R){return U(R)||V(R)===p},Pt.isConcurrentMode=U,Pt.isContextConsumer=function(R){return V(R)===m},Pt.isContextProvider=function(R){return V(R)===f},Pt.isElement=function(R){return typeof R=="object"&&R!==null&&R.$$typeof===o},Pt.isForwardRef=function(R){return V(R)===y},Pt.isFragment=function(R){return V(R)===l},Pt.isLazy=function(R){return V(R)===N},Pt.isMemo=function(R){return V(R)===k},Pt.isPortal=function(R){return V(R)===s},Pt.isProfiler=function(R){return V(R)===c},Pt.isStrictMode=function(R){return V(R)===i},Pt.isSuspense=function(R){return V(R)===x},Pt.isValidElementType=function(R){return typeof R=="string"||typeof R=="function"||R===l||R===g||R===c||R===i||R===x||R===w||typeof R=="object"&&R!==null&&(R.$$typeof===N||R.$$typeof===k||R.$$typeof===f||R.$$typeof===m||R.$$typeof===y||R.$$typeof===j||R.$$typeof===C||R.$$typeof===T||R.$$typeof===S)},Pt.typeOf=V,Pt}var cy;function SN(){return cy||(cy=1,af.exports=wN()),af.exports}var uf,dy;function NN(){if(dy)return uf;dy=1;var n=SN(),o={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},s={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},l={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},i={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},c={};c[n.ForwardRef]=l,c[n.Memo]=i;function f(N){return n.isMemo(N)?i:c[N.$$typeof]||o}var m=Object.defineProperty,p=Object.getOwnPropertyNames,g=Object.getOwnPropertySymbols,y=Object.getOwnPropertyDescriptor,x=Object.getPrototypeOf,w=Object.prototype;function k(N,S,j){if(typeof S!="string"){if(w){var C=x(S);C&&C!==w&&k(N,C,j)}var T=p(S);g&&(T=T.concat(g(S)));for(var V=f(N),U=f(S),R=0;R<T.length;++R){var z=T[R];if(!s[z]&&!(j&&j[z])&&!(U&&U[z])&&!(V&&V[z])){var L=y(S,z);try{m(N,z,L)}catch{}}}}return N}return uf=k,uf}NN();var CN=!0;function kN(n,o,s){var l="";return s.split(" ").forEach(function(i){n[i]!==void 0?o.push(n[i]+";"):i&&(l+=i+" ")}),l}var Rb=function(o,s,l){var i=o.key+"-"+s.name;(l===!1||CN===!1)&&o.registered[i]===void 0&&(o.registered[i]=s.styles)},jN=function(o,s,l){Rb(o,s,l);var i=o.key+"-"+s.name;if(o.inserted[s.name]===void 0){var c=s;do o.insert(s===c?"."+i:"",c,o.sheet,!0),c=c.next;while(c!==void 0)}};function MN(n){for(var o=0,s,l=0,i=n.length;i>=4;++l,i-=4)s=n.charCodeAt(l)&255|(n.charCodeAt(++l)&255)<<8|(n.charCodeAt(++l)&255)<<16|(n.charCodeAt(++l)&255)<<24,s=(s&65535)*1540483477+((s>>>16)*59797<<16),s^=s>>>24,o=(s&65535)*1540483477+((s>>>16)*59797<<16)^(o&65535)*1540483477+((o>>>16)*59797<<16);switch(i){case 3:o^=(n.charCodeAt(l+2)&255)<<16;case 2:o^=(n.charCodeAt(l+1)&255)<<8;case 1:o^=n.charCodeAt(l)&255,o=(o&65535)*1540483477+((o>>>16)*59797<<16)}return o^=o>>>13,o=(o&65535)*1540483477+((o>>>16)*59797<<16),((o^o>>>15)>>>0).toString(36)}var ON={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},TN=/[A-Z]|^ms/g,EN=/_EMO_([^_]+?)_([^]*?)_EMO_/g,_b=function(o){return o.charCodeAt(1)===45},fy=function(o){return o!=null&&typeof o!="boolean"},cf=fN(function(n){return _b(n)?n:n.replace(TN,"-$&").toLowerCase()}),py=function(o,s){switch(o){case"animation":case"animationName":if(typeof s=="string")return s.replace(EN,function(l,i,c){return qo={name:i,styles:c,next:qo},i})}return ON[o]!==1&&!_b(o)&&typeof s=="number"&&s!==0?s+"px":s};function Sa(n,o,s){if(s==null)return"";var l=s;if(l.__emotion_styles!==void 0)return l;switch(typeof s){case"boolean":return"";case"object":{var i=s;if(i.anim===1)return qo={name:i.name,styles:i.styles,next:qo},i.name;var c=s;if(c.styles!==void 0){var f=c.next;if(f!==void 0)for(;f!==void 0;)qo={name:f.name,styles:f.styles,next:qo},f=f.next;var m=c.styles+";";return m}return IN(n,o,s)}case"function":{if(n!==void 0){var p=qo,g=s(n);return qo=p,Sa(n,o,g)}break}}var y=s;return y}function IN(n,o,s){var l="";if(Array.isArray(s))for(var i=0;i<s.length;i++)l+=Sa(n,o,s[i])+";";else for(var c in s){var f=s[c];if(typeof f!="object"){var m=f;fy(m)&&(l+=cf(c)+":"+py(c,m)+";")}else if(Array.isArray(f)&&typeof f[0]=="string"&&o==null)for(var p=0;p<f.length;p++)fy(f[p])&&(l+=cf(c)+":"+py(c,f[p])+";");else{var g=Sa(n,o,f);switch(c){case"animation":case"animationName":{l+=cf(c)+":"+g+";";break}default:l+=c+"{"+g+"}"}}}return l}var hy=/label:\s*([^\s;{]+)\s*(;|$)/g,qo;function Db(n,o,s){if(n.length===1&&typeof n[0]=="object"&&n[0]!==null&&n[0].styles!==void 0)return n[0];var l=!0,i="";qo=void 0;var c=n[0];if(c==null||c.raw===void 0)l=!1,i+=Sa(s,o,c);else{var f=c;i+=f[0]}for(var m=1;m<n.length;m++)if(i+=Sa(s,o,n[m]),l){var p=c;i+=p[m]}hy.lastIndex=0;for(var g="",y;(y=hy.exec(i))!==null;)g+="-"+y[1];var x=MN(i)+g;return{name:x,styles:i,next:qo}}var LN=function(o){return o()},AN=p0.useInsertionEffect?p0.useInsertionEffect:!1,RN=AN||LN,Bb=b.createContext(typeof HTMLElement<"u"?vN({key:"css"}):null);Bb.Provider;var _N=function(o){return b.forwardRef(function(s,l){var i=b.useContext(Bb);return o(s,i,l)})},DN=b.createContext({}),wp={}.hasOwnProperty,Ff="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",BN=function(o,s){var l={};for(var i in s)wp.call(s,i)&&(l[i]=s[i]);return l[Ff]=o,l},zN=function(o){var s=o.cache,l=o.serialized,i=o.isStringTag;return Rb(s,l,i),RN(function(){return jN(s,l,i)}),null},HN=_N(function(n,o,s){var l=n.css;typeof l=="string"&&o.registered[l]!==void 0&&(l=o.registered[l]);var i=n[Ff],c=[l],f="";typeof n.className=="string"?f=kN(o.registered,c,n.className):n.className!=null&&(f=n.className+" ");var m=Db(c,void 0,b.useContext(DN));f+=o.key+"-"+m.name;var p={};for(var g in n)wp.call(n,g)&&g!=="css"&&g!==Ff&&(p[g]=n[g]);return p.className=f,s&&(p.ref=s),b.createElement(b.Fragment,null,b.createElement(zN,{cache:o,serialized:m,isStringTag:typeof i=="string"}),b.createElement(i,p))}),VN=HN,gt=function(o,s){var l=arguments;if(s==null||!wp.call(s,"css"))return b.createElement.apply(void 0,l);var i=l.length,c=new Array(i);c[0]=VN,c[1]=BN(o,s);for(var f=2;f<i;f++)c[f]=l[f];return b.createElement.apply(null,c)};(function(n){var o;o||(o=n.JSX||(n.JSX={}))})(gt||(gt={}));function Sp(){for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return Db(o)}function KN(){var n=Sp.apply(void 0,arguments),o="animation-"+n.name;return{name:o,styles:"@keyframes "+o+"{"+n.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}function UN(n,o){return o||(o=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(o)}}))}const $N=Math.min,FN=Math.max,Cu=Math.round,nu=Math.floor,ku=n=>({x:n,y:n});function qN(n){const{x:o,y:s,width:l,height:i}=n;return{width:l,height:i,top:s,left:o,right:o+l,bottom:s+i,x:o,y:s}}function Hu(){return typeof window<"u"}function zb(n){return Vb(n)?(n.nodeName||"").toLowerCase():"#document"}function yr(n){var o;return(n==null||(o=n.ownerDocument)==null?void 0:o.defaultView)||window}function Hb(n){var o;return(o=(Vb(n)?n.ownerDocument:n.document)||window.document)==null?void 0:o.documentElement}function Vb(n){return Hu()?n instanceof Node||n instanceof yr(n).Node:!1}function WN(n){return Hu()?n instanceof Element||n instanceof yr(n).Element:!1}function Np(n){return Hu()?n instanceof HTMLElement||n instanceof yr(n).HTMLElement:!1}function my(n){return!Hu()||typeof ShadowRoot>"u"?!1:n instanceof ShadowRoot||n instanceof yr(n).ShadowRoot}const GN=new Set(["inline","contents"]);function Kb(n){const{overflow:o,overflowX:s,overflowY:l,display:i}=Cp(n);return/auto|scroll|overlay|hidden|clip/.test(o+l+s)&&!GN.has(i)}function PN(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const YN=new Set(["html","body","#document"]);function QN(n){return YN.has(zb(n))}function Cp(n){return yr(n).getComputedStyle(n)}function XN(n){if(zb(n)==="html")return n;const o=n.assignedSlot||n.parentNode||my(n)&&n.host||Hb(n);return my(o)?o.host:o}function Ub(n){const o=XN(n);return QN(o)?n.ownerDocument?n.ownerDocument.body:n.body:Np(o)&&Kb(o)?o:Ub(o)}function ju(n,o,s){var l;o===void 0&&(o=[]),s===void 0&&(s=!0);const i=Ub(n),c=i===((l=n.ownerDocument)==null?void 0:l.body),f=yr(i);if(c){const m=qf(f);return o.concat(f,f.visualViewport||[],Kb(i)?i:[],m&&s?ju(m):[])}return o.concat(i,ju(i,[],s))}function qf(n){return n.parent&&Object.getPrototypeOf(n.parent)?n.frameElement:null}function ZN(n){const o=Cp(n);let s=parseFloat(o.width)||0,l=parseFloat(o.height)||0;const i=Np(n),c=i?n.offsetWidth:s,f=i?n.offsetHeight:l,m=Cu(s)!==c||Cu(l)!==f;return m&&(s=c,l=f),{width:s,height:l,$:m}}function kp(n){return WN(n)?n:n.contextElement}function gy(n){const o=kp(n);if(!Np(o))return ku(1);const s=o.getBoundingClientRect(),{width:l,height:i,$:c}=ZN(o);let f=(c?Cu(s.width):s.width)/l,m=(c?Cu(s.height):s.height)/i;return(!f||!Number.isFinite(f))&&(f=1),(!m||!Number.isFinite(m))&&(m=1),{x:f,y:m}}const JN=ku(0);function e3(n){const o=yr(n);return!PN()||!o.visualViewport?JN:{x:o.visualViewport.offsetLeft,y:o.visualViewport.offsetTop}}function t3(n,o,s){return!1}function yy(n,o,s,l){o===void 0&&(o=!1);const i=n.getBoundingClientRect(),c=kp(n);let f=ku(1);o&&(f=gy(n));const m=t3()?e3(c):ku(0);let p=(i.left+m.x)/f.x,g=(i.top+m.y)/f.y,y=i.width/f.x,x=i.height/f.y;if(c){const w=yr(c),k=l;let N=w,S=qf(N);for(;S&&l&&k!==N;){const j=gy(S),C=S.getBoundingClientRect(),T=Cp(S),V=C.left+(S.clientLeft+parseFloat(T.paddingLeft))*j.x,U=C.top+(S.clientTop+parseFloat(T.paddingTop))*j.y;p*=j.x,g*=j.y,y*=j.x,x*=j.y,p+=V,g+=U,N=yr(S),S=qf(N)}}return qN({width:y,height:x,x:p,y:g})}function $b(n,o){return n.x===o.x&&n.y===o.y&&n.width===o.width&&n.height===o.height}function n3(n,o){let s=null,l;const i=Hb(n);function c(){var m;clearTimeout(l),(m=s)==null||m.disconnect(),s=null}function f(m,p){m===void 0&&(m=!1),p===void 0&&(p=1),c();const g=n.getBoundingClientRect(),{left:y,top:x,width:w,height:k}=g;if(m||o(),!w||!k)return;const N=nu(x),S=nu(i.clientWidth-(y+w)),j=nu(i.clientHeight-(x+k)),C=nu(y),V={rootMargin:-N+"px "+-S+"px "+-j+"px "+-C+"px",threshold:FN(0,$N(1,p))||1};let U=!0;function R(z){const L=z[0].intersectionRatio;if(L!==p){if(!U)return f();L?f(!1,L):l=setTimeout(()=>{f(!1,1e-7)},1e3)}L===1&&!$b(g,n.getBoundingClientRect())&&f(),U=!1}try{s=new IntersectionObserver(R,{...V,root:i.ownerDocument})}catch{s=new IntersectionObserver(R,V)}s.observe(n)}return f(!0),c}function o3(n,o,s,l){l===void 0&&(l={});const{ancestorScroll:i=!0,ancestorResize:c=!0,elementResize:f=typeof ResizeObserver=="function",layoutShift:m=typeof IntersectionObserver=="function",animationFrame:p=!1}=l,g=kp(n),y=i||c?[...g?ju(g):[],...ju(o)]:[];y.forEach(C=>{i&&C.addEventListener("scroll",s,{passive:!0}),c&&C.addEventListener("resize",s)});const x=g&&m?n3(g,s):null;let w=-1,k=null;f&&(k=new ResizeObserver(C=>{let[T]=C;T&&T.target===g&&k&&(k.unobserve(o),cancelAnimationFrame(w),w=requestAnimationFrame(()=>{var V;(V=k)==null||V.observe(o)})),s()}),g&&!p&&k.observe(g),k.observe(o));let N,S=p?yy(n):null;p&&j();function j(){const C=yy(n);S&&!$b(S,C)&&s(),S=C,N=requestAnimationFrame(j)}return s(),()=>{var C;y.forEach(T=>{i&&T.removeEventListener("scroll",s),c&&T.removeEventListener("resize",s)}),x?.(),(C=k)==null||C.disconnect(),k=null,p&&cancelAnimationFrame(N)}}var Wf=b.useLayoutEffect,r3=["className","clearValue","cx","getStyles","getClassNames","getValue","hasValue","isMulti","isRtl","options","selectOption","selectProps","setValue","theme"],Mu=function(){};function s3(n,o){return o?o[0]==="-"?n+o:n+"__"+o:n}function l3(n,o){for(var s=arguments.length,l=new Array(s>2?s-2:0),i=2;i<s;i++)l[i-2]=arguments[i];var c=[].concat(l);if(o&&n)for(var f in o)o.hasOwnProperty(f)&&o[f]&&c.push("".concat(s3(n,f)));return c.filter(function(m){return m}).map(function(m){return String(m).trim()}).join(" ")}var by=function(o){return m3(o)?o.filter(Boolean):ys(o)==="object"&&o!==null?[o]:[]},Fb=function(o){o.className,o.clearValue,o.cx,o.getStyles,o.getClassNames,o.getValue,o.hasValue,o.isMulti,o.isRtl,o.options,o.selectOption,o.selectProps,o.setValue,o.theme;var s=vr(o,r3);return bt({},s)},gn=function(o,s,l){var i=o.cx,c=o.getStyles,f=o.getClassNames,m=o.className;return{css:c(s,o),className:i(l??{},f(s,o),m)}};function Vu(n){return[document.documentElement,document.body,window].indexOf(n)>-1}function a3(n){return Vu(n)?window.innerHeight:n.clientHeight}function qb(n){return Vu(n)?window.pageYOffset:n.scrollTop}function Ou(n,o){if(Vu(n)){window.scrollTo(0,o);return}n.scrollTop=o}function i3(n){var o=getComputedStyle(n),s=o.position==="absolute",l=/(auto|scroll)/;if(o.position==="fixed")return document.documentElement;for(var i=n;i=i.parentElement;)if(o=getComputedStyle(i),!(s&&o.position==="static")&&l.test(o.overflow+o.overflowY+o.overflowX))return i;return document.documentElement}function u3(n,o,s,l){return s*((n=n/l-1)*n*n+1)+o}function ou(n,o){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:200,l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Mu,i=qb(n),c=o-i,f=10,m=0;function p(){m+=f;var g=u3(m,i,c,s);Ou(n,g),m<s?window.requestAnimationFrame(p):l(n)}p()}function xy(n,o){var s=n.getBoundingClientRect(),l=o.getBoundingClientRect(),i=o.offsetHeight/3;l.bottom+i>s.bottom?Ou(n,Math.min(o.offsetTop+o.clientHeight-n.offsetHeight+i,n.scrollHeight)):l.top-i<s.top&&Ou(n,Math.max(o.offsetTop-i,0))}function c3(n){var o=n.getBoundingClientRect();return{bottom:o.bottom,height:o.height,left:o.left,right:o.right,top:o.top,width:o.width}}function vy(){try{return document.createEvent("TouchEvent"),!0}catch{return!1}}function d3(){try{return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}catch{return!1}}var Wb=!1,f3={get passive(){return Wb=!0}},ru=typeof window<"u"?window:{};ru.addEventListener&&ru.removeEventListener&&(ru.addEventListener("p",Mu,f3),ru.removeEventListener("p",Mu,!1));var p3=Wb;function h3(n){return n!=null}function m3(n){return Array.isArray(n)}function su(n,o,s){return n?o:s}var g3=function(o){for(var s=arguments.length,l=new Array(s>1?s-1:0),i=1;i<s;i++)l[i-1]=arguments[i];var c=Object.entries(o).filter(function(f){var m=mr(f,1),p=m[0];return!l.includes(p)});return c.reduce(function(f,m){var p=mr(m,2),g=p[0],y=p[1];return f[g]=y,f},{})},y3=["children","innerProps"],b3=["children","innerProps"];function x3(n){var o=n.maxHeight,s=n.menuEl,l=n.minHeight,i=n.placement,c=n.shouldScroll,f=n.isFixedPosition,m=n.controlHeight,p=i3(s),g={placement:"bottom",maxHeight:o};if(!s||!s.offsetParent)return g;var y=p.getBoundingClientRect(),x=y.height,w=s.getBoundingClientRect(),k=w.bottom,N=w.height,S=w.top,j=s.offsetParent.getBoundingClientRect(),C=j.top,T=f?window.innerHeight:a3(p),V=qb(p),U=parseInt(getComputedStyle(s).marginBottom,10),R=parseInt(getComputedStyle(s).marginTop,10),z=C-R,L=T-S,$=z+V,Y=x-V-S,ue=k-T+V+U,pe=V+S-R,fe=160;switch(i){case"auto":case"bottom":if(L>=N)return{placement:"bottom",maxHeight:o};if(Y>=N&&!f)return c&&ou(p,ue,fe),{placement:"bottom",maxHeight:o};if(!f&&Y>=l||f&&L>=l){c&&ou(p,ue,fe);var Re=f?L-U:Y-U;return{placement:"bottom",maxHeight:Re}}if(i==="auto"||f){var Ie=o,Ae=f?z:$;return Ae>=l&&(Ie=Math.min(Ae-U-m,o)),{placement:"top",maxHeight:Ie}}if(i==="bottom")return c&&Ou(p,ue),{placement:"bottom",maxHeight:o};break;case"top":if(z>=N)return{placement:"top",maxHeight:o};if($>=N&&!f)return c&&ou(p,pe,fe),{placement:"top",maxHeight:o};if(!f&&$>=l||f&&z>=l){var _=o;return(!f&&$>=l||f&&z>=l)&&(_=f?z-R:$-R),c&&ou(p,pe,fe),{placement:"top",maxHeight:_}}return{placement:"bottom",maxHeight:o};default:throw new Error('Invalid placement provided "'.concat(i,'".'))}return g}function v3(n){var o={bottom:"top",top:"bottom"};return n?o[n]:"bottom"}var Gb=function(o){return o==="auto"?"bottom":o},w3=function(o,s){var l,i=o.placement,c=o.theme,f=c.borderRadius,m=c.spacing,p=c.colors;return bt((l={label:"menu"},ia(l,v3(i),"100%"),ia(l,"position","absolute"),ia(l,"width","100%"),ia(l,"zIndex",1),l),s?{}:{backgroundColor:p.neutral0,borderRadius:f,boxShadow:"0 0 0 1px hsla(0, 0%, 0%, 0.1), 0 4px 11px hsla(0, 0%, 0%, 0.1)",marginBottom:m.menuGutter,marginTop:m.menuGutter})},Pb=b.createContext(null),S3=function(o){var s=o.children,l=o.minMenuHeight,i=o.maxMenuHeight,c=o.menuPlacement,f=o.menuPosition,m=o.menuShouldScrollIntoView,p=o.theme,g=b.useContext(Pb)||{},y=g.setPortalPlacement,x=b.useRef(null),w=b.useState(i),k=mr(w,2),N=k[0],S=k[1],j=b.useState(null),C=mr(j,2),T=C[0],V=C[1],U=p.spacing.controlHeight;return Wf(function(){var R=x.current;if(R){var z=f==="fixed",L=m&&!z,$=x3({maxHeight:i,menuEl:R,minHeight:l,placement:c,shouldScroll:L,isFixedPosition:z,controlHeight:U});S($.maxHeight),V($.placement),y?.($.placement)}},[i,c,f,m,l,y,U]),s({ref:x,placerProps:bt(bt({},o),{},{placement:T||Gb(c),maxHeight:N})})},N3=function(o){var s=o.children,l=o.innerRef,i=o.innerProps;return gt("div",vt({},gn(o,"menu",{menu:!0}),{ref:l},i),s)},C3=N3,k3=function(o,s){var l=o.maxHeight,i=o.theme.spacing.baseUnit;return bt({maxHeight:l,overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},s?{}:{paddingBottom:i,paddingTop:i})},j3=function(o){var s=o.children,l=o.innerProps,i=o.innerRef,c=o.isMulti;return gt("div",vt({},gn(o,"menuList",{"menu-list":!0,"menu-list--is-multi":c}),{ref:i},l),s)},Yb=function(o,s){var l=o.theme,i=l.spacing.baseUnit,c=l.colors;return bt({textAlign:"center"},s?{}:{color:c.neutral40,padding:"".concat(i*2,"px ").concat(i*3,"px")})},M3=Yb,O3=Yb,T3=function(o){var s=o.children,l=s===void 0?"No options":s,i=o.innerProps,c=vr(o,y3);return gt("div",vt({},gn(bt(bt({},c),{},{children:l,innerProps:i}),"noOptionsMessage",{"menu-notice":!0,"menu-notice--no-options":!0}),i),l)},E3=function(o){var s=o.children,l=s===void 0?"Loading...":s,i=o.innerProps,c=vr(o,b3);return gt("div",vt({},gn(bt(bt({},c),{},{children:l,innerProps:i}),"loadingMessage",{"menu-notice":!0,"menu-notice--loading":!0}),i),l)},I3=function(o){var s=o.rect,l=o.offset,i=o.position;return{left:s.left,position:i,top:l,width:s.width,zIndex:1}},L3=function(o){var s=o.appendTo,l=o.children,i=o.controlElement,c=o.innerProps,f=o.menuPlacement,m=o.menuPosition,p=b.useRef(null),g=b.useRef(null),y=b.useState(Gb(f)),x=mr(y,2),w=x[0],k=x[1],N=b.useMemo(function(){return{setPortalPlacement:k}},[]),S=b.useState(null),j=mr(S,2),C=j[0],T=j[1],V=b.useCallback(function(){if(i){var L=c3(i),$=m==="fixed"?0:window.pageYOffset,Y=L[w]+$;(Y!==C?.offset||L.left!==C?.rect.left||L.width!==C?.rect.width)&&T({offset:Y,rect:L})}},[i,m,w,C?.offset,C?.rect.left,C?.rect.width]);Wf(function(){V()},[V]);var U=b.useCallback(function(){typeof g.current=="function"&&(g.current(),g.current=null),i&&p.current&&(g.current=o3(i,p.current,V,{elementResize:"ResizeObserver"in window}))},[i,V]);Wf(function(){U()},[U]);var R=b.useCallback(function(L){p.current=L,U()},[U]);if(!s&&m!=="fixed"||!C)return null;var z=gt("div",vt({ref:R},gn(bt(bt({},o),{},{offset:C.offset,position:m,rect:C.rect}),"menuPortal",{"menu-portal":!0}),c),l);return gt(Pb.Provider,{value:N},s?Mn.createPortal(z,s):z)},A3=function(o){var s=o.isDisabled,l=o.isRtl;return{label:"container",direction:l?"rtl":void 0,pointerEvents:s?"none":void 0,position:"relative"}},R3=function(o){var s=o.children,l=o.innerProps,i=o.isDisabled,c=o.isRtl;return gt("div",vt({},gn(o,"container",{"--is-disabled":i,"--is-rtl":c}),l),s)},_3=function(o,s){var l=o.theme.spacing,i=o.isMulti,c=o.hasValue,f=o.selectProps.controlShouldRenderValue;return bt({alignItems:"center",display:i&&c&&f?"flex":"grid",flex:1,flexWrap:"wrap",WebkitOverflowScrolling:"touch",position:"relative",overflow:"hidden"},s?{}:{padding:"".concat(l.baseUnit/2,"px ").concat(l.baseUnit*2,"px")})},D3=function(o){var s=o.children,l=o.innerProps,i=o.isMulti,c=o.hasValue;return gt("div",vt({},gn(o,"valueContainer",{"value-container":!0,"value-container--is-multi":i,"value-container--has-value":c}),l),s)},B3=function(){return{alignItems:"center",alignSelf:"stretch",display:"flex",flexShrink:0}},z3=function(o){var s=o.children,l=o.innerProps;return gt("div",vt({},gn(o,"indicatorsContainer",{indicators:!0}),l),s)},wy,H3=["size"],V3=["innerProps","isRtl","size"],K3={name:"8mmkcg",styles:"display:inline-block;fill:currentColor;line-height:1;stroke:currentColor;stroke-width:0"},Qb=function(o){var s=o.size,l=vr(o,H3);return gt("svg",vt({height:s,width:s,viewBox:"0 0 20 20","aria-hidden":"true",focusable:"false",css:K3},l))},jp=function(o){return gt(Qb,vt({size:20},o),gt("path",{d:"M14.348 14.849c-0.469 0.469-1.229 0.469-1.697 0l-2.651-3.030-2.651 3.029c-0.469 0.469-1.229 0.469-1.697 0-0.469-0.469-0.469-1.229 0-1.697l2.758-3.15-2.759-3.152c-0.469-0.469-0.469-1.228 0-1.697s1.228-0.469 1.697 0l2.652 3.031 2.651-3.031c0.469-0.469 1.228-0.469 1.697 0s0.469 1.229 0 1.697l-2.758 3.152 2.758 3.15c0.469 0.469 0.469 1.229 0 1.698z"}))},Xb=function(o){return gt(Qb,vt({size:20},o),gt("path",{d:"M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"}))},Zb=function(o,s){var l=o.isFocused,i=o.theme,c=i.spacing.baseUnit,f=i.colors;return bt({label:"indicatorContainer",display:"flex",transition:"color 150ms"},s?{}:{color:l?f.neutral60:f.neutral20,padding:c*2,":hover":{color:l?f.neutral80:f.neutral40}})},U3=Zb,$3=function(o){var s=o.children,l=o.innerProps;return gt("div",vt({},gn(o,"dropdownIndicator",{indicator:!0,"dropdown-indicator":!0}),l),s||gt(Xb,null))},F3=Zb,q3=function(o){var s=o.children,l=o.innerProps;return gt("div",vt({},gn(o,"clearIndicator",{indicator:!0,"clear-indicator":!0}),l),s||gt(jp,null))},W3=function(o,s){var l=o.isDisabled,i=o.theme,c=i.spacing.baseUnit,f=i.colors;return bt({label:"indicatorSeparator",alignSelf:"stretch",width:1},s?{}:{backgroundColor:l?f.neutral10:f.neutral20,marginBottom:c*2,marginTop:c*2})},G3=function(o){var s=o.innerProps;return gt("span",vt({},s,gn(o,"indicatorSeparator",{"indicator-separator":!0})))},P3=KN(wy||(wy=UN([`
  0%, 80%, 100% { opacity: 0; }
  40% { opacity: 1; }
`]))),Y3=function(o,s){var l=o.isFocused,i=o.size,c=o.theme,f=c.colors,m=c.spacing.baseUnit;return bt({label:"loadingIndicator",display:"flex",transition:"color 150ms",alignSelf:"center",fontSize:i,lineHeight:1,marginRight:i,textAlign:"center",verticalAlign:"middle"},s?{}:{color:l?f.neutral60:f.neutral20,padding:m*2})},df=function(o){var s=o.delay,l=o.offset;return gt("span",{css:Sp({animation:"".concat(P3," 1s ease-in-out ").concat(s,"ms infinite;"),backgroundColor:"currentColor",borderRadius:"1em",display:"inline-block",marginLeft:l?"1em":void 0,height:"1em",verticalAlign:"top",width:"1em"},"","")})},Q3=function(o){var s=o.innerProps,l=o.isRtl,i=o.size,c=i===void 0?4:i,f=vr(o,V3);return gt("div",vt({},gn(bt(bt({},f),{},{innerProps:s,isRtl:l,size:c}),"loadingIndicator",{indicator:!0,"loading-indicator":!0}),s),gt(df,{delay:0,offset:l}),gt(df,{delay:160,offset:!0}),gt(df,{delay:320,offset:!l}))},X3=function(o,s){var l=o.isDisabled,i=o.isFocused,c=o.theme,f=c.colors,m=c.borderRadius,p=c.spacing;return bt({label:"control",alignItems:"center",cursor:"default",display:"flex",flexWrap:"wrap",justifyContent:"space-between",minHeight:p.controlHeight,outline:"0 !important",position:"relative",transition:"all 100ms"},s?{}:{backgroundColor:l?f.neutral5:f.neutral0,borderColor:l?f.neutral10:i?f.primary:f.neutral20,borderRadius:m,borderStyle:"solid",borderWidth:1,boxShadow:i?"0 0 0 1px ".concat(f.primary):void 0,"&:hover":{borderColor:i?f.primary:f.neutral30}})},Z3=function(o){var s=o.children,l=o.isDisabled,i=o.isFocused,c=o.innerRef,f=o.innerProps,m=o.menuIsOpen;return gt("div",vt({ref:c},gn(o,"control",{control:!0,"control--is-disabled":l,"control--is-focused":i,"control--menu-is-open":m}),f,{"aria-disabled":l||void 0}),s)},J3=Z3,eC=["data"],tC=function(o,s){var l=o.theme.spacing;return s?{}:{paddingBottom:l.baseUnit*2,paddingTop:l.baseUnit*2}},nC=function(o){var s=o.children,l=o.cx,i=o.getStyles,c=o.getClassNames,f=o.Heading,m=o.headingProps,p=o.innerProps,g=o.label,y=o.theme,x=o.selectProps;return gt("div",vt({},gn(o,"group",{group:!0}),p),gt(f,vt({},m,{selectProps:x,theme:y,getStyles:i,getClassNames:c,cx:l}),g),gt("div",null,s))},oC=function(o,s){var l=o.theme,i=l.colors,c=l.spacing;return bt({label:"group",cursor:"default",display:"block"},s?{}:{color:i.neutral40,fontSize:"75%",fontWeight:500,marginBottom:"0.25em",paddingLeft:c.baseUnit*3,paddingRight:c.baseUnit*3,textTransform:"uppercase"})},rC=function(o){var s=Fb(o);s.data;var l=vr(s,eC);return gt("div",vt({},gn(o,"groupHeading",{"group-heading":!0}),l))},sC=nC,lC=["innerRef","isDisabled","isHidden","inputClassName"],aC=function(o,s){var l=o.isDisabled,i=o.value,c=o.theme,f=c.spacing,m=c.colors;return bt(bt({visibility:l?"hidden":"visible",transform:i?"translateZ(0)":""},iC),s?{}:{margin:f.baseUnit/2,paddingBottom:f.baseUnit/2,paddingTop:f.baseUnit/2,color:m.neutral80})},Jb={gridArea:"1 / 2",font:"inherit",minWidth:"2px",border:0,margin:0,outline:0,padding:0},iC={flex:"1 1 auto",display:"inline-grid",gridArea:"1 / 1 / 2 / 3",gridTemplateColumns:"0 min-content","&:after":bt({content:'attr(data-value) " "',visibility:"hidden",whiteSpace:"pre"},Jb)},uC=function(o){return bt({label:"input",color:"inherit",background:0,opacity:o?0:1,width:"100%"},Jb)},cC=function(o){var s=o.cx,l=o.value,i=Fb(o),c=i.innerRef,f=i.isDisabled,m=i.isHidden,p=i.inputClassName,g=vr(i,lC);return gt("div",vt({},gn(o,"input",{"input-container":!0}),{"data-value":l||""}),gt("input",vt({className:s({input:!0},p),ref:c,style:uC(m),disabled:f},g)))},dC=cC,fC=function(o,s){var l=o.theme,i=l.spacing,c=l.borderRadius,f=l.colors;return bt({label:"multiValue",display:"flex",minWidth:0},s?{}:{backgroundColor:f.neutral10,borderRadius:c/2,margin:i.baseUnit/2})},pC=function(o,s){var l=o.theme,i=l.borderRadius,c=l.colors,f=o.cropWithEllipsis;return bt({overflow:"hidden",textOverflow:f||f===void 0?"ellipsis":void 0,whiteSpace:"nowrap"},s?{}:{borderRadius:i/2,color:c.neutral80,fontSize:"85%",padding:3,paddingLeft:6})},hC=function(o,s){var l=o.theme,i=l.spacing,c=l.borderRadius,f=l.colors,m=o.isFocused;return bt({alignItems:"center",display:"flex"},s?{}:{borderRadius:c/2,backgroundColor:m?f.dangerLight:void 0,paddingLeft:i.baseUnit,paddingRight:i.baseUnit,":hover":{backgroundColor:f.dangerLight,color:f.danger}})},ex=function(o){var s=o.children,l=o.innerProps;return gt("div",l,s)},mC=ex,gC=ex;function yC(n){var o=n.children,s=n.innerProps;return gt("div",vt({role:"button"},s),o||gt(jp,{size:14}))}var bC=function(o){var s=o.children,l=o.components,i=o.data,c=o.innerProps,f=o.isDisabled,m=o.removeProps,p=o.selectProps,g=l.Container,y=l.Label,x=l.Remove;return gt(g,{data:i,innerProps:bt(bt({},gn(o,"multiValue",{"multi-value":!0,"multi-value--is-disabled":f})),c),selectProps:p},gt(y,{data:i,innerProps:bt({},gn(o,"multiValueLabel",{"multi-value__label":!0})),selectProps:p},s),gt(x,{data:i,innerProps:bt(bt({},gn(o,"multiValueRemove",{"multi-value__remove":!0})),{},{"aria-label":"Remove ".concat(s||"option")},m),selectProps:p}))},xC=bC,vC=function(o,s){var l=o.isDisabled,i=o.isFocused,c=o.isSelected,f=o.theme,m=f.spacing,p=f.colors;return bt({label:"option",cursor:"default",display:"block",fontSize:"inherit",width:"100%",userSelect:"none",WebkitTapHighlightColor:"rgba(0, 0, 0, 0)"},s?{}:{backgroundColor:c?p.primary:i?p.primary25:"transparent",color:l?p.neutral20:c?p.neutral0:"inherit",padding:"".concat(m.baseUnit*2,"px ").concat(m.baseUnit*3,"px"),":active":{backgroundColor:l?void 0:c?p.primary:p.primary50}})},wC=function(o){var s=o.children,l=o.isDisabled,i=o.isFocused,c=o.isSelected,f=o.innerRef,m=o.innerProps;return gt("div",vt({},gn(o,"option",{option:!0,"option--is-disabled":l,"option--is-focused":i,"option--is-selected":c}),{ref:f,"aria-disabled":l},m),s)},SC=wC,NC=function(o,s){var l=o.theme,i=l.spacing,c=l.colors;return bt({label:"placeholder",gridArea:"1 / 1 / 2 / 3"},s?{}:{color:c.neutral50,marginLeft:i.baseUnit/2,marginRight:i.baseUnit/2})},CC=function(o){var s=o.children,l=o.innerProps;return gt("div",vt({},gn(o,"placeholder",{placeholder:!0}),l),s)},kC=CC,jC=function(o,s){var l=o.isDisabled,i=o.theme,c=i.spacing,f=i.colors;return bt({label:"singleValue",gridArea:"1 / 1 / 2 / 3",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},s?{}:{color:l?f.neutral40:f.neutral80,marginLeft:c.baseUnit/2,marginRight:c.baseUnit/2})},MC=function(o){var s=o.children,l=o.isDisabled,i=o.innerProps;return gt("div",vt({},gn(o,"singleValue",{"single-value":!0,"single-value--is-disabled":l}),i),s)},OC=MC,tx={ClearIndicator:q3,Control:J3,DropdownIndicator:$3,DownChevron:Xb,CrossIcon:jp,Group:sC,GroupHeading:rC,IndicatorsContainer:z3,IndicatorSeparator:G3,Input:dC,LoadingIndicator:Q3,Menu:C3,MenuList:j3,MenuPortal:L3,LoadingMessage:E3,NoOptionsMessage:T3,MultiValue:xC,MultiValueContainer:mC,MultiValueLabel:gC,MultiValueRemove:yC,Option:SC,Placeholder:kC,SelectContainer:R3,SingleValue:OC,ValueContainer:D3},TC=function(o){return bt(bt({},tx),o.components)},Sy=Number.isNaN||function(o){return typeof o=="number"&&o!==o};function EC(n,o){return!!(n===o||Sy(n)&&Sy(o))}function IC(n,o){if(n.length!==o.length)return!1;for(var s=0;s<n.length;s++)if(!EC(n[s],o[s]))return!1;return!0}function LC(n,o){o===void 0&&(o=IC);var s=null;function l(){for(var i=[],c=0;c<arguments.length;c++)i[c]=arguments[c];if(s&&s.lastThis===this&&o(i,s.lastArgs))return s.lastResult;var f=n.apply(this,i);return s={lastResult:f,lastArgs:i,lastThis:this},f}return l.clear=function(){s=null},l}var AC={name:"7pg0cj-a11yText",styles:"label:a11yText;z-index:9999;border:0;clip:rect(1px, 1px, 1px, 1px);height:1px;width:1px;position:absolute;overflow:hidden;padding:0;white-space:nowrap"},RC=function(o){return gt("span",vt({css:AC},o))},Ny=RC,_C={guidance:function(o){var s=o.isSearchable,l=o.isMulti,i=o.tabSelectsValue,c=o.context,f=o.isInitialFocus;switch(c){case"menu":return"Use Up and Down to choose options, press Enter to select the currently focused option, press Escape to exit the menu".concat(i?", press Tab to select the option and exit the menu":"",".");case"input":return f?"".concat(o["aria-label"]||"Select"," is focused ").concat(s?",type to refine list":"",", press Down to open the menu, ").concat(l?" press left to focus selected values":""):"";case"value":return"Use left and right to toggle between focused values, press Backspace to remove the currently focused value";default:return""}},onChange:function(o){var s=o.action,l=o.label,i=l===void 0?"":l,c=o.labels,f=o.isDisabled;switch(s){case"deselect-option":case"pop-value":case"remove-value":return"option ".concat(i,", deselected.");case"clear":return"All selected options have been cleared.";case"initial-input-focus":return"option".concat(c.length>1?"s":""," ").concat(c.join(","),", selected.");case"select-option":return f?"option ".concat(i," is disabled. Select another option."):"option ".concat(i,", selected.");default:return""}},onFocus:function(o){var s=o.context,l=o.focused,i=o.options,c=o.label,f=c===void 0?"":c,m=o.selectValue,p=o.isDisabled,g=o.isSelected,y=o.isAppleDevice,x=function(S,j){return S&&S.length?"".concat(S.indexOf(j)+1," of ").concat(S.length):""};if(s==="value"&&m)return"value ".concat(f," focused, ").concat(x(m,l),".");if(s==="menu"&&y){var w=p?" disabled":"",k="".concat(g?" selected":"").concat(w);return"".concat(f).concat(k,", ").concat(x(i,l),".")}return""},onFilter:function(o){var s=o.inputValue,l=o.resultsMessage;return"".concat(l).concat(s?" for search term "+s:"",".")}},DC=function(o){var s=o.ariaSelection,l=o.focusedOption,i=o.focusedValue,c=o.focusableOptions,f=o.isFocused,m=o.selectValue,p=o.selectProps,g=o.id,y=o.isAppleDevice,x=p.ariaLiveMessages,w=p.getOptionLabel,k=p.inputValue,N=p.isMulti,S=p.isOptionDisabled,j=p.isSearchable,C=p.menuIsOpen,T=p.options,V=p.screenReaderStatus,U=p.tabSelectsValue,R=p.isLoading,z=p["aria-label"],L=p["aria-live"],$=b.useMemo(function(){return bt(bt({},_C),x||{})},[x]),Y=b.useMemo(function(){var Ae="";if(s&&$.onChange){var _=s.option,se=s.options,ce=s.removedValue,Ue=s.removedValues,De=s.value,E=function(Se){return Array.isArray(Se)?null:Se},A=ce||_||E(De),O=A?w(A):"",te=se||Ue||void 0,Le=te?te.map(w):[],We=bt({isDisabled:A&&S(A,m),label:O,labels:Le},s);Ae=$.onChange(We)}return Ae},[s,$,S,m,w]),ue=b.useMemo(function(){var Ae="",_=l||i,se=!!(l&&m&&m.includes(l));if(_&&$.onFocus){var ce={focused:_,label:w(_),isDisabled:S(_,m),isSelected:se,options:c,context:_===l?"menu":"value",selectValue:m,isAppleDevice:y};Ae=$.onFocus(ce)}return Ae},[l,i,w,S,$,c,m,y]),pe=b.useMemo(function(){var Ae="";if(C&&T.length&&!R&&$.onFilter){var _=V({count:c.length});Ae=$.onFilter({inputValue:k,resultsMessage:_})}return Ae},[c,k,C,$,T,V,R]),fe=s?.action==="initial-input-focus",Re=b.useMemo(function(){var Ae="";if($.guidance){var _=i?"value":C?"menu":"input";Ae=$.guidance({"aria-label":z,context:_,isDisabled:l&&S(l,m),isMulti:N,isSearchable:j,tabSelectsValue:U,isInitialFocus:fe})}return Ae},[z,l,i,N,S,j,C,$,m,U,fe]),Ie=gt(b.Fragment,null,gt("span",{id:"aria-selection"},Y),gt("span",{id:"aria-focused"},ue),gt("span",{id:"aria-results"},pe),gt("span",{id:"aria-guidance"},Re));return gt(b.Fragment,null,gt(Ny,{id:g},fe&&Ie),gt(Ny,{"aria-live":L,"aria-atomic":"false","aria-relevant":"additions text",role:"log"},f&&!fe&&Ie))},BC=DC,Gf=[{base:"A",letters:"A"},{base:"AA",letters:""},{base:"AE",letters:""},{base:"AO",letters:""},{base:"AU",letters:""},{base:"AV",letters:""},{base:"AY",letters:""},{base:"B",letters:"B"},{base:"C",letters:"C"},{base:"D",letters:"D"},{base:"DZ",letters:""},{base:"Dz",letters:""},{base:"E",letters:"E"},{base:"F",letters:"F"},{base:"G",letters:"G"},{base:"H",letters:"H"},{base:"I",letters:"I"},{base:"J",letters:"J"},{base:"K",letters:"K"},{base:"L",letters:"L"},{base:"LJ",letters:""},{base:"Lj",letters:""},{base:"M",letters:"M"},{base:"N",letters:"N"},{base:"NJ",letters:""},{base:"Nj",letters:""},{base:"O",letters:"O"},{base:"OI",letters:""},{base:"OO",letters:""},{base:"OU",letters:""},{base:"P",letters:"P"},{base:"Q",letters:"Q"},{base:"R",letters:"R"},{base:"S",letters:"S"},{base:"T",letters:"T"},{base:"TZ",letters:""},{base:"U",letters:"U"},{base:"V",letters:"V"},{base:"VY",letters:""},{base:"W",letters:"W"},{base:"X",letters:"X"},{base:"Y",letters:"Y"},{base:"Z",letters:"Z"},{base:"a",letters:"a"},{base:"aa",letters:""},{base:"ae",letters:""},{base:"ao",letters:""},{base:"au",letters:""},{base:"av",letters:""},{base:"ay",letters:""},{base:"b",letters:"b"},{base:"c",letters:"c"},{base:"d",letters:"d"},{base:"dz",letters:""},{base:"e",letters:"e"},{base:"f",letters:"f"},{base:"g",letters:"g"},{base:"h",letters:"h"},{base:"hv",letters:""},{base:"i",letters:"i"},{base:"j",letters:"j"},{base:"k",letters:"k"},{base:"l",letters:"l"},{base:"lj",letters:""},{base:"m",letters:"m"},{base:"n",letters:"n"},{base:"nj",letters:""},{base:"o",letters:"o"},{base:"oi",letters:""},{base:"ou",letters:""},{base:"oo",letters:""},{base:"p",letters:"p"},{base:"q",letters:"q"},{base:"r",letters:"r"},{base:"s",letters:"s"},{base:"t",letters:"t"},{base:"tz",letters:""},{base:"u",letters:"u"},{base:"v",letters:"v"},{base:"vy",letters:""},{base:"w",letters:"w"},{base:"x",letters:"x"},{base:"y",letters:"y"},{base:"z",letters:"z"}],zC=new RegExp("["+Gf.map(function(n){return n.letters}).join("")+"]","g"),nx={};for(var ff=0;ff<Gf.length;ff++)for(var pf=Gf[ff],hf=0;hf<pf.letters.length;hf++)nx[pf.letters[hf]]=pf.base;var ox=function(o){return o.replace(zC,function(s){return nx[s]})},HC=LC(ox),Cy=function(o){return o.replace(/^\s+|\s+$/g,"")},VC=function(o){return"".concat(o.label," ").concat(o.value)},Pf=function(o){return function(s,l){if(s.data.__isNew__)return!0;var i=bt({ignoreCase:!0,ignoreAccents:!0,stringify:VC,trim:!0,matchFrom:"any"},o),c=i.ignoreCase,f=i.ignoreAccents,m=i.stringify,p=i.trim,g=i.matchFrom,y=p?Cy(l):l,x=p?Cy(m(s)):m(s);return c&&(y=y.toLowerCase(),x=x.toLowerCase()),f&&(y=HC(y),x=ox(x)),g==="start"?x.substr(0,y.length)===y:x.indexOf(y)>-1}},KC=["innerRef"];function UC(n){var o=n.innerRef,s=vr(n,KC),l=g3(s,"onExited","in","enter","exit","appear");return gt("input",vt({ref:o},l,{css:Sp({label:"dummyInput",background:0,border:0,caretColor:"transparent",fontSize:"inherit",gridArea:"1 / 1 / 2 / 3",outline:0,padding:0,width:1,color:"transparent",left:-100,opacity:0,position:"relative",transform:"scale(.01)"},"","")}))}var $C=function(o){o.cancelable&&o.preventDefault(),o.stopPropagation()};function FC(n){var o=n.isEnabled,s=n.onBottomArrive,l=n.onBottomLeave,i=n.onTopArrive,c=n.onTopLeave,f=b.useRef(!1),m=b.useRef(!1),p=b.useRef(0),g=b.useRef(null),y=b.useCallback(function(j,C){if(g.current!==null){var T=g.current,V=T.scrollTop,U=T.scrollHeight,R=T.clientHeight,z=g.current,L=C>0,$=U-R-V,Y=!1;$>C&&f.current&&(l&&l(j),f.current=!1),L&&m.current&&(c&&c(j),m.current=!1),L&&C>$?(s&&!f.current&&s(j),z.scrollTop=U,Y=!0,f.current=!0):!L&&-C>V&&(i&&!m.current&&i(j),z.scrollTop=0,Y=!0,m.current=!0),Y&&$C(j)}},[s,l,i,c]),x=b.useCallback(function(j){y(j,j.deltaY)},[y]),w=b.useCallback(function(j){p.current=j.changedTouches[0].clientY},[]),k=b.useCallback(function(j){var C=p.current-j.changedTouches[0].clientY;y(j,C)},[y]),N=b.useCallback(function(j){if(j){var C=p3?{passive:!1}:!1;j.addEventListener("wheel",x,C),j.addEventListener("touchstart",w,C),j.addEventListener("touchmove",k,C)}},[k,w,x]),S=b.useCallback(function(j){j&&(j.removeEventListener("wheel",x,!1),j.removeEventListener("touchstart",w,!1),j.removeEventListener("touchmove",k,!1))},[k,w,x]);return b.useEffect(function(){if(o){var j=g.current;return N(j),function(){S(j)}}},[o,N,S]),function(j){g.current=j}}var ky=["boxSizing","height","overflow","paddingRight","position"],jy={boxSizing:"border-box",overflow:"hidden",position:"relative",height:"100%"};function My(n){n.cancelable&&n.preventDefault()}function Oy(n){n.stopPropagation()}function Ty(){var n=this.scrollTop,o=this.scrollHeight,s=n+this.offsetHeight;n===0?this.scrollTop=1:s===o&&(this.scrollTop=n-1)}function Ey(){return"ontouchstart"in window||navigator.maxTouchPoints}var Iy=!!(typeof window<"u"&&window.document&&window.document.createElement),la=0,Js={capture:!1,passive:!1};function qC(n){var o=n.isEnabled,s=n.accountForScrollbars,l=s===void 0?!0:s,i=b.useRef({}),c=b.useRef(null),f=b.useCallback(function(p){if(Iy){var g=document.body,y=g&&g.style;if(l&&ky.forEach(function(N){var S=y&&y[N];i.current[N]=S}),l&&la<1){var x=parseInt(i.current.paddingRight,10)||0,w=document.body?document.body.clientWidth:0,k=window.innerWidth-w+x||0;Object.keys(jy).forEach(function(N){var S=jy[N];y&&(y[N]=S)}),y&&(y.paddingRight="".concat(k,"px"))}g&&Ey()&&(g.addEventListener("touchmove",My,Js),p&&(p.addEventListener("touchstart",Ty,Js),p.addEventListener("touchmove",Oy,Js))),la+=1}},[l]),m=b.useCallback(function(p){if(Iy){var g=document.body,y=g&&g.style;la=Math.max(la-1,0),l&&la<1&&ky.forEach(function(x){var w=i.current[x];y&&(y[x]=w)}),g&&Ey()&&(g.removeEventListener("touchmove",My,Js),p&&(p.removeEventListener("touchstart",Ty,Js),p.removeEventListener("touchmove",Oy,Js)))}},[l]);return b.useEffect(function(){if(o){var p=c.current;return f(p),function(){m(p)}}},[o,f,m]),function(p){c.current=p}}var WC=function(o){var s=o.target;return s.ownerDocument.activeElement&&s.ownerDocument.activeElement.blur()},GC={name:"1kfdb0e",styles:"position:fixed;left:0;bottom:0;right:0;top:0"};function PC(n){var o=n.children,s=n.lockEnabled,l=n.captureEnabled,i=l===void 0?!0:l,c=n.onBottomArrive,f=n.onBottomLeave,m=n.onTopArrive,p=n.onTopLeave,g=FC({isEnabled:i,onBottomArrive:c,onBottomLeave:f,onTopArrive:m,onTopLeave:p}),y=qC({isEnabled:s}),x=function(k){g(k),y(k)};return gt(b.Fragment,null,s&&gt("div",{onClick:WC,css:GC}),o(x))}var YC={name:"1a0ro4n-requiredInput",styles:"label:requiredInput;opacity:0;pointer-events:none;position:absolute;bottom:0;left:0;right:0;width:100%"},QC=function(o){var s=o.name,l=o.onFocus;return gt("input",{required:!0,name:s,tabIndex:-1,"aria-hidden":"true",onFocus:l,css:YC,value:"",onChange:function(){}})},XC=QC;function Mp(n){var o;return typeof window<"u"&&window.navigator!=null?n.test(((o=window.navigator.userAgentData)===null||o===void 0?void 0:o.platform)||window.navigator.platform):!1}function ZC(){return Mp(/^iPhone/i)}function rx(){return Mp(/^Mac/i)}function JC(){return Mp(/^iPad/i)||rx()&&navigator.maxTouchPoints>1}function e4(){return ZC()||JC()}function t4(){return rx()||e4()}var n4=function(o){return o.label},o4=function(o){return o.label},r4=function(o){return o.value},s4=function(o){return!!o.isDisabled},l4={clearIndicator:F3,container:A3,control:X3,dropdownIndicator:U3,group:tC,groupHeading:oC,indicatorsContainer:B3,indicatorSeparator:W3,input:aC,loadingIndicator:Y3,loadingMessage:O3,menu:w3,menuList:k3,menuPortal:I3,multiValue:fC,multiValueLabel:pC,multiValueRemove:hC,noOptionsMessage:M3,option:vC,placeholder:NC,singleValue:jC,valueContainer:_3},a4={primary:"#2684FF",primary75:"#4C9AFF",primary50:"#B2D4FF",primary25:"#DEEBFF",danger:"#DE350B",dangerLight:"#FFBDAD",neutral0:"hsl(0, 0%, 100%)",neutral5:"hsl(0, 0%, 95%)",neutral10:"hsl(0, 0%, 90%)",neutral20:"hsl(0, 0%, 80%)",neutral30:"hsl(0, 0%, 70%)",neutral40:"hsl(0, 0%, 60%)",neutral50:"hsl(0, 0%, 50%)",neutral60:"hsl(0, 0%, 40%)",neutral70:"hsl(0, 0%, 30%)",neutral80:"hsl(0, 0%, 20%)",neutral90:"hsl(0, 0%, 10%)"},i4=4,sx=4,u4=38,c4=sx*2,d4={baseUnit:sx,controlHeight:u4,menuGutter:c4},mf={borderRadius:i4,colors:a4,spacing:d4},f4={"aria-live":"polite",backspaceRemovesValue:!0,blurInputOnSelect:vy(),captureMenuScroll:!vy(),classNames:{},closeMenuOnSelect:!0,closeMenuOnScroll:!1,components:{},controlShouldRenderValue:!0,escapeClearsValue:!1,filterOption:Pf(),formatGroupLabel:n4,getOptionLabel:o4,getOptionValue:r4,isDisabled:!1,isLoading:!1,isMulti:!1,isRtl:!1,isSearchable:!0,isOptionDisabled:s4,loadingMessage:function(){return"Loading..."},maxMenuHeight:300,minMenuHeight:140,menuIsOpen:!1,menuPlacement:"bottom",menuPosition:"absolute",menuShouldBlockScroll:!1,menuShouldScrollIntoView:!d3(),noOptionsMessage:function(){return"No options"},openMenuOnFocus:!1,openMenuOnClick:!0,options:[],pageSize:5,placeholder:"Select...",screenReaderStatus:function(o){var s=o.count;return"".concat(s," result").concat(s!==1?"s":""," available")},styles:{},tabIndex:0,tabSelectsValue:!0,unstyled:!1};function Ly(n,o,s,l){var i=ix(n,o,s),c=ux(n,o,s),f=ax(n,o),m=Tu(n,o);return{type:"option",data:o,isDisabled:i,isSelected:c,label:f,value:m,index:l}}function pu(n,o){return n.options.map(function(s,l){if("options"in s){var i=s.options.map(function(f,m){return Ly(n,f,o,m)}).filter(function(f){return Ry(n,f)});return i.length>0?{type:"group",data:s,options:i,index:l}:void 0}var c=Ly(n,s,o,l);return Ry(n,c)?c:void 0}).filter(h3)}function lx(n){return n.reduce(function(o,s){return s.type==="group"?o.push.apply(o,yp(s.options.map(function(l){return l.data}))):o.push(s.data),o},[])}function Ay(n,o){return n.reduce(function(s,l){return l.type==="group"?s.push.apply(s,yp(l.options.map(function(i){return{data:i.data,id:"".concat(o,"-").concat(l.index,"-").concat(i.index)}}))):s.push({data:l.data,id:"".concat(o,"-").concat(l.index)}),s},[])}function p4(n,o){return lx(pu(n,o))}function Ry(n,o){var s=n.inputValue,l=s===void 0?"":s,i=o.data,c=o.isSelected,f=o.label,m=o.value;return(!dx(n)||!c)&&cx(n,{label:f,value:m,data:i},l)}function h4(n,o){var s=n.focusedValue,l=n.selectValue,i=l.indexOf(s);if(i>-1){var c=o.indexOf(s);if(c>-1)return s;if(i<o.length)return o[i]}return null}function m4(n,o){var s=n.focusedOption;return s&&o.indexOf(s)>-1?s:o[0]}var gf=function(o,s){var l,i=(l=o.find(function(c){return c.data===s}))===null||l===void 0?void 0:l.id;return i||null},ax=function(o,s){return o.getOptionLabel(s)},Tu=function(o,s){return o.getOptionValue(s)};function ix(n,o,s){return typeof n.isOptionDisabled=="function"?n.isOptionDisabled(o,s):!1}function ux(n,o,s){if(s.indexOf(o)>-1)return!0;if(typeof n.isOptionSelected=="function")return n.isOptionSelected(o,s);var l=Tu(n,o);return s.some(function(i){return Tu(n,i)===l})}function cx(n,o,s){return n.filterOption?n.filterOption(o,s):!0}var dx=function(o){var s=o.hideSelectedOptions,l=o.isMulti;return s===void 0?l:s},g4=1,fx=(function(n){zS(s,n);var o=KS(s);function s(l){var i;if(DS(this,s),i=o.call(this,l),i.state={ariaSelection:null,focusedOption:null,focusedOptionId:null,focusableOptionsWithIds:[],focusedValue:null,inputIsHidden:!1,isFocused:!1,selectValue:[],clearFocusValueOnUpdate:!1,prevWasFocused:!1,inputIsHiddenAfterUpdate:void 0,prevProps:void 0,instancePrefix:"",isAppleDevice:!1},i.blockOptionHover=!1,i.isComposing=!1,i.commonProps=void 0,i.initialTouchX=0,i.initialTouchY=0,i.openAfterFocus=!1,i.scrollToFocusedOptionOnUpdate=!1,i.userIsDragging=void 0,i.controlRef=null,i.getControlRef=function(p){i.controlRef=p},i.focusedOptionRef=null,i.getFocusedOptionRef=function(p){i.focusedOptionRef=p},i.menuListRef=null,i.getMenuListRef=function(p){i.menuListRef=p},i.inputRef=null,i.getInputRef=function(p){i.inputRef=p},i.focus=i.focusInput,i.blur=i.blurInput,i.onChange=function(p,g){var y=i.props,x=y.onChange,w=y.name;g.name=w,i.ariaOnChange(p,g),x(p,g)},i.setValue=function(p,g,y){var x=i.props,w=x.closeMenuOnSelect,k=x.isMulti,N=x.inputValue;i.onInputChange("",{action:"set-value",prevInputValue:N}),w&&(i.setState({inputIsHiddenAfterUpdate:!k}),i.onMenuClose()),i.setState({clearFocusValueOnUpdate:!0}),i.onChange(p,{action:g,option:y})},i.selectOption=function(p){var g=i.props,y=g.blurInputOnSelect,x=g.isMulti,w=g.name,k=i.state.selectValue,N=x&&i.isOptionSelected(p,k),S=i.isOptionDisabled(p,k);if(N){var j=i.getOptionValue(p);i.setValue(k.filter(function(C){return i.getOptionValue(C)!==j}),"deselect-option",p)}else if(!S)x?i.setValue([].concat(yp(k),[p]),"select-option",p):i.setValue(p,"select-option");else{i.ariaOnChange(p,{action:"select-option",option:p,name:w});return}y&&i.blurInput()},i.removeValue=function(p){var g=i.props.isMulti,y=i.state.selectValue,x=i.getOptionValue(p),w=y.filter(function(N){return i.getOptionValue(N)!==x}),k=su(g,w,w[0]||null);i.onChange(k,{action:"remove-value",removedValue:p}),i.focusInput()},i.clearValue=function(){var p=i.state.selectValue;i.onChange(su(i.props.isMulti,[],null),{action:"clear",removedValues:p})},i.popValue=function(){var p=i.props.isMulti,g=i.state.selectValue,y=g[g.length-1],x=g.slice(0,g.length-1),w=su(p,x,x[0]||null);y&&i.onChange(w,{action:"pop-value",removedValue:y})},i.getFocusedOptionId=function(p){return gf(i.state.focusableOptionsWithIds,p)},i.getFocusableOptionsWithIds=function(){return Ay(pu(i.props,i.state.selectValue),i.getElementId("option"))},i.getValue=function(){return i.state.selectValue},i.cx=function(){for(var p=arguments.length,g=new Array(p),y=0;y<p;y++)g[y]=arguments[y];return l3.apply(void 0,[i.props.classNamePrefix].concat(g))},i.getOptionLabel=function(p){return ax(i.props,p)},i.getOptionValue=function(p){return Tu(i.props,p)},i.getStyles=function(p,g){var y=i.props.unstyled,x=l4[p](g,y);x.boxSizing="border-box";var w=i.props.styles[p];return w?w(x,g):x},i.getClassNames=function(p,g){var y,x;return(y=(x=i.props.classNames)[p])===null||y===void 0?void 0:y.call(x,g)},i.getElementId=function(p){return"".concat(i.state.instancePrefix,"-").concat(p)},i.getComponents=function(){return TC(i.props)},i.buildCategorizedOptions=function(){return pu(i.props,i.state.selectValue)},i.getCategorizedOptions=function(){return i.props.menuIsOpen?i.buildCategorizedOptions():[]},i.buildFocusableOptions=function(){return lx(i.buildCategorizedOptions())},i.getFocusableOptions=function(){return i.props.menuIsOpen?i.buildFocusableOptions():[]},i.ariaOnChange=function(p,g){i.setState({ariaSelection:bt({value:p},g)})},i.onMenuMouseDown=function(p){p.button===0&&(p.stopPropagation(),p.preventDefault(),i.focusInput())},i.onMenuMouseMove=function(p){i.blockOptionHover=!1},i.onControlMouseDown=function(p){if(!p.defaultPrevented){var g=i.props.openMenuOnClick;i.state.isFocused?i.props.menuIsOpen?p.target.tagName!=="INPUT"&&p.target.tagName!=="TEXTAREA"&&i.onMenuClose():g&&i.openMenu("first"):(g&&(i.openAfterFocus=!0),i.focusInput()),p.target.tagName!=="INPUT"&&p.target.tagName!=="TEXTAREA"&&p.preventDefault()}},i.onDropdownIndicatorMouseDown=function(p){if(!(p&&p.type==="mousedown"&&p.button!==0)&&!i.props.isDisabled){var g=i.props,y=g.isMulti,x=g.menuIsOpen;i.focusInput(),x?(i.setState({inputIsHiddenAfterUpdate:!y}),i.onMenuClose()):i.openMenu("first"),p.preventDefault()}},i.onClearIndicatorMouseDown=function(p){p&&p.type==="mousedown"&&p.button!==0||(i.clearValue(),p.preventDefault(),i.openAfterFocus=!1,p.type==="touchend"?i.focusInput():setTimeout(function(){return i.focusInput()}))},i.onScroll=function(p){typeof i.props.closeMenuOnScroll=="boolean"?p.target instanceof HTMLElement&&Vu(p.target)&&i.props.onMenuClose():typeof i.props.closeMenuOnScroll=="function"&&i.props.closeMenuOnScroll(p)&&i.props.onMenuClose()},i.onCompositionStart=function(){i.isComposing=!0},i.onCompositionEnd=function(){i.isComposing=!1},i.onTouchStart=function(p){var g=p.touches,y=g&&g.item(0);y&&(i.initialTouchX=y.clientX,i.initialTouchY=y.clientY,i.userIsDragging=!1)},i.onTouchMove=function(p){var g=p.touches,y=g&&g.item(0);if(y){var x=Math.abs(y.clientX-i.initialTouchX),w=Math.abs(y.clientY-i.initialTouchY),k=5;i.userIsDragging=x>k||w>k}},i.onTouchEnd=function(p){i.userIsDragging||(i.controlRef&&!i.controlRef.contains(p.target)&&i.menuListRef&&!i.menuListRef.contains(p.target)&&i.blurInput(),i.initialTouchX=0,i.initialTouchY=0)},i.onControlTouchEnd=function(p){i.userIsDragging||i.onControlMouseDown(p)},i.onClearIndicatorTouchEnd=function(p){i.userIsDragging||i.onClearIndicatorMouseDown(p)},i.onDropdownIndicatorTouchEnd=function(p){i.userIsDragging||i.onDropdownIndicatorMouseDown(p)},i.handleInputChange=function(p){var g=i.props.inputValue,y=p.currentTarget.value;i.setState({inputIsHiddenAfterUpdate:!1}),i.onInputChange(y,{action:"input-change",prevInputValue:g}),i.props.menuIsOpen||i.onMenuOpen()},i.onInputFocus=function(p){i.props.onFocus&&i.props.onFocus(p),i.setState({inputIsHiddenAfterUpdate:!1,isFocused:!0}),(i.openAfterFocus||i.props.openMenuOnFocus)&&i.openMenu("first"),i.openAfterFocus=!1},i.onInputBlur=function(p){var g=i.props.inputValue;if(i.menuListRef&&i.menuListRef.contains(document.activeElement)){i.inputRef.focus();return}i.props.onBlur&&i.props.onBlur(p),i.onInputChange("",{action:"input-blur",prevInputValue:g}),i.onMenuClose(),i.setState({focusedValue:null,isFocused:!1})},i.onOptionHover=function(p){if(!(i.blockOptionHover||i.state.focusedOption===p)){var g=i.getFocusableOptions(),y=g.indexOf(p);i.setState({focusedOption:p,focusedOptionId:y>-1?i.getFocusedOptionId(p):null})}},i.shouldHideSelectedOptions=function(){return dx(i.props)},i.onValueInputFocus=function(p){p.preventDefault(),p.stopPropagation(),i.focus()},i.onKeyDown=function(p){var g=i.props,y=g.isMulti,x=g.backspaceRemovesValue,w=g.escapeClearsValue,k=g.inputValue,N=g.isClearable,S=g.isDisabled,j=g.menuIsOpen,C=g.onKeyDown,T=g.tabSelectsValue,V=g.openMenuOnFocus,U=i.state,R=U.focusedOption,z=U.focusedValue,L=U.selectValue;if(!S&&!(typeof C=="function"&&(C(p),p.defaultPrevented))){switch(i.blockOptionHover=!0,p.key){case"ArrowLeft":if(!y||k)return;i.focusValue("previous");break;case"ArrowRight":if(!y||k)return;i.focusValue("next");break;case"Delete":case"Backspace":if(k)return;if(z)i.removeValue(z);else{if(!x)return;y?i.popValue():N&&i.clearValue()}break;case"Tab":if(i.isComposing||p.shiftKey||!j||!T||!R||V&&i.isOptionSelected(R,L))return;i.selectOption(R);break;case"Enter":if(p.keyCode===229)break;if(j){if(!R||i.isComposing)return;i.selectOption(R);break}return;case"Escape":j?(i.setState({inputIsHiddenAfterUpdate:!1}),i.onInputChange("",{action:"menu-close",prevInputValue:k}),i.onMenuClose()):N&&w&&i.clearValue();break;case" ":if(k)return;if(!j){i.openMenu("first");break}if(!R)return;i.selectOption(R);break;case"ArrowUp":j?i.focusOption("up"):i.openMenu("last");break;case"ArrowDown":j?i.focusOption("down"):i.openMenu("first");break;case"PageUp":if(!j)return;i.focusOption("pageup");break;case"PageDown":if(!j)return;i.focusOption("pagedown");break;case"Home":if(!j)return;i.focusOption("first");break;case"End":if(!j)return;i.focusOption("last");break;default:return}p.preventDefault()}},i.state.instancePrefix="react-select-"+(i.props.instanceId||++g4),i.state.selectValue=by(l.value),l.menuIsOpen&&i.state.selectValue.length){var c=i.getFocusableOptionsWithIds(),f=i.buildFocusableOptions(),m=f.indexOf(i.state.selectValue[0]);i.state.focusableOptionsWithIds=c,i.state.focusedOption=f[m],i.state.focusedOptionId=gf(c,f[m])}return i}return BS(s,[{key:"componentDidMount",value:function(){this.startListeningComposition(),this.startListeningToTouch(),this.props.closeMenuOnScroll&&document&&document.addEventListener&&document.addEventListener("scroll",this.onScroll,!0),this.props.autoFocus&&this.focusInput(),this.props.menuIsOpen&&this.state.focusedOption&&this.menuListRef&&this.focusedOptionRef&&xy(this.menuListRef,this.focusedOptionRef),t4()&&this.setState({isAppleDevice:!0})}},{key:"componentDidUpdate",value:function(i){var c=this.props,f=c.isDisabled,m=c.menuIsOpen,p=this.state.isFocused;(p&&!f&&i.isDisabled||p&&m&&!i.menuIsOpen)&&this.focusInput(),p&&f&&!i.isDisabled?this.setState({isFocused:!1},this.onMenuClose):!p&&!f&&i.isDisabled&&this.inputRef===document.activeElement&&this.setState({isFocused:!0}),this.menuListRef&&this.focusedOptionRef&&this.scrollToFocusedOptionOnUpdate&&(xy(this.menuListRef,this.focusedOptionRef),this.scrollToFocusedOptionOnUpdate=!1)}},{key:"componentWillUnmount",value:function(){this.stopListeningComposition(),this.stopListeningToTouch(),document.removeEventListener("scroll",this.onScroll,!0)}},{key:"onMenuOpen",value:function(){this.props.onMenuOpen()}},{key:"onMenuClose",value:function(){this.onInputChange("",{action:"menu-close",prevInputValue:this.props.inputValue}),this.props.onMenuClose()}},{key:"onInputChange",value:function(i,c){this.props.onInputChange(i,c)}},{key:"focusInput",value:function(){this.inputRef&&this.inputRef.focus()}},{key:"blurInput",value:function(){this.inputRef&&this.inputRef.blur()}},{key:"openMenu",value:function(i){var c=this,f=this.state,m=f.selectValue,p=f.isFocused,g=this.buildFocusableOptions(),y=i==="first"?0:g.length-1;if(!this.props.isMulti){var x=g.indexOf(m[0]);x>-1&&(y=x)}this.scrollToFocusedOptionOnUpdate=!(p&&this.menuListRef),this.setState({inputIsHiddenAfterUpdate:!1,focusedValue:null,focusedOption:g[y],focusedOptionId:this.getFocusedOptionId(g[y])},function(){return c.onMenuOpen()})}},{key:"focusValue",value:function(i){var c=this.state,f=c.selectValue,m=c.focusedValue;if(this.props.isMulti){this.setState({focusedOption:null});var p=f.indexOf(m);m||(p=-1);var g=f.length-1,y=-1;if(f.length){switch(i){case"previous":p===0?y=0:p===-1?y=g:y=p-1;break;case"next":p>-1&&p<g&&(y=p+1);break}this.setState({inputIsHidden:y!==-1,focusedValue:f[y]})}}}},{key:"focusOption",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"first",c=this.props.pageSize,f=this.state.focusedOption,m=this.getFocusableOptions();if(m.length){var p=0,g=m.indexOf(f);f||(g=-1),i==="up"?p=g>0?g-1:m.length-1:i==="down"?p=(g+1)%m.length:i==="pageup"?(p=g-c,p<0&&(p=0)):i==="pagedown"?(p=g+c,p>m.length-1&&(p=m.length-1)):i==="last"&&(p=m.length-1),this.scrollToFocusedOptionOnUpdate=!0,this.setState({focusedOption:m[p],focusedValue:null,focusedOptionId:this.getFocusedOptionId(m[p])})}}},{key:"getTheme",value:(function(){return this.props.theme?typeof this.props.theme=="function"?this.props.theme(mf):bt(bt({},mf),this.props.theme):mf})},{key:"getCommonProps",value:function(){var i=this.clearValue,c=this.cx,f=this.getStyles,m=this.getClassNames,p=this.getValue,g=this.selectOption,y=this.setValue,x=this.props,w=x.isMulti,k=x.isRtl,N=x.options,S=this.hasValue();return{clearValue:i,cx:c,getStyles:f,getClassNames:m,getValue:p,hasValue:S,isMulti:w,isRtl:k,options:N,selectOption:g,selectProps:x,setValue:y,theme:this.getTheme()}}},{key:"hasValue",value:function(){var i=this.state.selectValue;return i.length>0}},{key:"hasOptions",value:function(){return!!this.getFocusableOptions().length}},{key:"isClearable",value:function(){var i=this.props,c=i.isClearable,f=i.isMulti;return c===void 0?f:c}},{key:"isOptionDisabled",value:function(i,c){return ix(this.props,i,c)}},{key:"isOptionSelected",value:function(i,c){return ux(this.props,i,c)}},{key:"filterOption",value:function(i,c){return cx(this.props,i,c)}},{key:"formatOptionLabel",value:function(i,c){if(typeof this.props.formatOptionLabel=="function"){var f=this.props.inputValue,m=this.state.selectValue;return this.props.formatOptionLabel(i,{context:c,inputValue:f,selectValue:m})}else return this.getOptionLabel(i)}},{key:"formatGroupLabel",value:function(i){return this.props.formatGroupLabel(i)}},{key:"startListeningComposition",value:(function(){document&&document.addEventListener&&(document.addEventListener("compositionstart",this.onCompositionStart,!1),document.addEventListener("compositionend",this.onCompositionEnd,!1))})},{key:"stopListeningComposition",value:function(){document&&document.removeEventListener&&(document.removeEventListener("compositionstart",this.onCompositionStart),document.removeEventListener("compositionend",this.onCompositionEnd))}},{key:"startListeningToTouch",value:(function(){document&&document.addEventListener&&(document.addEventListener("touchstart",this.onTouchStart,!1),document.addEventListener("touchmove",this.onTouchMove,!1),document.addEventListener("touchend",this.onTouchEnd,!1))})},{key:"stopListeningToTouch",value:function(){document&&document.removeEventListener&&(document.removeEventListener("touchstart",this.onTouchStart),document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onTouchEnd))}},{key:"renderInput",value:(function(){var i=this.props,c=i.isDisabled,f=i.isSearchable,m=i.inputId,p=i.inputValue,g=i.tabIndex,y=i.form,x=i.menuIsOpen,w=i.required,k=this.getComponents(),N=k.Input,S=this.state,j=S.inputIsHidden,C=S.ariaSelection,T=this.commonProps,V=m||this.getElementId("input"),U=bt(bt(bt({"aria-autocomplete":"list","aria-expanded":x,"aria-haspopup":!0,"aria-errormessage":this.props["aria-errormessage"],"aria-invalid":this.props["aria-invalid"],"aria-label":this.props["aria-label"],"aria-labelledby":this.props["aria-labelledby"],"aria-required":w,role:"combobox","aria-activedescendant":this.state.isAppleDevice?void 0:this.state.focusedOptionId||""},x&&{"aria-controls":this.getElementId("listbox")}),!f&&{"aria-readonly":!0}),this.hasValue()?C?.action==="initial-input-focus"&&{"aria-describedby":this.getElementId("live-region")}:{"aria-describedby":this.getElementId("placeholder")});return f?b.createElement(N,vt({},T,{autoCapitalize:"none",autoComplete:"off",autoCorrect:"off",id:V,innerRef:this.getInputRef,isDisabled:c,isHidden:j,onBlur:this.onInputBlur,onChange:this.handleInputChange,onFocus:this.onInputFocus,spellCheck:"false",tabIndex:g,form:y,type:"text",value:p},U)):b.createElement(UC,vt({id:V,innerRef:this.getInputRef,onBlur:this.onInputBlur,onChange:Mu,onFocus:this.onInputFocus,disabled:c,tabIndex:g,inputMode:"none",form:y,value:""},U))})},{key:"renderPlaceholderOrValue",value:function(){var i=this,c=this.getComponents(),f=c.MultiValue,m=c.MultiValueContainer,p=c.MultiValueLabel,g=c.MultiValueRemove,y=c.SingleValue,x=c.Placeholder,w=this.commonProps,k=this.props,N=k.controlShouldRenderValue,S=k.isDisabled,j=k.isMulti,C=k.inputValue,T=k.placeholder,V=this.state,U=V.selectValue,R=V.focusedValue,z=V.isFocused;if(!this.hasValue()||!N)return C?null:b.createElement(x,vt({},w,{key:"placeholder",isDisabled:S,isFocused:z,innerProps:{id:this.getElementId("placeholder")}}),T);if(j)return U.map(function($,Y){var ue=$===R,pe="".concat(i.getOptionLabel($),"-").concat(i.getOptionValue($));return b.createElement(f,vt({},w,{components:{Container:m,Label:p,Remove:g},isFocused:ue,isDisabled:S,key:pe,index:Y,removeProps:{onClick:function(){return i.removeValue($)},onTouchEnd:function(){return i.removeValue($)},onMouseDown:function(Re){Re.preventDefault()}},data:$}),i.formatOptionLabel($,"value"))});if(C)return null;var L=U[0];return b.createElement(y,vt({},w,{data:L,isDisabled:S}),this.formatOptionLabel(L,"value"))}},{key:"renderClearIndicator",value:function(){var i=this.getComponents(),c=i.ClearIndicator,f=this.commonProps,m=this.props,p=m.isDisabled,g=m.isLoading,y=this.state.isFocused;if(!this.isClearable()||!c||p||!this.hasValue()||g)return null;var x={onMouseDown:this.onClearIndicatorMouseDown,onTouchEnd:this.onClearIndicatorTouchEnd,"aria-hidden":"true"};return b.createElement(c,vt({},f,{innerProps:x,isFocused:y}))}},{key:"renderLoadingIndicator",value:function(){var i=this.getComponents(),c=i.LoadingIndicator,f=this.commonProps,m=this.props,p=m.isDisabled,g=m.isLoading,y=this.state.isFocused;if(!c||!g)return null;var x={"aria-hidden":"true"};return b.createElement(c,vt({},f,{innerProps:x,isDisabled:p,isFocused:y}))}},{key:"renderIndicatorSeparator",value:function(){var i=this.getComponents(),c=i.DropdownIndicator,f=i.IndicatorSeparator;if(!c||!f)return null;var m=this.commonProps,p=this.props.isDisabled,g=this.state.isFocused;return b.createElement(f,vt({},m,{isDisabled:p,isFocused:g}))}},{key:"renderDropdownIndicator",value:function(){var i=this.getComponents(),c=i.DropdownIndicator;if(!c)return null;var f=this.commonProps,m=this.props.isDisabled,p=this.state.isFocused,g={onMouseDown:this.onDropdownIndicatorMouseDown,onTouchEnd:this.onDropdownIndicatorTouchEnd,"aria-hidden":"true"};return b.createElement(c,vt({},f,{innerProps:g,isDisabled:m,isFocused:p}))}},{key:"renderMenu",value:function(){var i=this,c=this.getComponents(),f=c.Group,m=c.GroupHeading,p=c.Menu,g=c.MenuList,y=c.MenuPortal,x=c.LoadingMessage,w=c.NoOptionsMessage,k=c.Option,N=this.commonProps,S=this.state.focusedOption,j=this.props,C=j.captureMenuScroll,T=j.inputValue,V=j.isLoading,U=j.loadingMessage,R=j.minMenuHeight,z=j.maxMenuHeight,L=j.menuIsOpen,$=j.menuPlacement,Y=j.menuPosition,ue=j.menuPortalTarget,pe=j.menuShouldBlockScroll,fe=j.menuShouldScrollIntoView,Re=j.noOptionsMessage,Ie=j.onMenuScrollToTop,Ae=j.onMenuScrollToBottom;if(!L)return null;var _=function(O,te){var Le=O.type,We=O.data,xe=O.isDisabled,Se=O.isSelected,H=O.label,P=O.value,D=S===We,K=xe?void 0:function(){return i.onOptionHover(We)},Z=xe?void 0:function(){return i.selectOption(We)},q="".concat(i.getElementId("option"),"-").concat(te),Ee={id:q,onClick:Z,onMouseMove:K,onMouseOver:K,tabIndex:-1,role:"option","aria-selected":i.state.isAppleDevice?void 0:Se};return b.createElement(k,vt({},N,{innerProps:Ee,data:We,isDisabled:xe,isSelected:Se,key:q,label:H,type:Le,value:P,isFocused:D,innerRef:D?i.getFocusedOptionRef:void 0}),i.formatOptionLabel(O.data,"menu"))},se;if(this.hasOptions())se=this.getCategorizedOptions().map(function(A){if(A.type==="group"){var O=A.data,te=A.options,Le=A.index,We="".concat(i.getElementId("group"),"-").concat(Le),xe="".concat(We,"-heading");return b.createElement(f,vt({},N,{key:We,data:O,options:te,Heading:m,headingProps:{id:xe,data:A.data},label:i.formatGroupLabel(A.data)}),A.options.map(function(Se){return _(Se,"".concat(Le,"-").concat(Se.index))}))}else if(A.type==="option")return _(A,"".concat(A.index))});else if(V){var ce=U({inputValue:T});if(ce===null)return null;se=b.createElement(x,N,ce)}else{var Ue=Re({inputValue:T});if(Ue===null)return null;se=b.createElement(w,N,Ue)}var De={minMenuHeight:R,maxMenuHeight:z,menuPlacement:$,menuPosition:Y,menuShouldScrollIntoView:fe},E=b.createElement(S3,vt({},N,De),function(A){var O=A.ref,te=A.placerProps,Le=te.placement,We=te.maxHeight;return b.createElement(p,vt({},N,De,{innerRef:O,innerProps:{onMouseDown:i.onMenuMouseDown,onMouseMove:i.onMenuMouseMove},isLoading:V,placement:Le}),b.createElement(PC,{captureEnabled:C,onTopArrive:Ie,onBottomArrive:Ae,lockEnabled:pe},function(xe){return b.createElement(g,vt({},N,{innerRef:function(H){i.getMenuListRef(H),xe(H)},innerProps:{role:"listbox","aria-multiselectable":N.isMulti,id:i.getElementId("listbox")},isLoading:V,maxHeight:We,focusedOption:S}),se)}))});return ue||Y==="fixed"?b.createElement(y,vt({},N,{appendTo:ue,controlElement:this.controlRef,menuPlacement:$,menuPosition:Y}),E):E}},{key:"renderFormField",value:function(){var i=this,c=this.props,f=c.delimiter,m=c.isDisabled,p=c.isMulti,g=c.name,y=c.required,x=this.state.selectValue;if(y&&!this.hasValue()&&!m)return b.createElement(XC,{name:g,onFocus:this.onValueInputFocus});if(!(!g||m))if(p)if(f){var w=x.map(function(S){return i.getOptionValue(S)}).join(f);return b.createElement("input",{name:g,type:"hidden",value:w})}else{var k=x.length>0?x.map(function(S,j){return b.createElement("input",{key:"i-".concat(j),name:g,type:"hidden",value:i.getOptionValue(S)})}):b.createElement("input",{name:g,type:"hidden",value:""});return b.createElement("div",null,k)}else{var N=x[0]?this.getOptionValue(x[0]):"";return b.createElement("input",{name:g,type:"hidden",value:N})}}},{key:"renderLiveRegion",value:function(){var i=this.commonProps,c=this.state,f=c.ariaSelection,m=c.focusedOption,p=c.focusedValue,g=c.isFocused,y=c.selectValue,x=this.getFocusableOptions();return b.createElement(BC,vt({},i,{id:this.getElementId("live-region"),ariaSelection:f,focusedOption:m,focusedValue:p,isFocused:g,selectValue:y,focusableOptions:x,isAppleDevice:this.state.isAppleDevice}))}},{key:"render",value:function(){var i=this.getComponents(),c=i.Control,f=i.IndicatorsContainer,m=i.SelectContainer,p=i.ValueContainer,g=this.props,y=g.className,x=g.id,w=g.isDisabled,k=g.menuIsOpen,N=this.state.isFocused,S=this.commonProps=this.getCommonProps();return b.createElement(m,vt({},S,{className:y,innerProps:{id:x,onKeyDown:this.onKeyDown},isDisabled:w,isFocused:N}),this.renderLiveRegion(),b.createElement(c,vt({},S,{innerRef:this.getControlRef,innerProps:{onMouseDown:this.onControlMouseDown,onTouchEnd:this.onControlTouchEnd},isDisabled:w,isFocused:N,menuIsOpen:k}),b.createElement(p,vt({},S,{isDisabled:w}),this.renderPlaceholderOrValue(),this.renderInput()),b.createElement(f,vt({},S,{isDisabled:w}),this.renderClearIndicator(),this.renderLoadingIndicator(),this.renderIndicatorSeparator(),this.renderDropdownIndicator())),this.renderMenu(),this.renderFormField())}}],[{key:"getDerivedStateFromProps",value:function(i,c){var f=c.prevProps,m=c.clearFocusValueOnUpdate,p=c.inputIsHiddenAfterUpdate,g=c.ariaSelection,y=c.isFocused,x=c.prevWasFocused,w=c.instancePrefix,k=i.options,N=i.value,S=i.menuIsOpen,j=i.inputValue,C=i.isMulti,T=by(N),V={};if(f&&(N!==f.value||k!==f.options||S!==f.menuIsOpen||j!==f.inputValue)){var U=S?p4(i,T):[],R=S?Ay(pu(i,T),"".concat(w,"-option")):[],z=m?h4(c,T):null,L=m4(c,U),$=gf(R,L);V={selectValue:T,focusedOption:L,focusedOptionId:$,focusableOptionsWithIds:R,focusedValue:z,clearFocusValueOnUpdate:!1}}var Y=p!=null&&i!==f?{inputIsHidden:p,inputIsHiddenAfterUpdate:void 0}:{},ue=g,pe=y&&x;return y&&!pe&&(ue={value:su(C,T,T[0]||null),options:T,action:"initial-input-focus"},pe=!x),g?.action==="initial-input-focus"&&(ue=null),bt(bt(bt({},V),Y),{},{prevProps:i,ariaSelection:ue,prevWasFocused:pe})}}]),s})(b.Component);fx.defaultProps=f4;var y4=b.forwardRef(function(n,o){var s=_S(n);return b.createElement(fx,vt({ref:o},s))}),_y=y4;function yf({containerClass:n,name:o,value:s,options:l,onChange:i,disabled:c=!1,hideLabel:f=!1,hasPin:m,isPinned:p=!1,onTogglePin:g,hasError:y=!1,forceModalOpen:x=!1,onModalClose:w}){const k=ae(I=>I.setNodeTypes),S=al(I=>I.theme)==="dark",[j,C]=b.useState(!1),T=b.useRef(null),V=b.useRef(null),[U,R]=b.useState([]),[z,L]=b.useState(!1),$=x||j,Y=Nb(),ue=I=>{if(!Array.isArray(l))return l?.[I]},pe=Array.isArray(l)?l:ue("options")??[],fe=!!ue("image_upload"),Re=ue("image_folder")??"input",Ie="__null__",Ae=pe.some(I=>I===null),_=pe.filter(I=>I!==null).map(I=>String(I)),se=Array.from(new Set([..._,...U])),ce=s===null?Ie:String(s??""),Ue=ce.split(/[\\/]/).pop()??ce,De=se.includes(ce)||se.includes(Ue),E=s!=null&&ce!==""&&!De,A=De?se.includes(ce)?ce:Ue:ce,O=[];(s===null||Ae)&&O.push({value:Ie,label:"None"}),E&&O.push({value:ce,label:ce,isMissing:!0}),O.push(...se.map(I=>({value:I,label:I})));const te=O.find(I=>I.value===A)??null,Le=pe.filter(I=>I!==null).length,We=x?!0:Y&&!(Le>0&&Le<5),xe=fe&&Re==="input",Se=I=>{const B=I.replace(/\\/g,"/"),W=B.lastIndexOf("/"),be=W>=0?B.slice(W+1):B,me=W>=0?B.slice(0,W):"";return mo(be,me,"input")},H=b.useMemo(()=>xe?{DropdownIndicator:null,IndicatorSeparator:null,Option:B=>{const{data:W}=B,me=W.value!==Ie&&!W.isMissing&&!!W.value?Se(W.value):null;return u.jsx(tx.Option,{...B,children:u.jsxs("div",{className:"flex items-center gap-2",children:[me&&u.jsx("img",{src:me,alt:"",className:"w-[72px] h-[72px] rounded-sm object-cover bg-gray-100 shrink-0",loading:"lazy",decoding:"async"}),u.jsx("span",{className:"truncate",children:W.label})]})})}}:{DropdownIndicator:null,IndicatorSeparator:null},[xe]),P=["rs-container",m?"rs-has-pin":"rs-no-pin",y?"rs-error":"",E?"rs-missing":"",c?"rs-disabled":""].filter(Boolean).join(" "),D=typeof document>"u"?null:document.body,K=()=>{C(!1),w?.()},Z=I=>{I&&i(I.value===Ie?null:I.value)},q=I=>{Z(I),K()},Ee=()=>{c||z||V.current?.click()},je=async I=>{const B=I.target.files?.[0];if(B){L(!0);try{const W=await eb(B,{type:Re}),be=W.subfolder?`${W.subfolder}/${W.name}`:W.name;R(me=>me.includes(be)?me:[...me,be]);try{const me=await tp();k(me)}catch{}i(be)}catch(W){console.error("Failed to upload image:",W)}finally{L(!1),I.target.value=""}}},Ne=fe?u.jsx("button",{type:"button",className:`w-full py-2 px-3 rounded-lg border text-sm font-medium transition-colors ${c||z?"opacity-60 cursor-not-allowed border-gray-200 text-gray-400 bg-white":"border-gray-200 text-gray-700 bg-white hover:border-gray-300 hover:text-gray-900"}`,onClick:Ee,disabled:c||z,children:u.jsxs("span",{className:"inline-flex items-center justify-center gap-2",children:[u.jsx(zo,{className:"w-4 h-4"}),z?"Uploading...":"Load from camera roll"]})}):null,ee=kt.text.primary,Me=kt.text.secondary;return We?u.jsxs("div",{className:`${n} combo-control-root combo-control-modal`,children:[!f&&u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:o}),u.jsxs("div",{className:`combo-control-trigger relative w-full p-3 comfy-input text-base flex items-center justify-between min-h-[46px] ${c?"opacity-60 cursor-not-allowed":""} ${y?"border-red-700 ring-1 ring-red-700":""}`,onClick:()=>!c&&C(!0),children:[u.jsx("span",{className:`combo-control-trigger-label truncate min-w-0 flex-1 ${te?"text-gray-900":"text-gray-400 dark:text-gray-500"} ${m?"pr-16":"pr-6"}`,style:te&&S?{color:kt.text.onDark}:void 0,children:te?te.label:"Select..."}),u.jsxs("div",{className:"combo-control-trigger-icons flex items-center absolute right-0 top-0 bottom-0 pointer-events-none",children:[u.jsx("div",{className:"combo-control-chevron px-2 text-gray-400",children:u.jsx(vu,{className:"w-5 h-5"})}),m&&u.jsx("div",{className:"combo-control-pin pointer-events-auto px-2",children:u.jsx(nl,{isPinned:p,onToggle:g})})]})]}),E&&u.jsx("div",{className:"mt-1 text-xs text-red-700",children:"Missing on ComfyUI server"}),fe&&u.jsxs("div",{className:"combo-control-upload mt-2",children:[Ne,u.jsx("input",{ref:V,type:"file",accept:"image/*",className:"hidden",onChange:je})]}),u.jsx(gp,{title:o,isOpen:$,onClose:K,children:u.jsx(_y,{className:P,classNamePrefix:"rs",options:O,value:te,onChange:q,isSearchable:!0,autoFocus:!x,menuIsOpen:x?void 0:!0,controlShouldRenderValue:!0,placeholder:"Search...",filterOption:Pf({ignoreAccents:!0,ignoreCase:!0,trim:!0,matchFrom:"any"}),styles:{menu:I=>({...I,position:"static",boxShadow:"none",border:"none",marginTop:"0.5rem",borderRadius:0,backgroundColor:S?kt.transparent:kt.surface.white}),menuList:I=>({...I,maxHeight:"calc(100vh - 160px)",height:"auto",paddingBottom:"2rem",overflowY:"auto",overflowX:"auto",overscrollBehaviorY:"contain",overscrollBehaviorX:"contain",touchAction:"pan-y"}),option:(I,B)=>S?I:{...I,color:ee,backgroundColor:B.isSelected?kt.surface.gray200:B.isFocused?kt.surface.gray100:kt.transparent},singleValue:I=>({...I,color:S?I.color:ee}),input:I=>({...I,color:S?I.color:ee}),placeholder:I=>({...I,color:S?I.color:Me}),control:I=>({...I,borderColor:kt.border.focusBlue,boxShadow:`0 0 0 1px ${kt.border.focusBlue}`,backgroundColor:S?I.backgroundColor:kt.surface.white,color:S?I.color:ee})},components:H,noOptionsMessage:()=>"No matches"})})]}):u.jsxs("div",{className:`${n} combo-control-root combo-control-inline`,children:[!f&&u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:o}),u.jsxs("div",{className:"combo-control-input-wrapper relative rs-scroll-target",ref:T,children:[u.jsx(_y,{className:P,classNamePrefix:"rs",options:O,value:te,onChange:Z,isSearchable:!0,isDisabled:c,filterOption:Pf({ignoreAccents:!0,ignoreCase:!0,trim:!0,matchFrom:"any"}),menuPortalTarget:D,menuPosition:"fixed",menuPlacement:"bottom",menuShouldScrollIntoView:!1,styles:{menuPortal:I=>({...I,zIndex:200}),menuList:I=>({...I,overflowY:"auto",overflowX:"auto",overscrollBehaviorY:"contain",overscrollBehaviorX:"contain",touchAction:"pan-y"}),option:(I,B)=>S?I:{...I,color:ee,backgroundColor:B.isSelected?kt.surface.gray200:B.isFocused?kt.surface.gray100:kt.transparent},singleValue:I=>({...I,color:S?I.color:ee}),input:I=>({...I,color:S?I.color:ee}),placeholder:I=>({...I,color:S?I.color:Me})},components:H,noOptionsMessage:()=>"No matches"}),u.jsxs("div",{className:"combo-control-icons absolute right-0 top-0 bottom-0 flex items-center pointer-events-none",children:[u.jsx("div",{className:"combo-control-chevron px-2 text-gray-400",children:u.jsx(vu,{className:"w-5 h-5"})}),m&&u.jsx("div",{className:"combo-control-pin pointer-events-auto px-2",children:u.jsx(nl,{isPinned:p,onToggle:g})}),!m&&u.jsx("div",{className:"w-3"})]})]}),E&&u.jsx("div",{className:"mt-1 text-xs text-red-700",children:"Missing on ComfyUI server"}),fe&&u.jsxs("div",{className:"mt-2",children:[Ne,u.jsx("input",{ref:V,type:"file",accept:"image/*",className:"hidden",onChange:je})]})]})}function _o({name:n,type:o,value:s,options:l,onChange:i,disabled:c=!1,hasError:f=!1,hideLabel:m=!1,compact:p=!1,forceModalOpen:g=!1,onModalClose:y,seedMode:x,onSeedModeChange:w,hasPin:k,isPinned:N=!1,onTogglePin:S,containerClass:j}){const[C,T]=b.useState(!1),V=()=>{c||T(!0)},U=()=>{T(!1),y?.()},R=o==="COMBO"||Array.isArray(l?.options),z=["INT","FLOAT"].includes(o.toUpperCase()),L=o.toUpperCase()==="STRING",$=n.replace(/_/g," "),Y=k??(!!S||N),ue=j??"space-y-2 w-full",pe=j??(p?"mb-0":"mb-3"),fe={name:n,value:s,options:l,onChange:i,disabled:c,hideLabel:m,hasError:f,forceModalOpen:g,onModalClose:y,containerClass:ue,hasPin:Y,isPinned:N,onTogglePin:S},Re=()=>R?u.jsx(yf,{...fe}):z?u.jsx(Hf,{...fe,type:o,seedMode:x,onSeedModeChange:w}):L?u.jsx(oy,{...fe}):u.jsxs("div",{className:"unsupported-widget-type text-xs text-gray-400 italic",children:["Unsupported: ",o]}),Ie=g||C;if(o==="POWER_LORA_HEADER")return u.jsx("div",{className:`${pe} power-lora-header flex items-center justify-between p-3 bg-blue-50/50 dark:bg-blue-900/20 rounded-lg`,children:u.jsxs("div",{className:"power-lora-header-content flex items-center gap-3",children:[u.jsx("input",{type:"checkbox",onChange:Ae=>i(Ae.target.checked),className:"w-5 h-5 rounded cursor-pointer",disabled:c}),u.jsx("span",{className:"power-lora-header-label text-sm font-semibold text-blue-900 dark:text-blue-100 uppercase tracking-wider",children:"Toggle All Loras"})]})});if(o==="POWER_LORA"){const Ae=s||{on:!0,lora:"",strength:1},_=l||{},se=_.choices,ce=_.showSeparate,Ue=(De,E)=>{i({...Ae,[De]:E})};return u.jsxs("div",{className:`${pe} power-lora-row flex flex-col gap-2 p-3 border border-gray-200 dark:border-gray-800 rounded-lg bg-gray-50/50 dark:bg-gray-900/50 ${Ae.on?"":"opacity-60"}`,children:[u.jsxs("div",{className:"power-lora-row-actions flex items-center gap-2",children:[u.jsx("button",{type:"button",onClick:()=>Ue("on",!Ae.on),className:`power-lora-enabled-button flex-1 py-2 rounded-lg text-sm font-semibold transition-colors ${Ae.on?"bg-blue-600 text-white":"bg-gray-700 text-white"} ${c?"opacity-60 cursor-not-allowed":""}`,disabled:c,children:Ae.on?"Enabled":"Disabled"}),u.jsx("button",{type:"button",onClick:()=>i(null),className:`power-lora-remove-button flex-1 py-2 rounded-lg text-sm font-semibold bg-red-600 text-white hover:bg-red-700 transition-colors ${c?"opacity-60 cursor-not-allowed":""}`,disabled:c,children:"Remove"})]}),u.jsx("div",{className:"power-lora-row-header flex items-center gap-3",children:u.jsx("div",{className:"power-lora-select flex-grow min-w-0",children:u.jsx(_o,{name:"",hideLabel:!0,compact:!0,type:"COMBO",value:Ae.lora,options:se,onChange:De=>Ue("lora",De),disabled:c})})}),u.jsxs("div",{className:"power-lora-strengths flex flex-col",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 ml-1",children:ce?"Model strength":"Strength"}),u.jsx("div",{className:"power-lora-strength-row flex items-center gap-3",children:u.jsx("div",{className:"power-lora-strength-input flex-grow",children:u.jsx(_o,{name:"",hideLabel:!0,compact:!0,type:"FLOAT",value:Ae.strength,options:{min:-10,max:10,step:.01},onChange:De=>Ue("strength",De),disabled:c})})}),ce&&u.jsx("label",{className:"block text-sm font-medium text-gray-700 ml-1",children:"Clip strength"}),ce&&u.jsx("div",{className:"power-lora-strength-row flex items-center gap-3",children:u.jsx("div",{className:"power-lora-strength-input flex-grow",children:u.jsx(_o,{name:"",hideLabel:!0,compact:!0,type:"FLOAT",value:Ae.strengthTwo??Ae.strength,options:{min:-10,max:10,step:.01},onChange:De=>Ue("strengthTwo",De),disabled:c})})})]})]})}if(o==="POWER_LORA_ADD"){const Ae=()=>{i({on:!0,lora:"None",strength:1,model_strength:1,clip_strength:1})};return u.jsx("div",{className:`${pe} power-lora-add`,children:u.jsxs("button",{onClick:Ae,className:"w-full py-2 px-4 border-2 border-dashed border-gray-300 dark:border-gray-700 rounded-lg text-sm font-medium text-gray-500 hover:text-blue-500 hover:border-blue-500 transition-all flex items-center justify-center gap-2",disabled:c,children:[u.jsx(zo,{className:"w-5 h-5"}),"Add Lora"]})})}return L?u.jsx(oy,{...fe}):R?u.jsx(yf,{...fe}):z?u.jsx(Hf,{...fe,type:o,seedMode:x,onSeedModeChange:w}):o.toUpperCase()==="BOOLEAN"?u.jsx(yf,{...fe,value:String(!!s),options:["true","false"],onChange:Ae=>i(String(Ae).toLowerCase()==="true")}):u.jsxs("div",{id:`widget-control-${n}`,className:`widget-control-root ${p?"compact-control":""}`,children:[!m&&u.jsxs("div",{id:`widget-label-container-${n}`,className:"flex items-center justify-between mb-1.5 px-1",children:[u.jsx("label",{id:`widget-label-${n}`,className:"text-[10px] font-bold text-gray-500 uppercase tracking-wider truncate mr-2",children:$}),f&&u.jsx("div",{id:`widget-error-icon-${n}`,className:"text-red-500",title:"Error in this input",children:u.jsx(pb,{className:"w-3.5 h-3.5"})})]}),u.jsx("div",{id:`widget-trigger-${n}`,className:`
          control-trigger
          relative flex items-center justify-between
          bg-gray-50 border border-gray-200 rounded-xl px-3 py-2.5
          active:bg-gray-100 active:border-gray-300 transition-all
          ${c?"opacity-50 grayscale pointer-events-none":"cursor-pointer"}
          ${f?"border-red-300 bg-red-50/30":""}
        `,onClick:V,children:u.jsx("div",{id:`widget-value-display-${n}`,className:"value-display flex-1 truncate text-sm font-medium text-gray-900",children:R?s||"Select...":s!=null?String(s):"Empty"})}),u.jsx(gp,{isOpen:Ie,title:$,onClose:U,children:u.jsx("div",{id:`modal-control-wrapper-${n}`,className:"p-2",children:Re()})})]})}function b4({node:n,isBypassed:o,isKSampler:s,workflowExists:l,nodeTypesExists:i,visibleInputWidgets:c,visibleWidgets:f,errorInputNames:m,onUpdateNodeWidget:p,onUpdateNodeWidgets:g,getWidgetIndexForInput:y,findSeedWidgetIndex:x,setSeedMode:w,isWidgetPinned:k,toggleWidgetPin:N}){const S=Array.isArray(n.widgets_values)?n.widgets_values:[],j=ae(O=>O.nodeTypes),C=ae(O=>O.workflow),T=ae(O=>O.bypassAllInContainer),V=$n(O=>O.seedModes[n.id]),U=$n(O=>O.seedLastValues[n.id]??null),R=n.type==="Fast Groups Bypasser (rgthree)",z=!s&&l&&i?x():null,L=z!==null?z+1:null,$=L!==null?S[L]:void 0,Y=typeof $=="string",ue=!s&&z!==null&&!Y,pe=ue?c.filter(O=>O.name!=="seed"&&O.name!=="noise_seed"):c,fe=ue?f.filter(O=>O.name!=="seed"&&O.name!=="noise_seed"):f,Re=f.length>0||c.length>0,Ie=b.useMemo(()=>{if(!R||!C)return[];const O=n.properties??{},te=typeof O.matchColors=="string"?O.matchColors:"",Le=typeof O.matchTitle=="string"?O.matchTitle:"",We=O.showAllGraphs!==!1,xe=typeof O.sort=="string"?O.sort:"position",Se=typeof O.customSortAlphabet=="string"?O.customSortAlphabet:"",H=kt.workflow.fastGroupBypassColors,P=te.split(",").map(B=>B.trim()).filter(Boolean).flatMap(B=>W0(B,H)),D=new Set(P),K=P.map(B=>ba(B)??xb(B)).filter(B=>!!B).map(B=>G0(B)).filter(B=>!!B);let Z=null;if(Le.trim())try{Z=new RegExp(Le,"i")}catch(B){return console.error(B),[]}let q=null;if(xe==="custom alphabet"){const B=Se.replace(/\n/g,"").trim().toLowerCase();B&&(q=B.includes(",")?B.split(",").map(W=>W.trim()).filter(Boolean):B.split("")),q?.length||(q=null)}const Ee=new Map(C.nodes.map(B=>[B.id,B])),je=[],Ne=B=>{if(D.size>0){const W=B.color?W0(B.color,H):[],be=B.color?ba(B.color):null,me=be?G0(be):null,ke=W.some(ie=>D.has(ie))||(be?D.has(be):!1),F=!!(me&&K.some(ie=>{const _e=Math.abs(ie.h-me.h);return Math.min(_e,360-_e)<=25}));if(!ke&&!F)return!1}return!(Z&&!Z.test(B.title||""))},ee=(B,W)=>{if(!Ne(B))return;const be=B.stableKey??null;if(!be)return;const me=If(C,B.id,W);let ke=!1;for(const F of me){const ie=Ee.get(F);if(!(!ie||ie.mode===4)){ke=!0;break}}je.push({key:`${W??"root"}-${B.id}`,label:B.title?.trim()||`Group ${B.id}`,stableKey:be,color:B.color,isEngaged:ke,isDisabled:me.size===0,group:B})},Me=n.properties?.__mobile_origin,I=Me?.scope==="subgraph"?Me.subgraphId:null;if(We){for(const B of C.groups??[])ee(B,null);for(const B of C.definitions?.subgraphs??[])for(const W of B.groups??[])ee(W,B.id)}else if(I){const B=C.definitions?.subgraphs?.find(W=>W.id===I);for(const W of B?.groups??[])ee(W,I)}else for(const B of C.groups??[])ee(B,null);return xe==="alphanumeric"?je.sort((B,W)=>B.label.localeCompare(W.label)):q?.length?je.sort((B,W)=>{const be=B.label.toLowerCase(),me=W.label.toLowerCase();let ke=-1,F=-1;for(const[ie,_e]of q.entries())if(ke<0&&be.startsWith(_e)&&(ke=ie),F<0&&me.startsWith(_e)&&(F=ie),ke>-1&&F>-1)break;if(ke>-1&&F>-1){const ie=ke-F;return ie===0?be.localeCompare(me):ie}return ke>-1?-1:F>-1?1:be.localeCompare(me)}):je.sort((B,W)=>{const be=B.group.bounding,me=W.group.bounding;return be[1]!==me[1]?be[1]-me[1]:be[0]-me[0]}),je},[R,n.properties,C]),Ae=O=>()=>{O.isDisabled||T(O.stableKey,O.isEngaged)},_=O=>{typeof O=="string"&&["fixed","randomize","increment","decrement"].includes(O)&&w(n.id,O)},se=O=>te=>{p(O,te),_(te)},ce=O=>te=>{p(O,te,"seed"),w(n.id,"fixed")},Ue=O=>()=>{if(!j)return;const te=fa(j,n);p(O,te,"seed"),w(n.id,"fixed")},De=O=>()=>{typeof U=="number"&&(p(O,U,"seed"),w(n.id,"fixed"))},E=O=>te=>{p(O.widgetIndex,te,O.name)},A=O=>te=>{if(O.type==="POWER_LORA_HEADER"&&typeof te=="boolean"){const{loraIndices:Le}=O.options||{};if(Le){const We={},xe=n.widgets_values;Array.isArray(xe)&&(Le.forEach(Se=>{const H=xe[Se];We[Se]={...H,on:te}}),g(We))}}else p(O.widgetIndex,te,O.name)};return!Re&&Ie.length===0?null:u.jsxs("div",{className:"node-parameters mb-2",children:[Ie.length>0&&u.jsxs("div",{className:"mb-4",children:[u.jsx("div",{className:"text-xs text-gray-400 dark:text-gray-300 mb-1.5 uppercase tracking-wide",children:"Groups"}),u.jsx("div",{className:"space-y-2",children:Ie.map(O=>u.jsxs("div",{className:`flex items-center justify-between gap-3 rounded-lg border px-3 py-2 bg-gray-50/40 dark:bg-gray-900/60 ${O.isDisabled?"border-gray-200 dark:border-white/10 opacity-60":"border-gray-200 dark:border-white/15"}`,children:[u.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[u.jsx("span",{className:"h-2.5 w-2.5 rounded-full",style:{backgroundColor:O.color||kt.workflow.defaultGroupDot}}),u.jsx("span",{className:"text-sm font-medium text-gray-800 dark:text-gray-100 truncate",children:O.label})]}),u.jsx("button",{type:"button",role:"switch","aria-checked":O.isEngaged,onClick:Ae(O),className:`relative inline-flex h-6 w-11 items-center rounded-full transition ${O.isEngaged?"bg-emerald-500":"bg-gray-300"} ${O.isDisabled?"cursor-not-allowed":"cursor-pointer"}`,children:u.jsx("span",{className:`inline-block h-5 w-5 transform rounded-full bg-white transition ${O.isEngaged?"translate-x-5":"translate-x-1"}`})})]},O.key))})]}),Re&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"text-xs text-gray-500 mb-1.5 uppercase tracking-wide",children:"Parameters"}),s&&l&&i&&(()=>{const O=y("seed");if(O===null)return null;const te=S[O],Le=O+1,We=S[Le],xe=["fixed","increment","decrement","randomize"],H=!!n.inputs.find(P=>P.name==="noise_seed")?.link;return u.jsxs("div",{className:"mb-3",children:[u.jsx(_o,{name:"seed",type:"INT",value:te,onChange:P=>p(O,P,"seed"),disabled:o,hasError:m.has("seed")}),Le<S.length&&!H&&u.jsx(_o,{name:"Control mode",type:"COMBO",value:We,options:xe,onChange:se(Le)})]})})(),!s&&l&&i&&(()=>{const O=z;if(O===null)return null;const te=["fixed","randomize","increment","decrement"],Le=typeof $=="string"&&!te.includes($)?[...te,$]:te;if(n.inputs.find(Ne=>Ne.name==="seed"||Ne.name==="noise_seed")?.link!=null)return null;if(Y){const Ne=O+1;return u.jsx("div",{className:"mb-3",children:u.jsx(_o,{name:"Seed control",type:"COMBO",value:$,options:Le,onChange:se(Ne)})})}const Se=c.find(Ne=>Ne.name==="seed"||Ne.name==="noise_seed")?.options??{},H=typeof Se.min=="number"?Se.min:void 0,P=typeof Se.max=="number"?Se.max:void 0,D=typeof Se.step=="number"?Se.step:void 0,K=Number(S[O]??0),Z=tb(K),q=V??Z??"fixed",Ee=sp(K)?typeof U=="number"?U:0:K,je=m.has("seed")||m.has("noise_seed");return u.jsxs("div",{className:"mb-3",children:[u.jsx(Hf,{name:"seed",value:Ee,onChange:ce(O),disabled:o,min:H,max:P,step:D,hasError:je}),u.jsx(_o,{name:"Seed control",type:"COMBO",value:q,options:te,onChange:_}),u.jsxs("div",{className:"grid gap-2 mt-2",children:[u.jsx("button",{type:"button",className:"w-full py-2 px-3 border border-gray-200 rounded-lg text-sm font-medium text-gray-600 hover:text-blue-600 hover:border-blue-500 transition",onClick:()=>w(n.id,"randomize"),disabled:o,children:"Randomize each time"}),u.jsx("button",{type:"button",className:"w-full py-2 px-3 border border-gray-200 rounded-lg text-sm font-medium text-gray-600 hover:text-blue-600 hover:border-blue-500 transition",onClick:Ue(O),disabled:o,children:"New fixed random"}),u.jsx("button",{type:"button",className:"w-full py-2 px-3 border border-gray-200 rounded-lg text-sm font-medium text-gray-600 hover:text-blue-600 hover:border-blue-500 transition",onClick:De(O),disabled:o||typeof U!="number",children:"Use last queued seed"})]})]})})(),pe.map(O=>u.jsx("div",{className:o?"opacity-80":"",children:u.jsx(_o,{name:O.name,type:O.type,value:O.value,options:O.options,onChange:E(O),disabled:o,isPinned:k(O.widgetIndex),onTogglePin:()=>N(O.widgetIndex,O.name,O.type,O.options),hasError:m.has(O.name)})},`input-widget-${O.name}`)),fe.map(O=>u.jsx("div",{className:o?"opacity-80":"",children:u.jsx(_o,{name:O.name,type:O.type,value:O.value,options:O.options,onChange:A(O),disabled:o,isPinned:k(O.widgetIndex),onTogglePin:()=>N(O.widgetIndex,O.name,O.type,O.options),hasError:m.has(O.name)})},`widget-${O.widgetIndex}`)),n.type==="PrimitiveNode"&&(()=>{const O=n.outputs?.[0]?.type,te=String(O).toUpperCase();if(te!=="INT"&&te!=="FLOAT"||S.length<2)return null;const Le=S[1],We=["fixed","increment","decrement","randomize"];return u.jsx("div",{className:"mb-3",children:u.jsx(_o,{name:"Control mode",type:"COMBO",value:Le,options:We,onChange:xe=>p(1,xe),disabled:o})})})()]})]})}function x4(n,o,s){if(!o)return null;const l=Wr(n,o,s,"image")??Wr(n,o,s,"filename")??Wr(n,o,s,"file");if(l==null||!Array.isArray(s.widgets_values))return null;const i=s.widgets_values[l];return v4(i)}function v4(n){if(typeof n=="string"&&n.trim()){const{filename:m,subfolder:p}=Dy(n.trim());return{filename:m,subfolder:p,type:"input"}}if(!n||typeof n!="object")return null;const o=n,s=typeof o.filename=="string"?o.filename:typeof o.name=="string"?o.name:null;if(!s||!s.trim())return null;const l=typeof o.subfolder=="string"?o.subfolder:"",i=typeof o.type=="string"?o.type:"input",{filename:c,subfolder:f}=Dy(s.trim());return{filename:c,subfolder:l||f,type:i}}function Dy(n){const o=n.replace(/^\/+/,""),s=o.split("/").filter(Boolean);return s.length<=1?{filename:o,subfolder:""}:{filename:s.pop()??o,subfolder:s.join("/")}}const w4=[],S4=b.memo(function({node:o,isExecuting:s,isConnectionHighlighted:l=!1,errorBadgeLabel:i,onImageClick:c,inGroup:f=!1,onMoveNode:m}){const p=ae(ne=>ne.nodeTypes),g=ae(ne=>ne.workflow),y=ae(ne=>ne.updateNodeWidget),x=ae(ne=>ne.updateNodeWidgets),w=ae(ne=>ne.updateNodeTitle),k=ae(ne=>ne.toggleBypass),N=ae(ne=>ne.setItemCollapsed),S=ae(ne=>ne.setItemHidden),j=ae(ne=>ne.collapsedItems),C=o.stableKey??null,T=ae(ne=>ne.setConnectionHighlightMode),V=ae(ne=>ne.connectionHighlightModes[o.id]??"off"),U=$n(ne=>ne.setSeedMode),R=ae(ne=>ne.currentWorkflowKey),z=ho(ne=>ne.pinnedWidget?.nodeId===o.id?ne.pinnedWidget:null),L=ho(ne=>ne.setPinnedWidget),$=Fn(ne=>ne.bookmarkedItems),Y=Fn(ne=>ne.toggleBookmark),ue=ae(ne=>ne.nodeOutputs[String(o.id)]),pe=sn(ne=>ne.nodeErrors[String(o.id)]),fe=ae(ne=>ne.progress),Re=ae(ne=>ne.executingPromptId),Ie=ae(ne=>ne.workflowDurationStats),Ae=ae(ne=>ne.isExecuting),_=Mt(ne=>ne.running),se=Re||(_[0]?.prompt_id??null),ce=Ma({workflow:g,runKey:se,isRunning:Ae||_.length>0,workflowDurationStats:Ie}),Ue=ce===100?100:fe,De=b.useCallback((ne,qe)=>{C&&U(ne,qe,{workflow:g,nodeTypes:p,updateNodeWidgets:(Je,at)=>x(C,at)})},[C,p,U,x,g]),E=b.useCallback(ne=>{L(ne,R)},[R,L]),A=ue??w4,[O,te]=b.useState(null),{errorPopoverOpen:Le,setErrorPopoverOpen:We,resetErrorPopover:xe}=fS(),Se=b.useRef(null),[H,P]=b.useState(!1),[D,K]=b.useState(!1),[Z,q]=b.useState(""),Ee=b.useRef(null),je=b.useRef(0),Ne=b.useRef(null),[ee,Me]=b.useState(null),[I,B]=b.useState(!1),W=ae(ne=>ne.deleteNode);b.useEffect(()=>{const ne=qe=>{const Je=qe.detail;if(Je.nodeId===o.id){Me(Je.label);const at=setTimeout(()=>Me(null),1e3);return()=>clearTimeout(at)}};return window.addEventListener("node-show-label",ne),()=>window.removeEventListener("node-show-label",ne)},[o.id]);const be=pe&&pe.length>0,me=b.useMemo(()=>pe?new Set(pe.map(ne=>ne.inputName).filter(ne=>!!ne)):new Set,[pe]),ke=A.length>0?A[A.length-1]:null,F=ke?`${ke.filename}|${ke.subfolder}|${ke.type}`:null,ie=O?`${O.filename}|${O.subfolder}|${O.type}`:null;b.useEffect(()=>{if(!ke||F===ie)return;const ne=mo(ke.filename,ke.subfolder,ke.type),qe=new Image;qe.onload=()=>te(ke),qe.src=ne},[F,ie,ke]);const _e=p?.[o.type],$e=b.useMemo(()=>{const ne=o.title;return typeof ne=="string"&&ne.trim()?ne.trim():null},[o]),Ze=$e||_e?.display_name||o.type,Ge=o.type==="KSampler",nt=o.mode===4,Ye=C?!!j[C]:!1,Fe=/LoadImage/i.test(o.type),ft=b.useMemo(()=>!Fe||!g||!p?null:x4(g,p,o),[Fe,o,p,g])??O,Nt=b.useMemo(()=>{const ne=lp(p,o);return Ge?ne.filter(qe=>qe.name!=="seed"):ne},[p,o,Ge]),Ht=b.useMemo(()=>ap(p,o),[p,o]),Vt=b.useMemo(()=>Ht.filter(ne=>!ne.connected),[Ht]),ye=b.useMemo(()=>Nt.filter(ne=>!ne.connected),[Nt]),Q=b.useMemo(()=>{const ne=o.properties,qe=["text","note","description","label","title"];if(ne)for(const at of qe){const Lt=ne[at];if(typeof Lt=="string"&&Lt.trim())return Lt}if(/note|comment|sticky|label/i.test(o.type)&&Array.isArray(o.widgets_values)){const at=o.widgets_values.find(Lt=>typeof Lt=="string"&&Lt.trim());if(typeof at=="string"&&at.trim())return at}return null},[o.properties,o.widgets_values,o.type]),re=b.useMemo(()=>{if(!/note|comment|sticky|label/i.test(o.type)||!Array.isArray(o.widgets_values))return null;const qe=o.widgets_values.findIndex(Je=>typeof Je=="string"&&Je.trim());return qe>=0?qe:null},[o.type,o.widgets_values]),de=ne=>!g||!p?null:Wr(g,p,o,ne),Oe=()=>!g||!p?null:rl(g,p,o),Ke=ne=>{re!==null&&C&&y(C,re,ne)},we=b.useMemo(()=>{if(!Q)return null;const ne=[],qe=/(https?:\/\/[^\s]+)/g;let Je=0,at,Lt=0;for(;(at=qe.exec(Q))!==null;){const[Zt]=at,On=at.index;On>Je&&ne.push(Q.slice(Je,On)),ne.push(u.jsx("a",{href:Zt,target:"_blank",rel:"noreferrer",className:"text-blue-600 underline break-all",children:Zt},`note-link-${Lt++}`)),Je=On+Zt.length}return Je<Q.length&&ne.push(Q.slice(Je)),ne},[Q]),it=()=>{const ne=Date.now();ne-je.current<300&&P(!0),je.current=ne},ot=b.useMemo(()=>{const ne=[];return Vt.forEach(qe=>{ne.push({widgetIndex:qe.widgetIndex,name:qe.name,type:qe.type,options:qe.options})}),ye.forEach(qe=>{ne.push({widgetIndex:qe.widgetIndex,name:qe.name,type:qe.type,options:qe.options})}),ne},[Vt,ye]),tt=b.useCallback(ne=>{if(ne.link!=null)return!1;if(ne.widget)return!0;const qe=_e?.input?.required?.[ne.name]||_e?.input?.optional?.[ne.name];if(!qe)return!1;const[Je,at]=qe;if(Array.isArray(Je))return!0;const Lt=String(Je).toUpperCase(),Zt=Object.prototype.hasOwnProperty.call(at??{},"default");return["INT","FLOAT","BOOLEAN","STRING"].includes(Lt)||Zt},[_e]),lt=b.useMemo(()=>o.inputs.filter(ne=>!(tt(ne)||String(ne.type).toUpperCase()==="OPT_CONNECTION"&&ne.link==null)),[o.inputs,tt]),wt=b.useMemo(()=>o.outputs.filter(ne=>!((ne.name||"").toLowerCase().replace(/[_\s]/g,"")==="showhelp"||String(ne.type).toUpperCase()==="OPT_CONNECTION"&&!ne.links?.length)),[o.outputs]),pt=o.outputs.some(ne=>String(ne.type).toUpperCase()==="IMAGE"),St=!!(_e?.output_node||/PreviewImage|SaveImage|SaveAnimatedPNG|SaveAnimatedWEBP|SaveVideo/i.test(o.type)),yt=ne=>z?.widgetIndex===ne,ht=(ne,qe,Je,at)=>{yt(ne)?E(null):E({nodeId:o.id,widgetIndex:ne,widgetName:qe,widgetType:Je,options:at})},Tt=ot.length===1?ot[0]:null,Et=Tt?yt(Tt.widgetIndex):!1,Yt=!!z,Gt=C?$.includes(C):!1,dn=$.length<5||Gt,pn=(pt||St)&&!!ft,Wn=o.inputs?.filter(ne=>ne.link!=null).length??0,Kn=o.outputs?.reduce((ne,qe)=>ne+(qe.links?.length??0),0)??0,no=Wn>0||Kn>0,oo=Math.min(3,Wn),X=Math.min(3,Kn),ze=ft?(()=>{const{filename:ne,subfolder:qe,type:Je}=ft,at=mo(ne,qe,Je),Lt=qe?`${qe}/${ne}`:ne,Zt=Oa(ne);return[{src:at,alt:Ze,filename:ne,mediaType:Zt,file:{id:`${Je}/${Lt}`,name:ne,type:Zt==="video"?"video":"image",fullUrl:at}}]})():[];b.useEffect(()=>{if(!D)return;const ne=Ee.current;ne&&(ne.focus(),ne.select())},[D]);const oe=()=>{q(Ze),K(!0)},et=()=>{const ne=Z.trim();C&&(w(C,ne.length>0?ne:null),K(!1))},Xe=b.useCallback((ne,qe,Je)=>{C&&y(C,ne,qe,Je)},[C,y]),Qe=b.useCallback(ne=>{C&&x(C,ne)},[C,x]),Pe=!!(ee&&!/^error\b/i.test(ee));return u.jsxs("div",{id:`node-card-wrapper-${o.id}`,className:"relative node-card-outer",children:[u.jsx("div",{id:`node-anchor-${o.id}`,className:"absolute -top-3 left-0 right-0 h-0 node-scroll-anchor"}),Pe&&u.jsx(vS,{label:ee??""}),i&&u.jsx("div",{className:"absolute top-2 right-2 z-[110] animate-in fade-in duration-150",children:u.jsx("div",{className:"bg-red-600 text-white text-[10px] font-black px-2 py-0.5 rounded-full shadow-lg whitespace-nowrap uppercase tracking-tighter ring-2 ring-white",children:i})}),u.jsxs("div",{id:`node-card-${o.id}`,className:`
        node-card-inner
        ${f?"rounded-lg shadow-sm py-1":"rounded-xl shadow-md px-2 py-1 mb-3"}
        border-2
        ${be?"border-red-700 shadow-red-200":l?"border-orange-500 shadow-orange-200":s?"border-green-500 shadow-green-200":nt?"border-purple-300":"border-transparent"}
        ${nt?Ye?"bg-purple-200":"bg-purple-100/50":"bg-white"}
      `,style:{overflow:"visible"},children:[u.jsx(bS,{nodeId:o.id,displayName:Ze,isEditingLabel:D,labelValue:Z,labelInputRef:Ee,onLabelChange:q,onLabelBlur:et,isCollapsed:Ye,isBypassed:nt,isExecuting:s,overallProgress:ce,hasErrors:be,errorIconRef:Ne,errorPopoverOpen:Le,setErrorPopoverOpen:We,toggleNodeFold:()=>{C&&N(C,!Ye)},rightSlot:u.jsx(hS,{nodeId:o.id,nodeStableKey:C,isBypassed:nt,onEditLabel:oe,pinnableWidgets:ot,singlePinnableWidget:Tt,isSingleWidgetPinned:Et,hasPinnedWidget:Yt,toggleWidgetPin:ht,setPinnedWidget:E,isNodeBookmarked:Gt,canAddNodeBookmark:dn,onToggleNodeBookmark:()=>C?Y(C):void 0,toggleBypass:k,setItemHidden:S,onDeleteNode:()=>B(!0),onMoveNode:m??(()=>{}),connectionHighlightMode:V,setConnectionHighlightMode:T,leftLineCount:oo,rightLineCount:X})}),u.jsx("div",{className:`grid transition-[grid-template-rows] duration-200 ease-out ${Ye?"grid-rows-[0fr]":"grid-rows-[1fr]"}`,children:u.jsxs("div",{className:`collapse-container overflow-hidden transition-opacity px-1 duration-200 ease-out ${Ye?"opacity-0":"opacity-100"}`,children:[$e&&u.jsx("div",{className:"node-card-subtitle text-[10px] text-center font-semibold uppercase tracking-wider text-gray-400 mb-2 px-1",children:_e?.display_name||o.type}),u.jsxs("div",{id:`node-content-${o.id}`,className:`node-expanded-content ${nt?"opacity-60 grayscale":""}`,children:[u.jsx(MS,{nodeId:o.id,nodeType:o.type,inputs:lt,outputs:wt,allInputs:o.inputs,allOutputs:o.outputs}),u.jsx(b4,{node:o,isBypassed:nt,isKSampler:Ge,workflowExists:!!g,nodeTypesExists:!!p,visibleInputWidgets:Vt,visibleWidgets:ye,errorInputNames:me,onUpdateNodeWidget:Xe,onUpdateNodeWidgets:Qe,getWidgetIndexForInput:de,findSeedWidgetIndex:Oe,setSeedMode:De,isWidgetPinned:yt,toggleWidgetPin:ht}),Q&&u.jsx(gS,{noteText:Q,noteLinkified:we,noteWidgetIndex:re,isEditingNote:H,setIsEditingNote:P,onUpdateNote:Ke,noteTextareaRef:Se,onNoteTap:it}),u.jsx(yS,{show:pn,previewImage:ft,displayName:Ze,onImageClick:()=>c?.(ze,0),isExecuting:!!s,overallProgress:ce,displayNodeProgress:Ue})]})]})})]}),u.jsx(mS,{nodeId:o.id,open:Le&&be,errors:pe??[],anchorRef:Ne,onClose:xe}),I&&u.jsx(xS,{nodeId:o.id,displayName:Ze,hasConnections:no,onCancel:()=>B(!1),onDelete:ne=>{C&&W(C,ne),B(!1)}})]})});function N4({onClick:n}){return u.jsxs("button",{type:"button",onClick:n,className:"w-full mb-3 py-4 rounded-xl border-2 border-dashed border-gray-300 flex items-center justify-center gap-2 text-sm font-medium text-gray-400 hover:border-gray-400 hover:text-gray-500 active:bg-gray-50 transition-colors",children:[u.jsx(zo,{className:"w-4 h-4"}),"Add node"]})}function By({id:n,headerId:o,title:s,nodeCount:l,backgroundColor:i,borderColor:c,textClassName:f,className:m=""}){const p=()=>{document.getElementById(o)?.scrollIntoView({behavior:"smooth",block:"start"})};return u.jsx("div",{id:n,className:`px-3 py-1.5 -mx-1 rounded-b-xl cursor-pointer ${m}`,onClick:p,style:{backgroundColor:i,borderColor:c},children:u.jsxs("div",{className:"flex items-center justify-between gap-3",children:[u.jsx("span",{className:`text-xs select-none ${f}`,children:s}),typeof l=="number"&&u.jsxs("span",{className:`text-xs select-none ${f}`,children:[l," node",l!==1?"s":""]})]})})}function zy({containerType:n,containerId:o,title:s,nodeCount:l,isCollapsed:i,hiddenNodeCount:c,isBookmarked:f,canShowBookmarkAction:m,foldAllLabel:p,backgroundColor:g,borderColor:y,onToggleCollapse:x,onToggleFoldAll:w,onToggleBookmark:k,onBypassAll:N,onHide:S,onAddNode:j,onDelete:C,onShowHiddenNodes:T,onMove:V,onCommitTitle:U}){const[R,z]=b.useState(!1),[L,$]=b.useState(!1),[Y,ue]=b.useState(""),pe=b.useRef(null),fe=b.useRef(null),Re=b.useRef(null),{menuStyle:Ie,resetMenuPosition:Ae}=mp({open:R,buttonRef:Re,menuRef:fe}),_=s.trim()||`${n} ${o}`,se=c>0,ce=f||m,Ue=n==="subgraph"?"text-blue-600":"text-gray-500",De=()=>{z(!1),Ae()};cl({open:R,onDismiss:()=>{z(!1),Ae()},triggerRef:Re,contentRef:fe,ignoreScrollWithinContent:!0}),b.useEffect(()=>{if(!L)return;const A=pe.current;A&&(A.focus(),A.select())},[L]);const E=()=>{L||x()};return u.jsxs("div",{id:`${n}-header-${o}`,className:`flex items-center justify-between cursor-pointer gap-3 px-3 py-2 ${i?"rounded-xl":"rounded-t-xl mb-2"}`,style:{backgroundColor:g,borderColor:y},onClick:E,children:[u.jsxs("div",{className:"flex items-center gap-1 min-w-0 flex-1",children:[u.jsx("button",{onClick:A=>{A.stopPropagation(),x()},className:"w-8 h-8 -ml-2 flex items-center justify-center text-gray-500 hover:text-gray-700 shrink-0",children:i?u.jsx(gs,{className:"w-6 h-6"}):u.jsx(Jn,{className:"w-6 h-6"})}),L?u.jsx("input",{ref:pe,value:Y,onChange:A=>ue(A.target.value),onBlur:()=>{U(Y),$(!1)},onKeyDown:A=>{(A.key==="Enter"||A.key==="Escape")&&A.currentTarget.blur()},onClick:A=>A.stopPropagation(),className:"font-semibold text-gray-900 flex-1 min-w-0 text-sm bg-white border border-gray-200 rounded px-2 py-1"}):u.jsx("h3",{className:"font-semibold text-gray-900 select-none flex-1 min-w-0 whitespace-nowrap overflow-hidden text-ellipsis",children:_}),u.jsxs("span",{className:`text-sm shrink-0 ${Ue}`,children:[l," node",l!==1?"s":""]})]}),u.jsx(Pr,{onClick:A=>{A.stopPropagation(),Ae(),z(O=>!O)},ariaLabel:`${n} options`,buttonRef:Re,buttonSize:8,iconSize:5,icon:f?u.jsx(Gr,{className:"w-5 h-5 text-blue-500"}):n==="subgraph"?u.jsx(bs,{className:"w-5 h-5 -scale-x-100 text-blue-500"}):void 0}),R&&Mn.createPortal(u.jsx("div",{ref:fe,className:"fixed z-[1000] w-44",style:Ie,children:u.jsx(gr,{items:[{key:"edit-label",label:"Edit label",icon:u.jsx(cp,{className:"w-4 h-4"}),onClick:A=>{A.stopPropagation(),ue(_),$(!0),De()}},{key:"add-node",label:"Add node",icon:u.jsx(zo,{className:"w-4 h-4"}),onClick:A=>{A.stopPropagation(),j(),De()}},{key:"fold-all",label:p,icon:p==="Fold all"?u.jsx(gs,{className:"w-4 h-4"}):u.jsx(Jn,{className:"w-4 h-4"}),onClick:A=>{A.stopPropagation(),w(),De()}},{key:"bypass-all",label:"Bypass all nodes",icon:u.jsx(Rf,{isBypassed:!0,className:"w-4 h-4"}),onClick:A=>{A.stopPropagation(),N(!0),De()}},{key:"unbypass-all",label:"Un-bypass all nodes",icon:u.jsx(Rf,{isBypassed:!1,className:"w-4 h-4"}),onClick:A=>{A.stopPropagation(),N(!1),De()}},{key:"toggle-bookmark",label:f?"Remove bookmark":"Bookmark container",icon:f?u.jsx(Gr,{className:"w-4 h-4 text-blue-500"}):u.jsx(_u,{className:"w-4 h-4"}),onClick:A=>{A.stopPropagation(),k(),De()},hidden:!ce},{key:"show-hidden-nodes",label:"Show hidden nodes",icon:u.jsx(Go,{className:"w-4 h-4"}),onClick:A=>{A.stopPropagation(),T(),De()},hidden:!se},{key:"hide-container",label:`Hide ${n}`,icon:u.jsx(Go,{className:"w-4 h-4"}),onClick:A=>{A.stopPropagation(),S(),De()}},{key:"move-container",label:`Move ${n}`,icon:u.jsx(bb,{className:"w-4 h-4"}),onClick:A=>{A.stopPropagation(),V(),De()}},{key:"delete-container",label:`Delete ${n}`,icon:u.jsx(Bo,{className:"w-4 h-4"}),color:"danger",onClick:A=>{A.stopPropagation(),C(),De()}}]})}),document.body)]})}function Hy({containerType:n,containerId:o,hiddenNodeCount:s=0,borderColor:l,dashedBorderColor:i,onClick:c}){const f=n==="group"?"group":"subgraph";return u.jsx("div",{id:`${n}-placeholder-${o}`,className:"flex items-center justify-center px-4 pb-4 pt-2",style:{borderColor:l},children:u.jsxs("button",{type:"button",onClick:c,className:"w-full rounded-lg border-2 border-dashed flex flex-col items-center justify-center py-4 hover:bg-white/40 transition-colors",style:{borderColor:i},children:[u.jsx("span",{className:"text-sm text-gray-400 select-none",children:s>0?`${s} hidden node${s!==1?"s":""} in ${f}`:`No nodes in ${f}`}),u.jsxs("span",{className:"text-xs text-gray-500 select-none mt-1 inline-flex items-center gap-1",children:[u.jsx(zo,{className:"w-3 h-3"}),"Click to add a node"]})]})})}function C4({isOpen:n,onClose:o,addInGroupId:s=null,addInSubgraphId:l=null,onNodeAdded:i}){const c=ae(k=>k.nodeTypes),f=ae(k=>k.addNode),m=ae(k=>k.scrollToNode),[p,g]=b.useState(""),y=b.useMemo(()=>c?Object.entries(c).map(([k,N],S)=>({index:S,name:k,displayName:ms(N,k),pack:hs(String(N.python_module??N.category?.split("/")[0]??"Core")),category:String(N.category??"Other"),description:String(N.description??"")})):[],[c]),x=b.useMemo(()=>Bf(y,p,k=>({displayName:k.displayName,typeName:k.name,category:k.category,pack:k.pack}),k=>k.index),[y,p]),w=k=>{const N=s==null&&l==null?void 0:{...s==null?{}:{inGroupId:s},...l==null?{}:{inSubgraphId:l}},S=f(k,N);if(o(),S!==null){i?.(S);const j=ae.getState().workflow?.nodes.find(C=>C.id===S)?.stableKey??null;j&&m(j)}};return u.jsx(Sb,{isOpen:n,onClose:o,title:"Add node",searchQuery:p,onSearchQueryChange:g,searchPlaceholder:"Search node types...",children:u.jsxs("div",{className:"flex-1 overflow-auto bg-white",children:[x.length===0&&u.jsx(aa,{query:p,message:"No matching node types found"}),u.jsx("div",{className:"px-3 pt-3 pb-20 flex flex-col gap-2",children:x.map(k=>u.jsx(zf,{title:k.displayName,subtitle:k.pack||"Core",onSelect:()=>w(k.name)},k.name))})]})})}function k4({containerTypeLabel:n,containerIdLabel:o,displayName:s,nodeCount:l,onCancel:i,onDeleteContainerOnly:c,onDeleteContainerAndNodes:f}){const m=n;return Mn.createPortal(u.jsx(Po,{onClose:i,title:`Delete ${m}`,description:u.jsxs(u.Fragment,{children:[u.jsx("span",{className:"font-medium text-gray-700",children:s})," (",o,") has ",l," node",l===1?"":"s","."]}),actionsLayout:"stack",actions:[{label:`Delete ${m} only`,onClick:c,className:"w-full px-4 py-2.5 text-sm font-medium text-red-700 bg-red-50 rounded-lg hover:bg-red-100 active:bg-red-200"},{label:`Delete ${m} and nodes`,onClick:f,className:"w-full px-4 py-2.5 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700 active:bg-red-800"},{label:"Cancel",onClick:i,className:"w-full px-4 py-2.5 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 active:bg-gray-300"}]}),document.body)}function lu(n){return String(n).split(",").map(o=>o.trim().toUpperCase()).filter(Boolean)}function Vy(n){return n.toLowerCase().replace(/[_-]+/g," ").replace(/\s+/g," ").trim()}function j4(n,o){let s=0;for(const l of o)if(l===n[s]&&(s+=1,s>=n.length))return!0;return n.length===0}function bf(n,o){if(!n.trim())return!0;const s=Vy(o);return Vy(n).split(" ").filter(Boolean).every(l=>s.includes(l)||j4(l,s))}function M4({visible:n,onImageClick:o}){const s=ae(X=>X.workflow),l=ae(X=>X.executingNodeId),i=ae(X=>X.connectionHighlightModes),c=Fn(X=>X.bookmarkBarSide),f=Fn(X=>X.bookmarkBarTop),m=Fn(X=>X.setBookmarkBarPosition),p=Fn(X=>X.setBookmarkRepositioningActive),g=ae(X=>X.setItemCollapsed),y=ae(X=>X.scrollToNode),x=ae(X=>X.revealNodeWithParents),w=ae(X=>X.nodeTypes),k=sn(X=>X.nodeErrors),N=ae(X=>X.searchOpen),S=ae(X=>X.searchQuery),j=ae(X=>X.setSearchQuery),C=ae(X=>X.setSearchOpen),T=ae(X=>X.addNodeModalRequest),V=ae(X=>X.clearAddNodeModalRequest),U=ae(X=>X.collapsedItems),R=ae(X=>X.hiddenItems),z=ae(X=>X.setItemHidden),L=ae(X=>X.bypassAllInContainer),$=ae(X=>X.deleteContainer),Y=ae(X=>X.updateContainerTitle),ue=ae(X=>X.mobileLayout),pe=ae(X=>X.stableKeyByPointer),fe=Fn(X=>X.bookmarkedItems),Re=Fn(X=>X.toggleBookmark),Ie=b.useRef(null),Ae=b.useRef(null),_=b.useRef(null),se=b.useRef(null),[ce,Ue]=b.useState(0),[De,E]=b.useState(!1),[A,O]=b.useState(!1),[te,Le]=b.useState(null),[We,xe]=b.useState(!1),[Se,H]=b.useState(null),[P,D]=b.useState(null),[K,Z]=b.useState(null),q=eS(),[Ee,je]=b.useState({}),Ne=b.useRef(new Map),ee=b.useRef(null),Me=b.useRef(null),I=b.useRef(null),B=b.useRef(null),W=b.useMemo(()=>new Map((s?.nodes??[]).map(X=>[X.id,X.stableKey??null])),[s]),be=b.useMemo(()=>new Map((s?.definitions?.subgraphs??[]).map(X=>[X.id,X.stableKey??null])),[s]),me=()=>{j(""),C(!1)},ke=b.useMemo(()=>{const X=new Map,ze=new Set,oe=new Set,et=(Xe,Qe)=>{Xe.forEach(Pe=>{if(Pe.type==="node"){const ne=W.get(Pe.id)??null;ne&&X.set(ne,{stableKey:ne,type:"node",nodeId:Pe.id,subgraphId:Qe,text:String(Pe.id)});return}if(Pe.type==="group"){const ne=Pe.stableKey;if(ne&&X.set(ne,{stableKey:ne,type:"group",groupId:Pe.id,subgraphId:Qe,groupKey:Pe.stableKey,text:`G${Pe.id}`}),ze.has(Pe.stableKey))return;ze.add(Pe.stableKey),et(ue.groups[Pe.stableKey]??[],Qe);return}if(Pe.type==="subgraph"){const ne=be.get(Pe.id)??null;if(ne&&X.set(ne,{stableKey:ne,type:"subgraph",subgraphId:Pe.id,text:"SG"}),oe.has(Pe.id))return;oe.add(Pe.id),et(ue.subgraphs[Pe.id]??[],Pe.id)}})};return et(ue.root,null),X},[ue,W,be]),F=b.useMemo(()=>fe.map(X=>ke.get(X)).filter(X=>X!=null),[ke,fe]),ie=b.useCallback(X=>{const ze=sb(ue,({ref:oe})=>oe.type==="node"?(W.get(oe.id)??null)===X:oe.type==="group"?oe.stableKey===X:oe.type==="subgraph"?(be.get(oe.id)??null)===X:!1);return ze?{groupKeys:ze.groupKeys,subgraphIds:ze.subgraphIds}:null},[ue,W,be]),_e=b.useCallback((X,ze,oe)=>{x(X),y(X,oe),window.dispatchEvent(new CustomEvent("workflow-scroll-to-node",{detail:{nodeId:ze,label:oe}}))},[x,y]),$e=b.useCallback((X,ze,oe,et)=>{const Xe=ie(X);if(Xe){for(const qe of Xe.subgraphIds){const Je=be.get(qe)??null;Je&&(z(Je,!1),g(Je,!1))}for(const qe of Xe.groupKeys){const Je=pe[qe];Je&&(z(Je,!1),g(Je,!1))}}if(et){const qe=be.get(et)??null;qe&&(z(qe,!1),g(qe,!1))}z(X,!1),g(X,!1);const Pe=`[data-group-id="${oe}"][data-subgraph-id="${et??"root"}"]`,ne=`[data-reposition-item="group-${ze}"]`;requestAnimationFrame(()=>{requestAnimationFrame(()=>{const qe=document.querySelector(Pe),Je=document.querySelector(ne);(qe??Je)?.scrollIntoView({behavior:"smooth",block:"start"})})})},[ie,g,z,pe,be]),Ze=b.useCallback((X,ze)=>{const oe=ie(X);if(oe){for(const Qe of oe.subgraphIds){const Pe=be.get(Qe)??null;Pe&&(z(Pe,!1),g(Pe,!1))}for(const Qe of oe.groupKeys){const Pe=pe[Qe];Pe&&(z(Pe,!1),g(Pe,!1))}}z(X,!1),g(X,!1);const et=`[data-subgraph-header-id="${ze}"]`,Xe=`[data-reposition-item="subgraph-${ze}"]`;requestAnimationFrame(()=>{requestAnimationFrame(()=>{const Qe=document.querySelector(et),Pe=document.querySelector(Xe);(Qe??Pe)?.scrollIntoView({behavior:"smooth",block:"start"})})})},[ie,g,z,pe,be]),Ge=b.useCallback((X,ze)=>()=>{if(De){E(!1),O(!1),Le(null);return}Ue(ze),X.type==="node"?_e(X.stableKey,X.nodeId):X.type==="group"?$e(X.stableKey,X.groupKey,X.groupId,X.subgraphId):Ze(X.stableKey,X.subgraphId)},[De,$e,_e,Ze]),nt=b.useCallback(()=>{if(De){E(!1),O(!1),Le(null);return}const X=(ce+1)%F.length;Ue(X);const ze=F[X];ze&&(ze.type==="node"?_e(ze.stableKey,ze.nodeId):ze.type==="group"?$e(ze.stableKey,ze.groupKey,ze.groupId,ze.subgraphId):Ze(ze.stableKey,ze.subgraphId))},[F,ce,De,$e,_e,Ze]),Ye=b.useCallback(()=>{ee.current!=null&&(window.clearTimeout(ee.current),ee.current=null)},[]),Fe=b.useCallback(()=>{const X=getComputedStyle(document.documentElement).getPropertyValue("--bottom-bar-offset"),ze=Number.parseFloat(X);return Number.isFinite(ze)?ze:0},[]),st=b.useCallback(()=>{const X=Ie.current,ze=Ae.current;if(!X||!ze)return null;const oe=X.getBoundingClientRect().height,et=ze.getBoundingClientRect().height,Xe=16,Qe=Fe()+8,Pe=Math.max(Xe,oe-et-Qe);return{minTop:Xe,maxTop:Pe}},[Fe]),ft=b.useCallback(X=>{const ze=st();return ze?Math.min(Math.max(X,ze.minTop),ze.maxTop):X},[st]),Nt=b.useCallback((X,ze)=>{const oe=Ie.current,et=I.current;if(!oe||!et)return;const Xe=oe.getBoundingClientRect(),Qe=X-Xe.left-et.x,Pe=ft(ze-Xe.top-et.y);Le({x:Qe,y:Pe})},[ft]),Ht=b.useCallback((X,ze)=>{const oe=Ie.current,et=Ae.current;if(!oe||!et)return;const Xe=et.getBoundingClientRect(),Qe=oe.getBoundingClientRect();I.current={x:X-Xe.left,y:ze-Xe.top};const Pe=Xe.left-Qe.left,ne=ft(Xe.top-Qe.top);Le({x:Pe,y:ne}),O(!0)},[ft]),Vt=b.useCallback(X=>{X.pointerType==="mouse"&&X.button!==0||X.target.closest("button")&&!De||(X.preventDefault(),Me.current={startX:X.clientX,startY:X.clientY,startTime:Date.now(),pointerId:X.pointerId},De?Ht(X.clientX,X.clientY):ee.current=window.setTimeout(()=>{E(!0),Ht(X.clientX,X.clientY)},500),X.currentTarget.setPointerCapture(X.pointerId))},[De,Ht]),ye=b.useCallback(X=>{if(A){Nt(X.clientX,X.clientY);return}const ze=Me.current;if(!ze)return;const oe=X.clientX-ze.startX,et=X.clientY-ze.startY;Math.hypot(oe,et)>8&&Ye()},[Ye,A,Nt]),Q=b.useCallback(()=>{const X=Ie.current,ze=Ae.current;if(!X||!ze||!te)return;const oe=X.getBoundingClientRect(),et=ze.getBoundingClientRect().width,Qe=te.x+et/2<oe.width/2?"left":"right",Pe=ft(te.y);m({side:Qe,top:Pe}),Le(null)},[te,ft,m]),re=b.useCallback(X=>{Ye();const ze=Me.current;if(Me.current=null,A){Q(),O(!1);return}if(De||!ze)return;const oe=X.clientX-ze.startX,et=X.clientY-ze.startY,Xe=Date.now()-ze.startTime;Math.abs(oe)>40&&Math.abs(oe)>Math.abs(et)&&Xe<500&&m({side:c==="left"?"right":"left"})},[c,Ye,Q,A,De,m]),de=b.useCallback(()=>{Ye(),Me.current=null,O(!1),Le(null)},[Ye]),Oe=b.useMemo(()=>{if(!s)return[];const X=ob(ue),ze=new Map(s.nodes.map(Xe=>[Xe.id,Xe])),oe=[];for(const Xe of X){const Qe=ze.get(Xe);Qe&&oe.push(Qe)}const et=new Set(X);for(const Xe of s.nodes)et.has(Xe.id)||oe.push(Xe);return Object.keys(R).length===0?oe:oe.filter(Xe=>{const Qe=Xe.stableKey??null;return Qe?!R[Qe]:!0})},[s,R,ue]),Ke=S.trim(),we=N&&Ke.length>0,it=b.useMemo(()=>{if(!we||!s)return new Set;const X=[...s.groups??[],...(s.definitions?.subgraphs??[]).flatMap(oe=>oe.groups??[])],ze=new Set;for(const oe of X)bf(Ke,oe.title)&&ze.add(oe.id);return ze},[s,we,Ke]),ot=b.useMemo(()=>{if(!we||!s)return new Set;const X=s.definitions?.subgraphs??[],ze=new Set;for(const oe of X){const et=oe.name||oe.id;bf(Ke,`${et} ${oe.id}`)&&ze.add(oe.id)}return ze},[s,we,Ke]),tt=b.useMemo(()=>we?Oe.filter(X=>{const ze=w?.[X.type],oe=X.title,et=[typeof oe=="string"?oe:"",ze?.display_name??"",X.type,String(X.id)];return bf(Ke,et.join(" "))}):Oe,[Oe,we,Ke,w]),lt=b.useMemo(()=>new Set(tt.map(X=>X.id)),[tt]),wt=b.useMemo(()=>s?tS(ue,s,U,R,pe):[],[ue,s,U,R,pe]),pt=b.useMemo(()=>{if(!s)return[];if(we){const X=oe=>{let et=0;for(const Xe of oe)Xe.type==="hiddenBlock"?et+=Xe.count:Xe.type==="node"?et+=1:et+=X(Xe.children);return et},ze=(oe,et=!1)=>{const Xe=[];for(const Qe of oe){if(Qe.type==="hiddenBlock")continue;if(Qe.type==="node"){(et||lt.has(Qe.node.id))&&Xe.push(Qe);continue}if(et){const qe=ze(Qe.children,!0);Xe.push({...Qe,isCollapsed:!1,nodeCount:X(qe),children:qe});continue}if(Qe.type==="group"){const qe=it.has(Qe.group.id),Je=ze(Qe.children,qe);(qe||Je.length>0)&&Xe.push({...Qe,isCollapsed:!1,nodeCount:X(Je),children:Je});continue}const Pe=ot.has(Qe.subgraph.id),ne=ze(Qe.children,!1);(Pe||ne.length>0)&&Xe.push({...Qe,isCollapsed:!1,nodeCount:X(ne),children:ne})}return Xe};return ze(wt)}return wt},[wt,lt,it,ot,we,s]),St=b.useMemo(()=>{const X=new Map;let ze=0;for(const oe of Oe){const et=k[String(oe.id)];et&&et.length>0&&(ze+=1,X.set(oe.id,ze))}return X},[Oe,k]),yt=b.useMemo(()=>{if(!s)return new Set;const X=Object.entries(i).filter(([,Pe])=>Pe!=="off").map(([Pe,ne])=>({id:Number(Pe),mode:ne}));if(X.length===0)return new Set;const ze=new Map(s.nodes.map(Pe=>[Pe.id,Pe])),oe=new Set,et=Pe=>!!(Pe.stableKey&&R[Pe.stableKey]),Xe=(Pe,ne,qe)=>{if(ne.has(Pe))return[];ne.add(Pe);const Je=ze.get(Pe);if(!Je)return[];const at=[];return Je.outputs?.forEach((Lt,Zt)=>{const On=lu(Lt.type);if(qe.size>0&&!On.some(Tn=>qe.has(Tn)))return;pa(s,Pe,Zt).forEach(Tn=>{const xn=Tn.node;et(xn)?at.push(...Xe(xn.id,ne,qe)):at.push(xn)})}),at},Qe=(Pe,ne,qe)=>{if(ne.has(Pe))return[];ne.add(Pe);const Je=ze.get(Pe);if(!Je)return[];const at=[];return Je.inputs?.forEach((Lt,Zt)=>{if(Lt.link===null)return;const On=lu(Lt.type);if(qe.size>0&&!On.some(Tn=>qe.has(Tn)))return;const on=ll(s,Pe,Zt);on&&(et(on.node)?at.push(...Qe(on.node.id,ne,qe)):at.push(on.node))}),at};return X.forEach(({id:Pe,mode:ne})=>{const qe=ze.get(Pe);qe&&((ne==="inputs"||ne==="both")&&qe.inputs?.forEach((Je,at)=>{if(Je.link===null)return;const Lt=ll(s,qe.id,at);if(!Lt)return;if(!et(Lt.node)){oe.add(Lt.node.id);return}const Zt=new Set(lu(Je.type));Qe(Lt.node.id,new Set,Zt).forEach(on=>oe.add(on.id))}),(ne==="outputs"||ne==="both")&&qe.outputs?.forEach((Je,at)=>{const Lt=new Set(lu(Je.type));pa(s,qe.id,at).forEach(On=>{const on=On.node;if(!et(on)){oe.add(on.id);return}Xe(on.id,new Set,Lt).forEach(xn=>oe.add(xn.id))})}))}),oe},[s,i,R]);b.useEffect(()=>{const X=ze=>{const oe=ze.detail,et=typeof oe=="number"?oe:oe.nodeId,Xe=typeof oe=="object"?oe.label:void 0;if(typeof et!="number"||!tt.some(at=>at.id===et))return;const Pe=St.get(et),ne=Xe??(Pe?`Error #${Pe}`:"Error");je(at=>({...at,[et]:ne}));const qe=Ne.current.get(et);qe&&window.clearTimeout(qe);const Je=window.setTimeout(()=>{je(at=>{const Lt={...at};return delete Lt[et],Lt}),Ne.current.delete(et)},2e3);Ne.current.set(et,Je)};return window.addEventListener("workflow-label-error-node",X),()=>window.removeEventListener("workflow-label-error-node",X)},[tt,St]),b.useEffect(()=>{const X=Ne.current;return()=>{X.forEach(ze=>window.clearTimeout(ze)),X.clear()}},[]),b.useEffect(()=>{const X=ze=>{const oe=ze.detail,et=typeof oe=="number"?oe:oe.nodeId,Xe=typeof oe=="object"?oe.label:void 0;if(typeof et!="number")return;const Pe=s?.nodes.find(qe=>qe.id===et)?.stableKey??null;if(!Pe)return;g(Pe,!1);const ne=(typeof Pe=="string"?document.querySelector(`[data-stable-key="${Pe}"]`):null)??document.querySelector(`[data-reposition-item="node-${et}"]`);ne&&ne.scrollIntoView({behavior:"smooth",block:"start"}),requestAnimationFrame(()=>y(Pe,Xe))};return window.addEventListener("workflow-scroll-to-node",X),()=>window.removeEventListener("workflow-scroll-to-node",X)},[g,y,s]),b.useEffect(()=>{N&&(_.current&&_.current.scrollTo({top:0,behavior:"auto"}),requestAnimationFrame(()=>{se.current?.focus();const X=Ie.current,ze=Ae.current,oe=se.current?.closest(".node-search-bar");if(!X||!ze||!oe)return;const et=X.getBoundingClientRect(),Xe=oe.getBoundingClientRect(),Qe=ze.getBoundingClientRect(),Pe=Xe.bottom-et.top,ne=Qe.top-et.top,qe=8;ne<Pe+qe&&m({top:Pe+qe})}))},[N,m]),b.useEffect(()=>(p(De),()=>p(!1)),[De,p]),b.useEffect(()=>{if(!F.length)return;const X=window.requestAnimationFrame(()=>{const ze=st();if(!ze)return;const{minTop:oe,maxTop:et}=ze;if(f==null)m({top:et});else{const Xe=Math.min(Math.max(f,oe),et);Xe!==f&&m({top:Xe})}});return()=>window.cancelAnimationFrame(X)},[F.length,f,st,m]),b.useEffect(()=>{if(!De)return;const X=ze=>{const oe=Ae.current;!oe||!ze.target||oe.contains(ze.target)||(E(!1),O(!1),Le(null),Ye())};return document.addEventListener("pointerdown",X),()=>{document.removeEventListener("pointerdown",X)}},[Ye,De]),b.useEffect(()=>{if(!T||B.current===T.id)return;B.current=T.id;const X=window.requestAnimationFrame(()=>{H(T.groupId),D(T.subgraphId),xe(!0),V()});return()=>window.cancelAnimationFrame(X)},[T,V]);const ht=X=>{for(const ze of X)if(ze.type!=="hiddenBlock"){if(ze.type==="node"){const oe=ze.node.stableKey??null;if(!oe||!U[oe])return!0;continue}if(!ze.isCollapsed||ht(ze.children))return!0}return!1},Tt=b.useCallback((X,ze)=>{const oe=et=>{for(const Xe of et){if(Xe.type==="hiddenBlock")continue;if(Xe.type==="node"){const Pe=Xe.node.stableKey??null;Pe&&g(Pe,ze);continue}if(Xe.type==="group"){const Pe=Xe.stableKey;if(!Pe){oe(Xe.children);continue}g(Pe,ze),oe(Xe.children);continue}const Qe=be.get(Xe.subgraph.id)??null;Qe&&g(Qe,ze),oe(Xe.children)}};oe(X)},[g,be]),Et=b.useCallback(X=>_f(X,{layout:ue,hiddenItems:R,stableKeyByPointer:pe}),[R,ue,pe]),Yt=b.useCallback(X=>Et(ue.groups[X]??[]),[Et,ue]),Gt=b.useCallback(X=>Et(ue.subgraphs[X]??[]),[Et,ue]),It=b.useCallback(X=>{for(const ze of X.hiddenGroupKeys){const oe=pe[ze];oe&&z(oe,!1)}for(const ze of X.hiddenSubgraphIds){const oe=be.get(ze)??null;oe&&z(oe,!1)}for(const ze of X.hiddenNodeKeys){const oe=pe[ze];oe&&z(oe,!1)}},[z,pe,be]),dn=(X,ze)=>X.map((oe,et)=>{const Xe=`${ze}-${et}`;if(oe.type==="hiddenBlock")return null;if(oe.type==="group"){const Qe=oe.group,Pe=Ro(Qe.color,.15),ne=Ro(Qe.color,.4),qe=ht(oe.children),Je=oe.children.some(vn=>vn.type!=="hiddenBlock"),at=oe.stableKey;if(!at)return null;const Lt=Yt(at),Zt=at?fe.includes(at):!1,On=fe.length<5||Zt,on=Lt.hiddenNodeCount,Tn=qe?"Fold all":"Unfold all",xn=()=>{!qe&&at&&g(at,!1),Tt(oe.children,qe)};return u.jsxs("div",{className:"group-wrapper shadow-md rounded-xl border mb-3",style:{backgroundColor:Pe,borderColor:ne},"data-reposition-item":`group-${at}`,"data-stable-key":at,children:[u.jsx(zy,{containerType:"group",containerId:Qe.id,title:Qe.title?.trim()||`Group ${Qe.id}`,nodeCount:oe.nodeCount,isCollapsed:oe.isCollapsed,backgroundColor:Ro(Qe.color,.22),borderColor:Ro(Qe.color,.4),hiddenNodeCount:on,isBookmarked:Zt,canShowBookmarkAction:On,foldAllLabel:Tn,onToggleCollapse:()=>at&&g(at,!oe.isCollapsed),onToggleBookmark:()=>at?Re(at):void 0,onShowHiddenNodes:()=>{on>0&&It(Lt)},onToggleFoldAll:xn,onBypassAll:vn=>at&&L(at,vn),onHide:()=>at&&z(at,!0),onAddNode:()=>{H(oe.group.id),D(oe.subgraphId??null),xe(!0)},onDelete:()=>{if(at){if(oe.nodeCount===0){$(at,{deleteNodes:!1});return}Z({stableKey:at,containerTypeLabel:"group",containerIdLabel:`#${oe.group.id}`,displayName:oe.group.title?.trim()||`Group ${oe.group.id}`,nodeCount:oe.nodeCount})}},onMove:()=>q.openOverlay({type:"group",id:oe.group.id,subgraphId:oe.subgraphId??null}),onCommitTitle:vn=>at&&Y(at,vn)}),u.jsx("div",{className:`grid transition-[grid-template-rows] duration-200 ease-out ${oe.isCollapsed?"grid-rows-[0fr]":"grid-rows-[1fr]"}`,children:u.jsxs("div",{className:`overflow-hidden px-1 transition-opacity duration-200 ease-out ${oe.isCollapsed?"opacity-0":"opacity-100"}`,children:[on>0&&oe.nodeCount>0&&u.jsxs("div",{className:"px-3 pb-2 -mt-1 text-xs text-gray-400 text-center",children:[on," hidden node",on===1?"":"s"]}),Je?dn(oe.children,Xe):!we||it.has(oe.group.id)?u.jsx(Hy,{containerType:"group",containerId:oe.group.id,hiddenNodeCount:on,borderColor:Ro(oe.group.color,.3),dashedBorderColor:Ro(oe.group.color,.4),onClick:()=>{H(oe.group.id),D(oe.subgraphId??null),xe(!0)}}):null,u.jsx(By,{id:`group-footer-${oe.group.id}`,headerId:`group-header-${oe.group.id}`,title:oe.group.title,nodeCount:oe.nodeCount,backgroundColor:Ro(oe.group.color,.15),borderColor:Ro(oe.group.color,.3),textClassName:"text-gray-500 dark:text-gray-400",className:"group-footer"})]})})]},`group-${oe.group.id}-${Xe}`)}if(oe.type==="subgraph"){const Qe=kt.brand.subgraphBackground08,Pe=kt.brand.subgraphBorder25,ne=Gt(oe.subgraph.id),qe=ne.hiddenNodeCount,Je=be.get(oe.subgraph.id)??null,at=Je?fe.includes(Je):!1,Lt=fe.length<5||at,Zt=ht(oe.children),On=Zt?"Fold all":"Unfold all",on=()=>{!Zt&&Je&&g(Je,!1),Tt(oe.children,Zt)};return u.jsxs("div",{className:"subgraph-wrapper shadow-md rounded-xl border mb-3",style:{backgroundColor:`var(--subgraph-bg, ${Qe})`,borderColor:`var(--subgraph-border, ${Pe})`,"--subgraph-bg":Qe,"--subgraph-border":Pe},"data-reposition-item":`subgraph-${oe.subgraph.id}`,"data-stable-key":Je??void 0,children:[u.jsx(zy,{containerType:"subgraph",containerId:oe.subgraph.id,title:(oe.subgraph.name||oe.subgraph.id).trim(),nodeCount:oe.nodeCount,isCollapsed:oe.isCollapsed,backgroundColor:kt.brand.subgraphBackground14,borderColor:kt.brand.subgraphBorder25,hiddenNodeCount:qe,isBookmarked:at,canShowBookmarkAction:Lt,foldAllLabel:On,onToggleCollapse:()=>Je&&g(Je,!oe.isCollapsed),onToggleBookmark:()=>Je?Re(Je):void 0,onBypassAll:Tn=>Je&&L(Je,Tn),onToggleFoldAll:on,onShowHiddenNodes:()=>{qe>0&&It(ne)},onHide:()=>Je&&z(Je,!0),onDelete:()=>{if(Je){if(oe.nodeCount===0){$(Je,{deleteNodes:!1});return}Z({stableKey:Je,containerTypeLabel:"subgraph",containerIdLabel:oe.subgraph.id,displayName:oe.subgraph.name?.trim()||oe.subgraph.id,nodeCount:oe.nodeCount})}},onAddNode:()=>{H(null),D(oe.subgraph.id),xe(!0)},onMove:()=>q.openOverlay({type:"subgraph",id:oe.subgraph.id}),onCommitTitle:Tn=>Je&&Y(Je,Tn)}),u.jsx("div",{className:`grid transition-[grid-template-rows] duration-200 ease-out ${oe.isCollapsed?"grid-rows-[0fr]":"grid-rows-[1fr]"}`,children:u.jsxs("div",{className:`overflow-hidden px-1 transition-opacity duration-200 ease-out ${oe.isCollapsed?"opacity-0":"opacity-100"}`,children:[qe>0&&oe.nodeCount>0&&u.jsxs("div",{className:"px-3 pb-2 -mt-1 text-xs text-gray-400 text-center",children:[qe," hidden node",qe===1?"":"s"]}),oe.children.length>0?dn(oe.children,Xe):!we||ot.has(oe.subgraph.id)?u.jsx(Hy,{containerType:"subgraph",containerId:oe.subgraph.id,hiddenNodeCount:qe,borderColor:kt.brand.subgraphBorder20,dashedBorderColor:kt.brand.subgraphBorder25,onClick:()=>{H(null),D(oe.subgraph.id),xe(!0)}}):null,u.jsx(By,{id:`subgraph-footer-${oe.subgraph.id}`,headerId:`subgraph-header-${oe.subgraph.id}`,title:oe.subgraph.name||oe.subgraph.id,nodeCount:oe.nodeCount,backgroundColor:kt.brand.subgraphBackground10,borderColor:kt.brand.subgraphBorder20,textClassName:"text-blue-600 dark:text-blue-500",className:"subgraph-footer"})]})})]},`subgraph-${oe.subgraph.id}-${Xe}`)}return u.jsx("div",{"data-reposition-item":`node-${oe.node.id}`,"data-stable-key":oe.node.stableKey??void 0,children:u.jsx(S4,{node:oe.node,isExecuting:l===String(oe.node.id),isConnectionHighlighted:yt.has(oe.node.id),errorBadgeLabel:Ee[oe.node.id]??null,onImageClick:o,onMoveNode:()=>q.openOverlay({type:"node",id:oe.node.id})})},`node-${oe.node.id}-${Xe}`)});let pn;s?Oe.length===0?pn=u.jsx("div",{id:"node-list-empty",className:"flex items-center justify-center h-full text-gray-500",children:u.jsxs("div",{id:"empty-workflow-content",className:"text-center p-8",children:[u.jsx("div",{id:"empty-workflow-icon-container",className:"flex items-center justify-center mb-4",children:u.jsx(e2,{className:"w-10 h-10 text-gray-300"})}),u.jsx("p",{id:"empty-workflow-title",className:"text-lg font-medium",children:"Empty workflow"}),u.jsx("p",{id:"empty-workflow-description",className:"text-sm mt-2",children:"This workflow has no nodes"}),u.jsx("div",{className:"mt-6 w-64 max-w-full mx-auto",children:u.jsx(N4,{onClick:()=>{H(null),D(null),xe(!0)}})})]})}):pn=u.jsxs("div",{id:"node-list-shell",className:"h-full flex flex-col",children:[N&&u.jsx("div",{className:"node-search-bar bg-gray-100 px-4 py-2",children:u.jsx(ja,{inputRef:se,value:S,onChange:j,onClear:me,placeholder:"Search nodes...",inputClassName:"comfy-input border-gray-300"})}),u.jsx("div",{id:"node-list-container",ref:_,className:"flex-1 overflow-auto px-4 pt-4 overscroll-contain scroll-container",style:{paddingBottom:"10rem"},"data-node-list":"true",children:pt.length===0?u.jsx("div",{className:"flex items-center justify-center h-full text-gray-500",children:u.jsxs("div",{className:"text-center p-8",children:[u.jsx("p",{className:"text-sm font-medium",children:"No matching nodes"}),u.jsx("p",{className:"text-xs mt-2",children:"Try a different search."})]})}):u.jsx("div",{id:"node-list-inner",children:dn(pt,"root")})})]}):pn=u.jsx("div",{id:"node-list-no-workflow",className:"flex items-center justify-center h-full text-gray-500",children:u.jsxs("div",{id:"no-workflow-content",className:"text-center p-8",children:[u.jsx("div",{id:"no-workflow-icon-container",className:"flex items-center justify-center mb-4",children:u.jsx(Zw,{className:"w-10 h-10 text-gray-300"})}),u.jsx("p",{id:"no-workflow-title",className:"text-lg font-medium",children:"No workflow loaded"}),u.jsx("p",{id:"no-workflow-description",className:"text-sm mt-2",children:"Open the menu to load a workflow"})]})});const Wn=te?.y??f??0,Kn=te?`${te.x}px`:c==="left"?"0.75rem":void 0,no=te?void 0:c==="right"?"0.75rem":void 0,oo={top:`${Wn}px`,left:Kn,right:no,opacity:f==null&&te==null?0:1,touchAction:De?"none":"pan-y",pointerEvents:f==null&&te==null?"none":"auto"};return u.jsxs("div",{id:"node-list-wrapper",ref:Ie,className:"absolute inset-x-0 top-[69px] bottom-0 bg-gray-100",style:{display:n?"block":"none"},children:[pn,u.jsx(C4,{isOpen:We,addInGroupId:Se,addInSubgraphId:P,onClose:()=>{xe(!1),H(null),D(null)}}),K&&u.jsx(k4,{containerTypeLabel:K.containerTypeLabel,containerIdLabel:K.containerIdLabel,displayName:K.displayName,nodeCount:K.nodeCount,onCancel:()=>Z(null),onDeleteContainerOnly:()=>{$(K.stableKey,{deleteNodes:!1}),Z(null)},onDeleteContainerAndNodes:()=>{$(K.stableKey,{deleteNodes:!0}),Z(null)}}),q.overlayOpen&&q.initialTarget&&u.jsx(dS,{mobileLayout:ue,initialTarget:q.initialTarget,initialViewportAnchor:q.initialViewportAnchor,onDone:q.commitAndClose,onCancel:q.cancelOverlay}),F.length>0&&u.jsx("div",{ref:Ae,className:`absolute z-[200] flex flex-col items-center gap-2 pointer-events-auto ${De?"rounded-2xl ring-2 ring-blue-400/70 bg-white/30 shadow-lg":""}`,style:oo,onPointerDown:Vt,onPointerMove:ye,onPointerUp:re,onPointerCancel:de,children:u.jsxs("div",{className:`flex flex-col items-center gap-2 ${De?"p-2 cursor-grab":""}`,children:[F.map((X,ze)=>u.jsx("button",{type:"button",className:"w-10 h-10 rounded-full border border-transparent bg-gray-900/10 text-[11px] font-bold text-gray-800 shadow-sm backdrop-blur-sm dark:bg-white/10 dark:text-gray-100 select-none",onClick:Ge(X,ze),children:X.text},X.stableKey)),F.length>1&&u.jsx("button",{type:"button",className:"w-10 h-10 rounded-full border border-transparent bg-gray-900/10 text-gray-600 shadow-sm backdrop-blur-sm flex items-center justify-center dark:bg-white/10 dark:text-gray-200 select-none","aria-label":"Cycle bookmarks",onClick:nt,children:u.jsx(Jn,{className:"w-4 h-4"})})]})})]})}function O4(){const n=eo(O=>O.currentPanel),o=Mo(O=>O.viewerOpen),s=ae(O=>O.workflow),l=ae(O=>O.isExecuting),i=ae(O=>O.progress),c=ae(O=>O.executingNodeId),f=ae(O=>O.executingPromptId),m=ae(O=>O.workflowDurationStats),p=sn(O=>O.error),g=sn(O=>O.nodeErrors),y=sn(O=>O.errorsDismissed),x=sn(O=>O.setErrorsDismissed),w=ae(O=>O.scrollToNode),k=sn(O=>O.errorCycleIndex),N=sn(O=>O.setErrorCycleIndex),S=ae(O=>O.revealNodeWithParents),j=ae(O=>O.nodeTypes),C=Mt(O=>O.running),[T,V]=b.useState(null),z=!(n==="queue")&&!(n==="outputs")&&!o,L=Object.values(g).reduce((O,te)=>O+te.length,0),$=L>0,Y=!!p?.startsWith("Workflow load error")||$,ue=Y?"Workflow load error":"Prompt error",pe=Y&&p?p.replace(/^Workflow load error:\s*/i,""):p??($?`${L} inputs reference missing options.`:null),fe=(!!p||$)&&!y,Re=b.useMemo(()=>{if(!s||!c)return null;const O=s.nodes.find(Le=>String(Le.id)===c);return O?j?.[O.type]?.display_name||O.type:`Node ${c}`},[s,c,j]),Ie=f||(C[0]?.prompt_id??null),Ae=Ma({workflow:s,runKey:Ie,isRunning:l||C.length>0,workflowDurationStats:m}),_=Ae===100?100:i,se=()=>{if(!s||!$)return;const O=s.nodes.filter(H=>g[String(H.id)]?.length);if(O.length===0)return;const te=k%O.length,Le=O[te];if(!Le)return;const We=Le.id,xe=Le.stableKey;if(!xe)return;const Se=`Error #${te+1}`;S(xe),N((te+1)%O.length),window.dispatchEvent(new CustomEvent("workflow-label-error-node",{detail:{nodeId:We,label:Se}})),window.dispatchEvent(new CustomEvent("workflow-scroll-to-node",{detail:{nodeId:We,label:Se}})),w(xe,Se)},ce=O=>{(O.key==="Enter"||O.key===" ")&&(O.preventDefault(),se())},Ue=O=>{O.stopPropagation()},De=O=>{O.stopPropagation(),x(!0)},E=()=>{Ie&&V(Ie)},A=T!==null&&T===Ie;return z?u.jsxs("div",{id:"bottom-status-overlay",className:"fixed inset-x-0 bottom-20 z-[2000] flex flex-col items-center gap-3 pointer-events-none",children:[fe&&u.jsxs("div",{id:"error-notification-wrapper",className:"relative pointer-events-auto",children:[u.jsx("div",{id:"error-notification-toast",className:"bg-red-100 text-red-900 rounded-xl shadow-lg px-4 py-3 w-[70vw] max-w-sm",role:"button",tabIndex:0,onClick:se,onKeyDown:ce,children:u.jsx("div",{className:"error-toast-content flex items-start justify-between gap-3",children:u.jsxs("div",{className:"error-text-container pr-16",children:[u.jsx("div",{className:"error-title text-sm font-semibold text-red-800",children:ue}),u.jsx("div",{className:"error-message mt-1 text-xs text-red-800 break-words",children:pe})]})})}),u.jsx("button",{id:"error-dismiss-button",type:"button","aria-label":"Dismiss error",className:"absolute top-3 right-3 shrink-0 px-3 py-1 text-xs font-semibold bg-red-700 text-white rounded-full z-10",onPointerDown:Ue,onClick:De,children:"Dismiss"})]}),Ae!==null&&!A&&u.jsxs("div",{id:"execution-progress-card",className:"relative bg-white border border-gray-200 rounded-xl shadow-lg px-4 py-2 w-[70vw] max-w-sm pointer-events-auto",children:[u.jsx("button",{type:"button","aria-label":"Dismiss progress",className:"absolute top-2 right-2 w-7 h-7 rounded-full flex items-center justify-center text-gray-400 hover:text-gray-600",onClick:E,children:u.jsx(Na,{className:"w-4 h-4"})}),u.jsx("div",{className:"executing-node-name text-sm font-semibold text-gray-900",children:Re||"Running"}),u.jsxs("div",{className:"node-progress-info mt-2 flex items-center justify-between text-xs text-gray-500",children:[u.jsx("span",{children:"Progress"}),u.jsxs("span",{children:[_,"%"]})]}),u.jsx("div",{className:"node-progress-track mt-1 h-2 rounded-full bg-gray-200 overflow-hidden",children:u.jsx("div",{className:"node-progress-bar h-full bg-green-500 transition-none",style:{width:`${Math.min(100,Math.max(0,_))}%`}})}),Ae!==null&&u.jsxs("div",{className:"overall-progress-container",children:[u.jsxs("div",{className:"overall-progress-info mt-3 flex items-center justify-between text-xs text-gray-500",children:[u.jsx("span",{children:"Overall"}),u.jsxs("span",{children:[Ae,"%"]})]}),u.jsx("div",{className:"overall-progress-track mt-1 h-2 rounded-full bg-gray-200 overflow-hidden",children:u.jsx("div",{className:"overall-progress-bar h-full bg-blue-500 transition-none",style:{width:`${Math.min(100,Math.max(0,Ae))}%`}})})]})]})]}):null}function T4({viewerOpen:n,followQueue:o,queueSize:s,overallProgress:l,onToggleFollowQueue:i,onOpenFollowQueue:c}){const f=b.useCallback(()=>{n?i?.():c?.()},[n,i,c]),m=b.useMemo(()=>n?o?"Disable follow queue":"Enable follow queue":"Open image viewer",[n,o]),p=b.useMemo(()=>n&&o?"bg-green-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200",[n,o]);return u.jsxs("button",{onClick:f,className:`relative w-12 h-12 rounded-xl flex items-center justify-center text-2xl transition-colors ${p}`,"aria-label":m,children:[u.jsx("span",{className:"absolute inset-0 flex items-center justify-center",children:u.jsx(cb,{className:"w-6 h-6",showSlash:n&&!o})}),s>0&&u.jsxs("div",{className:`queue-badge absolute top-0 right-0 translate-x-[18px] -translate-y-[18px] w-6 h-6 rounded-full bg-blue-500 text-white
                     flex items-center justify-center font-bold text-xs border-2 border-white relative z-20`,children:[l!==null&&u.jsx(d2,{className:"absolute z-10 pointer-events-none",width:"24",height:"24",style:{top:"50%",left:"50%",transform:"translate(-50%, -50%) rotate(-90deg)"},progress:l}),s]})]})}function E4(){const n=ae(p=>p.workflow),o=ho(p=>p.pinnedWidget),s=ho(p=>p.pinOverlayOpen),l=ho(p=>p.togglePinOverlay),i=ae(p=>p.updateNodeWidget),c=b.useMemo(()=>{if(!o||!n)return;const p=n.nodes.find(g=>g.id===o.nodeId);if(p)return da(p,o.widgetName,o.widgetIndex)},[o,n]);if(!s||!o)return null;const m=n?.nodes.find(p=>p.id===o.nodeId)?.stableKey??null;return u.jsx("div",{id:"pin-overlay-hidden-anchor",className:"hidden",children:u.jsx(_o,{name:o.widgetName,type:o.widgetType,value:c,options:o.options,onChange:p=>m?i(m,o.widgetIndex,p,o.widgetName):void 0,hideLabel:!0,compact:!0,forceModalOpen:!0,onModalClose:l})})}function I4(){const n=$t(o=>o.setFilterModalOpen);return u.jsx("button",{onClick:()=>n(!0),className:"relative w-12 h-12 rounded-xl flex items-center justify-center text-2xl transition-colors bg-gray-100 text-gray-700 hover:bg-gray-200","aria-label":"Filter and sort",children:u.jsx(Xw,{className:"w-6 h-6"})})}function L4(){const n=$t(l=>l.selectedIds.length),o=$t(l=>l.setSelectionActionOpen),s=n===0;return u.jsx("button",{onClick:()=>o(!0),disabled:s,className:`relative w-12 h-12 rounded-xl flex items-center justify-center text-2xl transition-colors ${s?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,"aria-label":"Selection actions",children:u.jsx("div",{className:`w-6 h-6 rounded-full border-2 flex items-center justify-center shadow-sm ${s?"border-gray-300 bg-transparent":"bg-blue-600 border-blue-600 text-white"}`,children:!s&&u.jsx(Do,{className:"w-4 h-4"})})})}function A4(){return $t(o=>o.selectionMode)?u.jsx(L4,{}):u.jsx(I4,{})}function R4(){const n=ho(l=>l.pinnedWidget),o=ho(l=>l.pinOverlayOpen),s=ho(l=>l.togglePinOverlay);return n?u.jsx("button",{onClick:s,className:`relative w-12 h-12 rounded-xl flex items-center justify-center text-2xl transition-colors ${o?"bg-fuchsia-500 text-white":"bg-gray-100 text-fuchsia-500 hover:bg-gray-200"}`,"aria-label":o?"Close pin editor":"Open pin editor",children:u.jsx(ya,{className:"w-6 h-6"})}):null}function _4(){const n=ae(c=>c.workflow),o=ae(c=>c.runCount),s=ae(c=>c.queueWorkflow),l=n!==null,i=()=>{l&&(s(o),"vibrate"in navigator&&navigator.vibrate(20))};return u.jsx("button",{onClick:i,disabled:!l,className:"flex-1 py-3 px-6 rounded-xl font-semibold text-lg min-h-[48px] transition-all "+(l?"bg-blue-500 text-white active:bg-blue-600":"bg-gray-300 text-gray-500 cursor-not-allowed"),children:"Run"})}function D4(){const n=ae(i=>i.runCount),o=ae(i=>i.setRunCount),s=()=>{o(n-1)},l=()=>{o(n+1)};return u.jsxs("div",{id:"run-count-selector",className:"flex items-center gap-1 bg-gray-100 rounded-lg p-1",children:[u.jsx("button",{onClick:s,disabled:n<=1,className:`w-10 h-10 rounded-lg bg-white shadow-sm flex items-center justify-center
                   text-lg font-medium text-gray-700 disabled:opacity-40 disabled:shadow-none`,children:""}),u.jsx("span",{className:"w-8 text-center font-semibold text-gray-900",children:n}),u.jsx("button",{onClick:l,className:`w-10 h-10 rounded-lg bg-white shadow-sm flex items-center justify-center
                   text-lg font-medium text-gray-700`,children:"+"})]})}function B4(n){const{currentPanel:o,viewerOpen:s=!1,followQueue:l=!1,onToggleFollowQueue:i,onOpenFollowQueue:c}=n,f=o==="outputs",m=ae(C=>C.workflow),p=ae(C=>C.isExecuting),g=ae(C=>C.executingPromptId),y=ae(C=>C.workflowDurationStats),x=Mt(C=>C.pending),w=Mt(C=>C.running),k=b.useRef(null),N=x.length+w.length,S=g||(w[0]?.prompt_id??null),j=Ma({workflow:m,runKey:S,isRunning:p||w.length>0,workflowDurationStats:y});return b.useEffect(()=>{const C=k.current;if(!C)return;const T=()=>{const V=C.getBoundingClientRect();document.documentElement.style.setProperty("--bottom-bar-offset",`${V.height}px`)};return T(),window.addEventListener("resize",T),()=>window.removeEventListener("resize",T)},[]),u.jsxs("div",{id:"bottom-bar-root",ref:k,className:"fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 shadow-lg safe-area-bottom z-[2200]",children:[u.jsxs("div",{id:"bottom-bar-content",className:"flex items-center gap-3 px-3 py-2 max-w-lg mx-auto",children:[u.jsx(D4,{}),u.jsx(_4,{}),f&&u.jsx(A4,{}),!f&&u.jsx(R4,{}),u.jsx(T4,{viewerOpen:s,followQueue:l,queueSize:N,overallProgress:j,onToggleFollowQueue:i,onOpenFollowQueue:c})]}),u.jsx(E4,{}),u.jsx(O4,{})]})}const Ky=n=>Symbol.iterator in n,Uy=n=>"entries"in n,$y=(n,o)=>{const s=n instanceof Map?n:new Map(n.entries()),l=o instanceof Map?o:new Map(o.entries());if(s.size!==l.size)return!1;for(const[i,c]of s)if(!l.has(i)||!Object.is(c,l.get(i)))return!1;return!0},z4=(n,o)=>{const s=n[Symbol.iterator](),l=o[Symbol.iterator]();let i=s.next(),c=l.next();for(;!i.done&&!c.done;){if(!Object.is(i.value,c.value))return!1;i=s.next(),c=l.next()}return!!i.done&&!!c.done};function H4(n,o){return Object.is(n,o)?!0:typeof n!="object"||n===null||typeof o!="object"||o===null||Object.getPrototypeOf(n)!==Object.getPrototypeOf(o)?!1:Ky(n)&&Ky(o)?Uy(n)&&Uy(o)?$y(n,o):z4(n,o):$y({entries:()=>Object.entries(n)},{entries:()=>Object.entries(o)})}function V4(n){const o=tl.useRef(void 0);return s=>{const l=n(s);return H4(o.current,l)?o.current:o.current=l}}function xf(n){return!!n&&typeof n=="object"&&!Array.isArray(n)}function px(n){return Array.isArray(n)&&n.length>=2&&(typeof n[0]=="string"||typeof n[0]=="number")&&typeof n[1]=="number"}function Ku(n){return n.class_type??n.type??null}function Op(n,o){for(const s of o){const l=n.inputs?.[s];if(!px(l)&&l!==void 0)return l}}function ol(n,o){const s=Op(n,o);if(s!=null)return typeof s=="string"?s:String(s)}function vf(n,o){if(!px(o))return null;const s=String(o[0]);return n[s]??null}function K4(n){if(!n)return;const o=ol(n,["sampler_name","sampler","name"]);if(o)return o;if(Ku(n)==="KSamplerSelect"&&Array.isArray(n.widgets_values)){const l=n.widgets_values[0];return l==null?void 0:String(l)}}function U4(n){if(!n)return;const o=ol(n,["scheduler","scheduler_name","name"]);if(o)return o;if(Ku(n)==="BasicScheduler"&&Array.isArray(n.widgets_values)){const l=n.widgets_values[0];return l==null?void 0:String(l)}}function $4(n){if(!n)return;const o=Op(n,["steps","step_count"]);if(o!==void 0)return o;if(Ku(n)==="BasicScheduler"&&Array.isArray(n.widgets_values)){const l=n.widgets_values[1];return l??void 0}}function F4(n){if(!n)return;const o=Op(n,["cfg","guidance","guidance_scale"]);if(o!==void 0)return o;if(Array.isArray(n.widgets_values)){const s=n.widgets_values[0];return s??void 0}}function Tp(n){const o={};if(!xf(n)&&!Array.isArray(n))return o;let s=null;if(Array.isArray(n)&&n.length>=3&&xf(n[2])?s=n[2]:xf(n)&&(s=n),!s)return o;const i=Object.entries(s).sort((c,f)=>Number(c[0])-Number(f[0])).map(([,c])=>c);for(const c of i){const f=Ku(c);if(f){if(f==="CheckpointLoaderSimple"||f==="CheckpointLoader"){const m=c.inputs?.ckpt_name;typeof m=="string"?o.model=m.replace(/\.(safetensors|ckpt|pt)$/i,""):m!=null&&(o.model=String(m).replace(/\.(safetensors|ckpt|pt)$/i,""))}if(f==="KSampler"||f==="KSamplerAdvanced"){if(o.steps===void 0&&c.inputs?.steps!==void 0&&(o.steps=c.inputs.steps),o.cfg===void 0&&c.inputs?.cfg!==void 0&&(o.cfg=c.inputs.cfg),o.sampler===void 0){const m=ol(c,["sampler_name"]);m&&(o.sampler=m)}if(o.scheduler===void 0){const m=ol(c,["scheduler"]);m&&(o.scheduler=m)}}if(f==="SamplerCustom"||f==="SamplerCustomAdvanced"){if(o.steps===void 0&&c.inputs?.steps!==void 0&&(o.steps=c.inputs.steps),o.cfg===void 0&&c.inputs?.cfg!==void 0&&(o.cfg=c.inputs.cfg),o.sampler===void 0){const m=ol(c,["sampler","sampler_name"]),p=vf(s,c.inputs?.sampler),g=m??K4(p);g&&(o.sampler=g)}if(o.scheduler===void 0){const m=ol(c,["scheduler","scheduler_name"]),p=vf(s,c.inputs?.sigmas??c.inputs?.scheduler),g=m??U4(p);g&&(o.scheduler=g)}if(o.steps===void 0){const m=vf(s,c.inputs?.sigmas??c.inputs?.scheduler),p=$4(m);p!==void 0&&(o.steps=p)}}if(f==="FluxGuidance"&&o.cfg===void 0){const m=F4(c);m!==void 0&&(o.cfg=m)}}}return o}function Ep(n,o={}){const{onlyOutput:s=!1,alt:l}=o,i=[];return n.forEach((c,f)=>{const m=c.outputs?.images??[],p=Tp(c.prompt),g=c.durationSeconds,y=c.success!==!1;m.forEach((x,w)=>{if(s&&x.type!=="output")return;const k=typeof l=="function"?l(w,f):l,N=x.subfolder?`${x.subfolder}/${x.filename}`:x.filename,S=Oa(x.filename),j=S==="video"?"video":"image";i.push({src:mo(x.filename,x.subfolder,x.type),alt:k,mediaType:S,metadata:p,durationSeconds:g,success:y,filename:x.filename,file:{id:`${x.type}/${N}`,name:x.filename,type:j,fullUrl:mo(x.filename,x.subfolder,x.type)}})})}),i}function q4({menuState:n,unifiedList:o,onClose:s,onLoadWorkflow:l,onCopyWorkflow:i,onDownload:c,onBatchDownload:f,onDeleteHistory:m,getBatchSources:p}){const g=n?.promptId??"",y=Mt(C=>C.queueItemHideImages[g]),x=Mt(C=>C.toggleQueueItemHideImages),w=()=>{n?.workflow&&n.promptId&&l(n.workflow,n.promptId),s()},k=()=>{i(n?.workflow),s()},N=async()=>{const C=n?.promptId?p(n.promptId,o):[];C.length>1?await f(C):n&&await c(n.imageSrc),s()},S=()=>{x(g),s()},j=()=>{n?.promptId&&m(n.promptId),s()};return n?.open?Mn.createPortal(u.jsx("div",{id:"queue-image-menu",className:"fixed z-[1200] w-44",style:{top:n.top,right:n.right},children:u.jsx(gr,{items:[{key:"load-workflow",label:"Load workflow",icon:u.jsx(bs,{className:"w-4 h-4"}),onClick:w,disabled:!n.workflow},{key:"copy-workflow",label:"Copy workflow",icon:u.jsx(a2,{className:"w-4 h-4"}),onClick:k,disabled:!n.workflow},{key:"download",label:n.promptId&&p(n.promptId,o).length>1?"Download batch":"Download",icon:u.jsx(i2,{className:"w-4 h-4"}),onClick:N},{key:"toggle-images",label:y?"Show images":"Hide images",icon:y?u.jsx(pr,{className:"w-4 h-4"}):u.jsx(Go,{className:"w-4 h-4"}),onClick:S,hidden:!(n.hasVideoOutputs&&n.hasImageOutputs&&n.promptId)},{key:"delete",label:"Delete",icon:u.jsx(Bo,{className:"w-4 h-4"}),onClick:j,color:"danger"}]})}),document.body):null}function W4({message:n}){return n?Mn.createPortal(u.jsx("div",{className:"fixed top-20 left-1/2 -translate-x-1/2 z-[1300] bg-gray-800 text-white px-4 py-2 rounded-lg shadow-lg text-sm font-medium animate-in fade-in slide-in-from-top-2 duration-200",children:n}),document.body):null}function hx(n){return"outputs"in n}function G4(n,o){const s=o.find(i=>i.id===n);return!s||s.status!=="done"?[]:hx(s.data)?(s.data.outputs.images??[]).filter(i=>i.type==="output").map(i=>mo(i.filename,i.subfolder,i.type)):[]}async function mx(n,o="image.png",s){try{const i=await(await fetch(n)).blob(),c=URL.createObjectURL(i),f=document.createElement("a");f.href=c,f.download=o,document.body.appendChild(f),f.click(),f.remove(),URL.revokeObjectURL(c),s?.(n)}catch(l){console.error("Failed to download image:",l)}}async function P4(n,o){for(const s of n)await mx(s,"image.png",o)}async function Y4(n){try{if(navigator.clipboard?.writeText)await navigator.clipboard.writeText(n);else{const o=document.createElement("textarea");o.value=n,o.style.position="fixed",o.style.opacity="0",document.body.appendChild(o),o.select(),document.execCommand("copy"),document.body.removeChild(o)}return!0}catch(o){return console.error("Failed to copy to clipboard:",o),!1}}function Q4({item:n,isActuallyRunning:o,progress:s,overallProgress:l,executingNodeLabel:i,onDelete:c,onStop:f,onImageClick:m,viewerImages:p,runningImages:g,onOpenMenu:y,downloaded:x,isTopDoneItem:w}){const k=Mt(ee=>ee.previewVisibility),N=Mt(ee=>ee.previewVisibilityDefault),S=Mt(ee=>ee.showQueueMetadata),j=Mt(ee=>ee.queueItemExpanded[n.id]),C=Mt(ee=>ee.setQueueItemExpanded),T=Mt(ee=>ee.queueItemHideImages[n.id]),V=b.useRef(new Map),U=b.useRef(new Set),[R,z]=b.useState(new Set),L=n.status==="pending"&&!o,$=n.status==="running"||o,Y=n.status==="done",ue=j!==void 0,pe=ue?j:!1,fe=b.useRef(Y);b.useEffect(()=>{ue||C(n.id,!1)},[ue,n.id,C]),b.useEffect(()=>{!fe.current&&Y&&C(n.id,!0),fe.current=Y},[Y,n.id,C]),b.useEffect(()=>{U.current.clear(),z(new Set)},[n.id]);const Re=()=>{C(n.id,!pe)},Ie=Y&&hx(n.data)?n.data:null,Ae=b.useMemo(()=>Ie?Ie.outputs.images:$?g:[],[Ie,$,g]),_=!!(n.data.prompt_id?k[n.data.prompt_id]??N:N),{savedImages:se,displayImages:ce}=b.useMemo(()=>{const ee=Ae.filter(B=>B.type==="output"),Me=Ae.filter(B=>B.type!=="output"),I=_||ee.length===0&&Me.length>0;return{savedImages:ee,displayImages:I?[...ee,...Me]:ee}},[_,Ae]),Ue=b.useMemo(()=>Ae.some(ee=>el(ee.filename)),[Ae]),De=b.useMemo(()=>Ae.some(ee=>!el(ee.filename)),[Ae]),E=b.useMemo(()=>!T||!Ue?ce:ce.filter(ee=>el(ee.filename)),[ce,Ue,T]),A=se.map(ee=>({src:mo(ee.filename,ee.subfolder,ee.type),alt:"Generation"})),O="aspect-square w-full bg-gray-100 flex flex-col items-center justify-center text-gray-400",te=Ie?.durationSeconds,Le=Ie?Ie.success!==!1:!0,We=X4(te),xe=l===100?100:s,Se=b.useMemo(()=>!S||!n.data.prompt?null:Tp(n.data.prompt),[S,n.data.prompt]),H=b.useMemo(()=>$?E.map(ee=>({src:mo(ee.filename,ee.subfolder,ee.type),alt:"Generation",mediaType:Oa(ee.filename)})):p,[$,p,E]);b.useEffect(()=>{pe&&E.forEach(ee=>{if(!el(ee.filename))return;const Me=mo(ee.filename,ee.subfolder,ee.type);if(U.current.has(Me))return;U.current.add(Me);const I=V.current.get(Me);if(!I)return;I.currentTime=0,z(W=>{const be=new Set(W);return be.delete(Me),be});const B=I.play();B&&typeof B.catch=="function"&&B.catch(()=>{})})},[pe,E]);const P=ee=>{ee.stopPropagation(),Re()},D=ee=>{ee.stopPropagation(),f()},K=ee=>{ee.stopPropagation(),c()},Z=ee=>{ee.stopPropagation();const Me=ee.currentTarget.getBoundingClientRect(),I=Math.max(8,window.innerWidth-Me.right),B=A[0]?.src||"";y({top:Me.bottom+6,right:I,imageSrc:B,workflow:Ie?.workflow,promptId:n.data.prompt_id||n.id,hasVideoOutputs:Ue,hasImageOutputs:De})},q=ee=>()=>{z(Me=>new Set(Me).add(ee))},Ee=ee=>()=>{z(Me=>{const I=new Set(Me);return I.delete(ee),I})},je=(ee,Me,I)=>()=>{const B=H.findIndex(W=>W.src===ee);m?.(H,B>=0?B:Me,I)},Ne=ee=>Me=>{Me.stopPropagation();const I=V.current.get(ee);if(!I)return;I.currentTime=0;const B=I.play();B&&typeof B.catch=="function"&&B.catch(()=>{})};return u.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden transition-all duration-300",children:[u.jsxs("div",{onClick:Re,className:`px-3 py-2 border-b flex justify-between items-center cursor-pointer select-none ${$?"bg-blue-50 border-blue-100":"bg-gray-50 border-gray-100"}`,children:[u.jsxs("div",{className:"flex items-center gap-1 min-w-0",children:[u.jsx("button",{onClick:P,className:"w-8 h-8 -ml-2 flex items-center justify-center text-gray-400 hover:text-gray-600 shrink-0",children:pe?u.jsx(Jn,{className:"w-6 h-6"}):u.jsx(gs,{className:"w-6 h-6"})}),$&&u.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"}),L&&u.jsx("span",{className:"text-xs font-bold text-gray-400",children:"PENDING"}),$&&u.jsx("span",{className:"text-xs font-bold text-blue-600",children:"GENERATING"}),Y&&u.jsx("span",{className:"text-xs font-bold text-gray-500",children:new Date(n.timestamp||0).toLocaleTimeString()}),$&&!pe&&o&&l!=null&&u.jsxs("span",{className:"ml-1 text-xs font-semibold text-blue-600",children:[Math.min(100,Math.max(0,l)),"%"]})]}),u.jsx("div",{className:"flex items-center gap-2",children:$?u.jsx("button",{onClick:D,className:"px-2 py-1 text-xs font-semibold text-white bg-red-600 rounded hover:bg-red-700",children:"Stop"}):Y?u.jsx(Pr,{onClick:Z,ariaLabel:"Image options",buttonSize:7,iconSize:4}):u.jsx("button",{onClick:K,className:"text-gray-400 hover:text-red-500 px-2",title:L?"Remove from Queue":"Delete from History","aria-label":L?"Remove from Queue":"Delete from History",children:u.jsx(Na,{className:"w-4 h-4"})})})]}),pe&&u.jsx("div",{className:"relative w-full animate-in fade-in duration-200",children:E.length>0?u.jsx("div",{className:"flex flex-col",children:(()=>{let ee=0,Me=0;return E.map((I,B)=>{const W=I.type!=="output",be=W?++Me:++ee,me=`${W?"Preview":"Save"} #${be}`,ke=mo(I.filename,I.subfolder,I.type),F=x[ke],ie=E.length>1;return u.jsxs("div",{className:"relative",children:[We&&u.jsxs("div",{className:`absolute top-2 left-2 flex items-center gap-1 px-2 py-1 rounded text-xs font-semibold ${Le?"bg-green-600/90 text-white":"bg-red-600/90 text-white"}`,children:[Le?u.jsx(Do,{className:"w-3.5 h-3.5"}):u.jsx(o2,{className:"w-3.5 h-3.5"}),u.jsx("span",{children:We})]}),el(I.filename)?u.jsxs(u.Fragment,{children:[u.jsx("video",{src:ke,className:"w-full h-auto block",muted:!0,playsInline:!0,preload:"metadata",ref:_e=>{_e?V.current.set(ke,_e):V.current.delete(ke)},onEnded:q(ke),onPlay:Ee(ke),onClick:je(ke,B,w)}),R.has(ke)&&u.jsx("button",{type:"button",className:"absolute inset-0 flex items-center justify-center bg-black/35 text-white",onClick:Ne(ke),"aria-label":"Replay video",children:u.jsx("span",{className:"flex h-12 w-12 items-center justify-center rounded-full bg-black/60 text-2xl",children:""})})]}):u.jsx("img",{src:ke,alt:"Generation",className:"w-full h-auto block",loading:"lazy",onClick:je(ke,B,w)}),F&&u.jsx("div",{className:"absolute bottom-2 right-2 w-7 h-7 rounded-full bg-black/60 text-white flex items-center justify-center",children:u.jsx(r2,{className:"w-4 h-4"})}),ie&&u.jsx("div",{className:"absolute bottom-2 left-2 px-2 py-1 bg-black/60 text-white text-xs font-medium rounded backdrop-blur-sm shadow-sm pointer-events-none",children:me}),Se&&u.jsxs("div",{className:`absolute right-2 flex flex-col-reverse items-end gap-1 pointer-events-none ${F?"bottom-10":"bottom-2"}`,children:[Se.model&&u.jsxs("div",{className:"px-1.5 py-0.5 bg-black/50 text-white text-[10px] rounded backdrop-blur-sm",children:["model: ",Se.model]}),Se.sampler&&u.jsxs("div",{className:"px-1.5 py-0.5 bg-black/50 text-white text-[10px] rounded backdrop-blur-sm",children:["sampler: ",Se.sampler]}),Se.steps&&u.jsxs("div",{className:"px-1.5 py-0.5 bg-black/50 text-white text-[10px] rounded backdrop-blur-sm",children:["steps: ",Se.steps]}),Se.cfg&&u.jsxs("div",{className:"px-1.5 py-0.5 bg-black/50 text-white text-[10px] rounded backdrop-blur-sm",children:["cfg: ",Se.cfg]})]})]},B)})})()}):Y?u.jsx("div",{className:O,children:u.jsx("span",{className:"text-sm",children:"No images saved"})}):$?u.jsx("div",{className:O,style:{minHeight:"300px"},children:o&&l!=null?u.jsxs("div",{className:"w-full max-w-xs px-4",children:[u.jsxs("p",{className:"font-semibold text-base text-gray-900 mb-3",children:["Executing: ",i||"Running"]}),u.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 mb-1",children:[u.jsx("span",{children:"Progress"}),u.jsxs("span",{children:[xe,"%"]})]}),u.jsx("div",{className:"h-2 rounded-full bg-gray-200 overflow-hidden",children:u.jsx("div",{className:"h-full bg-green-500 transition-none",style:{width:`${Math.min(100,Math.max(0,xe))}%`}})}),u.jsxs("div",{className:"mt-3 flex items-center justify-between text-xs text-gray-500 mb-1",children:[u.jsx("span",{children:"Overall"}),u.jsxs("span",{children:[l,"%"]})]}),u.jsx("div",{className:"h-2 rounded-full bg-gray-200 overflow-hidden",children:u.jsx("div",{className:"h-full bg-blue-500 transition-none",style:{width:`${Math.min(100,Math.max(0,l))}%`}})})]}):u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"w-12 h-12 border-4 border-blue-200 border-t-blue-500 rounded-full animate-spin mb-4"}),u.jsx("p",{className:"font-medium text-lg text-blue-600",children:"Generating..."})]})}):u.jsxs("div",{className:O,style:{minHeight:"100px"},children:[u.jsx(N2,{className:"w-8 h-8 text-gray-300"}),u.jsx("span",{className:"text-xs mt-2 opacity-40",children:"Waiting to start..."})]})})]})}function X4(n){const o=n===void 0||Number.isNaN(n)?0:n;return o<10?`${o.toFixed(1)}s`:`${Math.round(o)}s`}function Z4({listRef:n,unifiedList:o,visibleCount:s,hasLoadedOnce:l,effectiveExecutingId:i,progress:c,overallProgress:f,executingNodeLabel:m,onDeleteItem:p,onStop:g,onImageClick:y,viewerImages:x,promptOutputs:w,onOpenMenu:k,downloaded:N,firstDoneItemId:S,onScroll:j}){return u.jsxs("div",{ref:n,className:"flex-1 overflow-y-auto p-4 space-y-4 overscroll-contain scroll-container","data-queue-list":"true",onScroll:j,children:[o.length===0&&!l&&u.jsx("div",{className:"flex items-center justify-center min-h-[calc(100vh-180px)] text-gray-400",children:u.jsxs("div",{className:"text-center",children:[u.jsx(hp,{size:"lg",color:"gray",className:"mx-auto mb-4"}),u.jsx("p",{className:"text-lg",children:"Loading..."})]})}),o.length===0&&l&&u.jsx("div",{className:"flex items-center justify-center min-h-[calc(100vh-180px)] text-gray-500",children:u.jsxs("div",{className:"text-center p-8",children:[u.jsx("div",{className:"flex items-center justify-center mb-4",children:u.jsx(t2,{className:"w-10 h-10 text-gray-300"})}),u.jsx("p",{className:"text-lg font-medium",children:"Queue is empty"}),u.jsx("p",{className:"text-sm mt-2",children:"Run a workflow to see items here"})]})}),o.slice(0,s).map(C=>u.jsx(Q4,{item:C,isActuallyRunning:C.id===i,progress:c,overallProgress:f,executingNodeLabel:m,onDelete:()=>p(C),onStop:g,onImageClick:y,viewerImages:x,runningImages:w[C.id]??[],onOpenMenu:k,downloaded:N,isTopDoneItem:C.id===S},C.id)),u.jsx("div",{className:"h-20"})]})}function J4(n,o,s){b.useEffect(()=>{if(!n)return;const l=()=>o(),i=c=>{const f=c.target,m=document.getElementById(s);m&&f&&m.contains(f)||o()};return document.addEventListener("scroll",l,!0),document.addEventListener("mousedown",i),()=>{document.removeEventListener("scroll",l,!0),document.removeEventListener("mousedown",i)}},[n,o,s])}function ek({visible:n,onImageClick:o}){const s=Mt(K=>K.running),l=Mt(K=>K.pending),i=Mt(K=>K.fetchQueue),c=Mt(K=>K.deleteItem),f=Mt(K=>K.interrupt),m=ae(K=>K.loadWorkflow),p=eo(K=>K.setCurrentPanel),g=ae(K=>K.workflow),y=ae(K=>K.nodeTypes),x=ae(K=>K.executingNodeId),w=ae(K=>K.workflowDurationStats),k=ae(K=>K.promptOutputs),N=qn(K=>K.history),S=qn(K=>K.fetchHistory),j=qn(K=>K.deleteItem),{isExecuting:C,progress:T,executingPromptId:V}=ae(V4(K=>({isExecuting:K.isExecuting,progress:K.progress,executingPromptId:K.executingPromptId}))),U=V||(s.length===1?s[0].prompt_id:null),R=b.useMemo(()=>{if(!g||!x)return null;const K=g.nodes.find(q=>String(q.id)===x);return K?y?.[K.type]?.display_name||K.type:`Node ${x}`},[g,x,y]),z=Ma({workflow:g,runKey:V||U,isRunning:C||!!U,workflowDurationStats:w}),[L,$]=b.useState(null),[Y,ue]=b.useState({}),[pe,fe]=b.useState(null),[Re,Ie]=b.useState(!1),[Ae,_]=b.useState(0),se=b.useRef(null),ce=b.useRef(0),Ue=b.useRef(!1),De=b.useRef(!1);b.useEffect(()=>{n&&(Ue.current||De.current&&se.current&&(se.current.scrollTop=0),Promise.all([i(),S()]).then(()=>{Ie(!0)})),Ue.current=n,De.current||(De.current=!0)},[n,i,S]),b.useEffect(()=>{!C&&n&&S()},[C,n,S]),J4(!!L?.open,()=>$(null),"queue-image-menu");const E=async K=>{if(!K)return;const Z=JSON.stringify(K,null,2),q=await Y4(Z);fe(q?"Copied to clipboard":"Failed to copy"),setTimeout(()=>fe(null),2e3)},A=async K=>{await mx(K,"image.png",Z=>{ue(q=>({...q,[Z]:!0}))})},O=b.useMemo(()=>{const K={};N.forEach(q=>{K[q.prompt_id]={id:q.prompt_id,status:"done",data:q,timestamp:q.timestamp}}),s.forEach(q=>{K[q.prompt_id]||(K[q.prompt_id]={id:q.prompt_id,status:"running",data:q})}),l.forEach(q=>{K[q.prompt_id]||(K[q.prompt_id]={id:q.prompt_id,status:"pending",data:q})}),V&&K[V]&&(K[V].status="running");const Z=Object.values(K);return Z.sort((q,Ee)=>{const je={pending:0,running:1,done:2};if(je[q.status]!==je[Ee.status])return je[q.status]-je[Ee.status];if(q.status==="pending"){const Ne=q.data.number;return Ee.data.number-Ne}return q.status==="done"?(Ee.timestamp||0)-(q.timestamp||0):0}),Z},[l,s,N,V]),te=b.useMemo(()=>{if(O.length===0)return 0;const K=O.filter(je=>je.status==="pending").length,Z=O.filter(je=>je.status==="running").length,Ee=O.filter(je=>je.status==="done").length>0?1:0;return Math.min(O.length,K+Z+Ee)},[O]),Le=b.useMemo(()=>{const K=O.filter(Z=>Z.status==="done").map(Z=>Z.data);return Ep(K,{onlyOutput:!0,alt:"Generation"})},[O]),We=b.useMemo(()=>O.find(Z=>Z.status==="done")?.id??null,[O]);b.useEffect(()=>{n&&(ce.current=O.length,queueMicrotask(()=>{_(K=>Math.max(K,te))}))},[n,O.length,te]),b.useEffect(()=>{if(!n)return;const K=se.current;K&&(Ae>=O.length||K.scrollHeight<=K.clientHeight+20&&queueMicrotask(()=>{_(Z=>Math.min(O.length,Z+10))}))},[n,Ae,O.length]);const xe=K=>{K.status==="pending"&&c(K.id),K.status==="done"&&j(K.id)},Se=K=>{const{top:Z,right:q,imageSrc:Ee,workflow:je,promptId:Ne,hasVideoOutputs:ee,hasImageOutputs:Me}=K;$({open:!0,top:Z,right:q,imageSrc:Ee,workflow:je,promptId:Ne,hasVideoOutputs:ee,hasImageOutputs:Me})},H=()=>{const K=se.current;if(!K)return;K.scrollHeight-K.scrollTop-K.clientHeight<400&&_(q=>Math.min(ce.current,q+10))},P=(K,Z)=>{m(K,`history-${Z}.json`,{source:{type:"history",promptId:Z}}),p("workflow")},D=async K=>{await P4(K,Z=>{ue(q=>({...q,[Z]:!0}))})};return u.jsx("div",{id:"queue-panel-wrapper",className:"absolute inset-x-0 top-[69px] bottom-0",style:{display:n?"block":"none"},children:u.jsxs("div",{className:"flex flex-col bg-gray-100 min-h-full",children:[u.jsx(Z4,{listRef:se,unifiedList:O,visibleCount:Ae,hasLoadedOnce:Re,effectiveExecutingId:U,progress:T,overallProgress:z,executingNodeLabel:R,onDeleteItem:xe,onStop:f,onImageClick:o,viewerImages:Le,promptOutputs:k,onOpenMenu:Se,downloaded:Y,firstDoneItemId:We,onScroll:H}),u.jsx(q4,{menuState:L,unifiedList:O,onClose:()=>$(null),onLoadWorkflow:P,onCopyWorkflow:E,onDownload:K=>A(K),onBatchDownload:D,onDeleteHistory:K=>j(K),getBatchSources:G4}),u.jsx(W4,{message:pe})]})})}let wf=null,hu=[];function Fy(n){return encodeURIComponent(n)}async function tk(){if(hu.length===0)return;const n=[...hu];hu=[];const o=n.map(s=>{const l=new Date(s.timestamp).toISOString(),i=s.data!==void 0?` | ${JSON.stringify(s.data)}`:"";return`${l} ${s.message}${i}`}).join(`
`)+`
`;try{let s="";try{const i=await fetch(`${nn}/api/userdata/${Fy("mobile-debug.log")}`);i.ok&&(s=await i.text())}catch{}const l=s+o;await fetch(`${nn}/api/userdata/${Fy("mobile-debug.log")}?overwrite=true`,{method:"POST",headers:{"Content-Type":"text/plain"},body:l})}catch(s){console.error("[debugLog] Failed to write to server:",s)}}function nk(){wf||(wf=setTimeout(()=>{wf=null,tk()},500))}function Yf(n,o){const s={timestamp:Date.now(),message:n,data:o};hu.push(s),o!==void 0?console.log(`[DEBUG] ${n}`,o):console.log(`[DEBUG] ${n}`),nk()}function ok(n,o,s){const l=n.closest("[data-textarea-root]")?.querySelector("[data-textarea-header]"),i=getComputedStyle(document.documentElement),c=parseFloat(i.getPropertyValue("--top-bar-offset"))||0,f=window.visualViewport?.offsetTop??0,m=window.visualViewport?.height??window.innerHeight,p=c+8,g=gx(n),y=l?.getBoundingClientRect(),x=g===window?{type:"window",scrollY:window.scrollY}:(()=>{const z=g;return{type:"element",tag:z.tagName.toLowerCase(),scrollTop:z.scrollTop,height:z.clientHeight}})();Yf("textarea-scroll: start",{reason:s,behavior:o,headerTop:y?.top??null,layoutTopEdge:p,viewportTopEdge:f+c+8,viewportTop:f,viewportHeight:m,topBarOffset:c,container:x,selectionStart:n.selectionStart});const w=sk(n),k=f+c+m*.25,N=f+m-24,S=y?y.top-p:null,j=w-k,C=w>N?w-N:0;let T=0;const V=S!==null&&S>2,U=V?w-S:w,R=U<=N;V&&R?T=S??0:!V&&w<=N?T=0:(T=j,C>T&&(T=C)),T<0&&(T=0),y&&S!==null&&y.top>p+2&&T>S&&(T=S),Yf("textarea-scroll: align",{caretTop:w,targetTop:k,visibilityBottom:N,deltaHeader:S,deltaCaret:j,deltaCaretMin:C,caretAfterHeader:U,caretVisibleAfterHeader:R,canAlignHeader:V,delta:T}),Math.abs(T)>8&&yx(g,T,o)}function rk(n){const o=n.closest("[data-textarea-root]")?.querySelector("[data-textarea-header]");if(!o)return;const s=getComputedStyle(document.documentElement),i=(parseFloat(s.getPropertyValue("--top-bar-offset"))||0)+8,c=o.getBoundingClientRect(),f=c.top-i;if(Math.abs(f)<2)return;const m=gx(n);Yf("textarea-scroll: align-header-request",{headerTop:c.top,layoutTopEdge:i,delta:f}),yx(m,f,"auto")}function sk(n){const o=n.getBoundingClientRect(),s=lk(n);return o.top+s-n.scrollTop}function lk(n){const o=n.selectionStart??0,s=n.value,l=document.createElement("div"),i=getComputedStyle(n),c=l.style;c.position="absolute",c.top="0",c.left="-9999px",c.visibility="hidden",c.whiteSpace="pre-wrap",c.wordWrap="break-word",c.overflowWrap="break-word",c.boxSizing=i.boxSizing,c.width=`${n.clientWidth}px`,c.padding=i.padding,c.border=i.border,c.fontFamily=i.fontFamily,c.fontSize=i.fontSize,c.fontWeight=i.fontWeight,c.fontStyle=i.fontStyle,c.letterSpacing=i.letterSpacing,c.lineHeight=i.lineHeight,c.textTransform=i.textTransform,c.textIndent=i.textIndent,c.tabSize=i.tabSize;const f=document.createTextNode(s.slice(0,o)),m=document.createElement("span");m.textContent=s.slice(o,o+1)||" ",m.style.display="inline-block",m.style.width="1px",l.appendChild(f),l.appendChild(m),document.body.appendChild(l);const p=l.getBoundingClientRect(),y=m.getBoundingClientRect().top-p.top;return document.body.removeChild(l),y}function Sf(n){n?document.body.dataset.textareaFocus="true":delete document.body.dataset.textareaFocus}function gx(n){let o=n?.parentElement??null;for(;o;){const l=getComputedStyle(o).overflowY;if((l==="auto"||l==="scroll")&&o.scrollHeight>o.clientHeight)return o;o=o.parentElement}return window}function yx(n,o,s="smooth"){if(Math.abs(o)<1)return;if(n===window){window.scrollBy({top:o,behavior:s});return}const l=n;l.scrollTo({top:l.scrollTop+o,behavior:s})}function bx(){const[n,o]=b.useState(!1),s=b.useRef(null),l=b.useRef(null),i=b.useRef(null);return b.useEffect(()=>{const c=m=>{const p=m.target;if(!(p instanceof HTMLElement))return;const g=p.tagName.toLowerCase();if((p.isContentEditable||g==="input"||g==="textarea"||g==="select")&&o(!0),p instanceof HTMLTextAreaElement){Sf(!0);const y=()=>ok(p,"smooth","focus");s.current&&clearTimeout(s.current),l.current&&window.visualViewport&&(window.visualViewport.removeEventListener("resize",l.current),l.current=null),i.current&&(document.removeEventListener("selectionchange",i.current),i.current=null);const x=()=>{document.activeElement===p&&(y(),i.current&&(document.removeEventListener("selectionchange",i.current),i.current=null))};if(i.current=x,document.addEventListener("selectionchange",x),setTimeout(()=>{i.current&&(document.removeEventListener("selectionchange",i.current),i.current=null)},1200),window.visualViewport){let w=!1;const k=()=>{w=!0,y(),l.current&&(window.visualViewport?.removeEventListener("resize",l.current),l.current=null)};l.current=k,window.visualViewport.addEventListener("resize",k),s.current=setTimeout(()=>{w||y(),setTimeout(y,300),l.current&&(window.visualViewport?.removeEventListener("resize",l.current),l.current=null)},600)}else requestAnimationFrame(y)}},f=()=>{const m=document.activeElement;if(!(m instanceof HTMLElement)){o(!1),Sf(!1),i.current&&(document.removeEventListener("selectionchange",i.current),i.current=null);return}const p=m.tagName.toLowerCase(),g=m.isContentEditable||p==="input"||p==="textarea"||p==="select";o(g),Sf(m instanceof HTMLTextAreaElement)};return document.addEventListener("focusin",c),document.addEventListener("focusout",f),()=>{document.removeEventListener("focusin",c),document.removeEventListener("focusout",f),s.current&&clearTimeout(s.current),l.current&&window.visualViewport&&(window.visualViewport.removeEventListener("resize",l.current),l.current=null),i.current&&(document.removeEventListener("selectionchange",i.current),i.current=null)}},[]),b.useEffect(()=>{const c=f=>{const p=f.detail?.textarea;p&&rk(p)};return document.addEventListener("textarea-align-header",c),()=>{document.removeEventListener("textarea-align-header",c)}},[]),{isInputFocused:n}}function ak({index:n,total:o,displayName:s}){return u.jsx("div",{id:"media-viewer-header",className:"absolute top-0 inset-x-0 px-3 pt-3 pb-4 bg-gradient-to-b from-black/50 to-transparent",children:u.jsxs("div",{className:"grid grid-cols-3 items-center",children:[u.jsxs("div",{className:"flex items-center gap-3 text-white text-sm",children:[n+1," / ",o]}),u.jsx("div",{className:"justify-self-center text-white/90 text-sm font-medium max-w-[70vw] truncate",children:s}),u.jsx("div",{})]})})}function ik({onClick:n}){return u.jsx("button",{type:"button",onClick:n,"aria-label":"Delete output",className:"pointer-events-auto w-9 h-9 rounded-full bg-black/40 text-red-500 flex items-center justify-center hover:bg-black/60 transition-colors",children:u.jsx(Bo,{className:"w-5 h-5"})})}function uk({onClick:n}){return u.jsx("button",{type:"button",onClick:n,"aria-label":"Load workflow",className:"pointer-events-auto w-9 h-9 rounded-full bg-black/40 text-white flex items-center justify-center hover:bg-black/60 transition-colors",children:u.jsx(bs,{className:"w-5 h-5"})})}function ck({onClick:n}){return u.jsx("button",{type:"button",onClick:n,"aria-label":"Use in workflow",className:"pointer-events-auto w-9 h-9 rounded-full bg-black/40 text-white flex items-center justify-center hover:bg-black/60 transition-colors",children:u.jsx(ub,{className:"w-5 h-5"})})}function dk({onClick:n,disabled:o}){return u.jsx("button",{type:"button",onClick:n,"aria-label":"Toggle metadata",className:`pointer-events-auto w-9 h-9 rounded-full bg-black/40 text-white flex items-center justify-center hover:bg-black/60 transition-colors ${o?"opacity-40":""}`,disabled:o,children:u.jsx(ib,{className:"w-5 h-5"})})}function fk({isVideo:n,showMetadataToggle:o,canToggleMetadata:s,onDelete:l,onLoadWorkflow:i,onUseInWorkflow:c,onToggleMetadata:f}){return u.jsxs("div",{className:"absolute inset-x-0 px-3 pb-2 pt-2 flex items-center justify-between",style:{bottom:"calc(var(--bottom-bar-offset, 0px) + 4px)"},children:[u.jsx(ik,{onClick:l}),!n&&u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(uk,{onClick:i}),u.jsx(ck,{onClick:c}),o&&u.jsx(dk,{onClick:f,disabled:!s})]})]})}function pk({isVideo:n,showMetadataToggle:o,showMetadataOverlay:s,metadataIsLoading:l,metadata:i,durationLabel:c}){return o?u.jsx("div",{className:`absolute right-3 flex flex-col items-end gap-1 pointer-events-none transition-opacity duration-300 ${s?"opacity-100":"opacity-0"}`,style:{bottom:n?"calc(var(--bottom-bar-offset, 0px) + 120px)":"calc(var(--bottom-bar-offset, 0px) + 64px)"},children:l?u.jsx("div",{className:"px-1.5 py-0.5 bg-black/50 text-white text-[10px] rounded backdrop-blur-sm",children:"Loading metadata..."}):i?u.jsxs(u.Fragment,{children:[i.model&&u.jsxs("div",{className:"px-1.5 py-0.5 bg-black/50 text-white text-[10px] rounded backdrop-blur-sm",children:["model: ",i.model]}),i.sampler&&u.jsxs("div",{className:"px-1.5 py-0.5 bg-black/50 text-white text-[10px] rounded backdrop-blur-sm",children:["sampler: ",i.sampler]}),i.steps&&u.jsxs("div",{className:"px-1.5 py-0.5 bg-black/50 text-white text-[10px] rounded backdrop-blur-sm",children:["steps: ",i.steps]}),i.cfg&&u.jsxs("div",{className:"px-1.5 py-0.5 bg-black/50 text-white text-[10px] rounded backdrop-blur-sm",children:["cfg: ",i.cfg]}),c&&u.jsxs("div",{className:"px-1.5 py-0.5 bg-black/50 text-white text-[10px] rounded backdrop-blur-sm",children:["time: ",c]})]}):u.jsx("div",{className:"px-1.5 py-0.5 bg-black/50 text-white text-[10px] rounded backdrop-blur-sm",children:"No metadata found"})}):null}const hk={x:0,y:0},Qf=2100,Nf=Qf+10;function xx({open:n,items:o,index:s,onIndexChange:l,onClose:i,onDelete:c,onLoadWorkflow:f,onLoadInWorkflow:m,showMetadataToggle:p=!1,showLoadingPlaceholder:g=!1,loadingProgress:y=0,loadingLabel:x,initialScale:w=1,initialTranslate:k=hk,onTransformChange:N,zoomResetKey:S}){const j=b.useRef(null),C=b.useRef(null),T=b.useRef(null),V=b.useRef(null),[U,R]=b.useState(1),[z,L]=b.useState({x:0,y:0}),$=b.useRef(1),Y=b.useRef({x:0,y:0}),ue=b.useRef(null),pe=b.useRef(null),fe=b.useRef(null),Re=b.useRef(null),[Ie,Ae]=b.useState(null),[_,se]=b.useState(null),[ce,Ue]=b.useState(!1),[De,E]=b.useState(!1),A=b.useRef(null),O=b.useRef("fit"),[te,Le]=b.useState({}),[We,xe]=b.useState({}),[Se,H]=b.useState(!1),{isInputFocused:P}=bx(),D=s>=0?o[s]??o[0]??null:null,K=D?.filename??D?.file?.name??D?.alt??D?.src??"",Z=!!(D?.mediaType==="video"||D?.file?.type==="video"||K&&el(K)),q=D?.file?.id??null,Ee=q?te[q]:void 0,je=D?.metadata??(Ee===void 0?void 0:Ee),Ne=mk(D?.durationSeconds),ee=D?.filename||D?.alt||"Output",Me=De&&!ce,I=p,B=q?!!We[q]:!1,W=b.useCallback(()=>{Ue(!1),A.current&&clearTimeout(A.current),A.current=setTimeout(()=>{Ue(!0)},3e3)},[]),be=b.useCallback(()=>{W(),E(Q=>!Q)},[W]),me=b.useCallback(()=>{D&&(W(),c(D))},[D,c,W]),ke=b.useCallback(()=>{D&&(W(),f(D))},[D,f,W]),F=b.useCallback(()=>{D&&(W(),m(D))},[D,m,W]);b.useEffect(()=>(n?queueMicrotask(W):A.current&&clearTimeout(A.current),()=>{A.current&&clearTimeout(A.current)}),[n,W]),b.useLayoutEffect(()=>{n&&(R(w),L(k),$.current=w,Y.current=k,ue.current=null,pe.current=null,fe.current=null,Re.current=null,O.current="fit")},[n,s,w,k]),b.useEffect(()=>{V.current=null,Ae(null),H(!1)},[D?.src]),b.useEffect(()=>{if(n)return document.body.style.overflow="hidden",()=>{document.body.style.overflow=""}},[n]),b.useEffect(()=>{n&&N&&N(U,z)},[n,U,z,N]),b.useEffect(()=>{if(!n)return;const Q=re=>{re.key==="Escape"&&i()};return document.addEventListener("keydown",Q),()=>document.removeEventListener("keydown",Q)},[n,i]),b.useEffect(()=>{if(!n||!p||!D?.file||D.metadata||!q||je!==void 0||B)return;const Q=q.startsWith("input/")?"input":"output",re=q.startsWith(`${Q}/`)?q.slice(Q.length+1):q;xe(de=>({...de,[q]:!0})),tw(re,Q).then(de=>{const Oe=de?.prompt?Tp(de.prompt):null,Ke=Oe&&Object.keys(Oe).length>0?Oe:null;Le(we=>({...we,[q]:Ke}))}).catch(()=>{Le(de=>({...de,[q]:null}))}).finally(()=>{xe(de=>({...de,[q]:!1}))})},[n,p,D,q,je,B]);const ie=b.useMemo(()=>!Ie||!_?null:_.height/Ie.height,[Ie,_]),_e=b.useMemo(()=>ie===null?1:Math.min(1,ie),[ie]),$e=b.useMemo(()=>ie===null?1:Math.max(1,ie),[ie]),Ze=(Q=U,re=Ie)=>{if(!re||!_)return{x:0,y:0};const de=re.width*Q,Oe=re.height*Q;return{x:de<_.width?(_.width-de)/2:0,y:Oe<_.height?(_.height-Oe)/2:0}},Ge=b.useCallback((Q,re=U)=>{if(!Ie||!_)return Q;const de=_.width,Oe=_.height,Ke=Ie.width*re,we=Ie.height*re,it=Ke<=de?0:Math.max(de-Ke,Math.min(0,Q.x)),ot=we<=Oe?0:Math.max(Oe-we,Math.min(0,Q.y));return{x:it,y:ot}},[Ie,_,U]),nt=b.useRef(Ge),Ye=b.useCallback(Q=>{let re=_e;if(Q==="cover"?re=$e:re=_e,O.current=Q,$.current=re,R(re),!Ie||!_)Y.current={x:0,y:0},L({x:0,y:0});else{const de=Ie.width*re,Oe=Ie.height*re,Ke={x:(_.width-de)/2,y:(_.height-Oe)/2},we=Ge(Ke,re);Y.current=we,L(we)}},[Ie,Ge,_,$e,_e]),Fe=b.useRef(Ye);b.useEffect(()=>{nt.current=Ge},[Ge]),b.useEffect(()=>{Fe.current=Ye},[Ye]);const st=Q=>{const re=Q.currentTarget;V.current={width:re.naturalWidth,height:re.naturalHeight};const de=j.current;if(!de||re.naturalWidth===0)return;const Oe=de.clientWidth,Ke=de.clientHeight,we=Oe/re.naturalWidth;Ae({width:Oe,height:re.naturalHeight*we}),se({width:Oe,height:Ke})};b.useEffect(()=>{if(Z||!n)return;const Q=C.current,re=j.current;if(!Q||!re)return;const de=()=>{const Ke=V.current,we=re.clientWidth,it=re.clientHeight;if(se({width:we,height:it}),!Ke||Ke.width===0)return;const ot=we/Ke.width,tt=Ke.height*ot;Ae({width:we,height:tt});const lt=nt.current(Y.current);Y.current=lt,L(lt)};de();const Oe=new ResizeObserver(de);return Oe.observe(re),()=>Oe.disconnect()},[n,D?.src,Z]),b.useEffect(()=>{Z||!n||!Ie||!_||Fe.current(O.current)},[n,D?.src,Ie,_,Z]),b.useEffect(()=>{n&&S!==void 0&&Fe.current(O.current)},[n,S]);const ft=()=>{const Q=C.current;if(!Q)return;const re=$.current,de=Y.current,Oe=Ze(re);Q.style.transform=`translate3d(${Oe.x+de.x}px, ${Oe.y+de.y}px, 0) scale(${re})`},Nt=Q=>{if(Z){const de=T.current;if(de&&Q.target===de){const Oe=de.getBoundingClientRect();if(Q.clientY>Oe.bottom-60)return}}Q.currentTarget.setPointerCapture(Q.pointerId);const re=Cf(j.current);if(re.set(Q.pointerId,{x:Q.clientX,y:Q.clientY}),re.size===1){if(pe.current={x:Q.clientX,y:Q.clientY,time:Date.now()},!Z){ue.current={x:Q.clientX-Y.current.x,y:Q.clientY-Y.current.y};const de=C.current;de&&(de.style.transition="none")}}else if(re.size===2&&!Z){const[de,Oe]=Array.from(re.values()),Ke=Math.hypot(Oe.x-de.x,Oe.y-de.y),we=(de.x+Oe.x)/2,it=(de.y+Oe.y)/2,ot=j.current?.getBoundingClientRect(),tt=$.current,lt=Y.current,wt=Ze(tt),pt=ot?{x:(we-ot.left-wt.x-lt.x)/tt,y:(it-ot.top-wt.y-lt.y)/tt}:void 0;fe.current={distance:Ke,scale:tt,centerX:we,centerY:it,imagePoint:pt}}},Ht=Q=>{const re=Cf(j.current);if(re.has(Q.pointerId)){if(re.set(Q.pointerId,{x:Q.clientX,y:Q.clientY}),re.size===2&&fe.current&&!Z){const de=fe.current,[Oe,Ke]=Array.from(re.values()),we=Math.hypot(Ke.x-Oe.x,Ke.y-Oe.y),ot=Math.max(_e,Math.min(5,de.scale*(we/de.distance)));$.current=ot;const tt=j.current?.getBoundingClientRect(),lt=(Oe.x+Ke.x)/2,wt=(Oe.y+Ke.y)/2;if(tt&&de.imagePoint){const pt=Ze(ot),St={x:lt-tt.left-pt.x-de.imagePoint.x*ot,y:wt-tt.top-pt.y-de.imagePoint.y*ot};Y.current=Ge(St,ot)}else Y.current=Ge(Y.current,ot);ft();return}if(re.size===1&&!Z){const de=$.current;(de>1||Ie&&j.current&&Ie.height*de>j.current.clientHeight+1)&&ue.current&&(Y.current=Ge({x:Q.clientX-ue.current.x,y:Q.clientY-ue.current.y},de),ft())}}},Vt=Q=>{const re=Cf(j.current);if(re.delete(Q.pointerId),re.size<2){if(re.size===1&&fe.current){const[de]=Array.from(re.values());ue.current={x:de.x-Y.current.x,y:de.y-Y.current.y}}fe.current=null}if(re.size===0){const de=C.current;de&&(de.style.transition="transform 0.05s linear");const Oe=Date.now(),Ke=Re.current,we=Ke?Q.clientX-Ke.x:0,it=Ke?Q.clientY-Ke.y:0,ot=!!(Ke&&Oe-Ke.time<300&&Math.hypot(we,it)<24);if(!Z&&ot){Re.current=null;const tt=O.current;Ye(tt==="fit"?"cover":"fit"),W()}else{Re.current={time:Oe,x:Q.clientX,y:Q.clientY};const tt=pe.current;if(!P&&tt){const lt=Q.clientX-tt.x,wt=Q.clientY-tt.y,pt=Date.now()-tt.time,St=Math.abs(lt),yt=Math.abs(wt),ht=$.current,Tt=Math.abs(ht-_e)<.05||Math.abs(ht-$e)<.05,Et=pt<250&&St<10&&yt<10;pt<=350&&St>60&&St>yt&&Tt?lt<0?s<o.length-1&&l(s+1):lt>0&&s>0&&l(s-1):Et&&W()}R($.current),L(Y.current)}ue.current=null}},ye=Q=>{if(Z||!Q.ctrlKey)return;Q.preventDefault();const re=-Q.deltaY*.005,de=Math.max(_e,Math.min(5,$.current+re));$.current=de,R(de);const Oe=Ge(Y.current,de);Y.current=Oe,L(Oe)};return n?!D&&!g?Mn.createPortal(u.jsxs("div",{className:"fixed inset-0 bg-black flex flex-col items-center justify-center text-white",style:{zIndex:Qf},role:"dialog","aria-modal":"true",children:[u.jsx(xa,{onClick:i,buttonSize:9,iconSize:6,zIndex:Nf}),u.jsx("p",{className:"text-gray-400 mb-2",children:"No images to display"}),u.jsxs("p",{className:"text-gray-500 text-sm",children:["images: ",o.length,", index: ",s]})]}),document.body):Mn.createPortal(u.jsxs("div",{id:"media-viewer-overlay",className:"fixed inset-0 bg-black",style:{zIndex:Qf},onWheel:ye,children:[u.jsx("div",{ref:j,className:`absolute inset-x-0 top-0 overflow-hidden ${Z?"":"touch-none"}`,style:{overscrollBehavior:"contain",height:"calc(100vh - var(--bottom-bar-offset, 0px))",zIndex:1},onPointerDown:Nt,onPointerMove:Ht,onPointerUp:Vt,onPointerCancel:Vt,children:g?u.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center text-white",children:[u.jsx("div",{className:"w-12 h-12 border-4 border-gray-600 border-t-white rounded-full animate-spin"}),u.jsx("div",{className:"mt-4 w-48 h-2 rounded-full bg-gray-700 overflow-hidden",children:u.jsx("div",{className:"h-full bg-white transition-all duration-300",style:{width:`${Math.min(100,Math.max(0,y))}%`}})}),u.jsx("div",{className:"mt-2 text-sm text-gray-300",children:x??`${Math.min(100,Math.max(0,y))}%`})]}):D&&u.jsx(u.Fragment,{children:Z?u.jsxs(u.Fragment,{children:[u.jsx("video",{ref:T,src:D.src,controls:!0,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,className:"w-full h-full object-contain select-none",onDragStart:Q=>Q.preventDefault(),onError:()=>H(!0)}),Se&&u.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-white text-sm bg-black/60",children:"Unable to play this video."})]}):u.jsx("img",{ref:C,src:D.src,alt:D.alt||"Generation",className:"w-full h-auto block select-none relative",draggable:!1,onLoad:st,style:{transform:`translate3d(${Ze(U).x+z.x}px, ${Ze(U).y+z.y}px, 0) scale(${U})`,transformOrigin:"top left",willChange:"transform",backfaceVisibility:"hidden",WebkitBackfaceVisibility:"hidden"}})})}),u.jsx(xa,{onClick:i,buttonSize:9,iconSize:6,isIdle:ce,zIndex:Nf}),u.jsx("div",{className:`absolute inset-0 pointer-events-none transition-opacity duration-300 ${ce?"opacity-0":"opacity-100"}`,style:{zIndex:Nf},children:D&&u.jsxs(u.Fragment,{children:[u.jsx(ak,{index:s,total:o.length,displayName:ee}),u.jsx(fk,{isVideo:Z,showMetadataToggle:p,canToggleMetadata:I,onDelete:me,onLoadWorkflow:ke,onUseInWorkflow:F,onToggleMetadata:be}),u.jsx(pk,{isVideo:Z,showMetadataToggle:p,showMetadataOverlay:Me,metadataIsLoading:B,metadata:je,durationLabel:Ne})]})})]}),document.body):null}function Cf(n){const o=n;return o?(o.__activePointers||(o.__activePointers=new Map),o.__activePointers):new Map}function mk(n){const o=n===void 0||Number.isNaN(n)?0:n;return o===0?"":o<10?`${o.toFixed(1)}s`:`${Math.round(o)}s`}function Eu(n){return n.id.startsWith("input/")?"input":"output"}function ul(n,o){const l=`${o??Eu(n)}/`;return n.id.startsWith(l)?n.id.slice(l.length):n.id}function gk(n){return`output-${n.replace(/[\\/]/g,"_")}.json`}async function vx(n){const{file:o,source:s,loadWorkflow:l,onLoaded:i,onError:c}=n;try{const f=s??Eu(o),m=ul(o,f),p=await ew(m,f);l(p,gk(m),{source:{type:"other"}}),i?.()}catch(f){throw c?.(f),f}}function yk(n){const{workflow:o,nodeTypes:s,nodeId:l}=n;if(!o||!s)return null;const i=o.nodes.find(f=>f.id===l);if(!i)return null;const c=["image","filename","file"];for(const f of c){const m=Wr(o,s,i,f);if(m!==null)return{node:i,index:m,name:f}}return null}function qy(n,o){const s=n.title,l=typeof s=="string"&&s.trim()?s.trim():null,i=o?.[n.type];return l||i?.display_name||n.type}function bk(n){const o=n.replace(/^\/+/,""),s=o.split("/").filter(Boolean);return s.length<=1?{filename:o,subfolder:""}:{filename:s.pop()??o,subfolder:s.join("/")}}async function xk(n,o){if(o==="input")return ul(n,o);const s=ul(n,o),{filename:l,subfolder:i}=bk(s),c=n.fullUrl||mo(l,i,o),f=await fetch(c);if(!f.ok)throw new Error("Failed to fetch image data.");const m=await f.blob(),p=l||n.name||"image.png",g=new File([m],p,{type:m.type||"image/png"}),y=await eb(g,{type:"input",overwrite:!0}),x=y.subfolder?`${y.subfolder}/${y.name}`:y.name;if(!(await fetch(mo(y.name,y.subfolder??"","input"))).ok)throw new Error("Uploaded image was not found in inputs.");return x}function wx({open:n,file:o,source:s,onClose:l,onLoaded:i}){const c=ae(T=>T.workflow),f=ae(T=>T.nodeTypes),m=ae(T=>T.setNodeTypes),p=ae(T=>T.updateNodeWidget),g=sn(T=>T.clearNodeError),y=ae(T=>T.scrollToNode),x=eo(T=>T.setCurrentPanel),[w,k]=b.useState(null),[N,S]=b.useState(null),j=b.useMemo(()=>c?c.nodes.filter(T=>/loadimage/i.test(T.type)).map(T=>({node:T,stableKey:T.stableKey??null})).filter(T=>T.stableKey!==null):[],[c]);b.useEffect(()=>{n||(k(null),S(null))},[n]);const C=async T=>{if(!(!o||!c)){S(T),k(null);try{const V=c.nodes.find(z=>z.stableKey===T);if(!V)throw new Error("Could not resolve selected node.");const U=yk({workflow:c,nodeTypes:f,nodeId:V.id});if(!U)throw new Error("Selected node does not accept image inputs.");const R=await xk(o,s);if(s!=="input")try{const z=await tp();m(z)}catch(z){console.warn("Failed to refresh node types after upload:",z)}p(T,U.index,R,U.name),g(U.node.id),x("workflow"),i?.(),setTimeout(()=>{y(T,qy(U.node,f))},150)}catch(V){console.error("Failed to load image into node:",V),k(V instanceof Error?V.message:"Failed to load image.")}finally{S(null)}}};return!n||!o?null:u.jsx("div",{id:"outputs-load-node-overlay",className:"fixed inset-0 z-[2150] bg-black/50 flex items-center justify-center p-4",onClick:l,role:"dialog","aria-modal":"true",children:u.jsxs("div",{id:"outputs-load-node-modal",className:"w-full max-w-sm bg-white border border-gray-200 rounded-xl shadow-lg overflow-hidden",onClick:T=>T.stopPropagation(),children:[u.jsx("div",{className:"px-4 py-3 text-sm font-semibold text-gray-700 border-b border-gray-100",children:"Load image into node"}),u.jsx("div",{className:"px-4 pt-3 text-xs text-gray-500",children:o.name}),u.jsxs("div",{className:"max-h-[50vh] overflow-y-auto",children:[j.length===0&&u.jsx("div",{className:"px-4 py-3 text-sm text-gray-400",children:"No Load Image nodes found in the current workflow."}),j.map(({node:T,stableKey:V})=>{const U=qy(T,f),R=N===V;return u.jsxs("button",{className:"w-full text-left px-4 py-3 text-sm hover:bg-gray-50 flex items-center gap-2 disabled:opacity-60 disabled:cursor-not-allowed",onClick:()=>C(V),disabled:N!==null,children:[u.jsxs("span",{className:"text-gray-500 dark:text-gray-300",children:["#",T.id]}),u.jsx("span",{className:"flex-1 text-gray-900 dark:text-gray-100 truncate",children:U}),R&&u.jsx("span",{className:"text-xs text-gray-400",children:"Loading"})]},`load-node-${V}`)})]}),w&&u.jsx("div",{className:"px-4 py-2 text-xs text-red-600 border-t border-gray-100",children:w}),u.jsx("div",{className:"px-4 py-3 border-t border-gray-100 flex justify-end",children:u.jsx("button",{className:"px-3 py-2 text-sm font-medium text-gray-600 hover:bg-gray-100 rounded-lg disabled:opacity-60",onClick:l,disabled:N!==null,children:"Close"})})]})})}function vk({onClose:n}){const o=Mo(xe=>xe.viewerOpen),s=Mo(xe=>xe.viewerImages),l=Mo(xe=>xe.viewerIndex),i=Mo(xe=>xe.viewerScale),c=Mo(xe=>xe.viewerTranslate),f=ae(xe=>xe.followQueue),m=Mo(xe=>xe.setViewerState),p=ae(xe=>xe.workflow),g=ae(xe=>xe.originalWorkflow),y=ae(xe=>xe.workflowDurationStats),x=ae(xe=>xe.isExecuting),w=ae(xe=>xe.executingPromptId),k=eo(xe=>xe.setCurrentPanel),N=ae(xe=>xe.loadWorkflow),S=Mt(xe=>xe.running),j=qn(xe=>xe.history),[C,T]=b.useState(null),[V,U]=b.useState(null),[R,z]=b.useState(null),[L,$]=b.useState(!1),Y=b.useRef(null),ue=b.useMemo(()=>!!(p&&g&&JSON.stringify(p)!==JSON.stringify(g)),[p,g]),pe=b.useMemo(()=>!o||!f?null:j[0]?.prompt_id??null,[o,f,j]),fe=w||(S.length===1?S[0].prompt_id:null),Re=Ma({workflow:p,runKey:fe,isRunning:x||S.length>0,workflowDurationStats:y}),Ie=x||S.length>0,Ae=Math.min(100,Math.max(0,Re??0)),se=!(l>=0?s[l]??s[0]??null:null)&&(f||Ie)||l<0&&Ie;b.useEffect(()=>{if(!o||!f){Y.current=null;return}!Y.current&&j[0]?.prompt_id&&(Y.current=j[0]?.prompt_id??null)},[o,f,j]),b.useEffect(()=>{if(!o||!f||j.length===0)return;const xe=j[0];if(Y.current===xe.prompt_id||xe.outputs.images.filter(P=>P.type==="output").length===0)return;const H=Ep(j,{onlyOutput:!0,alt:"Generation"});H.length!==0&&(Y.current=xe.prompt_id,m({viewerImages:H,viewerIndex:0,viewerScale:1,viewerTranslate:{x:0,y:0}}))},[o,f,j,m]);const ce=xe=>{m({viewerIndex:xe})},Ue=(xe,Se)=>{m({viewerScale:xe,viewerTranslate:Se})},De=xe=>{xe.file&&T(xe.file)},E=async()=>{if(!C)return;const xe=C;try{const Se=ul(xe);await Of(Se,Eu(xe));const H=s.filter(K=>K.file?.id!==xe.id),P=s.findIndex(K=>K.file?.id===xe.id),D=H.length===0?0:P<0?l:P<l?l-1:P===l?Math.min(l,H.length-1):l;m({viewerImages:H,viewerIndex:D}),H.length===0&&n()}catch(Se){console.error("Failed to delete file:",Se),window.alert("Failed to delete file.")}finally{T(null)}},A=xe=>{if(xe.file){if(ue){U(xe.file);return}O(xe.file)}},O=async xe=>{try{await vx({file:xe,loadWorkflow:N,onLoaded:()=>{n(),queueMicrotask(()=>k("workflow"))}})}catch(Se){console.error("Failed to load workflow from file:",Se),window.alert("Failed to load workflow from file.")}finally{U(null)}},te=xe=>{!xe.file||xe.file.type!=="image"||(z(xe.file),$(!0))},Le=()=>{$(!1),z(null)},We=()=>{Le(),n(),queueMicrotask(()=>k("workflow"))};return o?u.jsxs(u.Fragment,{children:[u.jsx(xx,{open:o,items:s,index:l,onIndexChange:ce,onClose:n,onDelete:De,onLoadWorkflow:A,onLoadInWorkflow:te,showMetadataToggle:!0,showLoadingPlaceholder:se,loadingProgress:Ae,loadingLabel:Ie?`${Ae}%`:"Waiting for output",initialScale:i,initialTranslate:c,onTransformChange:Ue,zoomResetKey:pe}),V&&Mn.createPortal(u.jsx(Po,{onClose:()=>U(null),title:"Unsaved changes",description:"Are you sure you want to load this workflow? You have unsaved changes.",actions:[{label:"Cancel",onClick:()=>U(null),className:"px-3 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-100"},{label:"Continue",onClick:()=>{(async()=>(await O(V),U(null)))()},className:"px-3 py-2 rounded-lg text-sm font-medium text-white bg-red-600 hover:bg-red-700"}]}),document.body),u.jsx(wx,{open:L,file:R,source:R?Eu(R):"output",onClose:Le,onLoaded:We}),C&&Mn.createPortal(u.jsx(Po,{onClose:()=>T(null),title:"Delete file?",description:`This will permanently delete "${C.name}" from the server. This cannot be undone.`,actions:[{label:"Cancel",onClick:()=>T(null),className:"px-3 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-100"},{label:"Delete",onClick:()=>{E()},className:"px-3 py-2 rounded-lg text-sm font-medium text-white bg-red-600 hover:bg-red-700"}]}),document.body)]}):null}function wk(){const[n,o]=b.useState(!1),s=b.useRef(null),l=b.useRef(null),i=b.useRef({}),c=b.useRef({setExecutionState:ae.getState().setExecutionState,setNodeOutput:ae.getState().setNodeOutput,clearNodeOutputs:ae.getState().clearNodeOutputs,addPromptOutputs:ae.getState().addPromptOutputs,clearPromptOutputs:ae.getState().clearPromptOutputs,applyControlAfterGenerate:ae.getState().applyControlAfterGenerate,updateFromStatus:Mt.getState().updateFromStatus,fetchQueue:Mt.getState().fetchQueue,addHistoryEntry:qn.getState().addHistoryEntry,fetchHistory:qn.getState().fetchHistory});b.useEffect(()=>{c.current={setExecutionState:ae.getState().setExecutionState,setNodeOutput:ae.getState().setNodeOutput,clearNodeOutputs:ae.getState().clearNodeOutputs,addPromptOutputs:ae.getState().addPromptOutputs,clearPromptOutputs:ae.getState().clearPromptOutputs,applyControlAfterGenerate:ae.getState().applyControlAfterGenerate,updateFromStatus:Mt.getState().updateFromStatus,fetchQueue:Mt.getState().fetchQueue,addHistoryEntry:qn.getState().addHistoryEntry,fetchHistory:qn.getState().fetchHistory}},[]);const f=b.useRef(null);return b.useEffect(()=>{const m=x=>{if(x==null)return null;const w=Number(x);if(!Number.isFinite(w))return null;const N=ae.getState().workflow;if(!N)return null;const S=N.nodes.filter(C=>C.id===w);return S.length===0?null:(S.find(C=>C.stableKey)??S[0])?.stableKey??null},p=x=>{const{setExecutionState:w,setNodeOutput:k,addPromptOutputs:N,clearPromptOutputs:S,updateFromStatus:j,fetchQueue:C,addHistoryEntry:T,fetchHistory:V}=c.current,U=x;switch(U.type){case"status":{const z=U.data.status.exec_info.queue_remaining;j(z),z===0&&w(!1,null,null,0);break}case"progress":{const R=U,{value:z,max:L,node:$,prompt_id:Y}=R.data,ue=Math.round(z/L*100);w(!0,m($),Y||null,ue);break}case"executing":{const R=U,z=R.data.node,L=R.data.prompt_id;if(z===null){if(w(!1,null,null,0),c.current.applyControlAfterGenerate(),L){const $=Mt.getState().running.find(ue=>ue.prompt_id===L),Y=i.current[L]||[];$&&T({prompt_id:L,timestamp:Date.now(),outputs:{images:Y},prompt:$.prompt}),delete i.current[L],S(L)}C(),V()}else{L&&L!==f.current&&(f.current=L),w(!0,m(z),L||null,0);const $=Mt.getState();L&&!$.running.some(Y=>Y.prompt_id===L)&&C()}break}case"executed":{const R=U,{node:z,prompt_id:L,output:$}=R.data;if($.images){i.current[L]||(i.current[L]=[]),i.current[L].push(...$.images),N(L,$.images);const Y=m(z);Y&&k(Y,$.images)}break}case"execution_error":{w(!1,null,null,0),S(),C(),V();break}}},g=()=>{s.current?.readyState!==WebSocket.OPEN&&(s.current=Z1(Xy,p,async()=>{o(!0);const{fetchQueue:x,fetchHistory:w,setExecutionState:k}=c.current;await x(),w();const N=Mt.getState(),S=ae.getState();if(N.running.length>0&&!S.executingPromptId){const j=N.running[0];k(!0,null,j.prompt_id,0)}},()=>{o(!1),l.current=setTimeout(g,2e3)},()=>{o(!1)}))};g();const y=setInterval(()=>{const{fetchQueue:x,fetchHistory:w}=c.current;Mt.getState().running.length>0&&(x(),w())},2e3);return()=>{l.current&&clearTimeout(l.current),s.current&&s.current.close(),clearInterval(y)}},[]),{isConnected:n}}function Sk({onSwipeLeft:n,onSwipeRight:o,onSwipeUp:s,onSwipeDown:l,enabled:i=!0,threshold:c=50,preventScroll:f=!0,deferResetOnSwipe:m=!1,deferResetDurationMs:p=350}){const[g,y]=b.useState(0),[x,w]=b.useState(!1),[k,N]=b.useState(i),S=b.useRef(null),j=b.useRef(null);b.useEffect(()=>{N(i)},[i]);const C=b.useCallback(()=>{S.current=null,w(!1),y(0)},[]),T=b.useCallback(V=>{N(V)},[]);return b.useEffect(()=>{if(!k)return;const V=L=>{if(!(L instanceof HTMLElement))return!1;if(L.isContentEditable)return!0;const $=L.tagName.toLowerCase();return $==="input"||$==="textarea"||$==="select"},U=L=>{if(V(L.target)||V(document.activeElement))return;j.current!==null&&(window.clearTimeout(j.current),j.current=null);const $=L.touches[0];S.current={startX:$.clientX,startY:$.clientY,currentX:$.clientX,currentY:$.clientY,isHorizontal:null,isTracking:!0}},R=L=>{const $=S.current;if(!$?.isTracking)return;const Y=L.touches[0],ue=Y.clientX-$.startX,pe=Y.clientY-$.startY;if($.isHorizontal===null){if(Math.abs(ue)>20||Math.abs(pe)>20){const fe=Math.abs(ue)>Math.abs(pe);$.isHorizontal=fe,fe?(ue>0?!!o:!!n)?w(!0):$.isTracking=!1:(pe>0?l:s)||($.isTracking=!1)}return}$.isHorizontal?(f&&L.cancelable&&L.preventDefault(),$.currentX=Y.clientX,y(Y.clientX-$.startX)):$.currentY=Y.clientY},z=()=>{const L=S.current;if(!L?.isTracking){C();return}const $=L.currentX-L.startX,Y=L.currentY-L.startY,ue=c||window.innerWidth*.25;let pe=!1;L.isHorizontal===!0?$<-ue&&n?(n(),pe=!0):$>ue&&o&&(o(),pe=!0):L.isHorizontal===!1&&(Y<-ue&&s?(s(),pe=!0):Y>ue&&l&&(l(),pe=!0)),pe?m?(S.current=null,w(!1),j.current!==null&&window.clearTimeout(j.current),j.current=window.setTimeout(()=>{C(),j.current=null},p)):requestAnimationFrame(()=>{C()}):C()};return document.addEventListener("touchstart",U,{passive:!0}),document.addEventListener("touchmove",R,{passive:!1}),document.addEventListener("touchend",z,{passive:!0}),document.addEventListener("touchcancel",z,{passive:!0}),()=>{document.removeEventListener("touchstart",U),document.removeEventListener("touchmove",R),document.removeEventListener("touchend",z),document.removeEventListener("touchcancel",z),j.current!==null&&(window.clearTimeout(j.current),j.current=null),C()}},[k,n,o,s,l,c,f,m,p,C]),{swipeOffset:g,isSwiping:x,setSwipeEnabled:T,resetSwipeState:C}}function Wy({idPrefix:n,title:o,items:s,selectedValue:l,onSelect:i,gridClassName:c="grid grid-cols-2 gap-2",buttonClassName:f=""}){return u.jsxs("div",{id:`${n}-container`,children:[u.jsx("h4",{id:`${n}-label`,className:"text-sm font-medium text-gray-700 mb-2",children:o}),u.jsx("div",{id:`${n}-options`,className:c,children:s.map(m=>{const p=l===m.value;return u.jsxs("button",{className:`px-3 py-2 rounded-lg text-sm border ${f} ${p?"bg-blue-500 border-blue-500 text-white shadow-sm":"border-gray-200 text-gray-700 hover:bg-gray-50"}`,onClick:()=>i(m.value),children:[m.label,p&&m.suffix?m.suffix:""]},m.value)})})]})}function Nk({checked:n,onChange:o}){return u.jsxs("div",{id:"favorites-toggle-container",className:"flex items-center gap-2",children:[u.jsx("input",{type:"checkbox",id:"favOnly",checked:n,onChange:s=>o(s.target.checked),className:"rounded text-blue-600 focus:ring-blue-500"}),u.jsx("label",{htmlFor:"favOnly",className:"text-sm text-gray-700",children:"Show Favorites Only"})]})}function Ck({open:n,onClose:o,filter:s,sort:l,onChangeFilter:i,onChangeSort:c}){if(!n)return null;const f=l?.mode||"modified",m=f.includes("name")?"name":f.includes("size")?"size":"date",p=(()=>{const y=f.endsWith("reverse");return m==="date"?y?"asc":"desc":y?"desc":"asc"})(),g=(y,x)=>{let w;y==="name"?w=x==="asc"?"name":"name-reverse":y==="size"?w=x==="asc"?"size":"size-reverse":w=x==="desc"?"modified":"modified-reverse",c({mode:w})};return u.jsx("div",{id:"filter-modal-root",className:"fixed inset-0 z-[1600] bg-black/50 flex items-center justify-center p-4",onClick:o,children:u.jsxs("div",{id:"filter-modal-content",className:"bg-white rounded-xl shadow-lg w-full max-w-sm max-h-[90vh] overflow-y-auto",onClick:y=>y.stopPropagation(),children:[u.jsxs("div",{id:"filter-modal-header",className:"p-4 border-b border-gray-100 flex items-center justify-between",children:[u.jsx("h3",{id:"filter-modal-title",className:"font-semibold text-gray-900",children:"Filter & Sort"}),u.jsx(xa,{variant:"plain",onClick:o,buttonSize:8,iconSize:6})]}),u.jsxs("div",{id:"filter-modal-body",className:"p-4 space-y-6",children:[u.jsx(Wy,{idPrefix:"sort-group",title:"Sort By",items:[{value:"name",label:"Name",suffix:m==="name"?p==="asc"?" ":" ":void 0},{value:"date",label:"Date",suffix:m==="date"?p==="asc"?" ":" ":void 0},{value:"size",label:"Size",suffix:m==="size"?p==="asc"?" ":" ":void 0}],selectedValue:m,onSelect:y=>{g(y,m===y?p==="asc"?"desc":"asc":y==="name"?"asc":"desc")}}),u.jsx(Wy,{idPrefix:"filter-type-group",title:"File Type",items:[{value:"all",label:"All"},{value:"image",label:"Image"},{value:"video",label:"Video"}],selectedValue:s.type,onSelect:y=>i({type:y}),gridClassName:"flex gap-2",buttonClassName:"flex-1"}),u.jsxs("div",{id:"search-input-container",children:[u.jsx("label",{id:"search-input-label",className:"block text-sm font-medium text-gray-700 mb-1",children:"Search"}),u.jsx(ja,{placeholder:"Search by filename...",value:s.search,onChange:y=>i({search:y})})]}),u.jsx(Nk,{checked:s.favoritesOnly,onChange:y=>i({favoritesOnly:y})})]}),u.jsx("div",{id:"filter-modal-footer",className:"p-4 border-t border-gray-100 bg-gray-50 flex justify-end",children:u.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700",onClick:o,children:"Apply"})})]})})}function au({onClose:n,zIndex:o=2200,children:s}){return u.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4",style:{zIndex:o},onClick:n,role:"dialog","aria-modal":"true",children:u.jsx("div",{className:"w-full max-w-sm bg-white border border-gray-200 rounded-xl shadow-lg overflow-hidden",onClick:l=>l.stopPropagation(),children:s})})}function kk({breadcrumbs:n,selectionMode:o,selectedCount:s,onClearSelection:l}){return u.jsx("div",{id:"outputs-panel-header",className:"px-4 py-3 flex flex-col gap-3 border-b border-gray-100",children:u.jsxs("div",{id:"outputs-header-top-row",className:"flex items-center justify-between min-h-[24px]",children:[n,o&&u.jsxs("div",{className:"selection-status-container flex items-center gap-2 shrink-0 ml-2",children:[u.jsxs("span",{className:"text-[10px] font-bold text-blue-600 uppercase",children:[s," selected"]}),u.jsx("button",{onClick:l,className:"text-[10px] text-gray-500 underline uppercase font-bold",children:"Clear"})]})]})})}function Xf({file:n,viewMode:o,selectionMode:s,isSelected:l,isFavorited:i,onNavigateFolder:c,onOpen:f,onMenu:m,onToggleSelection:p}){const g=n.type==="folder",[y,x]=b.useState(!1);b.useEffect(()=>{x(!1)},[n.previewUrl,n.id]);const w=()=>{s?p(n.id):g?c(n.name):f(n)},k=N=>{N.stopPropagation(),m(n,N)};return o==="list"?u.jsxs("div",{className:`file-card-list-item flex items-center gap-3 p-2 hover:bg-gray-50 border-b border-gray-100 last:border-0 ${l?"bg-blue-50":""}`,onClick:w,children:[s&&u.jsx("div",{className:`selection-checkbox w-5 h-5 rounded border flex items-center justify-center flex-shrink-0 ${l?"bg-blue-600 border-blue-600 text-white":"border-gray-300 bg-white"}`,children:l&&u.jsx(Do,{className:"w-3.5 h-3.5"})}),u.jsx("div",{className:`file-preview-container w-10 h-10 flex-shrink-0 flex items-center justify-center rounded text-gray-500 overflow-hidden relative ${g?"":"bg-gray-100"}`,children:g?u.jsx(hr,{className:"w-6 h-6 text-amber-500"}):n.previewUrl&&!y?u.jsx("img",{src:n.previewUrl,className:"w-full h-full object-cover",loading:"lazy",onError:()=>x(!0)}):n.type==="video"?u.jsx(K0,{className:"w-5 h-5 text-gray-500"}):u.jsx("span",{className:"text-xs font-bold",children:"IMG"})}),u.jsx("div",{className:"file-info-container flex-1 min-w-0",children:u.jsx("div",{className:"file-name text-sm font-medium text-gray-900 truncate",children:n.name})}),u.jsxs("div",{className:"file-actions-container flex items-center gap-2",children:[i&&u.jsx(Gr,{className:"w-4 h-4 text-yellow-500"}),u.jsx(Pr,{onClick:k,ariaLabel:"File options",buttonSize:8,iconSize:5})]})]}):u.jsxs("div",{className:"file-card-grid-item flex flex-col gap-1",children:[u.jsxs("div",{className:`relative aspect-square bg-gray-100 rounded-lg overflow-hidden transition-all ${l?"ring-4 ring-blue-500 ring-offset-2":""}`,onClick:w,children:[g?u.jsx("div",{className:"folder-grid-content w-full h-full flex flex-col items-center justify-center text-gray-500",children:u.jsx(hr,{className:"w-12 h-12 mb-2 text-amber-500"})}):n.previewUrl&&!y?u.jsx("img",{src:n.previewUrl,className:"w-full h-full object-cover",loading:"lazy",onError:()=>x(!0)}):u.jsx("div",{className:"media-placeholder w-full h-full flex items-center justify-center bg-gray-800 text-white font-bold",children:n.type==="video"?u.jsx(K0,{className:"w-10 h-10 text-white/80"}):"IMG"}),s?u.jsx("div",{className:"selection-badge-container absolute top-2 left-2",children:u.jsx("div",{className:`selection-badge w-6 h-6 rounded-full border-2 flex items-center justify-center shadow-sm ${l?"bg-blue-600 border-blue-600 text-white":"border-white bg-black/20"}`,children:l&&u.jsx(Do,{className:"w-4 h-4"})})}):u.jsxs("div",{className:"file-menu-trigger-container absolute top-1 right-1 flex flex-col items-center gap-1 text-white",children:[u.jsx(Pr,{onClick:k,ariaLabel:"File options",buttonSize:7,iconSize:4}),i&&u.jsx(Gr,{className:"w-4 h-4 text-yellow-400 drop-shadow"})]}),n.type==="video"&&u.jsx("div",{className:"video-label absolute top-1 left-1 bg-black/50 px-1 rounded text-[10px] text-white",children:"VID"})]}),u.jsx("div",{className:"file-name text-xs text-gray-700 truncate px-1",children:n.name})]})}function jk({folders:n,foldersCollapsed:o,toggleFoldersCollapsed:s,selectionMode:l,selectedIds:i,favorites:c,setCurrentFolder:f,handleOpen:m,handleMenu:p,toggleSelection:g}){return n.length===0?null:u.jsxs("div",{id:"outputs-folders-section",className:"mb-4",children:[u.jsxs("button",{onClick:s,className:"flex items-center gap-2 w-full text-left mb-2 py-1 text-sm font-medium text-gray-600 hover:text-gray-900",children:[o?u.jsx(pp,{className:"w-4 h-4"}):u.jsx(vu,{className:"w-4 h-4"}),u.jsxs("span",{children:["Folders (",n.length,")"]})]}),!o&&u.jsx("div",{className:"flex flex-col border border-gray-200 rounded-lg overflow-hidden",children:n.map(y=>u.jsx(Xf,{file:y,viewMode:"list",selectionMode:l,isSelected:i.includes(y.id),isFavorited:c.includes(y.id),onNavigateFolder:f,onOpen:m,onMenu:p,onToggleSelection:g},y.id))})]})}function Mk({fileSections:n,collapsedSections:o,viewMode:s,selectionMode:l,selectedIds:i,favorites:c,setCurrentFolder:f,handleOpen:m,handleMenu:p,toggleSelection:g,toggleSectionCollapsed:y,selectIds:x}){return u.jsx("div",{id:"outputs-files-section",className:"flex flex-col gap-4",children:n.map(w=>u.jsxs("div",{className:"flex flex-col gap-2",children:[u.jsxs("div",{className:"flex items-center justify-between gap-3",children:[u.jsxs("button",{className:"flex items-center gap-2 text-[11px] font-semibold uppercase tracking-wide text-gray-500 hover:text-gray-800",onClick:()=>y(w.key),children:[o[w.key]?u.jsx(pp,{className:"w-3.5 h-3.5"}):u.jsx(vu,{className:"w-3.5 h-3.5"}),u.jsxs("span",{children:[w.label," (",w.files.length,")"]})]}),l&&u.jsx("button",{className:"text-[10px] font-bold uppercase text-blue-600 hover:text-blue-700",onClick:()=>x(w.files.map(k=>k.id)),children:"Select all"})]}),!o[w.key]&&(s==="grid"?u.jsx("div",{className:"grid grid-cols-2 gap-4 auto-rows-min",children:w.files.map(k=>u.jsx(Xf,{file:k,viewMode:s,selectionMode:l,isSelected:i.includes(k.id),isFavorited:c.includes(k.id),onNavigateFolder:f,onOpen:m,onMenu:p,onToggleSelection:g},k.id))}):u.jsx("div",{className:"flex flex-col",children:w.files.map(k=>u.jsx(Xf,{file:k,viewMode:s,selectionMode:l,isSelected:i.includes(k.id),isFavorited:c.includes(k.id),onNavigateFolder:f,onOpen:m,onMenu:p,onToggleSelection:g},k.id))}))]},w.key))})}function Ok({menuTarget:n,favorites:o,setMenuTarget:s,menuRef:l,menuStyle:i,handleFavorite:c,handleSelectSingle:f,handleMoveSingle:m,handleRenameRequest:p,handleLoadWorkflow:g,handleLoadInWorkflow:y,handleDeleteRequest:x}){if(!n)return null;const w=[{key:"favorite",label:o.includes(n.file.id)?"Unfavorite":"Favorite",icon:o.includes(n.file.id)?u.jsx(Gr,{className:"w-4 h-4"}):u.jsx(_u,{className:"w-4 h-4"}),onClick:()=>c()},{key:"select",label:"Select",icon:u.jsx(Do,{className:"w-4 h-4"}),onClick:()=>f()},{key:"move",label:"Move",icon:u.jsx(hr,{className:"w-4 h-4"}),onClick:()=>m()},{key:"rename",label:"Rename",icon:u.jsx(cp,{className:"w-4 h-4"}),onClick:()=>p()},{key:"load-workflow",label:"Load workflow",icon:u.jsx(bs,{className:"w-4 h-4"}),onClick:()=>g(),hidden:n.file.type!=="image"},{key:"use-in-workflow",label:"Use in workflow",icon:u.jsx(ub,{className:"w-4 h-4"}),onClick:()=>y(),hidden:n.file.type!=="image"},{key:"delete",label:"Delete",icon:u.jsx(Bo,{className:"w-4 h-4"}),onClick:()=>x(),color:"danger"}];return u.jsxs(u.Fragment,{children:[u.jsx("div",{id:"outputs-context-menu-overlay",className:"fixed inset-0 z-[1690]",onClick:()=>s(null),onPointerDown:k=>k.stopPropagation()}),u.jsx("div",{id:"outputs-context-menu",ref:l,className:"fixed z-[1700] min-w-44 w-max",style:i,onPointerDown:k=>k.stopPropagation(),onClick:k=>k.stopPropagation(),children:u.jsx(gr,{items:w})})]})}const Gy="outputs-folders-collapsed",Tk=1440*60*1e3;function Ek(n){if(!n)return"Unknown date";const o=new Date,s=new Date(o.getFullYear(),o.getMonth(),o.getDate()),l=new Date(n),i=new Date(l.getFullYear(),l.getMonth(),l.getDate()),c=Math.round((s.getTime()-i.getTime())/Tk);return c===0?"Today":c===1?"Yesterday":l.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})}function Ik({visible:n}){const{source:o,currentFolder:s,isLoading:l,viewMode:i,showHidden:c,filter:f,sort:m,favorites:p,selectionMode:g,selectedIds:y,setCurrentFolder:x,navigateToPath:w,fetchFolders:k,fetchFiles:N,toggleFavorite:S,toggleSelection:j,getDisplayedFiles:C,refresh:T,selectIds:V,toggleSelectionMode:U,setFilter:R,setSort:z}=$t(),L=$t(Ce=>Ce.selectionActionOpen),$=$t(Ce=>Ce.setSelectionActionOpen),Y=$t(Ce=>Ce.filterModalOpen),ue=$t(Ce=>Ce.setFilterModalOpen),pe=$t(Ce=>Ce.newFolderModalOpen),fe=$t(Ce=>Ce.setNewFolderModalOpen),Re=$t(Ce=>Ce.setOutputsViewerOpen),Ie=$t(Ce=>Ce.addFavorites),Ae=$t(Ce=>Ce.removeFavorites),_=$t(Ce=>Ce.clearSelection),se=ae(Ce=>Ce.loadWorkflow),ce=eo(Ce=>Ce.setCurrentPanel),Ue=ae(Ce=>Ce.workflow),De=ae(Ce=>Ce.originalWorkflow),E=b.useMemo(()=>!!(Ue&&De&&JSON.stringify(Ue)!==JSON.stringify(De)),[Ue,De]),[A,O]=b.useState(null),[te,Le]=b.useState(null),[We,xe]=b.useState(null),[Se,H]=b.useState(null),[P,D]=b.useState(!1),[K,Z]=b.useState(null),[q,Ee]=b.useState(""),[je,Ne]=b.useState(!1),[ee,Me]=b.useState(!1),[I,B]=b.useState(null),[W,be]=b.useState([]),[me,ke]=b.useState(!1),[F,ie]=b.useState(""),[_e,$e]=b.useState([]),[Ze,Ge]=b.useState(null),[nt,Ye]=b.useState(""),[Fe,st]=b.useState(!1),[ft,Nt]=b.useState([]),[Ht,Vt]=b.useState(0),ye=b.useRef(null),Q=b.useRef(null),re=b.useRef(!1),[de,Oe]=b.useState(()=>localStorage.getItem(Gy)==="true"),[Ke,we]=b.useState({}),it=b.useRef(null),ot=b.useRef(null),tt=b.useRef(!1),lt=()=>{Le(null),it.current=null},wt=()=>{D(!1),xe(null),ot.current=null},pt=(Ce,rt)=>{it.current=rt?.onDeleted??null,Le(Ce)},St=(Ce,rt)=>{Ce.type==="image"&&(ot.current=rt?.onLoaded??null,xe(Ce),D(!0))},{menuStyle:yt,resetMenuPosition:ht}=mp({open:!!A,buttonRef:Q,menuRef:ye,repositionToken:A?.file.id,menuWidth:176,horizontalAnchorOffset:160,viewportPadding:8,bottomBarReserve:104});cl({open:!!A,onDismiss:()=>{O(null),ht()},triggerRef:Q,contentRef:ye}),b.useEffect(()=>{re.current=!1},[o]),b.useEffect(()=>{n&&!re.current&&!l&&(re.current=!0,k(),N())},[n,k,N,l]),b.useEffect(()=>{!n&&Fe&&(st(!1),Re(!1))},[n,Fe,Re]),b.useEffect(()=>{!n&&Y&&ue(!1)},[n,Y,ue]);const Tt=C(),Et=$t(Ce=>Ce.sort.mode),Yt=Ce=>{const dt=C().filter(_t=>(_t.type==="image"||_t.type==="video")&&_t.fullUrl),ln=dt.map(_t=>({src:_t.fullUrl,alt:_t.name,mediaType:Oa(_t.name),file:_t,filename:_t.name})),wn=dt.findIndex(_t=>_t.id===Ce.id);wn>=0&&(Nt(ln),Vt(wn),st(!0),Re(!0))},Gt=()=>{st(!1),Re(!1)},It=Ce=>{Ce.file&&pt(Ce.file,{onDeleted:rt=>{Nt(dt=>{const ln=dt.findIndex(_t=>_t.file?.id===rt.id),wn=dt.filter(_t=>_t.file?.id!==rt.id);return Vt(_t=>wn.length===0?0:ln===-1?_t:ln<_t?_t-1:ln===_t?Math.min(_t,wn.length-1):_t),wn.length===0&&(st(!1),Re(!1)),wn})}})},dn=Ce=>{!Ce.file||Ce.file.type!=="image"||St(Ce.file,{onLoaded:()=>{st(!1),Re(!1)}})},pn=Ce=>{Ce.file&&On(Ce.file,{closeViewer:!0})},{folders:Wn,nonFolders:Kn}=b.useMemo(()=>{const Ce=[],rt=[];for(const dt of Tt)dt.type==="folder"?Ce.push(dt):rt.push(dt);return{folders:Ce,nonFolders:rt}},[Tt]),no=Et.startsWith("name"),oo=Et.startsWith("size"),X=f.favoritesOnly||!no&&!oo,ze=b.useMemo(()=>{if(no){const rt=[];for(const dt of Kn){const ln=dt.name?.trim()?.charAt(0).toUpperCase()||"#",wn=`Starting with ${ln}`,_t=rt[rt.length-1];_t&&_t.key===ln?_t.files.push(dt):rt.push({key:ln,label:wn,files:[dt]})}return rt}if(oo){const rt=[];for(const dt of Kn){const wn=(dt.size??0)/(1024*1024),_t=wn<1?0:Math.round(wn),yo=_t===0?"<1MB":`${_t}MB`,hl=_t===0?"<1MB":`${_t}MB`,Yr=rt[rt.length-1];Yr&&Yr.key===yo?Yr.files.push(dt):rt.push({key:yo,label:hl,files:[dt]})}return rt}if(!X)return[{key:"all",label:"All files",files:Kn}];const Ce=[];for(const rt of Kn){const dt=rt.date?new Date(rt.date).toISOString().slice(0,10):"unknown",ln=Ek(rt.date),wn=Ce[Ce.length-1];wn&&wn.key===dt?wn.files.push(rt):Ce.push({key:dt,label:ln,files:[rt]})}return Ce},[Kn,X,no,oo]),oe=()=>{const Ce=!de;Oe(Ce),localStorage.setItem(Gy,String(Ce))},et=Ce=>{we(rt=>({...rt,[Ce]:!rt[Ce]}))},Xe=Ce=>{Yt(Ce)},Qe=(Ce,rt)=>{rt.preventDefault(),rt.stopPropagation(),Q.current=rt.currentTarget,O({file:Ce})},Pe=()=>{A&&(S(A.file.id),O(null))},ne=()=>{A&&(g||U(),V([A.file.id],"replace"),O(null))},qe=()=>{A&&A.file.type==="image"&&(xe(A.file),D(!0),O(null))},Je=()=>{A&&(Le(A.file),O(null))},at=()=>{A&&(Z(A.file),Ee(A.file.name),O(null))},Lt=()=>{y.length!==0&&($(!1),Ne(!0))},Zt=async(Ce,rt)=>{try{await vx({file:Ce,source:o,loadWorkflow:se,onLoaded:()=>{ce("workflow"),rt?.closeViewer&&(st(!1),Re(!1))}})}catch(dt){console.error("Failed to load workflow from file:",dt),window.alert("Failed to load workflow from file.")}},On=(Ce,rt)=>{if(Ce.type==="folder"){window.alert("Workflow metadata is not available for folders.");return}if(E){tt.current=!!rt?.closeViewer,H(Ce);return}Zt(Ce,rt)},on=()=>{if(!A)return;const Ce=A.file;O(null),On(Ce,{closeViewer:!1})},Tn=async()=>{if(!Se)return;const Ce=Se,rt=tt.current;tt.current=!1,H(null),await Zt(Ce,{closeViewer:rt})},xn=()=>{tt.current=!1,H(null)},vn=async()=>{if(!te)return;const Ce=te;try{const rt=ul(te,o);await Of(rt,o),T(),it.current?.(Ce),it.current=null}catch(rt){console.error("Failed to delete file:",rt),window.alert("Failed to delete file.")}finally{Le(null)}},Ea=async()=>{if(y.length===0){Ne(!1);return}try{const Ce=`${o}/`,rt=y.map(dt=>dt.startsWith(Ce)?dt.slice(Ce.length):dt);await Promise.all(rt.map(dt=>Of(dt,o))),T(),_()}catch(Ce){console.error("Failed to delete selected files:",Ce),window.alert("Failed to delete selected files.")}finally{Ne(!1)}},Uu=()=>{if(y.length===0)return;y.every(rt=>p.includes(rt))?Ae(y):Ie(y),$(!1)},fl=()=>{y.length!==0&&($(!1),$e([...y]),Ge(s),B(s),Me(!0))},Ia=()=>{A&&($e([A.file.id]),Ge(s),B(s),Me(!0),O(null))},Qo=()=>{Z(null),Ee("")},La=async()=>{if(!K)return;const Ce=q.trim();if(Ce){if(Ce===K.name){Qo();return}try{const rt=ul(K,o);await ow(rt,Ce,o),T(),Qo()}catch(rt){console.error("Failed to rename item:",rt),window.alert("Failed to rename item.")}}},Bn=()=>{Me(!1),$e([]),Ge(null)},pl=async()=>{if(_e.length!==0)try{const Ce=`${o}/`,rt=_e.map(dt=>dt.startsWith(Ce)?dt.slice(Ce.length):dt);await nw(rt,I,o),T(),g&&(_(),U())}catch(Ce){console.error("Failed to move selected files:",Ce),window.alert("Failed to move selected files.")}finally{Bn()}},Aa=async()=>{const Ce=F.trim();if(!Ce)return;const rt=I?`${I}/${Ce}`:Ce;try{await N0(rt,o),ie(""),ke(!0);const dt=await Mf(o,1e3,0,"modified",!1,I,c);be(dt.filter(ln=>ln.type==="folder"))}catch(dt){console.error("Failed to create folder:",dt),window.alert("Failed to create folder.")}finally{ke(!1)}},xs=async()=>{const Ce=nt.trim();if(!Ce)return;const rt=s?`${s}/${Ce}`:Ce;try{await N0(rt,o),Ye(""),fe(!1),T()}catch(dt){console.error("Failed to create folder:",dt),window.alert("Failed to create folder.")}},ro=b.useMemo(()=>{const rt=[{name:o==="output"?"Outputs":"Inputs",path:null}];if(s){const dt=s.split("/");dt.forEach((ln,wn)=>{rt.push({name:ln,path:dt.slice(0,wn+1).join("/")})})}return rt},[o,s]),Ra=()=>{const Ce=ro.length,rt=[];return Ce<=3?ro.forEach((dt,ln)=>{rt.push({...dt,isClickable:ln<Ce-1})}):(rt.push({...ro[0],isClickable:!0}),rt.push({name:"...",path:ro[Ce-3].path,isEllipsis:!0,isClickable:!0}),rt.push({...ro[Ce-2],isClickable:!0}),rt.push({...ro[Ce-1],isClickable:!1})),u.jsx("div",{id:"outputs-breadcrumb-trail",className:"flex items-center text-sm overflow-hidden whitespace-nowrap",children:rt.map((dt,ln)=>u.jsxs("div",{className:"flex items-center min-w-0",children:[ln>0&&u.jsx("span",{className:"mx-1.5 text-gray-400 shrink-0",children:"/"}),u.jsx("button",{onClick:()=>dt.isClickable&&w(dt.path),disabled:!dt.isClickable,className:`
                truncate transition-colors
                ${dt.isClickable?"text-blue-600 hover:text-blue-700 active:opacity-70":"text-gray-700 font-medium"}
                ${dt.isEllipsis?"px-1 bg-gray-100 rounded":""}
              `,title:dt.name,children:dt.name})]},ln))})};b.useEffect(()=>{if(!ee)return;let Ce=!1;return(async()=>{ke(!0);try{const dt=await Mf(o,1e3,0,"modified",!1,I,c);if(Ce)return;be(dt.filter(ln=>ln.type==="folder"))}catch(dt){if(Ce)return;console.error("Failed to load folders:",dt),be([])}finally{Ce||ke(!1)}})(),()=>{Ce=!0}},[ee,I,o,c]),b.useEffect(()=>{L&&y.length===0&&$(!1)},[L,y.length,$]);const _a=()=>{const Ce=$t.getState();Ce.clearSelection(),Ce.toggleSelectionMode()},wr=()=>{if(!I)return;const Ce=I.split("/");Ce.pop(),B(Ce.length?Ce.join("/"):null)},$u=Ce=>()=>{B(I?`${I}/${Ce}`:Ce)};return u.jsx("div",{id:"outputs-panel-wrapper",className:"absolute inset-x-0 top-[60px] bottom-0",style:{display:n?"block":"none"},children:u.jsxs("div",{id:"outputs-panel-root",className:"h-full bg-white flex flex-col pt-[4px] pb-[80px]",children:[u.jsx(kk,{breadcrumbs:Ra(),selectionMode:g,selectedCount:y.length,onClearSelection:_a}),u.jsxs("div",{id:"outputs-content-container",className:"flex-1 overflow-y-auto p-4",children:[u.jsx(jk,{folders:Wn,foldersCollapsed:de,toggleFoldersCollapsed:oe,selectionMode:g,selectedIds:y,favorites:p,setCurrentFolder:x,handleOpen:Xe,handleMenu:Qe,toggleSelection:j}),u.jsx(Mk,{fileSections:ze,collapsedSections:Ke,viewMode:i,selectionMode:g,selectedIds:y,favorites:p,setCurrentFolder:x,handleOpen:Xe,handleMenu:Qe,toggleSelection:j,toggleSectionCollapsed:et,selectIds:V}),l&&u.jsx("div",{id:"outputs-loading-indicator",className:"py-4 flex justify-center",children:u.jsx("span",{className:"text-gray-400 text-sm",children:"Loading..."})}),!l&&Tt.length===0&&u.jsx("div",{id:"outputs-empty-message",className:"text-center text-gray-400 py-8",children:s?"No images in this folder":o==="output"?"No generated images yet":"No imported images"})]}),u.jsx(Ok,{menuTarget:A,favorites:p,setMenuTarget:O,menuRef:ye,menuStyle:yt,handleFavorite:Pe,handleSelectSingle:ne,handleMoveSingle:Ia,handleRenameRequest:at,handleLoadWorkflow:on,handleLoadInWorkflow:qe,handleDeleteRequest:Je}),L&&u.jsxs(au,{onClose:()=>$(!1),zIndex:1800,children:[u.jsxs("div",{className:"px-4 py-3 text-sm font-semibold text-gray-700 border-b border-gray-100",children:[y.length," selected"]}),u.jsxs("button",{className:"w-full text-left px-4 py-3 text-sm hover:bg-gray-50 flex items-center gap-2",onClick:Uu,children:[y.every(Ce=>p.includes(Ce))?u.jsx(_u,{className:"w-4 h-4"}):u.jsx(Gr,{className:"w-4 h-4"}),y.every(Ce=>p.includes(Ce))?"Unfavorite":"Favorite"]}),u.jsxs("button",{className:"w-full text-left px-4 py-3 text-sm hover:bg-gray-50 flex items-center gap-2",onClick:fl,children:[u.jsx(hr,{className:"w-4 h-4 text-gray-500"}),"Move"]}),u.jsxs("button",{className:"w-full text-left px-4 py-3 text-sm text-red-600 hover:bg-red-50 flex items-center gap-2",onClick:Lt,children:[u.jsx(Bo,{className:"w-4 h-4"}),"Delete"]}),u.jsx("button",{className:"w-full text-left px-4 py-3 text-sm text-gray-600 hover:bg-gray-50",onClick:()=>$(!1),children:"Cancel"})]}),ee&&u.jsxs(au,{onClose:Bn,zIndex:1850,children:[u.jsx("div",{className:"px-4 py-3 text-sm font-semibold text-gray-700 border-b border-gray-100",children:I!==Ze?u.jsxs(u.Fragment,{children:["Move to ",u.jsx(hr,{className:"w-4 h-4 text-amber-500 inline"})," ",I||"root"]}):"Move to..."}),u.jsxs("div",{className:"max-h-[50vh] overflow-y-auto",children:[me&&u.jsx("div",{className:"px-4 py-3 text-sm text-gray-400",children:"Loading folders..."}),!me&&I&&u.jsx("button",{className:"w-full text-left px-4 py-3 text-sm hover:bg-gray-50 flex items-center gap-2",onClick:wr,children:u.jsx("span",{className:"text-gray-500",children:".."})}),!me&&W.filter(Ce=>!_e.includes(Ce.id)).length===0&&u.jsx("div",{className:"px-4 py-3 text-sm text-gray-400",children:"No folders"}),!me&&W.filter(Ce=>!_e.includes(Ce.id)).map(Ce=>u.jsxs("button",{className:"w-full text-left px-4 py-3 text-sm hover:bg-gray-50 flex items-center gap-2",onClick:$u(Ce.name),children:[u.jsx(hr,{className:"w-4 h-4 text-amber-500"}),Ce.name]},Ce.id)),u.jsx("div",{className:"px-4 py-3 border-t border-gray-100",children:u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("input",{value:F,onChange:Ce=>ie(Ce.target.value),placeholder:"New folder",className:"flex-1 border border-gray-200 rounded-lg px-3 py-2 text-sm"}),u.jsx("button",{className:"px-3 py-2 text-sm font-medium text-blue-600 hover:text-blue-700",onClick:Aa,children:"Create"})]})})]}),u.jsxs("div",{className:"px-4 py-3 border-t border-gray-100 flex justify-end gap-2",children:[u.jsx("button",{className:"px-3 py-2 text-sm font-medium text-gray-600 hover:bg-gray-100 rounded-lg",onClick:Bn,children:"Cancel"}),u.jsx("button",{className:`px-3 py-2 text-sm font-medium rounded-lg ${I!==Ze?"text-white bg-blue-600 hover:bg-blue-700":"text-gray-400 bg-gray-200 cursor-not-allowed"}`,onClick:pl,disabled:I===Ze,children:"Submit"})]})]}),te&&u.jsx(Po,{onClose:lt,title:"Delete file?",description:te.type==="folder"?`This will permanently delete the folder "${te.name}" and all of its contents from the server. This cannot be undone.`:`This will permanently delete "${te.name}" from the server. This cannot be undone.`,actions:[{label:"Cancel",onClick:lt,className:"px-3 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-100"},{label:"Delete",onClick:vn,className:"px-3 py-2 rounded-lg text-sm font-medium text-white bg-red-600 hover:bg-red-700"}]}),je&&u.jsx(Po,{onClose:()=>Ne(!1),title:"Delete selected files?",description:`This will permanently delete ${y.length} selected file${y.length===1?"":"s"} from the server. This cannot be undone.`,zIndex:1800,actions:[{label:"Cancel",onClick:()=>Ne(!1),className:"px-3 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-100"},{label:"Delete",onClick:Ea,className:"px-3 py-2 rounded-lg text-sm font-medium text-white bg-red-600 hover:bg-red-700"}]}),K&&u.jsx(au,{onClose:Qo,zIndex:1850,children:u.jsxs("div",{className:"p-4",children:[u.jsxs("div",{className:"text-gray-900 text-base font-semibold",children:["Rename ",K.type==="folder"?"folder":"file"]}),u.jsxs("div",{className:"text-gray-600 text-sm mt-1 truncate",children:["Current: ",K.name]}),u.jsx("input",{value:q,onChange:Ce=>Ee(Ce.target.value),onKeyDown:Ce=>{Ce.key==="Enter"&&La()},placeholder:K.type==="folder"?"Folder name":"File name",className:"mt-3 w-full border border-gray-200 rounded-lg px-3 py-2 text-sm",autoFocus:!0}),u.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[u.jsx("button",{className:"px-3 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-100",onClick:Qo,children:"Cancel"}),u.jsx("button",{className:`px-3 py-2 rounded-lg text-sm font-medium ${q.trim()&&q.trim()!==K.name?"text-white bg-blue-600 hover:bg-blue-700":"text-gray-400 bg-gray-200 cursor-not-allowed"}`,onClick:()=>{La()},disabled:!q.trim()||q.trim()===K.name,children:"Rename"})]})]})}),pe&&u.jsx(au,{onClose:()=>{fe(!1),Ye("")},zIndex:1850,children:u.jsxs("div",{className:"p-4",children:[u.jsx("div",{className:"text-gray-900 text-base font-semibold",children:"New folder"}),u.jsxs("div",{className:"text-gray-600 text-sm mt-1",children:["Create a new folder in ",s?u.jsxs(u.Fragment,{children:[u.jsx(hr,{className:"w-3.5 h-3.5 text-amber-500 inline"})," ",s]}):"root"]}),u.jsx("input",{value:nt,onChange:Ce=>Ye(Ce.target.value),onKeyDown:Ce=>{Ce.key==="Enter"&&xs()},placeholder:"Folder name",className:"mt-3 w-full border border-gray-200 rounded-lg px-3 py-2 text-sm",autoFocus:!0}),u.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[u.jsx("button",{className:"px-3 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-100",onClick:()=>{fe(!1),Ye("")},children:"Cancel"}),u.jsx("button",{className:`px-3 py-2 rounded-lg text-sm font-medium ${nt.trim()?"text-white bg-blue-600 hover:bg-blue-700":"text-gray-400 bg-gray-200 cursor-not-allowed"}`,onClick:xs,disabled:!nt.trim(),children:"Create"})]})]})}),u.jsx(wx,{open:P,file:We,source:o,onClose:wt,onLoaded:()=>{D(!1),xe(null),ot.current?.(),ot.current=null}}),u.jsx(Ck,{open:Y,onClose:()=>ue(!1),filter:f,sort:m,onChangeFilter:R,onChangeSort:z}),Se&&Mn.createPortal(u.jsx(Po,{onClose:xn,title:"Unsaved changes",description:"Are you sure you want to load this workflow? You have unsaved changes.",actions:[{label:"Cancel",onClick:xn,className:"px-3 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-100"},{label:"Continue",onClick:()=>{Tn()},className:"px-3 py-2 rounded-lg text-sm font-medium text-white bg-red-600 hover:bg-red-700"}]}),document.body),u.jsx(xx,{open:Fe,items:ft,index:Ht,onClose:Gt,onIndexChange:Vt,onDelete:It,onLoadInWorkflow:dn,onLoadWorkflow:pn,showMetadataToggle:!0})]})})}function Lk(){const n=eo(_=>_.currentPanel),o=eo(_=>_.setCurrentPanel),s=Lf(_=>_.appMenuOpen),l=Mo(_=>_.viewerOpen),i=Mo(_=>_.setViewerState),c=ae(_=>_.followQueue),f=ae(_=>_.setFollowQueue),m=Fn(_=>_.bookmarkRepositioningActive),p=b.useRef(null),{isInputFocused:g}=bx(),y=$t(_=>_.outputsViewerOpen),x=$t(_=>_.selectionMode),w=$t(_=>_.filterModalOpen),k=$t(_=>_.selectionActionOpen),N=$t(_=>_.currentFolder),S=$t(_=>_.navigateUp);wk();const j=b.useCallback(()=>{n==="workflow"?o("queue"):n==="outputs"&&o("workflow")},[n,o]),C=b.useCallback(()=>{n==="outputs"&&N?S():n==="workflow"?o("outputs"):n==="queue"&&o("workflow")},[n,N,S,o]),T=n==="workflow"||n==="outputs",V=n==="workflow"||n==="queue"||n==="outputs"&&!!N,{swipeOffset:U,isSwiping:R,setSwipeEnabled:z,resetSwipeState:L}=Sk({onSwipeLeft:T?j:void 0,onSwipeRight:V?C:void 0,enabled:!g&&!l&&!s&&!y&&!m&&!x&&!w&&!k}),$=ae(_=>_.setNodeTypes),Y=al(_=>_.theme),ue=ae(_=>_.workflowLoadedAt),pe=Mt(_=>_.fetchQueue),fe=qn(_=>_.history);b.useEffect(()=>{!R&&U!==0&&L()},[R,U,L]),b.useEffect(()=>{y&&L()},[y,L]);const Re=()=>{i({viewerOpen:!1}),f(!1),z(!0),L()};b.useEffect(()=>{tp().then(_=>{$(_)}).catch(_=>{console.error("Failed to load node types:",_)})},[$]),b.useEffect(()=>{pe()},[pe]);const Ie=(_,se,ce=!0)=>{z(!1),L(),i({viewerImages:_,viewerIndex:se,viewerScale:1,viewerTranslate:{x:0,y:0},viewerOpen:!0}),f(ce)},Ae=()=>{const _=Ep(fe,{onlyOutput:!0,alt:"Generation"});z(!1),L();const se=_.length>0?0:-1;i({viewerImages:_,viewerIndex:se,viewerScale:1,viewerTranslate:{x:0,y:0},viewerOpen:!0}),f(!0)};return b.useLayoutEffect(()=>{const _=document.documentElement;_.classList.toggle("dark",Y==="dark"),_.style.colorScheme=Y},[Y]),b.useEffect(()=>{ue&&queueMicrotask(()=>{f(!1)})},[ue,f]),u.jsxs("div",{id:"app-root",className:"min-h-screen bg-gray-100",children:[u.jsx(J2,{mode:n}),u.jsxs("main",{id:"main-content",ref:p,className:"pt-[69px] pb-[80px] min-h-screen relative",children:[u.jsxs(u.Fragment,{children:[u.jsx(Ik,{visible:n==="outputs"}),u.jsx(M4,{visible:n==="workflow",onImageClick:Ie}),u.jsx(ek,{visible:n==="queue",onImageClick:Ie})]}),u.jsx("div",{id:"bottom-bar-spacer",className:"fixed inset-x-0 bottom-0 bg-gray-100 pointer-events-none z-[1500]",style:{height:"var(--bottom-bar-offset, 80px)"}})]}),u.jsx(B4,{currentPanel:n,viewerOpen:l,followQueue:c,onToggleFollowQueue:()=>f(!c),onOpenFollowQueue:Ae}),u.jsx(vk,{onClose:Re})]})}R1.createRoot(document.getElementById("root")).render(u.jsx(b.StrictMode,{children:u.jsx(Lk,{})}));
//# sourceMappingURL=index-CqdPv-fZ.js.map
