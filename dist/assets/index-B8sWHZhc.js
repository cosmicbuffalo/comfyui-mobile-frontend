function j1(n,o){for(var s=0;s<o.length;s++){const l=o[s];if(typeof l!="string"&&!Array.isArray(l)){for(const i in l)if(i!=="default"&&!(i in n)){const c=Object.getOwnPropertyDescriptor(l,i);c&&Object.defineProperty(n,i,c.get?c:{enumerable:!0,get:()=>l[i]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))l(i);new MutationObserver(i=>{for(const c of i)if(c.type==="childList")for(const f of c.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&l(f)}).observe(document,{childList:!0,subtree:!0});function s(i){const c={};return i.integrity&&(c.integrity=i.integrity),i.referrerPolicy&&(c.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?c.credentials="include":i.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function l(i){if(i.ep)return;i.ep=!0;const c=s(i);fetch(i.href,c)}})();function M1(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var qd={exports:{}},na={};var u0;function O1(){if(u0)return na;u0=1;var n=Symbol.for("react.transitional.element"),o=Symbol.for("react.fragment");function s(l,i,c){var f=null;if(c!==void 0&&(f=""+c),i.key!==void 0&&(f=""+i.key),"key"in i){c={};for(var m in i)m!=="key"&&(c[m]=i[m])}else c=i;return i=c.ref,{$$typeof:n,type:l,key:f,ref:i!==void 0?i:null,props:c}}return na.Fragment=o,na.jsx=s,na.jsxs=s,na}var c0;function T1(){return c0||(c0=1,qd.exports=O1()),qd.exports}var u=T1(),Wd={exports:{}},Ot={};var d0;function E1(){if(d0)return Ot;d0=1;var n=Symbol.for("react.transitional.element"),o=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),l=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),c=Symbol.for("react.consumer"),f=Symbol.for("react.context"),m=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),g=Symbol.for("react.memo"),b=Symbol.for("react.lazy"),x=Symbol.for("react.activity"),w=Symbol.iterator;function k(E){return E===null||typeof E!="object"?null:(E=w&&E[w]||E["@@iterator"],typeof E=="function"?E:null)}var N={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,j={};function C(E,A,M){this.props=E,this.context=A,this.refs=j,this.updater=M||N}C.prototype.isReactComponent={},C.prototype.setState=function(E,A){if(typeof E!="object"&&typeof E!="function"&&E!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,E,A,"setState")},C.prototype.forceUpdate=function(E){this.updater.enqueueForceUpdate(this,E,"forceUpdate")};function T(){}T.prototype=C.prototype;function V(E,A,M){this.props=E,this.context=A,this.refs=j,this.updater=M||N}var U=V.prototype=new T;U.constructor=V,S(U,C.prototype),U.isPureReactComponent=!0;var R=Array.isArray;function z(){}var L={H:null,A:null,T:null,S:null},$=Object.prototype.hasOwnProperty;function Q(E,A,M){var ee=M.ref;return{$$typeof:n,type:E,key:A,ref:ee!==void 0?ee:null,props:M}}function ue(E,A){return Q(E.type,A,E.props)}function fe(E){return typeof E=="object"&&E!==null&&E.$$typeof===n}function de(E){var A={"=":"=0",":":"=2"};return"$"+E.replace(/[=:]/g,function(M){return A[M]})}var Ie=/\/+/g;function je(E,A){return typeof E=="object"&&E!==null&&E.key!=null?de(""+E.key):A.toString(36)}function Me(E){switch(E.status){case"fulfilled":return E.value;case"rejected":throw E.reason;default:switch(typeof E.status=="string"?E.then(z,z):(E.status="pending",E.then(function(A){E.status==="pending"&&(E.status="fulfilled",E.value=A)},function(A){E.status==="pending"&&(E.status="rejected",E.reason=A)})),E.status){case"fulfilled":return E.value;case"rejected":throw E.reason}}throw E}function _(E,A,M,ee,Te){var qe=typeof E;(qe==="undefined"||qe==="boolean")&&(E=null);var ye=!1;if(E===null)ye=!0;else switch(qe){case"bigint":case"string":case"number":ye=!0;break;case"object":switch(E.$$typeof){case n:case o:ye=!0;break;case b:return ye=E._init,_(ye(E._payload),A,M,ee,Te)}}if(ye)return Te=Te(E),ye=ee===""?"."+je(E,0):ee,R(Te)?(M="",ye!=null&&(M=ye.replace(Ie,"$&/")+"/"),_(Te,A,M,"",function(Y){return Y})):Te!=null&&(fe(Te)&&(Te=ue(Te,M+(Te.key==null||E&&E.key===Te.key?"":(""+Te.key).replace(Ie,"$&/")+"/")+ye)),A.push(Te)),1;ye=0;var Ne=ee===""?".":ee+":";if(R(E))for(var H=0;H<E.length;H++)ee=E[H],qe=Ne+je(ee,H),ye+=_(ee,A,M,qe,Te);else if(H=k(E),typeof H=="function")for(E=H.call(E),H=0;!(ee=E.next()).done;)ee=ee.value,qe=Ne+je(ee,H++),ye+=_(ee,A,M,qe,Te);else if(qe==="object"){if(typeof E.then=="function")return _(Me(E),A,M,ee,Te);throw A=String(E),Error("Objects are not valid as a React child (found: "+(A==="[object Object]"?"object with keys {"+Object.keys(E).join(", ")+"}":A)+"). If you meant to render a collection of children, use an array instead.")}return ye}function oe(E,A,M){if(E==null)return E;var ee=[],Te=0;return _(E,ee,"","",function(qe){return A.call(M,qe,Te++)}),ee}function ce(E){if(E._status===-1){var A=E._result;A=A(),A.then(function(M){(E._status===0||E._status===-1)&&(E._status=1,E._result=M)},function(M){(E._status===0||E._status===-1)&&(E._status=2,E._result=M)}),E._status===-1&&(E._status=0,E._result=A)}if(E._status===1)return E._result.default;throw E._result}var Ke=typeof reportError=="function"?reportError:function(E){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var A=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof E=="object"&&E!==null&&typeof E.message=="string"?String(E.message):String(E),error:E});if(!window.dispatchEvent(A))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",E);return}console.error(E)},Le={map:oe,forEach:function(E,A,M){oe(E,function(){A.apply(this,arguments)},M)},count:function(E){var A=0;return oe(E,function(){A++}),A},toArray:function(E){return oe(E,function(A){return A})||[]},only:function(E){if(!fe(E))throw Error("React.Children.only expected to receive a single React element child.");return E}};return Ot.Activity=x,Ot.Children=Le,Ot.Component=C,Ot.Fragment=s,Ot.Profiler=i,Ot.PureComponent=V,Ot.StrictMode=l,Ot.Suspense=p,Ot.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=L,Ot.__COMPILER_RUNTIME={__proto__:null,c:function(E){return L.H.useMemoCache(E)}},Ot.cache=function(E){return function(){return E.apply(null,arguments)}},Ot.cacheSignal=function(){return null},Ot.cloneElement=function(E,A,M){if(E==null)throw Error("The argument must be a React element, but you passed "+E+".");var ee=S({},E.props),Te=E.key;if(A!=null)for(qe in A.key!==void 0&&(Te=""+A.key),A)!$.call(A,qe)||qe==="key"||qe==="__self"||qe==="__source"||qe==="ref"&&A.ref===void 0||(ee[qe]=A[qe]);var qe=arguments.length-2;if(qe===1)ee.children=M;else if(1<qe){for(var ye=Array(qe),Ne=0;Ne<qe;Ne++)ye[Ne]=arguments[Ne+2];ee.children=ye}return Q(E.type,Te,ee)},Ot.createContext=function(E){return E={$$typeof:f,_currentValue:E,_currentValue2:E,_threadCount:0,Provider:null,Consumer:null},E.Provider=E,E.Consumer={$$typeof:c,_context:E},E},Ot.createElement=function(E,A,M){var ee,Te={},qe=null;if(A!=null)for(ee in A.key!==void 0&&(qe=""+A.key),A)$.call(A,ee)&&ee!=="key"&&ee!=="__self"&&ee!=="__source"&&(Te[ee]=A[ee]);var ye=arguments.length-2;if(ye===1)Te.children=M;else if(1<ye){for(var Ne=Array(ye),H=0;H<ye;H++)Ne[H]=arguments[H+2];Te.children=Ne}if(E&&E.defaultProps)for(ee in ye=E.defaultProps,ye)Te[ee]===void 0&&(Te[ee]=ye[ee]);return Q(E,qe,Te)},Ot.createRef=function(){return{current:null}},Ot.forwardRef=function(E){return{$$typeof:m,render:E}},Ot.isValidElement=fe,Ot.lazy=function(E){return{$$typeof:b,_payload:{_status:-1,_result:E},_init:ce}},Ot.memo=function(E,A){return{$$typeof:g,type:E,compare:A===void 0?null:A}},Ot.startTransition=function(E){var A=L.T,M={};L.T=M;try{var ee=E(),Te=L.S;Te!==null&&Te(M,ee),typeof ee=="object"&&ee!==null&&typeof ee.then=="function"&&ee.then(z,Ke)}catch(qe){Ke(qe)}finally{A!==null&&M.types!==null&&(A.types=M.types),L.T=A}},Ot.unstable_useCacheRefresh=function(){return L.H.useCacheRefresh()},Ot.use=function(E){return L.H.use(E)},Ot.useActionState=function(E,A,M){return L.H.useActionState(E,A,M)},Ot.useCallback=function(E,A){return L.H.useCallback(E,A)},Ot.useContext=function(E){return L.H.useContext(E)},Ot.useDebugValue=function(){},Ot.useDeferredValue=function(E,A){return L.H.useDeferredValue(E,A)},Ot.useEffect=function(E,A){return L.H.useEffect(E,A)},Ot.useEffectEvent=function(E){return L.H.useEffectEvent(E)},Ot.useId=function(){return L.H.useId()},Ot.useImperativeHandle=function(E,A,M){return L.H.useImperativeHandle(E,A,M)},Ot.useInsertionEffect=function(E,A){return L.H.useInsertionEffect(E,A)},Ot.useLayoutEffect=function(E,A){return L.H.useLayoutEffect(E,A)},Ot.useMemo=function(E,A){return L.H.useMemo(E,A)},Ot.useOptimistic=function(E,A){return L.H.useOptimistic(E,A)},Ot.useReducer=function(E,A,M){return L.H.useReducer(E,A,M)},Ot.useRef=function(E){return L.H.useRef(E)},Ot.useState=function(E){return L.H.useState(E)},Ot.useSyncExternalStore=function(E,A,M){return L.H.useSyncExternalStore(E,A,M)},Ot.useTransition=function(){return L.H.useTransition()},Ot.version="19.2.3",Ot}var f0;function Zf(){return f0||(f0=1,Wd.exports=E1()),Wd.exports}var y=Zf();const tl=M1(y),p0=j1({__proto__:null,default:tl},[y]);var Gd={exports:{}},oa={},Pd={exports:{}},Yd={};var h0;function I1(){return h0||(h0=1,(function(n){function o(_,oe){var ce=_.length;_.push(oe);e:for(;0<ce;){var Ke=ce-1>>>1,Le=_[Ke];if(0<i(Le,oe))_[Ke]=oe,_[ce]=Le,ce=Ke;else break e}}function s(_){return _.length===0?null:_[0]}function l(_){if(_.length===0)return null;var oe=_[0],ce=_.pop();if(ce!==oe){_[0]=ce;e:for(var Ke=0,Le=_.length,E=Le>>>1;Ke<E;){var A=2*(Ke+1)-1,M=_[A],ee=A+1,Te=_[ee];if(0>i(M,ce))ee<Le&&0>i(Te,M)?(_[Ke]=Te,_[ee]=ce,Ke=ee):(_[Ke]=M,_[A]=ce,Ke=A);else if(ee<Le&&0>i(Te,ce))_[Ke]=Te,_[ee]=ce,Ke=ee;else break e}}return oe}function i(_,oe){var ce=_.sortIndex-oe.sortIndex;return ce!==0?ce:_.id-oe.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var c=performance;n.unstable_now=function(){return c.now()}}else{var f=Date,m=f.now();n.unstable_now=function(){return f.now()-m}}var p=[],g=[],b=1,x=null,w=3,k=!1,N=!1,S=!1,j=!1,C=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,V=typeof setImmediate<"u"?setImmediate:null;function U(_){for(var oe=s(g);oe!==null;){if(oe.callback===null)l(g);else if(oe.startTime<=_)l(g),oe.sortIndex=oe.expirationTime,o(p,oe);else break;oe=s(g)}}function R(_){if(S=!1,U(_),!N)if(s(p)!==null)N=!0,z||(z=!0,de());else{var oe=s(g);oe!==null&&Me(R,oe.startTime-_)}}var z=!1,L=-1,$=5,Q=-1;function ue(){return j?!0:!(n.unstable_now()-Q<$)}function fe(){if(j=!1,z){var _=n.unstable_now();Q=_;var oe=!0;try{e:{N=!1,S&&(S=!1,T(L),L=-1),k=!0;var ce=w;try{t:{for(U(_),x=s(p);x!==null&&!(x.expirationTime>_&&ue());){var Ke=x.callback;if(typeof Ke=="function"){x.callback=null,w=x.priorityLevel;var Le=Ke(x.expirationTime<=_);if(_=n.unstable_now(),typeof Le=="function"){x.callback=Le,U(_),oe=!0;break t}x===s(p)&&l(p),U(_)}else l(p);x=s(p)}if(x!==null)oe=!0;else{var E=s(g);E!==null&&Me(R,E.startTime-_),oe=!1}}break e}finally{x=null,w=ce,k=!1}oe=void 0}}finally{oe?de():z=!1}}}var de;if(typeof V=="function")de=function(){V(fe)};else if(typeof MessageChannel<"u"){var Ie=new MessageChannel,je=Ie.port2;Ie.port1.onmessage=fe,de=function(){je.postMessage(null)}}else de=function(){C(fe,0)};function Me(_,oe){L=C(function(){_(n.unstable_now())},oe)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(_){_.callback=null},n.unstable_forceFrameRate=function(_){0>_||125<_?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):$=0<_?Math.floor(1e3/_):5},n.unstable_getCurrentPriorityLevel=function(){return w},n.unstable_next=function(_){switch(w){case 1:case 2:case 3:var oe=3;break;default:oe=w}var ce=w;w=oe;try{return _()}finally{w=ce}},n.unstable_requestPaint=function(){j=!0},n.unstable_runWithPriority=function(_,oe){switch(_){case 1:case 2:case 3:case 4:case 5:break;default:_=3}var ce=w;w=_;try{return oe()}finally{w=ce}},n.unstable_scheduleCallback=function(_,oe,ce){var Ke=n.unstable_now();switch(typeof ce=="object"&&ce!==null?(ce=ce.delay,ce=typeof ce=="number"&&0<ce?Ke+ce:Ke):ce=Ke,_){case 1:var Le=-1;break;case 2:Le=250;break;case 5:Le=1073741823;break;case 4:Le=1e4;break;default:Le=5e3}return Le=ce+Le,_={id:b++,callback:oe,priorityLevel:_,startTime:ce,expirationTime:Le,sortIndex:-1},ce>Ke?(_.sortIndex=ce,o(g,_),s(p)===null&&_===s(g)&&(S?(T(L),L=-1):S=!0,Me(R,ce-Ke))):(_.sortIndex=Le,o(p,_),N||k||(N=!0,z||(z=!0,de()))),_},n.unstable_shouldYield=ue,n.unstable_wrapCallback=function(_){var oe=w;return function(){var ce=w;w=oe;try{return _.apply(this,arguments)}finally{w=ce}}}})(Yd)),Yd}var m0;function L1(){return m0||(m0=1,Pd.exports=I1()),Pd.exports}var Qd={exports:{}},Un={};var g0;function A1(){if(g0)return Un;g0=1;var n=Zf();function o(p){var g="https://react.dev/errors/"+p;if(1<arguments.length){g+="?args[]="+encodeURIComponent(arguments[1]);for(var b=2;b<arguments.length;b++)g+="&args[]="+encodeURIComponent(arguments[b])}return"Minified React error #"+p+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(){}var l={d:{f:s,r:function(){throw Error(o(522))},D:s,C:s,L:s,m:s,X:s,S:s,M:s},p:0,findDOMNode:null},i=Symbol.for("react.portal");function c(p,g,b){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:x==null?null:""+x,children:p,containerInfo:g,implementation:b}}var f=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function m(p,g){if(p==="font")return"";if(typeof g=="string")return g==="use-credentials"?g:""}return Un.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=l,Un.createPortal=function(p,g){var b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!g||g.nodeType!==1&&g.nodeType!==9&&g.nodeType!==11)throw Error(o(299));return c(p,g,null,b)},Un.flushSync=function(p){var g=f.T,b=l.p;try{if(f.T=null,l.p=2,p)return p()}finally{f.T=g,l.p=b,l.d.f()}},Un.preconnect=function(p,g){typeof p=="string"&&(g?(g=g.crossOrigin,g=typeof g=="string"?g==="use-credentials"?g:"":void 0):g=null,l.d.C(p,g))},Un.prefetchDNS=function(p){typeof p=="string"&&l.d.D(p)},Un.preinit=function(p,g){if(typeof p=="string"&&g&&typeof g.as=="string"){var b=g.as,x=m(b,g.crossOrigin),w=typeof g.integrity=="string"?g.integrity:void 0,k=typeof g.fetchPriority=="string"?g.fetchPriority:void 0;b==="style"?l.d.S(p,typeof g.precedence=="string"?g.precedence:void 0,{crossOrigin:x,integrity:w,fetchPriority:k}):b==="script"&&l.d.X(p,{crossOrigin:x,integrity:w,fetchPriority:k,nonce:typeof g.nonce=="string"?g.nonce:void 0})}},Un.preinitModule=function(p,g){if(typeof p=="string")if(typeof g=="object"&&g!==null){if(g.as==null||g.as==="script"){var b=m(g.as,g.crossOrigin);l.d.M(p,{crossOrigin:b,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0})}}else g==null&&l.d.M(p)},Un.preload=function(p,g){if(typeof p=="string"&&typeof g=="object"&&g!==null&&typeof g.as=="string"){var b=g.as,x=m(b,g.crossOrigin);l.d.L(p,b,{crossOrigin:x,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0,type:typeof g.type=="string"?g.type:void 0,fetchPriority:typeof g.fetchPriority=="string"?g.fetchPriority:void 0,referrerPolicy:typeof g.referrerPolicy=="string"?g.referrerPolicy:void 0,imageSrcSet:typeof g.imageSrcSet=="string"?g.imageSrcSet:void 0,imageSizes:typeof g.imageSizes=="string"?g.imageSizes:void 0,media:typeof g.media=="string"?g.media:void 0})}},Un.preloadModule=function(p,g){if(typeof p=="string")if(g){var b=m(g.as,g.crossOrigin);l.d.m(p,{as:typeof g.as=="string"&&g.as!=="script"?g.as:void 0,crossOrigin:b,integrity:typeof g.integrity=="string"?g.integrity:void 0})}else l.d.m(p)},Un.requestFormReset=function(p){l.d.r(p)},Un.unstable_batchedUpdates=function(p,g){return p(g)},Un.useFormState=function(p,g,b){return f.H.useFormState(p,g,b)},Un.useFormStatus=function(){return f.H.useHostTransitionStatus()},Un.version="19.2.3",Un}var y0;function Yy(){if(y0)return Qd.exports;y0=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(o){console.error(o)}}return n(),Qd.exports=A1(),Qd.exports}var b0;function R1(){if(b0)return oa;b0=1;var n=L1(),o=Zf(),s=Yy();function l(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var r=2;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function c(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function f(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function m(e){if(e.tag===31){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function p(e){if(c(e)!==e)throw Error(l(188))}function g(e){var t=e.alternate;if(!t){if(t=c(e),t===null)throw Error(l(188));return t!==e?null:e}for(var r=e,a=t;;){var d=r.return;if(d===null)break;var h=d.alternate;if(h===null){if(a=d.return,a!==null){r=a;continue}break}if(d.child===h.child){for(h=d.child;h;){if(h===r)return p(d),e;if(h===a)return p(d),t;h=h.sibling}throw Error(l(188))}if(r.return!==a.return)r=d,a=h;else{for(var v=!1,O=d.child;O;){if(O===r){v=!0,r=d,a=h;break}if(O===a){v=!0,a=d,r=h;break}O=O.sibling}if(!v){for(O=h.child;O;){if(O===r){v=!0,r=h,a=d;break}if(O===a){v=!0,a=h,r=d;break}O=O.sibling}if(!v)throw Error(l(189))}}if(r.alternate!==a)throw Error(l(190))}if(r.tag!==3)throw Error(l(188));return r.stateNode.current===r?e:t}function b(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e;for(e=e.child;e!==null;){if(t=b(e),t!==null)return t;e=e.sibling}return null}var x=Object.assign,w=Symbol.for("react.element"),k=Symbol.for("react.transitional.element"),N=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),j=Symbol.for("react.strict_mode"),C=Symbol.for("react.profiler"),T=Symbol.for("react.consumer"),V=Symbol.for("react.context"),U=Symbol.for("react.forward_ref"),R=Symbol.for("react.suspense"),z=Symbol.for("react.suspense_list"),L=Symbol.for("react.memo"),$=Symbol.for("react.lazy"),Q=Symbol.for("react.activity"),ue=Symbol.for("react.memo_cache_sentinel"),fe=Symbol.iterator;function de(e){return e===null||typeof e!="object"?null:(e=fe&&e[fe]||e["@@iterator"],typeof e=="function"?e:null)}var Ie=Symbol.for("react.client.reference");function je(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===Ie?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case S:return"Fragment";case C:return"Profiler";case j:return"StrictMode";case R:return"Suspense";case z:return"SuspenseList";case Q:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case N:return"Portal";case V:return e.displayName||"Context";case T:return(e._context.displayName||"Context")+".Consumer";case U:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case L:return t=e.displayName||null,t!==null?t:je(e.type)||"Memo";case $:t=e._payload,e=e._init;try{return je(e(t))}catch{}}return null}var Me=Array.isArray,_=o.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,oe=s.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ce={pending:!1,data:null,method:null,action:null},Ke=[],Le=-1;function E(e){return{current:e}}function A(e){0>Le||(e.current=Ke[Le],Ke[Le]=null,Le--)}function M(e,t){Le++,Ke[Le]=e.current,e.current=t}var ee=E(null),Te=E(null),qe=E(null),ye=E(null);function Ne(e,t){switch(M(qe,t),M(Te,e),M(ee,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?Lg(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)t=Lg(t),e=Ag(t,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}A(ee),M(ee,e)}function H(){A(ee),A(Te),A(qe)}function Y(e){e.memoizedState!==null&&M(ye,e);var t=ee.current,r=Ag(t,e.type);t!==r&&(M(Te,e),M(ee,r))}function D(e){Te.current===e&&(A(ee),A(Te)),ye.current===e&&(A(ye),Zl._currentValue=ce)}var K,X;function W(e){if(K===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);K=t&&t[1]||"",X=-1<r.stack.indexOf(`
    at`)?" (<anonymous>)":-1<r.stack.indexOf("@")?"@unknown:0:0":""}return`
`+K+e+X}var Oe=!1;function be(e,t){if(!e||Oe)return"";Oe=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var a={DetermineComponentFrameRoot:function(){try{if(t){var ze=function(){throw Error()};if(Object.defineProperty(ze.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ze,[])}catch(Ce){var ve=Ce}Reflect.construct(e,[],ze)}else{try{ze.call()}catch(Ce){ve=Ce}e.call(ze.prototype)}}else{try{throw Error()}catch(Ce){ve=Ce}(ze=e())&&typeof ze.catch=="function"&&ze.catch(function(){})}}catch(Ce){if(Ce&&ve&&typeof Ce.stack=="string")return[Ce.stack,ve.stack]}return[null,null]}};a.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var d=Object.getOwnPropertyDescriptor(a.DetermineComponentFrameRoot,"name");d&&d.configurable&&Object.defineProperty(a.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var h=a.DetermineComponentFrameRoot(),v=h[0],O=h[1];if(v&&O){var G=v.split(`
`),ge=O.split(`
`);for(d=a=0;a<G.length&&!G[a].includes("DetermineComponentFrameRoot");)a++;for(;d<ge.length&&!ge[d].includes("DetermineComponentFrameRoot");)d++;if(a===G.length||d===ge.length)for(a=G.length-1,d=ge.length-1;1<=a&&0<=d&&G[a]!==ge[d];)d--;for(;1<=a&&0<=d;a--,d--)if(G[a]!==ge[d]){if(a!==1||d!==1)do if(a--,d--,0>d||G[a]!==ge[d]){var _e=`
`+G[a].replace(" at new "," at ");return e.displayName&&_e.includes("<anonymous>")&&(_e=_e.replace("<anonymous>",e.displayName)),_e}while(1<=a&&0<=d);break}}}finally{Oe=!1,Error.prepareStackTrace=r}return(r=e?e.displayName||e.name:"")?W(r):""}function ke(e,t){switch(e.tag){case 26:case 27:case 5:return W(e.type);case 16:return W("Lazy");case 13:return e.child!==t&&t!==null?W("Suspense Fallback"):W("Suspense");case 19:return W("SuspenseList");case 0:case 15:return be(e.type,!1);case 11:return be(e.type.render,!1);case 1:return be(e.type,!0);case 31:return W("Activity");default:return""}}function J(e){try{var t="",r=null;do t+=ke(e,r),r=e,e=e.return;while(e);return t}catch(a){return`
Error generating stack: `+a.message+`
`+a.stack}}var xe=Object.prototype.hasOwnProperty,I=n.unstable_scheduleCallback,B=n.unstable_cancelCallback,q=n.unstable_shouldYield,he=n.unstable_requestPaint,me=n.unstable_now,Se=n.unstable_getCurrentPriorityLevel,F=n.unstable_ImmediatePriority,ie=n.unstable_UserBlockingPriority,Ae=n.unstable_NormalPriority,Ue=n.unstable_LowPriority,Je=n.unstable_IdlePriority,Pe=n.log,st=n.unstable_setDisableYieldValue,$e=null,Fe=null;function at(e){if(typeof Pe=="function"&&st(e),Fe&&typeof Fe.setStrictMode=="function")try{Fe.setStrictMode($e,e)}catch{}}var ht=Math.clz32?Math.clz32:Pt,Lt=Math.log,Gt=Math.LN2;function Pt(e){return e>>>=0,e===0?32:31-(Lt(e)/Gt|0)|0}var $t=256,Ge=262144,He=4194304;function Ve(e){var t=e&42;if(t!==0)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function et(e,t,r){var a=e.pendingLanes;if(a===0)return 0;var d=0,h=e.suspendedLanes,v=e.pingedLanes;e=e.warmLanes;var O=a&134217727;return O!==0?(a=O&~h,a!==0?d=Ve(a):(v&=O,v!==0?d=Ve(v):r||(r=O&~e,r!==0&&(d=Ve(r))))):(O=a&~h,O!==0?d=Ve(O):v!==0?d=Ve(v):r||(r=a&~e,r!==0&&(d=Ve(r)))),d===0?0:t!==0&&t!==d&&(t&h)===0&&(h=d&-d,r=t&-t,h>=r||h===32&&(r&4194048)!==0)?t:d}function ft(e,t){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)===0}function St(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function zt(){var e=He;return He<<=1,(He&62914560)===0&&(He=4194304),e}function le(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function se(e,t){e.pendingLanes|=t,t!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function De(e,t,r,a,d,h){var v=e.pendingLanes;e.pendingLanes=r,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=r,e.entangledLanes&=r,e.errorRecoveryDisabledLanes&=r,e.shellSuspendCounter=0;var O=e.entanglements,G=e.expirationTimes,ge=e.hiddenUpdates;for(r=v&~r;0<r;){var _e=31-ht(r),ze=1<<_e;O[_e]=0,G[_e]=-1;var ve=ge[_e];if(ve!==null)for(ge[_e]=null,_e=0;_e<ve.length;_e++){var Ce=ve[_e];Ce!==null&&(Ce.lane&=-536870913)}r&=~ze}a!==0&&Ze(e,a,0),h!==0&&d===0&&e.tag!==0&&(e.suspendedLanes|=h&~(v&~t))}function Ze(e,t,r){e.pendingLanes|=t,e.suspendedLanes&=~t;var a=31-ht(t);e.entangledLanes|=t,e.entanglements[a]=e.entanglements[a]|1073741824|r&261930}function Qe(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var a=31-ht(r),d=1<<a;d&t|e[a]&t&&(e[a]|=t),r&=~d}}function rt(e,t){var r=t&-t;return r=(r&42)!==0?1:Re(r),(r&(e.suspendedLanes|t))!==0?0:r}function Re(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function gt(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function bt(){var e=oe.p;return e!==0?e:(e=window.event,e===void 0?32:n0(e.type))}function it(e,t){var r=oe.p;try{return oe.p=e,t()}finally{oe.p=r}}var xt=Math.random().toString(36).slice(2),Nt="__reactFiber$"+xt,ct="__reactProps$"+xt,jt="__reactContainer$"+xt,pt="__reactEvents$"+xt,At="__reactListeners$"+xt,tn="__reactHandles$"+xt,In="__reactResources$"+xt,cn="__reactMarker$"+xt;function P(e){delete e[Nt],delete e[ct],delete e[pt],delete e[At],delete e[tn]}function Ee(e){var t=e[Nt];if(t)return t;for(var r=e.parentNode;r;){if(t=r[jt]||r[Nt]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Vg(e);e!==null;){if(r=e[Nt])return r;e=Vg(e)}return t}e=r,r=e.parentNode}return null}function ne(e){if(e=e[Nt]||e[jt]){var t=e.tag;if(t===5||t===6||t===13||t===31||t===26||t===27||t===3)return e}return null}function ot(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e.stateNode;throw Error(l(33))}function tt(e){var t=e[In];return t||(t=e[In]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function Xe(e){e[cn]=!0}var Ye=new Set,te={};function We(e,t){nt(e,t),nt(e+"Capture",t)}function nt(e,t){for(te[e]=t,e=0;e<t.length;e++)Ye.add(t[e])}var ut=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),_t={},nn={};function Ln(e){return xe.call(nn,e)?!0:xe.call(_t,e)?!1:ut.test(e)?nn[e]=!0:(_t[e]=!0,!1)}function an(e,t,r){if(Ln(t))if(r===null)e.removeAttribute(t);else{switch(typeof r){case"undefined":case"function":case"symbol":e.removeAttribute(t);return;case"boolean":var a=t.toLowerCase().slice(0,5);if(a!=="data-"&&a!=="aria-"){e.removeAttribute(t);return}}e.setAttribute(t,""+r)}}function An(e,t,r){if(r===null)e.removeAttribute(t);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttribute(t,""+r)}}function Sn(e,t,r,a){if(a===null)e.removeAttribute(r);else{switch(typeof a){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(r);return}e.setAttributeNS(t,r,""+a)}}function Nn(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Ea(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Uu(e,t,r){var a=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&typeof a<"u"&&typeof a.get=="function"&&typeof a.set=="function"){var d=a.get,h=a.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return d.call(this)},set:function(v){r=""+v,h.call(this,v)}}),Object.defineProperty(e,t,{enumerable:a.enumerable}),{getValue:function(){return r},setValue:function(v){r=""+v},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function fl(e){if(!e._valueTracker){var t=Ea(e)?"checked":"value";e._valueTracker=Uu(e,t,""+e[t])}}function Ia(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),a="";return e&&(a=Ea(e)?e.checked?"true":"false":e.value),e=a,e!==r?(t.setValue(e),!0):!1}function Qo(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var La=/[\n"\\]/g;function Kn(e){return e.replace(La,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function pl(e,t,r,a,d,h,v,O){e.name="",v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"?e.type=v:e.removeAttribute("type"),t!=null?v==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+Nn(t)):e.value!==""+Nn(t)&&(e.value=""+Nn(t)):v!=="submit"&&v!=="reset"||e.removeAttribute("value"),t!=null?xs(e,v,Nn(t)):r!=null?xs(e,v,Nn(r)):a!=null&&e.removeAttribute("value"),d==null&&h!=null&&(e.defaultChecked=!!h),d!=null&&(e.checked=d&&typeof d!="function"&&typeof d!="symbol"),O!=null&&typeof O!="function"&&typeof O!="symbol"&&typeof O!="boolean"?e.name=""+Nn(O):e.removeAttribute("name")}function Aa(e,t,r,a,d,h,v,O){if(h!=null&&typeof h!="function"&&typeof h!="symbol"&&typeof h!="boolean"&&(e.type=h),t!=null||r!=null){if(!(h!=="submit"&&h!=="reset"||t!=null)){fl(e);return}r=r!=null?""+Nn(r):"",t=t!=null?""+Nn(t):r,O||t===e.value||(e.value=t),e.defaultValue=t}a=a??d,a=typeof a!="function"&&typeof a!="symbol"&&!!a,e.checked=O?e.checked:!!a,e.defaultChecked=!!a,v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(e.name=v),fl(e)}function xs(e,t,r){t==="number"&&Qo(e.ownerDocument)===e||e.defaultValue===""+r||(e.defaultValue=""+r)}function ro(e,t,r,a){if(e=e.options,t){t={};for(var d=0;d<r.length;d++)t["$"+r[d]]=!0;for(r=0;r<e.length;r++)d=t.hasOwnProperty("$"+e[r].value),e[r].selected!==d&&(e[r].selected=d),d&&a&&(e[r].defaultSelected=!0)}else{for(r=""+Nn(r),t=null,d=0;d<e.length;d++){if(e[d].value===r){e[d].selected=!0,a&&(e[d].defaultSelected=!0);return}t!==null||e[d].disabled||(t=e[d])}t!==null&&(t.selected=!0)}}function Ra(e,t,r){if(t!=null&&(t=""+Nn(t),t!==e.value&&(e.value=t),r==null)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=r!=null?""+Nn(r):""}function _a(e,t,r,a){if(t==null){if(a!=null){if(r!=null)throw Error(l(92));if(Me(a)){if(1<a.length)throw Error(l(93));a=a[0]}r=a}r==null&&(r=""),t=r}r=Nn(t),e.defaultValue=r,a=e.textContent,a===r&&a!==""&&a!==null&&(e.value=a),fl(e)}function wr(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var $u=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function we(e,t,r){var a=t.indexOf("--")===0;r==null||typeof r=="boolean"||r===""?a?e.setProperty(t,""):t==="float"?e.cssFloat="":e[t]="":a?e.setProperty(t,r):typeof r!="number"||r===0||$u.has(t)?t==="float"?e.cssFloat=r:e[t]=(""+r).trim():e[t]=r+"px"}function lt(e,t,r){if(t!=null&&typeof t!="object")throw Error(l(62));if(e=e.style,r!=null){for(var a in r)!r.hasOwnProperty(a)||t!=null&&t.hasOwnProperty(a)||(a.indexOf("--")===0?e.setProperty(a,""):a==="float"?e.cssFloat="":e[a]="");for(var d in t)a=t[d],t.hasOwnProperty(d)&&r[d]!==a&&we(e,d,a)}else for(var h in t)t.hasOwnProperty(h)&&we(e,h,t[h])}function yt(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var fn=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Cn=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ht(e){return Cn.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function yo(){}var hl=null;function Yr(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var vs=null,ws=null;function Ip(e){var t=ne(e);if(t&&(e=t.stateNode)){var r=e[ct]||null;e:switch(e=t.stateNode,t.type){case"input":if(pl(e,r.value,r.defaultValue,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll('input[name="'+Kn(""+t)+'"][type="radio"]'),t=0;t<r.length;t++){var a=r[t];if(a!==e&&a.form===e.form){var d=a[ct]||null;if(!d)throw Error(l(90));pl(a,d.value,d.defaultValue,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name)}}for(t=0;t<r.length;t++)a=r[t],a.form===e.form&&Ia(a)}break e;case"textarea":Ra(e,r.value,r.defaultValue);break e;case"select":t=r.value,t!=null&&ro(e,!!r.multiple,t,!1)}}}var Fu=!1;function Lp(e,t,r){if(Fu)return e(t,r);Fu=!0;try{var a=e(t);return a}finally{if(Fu=!1,(vs!==null||ws!==null)&&(Si(),vs&&(t=vs,e=ws,ws=vs=null,Ip(t),e)))for(t=0;t<e.length;t++)Ip(e[t])}}function ml(e,t){var r=e.stateNode;if(r===null)return null;var a=r[ct]||null;if(a===null)return null;r=a[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(a=!a.disabled)||(e=e.type,a=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!a;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(l(231,t,typeof r));return r}var Xo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),qu=!1;if(Xo)try{var gl={};Object.defineProperty(gl,"passive",{get:function(){qu=!0}}),window.addEventListener("test",gl,gl),window.removeEventListener("test",gl,gl)}catch{qu=!1}var Sr=null,Wu=null,Da=null;function Ap(){if(Da)return Da;var e,t=Wu,r=t.length,a,d="value"in Sr?Sr.value:Sr.textContent,h=d.length;for(e=0;e<r&&t[e]===d[e];e++);var v=r-e;for(a=1;a<=v&&t[r-a]===d[h-a];a++);return Da=d.slice(e,1<a?1-a:void 0)}function Ba(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function za(){return!0}function Rp(){return!1}function Yn(e){function t(r,a,d,h,v){this._reactName=r,this._targetInst=d,this.type=a,this.nativeEvent=h,this.target=v,this.currentTarget=null;for(var O in e)e.hasOwnProperty(O)&&(r=e[O],this[O]=r?r(h):h[O]);return this.isDefaultPrevented=(h.defaultPrevented!=null?h.defaultPrevented:h.returnValue===!1)?za:Rp,this.isPropagationStopped=Rp,this}return x(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=za)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=za)},persist:function(){},isPersistent:za}),t}var Qr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ha=Yn(Qr),yl=x({},Qr,{view:0,detail:0}),Cx=Yn(yl),Gu,Pu,bl,Va=x({},yl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Qu,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==bl&&(bl&&e.type==="mousemove"?(Gu=e.screenX-bl.screenX,Pu=e.screenY-bl.screenY):Pu=Gu=0,bl=e),Gu)},movementY:function(e){return"movementY"in e?e.movementY:Pu}}),_p=Yn(Va),kx=x({},Va,{dataTransfer:0}),jx=Yn(kx),Mx=x({},yl,{relatedTarget:0}),Yu=Yn(Mx),Ox=x({},Qr,{animationName:0,elapsedTime:0,pseudoElement:0}),Tx=Yn(Ox),Ex=x({},Qr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Ix=Yn(Ex),Lx=x({},Qr,{data:0}),Dp=Yn(Lx),Ax={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Rx={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_x={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Dx(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=_x[e])?!!t[e]:!1}function Qu(){return Dx}var Bx=x({},yl,{key:function(e){if(e.key){var t=Ax[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Ba(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Rx[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Qu,charCode:function(e){return e.type==="keypress"?Ba(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Ba(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),zx=Yn(Bx),Hx=x({},Va,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Bp=Yn(Hx),Vx=x({},yl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Qu}),Kx=Yn(Vx),Ux=x({},Qr,{propertyName:0,elapsedTime:0,pseudoElement:0}),$x=Yn(Ux),Fx=x({},Va,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),qx=Yn(Fx),Wx=x({},Qr,{newState:0,oldState:0}),Gx=Yn(Wx),Px=[9,13,27,32],Xu=Xo&&"CompositionEvent"in window,xl=null;Xo&&"documentMode"in document&&(xl=document.documentMode);var Yx=Xo&&"TextEvent"in window&&!xl,zp=Xo&&(!Xu||xl&&8<xl&&11>=xl),Hp=" ",Vp=!1;function Kp(e,t){switch(e){case"keyup":return Px.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Up(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Ss=!1;function Qx(e,t){switch(e){case"compositionend":return Up(t);case"keypress":return t.which!==32?null:(Vp=!0,Hp);case"textInput":return e=t.data,e===Hp&&Vp?null:e;default:return null}}function Xx(e,t){if(Ss)return e==="compositionend"||!Xu&&Kp(e,t)?(e=Ap(),Da=Wu=Sr=null,Ss=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return zp&&t.locale!=="ko"?null:t.data;default:return null}}var Zx={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function $p(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Zx[e.type]:t==="textarea"}function Fp(e,t,r,a){vs?ws?ws.push(a):ws=[a]:vs=a,t=Ti(t,"onChange"),0<t.length&&(r=new Ha("onChange","change",null,r,a),e.push({event:r,listeners:t}))}var vl=null,wl=null;function Jx(e){jg(e,0)}function Ka(e){var t=ot(e);if(Ia(t))return e}function qp(e,t){if(e==="change")return t}var Wp=!1;if(Xo){var Zu;if(Xo){var Ju="oninput"in document;if(!Ju){var Gp=document.createElement("div");Gp.setAttribute("oninput","return;"),Ju=typeof Gp.oninput=="function"}Zu=Ju}else Zu=!1;Wp=Zu&&(!document.documentMode||9<document.documentMode)}function Pp(){vl&&(vl.detachEvent("onpropertychange",Yp),wl=vl=null)}function Yp(e){if(e.propertyName==="value"&&Ka(wl)){var t=[];Fp(t,wl,e,Yr(e)),Lp(Jx,t)}}function ev(e,t,r){e==="focusin"?(Pp(),vl=t,wl=r,vl.attachEvent("onpropertychange",Yp)):e==="focusout"&&Pp()}function tv(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Ka(wl)}function nv(e,t){if(e==="click")return Ka(t)}function ov(e,t){if(e==="input"||e==="change")return Ka(t)}function rv(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var so=typeof Object.is=="function"?Object.is:rv;function Sl(e,t){if(so(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),a=Object.keys(t);if(r.length!==a.length)return!1;for(a=0;a<r.length;a++){var d=r[a];if(!xe.call(t,d)||!so(e[d],t[d]))return!1}return!0}function Qp(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Xp(e,t){var r=Qp(e);e=0;for(var a;r;){if(r.nodeType===3){if(a=e+r.textContent.length,e<=t&&a>=t)return{node:r,offset:t-e};e=a}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Qp(r)}}function Zp(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Zp(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Jp(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var t=Qo(e.document);t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Qo(e.document)}return t}function ec(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}var sv=Xo&&"documentMode"in document&&11>=document.documentMode,Ns=null,tc=null,Nl=null,nc=!1;function eh(e,t,r){var a=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;nc||Ns==null||Ns!==Qo(a)||(a=Ns,"selectionStart"in a&&ec(a)?a={start:a.selectionStart,end:a.selectionEnd}:(a=(a.ownerDocument&&a.ownerDocument.defaultView||window).getSelection(),a={anchorNode:a.anchorNode,anchorOffset:a.anchorOffset,focusNode:a.focusNode,focusOffset:a.focusOffset}),Nl&&Sl(Nl,a)||(Nl=a,a=Ti(tc,"onSelect"),0<a.length&&(t=new Ha("onSelect","select",null,t,r),e.push({event:t,listeners:a}),t.target=Ns)))}function Xr(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Cs={animationend:Xr("Animation","AnimationEnd"),animationiteration:Xr("Animation","AnimationIteration"),animationstart:Xr("Animation","AnimationStart"),transitionrun:Xr("Transition","TransitionRun"),transitionstart:Xr("Transition","TransitionStart"),transitioncancel:Xr("Transition","TransitionCancel"),transitionend:Xr("Transition","TransitionEnd")},oc={},th={};Xo&&(th=document.createElement("div").style,"AnimationEvent"in window||(delete Cs.animationend.animation,delete Cs.animationiteration.animation,delete Cs.animationstart.animation),"TransitionEvent"in window||delete Cs.transitionend.transition);function Zr(e){if(oc[e])return oc[e];if(!Cs[e])return e;var t=Cs[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in th)return oc[e]=t[r];return e}var nh=Zr("animationend"),oh=Zr("animationiteration"),rh=Zr("animationstart"),lv=Zr("transitionrun"),av=Zr("transitionstart"),iv=Zr("transitioncancel"),sh=Zr("transitionend"),lh=new Map,rc="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");rc.push("scrollEnd");function To(e,t){lh.set(e,t),We(t,[e])}var Ua=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},bo=[],ks=0,sc=0;function $a(){for(var e=ks,t=sc=ks=0;t<e;){var r=bo[t];bo[t++]=null;var a=bo[t];bo[t++]=null;var d=bo[t];bo[t++]=null;var h=bo[t];if(bo[t++]=null,a!==null&&d!==null){var v=a.pending;v===null?d.next=d:(d.next=v.next,v.next=d),a.pending=d}h!==0&&ah(r,d,h)}}function Fa(e,t,r,a){bo[ks++]=e,bo[ks++]=t,bo[ks++]=r,bo[ks++]=a,sc|=a,e.lanes|=a,e=e.alternate,e!==null&&(e.lanes|=a)}function lc(e,t,r,a){return Fa(e,t,r,a),qa(e)}function Jr(e,t){return Fa(e,null,null,t),qa(e)}function ah(e,t,r){e.lanes|=r;var a=e.alternate;a!==null&&(a.lanes|=r);for(var d=!1,h=e.return;h!==null;)h.childLanes|=r,a=h.alternate,a!==null&&(a.childLanes|=r),h.tag===22&&(e=h.stateNode,e===null||e._visibility&1||(d=!0)),e=h,h=h.return;return e.tag===3?(h=e.stateNode,d&&t!==null&&(d=31-ht(r),e=h.hiddenUpdates,a=e[d],a===null?e[d]=[t]:a.push(t),t.lane=r|536870912),h):null}function qa(e){if(50<ql)throw ql=0,md=null,Error(l(185));for(var t=e.return;t!==null;)e=t,t=e.return;return e.tag===3?e.stateNode:null}var js={};function uv(e,t,r,a){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=a,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function lo(e,t,r,a){return new uv(e,t,r,a)}function ac(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Zo(e,t){var r=e.alternate;return r===null?(r=lo(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&65011712,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r.refCleanup=e.refCleanup,r}function ih(e,t){e.flags&=65011714;var r=e.alternate;return r===null?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=r.childLanes,e.lanes=r.lanes,e.child=r.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=r.memoizedProps,e.memoizedState=r.memoizedState,e.updateQueue=r.updateQueue,e.type=r.type,t=r.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Wa(e,t,r,a,d,h){var v=0;if(a=e,typeof e=="function")ac(e)&&(v=1);else if(typeof e=="string")v=h1(e,r,ee.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case Q:return e=lo(31,r,t,d),e.elementType=Q,e.lanes=h,e;case S:return es(r.children,d,h,t);case j:v=8,d|=24;break;case C:return e=lo(12,r,t,d|2),e.elementType=C,e.lanes=h,e;case R:return e=lo(13,r,t,d),e.elementType=R,e.lanes=h,e;case z:return e=lo(19,r,t,d),e.elementType=z,e.lanes=h,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case V:v=10;break e;case T:v=9;break e;case U:v=11;break e;case L:v=14;break e;case $:v=16,a=null;break e}v=29,r=Error(l(130,e===null?"null":typeof e,"")),a=null}return t=lo(v,r,t,d),t.elementType=e,t.type=a,t.lanes=h,t}function es(e,t,r,a){return e=lo(7,e,a,t),e.lanes=r,e}function ic(e,t,r){return e=lo(6,e,null,t),e.lanes=r,e}function uh(e){var t=lo(18,null,null,0);return t.stateNode=e,t}function uc(e,t,r){return t=lo(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var ch=new WeakMap;function xo(e,t){if(typeof e=="object"&&e!==null){var r=ch.get(e);return r!==void 0?r:(t={value:e,source:t,stack:J(t)},ch.set(e,t),t)}return{value:e,source:t,stack:J(t)}}var Ms=[],Os=0,Ga=null,Cl=0,vo=[],wo=0,Nr=null,Ho=1,Vo="";function Jo(e,t){Ms[Os++]=Cl,Ms[Os++]=Ga,Ga=e,Cl=t}function dh(e,t,r){vo[wo++]=Ho,vo[wo++]=Vo,vo[wo++]=Nr,Nr=e;var a=Ho;e=Vo;var d=32-ht(a)-1;a&=~(1<<d),r+=1;var h=32-ht(t)+d;if(30<h){var v=d-d%5;h=(a&(1<<v)-1).toString(32),a>>=v,d-=v,Ho=1<<32-ht(t)+d|r<<d|a,Vo=h+e}else Ho=1<<h|r<<d|a,Vo=e}function cc(e){e.return!==null&&(Jo(e,1),dh(e,1,0))}function dc(e){for(;e===Ga;)Ga=Ms[--Os],Ms[Os]=null,Cl=Ms[--Os],Ms[Os]=null;for(;e===Nr;)Nr=vo[--wo],vo[wo]=null,Vo=vo[--wo],vo[wo]=null,Ho=vo[--wo],vo[wo]=null}function fh(e,t){vo[wo++]=Ho,vo[wo++]=Vo,vo[wo++]=Nr,Ho=t.id,Vo=t.overflow,Nr=e}var Dn=null,pn=null,Ut=!1,Cr=null,So=!1,fc=Error(l(519));function kr(e){var t=Error(l(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw kl(xo(t,e)),fc}function ph(e){var t=e.stateNode,r=e.type,a=e.memoizedProps;switch(t[Nt]=e,t[ct]=a,r){case"dialog":Bt("cancel",t),Bt("close",t);break;case"iframe":case"object":case"embed":Bt("load",t);break;case"video":case"audio":for(r=0;r<Gl.length;r++)Bt(Gl[r],t);break;case"source":Bt("error",t);break;case"img":case"image":case"link":Bt("error",t),Bt("load",t);break;case"details":Bt("toggle",t);break;case"input":Bt("invalid",t),Aa(t,a.value,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name,!0);break;case"select":Bt("invalid",t);break;case"textarea":Bt("invalid",t),_a(t,a.value,a.defaultValue,a.children)}r=a.children,typeof r!="string"&&typeof r!="number"&&typeof r!="bigint"||t.textContent===""+r||a.suppressHydrationWarning===!0||Eg(t.textContent,r)?(a.popover!=null&&(Bt("beforetoggle",t),Bt("toggle",t)),a.onScroll!=null&&Bt("scroll",t),a.onScrollEnd!=null&&Bt("scrollend",t),a.onClick!=null&&(t.onclick=yo),t=!0):t=!1,t||kr(e,!0)}function hh(e){for(Dn=e.return;Dn;)switch(Dn.tag){case 5:case 31:case 13:So=!1;return;case 27:case 3:So=!0;return;default:Dn=Dn.return}}function Ts(e){if(e!==Dn)return!1;if(!Ut)return hh(e),Ut=!0,!1;var t=e.tag,r;if((r=t!==3&&t!==27)&&((r=t===5)&&(r=e.type,r=!(r!=="form"&&r!=="button")||Ed(e.type,e.memoizedProps)),r=!r),r&&pn&&kr(e),hh(e),t===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(l(317));pn=Hg(e)}else if(t===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(l(317));pn=Hg(e)}else t===27?(t=pn,Hr(e.type)?(e=_d,_d=null,pn=e):pn=t):pn=Dn?Co(e.stateNode.nextSibling):null;return!0}function ts(){pn=Dn=null,Ut=!1}function pc(){var e=Cr;return e!==null&&(Jn===null?Jn=e:Jn.push.apply(Jn,e),Cr=null),e}function kl(e){Cr===null?Cr=[e]:Cr.push(e)}var hc=E(null),ns=null,er=null;function jr(e,t,r){M(hc,t._currentValue),t._currentValue=r}function tr(e){e._currentValue=hc.current,A(hc)}function mc(e,t,r){for(;e!==null;){var a=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,a!==null&&(a.childLanes|=t)):a!==null&&(a.childLanes&t)!==t&&(a.childLanes|=t),e===r)break;e=e.return}}function gc(e,t,r,a){var d=e.child;for(d!==null&&(d.return=e);d!==null;){var h=d.dependencies;if(h!==null){var v=d.child;h=h.firstContext;e:for(;h!==null;){var O=h;h=d;for(var G=0;G<t.length;G++)if(O.context===t[G]){h.lanes|=r,O=h.alternate,O!==null&&(O.lanes|=r),mc(h.return,r,e),a||(v=null);break e}h=O.next}}else if(d.tag===18){if(v=d.return,v===null)throw Error(l(341));v.lanes|=r,h=v.alternate,h!==null&&(h.lanes|=r),mc(v,r,e),v=null}else v=d.child;if(v!==null)v.return=d;else for(v=d;v!==null;){if(v===e){v=null;break}if(d=v.sibling,d!==null){d.return=v.return,v=d;break}v=v.return}d=v}}function Es(e,t,r,a){e=null;for(var d=t,h=!1;d!==null;){if(!h){if((d.flags&524288)!==0)h=!0;else if((d.flags&262144)!==0)break}if(d.tag===10){var v=d.alternate;if(v===null)throw Error(l(387));if(v=v.memoizedProps,v!==null){var O=d.type;so(d.pendingProps.value,v.value)||(e!==null?e.push(O):e=[O])}}else if(d===ye.current){if(v=d.alternate,v===null)throw Error(l(387));v.memoizedState.memoizedState!==d.memoizedState.memoizedState&&(e!==null?e.push(Zl):e=[Zl])}d=d.return}e!==null&&gc(t,e,r,a),t.flags|=262144}function Pa(e){for(e=e.firstContext;e!==null;){if(!so(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function os(e){ns=e,er=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function Bn(e){return mh(ns,e)}function Ya(e,t){return ns===null&&os(e),mh(e,t)}function mh(e,t){var r=t._currentValue;if(t={context:t,memoizedValue:r,next:null},er===null){if(e===null)throw Error(l(308));er=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else er=er.next=t;return r}var cv=typeof AbortController<"u"?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(r,a){e.push(a)}};this.abort=function(){t.aborted=!0,e.forEach(function(r){return r()})}},dv=n.unstable_scheduleCallback,fv=n.unstable_NormalPriority,kn={$$typeof:V,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function yc(){return{controller:new cv,data:new Map,refCount:0}}function jl(e){e.refCount--,e.refCount===0&&dv(fv,function(){e.controller.abort()})}var Ml=null,bc=0,Is=0,Ls=null;function pv(e,t){if(Ml===null){var r=Ml=[];bc=0,Is=wd(),Ls={status:"pending",value:void 0,then:function(a){r.push(a)}}}return bc++,t.then(gh,gh),t}function gh(){if(--bc===0&&Ml!==null){Ls!==null&&(Ls.status="fulfilled");var e=Ml;Ml=null,Is=0,Ls=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function hv(e,t){var r=[],a={status:"pending",value:null,reason:null,then:function(d){r.push(d)}};return e.then(function(){a.status="fulfilled",a.value=t;for(var d=0;d<r.length;d++)(0,r[d])(t)},function(d){for(a.status="rejected",a.reason=d,d=0;d<r.length;d++)(0,r[d])(void 0)}),a}var yh=_.S;_.S=function(e,t){eg=me(),typeof t=="object"&&t!==null&&typeof t.then=="function"&&pv(e,t),yh!==null&&yh(e,t)};var rs=E(null);function xc(){var e=rs.current;return e!==null?e:un.pooledCache}function Qa(e,t){t===null?M(rs,rs.current):M(rs,t.pool)}function bh(){var e=xc();return e===null?null:{parent:kn._currentValue,pool:e}}var As=Error(l(460)),vc=Error(l(474)),Xa=Error(l(542)),Za={then:function(){}};function xh(e){return e=e.status,e==="fulfilled"||e==="rejected"}function vh(e,t,r){switch(r=e[r],r===void 0?e.push(t):r!==t&&(t.then(yo,yo),t=r),t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,Sh(e),e;default:if(typeof t.status=="string")t.then(yo,yo);else{if(e=un,e!==null&&100<e.shellSuspendCounter)throw Error(l(482));e=t,e.status="pending",e.then(function(a){if(t.status==="pending"){var d=t;d.status="fulfilled",d.value=a}},function(a){if(t.status==="pending"){var d=t;d.status="rejected",d.reason=a}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,Sh(e),e}throw ls=t,As}}function ss(e){try{var t=e._init;return t(e._payload)}catch(r){throw r!==null&&typeof r=="object"&&typeof r.then=="function"?(ls=r,As):r}}var ls=null;function wh(){if(ls===null)throw Error(l(459));var e=ls;return ls=null,e}function Sh(e){if(e===As||e===Xa)throw Error(l(483))}var Rs=null,Ol=0;function Ja(e){var t=Ol;return Ol+=1,Rs===null&&(Rs=[]),vh(Rs,e,t)}function Tl(e,t){t=t.props.ref,e.ref=t!==void 0?t:null}function ei(e,t){throw t.$$typeof===w?Error(l(525)):(e=Object.prototype.toString.call(t),Error(l(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)))}function Nh(e){function t(re,Z){if(e){var pe=re.deletions;pe===null?(re.deletions=[Z],re.flags|=16):pe.push(Z)}}function r(re,Z){if(!e)return null;for(;Z!==null;)t(re,Z),Z=Z.sibling;return null}function a(re){for(var Z=new Map;re!==null;)re.key!==null?Z.set(re.key,re):Z.set(re.index,re),re=re.sibling;return Z}function d(re,Z){return re=Zo(re,Z),re.index=0,re.sibling=null,re}function h(re,Z,pe){return re.index=pe,e?(pe=re.alternate,pe!==null?(pe=pe.index,pe<Z?(re.flags|=67108866,Z):pe):(re.flags|=67108866,Z)):(re.flags|=1048576,Z)}function v(re){return e&&re.alternate===null&&(re.flags|=67108866),re}function O(re,Z,pe,Be){return Z===null||Z.tag!==6?(Z=ic(pe,re.mode,Be),Z.return=re,Z):(Z=d(Z,pe),Z.return=re,Z)}function G(re,Z,pe,Be){var vt=pe.type;return vt===S?_e(re,Z,pe.props.children,Be,pe.key):Z!==null&&(Z.elementType===vt||typeof vt=="object"&&vt!==null&&vt.$$typeof===$&&ss(vt)===Z.type)?(Z=d(Z,pe.props),Tl(Z,pe),Z.return=re,Z):(Z=Wa(pe.type,pe.key,pe.props,null,re.mode,Be),Tl(Z,pe),Z.return=re,Z)}function ge(re,Z,pe,Be){return Z===null||Z.tag!==4||Z.stateNode.containerInfo!==pe.containerInfo||Z.stateNode.implementation!==pe.implementation?(Z=uc(pe,re.mode,Be),Z.return=re,Z):(Z=d(Z,pe.children||[]),Z.return=re,Z)}function _e(re,Z,pe,Be,vt){return Z===null||Z.tag!==7?(Z=es(pe,re.mode,Be,vt),Z.return=re,Z):(Z=d(Z,pe),Z.return=re,Z)}function ze(re,Z,pe){if(typeof Z=="string"&&Z!==""||typeof Z=="number"||typeof Z=="bigint")return Z=ic(""+Z,re.mode,pe),Z.return=re,Z;if(typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case k:return pe=Wa(Z.type,Z.key,Z.props,null,re.mode,pe),Tl(pe,Z),pe.return=re,pe;case N:return Z=uc(Z,re.mode,pe),Z.return=re,Z;case $:return Z=ss(Z),ze(re,Z,pe)}if(Me(Z)||de(Z))return Z=es(Z,re.mode,pe,null),Z.return=re,Z;if(typeof Z.then=="function")return ze(re,Ja(Z),pe);if(Z.$$typeof===V)return ze(re,Ya(re,Z),pe);ei(re,Z)}return null}function ve(re,Z,pe,Be){var vt=Z!==null?Z.key:null;if(typeof pe=="string"&&pe!==""||typeof pe=="number"||typeof pe=="bigint")return vt!==null?null:O(re,Z,""+pe,Be);if(typeof pe=="object"&&pe!==null){switch(pe.$$typeof){case k:return pe.key===vt?G(re,Z,pe,Be):null;case N:return pe.key===vt?ge(re,Z,pe,Be):null;case $:return pe=ss(pe),ve(re,Z,pe,Be)}if(Me(pe)||de(pe))return vt!==null?null:_e(re,Z,pe,Be,null);if(typeof pe.then=="function")return ve(re,Z,Ja(pe),Be);if(pe.$$typeof===V)return ve(re,Z,Ya(re,pe),Be);ei(re,pe)}return null}function Ce(re,Z,pe,Be,vt){if(typeof Be=="string"&&Be!==""||typeof Be=="number"||typeof Be=="bigint")return re=re.get(pe)||null,O(Z,re,""+Be,vt);if(typeof Be=="object"&&Be!==null){switch(Be.$$typeof){case k:return re=re.get(Be.key===null?pe:Be.key)||null,G(Z,re,Be,vt);case N:return re=re.get(Be.key===null?pe:Be.key)||null,ge(Z,re,Be,vt);case $:return Be=ss(Be),Ce(re,Z,pe,Be,vt)}if(Me(Be)||de(Be))return re=re.get(pe)||null,_e(Z,re,Be,vt,null);if(typeof Be.then=="function")return Ce(re,Z,pe,Ja(Be),vt);if(Be.$$typeof===V)return Ce(re,Z,pe,Ya(Z,Be),vt);ei(Z,Be)}return null}function dt(re,Z,pe,Be){for(var vt=null,Ft=null,mt=Z,Rt=Z=0,Kt=null;mt!==null&&Rt<pe.length;Rt++){mt.index>Rt?(Kt=mt,mt=null):Kt=mt.sibling;var qt=ve(re,mt,pe[Rt],Be);if(qt===null){mt===null&&(mt=Kt);break}e&&mt&&qt.alternate===null&&t(re,mt),Z=h(qt,Z,Rt),Ft===null?vt=qt:Ft.sibling=qt,Ft=qt,mt=Kt}if(Rt===pe.length)return r(re,mt),Ut&&Jo(re,Rt),vt;if(mt===null){for(;Rt<pe.length;Rt++)mt=ze(re,pe[Rt],Be),mt!==null&&(Z=h(mt,Z,Rt),Ft===null?vt=mt:Ft.sibling=mt,Ft=mt);return Ut&&Jo(re,Rt),vt}for(mt=a(mt);Rt<pe.length;Rt++)Kt=Ce(mt,re,Rt,pe[Rt],Be),Kt!==null&&(e&&Kt.alternate!==null&&mt.delete(Kt.key===null?Rt:Kt.key),Z=h(Kt,Z,Rt),Ft===null?vt=Kt:Ft.sibling=Kt,Ft=Kt);return e&&mt.forEach(function(Fr){return t(re,Fr)}),Ut&&Jo(re,Rt),vt}function kt(re,Z,pe,Be){if(pe==null)throw Error(l(151));for(var vt=null,Ft=null,mt=Z,Rt=Z=0,Kt=null,qt=pe.next();mt!==null&&!qt.done;Rt++,qt=pe.next()){mt.index>Rt?(Kt=mt,mt=null):Kt=mt.sibling;var Fr=ve(re,mt,qt.value,Be);if(Fr===null){mt===null&&(mt=Kt);break}e&&mt&&Fr.alternate===null&&t(re,mt),Z=h(Fr,Z,Rt),Ft===null?vt=Fr:Ft.sibling=Fr,Ft=Fr,mt=Kt}if(qt.done)return r(re,mt),Ut&&Jo(re,Rt),vt;if(mt===null){for(;!qt.done;Rt++,qt=pe.next())qt=ze(re,qt.value,Be),qt!==null&&(Z=h(qt,Z,Rt),Ft===null?vt=qt:Ft.sibling=qt,Ft=qt);return Ut&&Jo(re,Rt),vt}for(mt=a(mt);!qt.done;Rt++,qt=pe.next())qt=Ce(mt,re,Rt,qt.value,Be),qt!==null&&(e&&qt.alternate!==null&&mt.delete(qt.key===null?Rt:qt.key),Z=h(qt,Z,Rt),Ft===null?vt=qt:Ft.sibling=qt,Ft=qt);return e&&mt.forEach(function(k1){return t(re,k1)}),Ut&&Jo(re,Rt),vt}function sn(re,Z,pe,Be){if(typeof pe=="object"&&pe!==null&&pe.type===S&&pe.key===null&&(pe=pe.props.children),typeof pe=="object"&&pe!==null){switch(pe.$$typeof){case k:e:{for(var vt=pe.key;Z!==null;){if(Z.key===vt){if(vt=pe.type,vt===S){if(Z.tag===7){r(re,Z.sibling),Be=d(Z,pe.props.children),Be.return=re,re=Be;break e}}else if(Z.elementType===vt||typeof vt=="object"&&vt!==null&&vt.$$typeof===$&&ss(vt)===Z.type){r(re,Z.sibling),Be=d(Z,pe.props),Tl(Be,pe),Be.return=re,re=Be;break e}r(re,Z);break}else t(re,Z);Z=Z.sibling}pe.type===S?(Be=es(pe.props.children,re.mode,Be,pe.key),Be.return=re,re=Be):(Be=Wa(pe.type,pe.key,pe.props,null,re.mode,Be),Tl(Be,pe),Be.return=re,re=Be)}return v(re);case N:e:{for(vt=pe.key;Z!==null;){if(Z.key===vt)if(Z.tag===4&&Z.stateNode.containerInfo===pe.containerInfo&&Z.stateNode.implementation===pe.implementation){r(re,Z.sibling),Be=d(Z,pe.children||[]),Be.return=re,re=Be;break e}else{r(re,Z);break}else t(re,Z);Z=Z.sibling}Be=uc(pe,re.mode,Be),Be.return=re,re=Be}return v(re);case $:return pe=ss(pe),sn(re,Z,pe,Be)}if(Me(pe))return dt(re,Z,pe,Be);if(de(pe)){if(vt=de(pe),typeof vt!="function")throw Error(l(150));return pe=vt.call(pe),kt(re,Z,pe,Be)}if(typeof pe.then=="function")return sn(re,Z,Ja(pe),Be);if(pe.$$typeof===V)return sn(re,Z,Ya(re,pe),Be);ei(re,pe)}return typeof pe=="string"&&pe!==""||typeof pe=="number"||typeof pe=="bigint"?(pe=""+pe,Z!==null&&Z.tag===6?(r(re,Z.sibling),Be=d(Z,pe),Be.return=re,re=Be):(r(re,Z),Be=ic(pe,re.mode,Be),Be.return=re,re=Be),v(re)):r(re,Z)}return function(re,Z,pe,Be){try{Ol=0;var vt=sn(re,Z,pe,Be);return Rs=null,vt}catch(mt){if(mt===As||mt===Xa)throw mt;var Ft=lo(29,mt,null,re.mode);return Ft.lanes=Be,Ft.return=re,Ft}}}var as=Nh(!0),Ch=Nh(!1),Mr=!1;function wc(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Sc(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function Or(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function Tr(e,t,r){var a=e.updateQueue;if(a===null)return null;if(a=a.shared,(Yt&2)!==0){var d=a.pending;return d===null?t.next=t:(t.next=d.next,d.next=t),a.pending=t,t=qa(e),ah(e,null,r),t}return Fa(e,a,t,r),qa(e)}function El(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194048)!==0)){var a=t.lanes;a&=e.pendingLanes,r|=a,t.lanes=r,Qe(e,r)}}function Nc(e,t){var r=e.updateQueue,a=e.alternate;if(a!==null&&(a=a.updateQueue,r===a)){var d=null,h=null;if(r=r.firstBaseUpdate,r!==null){do{var v={lane:r.lane,tag:r.tag,payload:r.payload,callback:null,next:null};h===null?d=h=v:h=h.next=v,r=r.next}while(r!==null);h===null?d=h=t:h=h.next=t}else d=h=t;r={baseState:a.baseState,firstBaseUpdate:d,lastBaseUpdate:h,shared:a.shared,callbacks:a.callbacks},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}var Cc=!1;function Il(){if(Cc){var e=Ls;if(e!==null)throw e}}function Ll(e,t,r,a){Cc=!1;var d=e.updateQueue;Mr=!1;var h=d.firstBaseUpdate,v=d.lastBaseUpdate,O=d.shared.pending;if(O!==null){d.shared.pending=null;var G=O,ge=G.next;G.next=null,v===null?h=ge:v.next=ge,v=G;var _e=e.alternate;_e!==null&&(_e=_e.updateQueue,O=_e.lastBaseUpdate,O!==v&&(O===null?_e.firstBaseUpdate=ge:O.next=ge,_e.lastBaseUpdate=G))}if(h!==null){var ze=d.baseState;v=0,_e=ge=G=null,O=h;do{var ve=O.lane&-536870913,Ce=ve!==O.lane;if(Ce?(Vt&ve)===ve:(a&ve)===ve){ve!==0&&ve===Is&&(Cc=!0),_e!==null&&(_e=_e.next={lane:0,tag:O.tag,payload:O.payload,callback:null,next:null});e:{var dt=e,kt=O;ve=t;var sn=r;switch(kt.tag){case 1:if(dt=kt.payload,typeof dt=="function"){ze=dt.call(sn,ze,ve);break e}ze=dt;break e;case 3:dt.flags=dt.flags&-65537|128;case 0:if(dt=kt.payload,ve=typeof dt=="function"?dt.call(sn,ze,ve):dt,ve==null)break e;ze=x({},ze,ve);break e;case 2:Mr=!0}}ve=O.callback,ve!==null&&(e.flags|=64,Ce&&(e.flags|=8192),Ce=d.callbacks,Ce===null?d.callbacks=[ve]:Ce.push(ve))}else Ce={lane:ve,tag:O.tag,payload:O.payload,callback:O.callback,next:null},_e===null?(ge=_e=Ce,G=ze):_e=_e.next=Ce,v|=ve;if(O=O.next,O===null){if(O=d.shared.pending,O===null)break;Ce=O,O=Ce.next,Ce.next=null,d.lastBaseUpdate=Ce,d.shared.pending=null}}while(!0);_e===null&&(G=ze),d.baseState=G,d.firstBaseUpdate=ge,d.lastBaseUpdate=_e,h===null&&(d.shared.lanes=0),Rr|=v,e.lanes=v,e.memoizedState=ze}}function kh(e,t){if(typeof e!="function")throw Error(l(191,e));e.call(t)}function jh(e,t){var r=e.callbacks;if(r!==null)for(e.callbacks=null,e=0;e<r.length;e++)kh(r[e],t)}var _s=E(null),ti=E(0);function Mh(e,t){e=cr,M(ti,e),M(_s,t),cr=e|t.baseLanes}function kc(){M(ti,cr),M(_s,_s.current)}function jc(){cr=ti.current,A(_s),A(ti)}var ao=E(null),No=null;function Er(e){var t=e.alternate;M(vn,vn.current&1),M(ao,e),No===null&&(t===null||_s.current!==null||t.memoizedState!==null)&&(No=e)}function Mc(e){M(vn,vn.current),M(ao,e),No===null&&(No=e)}function Oh(e){e.tag===22?(M(vn,vn.current),M(ao,e),No===null&&(No=e)):Ir()}function Ir(){M(vn,vn.current),M(ao,ao.current)}function io(e){A(ao),No===e&&(No=null),A(vn)}var vn=E(0);function ni(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||Ad(r)||Rd(r)))return t}else if(t.tag===19&&(t.memoizedProps.revealOrder==="forwards"||t.memoizedProps.revealOrder==="backwards"||t.memoizedProps.revealOrder==="unstable_legacy-backwards"||t.memoizedProps.revealOrder==="together")){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var nr=0,Et=null,on=null,jn=null,oi=!1,Ds=!1,is=!1,ri=0,Al=0,Bs=null,mv=0;function yn(){throw Error(l(321))}function Oc(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!so(e[r],t[r]))return!1;return!0}function Tc(e,t,r,a,d,h){return nr=h,Et=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,_.H=e===null||e.memoizedState===null?dm:Fc,is=!1,h=r(a,d),is=!1,Ds&&(h=Eh(t,r,a,d)),Th(e),h}function Th(e){_.H=Dl;var t=on!==null&&on.next!==null;if(nr=0,jn=on=Et=null,oi=!1,Al=0,Bs=null,t)throw Error(l(300));e===null||Mn||(e=e.dependencies,e!==null&&Pa(e)&&(Mn=!0))}function Eh(e,t,r,a){Et=e;var d=0;do{if(Ds&&(Bs=null),Al=0,Ds=!1,25<=d)throw Error(l(301));if(d+=1,jn=on=null,e.updateQueue!=null){var h=e.updateQueue;h.lastEffect=null,h.events=null,h.stores=null,h.memoCache!=null&&(h.memoCache.index=0)}_.H=fm,h=t(r,a)}while(Ds);return h}function gv(){var e=_.H,t=e.useState()[0];return t=typeof t.then=="function"?Rl(t):t,e=e.useState()[0],(on!==null?on.memoizedState:null)!==e&&(Et.flags|=1024),t}function Ec(){var e=ri!==0;return ri=0,e}function Ic(e,t,r){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r}function Lc(e){if(oi){for(e=e.memoizedState;e!==null;){var t=e.queue;t!==null&&(t.pending=null),e=e.next}oi=!1}nr=0,jn=on=Et=null,Ds=!1,Al=ri=0,Bs=null}function qn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return jn===null?Et.memoizedState=jn=e:jn=jn.next=e,jn}function wn(){if(on===null){var e=Et.alternate;e=e!==null?e.memoizedState:null}else e=on.next;var t=jn===null?Et.memoizedState:jn.next;if(t!==null)jn=t,on=e;else{if(e===null)throw Et.alternate===null?Error(l(467)):Error(l(310));on=e,e={memoizedState:on.memoizedState,baseState:on.baseState,baseQueue:on.baseQueue,queue:on.queue,next:null},jn===null?Et.memoizedState=jn=e:jn=jn.next=e}return jn}function si(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Rl(e){var t=Al;return Al+=1,Bs===null&&(Bs=[]),e=vh(Bs,e,t),t=Et,(jn===null?t.memoizedState:jn.next)===null&&(t=t.alternate,_.H=t===null||t.memoizedState===null?dm:Fc),e}function li(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return Rl(e);if(e.$$typeof===V)return Bn(e)}throw Error(l(438,String(e)))}function Ac(e){var t=null,r=Et.updateQueue;if(r!==null&&(t=r.memoCache),t==null){var a=Et.alternate;a!==null&&(a=a.updateQueue,a!==null&&(a=a.memoCache,a!=null&&(t={data:a.data.map(function(d){return d.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),r===null&&(r=si(),Et.updateQueue=r),r.memoCache=t,r=t.data[t.index],r===void 0)for(r=t.data[t.index]=Array(e),a=0;a<e;a++)r[a]=ue;return t.index++,r}function or(e,t){return typeof t=="function"?t(e):t}function ai(e){var t=wn();return Rc(t,on,e)}function Rc(e,t,r){var a=e.queue;if(a===null)throw Error(l(311));a.lastRenderedReducer=r;var d=e.baseQueue,h=a.pending;if(h!==null){if(d!==null){var v=d.next;d.next=h.next,h.next=v}t.baseQueue=d=h,a.pending=null}if(h=e.baseState,d===null)e.memoizedState=h;else{t=d.next;var O=v=null,G=null,ge=t,_e=!1;do{var ze=ge.lane&-536870913;if(ze!==ge.lane?(Vt&ze)===ze:(nr&ze)===ze){var ve=ge.revertLane;if(ve===0)G!==null&&(G=G.next={lane:0,revertLane:0,gesture:null,action:ge.action,hasEagerState:ge.hasEagerState,eagerState:ge.eagerState,next:null}),ze===Is&&(_e=!0);else if((nr&ve)===ve){ge=ge.next,ve===Is&&(_e=!0);continue}else ze={lane:0,revertLane:ge.revertLane,gesture:null,action:ge.action,hasEagerState:ge.hasEagerState,eagerState:ge.eagerState,next:null},G===null?(O=G=ze,v=h):G=G.next=ze,Et.lanes|=ve,Rr|=ve;ze=ge.action,is&&r(h,ze),h=ge.hasEagerState?ge.eagerState:r(h,ze)}else ve={lane:ze,revertLane:ge.revertLane,gesture:ge.gesture,action:ge.action,hasEagerState:ge.hasEagerState,eagerState:ge.eagerState,next:null},G===null?(O=G=ve,v=h):G=G.next=ve,Et.lanes|=ze,Rr|=ze;ge=ge.next}while(ge!==null&&ge!==t);if(G===null?v=h:G.next=O,!so(h,e.memoizedState)&&(Mn=!0,_e&&(r=Ls,r!==null)))throw r;e.memoizedState=h,e.baseState=v,e.baseQueue=G,a.lastRenderedState=h}return d===null&&(a.lanes=0),[e.memoizedState,a.dispatch]}function _c(e){var t=wn(),r=t.queue;if(r===null)throw Error(l(311));r.lastRenderedReducer=e;var a=r.dispatch,d=r.pending,h=t.memoizedState;if(d!==null){r.pending=null;var v=d=d.next;do h=e(h,v.action),v=v.next;while(v!==d);so(h,t.memoizedState)||(Mn=!0),t.memoizedState=h,t.baseQueue===null&&(t.baseState=h),r.lastRenderedState=h}return[h,a]}function Ih(e,t,r){var a=Et,d=wn(),h=Ut;if(h){if(r===void 0)throw Error(l(407));r=r()}else r=t();var v=!so((on||d).memoizedState,r);if(v&&(d.memoizedState=r,Mn=!0),d=d.queue,zc(Rh.bind(null,a,d,e),[e]),d.getSnapshot!==t||v||jn!==null&&jn.memoizedState.tag&1){if(a.flags|=2048,zs(9,{destroy:void 0},Ah.bind(null,a,d,r,t),null),un===null)throw Error(l(349));h||(nr&127)!==0||Lh(a,t,r)}return r}function Lh(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Et.updateQueue,t===null?(t=si(),Et.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function Ah(e,t,r,a){t.value=r,t.getSnapshot=a,_h(t)&&Dh(e)}function Rh(e,t,r){return r(function(){_h(t)&&Dh(e)})}function _h(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!so(e,r)}catch{return!0}}function Dh(e){var t=Jr(e,2);t!==null&&eo(t,e,2)}function Dc(e){var t=qn();if(typeof e=="function"){var r=e;if(e=r(),is){at(!0);try{r()}finally{at(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:or,lastRenderedState:e},t}function Bh(e,t,r,a){return e.baseState=r,Rc(e,on,typeof a=="function"?a:or)}function yv(e,t,r,a,d){if(ci(e))throw Error(l(485));if(e=t.action,e!==null){var h={payload:d,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(v){h.listeners.push(v)}};_.T!==null?r(!0):h.isTransition=!1,a(h),r=t.pending,r===null?(h.next=t.pending=h,zh(t,h)):(h.next=r.next,t.pending=r.next=h)}}function zh(e,t){var r=t.action,a=t.payload,d=e.state;if(t.isTransition){var h=_.T,v={};_.T=v;try{var O=r(d,a),G=_.S;G!==null&&G(v,O),Hh(e,t,O)}catch(ge){Bc(e,t,ge)}finally{h!==null&&v.types!==null&&(h.types=v.types),_.T=h}}else try{h=r(d,a),Hh(e,t,h)}catch(ge){Bc(e,t,ge)}}function Hh(e,t,r){r!==null&&typeof r=="object"&&typeof r.then=="function"?r.then(function(a){Vh(e,t,a)},function(a){return Bc(e,t,a)}):Vh(e,t,r)}function Vh(e,t,r){t.status="fulfilled",t.value=r,Kh(t),e.state=r,t=e.pending,t!==null&&(r=t.next,r===t?e.pending=null:(r=r.next,t.next=r,zh(e,r)))}function Bc(e,t,r){var a=e.pending;if(e.pending=null,a!==null){a=a.next;do t.status="rejected",t.reason=r,Kh(t),t=t.next;while(t!==a)}e.action=null}function Kh(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function Uh(e,t){return t}function $h(e,t){if(Ut){var r=un.formState;if(r!==null){e:{var a=Et;if(Ut){if(pn){t:{for(var d=pn,h=So;d.nodeType!==8;){if(!h){d=null;break t}if(d=Co(d.nextSibling),d===null){d=null;break t}}h=d.data,d=h==="F!"||h==="F"?d:null}if(d){pn=Co(d.nextSibling),a=d.data==="F!";break e}}kr(a)}a=!1}a&&(t=r[0])}}return r=qn(),r.memoizedState=r.baseState=t,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Uh,lastRenderedState:t},r.queue=a,r=im.bind(null,Et,a),a.dispatch=r,a=Dc(!1),h=$c.bind(null,Et,!1,a.queue),a=qn(),d={state:t,dispatch:null,action:e,pending:null},a.queue=d,r=yv.bind(null,Et,d,h,r),d.dispatch=r,a.memoizedState=e,[t,r,!1]}function Fh(e){var t=wn();return qh(t,on,e)}function qh(e,t,r){if(t=Rc(e,t,Uh)[0],e=ai(or)[0],typeof t=="object"&&t!==null&&typeof t.then=="function")try{var a=Rl(t)}catch(v){throw v===As?Xa:v}else a=t;t=wn();var d=t.queue,h=d.dispatch;return r!==t.memoizedState&&(Et.flags|=2048,zs(9,{destroy:void 0},bv.bind(null,d,r),null)),[a,h,e]}function bv(e,t){e.action=t}function Wh(e){var t=wn(),r=on;if(r!==null)return qh(t,r,e);wn(),t=t.memoizedState,r=wn();var a=r.queue.dispatch;return r.memoizedState=e,[t,a,!1]}function zs(e,t,r,a){return e={tag:e,create:r,deps:a,inst:t,next:null},t=Et.updateQueue,t===null&&(t=si(),Et.updateQueue=t),r=t.lastEffect,r===null?t.lastEffect=e.next=e:(a=r.next,r.next=e,e.next=a,t.lastEffect=e),e}function Gh(){return wn().memoizedState}function ii(e,t,r,a){var d=qn();Et.flags|=e,d.memoizedState=zs(1|t,{destroy:void 0},r,a===void 0?null:a)}function ui(e,t,r,a){var d=wn();a=a===void 0?null:a;var h=d.memoizedState.inst;on!==null&&a!==null&&Oc(a,on.memoizedState.deps)?d.memoizedState=zs(t,h,r,a):(Et.flags|=e,d.memoizedState=zs(1|t,h,r,a))}function Ph(e,t){ii(8390656,8,e,t)}function zc(e,t){ui(2048,8,e,t)}function xv(e){Et.flags|=4;var t=Et.updateQueue;if(t===null)t=si(),Et.updateQueue=t,t.events=[e];else{var r=t.events;r===null?t.events=[e]:r.push(e)}}function Yh(e){var t=wn().memoizedState;return xv({ref:t,nextImpl:e}),function(){if((Yt&2)!==0)throw Error(l(440));return t.impl.apply(void 0,arguments)}}function Qh(e,t){return ui(4,2,e,t)}function Xh(e,t){return ui(4,4,e,t)}function Zh(e,t){if(typeof t=="function"){e=e();var r=t(e);return function(){typeof r=="function"?r():t(null)}}if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Jh(e,t,r){r=r!=null?r.concat([e]):null,ui(4,4,Zh.bind(null,t,e),r)}function Hc(){}function em(e,t){var r=wn();t=t===void 0?null:t;var a=r.memoizedState;return t!==null&&Oc(t,a[1])?a[0]:(r.memoizedState=[e,t],e)}function tm(e,t){var r=wn();t=t===void 0?null:t;var a=r.memoizedState;if(t!==null&&Oc(t,a[1]))return a[0];if(a=e(),is){at(!0);try{e()}finally{at(!1)}}return r.memoizedState=[a,t],a}function Vc(e,t,r){return r===void 0||(nr&1073741824)!==0&&(Vt&261930)===0?e.memoizedState=t:(e.memoizedState=r,e=ng(),Et.lanes|=e,Rr|=e,r)}function nm(e,t,r,a){return so(r,t)?r:_s.current!==null?(e=Vc(e,r,a),so(e,t)||(Mn=!0),e):(nr&42)===0||(nr&1073741824)!==0&&(Vt&261930)===0?(Mn=!0,e.memoizedState=r):(e=ng(),Et.lanes|=e,Rr|=e,t)}function om(e,t,r,a,d){var h=oe.p;oe.p=h!==0&&8>h?h:8;var v=_.T,O={};_.T=O,$c(e,!1,t,r);try{var G=d(),ge=_.S;if(ge!==null&&ge(O,G),G!==null&&typeof G=="object"&&typeof G.then=="function"){var _e=hv(G,a);_l(e,t,_e,fo(e))}else _l(e,t,a,fo(e))}catch(ze){_l(e,t,{then:function(){},status:"rejected",reason:ze},fo())}finally{oe.p=h,v!==null&&O.types!==null&&(v.types=O.types),_.T=v}}function vv(){}function Kc(e,t,r,a){if(e.tag!==5)throw Error(l(476));var d=rm(e).queue;om(e,d,t,ce,r===null?vv:function(){return sm(e),r(a)})}function rm(e){var t=e.memoizedState;if(t!==null)return t;t={memoizedState:ce,baseState:ce,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:or,lastRenderedState:ce},next:null};var r={};return t.next={memoizedState:r,baseState:r,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:or,lastRenderedState:r},next:null},e.memoizedState=t,e=e.alternate,e!==null&&(e.memoizedState=t),t}function sm(e){var t=rm(e);t.next===null&&(t=e.alternate.memoizedState),_l(e,t.next.queue,{},fo())}function Uc(){return Bn(Zl)}function lm(){return wn().memoizedState}function am(){return wn().memoizedState}function wv(e){for(var t=e.return;t!==null;){switch(t.tag){case 24:case 3:var r=fo();e=Or(r);var a=Tr(t,e,r);a!==null&&(eo(a,t,r),El(a,t,r)),t={cache:yc()},e.payload=t;return}t=t.return}}function Sv(e,t,r){var a=fo();r={lane:a,revertLane:0,gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null},ci(e)?um(t,r):(r=lc(e,t,r,a),r!==null&&(eo(r,e,a),cm(r,t,a)))}function im(e,t,r){var a=fo();_l(e,t,r,a)}function _l(e,t,r,a){var d={lane:a,revertLane:0,gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null};if(ci(e))um(t,d);else{var h=e.alternate;if(e.lanes===0&&(h===null||h.lanes===0)&&(h=t.lastRenderedReducer,h!==null))try{var v=t.lastRenderedState,O=h(v,r);if(d.hasEagerState=!0,d.eagerState=O,so(O,v))return Fa(e,t,d,0),un===null&&$a(),!1}catch{}if(r=lc(e,t,d,a),r!==null)return eo(r,e,a),cm(r,t,a),!0}return!1}function $c(e,t,r,a){if(a={lane:2,revertLane:wd(),gesture:null,action:a,hasEagerState:!1,eagerState:null,next:null},ci(e)){if(t)throw Error(l(479))}else t=lc(e,r,a,2),t!==null&&eo(t,e,2)}function ci(e){var t=e.alternate;return e===Et||t!==null&&t===Et}function um(e,t){Ds=oi=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function cm(e,t,r){if((r&4194048)!==0){var a=t.lanes;a&=e.pendingLanes,r|=a,t.lanes=r,Qe(e,r)}}var Dl={readContext:Bn,use:li,useCallback:yn,useContext:yn,useEffect:yn,useImperativeHandle:yn,useLayoutEffect:yn,useInsertionEffect:yn,useMemo:yn,useReducer:yn,useRef:yn,useState:yn,useDebugValue:yn,useDeferredValue:yn,useTransition:yn,useSyncExternalStore:yn,useId:yn,useHostTransitionStatus:yn,useFormState:yn,useActionState:yn,useOptimistic:yn,useMemoCache:yn,useCacheRefresh:yn};Dl.useEffectEvent=yn;var dm={readContext:Bn,use:li,useCallback:function(e,t){return qn().memoizedState=[e,t===void 0?null:t],e},useContext:Bn,useEffect:Ph,useImperativeHandle:function(e,t,r){r=r!=null?r.concat([e]):null,ii(4194308,4,Zh.bind(null,t,e),r)},useLayoutEffect:function(e,t){return ii(4194308,4,e,t)},useInsertionEffect:function(e,t){ii(4,2,e,t)},useMemo:function(e,t){var r=qn();t=t===void 0?null:t;var a=e();if(is){at(!0);try{e()}finally{at(!1)}}return r.memoizedState=[a,t],a},useReducer:function(e,t,r){var a=qn();if(r!==void 0){var d=r(t);if(is){at(!0);try{r(t)}finally{at(!1)}}}else d=t;return a.memoizedState=a.baseState=d,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:d},a.queue=e,e=e.dispatch=Sv.bind(null,Et,e),[a.memoizedState,e]},useRef:function(e){var t=qn();return e={current:e},t.memoizedState=e},useState:function(e){e=Dc(e);var t=e.queue,r=im.bind(null,Et,t);return t.dispatch=r,[e.memoizedState,r]},useDebugValue:Hc,useDeferredValue:function(e,t){var r=qn();return Vc(r,e,t)},useTransition:function(){var e=Dc(!1);return e=om.bind(null,Et,e.queue,!0,!1),qn().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,r){var a=Et,d=qn();if(Ut){if(r===void 0)throw Error(l(407));r=r()}else{if(r=t(),un===null)throw Error(l(349));(Vt&127)!==0||Lh(a,t,r)}d.memoizedState=r;var h={value:r,getSnapshot:t};return d.queue=h,Ph(Rh.bind(null,a,h,e),[e]),a.flags|=2048,zs(9,{destroy:void 0},Ah.bind(null,a,h,r,t),null),r},useId:function(){var e=qn(),t=un.identifierPrefix;if(Ut){var r=Vo,a=Ho;r=(a&~(1<<32-ht(a)-1)).toString(32)+r,t="_"+t+"R_"+r,r=ri++,0<r&&(t+="H"+r.toString(32)),t+="_"}else r=mv++,t="_"+t+"r_"+r.toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:Uc,useFormState:$h,useActionState:$h,useOptimistic:function(e){var t=qn();t.memoizedState=t.baseState=e;var r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=r,t=$c.bind(null,Et,!0,r),r.dispatch=t,[e,t]},useMemoCache:Ac,useCacheRefresh:function(){return qn().memoizedState=wv.bind(null,Et)},useEffectEvent:function(e){var t=qn(),r={impl:e};return t.memoizedState=r,function(){if((Yt&2)!==0)throw Error(l(440));return r.impl.apply(void 0,arguments)}}},Fc={readContext:Bn,use:li,useCallback:em,useContext:Bn,useEffect:zc,useImperativeHandle:Jh,useInsertionEffect:Qh,useLayoutEffect:Xh,useMemo:tm,useReducer:ai,useRef:Gh,useState:function(){return ai(or)},useDebugValue:Hc,useDeferredValue:function(e,t){var r=wn();return nm(r,on.memoizedState,e,t)},useTransition:function(){var e=ai(or)[0],t=wn().memoizedState;return[typeof e=="boolean"?e:Rl(e),t]},useSyncExternalStore:Ih,useId:lm,useHostTransitionStatus:Uc,useFormState:Fh,useActionState:Fh,useOptimistic:function(e,t){var r=wn();return Bh(r,on,e,t)},useMemoCache:Ac,useCacheRefresh:am};Fc.useEffectEvent=Yh;var fm={readContext:Bn,use:li,useCallback:em,useContext:Bn,useEffect:zc,useImperativeHandle:Jh,useInsertionEffect:Qh,useLayoutEffect:Xh,useMemo:tm,useReducer:_c,useRef:Gh,useState:function(){return _c(or)},useDebugValue:Hc,useDeferredValue:function(e,t){var r=wn();return on===null?Vc(r,e,t):nm(r,on.memoizedState,e,t)},useTransition:function(){var e=_c(or)[0],t=wn().memoizedState;return[typeof e=="boolean"?e:Rl(e),t]},useSyncExternalStore:Ih,useId:lm,useHostTransitionStatus:Uc,useFormState:Wh,useActionState:Wh,useOptimistic:function(e,t){var r=wn();return on!==null?Bh(r,on,e,t):(r.baseState=e,[e,r.queue.dispatch])},useMemoCache:Ac,useCacheRefresh:am};fm.useEffectEvent=Yh;function qc(e,t,r,a){t=e.memoizedState,r=r(a,t),r=r==null?t:x({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Wc={enqueueSetState:function(e,t,r){e=e._reactInternals;var a=fo(),d=Or(a);d.payload=t,r!=null&&(d.callback=r),t=Tr(e,d,a),t!==null&&(eo(t,e,a),El(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var a=fo(),d=Or(a);d.tag=1,d.payload=t,r!=null&&(d.callback=r),t=Tr(e,d,a),t!==null&&(eo(t,e,a),El(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=fo(),a=Or(r);a.tag=2,t!=null&&(a.callback=t),t=Tr(e,a,r),t!==null&&(eo(t,e,r),El(t,e,r))}};function pm(e,t,r,a,d,h,v){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(a,h,v):t.prototype&&t.prototype.isPureReactComponent?!Sl(r,a)||!Sl(d,h):!0}function hm(e,t,r,a){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,a),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,a),t.state!==e&&Wc.enqueueReplaceState(t,t.state,null)}function us(e,t){var r=t;if("ref"in t){r={};for(var a in t)a!=="ref"&&(r[a]=t[a])}if(e=e.defaultProps){r===t&&(r=x({},r));for(var d in e)r[d]===void 0&&(r[d]=e[d])}return r}function mm(e){Ua(e)}function gm(e){console.error(e)}function ym(e){Ua(e)}function di(e,t){try{var r=e.onUncaughtError;r(t.value,{componentStack:t.stack})}catch(a){setTimeout(function(){throw a})}}function bm(e,t,r){try{var a=e.onCaughtError;a(r.value,{componentStack:r.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(d){setTimeout(function(){throw d})}}function Gc(e,t,r){return r=Or(r),r.tag=3,r.payload={element:null},r.callback=function(){di(e,t)},r}function xm(e){return e=Or(e),e.tag=3,e}function vm(e,t,r,a){var d=r.type.getDerivedStateFromError;if(typeof d=="function"){var h=a.value;e.payload=function(){return d(h)},e.callback=function(){bm(t,r,a)}}var v=r.stateNode;v!==null&&typeof v.componentDidCatch=="function"&&(e.callback=function(){bm(t,r,a),typeof d!="function"&&(_r===null?_r=new Set([this]):_r.add(this));var O=a.stack;this.componentDidCatch(a.value,{componentStack:O!==null?O:""})})}function Nv(e,t,r,a,d){if(r.flags|=32768,a!==null&&typeof a=="object"&&typeof a.then=="function"){if(t=r.alternate,t!==null&&Es(t,r,d,!0),r=ao.current,r!==null){switch(r.tag){case 31:case 13:return No===null?Ni():r.alternate===null&&bn===0&&(bn=3),r.flags&=-257,r.flags|=65536,r.lanes=d,a===Za?r.flags|=16384:(t=r.updateQueue,t===null?r.updateQueue=new Set([a]):t.add(a),bd(e,a,d)),!1;case 22:return r.flags|=65536,a===Za?r.flags|=16384:(t=r.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([a])},r.updateQueue=t):(r=t.retryQueue,r===null?t.retryQueue=new Set([a]):r.add(a)),bd(e,a,d)),!1}throw Error(l(435,r.tag))}return bd(e,a,d),Ni(),!1}if(Ut)return t=ao.current,t!==null?((t.flags&65536)===0&&(t.flags|=256),t.flags|=65536,t.lanes=d,a!==fc&&(e=Error(l(422),{cause:a}),kl(xo(e,r)))):(a!==fc&&(t=Error(l(423),{cause:a}),kl(xo(t,r))),e=e.current.alternate,e.flags|=65536,d&=-d,e.lanes|=d,a=xo(a,r),d=Gc(e.stateNode,a,d),Nc(e,d),bn!==4&&(bn=2)),!1;var h=Error(l(520),{cause:a});if(h=xo(h,r),Fl===null?Fl=[h]:Fl.push(h),bn!==4&&(bn=2),t===null)return!0;a=xo(a,r),r=t;do{switch(r.tag){case 3:return r.flags|=65536,e=d&-d,r.lanes|=e,e=Gc(r.stateNode,a,e),Nc(r,e),!1;case 1:if(t=r.type,h=r.stateNode,(r.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||h!==null&&typeof h.componentDidCatch=="function"&&(_r===null||!_r.has(h))))return r.flags|=65536,d&=-d,r.lanes|=d,d=xm(d),vm(d,e,r,a),Nc(r,d),!1}r=r.return}while(r!==null);return!1}var Pc=Error(l(461)),Mn=!1;function zn(e,t,r,a){t.child=e===null?Ch(t,null,r,a):as(t,e.child,r,a)}function wm(e,t,r,a,d){r=r.render;var h=t.ref;if("ref"in a){var v={};for(var O in a)O!=="ref"&&(v[O]=a[O])}else v=a;return os(t),a=Tc(e,t,r,v,h,d),O=Ec(),e!==null&&!Mn?(Ic(e,t,d),rr(e,t,d)):(Ut&&O&&cc(t),t.flags|=1,zn(e,t,a,d),t.child)}function Sm(e,t,r,a,d){if(e===null){var h=r.type;return typeof h=="function"&&!ac(h)&&h.defaultProps===void 0&&r.compare===null?(t.tag=15,t.type=h,Nm(e,t,h,a,d)):(e=Wa(r.type,null,a,t,t.mode,d),e.ref=t.ref,e.return=t,t.child=e)}if(h=e.child,!nd(e,d)){var v=h.memoizedProps;if(r=r.compare,r=r!==null?r:Sl,r(v,a)&&e.ref===t.ref)return rr(e,t,d)}return t.flags|=1,e=Zo(h,a),e.ref=t.ref,e.return=t,t.child=e}function Nm(e,t,r,a,d){if(e!==null){var h=e.memoizedProps;if(Sl(h,a)&&e.ref===t.ref)if(Mn=!1,t.pendingProps=a=h,nd(e,d))(e.flags&131072)!==0&&(Mn=!0);else return t.lanes=e.lanes,rr(e,t,d)}return Yc(e,t,r,a,d)}function Cm(e,t,r,a){var d=a.children,h=e!==null?e.memoizedState:null;if(e===null&&t.stateNode===null&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.mode==="hidden"){if((t.flags&128)!==0){if(h=h!==null?h.baseLanes|r:r,e!==null){for(a=t.child=e.child,d=0;a!==null;)d=d|a.lanes|a.childLanes,a=a.sibling;a=d&~h}else a=0,t.child=null;return km(e,t,h,r,a)}if((r&536870912)!==0)t.memoizedState={baseLanes:0,cachePool:null},e!==null&&Qa(t,h!==null?h.cachePool:null),h!==null?Mh(t,h):kc(),Oh(t);else return a=t.lanes=536870912,km(e,t,h!==null?h.baseLanes|r:r,r,a)}else h!==null?(Qa(t,h.cachePool),Mh(t,h),Ir(),t.memoizedState=null):(e!==null&&Qa(t,null),kc(),Ir());return zn(e,t,d,r),t.child}function Bl(e,t){return e!==null&&e.tag===22||t.stateNode!==null||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function km(e,t,r,a,d){var h=xc();return h=h===null?null:{parent:kn._currentValue,pool:h},t.memoizedState={baseLanes:r,cachePool:h},e!==null&&Qa(t,null),kc(),Oh(t),e!==null&&Es(e,t,a,!0),t.childLanes=d,null}function fi(e,t){return t=hi({mode:t.mode,children:t.children},e.mode),t.ref=e.ref,e.child=t,t.return=e,t}function jm(e,t,r){return as(t,e.child,null,r),e=fi(t,t.pendingProps),e.flags|=2,io(t),t.memoizedState=null,e}function Cv(e,t,r){var a=t.pendingProps,d=(t.flags&128)!==0;if(t.flags&=-129,e===null){if(Ut){if(a.mode==="hidden")return e=fi(t,a),t.lanes=536870912,Bl(null,e);if(Mc(t),(e=pn)?(e=zg(e,So),e=e!==null&&e.data==="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:Nr!==null?{id:Ho,overflow:Vo}:null,retryLane:536870912,hydrationErrors:null},r=uh(e),r.return=t,t.child=r,Dn=t,pn=null)):e=null,e===null)throw kr(t);return t.lanes=536870912,null}return fi(t,a)}var h=e.memoizedState;if(h!==null){var v=h.dehydrated;if(Mc(t),d)if(t.flags&256)t.flags&=-257,t=jm(e,t,r);else if(t.memoizedState!==null)t.child=e.child,t.flags|=128,t=null;else throw Error(l(558));else if(Mn||Es(e,t,r,!1),d=(r&e.childLanes)!==0,Mn||d){if(a=un,a!==null&&(v=rt(a,r),v!==0&&v!==h.retryLane))throw h.retryLane=v,Jr(e,v),eo(a,e,v),Pc;Ni(),t=jm(e,t,r)}else e=h.treeContext,pn=Co(v.nextSibling),Dn=t,Ut=!0,Cr=null,So=!1,e!==null&&fh(t,e),t=fi(t,a),t.flags|=4096;return t}return e=Zo(e.child,{mode:a.mode,children:a.children}),e.ref=t.ref,t.child=e,e.return=t,e}function pi(e,t){var r=t.ref;if(r===null)e!==null&&e.ref!==null&&(t.flags|=4194816);else{if(typeof r!="function"&&typeof r!="object")throw Error(l(284));(e===null||e.ref!==r)&&(t.flags|=4194816)}}function Yc(e,t,r,a,d){return os(t),r=Tc(e,t,r,a,void 0,d),a=Ec(),e!==null&&!Mn?(Ic(e,t,d),rr(e,t,d)):(Ut&&a&&cc(t),t.flags|=1,zn(e,t,r,d),t.child)}function Mm(e,t,r,a,d,h){return os(t),t.updateQueue=null,r=Eh(t,a,r,d),Th(e),a=Ec(),e!==null&&!Mn?(Ic(e,t,h),rr(e,t,h)):(Ut&&a&&cc(t),t.flags|=1,zn(e,t,r,h),t.child)}function Om(e,t,r,a,d){if(os(t),t.stateNode===null){var h=js,v=r.contextType;typeof v=="object"&&v!==null&&(h=Bn(v)),h=new r(a,h),t.memoizedState=h.state!==null&&h.state!==void 0?h.state:null,h.updater=Wc,t.stateNode=h,h._reactInternals=t,h=t.stateNode,h.props=a,h.state=t.memoizedState,h.refs={},wc(t),v=r.contextType,h.context=typeof v=="object"&&v!==null?Bn(v):js,h.state=t.memoizedState,v=r.getDerivedStateFromProps,typeof v=="function"&&(qc(t,r,v,a),h.state=t.memoizedState),typeof r.getDerivedStateFromProps=="function"||typeof h.getSnapshotBeforeUpdate=="function"||typeof h.UNSAFE_componentWillMount!="function"&&typeof h.componentWillMount!="function"||(v=h.state,typeof h.componentWillMount=="function"&&h.componentWillMount(),typeof h.UNSAFE_componentWillMount=="function"&&h.UNSAFE_componentWillMount(),v!==h.state&&Wc.enqueueReplaceState(h,h.state,null),Ll(t,a,h,d),Il(),h.state=t.memoizedState),typeof h.componentDidMount=="function"&&(t.flags|=4194308),a=!0}else if(e===null){h=t.stateNode;var O=t.memoizedProps,G=us(r,O);h.props=G;var ge=h.context,_e=r.contextType;v=js,typeof _e=="object"&&_e!==null&&(v=Bn(_e));var ze=r.getDerivedStateFromProps;_e=typeof ze=="function"||typeof h.getSnapshotBeforeUpdate=="function",O=t.pendingProps!==O,_e||typeof h.UNSAFE_componentWillReceiveProps!="function"&&typeof h.componentWillReceiveProps!="function"||(O||ge!==v)&&hm(t,h,a,v),Mr=!1;var ve=t.memoizedState;h.state=ve,Ll(t,a,h,d),Il(),ge=t.memoizedState,O||ve!==ge||Mr?(typeof ze=="function"&&(qc(t,r,ze,a),ge=t.memoizedState),(G=Mr||pm(t,r,G,a,ve,ge,v))?(_e||typeof h.UNSAFE_componentWillMount!="function"&&typeof h.componentWillMount!="function"||(typeof h.componentWillMount=="function"&&h.componentWillMount(),typeof h.UNSAFE_componentWillMount=="function"&&h.UNSAFE_componentWillMount()),typeof h.componentDidMount=="function"&&(t.flags|=4194308)):(typeof h.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=a,t.memoizedState=ge),h.props=a,h.state=ge,h.context=v,a=G):(typeof h.componentDidMount=="function"&&(t.flags|=4194308),a=!1)}else{h=t.stateNode,Sc(e,t),v=t.memoizedProps,_e=us(r,v),h.props=_e,ze=t.pendingProps,ve=h.context,ge=r.contextType,G=js,typeof ge=="object"&&ge!==null&&(G=Bn(ge)),O=r.getDerivedStateFromProps,(ge=typeof O=="function"||typeof h.getSnapshotBeforeUpdate=="function")||typeof h.UNSAFE_componentWillReceiveProps!="function"&&typeof h.componentWillReceiveProps!="function"||(v!==ze||ve!==G)&&hm(t,h,a,G),Mr=!1,ve=t.memoizedState,h.state=ve,Ll(t,a,h,d),Il();var Ce=t.memoizedState;v!==ze||ve!==Ce||Mr||e!==null&&e.dependencies!==null&&Pa(e.dependencies)?(typeof O=="function"&&(qc(t,r,O,a),Ce=t.memoizedState),(_e=Mr||pm(t,r,_e,a,ve,Ce,G)||e!==null&&e.dependencies!==null&&Pa(e.dependencies))?(ge||typeof h.UNSAFE_componentWillUpdate!="function"&&typeof h.componentWillUpdate!="function"||(typeof h.componentWillUpdate=="function"&&h.componentWillUpdate(a,Ce,G),typeof h.UNSAFE_componentWillUpdate=="function"&&h.UNSAFE_componentWillUpdate(a,Ce,G)),typeof h.componentDidUpdate=="function"&&(t.flags|=4),typeof h.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof h.componentDidUpdate!="function"||v===e.memoizedProps&&ve===e.memoizedState||(t.flags|=4),typeof h.getSnapshotBeforeUpdate!="function"||v===e.memoizedProps&&ve===e.memoizedState||(t.flags|=1024),t.memoizedProps=a,t.memoizedState=Ce),h.props=a,h.state=Ce,h.context=G,a=_e):(typeof h.componentDidUpdate!="function"||v===e.memoizedProps&&ve===e.memoizedState||(t.flags|=4),typeof h.getSnapshotBeforeUpdate!="function"||v===e.memoizedProps&&ve===e.memoizedState||(t.flags|=1024),a=!1)}return h=a,pi(e,t),a=(t.flags&128)!==0,h||a?(h=t.stateNode,r=a&&typeof r.getDerivedStateFromError!="function"?null:h.render(),t.flags|=1,e!==null&&a?(t.child=as(t,e.child,null,d),t.child=as(t,null,r,d)):zn(e,t,r,d),t.memoizedState=h.state,e=t.child):e=rr(e,t,d),e}function Tm(e,t,r,a){return ts(),t.flags|=256,zn(e,t,r,a),t.child}var Qc={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Xc(e){return{baseLanes:e,cachePool:bh()}}function Zc(e,t,r){return e=e!==null?e.childLanes&~r:0,t&&(e|=co),e}function Em(e,t,r){var a=t.pendingProps,d=!1,h=(t.flags&128)!==0,v;if((v=h)||(v=e!==null&&e.memoizedState===null?!1:(vn.current&2)!==0),v&&(d=!0,t.flags&=-129),v=(t.flags&32)!==0,t.flags&=-33,e===null){if(Ut){if(d?Er(t):Ir(),(e=pn)?(e=zg(e,So),e=e!==null&&e.data!=="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:Nr!==null?{id:Ho,overflow:Vo}:null,retryLane:536870912,hydrationErrors:null},r=uh(e),r.return=t,t.child=r,Dn=t,pn=null)):e=null,e===null)throw kr(t);return Rd(e)?t.lanes=32:t.lanes=536870912,null}var O=a.children;return a=a.fallback,d?(Ir(),d=t.mode,O=hi({mode:"hidden",children:O},d),a=es(a,d,r,null),O.return=t,a.return=t,O.sibling=a,t.child=O,a=t.child,a.memoizedState=Xc(r),a.childLanes=Zc(e,v,r),t.memoizedState=Qc,Bl(null,a)):(Er(t),Jc(t,O))}var G=e.memoizedState;if(G!==null&&(O=G.dehydrated,O!==null)){if(h)t.flags&256?(Er(t),t.flags&=-257,t=ed(e,t,r)):t.memoizedState!==null?(Ir(),t.child=e.child,t.flags|=128,t=null):(Ir(),O=a.fallback,d=t.mode,a=hi({mode:"visible",children:a.children},d),O=es(O,d,r,null),O.flags|=2,a.return=t,O.return=t,a.sibling=O,t.child=a,as(t,e.child,null,r),a=t.child,a.memoizedState=Xc(r),a.childLanes=Zc(e,v,r),t.memoizedState=Qc,t=Bl(null,a));else if(Er(t),Rd(O)){if(v=O.nextSibling&&O.nextSibling.dataset,v)var ge=v.dgst;v=ge,a=Error(l(419)),a.stack="",a.digest=v,kl({value:a,source:null,stack:null}),t=ed(e,t,r)}else if(Mn||Es(e,t,r,!1),v=(r&e.childLanes)!==0,Mn||v){if(v=un,v!==null&&(a=rt(v,r),a!==0&&a!==G.retryLane))throw G.retryLane=a,Jr(e,a),eo(v,e,a),Pc;Ad(O)||Ni(),t=ed(e,t,r)}else Ad(O)?(t.flags|=192,t.child=e.child,t=null):(e=G.treeContext,pn=Co(O.nextSibling),Dn=t,Ut=!0,Cr=null,So=!1,e!==null&&fh(t,e),t=Jc(t,a.children),t.flags|=4096);return t}return d?(Ir(),O=a.fallback,d=t.mode,G=e.child,ge=G.sibling,a=Zo(G,{mode:"hidden",children:a.children}),a.subtreeFlags=G.subtreeFlags&65011712,ge!==null?O=Zo(ge,O):(O=es(O,d,r,null),O.flags|=2),O.return=t,a.return=t,a.sibling=O,t.child=a,Bl(null,a),a=t.child,O=e.child.memoizedState,O===null?O=Xc(r):(d=O.cachePool,d!==null?(G=kn._currentValue,d=d.parent!==G?{parent:G,pool:G}:d):d=bh(),O={baseLanes:O.baseLanes|r,cachePool:d}),a.memoizedState=O,a.childLanes=Zc(e,v,r),t.memoizedState=Qc,Bl(e.child,a)):(Er(t),r=e.child,e=r.sibling,r=Zo(r,{mode:"visible",children:a.children}),r.return=t,r.sibling=null,e!==null&&(v=t.deletions,v===null?(t.deletions=[e],t.flags|=16):v.push(e)),t.child=r,t.memoizedState=null,r)}function Jc(e,t){return t=hi({mode:"visible",children:t},e.mode),t.return=e,e.child=t}function hi(e,t){return e=lo(22,e,null,t),e.lanes=0,e}function ed(e,t,r){return as(t,e.child,null,r),e=Jc(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Im(e,t,r){e.lanes|=t;var a=e.alternate;a!==null&&(a.lanes|=t),mc(e.return,t,r)}function td(e,t,r,a,d,h){var v=e.memoizedState;v===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:a,tail:r,tailMode:d,treeForkCount:h}:(v.isBackwards=t,v.rendering=null,v.renderingStartTime=0,v.last=a,v.tail=r,v.tailMode=d,v.treeForkCount=h)}function Lm(e,t,r){var a=t.pendingProps,d=a.revealOrder,h=a.tail;a=a.children;var v=vn.current,O=(v&2)!==0;if(O?(v=v&1|2,t.flags|=128):v&=1,M(vn,v),zn(e,t,a,r),a=Ut?Cl:0,!O&&e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Im(e,r,t);else if(e.tag===19)Im(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(d){case"forwards":for(r=t.child,d=null;r!==null;)e=r.alternate,e!==null&&ni(e)===null&&(d=r),r=r.sibling;r=d,r===null?(d=t.child,t.child=null):(d=r.sibling,r.sibling=null),td(t,!1,d,r,h,a);break;case"backwards":case"unstable_legacy-backwards":for(r=null,d=t.child,t.child=null;d!==null;){if(e=d.alternate,e!==null&&ni(e)===null){t.child=d;break}e=d.sibling,d.sibling=r,r=d,d=e}td(t,!0,r,null,h,a);break;case"together":td(t,!1,null,null,void 0,a);break;default:t.memoizedState=null}return t.child}function rr(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Rr|=t.lanes,(r&t.childLanes)===0)if(e!==null){if(Es(e,t,r,!1),(r&t.childLanes)===0)return null}else return null;if(e!==null&&t.child!==e.child)throw Error(l(153));if(t.child!==null){for(e=t.child,r=Zo(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Zo(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function nd(e,t){return(e.lanes&t)!==0?!0:(e=e.dependencies,!!(e!==null&&Pa(e)))}function kv(e,t,r){switch(t.tag){case 3:Ne(t,t.stateNode.containerInfo),jr(t,kn,e.memoizedState.cache),ts();break;case 27:case 5:Y(t);break;case 4:Ne(t,t.stateNode.containerInfo);break;case 10:jr(t,t.type,t.memoizedProps.value);break;case 31:if(t.memoizedState!==null)return t.flags|=128,Mc(t),null;break;case 13:var a=t.memoizedState;if(a!==null)return a.dehydrated!==null?(Er(t),t.flags|=128,null):(r&t.child.childLanes)!==0?Em(e,t,r):(Er(t),e=rr(e,t,r),e!==null?e.sibling:null);Er(t);break;case 19:var d=(e.flags&128)!==0;if(a=(r&t.childLanes)!==0,a||(Es(e,t,r,!1),a=(r&t.childLanes)!==0),d){if(a)return Lm(e,t,r);t.flags|=128}if(d=t.memoizedState,d!==null&&(d.rendering=null,d.tail=null,d.lastEffect=null),M(vn,vn.current),a)break;return null;case 22:return t.lanes=0,Cm(e,t,r,t.pendingProps);case 24:jr(t,kn,e.memoizedState.cache)}return rr(e,t,r)}function Am(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps)Mn=!0;else{if(!nd(e,r)&&(t.flags&128)===0)return Mn=!1,kv(e,t,r);Mn=(e.flags&131072)!==0}else Mn=!1,Ut&&(t.flags&1048576)!==0&&dh(t,Cl,t.index);switch(t.lanes=0,t.tag){case 16:e:{var a=t.pendingProps;if(e=ss(t.elementType),t.type=e,typeof e=="function")ac(e)?(a=us(e,a),t.tag=1,t=Om(null,t,e,a,r)):(t.tag=0,t=Yc(null,t,e,a,r));else{if(e!=null){var d=e.$$typeof;if(d===U){t.tag=11,t=wm(null,t,e,a,r);break e}else if(d===L){t.tag=14,t=Sm(null,t,e,a,r);break e}}throw t=je(e)||e,Error(l(306,t,""))}}return t;case 0:return Yc(e,t,t.type,t.pendingProps,r);case 1:return a=t.type,d=us(a,t.pendingProps),Om(e,t,a,d,r);case 3:e:{if(Ne(t,t.stateNode.containerInfo),e===null)throw Error(l(387));a=t.pendingProps;var h=t.memoizedState;d=h.element,Sc(e,t),Ll(t,a,null,r);var v=t.memoizedState;if(a=v.cache,jr(t,kn,a),a!==h.cache&&gc(t,[kn],r,!0),Il(),a=v.element,h.isDehydrated)if(h={element:a,isDehydrated:!1,cache:v.cache},t.updateQueue.baseState=h,t.memoizedState=h,t.flags&256){t=Tm(e,t,a,r);break e}else if(a!==d){d=xo(Error(l(424)),t),kl(d),t=Tm(e,t,a,r);break e}else for(e=t.stateNode.containerInfo,e.nodeType===9?e=e.body:e=e.nodeName==="HTML"?e.ownerDocument.body:e,pn=Co(e.firstChild),Dn=t,Ut=!0,Cr=null,So=!0,r=Ch(t,null,a,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(ts(),a===d){t=rr(e,t,r);break e}zn(e,t,a,r)}t=t.child}return t;case 26:return pi(e,t),e===null?(r=Fg(t.type,null,t.pendingProps,null))?t.memoizedState=r:Ut||(r=t.type,e=t.pendingProps,a=Ei(qe.current).createElement(r),a[Nt]=t,a[ct]=e,Hn(a,r,e),Xe(a),t.stateNode=a):t.memoizedState=Fg(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return Y(t),e===null&&Ut&&(a=t.stateNode=Kg(t.type,t.pendingProps,qe.current),Dn=t,So=!0,d=pn,Hr(t.type)?(_d=d,pn=Co(a.firstChild)):pn=d),zn(e,t,t.pendingProps.children,r),pi(e,t),e===null&&(t.flags|=4194304),t.child;case 5:return e===null&&Ut&&((d=a=pn)&&(a=t1(a,t.type,t.pendingProps,So),a!==null?(t.stateNode=a,Dn=t,pn=Co(a.firstChild),So=!1,d=!0):d=!1),d||kr(t)),Y(t),d=t.type,h=t.pendingProps,v=e!==null?e.memoizedProps:null,a=h.children,Ed(d,h)?a=null:v!==null&&Ed(d,v)&&(t.flags|=32),t.memoizedState!==null&&(d=Tc(e,t,gv,null,null,r),Zl._currentValue=d),pi(e,t),zn(e,t,a,r),t.child;case 6:return e===null&&Ut&&((e=r=pn)&&(r=n1(r,t.pendingProps,So),r!==null?(t.stateNode=r,Dn=t,pn=null,e=!0):e=!1),e||kr(t)),null;case 13:return Em(e,t,r);case 4:return Ne(t,t.stateNode.containerInfo),a=t.pendingProps,e===null?t.child=as(t,null,a,r):zn(e,t,a,r),t.child;case 11:return wm(e,t,t.type,t.pendingProps,r);case 7:return zn(e,t,t.pendingProps,r),t.child;case 8:return zn(e,t,t.pendingProps.children,r),t.child;case 12:return zn(e,t,t.pendingProps.children,r),t.child;case 10:return a=t.pendingProps,jr(t,t.type,a.value),zn(e,t,a.children,r),t.child;case 9:return d=t.type._context,a=t.pendingProps.children,os(t),d=Bn(d),a=a(d),t.flags|=1,zn(e,t,a,r),t.child;case 14:return Sm(e,t,t.type,t.pendingProps,r);case 15:return Nm(e,t,t.type,t.pendingProps,r);case 19:return Lm(e,t,r);case 31:return Cv(e,t,r);case 22:return Cm(e,t,r,t.pendingProps);case 24:return os(t),a=Bn(kn),e===null?(d=xc(),d===null&&(d=un,h=yc(),d.pooledCache=h,h.refCount++,h!==null&&(d.pooledCacheLanes|=r),d=h),t.memoizedState={parent:a,cache:d},wc(t),jr(t,kn,d)):((e.lanes&r)!==0&&(Sc(e,t),Ll(t,null,null,r),Il()),d=e.memoizedState,h=t.memoizedState,d.parent!==a?(d={parent:a,cache:a},t.memoizedState=d,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=d),jr(t,kn,a)):(a=h.cache,jr(t,kn,a),a!==d.cache&&gc(t,[kn],r,!0))),zn(e,t,t.pendingProps.children,r),t.child;case 29:throw t.pendingProps}throw Error(l(156,t.tag))}function sr(e){e.flags|=4}function od(e,t,r,a,d){if((t=(e.mode&32)!==0)&&(t=!1),t){if(e.flags|=16777216,(d&335544128)===d)if(e.stateNode.complete)e.flags|=8192;else if(lg())e.flags|=8192;else throw ls=Za,vc}else e.flags&=-16777217}function Rm(e,t){if(t.type!=="stylesheet"||(t.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!Yg(t))if(lg())e.flags|=8192;else throw ls=Za,vc}function mi(e,t){t!==null&&(e.flags|=4),e.flags&16384&&(t=e.tag!==22?zt():536870912,e.lanes|=t,Us|=t)}function zl(e,t){if(!Ut)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var a=null;r!==null;)r.alternate!==null&&(a=r),r=r.sibling;a===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:a.sibling=null}}function hn(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,a=0;if(t)for(var d=e.child;d!==null;)r|=d.lanes|d.childLanes,a|=d.subtreeFlags&65011712,a|=d.flags&65011712,d.return=e,d=d.sibling;else for(d=e.child;d!==null;)r|=d.lanes|d.childLanes,a|=d.subtreeFlags,a|=d.flags,d.return=e,d=d.sibling;return e.subtreeFlags|=a,e.childLanes=r,t}function jv(e,t,r){var a=t.pendingProps;switch(dc(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return hn(t),null;case 1:return hn(t),null;case 3:return r=t.stateNode,a=null,e!==null&&(a=e.memoizedState.cache),t.memoizedState.cache!==a&&(t.flags|=2048),tr(kn),H(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(Ts(t)?sr(t):e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,pc())),hn(t),null;case 26:var d=t.type,h=t.memoizedState;return e===null?(sr(t),h!==null?(hn(t),Rm(t,h)):(hn(t),od(t,d,null,a,r))):h?h!==e.memoizedState?(sr(t),hn(t),Rm(t,h)):(hn(t),t.flags&=-16777217):(e=e.memoizedProps,e!==a&&sr(t),hn(t),od(t,d,e,a,r)),null;case 27:if(D(t),r=qe.current,d=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==a&&sr(t);else{if(!a){if(t.stateNode===null)throw Error(l(166));return hn(t),null}e=ee.current,Ts(t)?ph(t):(e=Kg(d,a,r),t.stateNode=e,sr(t))}return hn(t),null;case 5:if(D(t),d=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==a&&sr(t);else{if(!a){if(t.stateNode===null)throw Error(l(166));return hn(t),null}if(h=ee.current,Ts(t))ph(t);else{var v=Ei(qe.current);switch(h){case 1:h=v.createElementNS("http://www.w3.org/2000/svg",d);break;case 2:h=v.createElementNS("http://www.w3.org/1998/Math/MathML",d);break;default:switch(d){case"svg":h=v.createElementNS("http://www.w3.org/2000/svg",d);break;case"math":h=v.createElementNS("http://www.w3.org/1998/Math/MathML",d);break;case"script":h=v.createElement("div"),h.innerHTML="<script><\/script>",h=h.removeChild(h.firstChild);break;case"select":h=typeof a.is=="string"?v.createElement("select",{is:a.is}):v.createElement("select"),a.multiple?h.multiple=!0:a.size&&(h.size=a.size);break;default:h=typeof a.is=="string"?v.createElement(d,{is:a.is}):v.createElement(d)}}h[Nt]=t,h[ct]=a;e:for(v=t.child;v!==null;){if(v.tag===5||v.tag===6)h.appendChild(v.stateNode);else if(v.tag!==4&&v.tag!==27&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===t)break e;for(;v.sibling===null;){if(v.return===null||v.return===t)break e;v=v.return}v.sibling.return=v.return,v=v.sibling}t.stateNode=h;e:switch(Hn(h,d,a),d){case"button":case"input":case"select":case"textarea":a=!!a.autoFocus;break e;case"img":a=!0;break e;default:a=!1}a&&sr(t)}}return hn(t),od(t,t.type,e===null?null:e.memoizedProps,t.pendingProps,r),null;case 6:if(e&&t.stateNode!=null)e.memoizedProps!==a&&sr(t);else{if(typeof a!="string"&&t.stateNode===null)throw Error(l(166));if(e=qe.current,Ts(t)){if(e=t.stateNode,r=t.memoizedProps,a=null,d=Dn,d!==null)switch(d.tag){case 27:case 5:a=d.memoizedProps}e[Nt]=t,e=!!(e.nodeValue===r||a!==null&&a.suppressHydrationWarning===!0||Eg(e.nodeValue,r)),e||kr(t,!0)}else e=Ei(e).createTextNode(a),e[Nt]=t,t.stateNode=e}return hn(t),null;case 31:if(r=t.memoizedState,e===null||e.memoizedState!==null){if(a=Ts(t),r!==null){if(e===null){if(!a)throw Error(l(318));if(e=t.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(l(557));e[Nt]=t}else ts(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;hn(t),e=!1}else r=pc(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=r),e=!0;if(!e)return t.flags&256?(io(t),t):(io(t),null);if((t.flags&128)!==0)throw Error(l(558))}return hn(t),null;case 13:if(a=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(d=Ts(t),a!==null&&a.dehydrated!==null){if(e===null){if(!d)throw Error(l(318));if(d=t.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(l(317));d[Nt]=t}else ts(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;hn(t),d=!1}else d=pc(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=d),d=!0;if(!d)return t.flags&256?(io(t),t):(io(t),null)}return io(t),(t.flags&128)!==0?(t.lanes=r,t):(r=a!==null,e=e!==null&&e.memoizedState!==null,r&&(a=t.child,d=null,a.alternate!==null&&a.alternate.memoizedState!==null&&a.alternate.memoizedState.cachePool!==null&&(d=a.alternate.memoizedState.cachePool.pool),h=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(h=a.memoizedState.cachePool.pool),h!==d&&(a.flags|=2048)),r!==e&&r&&(t.child.flags|=8192),mi(t,t.updateQueue),hn(t),null);case 4:return H(),e===null&&kd(t.stateNode.containerInfo),hn(t),null;case 10:return tr(t.type),hn(t),null;case 19:if(A(vn),a=t.memoizedState,a===null)return hn(t),null;if(d=(t.flags&128)!==0,h=a.rendering,h===null)if(d)zl(a,!1);else{if(bn!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(h=ni(e),h!==null){for(t.flags|=128,zl(a,!1),e=h.updateQueue,t.updateQueue=e,mi(t,e),t.subtreeFlags=0,e=r,r=t.child;r!==null;)ih(r,e),r=r.sibling;return M(vn,vn.current&1|2),Ut&&Jo(t,a.treeForkCount),t.child}e=e.sibling}a.tail!==null&&me()>vi&&(t.flags|=128,d=!0,zl(a,!1),t.lanes=4194304)}else{if(!d)if(e=ni(h),e!==null){if(t.flags|=128,d=!0,e=e.updateQueue,t.updateQueue=e,mi(t,e),zl(a,!0),a.tail===null&&a.tailMode==="hidden"&&!h.alternate&&!Ut)return hn(t),null}else 2*me()-a.renderingStartTime>vi&&r!==536870912&&(t.flags|=128,d=!0,zl(a,!1),t.lanes=4194304);a.isBackwards?(h.sibling=t.child,t.child=h):(e=a.last,e!==null?e.sibling=h:t.child=h,a.last=h)}return a.tail!==null?(e=a.tail,a.rendering=e,a.tail=e.sibling,a.renderingStartTime=me(),e.sibling=null,r=vn.current,M(vn,d?r&1|2:r&1),Ut&&Jo(t,a.treeForkCount),e):(hn(t),null);case 22:case 23:return io(t),jc(),a=t.memoizedState!==null,e!==null?e.memoizedState!==null!==a&&(t.flags|=8192):a&&(t.flags|=8192),a?(r&536870912)!==0&&(t.flags&128)===0&&(hn(t),t.subtreeFlags&6&&(t.flags|=8192)):hn(t),r=t.updateQueue,r!==null&&mi(t,r.retryQueue),r=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(r=e.memoizedState.cachePool.pool),a=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(a=t.memoizedState.cachePool.pool),a!==r&&(t.flags|=2048),e!==null&&A(rs),null;case 24:return r=null,e!==null&&(r=e.memoizedState.cache),t.memoizedState.cache!==r&&(t.flags|=2048),tr(kn),hn(t),null;case 25:return null;case 30:return null}throw Error(l(156,t.tag))}function Mv(e,t){switch(dc(t),t.tag){case 1:return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return tr(kn),H(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 26:case 27:case 5:return D(t),null;case 31:if(t.memoizedState!==null){if(io(t),t.alternate===null)throw Error(l(340));ts()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 13:if(io(t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(l(340));ts()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return A(vn),null;case 4:return H(),null;case 10:return tr(t.type),null;case 22:case 23:return io(t),jc(),e!==null&&A(rs),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 24:return tr(kn),null;case 25:return null;default:return null}}function _m(e,t){switch(dc(t),t.tag){case 3:tr(kn),H();break;case 26:case 27:case 5:D(t);break;case 4:H();break;case 31:t.memoizedState!==null&&io(t);break;case 13:io(t);break;case 19:A(vn);break;case 10:tr(t.type);break;case 22:case 23:io(t),jc(),e!==null&&A(rs);break;case 24:tr(kn)}}function Hl(e,t){try{var r=t.updateQueue,a=r!==null?r.lastEffect:null;if(a!==null){var d=a.next;r=d;do{if((r.tag&e)===e){a=void 0;var h=r.create,v=r.inst;a=h(),v.destroy=a}r=r.next}while(r!==d)}}catch(O){en(t,t.return,O)}}function Lr(e,t,r){try{var a=t.updateQueue,d=a!==null?a.lastEffect:null;if(d!==null){var h=d.next;a=h;do{if((a.tag&e)===e){var v=a.inst,O=v.destroy;if(O!==void 0){v.destroy=void 0,d=t;var G=r,ge=O;try{ge()}catch(_e){en(d,G,_e)}}}a=a.next}while(a!==h)}}catch(_e){en(t,t.return,_e)}}function Dm(e){var t=e.updateQueue;if(t!==null){var r=e.stateNode;try{jh(t,r)}catch(a){en(e,e.return,a)}}}function Bm(e,t,r){r.props=us(e.type,e.memoizedProps),r.state=e.memoizedState;try{r.componentWillUnmount()}catch(a){en(e,t,a)}}function Vl(e,t){try{var r=e.ref;if(r!==null){switch(e.tag){case 26:case 27:case 5:var a=e.stateNode;break;case 30:a=e.stateNode;break;default:a=e.stateNode}typeof r=="function"?e.refCleanup=r(a):r.current=a}}catch(d){en(e,t,d)}}function Ko(e,t){var r=e.ref,a=e.refCleanup;if(r!==null)if(typeof a=="function")try{a()}catch(d){en(e,t,d)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof r=="function")try{r(null)}catch(d){en(e,t,d)}else r.current=null}function zm(e){var t=e.type,r=e.memoizedProps,a=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":r.autoFocus&&a.focus();break e;case"img":r.src?a.src=r.src:r.srcSet&&(a.srcset=r.srcSet)}}catch(d){en(e,e.return,d)}}function rd(e,t,r){try{var a=e.stateNode;Yv(a,e.type,r,t),a[ct]=t}catch(d){en(e,e.return,d)}}function Hm(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&Hr(e.type)||e.tag===4}function sd(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Hm(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&Hr(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function ld(e,t,r){var a=e.tag;if(a===5||a===6)e=e.stateNode,t?(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r).insertBefore(e,t):(t=r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,t.appendChild(e),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=yo));else if(a!==4&&(a===27&&Hr(e.type)&&(r=e.stateNode,t=null),e=e.child,e!==null))for(ld(e,t,r),e=e.sibling;e!==null;)ld(e,t,r),e=e.sibling}function gi(e,t,r){var a=e.tag;if(a===5||a===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(a!==4&&(a===27&&Hr(e.type)&&(r=e.stateNode),e=e.child,e!==null))for(gi(e,t,r),e=e.sibling;e!==null;)gi(e,t,r),e=e.sibling}function Vm(e){var t=e.stateNode,r=e.memoizedProps;try{for(var a=e.type,d=t.attributes;d.length;)t.removeAttributeNode(d[0]);Hn(t,a,r),t[Nt]=e,t[ct]=r}catch(h){en(e,e.return,h)}}var lr=!1,On=!1,ad=!1,Km=typeof WeakSet=="function"?WeakSet:Set,_n=null;function Ov(e,t){if(e=e.containerInfo,Od=Bi,e=Jp(e),ec(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var a=r.getSelection&&r.getSelection();if(a&&a.rangeCount!==0){r=a.anchorNode;var d=a.anchorOffset,h=a.focusNode;a=a.focusOffset;try{r.nodeType,h.nodeType}catch{r=null;break e}var v=0,O=-1,G=-1,ge=0,_e=0,ze=e,ve=null;t:for(;;){for(var Ce;ze!==r||d!==0&&ze.nodeType!==3||(O=v+d),ze!==h||a!==0&&ze.nodeType!==3||(G=v+a),ze.nodeType===3&&(v+=ze.nodeValue.length),(Ce=ze.firstChild)!==null;)ve=ze,ze=Ce;for(;;){if(ze===e)break t;if(ve===r&&++ge===d&&(O=v),ve===h&&++_e===a&&(G=v),(Ce=ze.nextSibling)!==null)break;ze=ve,ve=ze.parentNode}ze=Ce}r=O===-1||G===-1?null:{start:O,end:G}}else r=null}r=r||{start:0,end:0}}else r=null;for(Td={focusedElem:e,selectionRange:r},Bi=!1,_n=t;_n!==null;)if(t=_n,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,_n=e;else for(;_n!==null;){switch(t=_n,h=t.alternate,e=t.flags,t.tag){case 0:if((e&4)!==0&&(e=t.updateQueue,e=e!==null?e.events:null,e!==null))for(r=0;r<e.length;r++)d=e[r],d.ref.impl=d.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&h!==null){e=void 0,r=t,d=h.memoizedProps,h=h.memoizedState,a=r.stateNode;try{var dt=us(r.type,d);e=a.getSnapshotBeforeUpdate(dt,h),a.__reactInternalSnapshotBeforeUpdate=e}catch(kt){en(r,r.return,kt)}}break;case 3:if((e&1024)!==0){if(e=t.stateNode.containerInfo,r=e.nodeType,r===9)Ld(e);else if(r===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Ld(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(l(163))}if(e=t.sibling,e!==null){e.return=t.return,_n=e;break}_n=t.return}}function Um(e,t,r){var a=r.flags;switch(r.tag){case 0:case 11:case 15:ir(e,r),a&4&&Hl(5,r);break;case 1:if(ir(e,r),a&4)if(e=r.stateNode,t===null)try{e.componentDidMount()}catch(v){en(r,r.return,v)}else{var d=us(r.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(d,t,e.__reactInternalSnapshotBeforeUpdate)}catch(v){en(r,r.return,v)}}a&64&&Dm(r),a&512&&Vl(r,r.return);break;case 3:if(ir(e,r),a&64&&(e=r.updateQueue,e!==null)){if(t=null,r.child!==null)switch(r.child.tag){case 27:case 5:t=r.child.stateNode;break;case 1:t=r.child.stateNode}try{jh(e,t)}catch(v){en(r,r.return,v)}}break;case 27:t===null&&a&4&&Vm(r);case 26:case 5:ir(e,r),t===null&&a&4&&zm(r),a&512&&Vl(r,r.return);break;case 12:ir(e,r);break;case 31:ir(e,r),a&4&&qm(e,r);break;case 13:ir(e,r),a&4&&Wm(e,r),a&64&&(e=r.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(r=Bv.bind(null,r),o1(e,r))));break;case 22:if(a=r.memoizedState!==null||lr,!a){t=t!==null&&t.memoizedState!==null||On,d=lr;var h=On;lr=a,(On=t)&&!h?ur(e,r,(r.subtreeFlags&8772)!==0):ir(e,r),lr=d,On=h}break;case 30:break;default:ir(e,r)}}function $m(e){var t=e.alternate;t!==null&&(e.alternate=null,$m(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&P(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var gn=null,Qn=!1;function ar(e,t,r){for(r=r.child;r!==null;)Fm(e,t,r),r=r.sibling}function Fm(e,t,r){if(Fe&&typeof Fe.onCommitFiberUnmount=="function")try{Fe.onCommitFiberUnmount($e,r)}catch{}switch(r.tag){case 26:On||Ko(r,t),ar(e,t,r),r.memoizedState?r.memoizedState.count--:r.stateNode&&(r=r.stateNode,r.parentNode.removeChild(r));break;case 27:On||Ko(r,t);var a=gn,d=Qn;Hr(r.type)&&(gn=r.stateNode,Qn=!1),ar(e,t,r),Yl(r.stateNode),gn=a,Qn=d;break;case 5:On||Ko(r,t);case 6:if(a=gn,d=Qn,gn=null,ar(e,t,r),gn=a,Qn=d,gn!==null)if(Qn)try{(gn.nodeType===9?gn.body:gn.nodeName==="HTML"?gn.ownerDocument.body:gn).removeChild(r.stateNode)}catch(h){en(r,t,h)}else try{gn.removeChild(r.stateNode)}catch(h){en(r,t,h)}break;case 18:gn!==null&&(Qn?(e=gn,Dg(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,r.stateNode),Qs(e)):Dg(gn,r.stateNode));break;case 4:a=gn,d=Qn,gn=r.stateNode.containerInfo,Qn=!0,ar(e,t,r),gn=a,Qn=d;break;case 0:case 11:case 14:case 15:Lr(2,r,t),On||Lr(4,r,t),ar(e,t,r);break;case 1:On||(Ko(r,t),a=r.stateNode,typeof a.componentWillUnmount=="function"&&Bm(r,t,a)),ar(e,t,r);break;case 21:ar(e,t,r);break;case 22:On=(a=On)||r.memoizedState!==null,ar(e,t,r),On=a;break;default:ar(e,t,r)}}function qm(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{Qs(e)}catch(r){en(t,t.return,r)}}}function Wm(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{Qs(e)}catch(r){en(t,t.return,r)}}function Tv(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return t===null&&(t=e.stateNode=new Km),t;case 22:return e=e.stateNode,t=e._retryCache,t===null&&(t=e._retryCache=new Km),t;default:throw Error(l(435,e.tag))}}function yi(e,t){var r=Tv(e);t.forEach(function(a){if(!r.has(a)){r.add(a);var d=zv.bind(null,e,a);a.then(d,d)}})}function Xn(e,t){var r=t.deletions;if(r!==null)for(var a=0;a<r.length;a++){var d=r[a],h=e,v=t,O=v;e:for(;O!==null;){switch(O.tag){case 27:if(Hr(O.type)){gn=O.stateNode,Qn=!1;break e}break;case 5:gn=O.stateNode,Qn=!1;break e;case 3:case 4:gn=O.stateNode.containerInfo,Qn=!0;break e}O=O.return}if(gn===null)throw Error(l(160));Fm(h,v,d),gn=null,Qn=!1,h=d.alternate,h!==null&&(h.return=null),d.return=null}if(t.subtreeFlags&13886)for(t=t.child;t!==null;)Gm(t,e),t=t.sibling}var Eo=null;function Gm(e,t){var r=e.alternate,a=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Xn(t,e),Zn(e),a&4&&(Lr(3,e,e.return),Hl(3,e),Lr(5,e,e.return));break;case 1:Xn(t,e),Zn(e),a&512&&(On||r===null||Ko(r,r.return)),a&64&&lr&&(e=e.updateQueue,e!==null&&(a=e.callbacks,a!==null&&(r=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=r===null?a:r.concat(a))));break;case 26:var d=Eo;if(Xn(t,e),Zn(e),a&512&&(On||r===null||Ko(r,r.return)),a&4){var h=r!==null?r.memoizedState:null;if(a=e.memoizedState,r===null)if(a===null)if(e.stateNode===null){e:{a=e.type,r=e.memoizedProps,d=d.ownerDocument||d;t:switch(a){case"title":h=d.getElementsByTagName("title")[0],(!h||h[cn]||h[Nt]||h.namespaceURI==="http://www.w3.org/2000/svg"||h.hasAttribute("itemprop"))&&(h=d.createElement(a),d.head.insertBefore(h,d.querySelector("head > title"))),Hn(h,a,r),h[Nt]=e,Xe(h),a=h;break e;case"link":var v=Gg("link","href",d).get(a+(r.href||""));if(v){for(var O=0;O<v.length;O++)if(h=v[O],h.getAttribute("href")===(r.href==null||r.href===""?null:r.href)&&h.getAttribute("rel")===(r.rel==null?null:r.rel)&&h.getAttribute("title")===(r.title==null?null:r.title)&&h.getAttribute("crossorigin")===(r.crossOrigin==null?null:r.crossOrigin)){v.splice(O,1);break t}}h=d.createElement(a),Hn(h,a,r),d.head.appendChild(h);break;case"meta":if(v=Gg("meta","content",d).get(a+(r.content||""))){for(O=0;O<v.length;O++)if(h=v[O],h.getAttribute("content")===(r.content==null?null:""+r.content)&&h.getAttribute("name")===(r.name==null?null:r.name)&&h.getAttribute("property")===(r.property==null?null:r.property)&&h.getAttribute("http-equiv")===(r.httpEquiv==null?null:r.httpEquiv)&&h.getAttribute("charset")===(r.charSet==null?null:r.charSet)){v.splice(O,1);break t}}h=d.createElement(a),Hn(h,a,r),d.head.appendChild(h);break;default:throw Error(l(468,a))}h[Nt]=e,Xe(h),a=h}e.stateNode=a}else Pg(d,e.type,e.stateNode);else e.stateNode=Wg(d,a,e.memoizedProps);else h!==a?(h===null?r.stateNode!==null&&(r=r.stateNode,r.parentNode.removeChild(r)):h.count--,a===null?Pg(d,e.type,e.stateNode):Wg(d,a,e.memoizedProps)):a===null&&e.stateNode!==null&&rd(e,e.memoizedProps,r.memoizedProps)}break;case 27:Xn(t,e),Zn(e),a&512&&(On||r===null||Ko(r,r.return)),r!==null&&a&4&&rd(e,e.memoizedProps,r.memoizedProps);break;case 5:if(Xn(t,e),Zn(e),a&512&&(On||r===null||Ko(r,r.return)),e.flags&32){d=e.stateNode;try{wr(d,"")}catch(dt){en(e,e.return,dt)}}a&4&&e.stateNode!=null&&(d=e.memoizedProps,rd(e,d,r!==null?r.memoizedProps:d)),a&1024&&(ad=!0);break;case 6:if(Xn(t,e),Zn(e),a&4){if(e.stateNode===null)throw Error(l(162));a=e.memoizedProps,r=e.stateNode;try{r.nodeValue=a}catch(dt){en(e,e.return,dt)}}break;case 3:if(Ai=null,d=Eo,Eo=Ii(t.containerInfo),Xn(t,e),Eo=d,Zn(e),a&4&&r!==null&&r.memoizedState.isDehydrated)try{Qs(t.containerInfo)}catch(dt){en(e,e.return,dt)}ad&&(ad=!1,Pm(e));break;case 4:a=Eo,Eo=Ii(e.stateNode.containerInfo),Xn(t,e),Zn(e),Eo=a;break;case 12:Xn(t,e),Zn(e);break;case 31:Xn(t,e),Zn(e),a&4&&(a=e.updateQueue,a!==null&&(e.updateQueue=null,yi(e,a)));break;case 13:Xn(t,e),Zn(e),e.child.flags&8192&&e.memoizedState!==null!=(r!==null&&r.memoizedState!==null)&&(xi=me()),a&4&&(a=e.updateQueue,a!==null&&(e.updateQueue=null,yi(e,a)));break;case 22:d=e.memoizedState!==null;var G=r!==null&&r.memoizedState!==null,ge=lr,_e=On;if(lr=ge||d,On=_e||G,Xn(t,e),On=_e,lr=ge,Zn(e),a&8192)e:for(t=e.stateNode,t._visibility=d?t._visibility&-2:t._visibility|1,d&&(r===null||G||lr||On||cs(e)),r=null,t=e;;){if(t.tag===5||t.tag===26){if(r===null){G=r=t;try{if(h=G.stateNode,d)v=h.style,typeof v.setProperty=="function"?v.setProperty("display","none","important"):v.display="none";else{O=G.stateNode;var ze=G.memoizedProps.style,ve=ze!=null&&ze.hasOwnProperty("display")?ze.display:null;O.style.display=ve==null||typeof ve=="boolean"?"":(""+ve).trim()}}catch(dt){en(G,G.return,dt)}}}else if(t.tag===6){if(r===null){G=t;try{G.stateNode.nodeValue=d?"":G.memoizedProps}catch(dt){en(G,G.return,dt)}}}else if(t.tag===18){if(r===null){G=t;try{var Ce=G.stateNode;d?Bg(Ce,!0):Bg(G.stateNode,!1)}catch(dt){en(G,G.return,dt)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;r===t&&(r=null),t=t.return}r===t&&(r=null),t.sibling.return=t.return,t=t.sibling}a&4&&(a=e.updateQueue,a!==null&&(r=a.retryQueue,r!==null&&(a.retryQueue=null,yi(e,r))));break;case 19:Xn(t,e),Zn(e),a&4&&(a=e.updateQueue,a!==null&&(e.updateQueue=null,yi(e,a)));break;case 30:break;case 21:break;default:Xn(t,e),Zn(e)}}function Zn(e){var t=e.flags;if(t&2){try{for(var r,a=e.return;a!==null;){if(Hm(a)){r=a;break}a=a.return}if(r==null)throw Error(l(160));switch(r.tag){case 27:var d=r.stateNode,h=sd(e);gi(e,h,d);break;case 5:var v=r.stateNode;r.flags&32&&(wr(v,""),r.flags&=-33);var O=sd(e);gi(e,O,v);break;case 3:case 4:var G=r.stateNode.containerInfo,ge=sd(e);ld(e,ge,G);break;default:throw Error(l(161))}}catch(_e){en(e,e.return,_e)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Pm(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var t=e;Pm(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),e=e.sibling}}function ir(e,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)Um(e,t.alternate,t),t=t.sibling}function cs(e){for(e=e.child;e!==null;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:Lr(4,t,t.return),cs(t);break;case 1:Ko(t,t.return);var r=t.stateNode;typeof r.componentWillUnmount=="function"&&Bm(t,t.return,r),cs(t);break;case 27:Yl(t.stateNode);case 26:case 5:Ko(t,t.return),cs(t);break;case 22:t.memoizedState===null&&cs(t);break;case 30:cs(t);break;default:cs(t)}e=e.sibling}}function ur(e,t,r){for(r=r&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var a=t.alternate,d=e,h=t,v=h.flags;switch(h.tag){case 0:case 11:case 15:ur(d,h,r),Hl(4,h);break;case 1:if(ur(d,h,r),a=h,d=a.stateNode,typeof d.componentDidMount=="function")try{d.componentDidMount()}catch(ge){en(a,a.return,ge)}if(a=h,d=a.updateQueue,d!==null){var O=a.stateNode;try{var G=d.shared.hiddenCallbacks;if(G!==null)for(d.shared.hiddenCallbacks=null,d=0;d<G.length;d++)kh(G[d],O)}catch(ge){en(a,a.return,ge)}}r&&v&64&&Dm(h),Vl(h,h.return);break;case 27:Vm(h);case 26:case 5:ur(d,h,r),r&&a===null&&v&4&&zm(h),Vl(h,h.return);break;case 12:ur(d,h,r);break;case 31:ur(d,h,r),r&&v&4&&qm(d,h);break;case 13:ur(d,h,r),r&&v&4&&Wm(d,h);break;case 22:h.memoizedState===null&&ur(d,h,r),Vl(h,h.return);break;case 30:break;default:ur(d,h,r)}t=t.sibling}}function id(e,t){var r=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(r=e.memoizedState.cachePool.pool),e=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(e=t.memoizedState.cachePool.pool),e!==r&&(e!=null&&e.refCount++,r!=null&&jl(r))}function ud(e,t){e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&jl(e))}function Io(e,t,r,a){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)Ym(e,t,r,a),t=t.sibling}function Ym(e,t,r,a){var d=t.flags;switch(t.tag){case 0:case 11:case 15:Io(e,t,r,a),d&2048&&Hl(9,t);break;case 1:Io(e,t,r,a);break;case 3:Io(e,t,r,a),d&2048&&(e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&jl(e)));break;case 12:if(d&2048){Io(e,t,r,a),e=t.stateNode;try{var h=t.memoizedProps,v=h.id,O=h.onPostCommit;typeof O=="function"&&O(v,t.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(G){en(t,t.return,G)}}else Io(e,t,r,a);break;case 31:Io(e,t,r,a);break;case 13:Io(e,t,r,a);break;case 23:break;case 22:h=t.stateNode,v=t.alternate,t.memoizedState!==null?h._visibility&2?Io(e,t,r,a):Kl(e,t):h._visibility&2?Io(e,t,r,a):(h._visibility|=2,Hs(e,t,r,a,(t.subtreeFlags&10256)!==0||!1)),d&2048&&id(v,t);break;case 24:Io(e,t,r,a),d&2048&&ud(t.alternate,t);break;default:Io(e,t,r,a)}}function Hs(e,t,r,a,d){for(d=d&&((t.subtreeFlags&10256)!==0||!1),t=t.child;t!==null;){var h=e,v=t,O=r,G=a,ge=v.flags;switch(v.tag){case 0:case 11:case 15:Hs(h,v,O,G,d),Hl(8,v);break;case 23:break;case 22:var _e=v.stateNode;v.memoizedState!==null?_e._visibility&2?Hs(h,v,O,G,d):Kl(h,v):(_e._visibility|=2,Hs(h,v,O,G,d)),d&&ge&2048&&id(v.alternate,v);break;case 24:Hs(h,v,O,G,d),d&&ge&2048&&ud(v.alternate,v);break;default:Hs(h,v,O,G,d)}t=t.sibling}}function Kl(e,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var r=e,a=t,d=a.flags;switch(a.tag){case 22:Kl(r,a),d&2048&&id(a.alternate,a);break;case 24:Kl(r,a),d&2048&&ud(a.alternate,a);break;default:Kl(r,a)}t=t.sibling}}var Ul=8192;function Vs(e,t,r){if(e.subtreeFlags&Ul)for(e=e.child;e!==null;)Qm(e,t,r),e=e.sibling}function Qm(e,t,r){switch(e.tag){case 26:Vs(e,t,r),e.flags&Ul&&e.memoizedState!==null&&m1(r,Eo,e.memoizedState,e.memoizedProps);break;case 5:Vs(e,t,r);break;case 3:case 4:var a=Eo;Eo=Ii(e.stateNode.containerInfo),Vs(e,t,r),Eo=a;break;case 22:e.memoizedState===null&&(a=e.alternate,a!==null&&a.memoizedState!==null?(a=Ul,Ul=16777216,Vs(e,t,r),Ul=a):Vs(e,t,r));break;default:Vs(e,t,r)}}function Xm(e){var t=e.alternate;if(t!==null&&(e=t.child,e!==null)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(e!==null)}}function $l(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var r=0;r<t.length;r++){var a=t[r];_n=a,Jm(a,e)}Xm(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)Zm(e),e=e.sibling}function Zm(e){switch(e.tag){case 0:case 11:case 15:$l(e),e.flags&2048&&Lr(9,e,e.return);break;case 3:$l(e);break;case 12:$l(e);break;case 22:var t=e.stateNode;e.memoizedState!==null&&t._visibility&2&&(e.return===null||e.return.tag!==13)?(t._visibility&=-3,bi(e)):$l(e);break;default:$l(e)}}function bi(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var r=0;r<t.length;r++){var a=t[r];_n=a,Jm(a,e)}Xm(e)}for(e=e.child;e!==null;){switch(t=e,t.tag){case 0:case 11:case 15:Lr(8,t,t.return),bi(t);break;case 22:r=t.stateNode,r._visibility&2&&(r._visibility&=-3,bi(t));break;default:bi(t)}e=e.sibling}}function Jm(e,t){for(;_n!==null;){var r=_n;switch(r.tag){case 0:case 11:case 15:Lr(8,r,t);break;case 23:case 22:if(r.memoizedState!==null&&r.memoizedState.cachePool!==null){var a=r.memoizedState.cachePool.pool;a!=null&&a.refCount++}break;case 24:jl(r.memoizedState.cache)}if(a=r.child,a!==null)a.return=r,_n=a;else e:for(r=e;_n!==null;){a=_n;var d=a.sibling,h=a.return;if($m(a),a===r){_n=null;break e}if(d!==null){d.return=h,_n=d;break e}_n=h}}}var Ev={getCacheForType:function(e){var t=Bn(kn),r=t.data.get(e);return r===void 0&&(r=e(),t.data.set(e,r)),r},cacheSignal:function(){return Bn(kn).controller.signal}},Iv=typeof WeakMap=="function"?WeakMap:Map,Yt=0,un=null,Dt=null,Vt=0,Jt=0,uo=null,Ar=!1,Ks=!1,cd=!1,cr=0,bn=0,Rr=0,ds=0,dd=0,co=0,Us=0,Fl=null,Jn=null,fd=!1,xi=0,eg=0,vi=1/0,wi=null,_r=null,Rn=0,Dr=null,$s=null,dr=0,pd=0,hd=null,tg=null,ql=0,md=null;function fo(){return(Yt&2)!==0&&Vt!==0?Vt&-Vt:_.T!==null?wd():bt()}function ng(){if(co===0)if((Vt&536870912)===0||Ut){var e=Ge;Ge<<=1,(Ge&3932160)===0&&(Ge=262144),co=e}else co=536870912;return e=ao.current,e!==null&&(e.flags|=32),co}function eo(e,t,r){(e===un&&(Jt===2||Jt===9)||e.cancelPendingCommit!==null)&&(Fs(e,0),Br(e,Vt,co,!1)),se(e,r),((Yt&2)===0||e!==un)&&(e===un&&((Yt&2)===0&&(ds|=r),bn===4&&Br(e,Vt,co,!1)),Uo(e))}function og(e,t,r){if((Yt&6)!==0)throw Error(l(327));var a=!r&&(t&127)===0&&(t&e.expiredLanes)===0||ft(e,t),d=a?Rv(e,t):yd(e,t,!0),h=a;do{if(d===0){Ks&&!a&&Br(e,t,0,!1);break}else{if(r=e.current.alternate,h&&!Lv(r)){d=yd(e,t,!1),h=!1;continue}if(d===2){if(h=t,e.errorRecoveryDisabledLanes&h)var v=0;else v=e.pendingLanes&-536870913,v=v!==0?v:v&536870912?536870912:0;if(v!==0){t=v;e:{var O=e;d=Fl;var G=O.current.memoizedState.isDehydrated;if(G&&(Fs(O,v).flags|=256),v=yd(O,v,!1),v!==2){if(cd&&!G){O.errorRecoveryDisabledLanes|=h,ds|=h,d=4;break e}h=Jn,Jn=d,h!==null&&(Jn===null?Jn=h:Jn.push.apply(Jn,h))}d=v}if(h=!1,d!==2)continue}}if(d===1){Fs(e,0),Br(e,t,0,!0);break}e:{switch(a=e,h=d,h){case 0:case 1:throw Error(l(345));case 4:if((t&4194048)!==t)break;case 6:Br(a,t,co,!Ar);break e;case 2:Jn=null;break;case 3:case 5:break;default:throw Error(l(329))}if((t&62914560)===t&&(d=xi+300-me(),10<d)){if(Br(a,t,co,!Ar),et(a,0,!0)!==0)break e;dr=t,a.timeoutHandle=Rg(rg.bind(null,a,r,Jn,wi,fd,t,co,ds,Us,Ar,h,"Throttled",-0,0),d);break e}rg(a,r,Jn,wi,fd,t,co,ds,Us,Ar,h,null,-0,0)}}break}while(!0);Uo(e)}function rg(e,t,r,a,d,h,v,O,G,ge,_e,ze,ve,Ce){if(e.timeoutHandle=-1,ze=t.subtreeFlags,ze&8192||(ze&16785408)===16785408){ze={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:yo},Qm(t,h,ze);var dt=(h&62914560)===h?xi-me():(h&4194048)===h?eg-me():0;if(dt=g1(ze,dt),dt!==null){dr=h,e.cancelPendingCommit=dt(fg.bind(null,e,t,h,r,a,d,v,O,G,_e,ze,null,ve,Ce)),Br(e,h,v,!ge);return}}fg(e,t,h,r,a,d,v,O,G)}function Lv(e){for(var t=e;;){var r=t.tag;if((r===0||r===11||r===15)&&t.flags&16384&&(r=t.updateQueue,r!==null&&(r=r.stores,r!==null)))for(var a=0;a<r.length;a++){var d=r[a],h=d.getSnapshot;d=d.value;try{if(!so(h(),d))return!1}catch{return!1}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Br(e,t,r,a){t&=~dd,t&=~ds,e.suspendedLanes|=t,e.pingedLanes&=~t,a&&(e.warmLanes|=t),a=e.expirationTimes;for(var d=t;0<d;){var h=31-ht(d),v=1<<h;a[h]=-1,d&=~v}r!==0&&Ze(e,r,t)}function Si(){return(Yt&6)===0?(Wl(0),!1):!0}function gd(){if(Dt!==null){if(Jt===0)var e=Dt.return;else e=Dt,er=ns=null,Lc(e),Rs=null,Ol=0,e=Dt;for(;e!==null;)_m(e.alternate,e),e=e.return;Dt=null}}function Fs(e,t){var r=e.timeoutHandle;r!==-1&&(e.timeoutHandle=-1,Zv(r)),r=e.cancelPendingCommit,r!==null&&(e.cancelPendingCommit=null,r()),dr=0,gd(),un=e,Dt=r=Zo(e.current,null),Vt=t,Jt=0,uo=null,Ar=!1,Ks=ft(e,t),cd=!1,Us=co=dd=ds=Rr=bn=0,Jn=Fl=null,fd=!1,(t&8)!==0&&(t|=t&32);var a=e.entangledLanes;if(a!==0)for(e=e.entanglements,a&=t;0<a;){var d=31-ht(a),h=1<<d;t|=e[d],a&=~h}return cr=t,$a(),r}function sg(e,t){Et=null,_.H=Dl,t===As||t===Xa?(t=wh(),Jt=3):t===vc?(t=wh(),Jt=4):Jt=t===Pc?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,uo=t,Dt===null&&(bn=1,di(e,xo(t,e.current)))}function lg(){var e=ao.current;return e===null?!0:(Vt&4194048)===Vt?No===null:(Vt&62914560)===Vt||(Vt&536870912)!==0?e===No:!1}function ag(){var e=_.H;return _.H=Dl,e===null?Dl:e}function ig(){var e=_.A;return _.A=Ev,e}function Ni(){bn=4,Ar||(Vt&4194048)!==Vt&&ao.current!==null||(Ks=!0),(Rr&134217727)===0&&(ds&134217727)===0||un===null||Br(un,Vt,co,!1)}function yd(e,t,r){var a=Yt;Yt|=2;var d=ag(),h=ig();(un!==e||Vt!==t)&&(wi=null,Fs(e,t)),t=!1;var v=bn;e:do try{if(Jt!==0&&Dt!==null){var O=Dt,G=uo;switch(Jt){case 8:gd(),v=6;break e;case 3:case 2:case 9:case 6:ao.current===null&&(t=!0);var ge=Jt;if(Jt=0,uo=null,qs(e,O,G,ge),r&&Ks){v=0;break e}break;default:ge=Jt,Jt=0,uo=null,qs(e,O,G,ge)}}Av(),v=bn;break}catch(_e){sg(e,_e)}while(!0);return t&&e.shellSuspendCounter++,er=ns=null,Yt=a,_.H=d,_.A=h,Dt===null&&(un=null,Vt=0,$a()),v}function Av(){for(;Dt!==null;)ug(Dt)}function Rv(e,t){var r=Yt;Yt|=2;var a=ag(),d=ig();un!==e||Vt!==t?(wi=null,vi=me()+500,Fs(e,t)):Ks=ft(e,t);e:do try{if(Jt!==0&&Dt!==null){t=Dt;var h=uo;t:switch(Jt){case 1:Jt=0,uo=null,qs(e,t,h,1);break;case 2:case 9:if(xh(h)){Jt=0,uo=null,cg(t);break}t=function(){Jt!==2&&Jt!==9||un!==e||(Jt=7),Uo(e)},h.then(t,t);break e;case 3:Jt=7;break e;case 4:Jt=5;break e;case 7:xh(h)?(Jt=0,uo=null,cg(t)):(Jt=0,uo=null,qs(e,t,h,7));break;case 5:var v=null;switch(Dt.tag){case 26:v=Dt.memoizedState;case 5:case 27:var O=Dt;if(v?Yg(v):O.stateNode.complete){Jt=0,uo=null;var G=O.sibling;if(G!==null)Dt=G;else{var ge=O.return;ge!==null?(Dt=ge,Ci(ge)):Dt=null}break t}}Jt=0,uo=null,qs(e,t,h,5);break;case 6:Jt=0,uo=null,qs(e,t,h,6);break;case 8:gd(),bn=6;break e;default:throw Error(l(462))}}_v();break}catch(_e){sg(e,_e)}while(!0);return er=ns=null,_.H=a,_.A=d,Yt=r,Dt!==null?0:(un=null,Vt=0,$a(),bn)}function _v(){for(;Dt!==null&&!q();)ug(Dt)}function ug(e){var t=Am(e.alternate,e,cr);e.memoizedProps=e.pendingProps,t===null?Ci(e):Dt=t}function cg(e){var t=e,r=t.alternate;switch(t.tag){case 15:case 0:t=Mm(r,t,t.pendingProps,t.type,void 0,Vt);break;case 11:t=Mm(r,t,t.pendingProps,t.type.render,t.ref,Vt);break;case 5:Lc(t);default:_m(r,t),t=Dt=ih(t,cr),t=Am(r,t,cr)}e.memoizedProps=e.pendingProps,t===null?Ci(e):Dt=t}function qs(e,t,r,a){er=ns=null,Lc(t),Rs=null,Ol=0;var d=t.return;try{if(Nv(e,d,t,r,Vt)){bn=1,di(e,xo(r,e.current)),Dt=null;return}}catch(h){if(d!==null)throw Dt=d,h;bn=1,di(e,xo(r,e.current)),Dt=null;return}t.flags&32768?(Ut||a===1?e=!0:Ks||(Vt&536870912)!==0?e=!1:(Ar=e=!0,(a===2||a===9||a===3||a===6)&&(a=ao.current,a!==null&&a.tag===13&&(a.flags|=16384))),dg(t,e)):Ci(t)}function Ci(e){var t=e;do{if((t.flags&32768)!==0){dg(t,Ar);return}e=t.return;var r=jv(t.alternate,t,cr);if(r!==null){Dt=r;return}if(t=t.sibling,t!==null){Dt=t;return}Dt=t=e}while(t!==null);bn===0&&(bn=5)}function dg(e,t){do{var r=Mv(e.alternate,e);if(r!==null){r.flags&=32767,Dt=r;return}if(r=e.return,r!==null&&(r.flags|=32768,r.subtreeFlags=0,r.deletions=null),!t&&(e=e.sibling,e!==null)){Dt=e;return}Dt=e=r}while(e!==null);bn=6,Dt=null}function fg(e,t,r,a,d,h,v,O,G){e.cancelPendingCommit=null;do ki();while(Rn!==0);if((Yt&6)!==0)throw Error(l(327));if(t!==null){if(t===e.current)throw Error(l(177));if(h=t.lanes|t.childLanes,h|=sc,De(e,r,h,v,O,G),e===un&&(Dt=un=null,Vt=0),$s=t,Dr=e,dr=r,pd=h,hd=d,tg=a,(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,Hv(Ae,function(){return yg(),null})):(e.callbackNode=null,e.callbackPriority=0),a=(t.flags&13878)!==0,(t.subtreeFlags&13878)!==0||a){a=_.T,_.T=null,d=oe.p,oe.p=2,v=Yt,Yt|=4;try{Ov(e,t,r)}finally{Yt=v,oe.p=d,_.T=a}}Rn=1,pg(),hg(),mg()}}function pg(){if(Rn===1){Rn=0;var e=Dr,t=$s,r=(t.flags&13878)!==0;if((t.subtreeFlags&13878)!==0||r){r=_.T,_.T=null;var a=oe.p;oe.p=2;var d=Yt;Yt|=4;try{Gm(t,e);var h=Td,v=Jp(e.containerInfo),O=h.focusedElem,G=h.selectionRange;if(v!==O&&O&&O.ownerDocument&&Zp(O.ownerDocument.documentElement,O)){if(G!==null&&ec(O)){var ge=G.start,_e=G.end;if(_e===void 0&&(_e=ge),"selectionStart"in O)O.selectionStart=ge,O.selectionEnd=Math.min(_e,O.value.length);else{var ze=O.ownerDocument||document,ve=ze&&ze.defaultView||window;if(ve.getSelection){var Ce=ve.getSelection(),dt=O.textContent.length,kt=Math.min(G.start,dt),sn=G.end===void 0?kt:Math.min(G.end,dt);!Ce.extend&&kt>sn&&(v=sn,sn=kt,kt=v);var re=Xp(O,kt),Z=Xp(O,sn);if(re&&Z&&(Ce.rangeCount!==1||Ce.anchorNode!==re.node||Ce.anchorOffset!==re.offset||Ce.focusNode!==Z.node||Ce.focusOffset!==Z.offset)){var pe=ze.createRange();pe.setStart(re.node,re.offset),Ce.removeAllRanges(),kt>sn?(Ce.addRange(pe),Ce.extend(Z.node,Z.offset)):(pe.setEnd(Z.node,Z.offset),Ce.addRange(pe))}}}}for(ze=[],Ce=O;Ce=Ce.parentNode;)Ce.nodeType===1&&ze.push({element:Ce,left:Ce.scrollLeft,top:Ce.scrollTop});for(typeof O.focus=="function"&&O.focus(),O=0;O<ze.length;O++){var Be=ze[O];Be.element.scrollLeft=Be.left,Be.element.scrollTop=Be.top}}Bi=!!Od,Td=Od=null}finally{Yt=d,oe.p=a,_.T=r}}e.current=t,Rn=2}}function hg(){if(Rn===2){Rn=0;var e=Dr,t=$s,r=(t.flags&8772)!==0;if((t.subtreeFlags&8772)!==0||r){r=_.T,_.T=null;var a=oe.p;oe.p=2;var d=Yt;Yt|=4;try{Um(e,t.alternate,t)}finally{Yt=d,oe.p=a,_.T=r}}Rn=3}}function mg(){if(Rn===4||Rn===3){Rn=0,he();var e=Dr,t=$s,r=dr,a=tg;(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?Rn=5:(Rn=0,$s=Dr=null,gg(e,e.pendingLanes));var d=e.pendingLanes;if(d===0&&(_r=null),gt(r),t=t.stateNode,Fe&&typeof Fe.onCommitFiberRoot=="function")try{Fe.onCommitFiberRoot($e,t,void 0,(t.current.flags&128)===128)}catch{}if(a!==null){t=_.T,d=oe.p,oe.p=2,_.T=null;try{for(var h=e.onRecoverableError,v=0;v<a.length;v++){var O=a[v];h(O.value,{componentStack:O.stack})}}finally{_.T=t,oe.p=d}}(dr&3)!==0&&ki(),Uo(e),d=e.pendingLanes,(r&261930)!==0&&(d&42)!==0?e===md?ql++:(ql=0,md=e):ql=0,Wl(0)}}function gg(e,t){(e.pooledCacheLanes&=t)===0&&(t=e.pooledCache,t!=null&&(e.pooledCache=null,jl(t)))}function ki(){return pg(),hg(),mg(),yg()}function yg(){if(Rn!==5)return!1;var e=Dr,t=pd;pd=0;var r=gt(dr),a=_.T,d=oe.p;try{oe.p=32>r?32:r,_.T=null,r=hd,hd=null;var h=Dr,v=dr;if(Rn=0,$s=Dr=null,dr=0,(Yt&6)!==0)throw Error(l(331));var O=Yt;if(Yt|=4,Zm(h.current),Ym(h,h.current,v,r),Yt=O,Wl(0,!1),Fe&&typeof Fe.onPostCommitFiberRoot=="function")try{Fe.onPostCommitFiberRoot($e,h)}catch{}return!0}finally{oe.p=d,_.T=a,gg(e,t)}}function bg(e,t,r){t=xo(r,t),t=Gc(e.stateNode,t,2),e=Tr(e,t,2),e!==null&&(se(e,2),Uo(e))}function en(e,t,r){if(e.tag===3)bg(e,e,r);else for(;t!==null;){if(t.tag===3){bg(t,e,r);break}else if(t.tag===1){var a=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof a.componentDidCatch=="function"&&(_r===null||!_r.has(a))){e=xo(r,e),r=xm(2),a=Tr(t,r,2),a!==null&&(vm(r,a,t,e),se(a,2),Uo(a));break}}t=t.return}}function bd(e,t,r){var a=e.pingCache;if(a===null){a=e.pingCache=new Iv;var d=new Set;a.set(t,d)}else d=a.get(t),d===void 0&&(d=new Set,a.set(t,d));d.has(r)||(cd=!0,d.add(r),e=Dv.bind(null,e,t,r),t.then(e,e))}function Dv(e,t,r){var a=e.pingCache;a!==null&&a.delete(t),e.pingedLanes|=e.suspendedLanes&r,e.warmLanes&=~r,un===e&&(Vt&r)===r&&(bn===4||bn===3&&(Vt&62914560)===Vt&&300>me()-xi?(Yt&2)===0&&Fs(e,0):dd|=r,Us===Vt&&(Us=0)),Uo(e)}function xg(e,t){t===0&&(t=zt()),e=Jr(e,t),e!==null&&(se(e,t),Uo(e))}function Bv(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),xg(e,r)}function zv(e,t){var r=0;switch(e.tag){case 31:case 13:var a=e.stateNode,d=e.memoizedState;d!==null&&(r=d.retryLane);break;case 19:a=e.stateNode;break;case 22:a=e.stateNode._retryCache;break;default:throw Error(l(314))}a!==null&&a.delete(t),xg(e,r)}function Hv(e,t){return I(e,t)}var ji=null,Ws=null,xd=!1,Mi=!1,vd=!1,zr=0;function Uo(e){e!==Ws&&e.next===null&&(Ws===null?ji=Ws=e:Ws=Ws.next=e),Mi=!0,xd||(xd=!0,Kv())}function Wl(e,t){if(!vd&&Mi){vd=!0;do for(var r=!1,a=ji;a!==null;){if(e!==0){var d=a.pendingLanes;if(d===0)var h=0;else{var v=a.suspendedLanes,O=a.pingedLanes;h=(1<<31-ht(42|e)+1)-1,h&=d&~(v&~O),h=h&201326741?h&201326741|1:h?h|2:0}h!==0&&(r=!0,Ng(a,h))}else h=Vt,h=et(a,a===un?h:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),(h&3)===0||ft(a,h)||(r=!0,Ng(a,h));a=a.next}while(r);vd=!1}}function Vv(){vg()}function vg(){Mi=xd=!1;var e=0;zr!==0&&Xv()&&(e=zr);for(var t=me(),r=null,a=ji;a!==null;){var d=a.next,h=wg(a,t);h===0?(a.next=null,r===null?ji=d:r.next=d,d===null&&(Ws=r)):(r=a,(e!==0||(h&3)!==0)&&(Mi=!0)),a=d}Rn!==0&&Rn!==5||Wl(e),zr!==0&&(zr=0)}function wg(e,t){for(var r=e.suspendedLanes,a=e.pingedLanes,d=e.expirationTimes,h=e.pendingLanes&-62914561;0<h;){var v=31-ht(h),O=1<<v,G=d[v];G===-1?((O&r)===0||(O&a)!==0)&&(d[v]=St(O,t)):G<=t&&(e.expiredLanes|=O),h&=~O}if(t=un,r=Vt,r=et(e,e===t?r:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),a=e.callbackNode,r===0||e===t&&(Jt===2||Jt===9)||e.cancelPendingCommit!==null)return a!==null&&a!==null&&B(a),e.callbackNode=null,e.callbackPriority=0;if((r&3)===0||ft(e,r)){if(t=r&-r,t===e.callbackPriority)return t;switch(a!==null&&B(a),gt(r)){case 2:case 8:r=ie;break;case 32:r=Ae;break;case 268435456:r=Je;break;default:r=Ae}return a=Sg.bind(null,e),r=I(r,a),e.callbackPriority=t,e.callbackNode=r,t}return a!==null&&a!==null&&B(a),e.callbackPriority=2,e.callbackNode=null,2}function Sg(e,t){if(Rn!==0&&Rn!==5)return e.callbackNode=null,e.callbackPriority=0,null;var r=e.callbackNode;if(ki()&&e.callbackNode!==r)return null;var a=Vt;return a=et(e,e===un?a:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),a===0?null:(og(e,a,t),wg(e,me()),e.callbackNode!=null&&e.callbackNode===r?Sg.bind(null,e):null)}function Ng(e,t){if(ki())return null;og(e,t,!0)}function Kv(){Jv(function(){(Yt&6)!==0?I(F,Vv):vg()})}function wd(){if(zr===0){var e=Is;e===0&&(e=$t,$t<<=1,($t&261888)===0&&($t=256)),zr=e}return zr}function Cg(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:Ht(""+e)}function kg(e,t){var r=t.ownerDocument.createElement("input");return r.name=t.name,r.value=t.value,e.id&&r.setAttribute("form",e.id),t.parentNode.insertBefore(r,t),e=new FormData(e),r.parentNode.removeChild(r),e}function Uv(e,t,r,a,d){if(t==="submit"&&r&&r.stateNode===d){var h=Cg((d[ct]||null).action),v=a.submitter;v&&(t=(t=v[ct]||null)?Cg(t.formAction):v.getAttribute("formAction"),t!==null&&(h=t,v=null));var O=new Ha("action","action",null,a,d);e.push({event:O,listeners:[{instance:null,listener:function(){if(a.defaultPrevented){if(zr!==0){var G=v?kg(d,v):new FormData(d);Kc(r,{pending:!0,data:G,method:d.method,action:h},null,G)}}else typeof h=="function"&&(O.preventDefault(),G=v?kg(d,v):new FormData(d),Kc(r,{pending:!0,data:G,method:d.method,action:h},h,G))},currentTarget:d}]})}}for(var Sd=0;Sd<rc.length;Sd++){var Nd=rc[Sd],$v=Nd.toLowerCase(),Fv=Nd[0].toUpperCase()+Nd.slice(1);To($v,"on"+Fv)}To(nh,"onAnimationEnd"),To(oh,"onAnimationIteration"),To(rh,"onAnimationStart"),To("dblclick","onDoubleClick"),To("focusin","onFocus"),To("focusout","onBlur"),To(lv,"onTransitionRun"),To(av,"onTransitionStart"),To(iv,"onTransitionCancel"),To(sh,"onTransitionEnd"),nt("onMouseEnter",["mouseout","mouseover"]),nt("onMouseLeave",["mouseout","mouseover"]),nt("onPointerEnter",["pointerout","pointerover"]),nt("onPointerLeave",["pointerout","pointerover"]),We("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),We("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),We("onBeforeInput",["compositionend","keypress","textInput","paste"]),We("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),We("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),We("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Gl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),qv=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Gl));function jg(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var a=e[r],d=a.event;a=a.listeners;e:{var h=void 0;if(t)for(var v=a.length-1;0<=v;v--){var O=a[v],G=O.instance,ge=O.currentTarget;if(O=O.listener,G!==h&&d.isPropagationStopped())break e;h=O,d.currentTarget=ge;try{h(d)}catch(_e){Ua(_e)}d.currentTarget=null,h=G}else for(v=0;v<a.length;v++){if(O=a[v],G=O.instance,ge=O.currentTarget,O=O.listener,G!==h&&d.isPropagationStopped())break e;h=O,d.currentTarget=ge;try{h(d)}catch(_e){Ua(_e)}d.currentTarget=null,h=G}}}}function Bt(e,t){var r=t[pt];r===void 0&&(r=t[pt]=new Set);var a=e+"__bubble";r.has(a)||(Mg(t,e,2,!1),r.add(a))}function Cd(e,t,r){var a=0;t&&(a|=4),Mg(r,e,a,t)}var Oi="_reactListening"+Math.random().toString(36).slice(2);function kd(e){if(!e[Oi]){e[Oi]=!0,Ye.forEach(function(r){r!=="selectionchange"&&(qv.has(r)||Cd(r,!1,e),Cd(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Oi]||(t[Oi]=!0,Cd("selectionchange",!1,t))}}function Mg(e,t,r,a){switch(n0(t)){case 2:var d=x1;break;case 8:d=v1;break;default:d=Vd}r=d.bind(null,t,r,e),d=void 0,!qu||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(d=!0),a?d!==void 0?e.addEventListener(t,r,{capture:!0,passive:d}):e.addEventListener(t,r,!0):d!==void 0?e.addEventListener(t,r,{passive:d}):e.addEventListener(t,r,!1)}function jd(e,t,r,a,d){var h=a;if((t&1)===0&&(t&2)===0&&a!==null)e:for(;;){if(a===null)return;var v=a.tag;if(v===3||v===4){var O=a.stateNode.containerInfo;if(O===d)break;if(v===4)for(v=a.return;v!==null;){var G=v.tag;if((G===3||G===4)&&v.stateNode.containerInfo===d)return;v=v.return}for(;O!==null;){if(v=Ee(O),v===null)return;if(G=v.tag,G===5||G===6||G===26||G===27){a=h=v;continue e}O=O.parentNode}}a=a.return}Lp(function(){var ge=h,_e=Yr(r),ze=[];e:{var ve=lh.get(e);if(ve!==void 0){var Ce=Ha,dt=e;switch(e){case"keypress":if(Ba(r)===0)break e;case"keydown":case"keyup":Ce=zx;break;case"focusin":dt="focus",Ce=Yu;break;case"focusout":dt="blur",Ce=Yu;break;case"beforeblur":case"afterblur":Ce=Yu;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ce=_p;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ce=jx;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ce=Kx;break;case nh:case oh:case rh:Ce=Tx;break;case sh:Ce=$x;break;case"scroll":case"scrollend":Ce=Cx;break;case"wheel":Ce=qx;break;case"copy":case"cut":case"paste":Ce=Ix;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ce=Bp;break;case"toggle":case"beforetoggle":Ce=Gx}var kt=(t&4)!==0,sn=!kt&&(e==="scroll"||e==="scrollend"),re=kt?ve!==null?ve+"Capture":null:ve;kt=[];for(var Z=ge,pe;Z!==null;){var Be=Z;if(pe=Be.stateNode,Be=Be.tag,Be!==5&&Be!==26&&Be!==27||pe===null||re===null||(Be=ml(Z,re),Be!=null&&kt.push(Pl(Z,Be,pe))),sn)break;Z=Z.return}0<kt.length&&(ve=new Ce(ve,dt,null,r,_e),ze.push({event:ve,listeners:kt}))}}if((t&7)===0){e:{if(ve=e==="mouseover"||e==="pointerover",Ce=e==="mouseout"||e==="pointerout",ve&&r!==hl&&(dt=r.relatedTarget||r.fromElement)&&(Ee(dt)||dt[jt]))break e;if((Ce||ve)&&(ve=_e.window===_e?_e:(ve=_e.ownerDocument)?ve.defaultView||ve.parentWindow:window,Ce?(dt=r.relatedTarget||r.toElement,Ce=ge,dt=dt?Ee(dt):null,dt!==null&&(sn=c(dt),kt=dt.tag,dt!==sn||kt!==5&&kt!==27&&kt!==6)&&(dt=null)):(Ce=null,dt=ge),Ce!==dt)){if(kt=_p,Be="onMouseLeave",re="onMouseEnter",Z="mouse",(e==="pointerout"||e==="pointerover")&&(kt=Bp,Be="onPointerLeave",re="onPointerEnter",Z="pointer"),sn=Ce==null?ve:ot(Ce),pe=dt==null?ve:ot(dt),ve=new kt(Be,Z+"leave",Ce,r,_e),ve.target=sn,ve.relatedTarget=pe,Be=null,Ee(_e)===ge&&(kt=new kt(re,Z+"enter",dt,r,_e),kt.target=pe,kt.relatedTarget=sn,Be=kt),sn=Be,Ce&&dt)t:{for(kt=Wv,re=Ce,Z=dt,pe=0,Be=re;Be;Be=kt(Be))pe++;Be=0;for(var vt=Z;vt;vt=kt(vt))Be++;for(;0<pe-Be;)re=kt(re),pe--;for(;0<Be-pe;)Z=kt(Z),Be--;for(;pe--;){if(re===Z||Z!==null&&re===Z.alternate){kt=re;break t}re=kt(re),Z=kt(Z)}kt=null}else kt=null;Ce!==null&&Og(ze,ve,Ce,kt,!1),dt!==null&&sn!==null&&Og(ze,sn,dt,kt,!0)}}e:{if(ve=ge?ot(ge):window,Ce=ve.nodeName&&ve.nodeName.toLowerCase(),Ce==="select"||Ce==="input"&&ve.type==="file")var Ft=qp;else if($p(ve))if(Wp)Ft=ov;else{Ft=tv;var mt=ev}else Ce=ve.nodeName,!Ce||Ce.toLowerCase()!=="input"||ve.type!=="checkbox"&&ve.type!=="radio"?ge&&yt(ge.elementType)&&(Ft=qp):Ft=nv;if(Ft&&(Ft=Ft(e,ge))){Fp(ze,Ft,r,_e);break e}mt&&mt(e,ve,ge),e==="focusout"&&ge&&ve.type==="number"&&ge.memoizedProps.value!=null&&xs(ve,"number",ve.value)}switch(mt=ge?ot(ge):window,e){case"focusin":($p(mt)||mt.contentEditable==="true")&&(Ns=mt,tc=ge,Nl=null);break;case"focusout":Nl=tc=Ns=null;break;case"mousedown":nc=!0;break;case"contextmenu":case"mouseup":case"dragend":nc=!1,eh(ze,r,_e);break;case"selectionchange":if(sv)break;case"keydown":case"keyup":eh(ze,r,_e)}var Rt;if(Xu)e:{switch(e){case"compositionstart":var Kt="onCompositionStart";break e;case"compositionend":Kt="onCompositionEnd";break e;case"compositionupdate":Kt="onCompositionUpdate";break e}Kt=void 0}else Ss?Kp(e,r)&&(Kt="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(Kt="onCompositionStart");Kt&&(zp&&r.locale!=="ko"&&(Ss||Kt!=="onCompositionStart"?Kt==="onCompositionEnd"&&Ss&&(Rt=Ap()):(Sr=_e,Wu="value"in Sr?Sr.value:Sr.textContent,Ss=!0)),mt=Ti(ge,Kt),0<mt.length&&(Kt=new Dp(Kt,e,null,r,_e),ze.push({event:Kt,listeners:mt}),Rt?Kt.data=Rt:(Rt=Up(r),Rt!==null&&(Kt.data=Rt)))),(Rt=Yx?Qx(e,r):Xx(e,r))&&(Kt=Ti(ge,"onBeforeInput"),0<Kt.length&&(mt=new Dp("onBeforeInput","beforeinput",null,r,_e),ze.push({event:mt,listeners:Kt}),mt.data=Rt)),Uv(ze,e,ge,r,_e)}jg(ze,t)})}function Pl(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Ti(e,t){for(var r=t+"Capture",a=[];e!==null;){var d=e,h=d.stateNode;if(d=d.tag,d!==5&&d!==26&&d!==27||h===null||(d=ml(e,r),d!=null&&a.unshift(Pl(e,d,h)),d=ml(e,t),d!=null&&a.push(Pl(e,d,h))),e.tag===3)return a;e=e.return}return[]}function Wv(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function Og(e,t,r,a,d){for(var h=t._reactName,v=[];r!==null&&r!==a;){var O=r,G=O.alternate,ge=O.stateNode;if(O=O.tag,G!==null&&G===a)break;O!==5&&O!==26&&O!==27||ge===null||(G=ge,d?(ge=ml(r,h),ge!=null&&v.unshift(Pl(r,ge,G))):d||(ge=ml(r,h),ge!=null&&v.push(Pl(r,ge,G)))),r=r.return}v.length!==0&&e.push({event:t,listeners:v})}var Gv=/\r\n?/g,Pv=/\u0000|\uFFFD/g;function Tg(e){return(typeof e=="string"?e:""+e).replace(Gv,`
`).replace(Pv,"")}function Eg(e,t){return t=Tg(t),Tg(e)===t}function rn(e,t,r,a,d,h){switch(r){case"children":typeof a=="string"?t==="body"||t==="textarea"&&a===""||wr(e,a):(typeof a=="number"||typeof a=="bigint")&&t!=="body"&&wr(e,""+a);break;case"className":An(e,"class",a);break;case"tabIndex":An(e,"tabindex",a);break;case"dir":case"role":case"viewBox":case"width":case"height":An(e,r,a);break;case"style":lt(e,a,h);break;case"data":if(t!=="object"){An(e,"data",a);break}case"src":case"href":if(a===""&&(t!=="a"||r!=="href")){e.removeAttribute(r);break}if(a==null||typeof a=="function"||typeof a=="symbol"||typeof a=="boolean"){e.removeAttribute(r);break}a=Ht(""+a),e.setAttribute(r,a);break;case"action":case"formAction":if(typeof a=="function"){e.setAttribute(r,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof h=="function"&&(r==="formAction"?(t!=="input"&&rn(e,t,"name",d.name,d,null),rn(e,t,"formEncType",d.formEncType,d,null),rn(e,t,"formMethod",d.formMethod,d,null),rn(e,t,"formTarget",d.formTarget,d,null)):(rn(e,t,"encType",d.encType,d,null),rn(e,t,"method",d.method,d,null),rn(e,t,"target",d.target,d,null)));if(a==null||typeof a=="symbol"||typeof a=="boolean"){e.removeAttribute(r);break}a=Ht(""+a),e.setAttribute(r,a);break;case"onClick":a!=null&&(e.onclick=yo);break;case"onScroll":a!=null&&Bt("scroll",e);break;case"onScrollEnd":a!=null&&Bt("scrollend",e);break;case"dangerouslySetInnerHTML":if(a!=null){if(typeof a!="object"||!("__html"in a))throw Error(l(61));if(r=a.__html,r!=null){if(d.children!=null)throw Error(l(60));e.innerHTML=r}}break;case"multiple":e.multiple=a&&typeof a!="function"&&typeof a!="symbol";break;case"muted":e.muted=a&&typeof a!="function"&&typeof a!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(a==null||typeof a=="function"||typeof a=="boolean"||typeof a=="symbol"){e.removeAttribute("xlink:href");break}r=Ht(""+a),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",r);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":a!=null&&typeof a!="function"&&typeof a!="symbol"?e.setAttribute(r,""+a):e.removeAttribute(r);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":a&&typeof a!="function"&&typeof a!="symbol"?e.setAttribute(r,""):e.removeAttribute(r);break;case"capture":case"download":a===!0?e.setAttribute(r,""):a!==!1&&a!=null&&typeof a!="function"&&typeof a!="symbol"?e.setAttribute(r,a):e.removeAttribute(r);break;case"cols":case"rows":case"size":case"span":a!=null&&typeof a!="function"&&typeof a!="symbol"&&!isNaN(a)&&1<=a?e.setAttribute(r,a):e.removeAttribute(r);break;case"rowSpan":case"start":a==null||typeof a=="function"||typeof a=="symbol"||isNaN(a)?e.removeAttribute(r):e.setAttribute(r,a);break;case"popover":Bt("beforetoggle",e),Bt("toggle",e),an(e,"popover",a);break;case"xlinkActuate":Sn(e,"http://www.w3.org/1999/xlink","xlink:actuate",a);break;case"xlinkArcrole":Sn(e,"http://www.w3.org/1999/xlink","xlink:arcrole",a);break;case"xlinkRole":Sn(e,"http://www.w3.org/1999/xlink","xlink:role",a);break;case"xlinkShow":Sn(e,"http://www.w3.org/1999/xlink","xlink:show",a);break;case"xlinkTitle":Sn(e,"http://www.w3.org/1999/xlink","xlink:title",a);break;case"xlinkType":Sn(e,"http://www.w3.org/1999/xlink","xlink:type",a);break;case"xmlBase":Sn(e,"http://www.w3.org/XML/1998/namespace","xml:base",a);break;case"xmlLang":Sn(e,"http://www.w3.org/XML/1998/namespace","xml:lang",a);break;case"xmlSpace":Sn(e,"http://www.w3.org/XML/1998/namespace","xml:space",a);break;case"is":an(e,"is",a);break;case"innerText":case"textContent":break;default:(!(2<r.length)||r[0]!=="o"&&r[0]!=="O"||r[1]!=="n"&&r[1]!=="N")&&(r=fn.get(r)||r,an(e,r,a))}}function Md(e,t,r,a,d,h){switch(r){case"style":lt(e,a,h);break;case"dangerouslySetInnerHTML":if(a!=null){if(typeof a!="object"||!("__html"in a))throw Error(l(61));if(r=a.__html,r!=null){if(d.children!=null)throw Error(l(60));e.innerHTML=r}}break;case"children":typeof a=="string"?wr(e,a):(typeof a=="number"||typeof a=="bigint")&&wr(e,""+a);break;case"onScroll":a!=null&&Bt("scroll",e);break;case"onScrollEnd":a!=null&&Bt("scrollend",e);break;case"onClick":a!=null&&(e.onclick=yo);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!te.hasOwnProperty(r))e:{if(r[0]==="o"&&r[1]==="n"&&(d=r.endsWith("Capture"),t=r.slice(2,d?r.length-7:void 0),h=e[ct]||null,h=h!=null?h[r]:null,typeof h=="function"&&e.removeEventListener(t,h,d),typeof a=="function")){typeof h!="function"&&h!==null&&(r in e?e[r]=null:e.hasAttribute(r)&&e.removeAttribute(r)),e.addEventListener(t,a,d);break e}r in e?e[r]=a:a===!0?e.setAttribute(r,""):an(e,r,a)}}}function Hn(e,t,r){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Bt("error",e),Bt("load",e);var a=!1,d=!1,h;for(h in r)if(r.hasOwnProperty(h)){var v=r[h];if(v!=null)switch(h){case"src":a=!0;break;case"srcSet":d=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(l(137,t));default:rn(e,t,h,v,r,null)}}d&&rn(e,t,"srcSet",r.srcSet,r,null),a&&rn(e,t,"src",r.src,r,null);return;case"input":Bt("invalid",e);var O=h=v=d=null,G=null,ge=null;for(a in r)if(r.hasOwnProperty(a)){var _e=r[a];if(_e!=null)switch(a){case"name":d=_e;break;case"type":v=_e;break;case"checked":G=_e;break;case"defaultChecked":ge=_e;break;case"value":h=_e;break;case"defaultValue":O=_e;break;case"children":case"dangerouslySetInnerHTML":if(_e!=null)throw Error(l(137,t));break;default:rn(e,t,a,_e,r,null)}}Aa(e,h,O,G,ge,v,d,!1);return;case"select":Bt("invalid",e),a=v=h=null;for(d in r)if(r.hasOwnProperty(d)&&(O=r[d],O!=null))switch(d){case"value":h=O;break;case"defaultValue":v=O;break;case"multiple":a=O;default:rn(e,t,d,O,r,null)}t=h,r=v,e.multiple=!!a,t!=null?ro(e,!!a,t,!1):r!=null&&ro(e,!!a,r,!0);return;case"textarea":Bt("invalid",e),h=d=a=null;for(v in r)if(r.hasOwnProperty(v)&&(O=r[v],O!=null))switch(v){case"value":a=O;break;case"defaultValue":d=O;break;case"children":h=O;break;case"dangerouslySetInnerHTML":if(O!=null)throw Error(l(91));break;default:rn(e,t,v,O,r,null)}_a(e,a,d,h);return;case"option":for(G in r)r.hasOwnProperty(G)&&(a=r[G],a!=null)&&(G==="selected"?e.selected=a&&typeof a!="function"&&typeof a!="symbol":rn(e,t,G,a,r,null));return;case"dialog":Bt("beforetoggle",e),Bt("toggle",e),Bt("cancel",e),Bt("close",e);break;case"iframe":case"object":Bt("load",e);break;case"video":case"audio":for(a=0;a<Gl.length;a++)Bt(Gl[a],e);break;case"image":Bt("error",e),Bt("load",e);break;case"details":Bt("toggle",e);break;case"embed":case"source":case"link":Bt("error",e),Bt("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ge in r)if(r.hasOwnProperty(ge)&&(a=r[ge],a!=null))switch(ge){case"children":case"dangerouslySetInnerHTML":throw Error(l(137,t));default:rn(e,t,ge,a,r,null)}return;default:if(yt(t)){for(_e in r)r.hasOwnProperty(_e)&&(a=r[_e],a!==void 0&&Md(e,t,_e,a,r,void 0));return}}for(O in r)r.hasOwnProperty(O)&&(a=r[O],a!=null&&rn(e,t,O,a,r,null))}function Yv(e,t,r,a){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var d=null,h=null,v=null,O=null,G=null,ge=null,_e=null;for(Ce in r){var ze=r[Ce];if(r.hasOwnProperty(Ce)&&ze!=null)switch(Ce){case"checked":break;case"value":break;case"defaultValue":G=ze;default:a.hasOwnProperty(Ce)||rn(e,t,Ce,null,a,ze)}}for(var ve in a){var Ce=a[ve];if(ze=r[ve],a.hasOwnProperty(ve)&&(Ce!=null||ze!=null))switch(ve){case"type":h=Ce;break;case"name":d=Ce;break;case"checked":ge=Ce;break;case"defaultChecked":_e=Ce;break;case"value":v=Ce;break;case"defaultValue":O=Ce;break;case"children":case"dangerouslySetInnerHTML":if(Ce!=null)throw Error(l(137,t));break;default:Ce!==ze&&rn(e,t,ve,Ce,a,ze)}}pl(e,v,O,G,ge,_e,h,d);return;case"select":Ce=v=O=ve=null;for(h in r)if(G=r[h],r.hasOwnProperty(h)&&G!=null)switch(h){case"value":break;case"multiple":Ce=G;default:a.hasOwnProperty(h)||rn(e,t,h,null,a,G)}for(d in a)if(h=a[d],G=r[d],a.hasOwnProperty(d)&&(h!=null||G!=null))switch(d){case"value":ve=h;break;case"defaultValue":O=h;break;case"multiple":v=h;default:h!==G&&rn(e,t,d,h,a,G)}t=O,r=v,a=Ce,ve!=null?ro(e,!!r,ve,!1):!!a!=!!r&&(t!=null?ro(e,!!r,t,!0):ro(e,!!r,r?[]:"",!1));return;case"textarea":Ce=ve=null;for(O in r)if(d=r[O],r.hasOwnProperty(O)&&d!=null&&!a.hasOwnProperty(O))switch(O){case"value":break;case"children":break;default:rn(e,t,O,null,a,d)}for(v in a)if(d=a[v],h=r[v],a.hasOwnProperty(v)&&(d!=null||h!=null))switch(v){case"value":ve=d;break;case"defaultValue":Ce=d;break;case"children":break;case"dangerouslySetInnerHTML":if(d!=null)throw Error(l(91));break;default:d!==h&&rn(e,t,v,d,a,h)}Ra(e,ve,Ce);return;case"option":for(var dt in r)ve=r[dt],r.hasOwnProperty(dt)&&ve!=null&&!a.hasOwnProperty(dt)&&(dt==="selected"?e.selected=!1:rn(e,t,dt,null,a,ve));for(G in a)ve=a[G],Ce=r[G],a.hasOwnProperty(G)&&ve!==Ce&&(ve!=null||Ce!=null)&&(G==="selected"?e.selected=ve&&typeof ve!="function"&&typeof ve!="symbol":rn(e,t,G,ve,a,Ce));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var kt in r)ve=r[kt],r.hasOwnProperty(kt)&&ve!=null&&!a.hasOwnProperty(kt)&&rn(e,t,kt,null,a,ve);for(ge in a)if(ve=a[ge],Ce=r[ge],a.hasOwnProperty(ge)&&ve!==Ce&&(ve!=null||Ce!=null))switch(ge){case"children":case"dangerouslySetInnerHTML":if(ve!=null)throw Error(l(137,t));break;default:rn(e,t,ge,ve,a,Ce)}return;default:if(yt(t)){for(var sn in r)ve=r[sn],r.hasOwnProperty(sn)&&ve!==void 0&&!a.hasOwnProperty(sn)&&Md(e,t,sn,void 0,a,ve);for(_e in a)ve=a[_e],Ce=r[_e],!a.hasOwnProperty(_e)||ve===Ce||ve===void 0&&Ce===void 0||Md(e,t,_e,ve,a,Ce);return}}for(var re in r)ve=r[re],r.hasOwnProperty(re)&&ve!=null&&!a.hasOwnProperty(re)&&rn(e,t,re,null,a,ve);for(ze in a)ve=a[ze],Ce=r[ze],!a.hasOwnProperty(ze)||ve===Ce||ve==null&&Ce==null||rn(e,t,ze,ve,a,Ce)}function Ig(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Qv(){if(typeof performance.getEntriesByType=="function"){for(var e=0,t=0,r=performance.getEntriesByType("resource"),a=0;a<r.length;a++){var d=r[a],h=d.transferSize,v=d.initiatorType,O=d.duration;if(h&&O&&Ig(v)){for(v=0,O=d.responseEnd,a+=1;a<r.length;a++){var G=r[a],ge=G.startTime;if(ge>O)break;var _e=G.transferSize,ze=G.initiatorType;_e&&Ig(ze)&&(G=G.responseEnd,v+=_e*(G<O?1:(O-ge)/(G-ge)))}if(--a,t+=8*(h+v)/(d.duration/1e3),e++,10<e)break}}if(0<e)return t/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var Od=null,Td=null;function Ei(e){return e.nodeType===9?e:e.ownerDocument}function Lg(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Ag(e,t){if(e===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&t==="foreignObject"?0:e}function Ed(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Id=null;function Xv(){var e=window.event;return e&&e.type==="popstate"?e===Id?!1:(Id=e,!0):(Id=null,!1)}var Rg=typeof setTimeout=="function"?setTimeout:void 0,Zv=typeof clearTimeout=="function"?clearTimeout:void 0,_g=typeof Promise=="function"?Promise:void 0,Jv=typeof queueMicrotask=="function"?queueMicrotask:typeof _g<"u"?function(e){return _g.resolve(null).then(e).catch(e1)}:Rg;function e1(e){setTimeout(function(){throw e})}function Hr(e){return e==="head"}function Dg(e,t){var r=t,a=0;do{var d=r.nextSibling;if(e.removeChild(r),d&&d.nodeType===8)if(r=d.data,r==="/$"||r==="/&"){if(a===0){e.removeChild(d),Qs(t);return}a--}else if(r==="$"||r==="$?"||r==="$~"||r==="$!"||r==="&")a++;else if(r==="html")Yl(e.ownerDocument.documentElement);else if(r==="head"){r=e.ownerDocument.head,Yl(r);for(var h=r.firstChild;h;){var v=h.nextSibling,O=h.nodeName;h[cn]||O==="SCRIPT"||O==="STYLE"||O==="LINK"&&h.rel.toLowerCase()==="stylesheet"||r.removeChild(h),h=v}}else r==="body"&&Yl(e.ownerDocument.body);r=d}while(r);Qs(t)}function Bg(e,t){var r=e;e=0;do{var a=r.nextSibling;if(r.nodeType===1?t?(r._stashedDisplay=r.style.display,r.style.display="none"):(r.style.display=r._stashedDisplay||"",r.getAttribute("style")===""&&r.removeAttribute("style")):r.nodeType===3&&(t?(r._stashedText=r.nodeValue,r.nodeValue=""):r.nodeValue=r._stashedText||""),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(e===0)break;e--}else r!=="$"&&r!=="$?"&&r!=="$~"&&r!=="$!"||e++;r=a}while(r)}function Ld(e){var t=e.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var r=t;switch(t=t.nextSibling,r.nodeName){case"HTML":case"HEAD":case"BODY":Ld(r),P(r);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(r.rel.toLowerCase()==="stylesheet")continue}e.removeChild(r)}}function t1(e,t,r,a){for(;e.nodeType===1;){var d=r;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!a&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(a){if(!e[cn])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(h=e.getAttribute("rel"),h==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(h!==d.rel||e.getAttribute("href")!==(d.href==null||d.href===""?null:d.href)||e.getAttribute("crossorigin")!==(d.crossOrigin==null?null:d.crossOrigin)||e.getAttribute("title")!==(d.title==null?null:d.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(h=e.getAttribute("src"),(h!==(d.src==null?null:d.src)||e.getAttribute("type")!==(d.type==null?null:d.type)||e.getAttribute("crossorigin")!==(d.crossOrigin==null?null:d.crossOrigin))&&h&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(t==="input"&&e.type==="hidden"){var h=d.name==null?null:""+d.name;if(d.type==="hidden"&&e.getAttribute("name")===h)return e}else return e;if(e=Co(e.nextSibling),e===null)break}return null}function n1(e,t,r){if(t==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!r||(e=Co(e.nextSibling),e===null))return null;return e}function zg(e,t){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!t||(e=Co(e.nextSibling),e===null))return null;return e}function Ad(e){return e.data==="$?"||e.data==="$~"}function Rd(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function o1(e,t){var r=e.ownerDocument;if(e.data==="$~")e._reactRetry=t;else if(e.data!=="$?"||r.readyState!=="loading")t();else{var a=function(){t(),r.removeEventListener("DOMContentLoaded",a)};r.addEventListener("DOMContentLoaded",a),e._reactRetry=a}}function Co(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?"||t==="$~"||t==="&"||t==="F!"||t==="F")break;if(t==="/$"||t==="/&")return null}}return e}var _d=null;function Hg(e){e=e.nextSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"||r==="/&"){if(t===0)return Co(e.nextSibling);t--}else r!=="$"&&r!=="$!"&&r!=="$?"&&r!=="$~"&&r!=="&"||t++}e=e.nextSibling}return null}function Vg(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"){if(t===0)return e;t--}else r!=="/$"&&r!=="/&"||t++}e=e.previousSibling}return null}function Kg(e,t,r){switch(t=Ei(r),e){case"html":if(e=t.documentElement,!e)throw Error(l(452));return e;case"head":if(e=t.head,!e)throw Error(l(453));return e;case"body":if(e=t.body,!e)throw Error(l(454));return e;default:throw Error(l(451))}}function Yl(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);P(e)}var ko=new Map,Ug=new Set;function Ii(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var fr=oe.d;oe.d={f:r1,r:s1,D:l1,C:a1,L:i1,m:u1,X:d1,S:c1,M:f1};function r1(){var e=fr.f(),t=Si();return e||t}function s1(e){var t=ne(e);t!==null&&t.tag===5&&t.type==="form"?sm(t):fr.r(e)}var Gs=typeof document>"u"?null:document;function $g(e,t,r){var a=Gs;if(a&&typeof t=="string"&&t){var d=Kn(t);d='link[rel="'+e+'"][href="'+d+'"]',typeof r=="string"&&(d+='[crossorigin="'+r+'"]'),Ug.has(d)||(Ug.add(d),e={rel:e,crossOrigin:r,href:t},a.querySelector(d)===null&&(t=a.createElement("link"),Hn(t,"link",e),Xe(t),a.head.appendChild(t)))}}function l1(e){fr.D(e),$g("dns-prefetch",e,null)}function a1(e,t){fr.C(e,t),$g("preconnect",e,t)}function i1(e,t,r){fr.L(e,t,r);var a=Gs;if(a&&e&&t){var d='link[rel="preload"][as="'+Kn(t)+'"]';t==="image"&&r&&r.imageSrcSet?(d+='[imagesrcset="'+Kn(r.imageSrcSet)+'"]',typeof r.imageSizes=="string"&&(d+='[imagesizes="'+Kn(r.imageSizes)+'"]')):d+='[href="'+Kn(e)+'"]';var h=d;switch(t){case"style":h=Ps(e);break;case"script":h=Ys(e)}ko.has(h)||(e=x({rel:"preload",href:t==="image"&&r&&r.imageSrcSet?void 0:e,as:t},r),ko.set(h,e),a.querySelector(d)!==null||t==="style"&&a.querySelector(Ql(h))||t==="script"&&a.querySelector(Xl(h))||(t=a.createElement("link"),Hn(t,"link",e),Xe(t),a.head.appendChild(t)))}}function u1(e,t){fr.m(e,t);var r=Gs;if(r&&e){var a=t&&typeof t.as=="string"?t.as:"script",d='link[rel="modulepreload"][as="'+Kn(a)+'"][href="'+Kn(e)+'"]',h=d;switch(a){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":h=Ys(e)}if(!ko.has(h)&&(e=x({rel:"modulepreload",href:e},t),ko.set(h,e),r.querySelector(d)===null)){switch(a){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(r.querySelector(Xl(h)))return}a=r.createElement("link"),Hn(a,"link",e),Xe(a),r.head.appendChild(a)}}}function c1(e,t,r){fr.S(e,t,r);var a=Gs;if(a&&e){var d=tt(a).hoistableStyles,h=Ps(e);t=t||"default";var v=d.get(h);if(!v){var O={loading:0,preload:null};if(v=a.querySelector(Ql(h)))O.loading=5;else{e=x({rel:"stylesheet",href:e,"data-precedence":t},r),(r=ko.get(h))&&Dd(e,r);var G=v=a.createElement("link");Xe(G),Hn(G,"link",e),G._p=new Promise(function(ge,_e){G.onload=ge,G.onerror=_e}),G.addEventListener("load",function(){O.loading|=1}),G.addEventListener("error",function(){O.loading|=2}),O.loading|=4,Li(v,t,a)}v={type:"stylesheet",instance:v,count:1,state:O},d.set(h,v)}}}function d1(e,t){fr.X(e,t);var r=Gs;if(r&&e){var a=tt(r).hoistableScripts,d=Ys(e),h=a.get(d);h||(h=r.querySelector(Xl(d)),h||(e=x({src:e,async:!0},t),(t=ko.get(d))&&Bd(e,t),h=r.createElement("script"),Xe(h),Hn(h,"link",e),r.head.appendChild(h)),h={type:"script",instance:h,count:1,state:null},a.set(d,h))}}function f1(e,t){fr.M(e,t);var r=Gs;if(r&&e){var a=tt(r).hoistableScripts,d=Ys(e),h=a.get(d);h||(h=r.querySelector(Xl(d)),h||(e=x({src:e,async:!0,type:"module"},t),(t=ko.get(d))&&Bd(e,t),h=r.createElement("script"),Xe(h),Hn(h,"link",e),r.head.appendChild(h)),h={type:"script",instance:h,count:1,state:null},a.set(d,h))}}function Fg(e,t,r,a){var d=(d=qe.current)?Ii(d):null;if(!d)throw Error(l(446));switch(e){case"meta":case"title":return null;case"style":return typeof r.precedence=="string"&&typeof r.href=="string"?(t=Ps(r.href),r=tt(d).hoistableStyles,a=r.get(t),a||(a={type:"style",instance:null,count:0,state:null},r.set(t,a)),a):{type:"void",instance:null,count:0,state:null};case"link":if(r.rel==="stylesheet"&&typeof r.href=="string"&&typeof r.precedence=="string"){e=Ps(r.href);var h=tt(d).hoistableStyles,v=h.get(e);if(v||(d=d.ownerDocument||d,v={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},h.set(e,v),(h=d.querySelector(Ql(e)))&&!h._p&&(v.instance=h,v.state.loading=5),ko.has(e)||(r={rel:"preload",as:"style",href:r.href,crossOrigin:r.crossOrigin,integrity:r.integrity,media:r.media,hrefLang:r.hrefLang,referrerPolicy:r.referrerPolicy},ko.set(e,r),h||p1(d,e,r,v.state))),t&&a===null)throw Error(l(528,""));return v}if(t&&a!==null)throw Error(l(529,""));return null;case"script":return t=r.async,r=r.src,typeof r=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=Ys(r),r=tt(d).hoistableScripts,a=r.get(t),a||(a={type:"script",instance:null,count:0,state:null},r.set(t,a)),a):{type:"void",instance:null,count:0,state:null};default:throw Error(l(444,e))}}function Ps(e){return'href="'+Kn(e)+'"'}function Ql(e){return'link[rel="stylesheet"]['+e+"]"}function qg(e){return x({},e,{"data-precedence":e.precedence,precedence:null})}function p1(e,t,r,a){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?a.loading=1:(t=e.createElement("link"),a.preload=t,t.addEventListener("load",function(){return a.loading|=1}),t.addEventListener("error",function(){return a.loading|=2}),Hn(t,"link",r),Xe(t),e.head.appendChild(t))}function Ys(e){return'[src="'+Kn(e)+'"]'}function Xl(e){return"script[async]"+e}function Wg(e,t,r){if(t.count++,t.instance===null)switch(t.type){case"style":var a=e.querySelector('style[data-href~="'+Kn(r.href)+'"]');if(a)return t.instance=a,Xe(a),a;var d=x({},r,{"data-href":r.href,"data-precedence":r.precedence,href:null,precedence:null});return a=(e.ownerDocument||e).createElement("style"),Xe(a),Hn(a,"style",d),Li(a,r.precedence,e),t.instance=a;case"stylesheet":d=Ps(r.href);var h=e.querySelector(Ql(d));if(h)return t.state.loading|=4,t.instance=h,Xe(h),h;a=qg(r),(d=ko.get(d))&&Dd(a,d),h=(e.ownerDocument||e).createElement("link"),Xe(h);var v=h;return v._p=new Promise(function(O,G){v.onload=O,v.onerror=G}),Hn(h,"link",a),t.state.loading|=4,Li(h,r.precedence,e),t.instance=h;case"script":return h=Ys(r.src),(d=e.querySelector(Xl(h)))?(t.instance=d,Xe(d),d):(a=r,(d=ko.get(h))&&(a=x({},r),Bd(a,d)),e=e.ownerDocument||e,d=e.createElement("script"),Xe(d),Hn(d,"link",a),e.head.appendChild(d),t.instance=d);case"void":return null;default:throw Error(l(443,t.type))}else t.type==="stylesheet"&&(t.state.loading&4)===0&&(a=t.instance,t.state.loading|=4,Li(a,r.precedence,e));return t.instance}function Li(e,t,r){for(var a=r.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),d=a.length?a[a.length-1]:null,h=d,v=0;v<a.length;v++){var O=a[v];if(O.dataset.precedence===t)h=O;else if(h!==d)break}h?h.parentNode.insertBefore(e,h.nextSibling):(t=r.nodeType===9?r.head:r,t.insertBefore(e,t.firstChild))}function Dd(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.title==null&&(e.title=t.title)}function Bd(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.integrity==null&&(e.integrity=t.integrity)}var Ai=null;function Gg(e,t,r){if(Ai===null){var a=new Map,d=Ai=new Map;d.set(r,a)}else d=Ai,a=d.get(r),a||(a=new Map,d.set(r,a));if(a.has(e))return a;for(a.set(e,null),r=r.getElementsByTagName(e),d=0;d<r.length;d++){var h=r[d];if(!(h[cn]||h[Nt]||e==="link"&&h.getAttribute("rel")==="stylesheet")&&h.namespaceURI!=="http://www.w3.org/2000/svg"){var v=h.getAttribute(t)||"";v=e+v;var O=a.get(v);O?O.push(h):a.set(v,[h])}}return a}function Pg(e,t,r){e=e.ownerDocument||e,e.head.insertBefore(r,t==="title"?e.querySelector("head > title"):null)}function h1(e,t,r){if(r===1||t.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;return t.rel==="stylesheet"?(e=t.disabled,typeof t.precedence=="string"&&e==null):!0;case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function Yg(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function m1(e,t,r,a){if(r.type==="stylesheet"&&(typeof a.media!="string"||matchMedia(a.media).matches!==!1)&&(r.state.loading&4)===0){if(r.instance===null){var d=Ps(a.href),h=t.querySelector(Ql(d));if(h){t=h._p,t!==null&&typeof t=="object"&&typeof t.then=="function"&&(e.count++,e=Ri.bind(e),t.then(e,e)),r.state.loading|=4,r.instance=h,Xe(h);return}h=t.ownerDocument||t,a=qg(a),(d=ko.get(d))&&Dd(a,d),h=h.createElement("link"),Xe(h);var v=h;v._p=new Promise(function(O,G){v.onload=O,v.onerror=G}),Hn(h,"link",a),r.instance=h}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(r,t),(t=r.state.preload)&&(r.state.loading&3)===0&&(e.count++,r=Ri.bind(e),t.addEventListener("load",r),t.addEventListener("error",r))}}var zd=0;function g1(e,t){return e.stylesheets&&e.count===0&&Di(e,e.stylesheets),0<e.count||0<e.imgCount?function(r){var a=setTimeout(function(){if(e.stylesheets&&Di(e,e.stylesheets),e.unsuspend){var h=e.unsuspend;e.unsuspend=null,h()}},6e4+t);0<e.imgBytes&&zd===0&&(zd=62500*Qv());var d=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&Di(e,e.stylesheets),e.unsuspend)){var h=e.unsuspend;e.unsuspend=null,h()}},(e.imgBytes>zd?50:800)+t);return e.unsuspend=r,function(){e.unsuspend=null,clearTimeout(a),clearTimeout(d)}}:null}function Ri(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Di(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var _i=null;function Di(e,t){e.stylesheets=null,e.unsuspend!==null&&(e.count++,_i=new Map,t.forEach(y1,e),_i=null,Ri.call(e))}function y1(e,t){if(!(t.state.loading&4)){var r=_i.get(e);if(r)var a=r.get(null);else{r=new Map,_i.set(e,r);for(var d=e.querySelectorAll("link[data-precedence],style[data-precedence]"),h=0;h<d.length;h++){var v=d[h];(v.nodeName==="LINK"||v.getAttribute("media")!=="not all")&&(r.set(v.dataset.precedence,v),a=v)}a&&r.set(null,a)}d=t.instance,v=d.getAttribute("data-precedence"),h=r.get(v)||a,h===a&&r.set(null,d),r.set(v,d),this.count++,a=Ri.bind(this),d.addEventListener("load",a),d.addEventListener("error",a),h?h.parentNode.insertBefore(d,h.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(d,e.firstChild)),t.state.loading|=4}}var Zl={$$typeof:V,Provider:null,Consumer:null,_currentValue:ce,_currentValue2:ce,_threadCount:0};function b1(e,t,r,a,d,h,v,O,G){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=le(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=le(0),this.hiddenUpdates=le(null),this.identifierPrefix=a,this.onUncaughtError=d,this.onCaughtError=h,this.onRecoverableError=v,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=G,this.incompleteTransitions=new Map}function Qg(e,t,r,a,d,h,v,O,G,ge,_e,ze){return e=new b1(e,t,r,v,G,ge,_e,ze,O),t=1,h===!0&&(t|=24),h=lo(3,null,null,t),e.current=h,h.stateNode=e,t=yc(),t.refCount++,e.pooledCache=t,t.refCount++,h.memoizedState={element:a,isDehydrated:r,cache:t},wc(h),e}function Xg(e){return e?(e=js,e):js}function Zg(e,t,r,a,d,h){d=Xg(d),a.context===null?a.context=d:a.pendingContext=d,a=Or(t),a.payload={element:r},h=h===void 0?null:h,h!==null&&(a.callback=h),r=Tr(e,a,t),r!==null&&(eo(r,e,t),El(r,e,t))}function Jg(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Hd(e,t){Jg(e,t),(e=e.alternate)&&Jg(e,t)}function e0(e){if(e.tag===13||e.tag===31){var t=Jr(e,67108864);t!==null&&eo(t,e,67108864),Hd(e,67108864)}}function t0(e){if(e.tag===13||e.tag===31){var t=fo();t=Re(t);var r=Jr(e,t);r!==null&&eo(r,e,t),Hd(e,t)}}var Bi=!0;function x1(e,t,r,a){var d=_.T;_.T=null;var h=oe.p;try{oe.p=2,Vd(e,t,r,a)}finally{oe.p=h,_.T=d}}function v1(e,t,r,a){var d=_.T;_.T=null;var h=oe.p;try{oe.p=8,Vd(e,t,r,a)}finally{oe.p=h,_.T=d}}function Vd(e,t,r,a){if(Bi){var d=Kd(a);if(d===null)jd(e,t,a,zi,r),o0(e,a);else if(S1(d,e,t,r,a))a.stopPropagation();else if(o0(e,a),t&4&&-1<w1.indexOf(e)){for(;d!==null;){var h=ne(d);if(h!==null)switch(h.tag){case 3:if(h=h.stateNode,h.current.memoizedState.isDehydrated){var v=Ve(h.pendingLanes);if(v!==0){var O=h;for(O.pendingLanes|=2,O.entangledLanes|=2;v;){var G=1<<31-ht(v);O.entanglements[1]|=G,v&=~G}Uo(h),(Yt&6)===0&&(vi=me()+500,Wl(0))}}break;case 31:case 13:O=Jr(h,2),O!==null&&eo(O,h,2),Si(),Hd(h,2)}if(h=Kd(a),h===null&&jd(e,t,a,zi,r),h===d)break;d=h}d!==null&&a.stopPropagation()}else jd(e,t,a,null,r)}}function Kd(e){return e=Yr(e),Ud(e)}var zi=null;function Ud(e){if(zi=null,e=Ee(e),e!==null){var t=c(e);if(t===null)e=null;else{var r=t.tag;if(r===13){if(e=f(t),e!==null)return e;e=null}else if(r===31){if(e=m(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return zi=e,null}function n0(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Se()){case F:return 2;case ie:return 8;case Ae:case Ue:return 32;case Je:return 268435456;default:return 32}default:return 32}}var $d=!1,Vr=null,Kr=null,Ur=null,Jl=new Map,ea=new Map,$r=[],w1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function o0(e,t){switch(e){case"focusin":case"focusout":Vr=null;break;case"dragenter":case"dragleave":Kr=null;break;case"mouseover":case"mouseout":Ur=null;break;case"pointerover":case"pointerout":Jl.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":ea.delete(t.pointerId)}}function ta(e,t,r,a,d,h){return e===null||e.nativeEvent!==h?(e={blockedOn:t,domEventName:r,eventSystemFlags:a,nativeEvent:h,targetContainers:[d]},t!==null&&(t=ne(t),t!==null&&e0(t)),e):(e.eventSystemFlags|=a,t=e.targetContainers,d!==null&&t.indexOf(d)===-1&&t.push(d),e)}function S1(e,t,r,a,d){switch(t){case"focusin":return Vr=ta(Vr,e,t,r,a,d),!0;case"dragenter":return Kr=ta(Kr,e,t,r,a,d),!0;case"mouseover":return Ur=ta(Ur,e,t,r,a,d),!0;case"pointerover":var h=d.pointerId;return Jl.set(h,ta(Jl.get(h)||null,e,t,r,a,d)),!0;case"gotpointercapture":return h=d.pointerId,ea.set(h,ta(ea.get(h)||null,e,t,r,a,d)),!0}return!1}function r0(e){var t=Ee(e.target);if(t!==null){var r=c(t);if(r!==null){if(t=r.tag,t===13){if(t=f(r),t!==null){e.blockedOn=t,it(e.priority,function(){t0(r)});return}}else if(t===31){if(t=m(r),t!==null){e.blockedOn=t,it(e.priority,function(){t0(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Hi(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Kd(e.nativeEvent);if(r===null){r=e.nativeEvent;var a=new r.constructor(r.type,r);hl=a,r.target.dispatchEvent(a),hl=null}else return t=ne(r),t!==null&&e0(t),e.blockedOn=r,!1;t.shift()}return!0}function s0(e,t,r){Hi(e)&&r.delete(t)}function N1(){$d=!1,Vr!==null&&Hi(Vr)&&(Vr=null),Kr!==null&&Hi(Kr)&&(Kr=null),Ur!==null&&Hi(Ur)&&(Ur=null),Jl.forEach(s0),ea.forEach(s0)}function Vi(e,t){e.blockedOn===t&&(e.blockedOn=null,$d||($d=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,N1)))}var Ki=null;function l0(e){Ki!==e&&(Ki=e,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Ki===e&&(Ki=null);for(var t=0;t<e.length;t+=3){var r=e[t],a=e[t+1],d=e[t+2];if(typeof a!="function"){if(Ud(a||r)===null)continue;break}var h=ne(r);h!==null&&(e.splice(t,3),t-=3,Kc(h,{pending:!0,data:d,method:r.method,action:a},a,d))}}))}function Qs(e){function t(G){return Vi(G,e)}Vr!==null&&Vi(Vr,e),Kr!==null&&Vi(Kr,e),Ur!==null&&Vi(Ur,e),Jl.forEach(t),ea.forEach(t);for(var r=0;r<$r.length;r++){var a=$r[r];a.blockedOn===e&&(a.blockedOn=null)}for(;0<$r.length&&(r=$r[0],r.blockedOn===null);)r0(r),r.blockedOn===null&&$r.shift();if(r=(e.ownerDocument||e).$$reactFormReplay,r!=null)for(a=0;a<r.length;a+=3){var d=r[a],h=r[a+1],v=d[ct]||null;if(typeof h=="function")v||l0(r);else if(v){var O=null;if(h&&h.hasAttribute("formAction")){if(d=h,v=h[ct]||null)O=v.formAction;else if(Ud(d)!==null)continue}else O=v.action;typeof O=="function"?r[a+1]=O:(r.splice(a,3),a-=3),l0(r)}}}function a0(){function e(h){h.canIntercept&&h.info==="react-transition"&&h.intercept({handler:function(){return new Promise(function(v){return d=v})},focusReset:"manual",scroll:"manual"})}function t(){d!==null&&(d(),d=null),a||setTimeout(r,20)}function r(){if(!a&&!navigation.transition){var h=navigation.currentEntry;h&&h.url!=null&&navigation.navigate(h.url,{state:h.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var a=!1,d=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(r,100),function(){a=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),d!==null&&(d(),d=null)}}}function Fd(e){this._internalRoot=e}Ui.prototype.render=Fd.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(l(409));var r=t.current,a=fo();Zg(r,a,e,t,null,null)},Ui.prototype.unmount=Fd.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Zg(e.current,2,null,e,null,null),Si(),t[jt]=null}};function Ui(e){this._internalRoot=e}Ui.prototype.unstable_scheduleHydration=function(e){if(e){var t=bt();e={blockedOn:null,target:e,priority:t};for(var r=0;r<$r.length&&t!==0&&t<$r[r].priority;r++);$r.splice(r,0,e),r===0&&r0(e)}};var i0=o.version;if(i0!=="19.2.3")throw Error(l(527,i0,"19.2.3"));oe.findDOMNode=function(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(l(188)):(e=Object.keys(e).join(","),Error(l(268,e)));return e=g(t),e=e!==null?b(e):null,e=e===null?null:e.stateNode,e};var C1={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:_,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var $i=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!$i.isDisabled&&$i.supportsFiber)try{$e=$i.inject(C1),Fe=$i}catch{}}return oa.createRoot=function(e,t){if(!i(e))throw Error(l(299));var r=!1,a="",d=mm,h=gm,v=ym;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(a=t.identifierPrefix),t.onUncaughtError!==void 0&&(d=t.onUncaughtError),t.onCaughtError!==void 0&&(h=t.onCaughtError),t.onRecoverableError!==void 0&&(v=t.onRecoverableError)),t=Qg(e,1,!1,null,null,r,a,null,d,h,v,a0),e[jt]=t.current,kd(e),new Fd(t)},oa.hydrateRoot=function(e,t,r){if(!i(e))throw Error(l(299));var a=!1,d="",h=mm,v=gm,O=ym,G=null;return r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(d=r.identifierPrefix),r.onUncaughtError!==void 0&&(h=r.onUncaughtError),r.onCaughtError!==void 0&&(v=r.onCaughtError),r.onRecoverableError!==void 0&&(O=r.onRecoverableError),r.formState!==void 0&&(G=r.formState)),t=Qg(e,1,!0,t,r??null,a,d,G,h,v,O,a0),t.context=Xg(null),r=t.current,a=fo(),a=Re(a),d=Or(a),d.callback=null,Tr(r,d,a),r=a,t.current.lanes=r,se(t,r),Uo(t),e[jt]=t.current,kd(e),new Ui(t)},oa.version="19.2.3",oa}var x0;function _1(){if(x0)return Gd.exports;x0=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(o){console.error(o)}}return n(),Gd.exports=R1(),Gd.exports}var D1=_1();const v0=n=>{let o;const s=new Set,l=(g,b)=>{const x=typeof g=="function"?g(o):g;if(!Object.is(x,o)){const w=o;o=b??(typeof x!="object"||x===null)?x:Object.assign({},o,x),s.forEach(k=>k(o,w))}},i=()=>o,m={setState:l,getState:i,getInitialState:()=>p,subscribe:g=>(s.add(g),()=>s.delete(g))},p=o=n(l,i,m);return m},B1=(n=>n?v0(n):v0),z1=n=>n;function H1(n,o=z1){const s=tl.useSyncExternalStore(n.subscribe,tl.useCallback(()=>o(n.getState()),[n,o]),tl.useCallback(()=>o(n.getInitialState()),[n,o]));return tl.useDebugValue(s),s}const w0=n=>{const o=B1(n),s=l=>H1(o,l);return Object.assign(s,o),s},Oo=(n=>n?w0(n):w0);function br(n,o){let s;try{s=n()}catch{return}return{getItem:i=>{var c;const f=p=>p===null?null:JSON.parse(p,void 0),m=(c=s.getItem(i))!=null?c:null;return m instanceof Promise?m.then(f):f(m)},setItem:(i,c)=>s.setItem(i,JSON.stringify(c,void 0)),removeItem:i=>s.removeItem(i)}}const kf=n=>o=>{try{const s=n(o);return s instanceof Promise?s:{then(l){return kf(l)(s)},catch(l){return this}}}catch(s){return{then(l){return this},catch(l){return kf(l)(s)}}}},V1=(n,o)=>(s,l,i)=>{let c={storage:br(()=>localStorage),partialize:S=>S,version:0,merge:(S,j)=>({...j,...S}),...o},f=!1;const m=new Set,p=new Set;let g=c.storage;if(!g)return n((...S)=>{console.warn(`[zustand persist middleware] Unable to update item '${c.name}', the given storage is currently unavailable.`),s(...S)},l,i);const b=()=>{const S=c.partialize({...l()});return g.setItem(c.name,{state:S,version:c.version})},x=i.setState;i.setState=(S,j)=>(x(S,j),b());const w=n((...S)=>(s(...S),b()),l,i);i.getInitialState=()=>w;let k;const N=()=>{var S,j;if(!g)return;f=!1,m.forEach(T=>{var V;return T((V=l())!=null?V:w)});const C=((j=c.onRehydrateStorage)==null?void 0:j.call(c,(S=l())!=null?S:w))||void 0;return kf(g.getItem.bind(g))(c.name).then(T=>{if(T)if(typeof T.version=="number"&&T.version!==c.version){if(c.migrate){const V=c.migrate(T.state,T.version);return V instanceof Promise?V.then(U=>[!0,U]):[!0,V]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,T.state];return[!1,void 0]}).then(T=>{var V;const[U,R]=T;if(k=c.merge(R,(V=l())!=null?V:w),s(k,!0),U)return b()}).then(()=>{C?.(k,void 0),k=l(),f=!0,p.forEach(T=>T(k))}).catch(T=>{C?.(void 0,T)})};return i.persist={setOptions:S=>{c={...c,...S},S.storage&&(g=S.storage)},clearStorage:()=>{g?.removeItem(c.name)},getOptions:()=>c,rehydrate:()=>N(),hasHydrated:()=>f,onHydrate:S=>(m.add(S),()=>{m.delete(S)}),onFinishHydration:S=>(p.add(S),()=>{p.delete(S)})},c.skipHydration||N(),k||w},xr=V1,Mo=Oo()(n=>({viewerOpen:!1,viewerImages:[],viewerIndex:0,viewerScale:1,viewerTranslate:{x:0,y:0},setViewerState:o=>{n(s=>{const l={viewerOpen:o.viewerOpen??s.viewerOpen,viewerImages:o.viewerImages??s.viewerImages,viewerIndex:o.viewerIndex??s.viewerIndex,viewerScale:o.viewerScale??s.viewerScale,viewerTranslate:o.viewerTranslate??s.viewerTranslate};return l.viewerOpen===s.viewerOpen&&l.viewerIndex===s.viewerIndex&&l.viewerScale===s.viewerScale&&l.viewerTranslate.x===s.viewerTranslate.x&&l.viewerTranslate.y===s.viewerTranslate.y&&l.viewerImages===s.viewerImages?s:{...s,...l}})}})),dn=Oo()(xr(n=>({error:null,nodeErrors:{},errorCycleIndex:0,errorsDismissed:!1,setError:o=>{n({error:o,errorsDismissed:!1})},setNodeErrors:o=>{n({nodeErrors:o,errorCycleIndex:0,errorsDismissed:!1})},clearNodeErrors:()=>{n({error:null,nodeErrors:{},errorCycleIndex:0,errorsDismissed:!1})},clearNodeError:o=>{n(s=>{const l={...s.nodeErrors};return delete l[String(o)],{nodeErrors:l}})},setErrorCycleIndex:o=>{n({errorCycleIndex:o})},setErrorsDismissed:o=>{n({errorsDismissed:o})}}),{name:"workflow-errors-storage",storage:br(()=>localStorage),partialize:n=>({error:n.error,nodeErrors:n.nodeErrors,errorCycleIndex:n.errorCycleIndex,errorsDismissed:n.errorsDismissed}),onRehydrateStorage:()=>n=>{if(!n)return;const o=Object.values(n.nodeErrors||{}).reduce((s,l)=>s+l.length,0);o>0&&!n.error&&n.setError(`Workflow load error: ${o} input${o===1?"":"s"} reference missing options.`),o>0&&n.setErrorCycleIndex(0)}}));function Qy(n){return!!n&&typeof n=="object"&&!Array.isArray(n)}function K1(n){if(!(!String(n.type||"").startsWith("Primitive")&&n.type!=="PrimitiveNode")){if(Array.isArray(n.widgets_values))return n.widgets_values[0];if(Qy(n.widgets_values)){const s=n.widgets_values.value;return s!==void 0?s:n.widgets_values[0]}}}function da(n,o,s){const l=n.widgets_values;if(Array.isArray(l))return s===void 0||s<0||s>=l.length?void 0:l[s];if(Qy(l)){if(l[o]!==void 0)return l[o];if(n.type==="VHS_VideoCombine"&&o==="save_image"&&l.save_output!==void 0)return l.save_output}}function Jf(n,o){const s=n.widget_idx_map?.[String(o)];return s||(n.extra?.widget_idx_map?.[String(o)]??null)}function Iu(n){if(Array.isArray(n))return!0;const o=String(n).toUpperCase();return o==="INT"||o==="FLOAT"||o==="BOOLEAN"||o==="STRING"}function ep(n,o,s){if(Array.isArray(o)){if(s?.comboIndexToValue&&typeof n=="number"&&Number.isFinite(n)){const l=Math.trunc(n);return o[l]??n}return n}if(o==="INT"&&typeof n=="string"&&n.trim()!==""&&!Number.isNaN(Number(n)))return Math.trunc(Number(n));if(o==="FLOAT"&&typeof n=="string"&&n.trim()!==""&&!Number.isNaN(Number(n)))return Number(n);if(o==="BOOLEAN"&&typeof n=="string"){if(n.toLowerCase()==="true")return!0;if(n.toLowerCase()==="false")return!1}return n}function U1(n,o,s){if(o.length===0)return n;const l=ep(n,o,{comboIndexToValue:!0}),i=String(l),c=i.split(/[\\/]/).pop()??i,f=o.find(p=>String(p)===i);if(f!==void 0)return f;const m=o.find(p=>String(p)===c);return m!==void 0?m:s!==void 0&&o.some(p=>String(p)===String(s))?s:o[0]}function Xy(n,o){const s=n.links.find(f=>f[0]===o);if(!s)return null;const l=s[1],i=s[2],c=n.nodes.find(f=>f.id===l);if(!c)return null;if(c.mode===4||c.type==="Reroute"){const f=c.outputs[i];if(!f)return null;const m=c.inputs.find(p=>{if(p.link===null)return!1;const g=String(p.type).toUpperCase(),b=String(f.type).toUpperCase();return g===b||g==="*"||b==="*"});return m?.link!=null?Xy(n,m.link):null}return{nodeId:l,slotIndex:i}}function $1(n,o,s,l,i,c,f){const m={};for(const N of s.inputs)if(N.link!=null){const S=Xy(n,N.link);if(S)if(i.has(S.nodeId))m[N.name]=[String(S.nodeId),S.slotIndex];else{const j=n.nodes.find(C=>C.id===S.nodeId);if(j){const C=K1(j);C!==void 0?m[N.name]=C:console.warn(`[workflowInputs] Missing source node for input '${N.name}' on node ${s.id} (${s.type}).`,{sourceNodeId:S.nodeId,sourceNodeType:j.type,sourceAllowed:!1})}}}const p=o[l];if(!p?.input)return m;const g=p.input_order?.required||Object.keys(p.input.required||{}),b=p.input_order?.optional||Object.keys(p.input.optional||{}),x=[...g,...b];let w=0;const k=Array.isArray(s.widgets_values)?s.widgets_values:null;for(const N of x)try{const S=p.input.required?.[N]||p.input.optional?.[N];if(!S)continue;const[j]=S,C=s.inputs.find(Q=>Q.name===N),T=C?.link!=null,V=!!C?.widget&&!T,U=!!C,R=S[1]?.default,z=Object.prototype.hasOwnProperty.call(S[1]??{},"default");if(Iu(j)||V||!U){let Q=c?.[N];if(Q===void 0&&(Q=w),N==="seed"&&f?.[s.id]!==void 0&&!(N in m))m[N]=f[s.id];else if(Q!==void 0&&!T&&!(N in m)){const ue=da(s,N,Q);ue!==void 0&&(Array.isArray(j)?m[N]=U1(ue,j,R):m[N]=ep(ue,j))}else!T&&z&&!(N in m)&&(m[N]=R);Q!==void 0&&(w=Math.max(w,Q+1)),String(j)==="INT"&&(N==="seed"||N==="noise_seed")&&(Q!==void 0?w=Math.max(w,Q+2):w=Math.max(w,w+1))}}catch(S){console.error(`Error processing input '${N}' for node ${s.id} (${s.type}):`,S)}if(c)for(const[N,S]of Object.entries(c)){if(!(N in m)&&k&&S<k.length){const j=k[S];j!=null&&(m[N]=j)}if(!(N in m)&&!k){const j=da(s,N,S);j!=null&&(m[N]=j)}}return(l==="Power Lora Loader (rgthree)"||s.type==="Power Lora Loader (rgthree)")&&k&&k.forEach((N,S)=>{if(typeof N=="object"&&N!==null&&"lora"in N&&!(Object.values(c||{}).some(C=>C===S)||c===null&&S<w)){const C=`lora_${S}`;C in m||(m[C]=N)}}),f?.[s.id]!==void 0&&!("seed"in m)&&!("noise_seed"in m)&&(m.seed=f[s.id]),m}const ln="";function F1(){const n="comfyui-mobile-client-id";let o=localStorage.getItem(n);return o||(o="mobile-"+Math.random().toString(36).substring(2,15),localStorage.setItem(n,o)),o}const Zy=F1();async function tp(){const n=await fetch(`${ln}/api/object_info`);if(!n.ok)throw new Error("Failed to fetch node types");return n.json()}async function q1(){const n=await fetch(`${ln}/api/queue`);if(!n.ok)throw new Error("Failed to fetch queue");return n.json()}async function W1(n){const o=`${ln}/api/history?max_items=${n}`,s=await fetch(o);if(!s.ok)throw new Error("Failed to fetch history");return s.json()}async function G1(){const n=await fetch(`${ln}/api/v2/userdata?path=workflows`);if(!n.ok){if(n.status===404)return[];throw new Error("Failed to list user workflows")}return(await n.json()).filter(s=>s.type==="file"&&s.name.endsWith(".json"))}function Jy(n){return encodeURIComponent(n)}async function np(n){const o=await fetch(`${ln}/api/userdata/${Jy("workflows/"+n)}`);if(!o.ok)throw new Error("Failed to load workflow");return o.json()}async function eb(n,o){if(!(await fetch(`${ln}/api/userdata/${Jy("workflows/"+n)}?overwrite=true`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)})).ok)throw new Error("Failed to save workflow")}async function P1(){const n=await fetch(`${ln}/api/workflow_templates`);if(!n.ok)throw new Error("Failed to fetch templates");return n.json()}async function op(n,o){const s=await fetch(`${ln}/api/workflow_templates/${encodeURIComponent(n)}/${encodeURIComponent(o)}`);if(!s.ok)throw new Error("Failed to load template");return s.json()}async function Y1(){await fetch(`${ln}/api/interrupt`,{method:"POST"})}async function Q1(){await fetch(`${ln}/api/queue`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({clear:!0})})}async function X1(n){await fetch(`${ln}/api/queue`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({delete:[n]})})}async function tb(n,o){const s=new FormData;s.append("image",n),o?.type&&s.append("type",o.type),o?.subfolder&&s.append("subfolder",o.subfolder),o?.overwrite!==void 0&&s.append("overwrite",o.overwrite?"true":"false");const l=await fetch(`${ln}/upload/image`,{method:"POST",body:s});if(!l.ok)throw new Error("Failed to upload image");return l.json()}async function Z1(n){await fetch(`${ln}/api/history`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({delete:[n]})})}async function S0(n){n.length!==0&&await fetch(`${ln}/api/history`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({delete:n})})}async function J1(){await fetch(`${ln}/api/history`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({clear:!0})})}function mo(n,o,s){return`${ln}/view?filename=${encodeURIComponent(n)}&subfolder=${encodeURIComponent(o)}&type=${encodeURIComponent(s)}`}function ew(n,o,s,l,i){const f=`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}/ws?clientId=${n}`,m=new WebSocket(f);return m.onopen=()=>{s?.()},m.onmessage=p=>{try{const g=JSON.parse(p.data);o(g)}catch(g){console.error("[WS] Failed to parse message:",g)}},m.onclose=()=>{l?.()},m.onerror=p=>{console.error("[WS] Error:",p),i?.(p)},m}async function jf(n="",o=!1,s="output",l){const i=new URLSearchParams;n&&i.set("path",n),o&&i.set("recursive","true"),s&&i.set("source",s),l&&i.set("showHidden","true");const c=await fetch(`${ln}/mobile/api/files?${i}`);if(!c.ok)throw new Error("Failed to fetch files");return c.json()}async function tw(n){const o=await jf("",!1,"output",n),s=await jf("",!1,"input",n),l=o.files.filter(c=>c.type==="dir").map(c=>c.name);return{input:s.files.filter(c=>c.type==="dir").map(c=>c.name),output:l}}async function Mf(n,o=1e3,s=0,l="modified",i=!1,c=null,f){return(await jf(c||"",i,n,f)).files.map(p=>{if(p.type==="dir")return{id:`${n}/${p.path}`,name:p.name,type:"folder",date:p.date,size:p.size};const g=p.folder||(p.path.includes("/")?p.path.substring(0,p.path.lastIndexOf("/")):"");return{id:`${n}/${p.path}`,name:p.name,type:p.type,previewUrl:`${ln}/mobile/api/thumbnail?filename=${encodeURIComponent(p.name)}&subfolder=${encodeURIComponent(g)}&source=${n}`,fullUrl:`${ln}/view?filename=${encodeURIComponent(p.name)}&type=${n}&subfolder=${encodeURIComponent(g)}`,date:p.date,size:p.size}})}async function Of(n,o="output"){const s=await fetch(`${ln}/mobile/api/files`,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:n,source:o})});if(!s.ok){const l=await s.json();throw new Error(l.error||"Failed to delete file")}}async function nw(n,o="output"){const s=new URLSearchParams({path:n,source:o}),l=await fetch(`${ln}/mobile/api/file-metadata?${s.toString()}`);if(!l.ok){const c=await l.json().catch(()=>({}));throw new Error(c.error||"Failed to load file metadata")}const i=await l.json();if(!i.workflow)throw new Error("No workflow metadata found");return i.workflow}async function ow(n,o="output"){const s=new URLSearchParams({path:n,source:o}),l=await fetch(`${ln}/mobile/api/image-metadata?${s.toString()}`);if(!l.ok){const i=await l.json().catch(()=>({}));throw new Error(i.error||"Failed to load image metadata")}return l.json()}async function rw(n,o,s="output"){const l=await fetch(`${ln}/mobile/api/files/move`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sources:n,destination:o??"",source:s})});if(!l.ok){const i=await l.json().catch(()=>({}));throw new Error(i.error||"Failed to move files")}}async function N0(n,o="output"){const s=await fetch(`${ln}/mobile/api/files/mkdir`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:n,source:o})});if(!s.ok){const l=await s.json().catch(()=>({}));throw new Error(l.error||"Failed to create folder")}}async function sw(n,o,s="output"){const l=await fetch(`${ln}/mobile/api/files/rename`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:n,newName:o,source:s})});if(!l.ok){const i=await l.json().catch(()=>({}));throw new Error(i.error||"Failed to rename file")}}const It=Oo()(xr((n,o)=>({running:[],pending:[],isLoading:!1,lastExecutedId:null,queueItemExpanded:{},queueItemUserToggled:{},queueItemHideImages:{},showQueueMetadata:!1,previewVisibility:{},previewVisibilityDefault:!1,fetchQueue:async()=>{const{running:s}=o();n({isLoading:!0});try{const l=await q1(),i=l.queue_running.map(f=>({number:f[0],prompt_id:f[1],prompt:f[2],extra:f[3],outputs_to_execute:f[4]})),c=l.queue_pending.map(f=>({number:f[0],prompt_id:f[1],prompt:f[2],extra:f[3],outputs_to_execute:f[4]}));s.length>0&&i.length===0&&(n({lastExecutedId:s[0].prompt_id}),setTimeout(()=>n({lastExecutedId:null}),100)),n({running:i,pending:c})}catch(l){console.error("Failed to fetch queue:",l)}finally{n({isLoading:!1})}},clearQueue:async()=>{try{await Q1(),n({pending:[]})}catch(s){console.error("Failed to clear queue:",s)}},deleteItem:async s=>{try{await X1(s),n(l=>({pending:l.pending.filter(i=>i.prompt_id!==s)}))}catch(l){console.error("Failed to delete queue item:",l)}},interrupt:async()=>{try{await Y1()}catch(s){console.error("Failed to interrupt execution:",s)}},updateFromStatus:s=>{const{pending:l}=o();s!==l.length&&o().fetchQueue()},setQueueItemExpanded:(s,l)=>{n(i=>({queueItemExpanded:{...i.queueItemExpanded,[s]:l}}))},setQueueItemUserToggled:(s,l)=>{n(i=>({queueItemUserToggled:{...i.queueItemUserToggled,[s]:l}}))},setQueueItemHideImages:(s,l)=>{n(i=>({queueItemHideImages:{...i.queueItemHideImages,[s]:l}}))},toggleQueueItemHideImages:s=>{n(l=>({queueItemHideImages:{...l.queueItemHideImages,[s]:!l.queueItemHideImages[s]}}))},setShowQueueMetadata:s=>{n({showQueueMetadata:s})},toggleShowQueueMetadata:()=>{n(s=>({showQueueMetadata:!s.showQueueMetadata}))},setPreviewVisibility:(s,l)=>{n(i=>({previewVisibility:{...i.previewVisibility,[s]:l}}))},togglePreviewVisibility:s=>{n(l=>({previewVisibility:{...l.previewVisibility,[s]:!l.previewVisibility[s]}}))},setPreviewVisibilityDefault:s=>{n({previewVisibilityDefault:s})}}),{name:"queue-storage",storage:br(()=>localStorage),partialize:n=>({queueItemExpanded:n.queueItemExpanded,queueItemUserToggled:n.queueItemUserToggled,queueItemHideImages:n.queueItemHideImages,showQueueMetadata:n.showQueueMetadata,previewVisibility:n.previewVisibility,previewVisibilityDefault:n.previewVisibilityDefault})})),no=Oo()(xr(n=>({currentPanel:"workflow",setCurrentPanel:o=>{n({currentPanel:o})}}),{name:"navigation-storage",storage:br(()=>localStorage),partialize:n=>({currentPanel:n.currentPanel})})),ho=Oo()(xr((n,o)=>({pinnedWidgets:{},pinnedWidget:null,pinOverlayOpen:!1,setPinnedWidget:(s,l)=>{const{pinnedWidgets:i}=o();if(l&&s)n({pinnedWidget:s,pinnedWidgets:{...i,[l]:s}});else if(l&&!s){const c={...i};delete c[l],n({pinnedWidget:null,pinnedWidgets:c})}else n({pinnedWidget:s})},setPinOverlayOpen:s=>{n({pinOverlayOpen:s})},togglePinOverlay:()=>{n(s=>({pinOverlayOpen:!s.pinOverlayOpen}))},clearPinnedWidgetForKey:s=>{if(!s){n({pinnedWidget:null,pinOverlayOpen:!1});return}n(l=>{const i={...l.pinnedWidgets};return delete i[s],{pinnedWidgets:i,pinnedWidget:null,pinOverlayOpen:!1}})},restorePinnedWidgetForWorkflow:(s,l)=>{if(!s){n({pinnedWidget:null,pinOverlayOpen:!1});return}const i=o().pinnedWidgets[s];if(!i){n({pinnedWidget:null,pinOverlayOpen:!1});return}const c=l.nodes.some(f=>f.id===i.nodeId);n({pinnedWidget:c?i:null,pinOverlayOpen:!1})},clearCurrentPin:()=>{n({pinnedWidget:null,pinOverlayOpen:!1})}}),{name:"pinned-widget-storage",storage:br(()=>localStorage),partialize:n=>({pinnedWidgets:n.pinnedWidgets,pinnedWidget:n.pinnedWidget,pinOverlayOpen:n.pinOverlayOpen})})),rp=-1,Lu=-2,Au=-3,Fi=0x4000000000000,mu=new Set([rp,Lu,Au]);function sp(n){return mu.has(n)}function nb(n){return n===rp?"randomize":n===Lu?"increment":n===Au?"decrement":null}function lw(n){return n==="randomize"?rp:n==="increment"?Lu:n==="decrement"?Au:null}function Wr(n,o,s,l){if(!o)return null;const c=Jf(n,s.id)?.[l];if(c!==void 0)return c;const f=o[s.type];if(!f?.input)return null;const m=f.input_order?.required||Object.keys(f.input.required||{}),p=f.input_order?.optional||Object.keys(f.input.optional||{}),g=[...m,...p];let b=0;for(const x of g){const w=f.input.required?.[x]||f.input.optional?.[x];if(!w)continue;const[k]=w,N=s.inputs.find(U=>U.name===x),S=N?.link!=null,j=!!N?.widget&&!S,C=!!N;if(Iu(k)||j||!C){if(x===l)return b;b+=1,String(k)==="INT"&&(x==="seed"||x==="noise_seed")&&(b+=1)}}return null}function rl(n,o,s){const l=Wr(n,o,s,"seed")??Wr(n,o,s,"noise_seed");if(l!==null)return l;if(!o)return s.outputs?.some(x=>String(x.name||"").toLowerCase().includes("seed")&&String(x.type||"").toUpperCase().includes("INT"))&&Array.isArray(s.widgets_values)&&s.widgets_values.length>0?0:null;const i=o[s.type];if(!i?.input)return s.outputs?.some(x=>String(x.name||"").toLowerCase().includes("seed")&&String(x.type||"").toUpperCase().includes("INT"))&&Array.isArray(s.widgets_values)&&s.widgets_values.length>0?0:null;const c=Jf(n,s.id),f=i.input_order?.required||Object.keys(i.input.required||{}),m=i.input_order?.optional||Object.keys(i.input.optional||{}),p=[...f,...m];let g=0;for(const b of p){const x=i.input.required?.[b]||i.input.optional?.[b];if(!x)continue;const[w]=x,k=s.inputs.find(T=>T.name===b),N=k?.link!=null,S=!!k?.widget&&!N,j=!!k;if(Iu(w)||S||!j){const V=c?.[b]??g;if(String(w)==="INT"&&b.toLowerCase().includes("seed"))return V;g+=1,String(w)==="INT"&&(b==="seed"||b==="noise_seed")&&(g+=1)}}return null}function aw(n,o){const s=n[o.type];if(!s?.input)return 1;const i=(s.input.required?.seed||s.input.optional?.seed)?.[1],c=typeof i?.step=="number"?i.step:1;return c>0?c:1}function iw(n){const o=Number(n.properties?.randomMin??0),s=Number(n.properties?.randomMax??Fi),l=Number.isFinite(o)?Math.max(-Fi,o):0,i=Number.isFinite(s)?Math.min(Fi,s):Fi;return l<=i?{min:l,max:i}:{min:i,max:l}}function fa(n,o){const s=aw(n,o),{min:l,max:i}=iw(o),c=s>0?s/10:1,f=i-l;let m=l+Math.random()*f;return c>0&&(m=Math.round((m-l)/c)*c+l),m>i&&(m=i),m<l&&(m=l),mu.has(m)&&(m=0),m}function uw(n,o,s,l){if(mu.has(n)){if(typeof o=="number"&&!mu.has(o)){if(n===Lu)return o+1;if(n===Au)return o-1}return fa(s,l)}return Number.isFinite(n)?n:0}const Wn=Oo()(xr((n,o)=>({seedModes:{},seedLastValues:{},setSeedMode:(s,l,i)=>{const{seedModes:c,seedLastValues:f}=o();if(i?.workflow&&i.nodeTypes){const{workflow:m,nodeTypes:p,updateNodeWidgets:g}=i,b=m.nodes.find(x=>x.id===s);if(b){const x=rl(m,p,b);if(x!==null&&Array.isArray(b.widgets_values)){const w=x+1,k=typeof b.widgets_values[w]=="string",N={};if(k)N[w]=l;else{const S=lw(l);if(S!==null&&l!=="fixed")N[x]=S;else if(l==="fixed"){const j=Number(b.widgets_values[x]);if(sp(j)){const C=f[s],T=typeof C=="number"?C:fa(p,b);N[x]=T}}}Object.keys(N).length>0&&g(s,N)}}}n({seedModes:{...c,[s]:l}})},setSeedModes:s=>{n({seedModes:s})},setSeedLastValues:s=>{n({seedLastValues:s})},clearSeedState:()=>{n({seedModes:{},seedLastValues:{}})}}),{name:"seed-storage",storage:br(()=>localStorage),partialize:n=>({seedModes:n.seedModes,seedLastValues:n.seedLastValues})}));function C0(n,o){return n&&n[o]||null}function ob(n,o){try{if(o.type==="PrimitiveNode"){const p=o.outputs?.[0]?.type;if(!p)return[];const g=String(p).toUpperCase(),b=Array.isArray(o.widgets_values)?o.widgets_values[0]:void 0;return[{name:o.outputs?.[0]?.name||"value",type:g,options:void 0,value:b,widgetIndex:0,isCombo:!1,connected:!1,inputIndex:-1}]}if(o.type==="Power Lora Loader (rgthree)"){const p=[],g=o.properties?.["Show Strengths"]==="Separate Model & Clip";let b=[];if(n){const x=C0(n,"LoraLoader");if(x?.input?.required?.lora_name){const[w]=x.input.required.lora_name;Array.isArray(w)&&(b=w)}}if(Array.isArray(o.widgets_values)){const x=o.widgets_values,w=[];x.forEach((k,N)=>{typeof k=="object"&&k!==null&&"lora"in k&&"strength"in k&&w.push(N)}),w.length>0&&(p.push({name:"Loras",type:"POWER_LORA_HEADER",options:{loraIndices:w},value:null,widgetIndex:-1,isCombo:!1,connected:!1,inputIndex:-1}),w.forEach(k=>{const N=x[k];p.push({name:"Lora",type:"POWER_LORA",options:{choices:b.length>0?b:void 0,showSeparate:g},value:N,widgetIndex:k,isCombo:!1,connected:!1,inputIndex:-1})})),p.push({name:"Add Lora",type:"POWER_LORA_ADD",options:void 0,value:null,widgetIndex:o.widgets_values.length,isCombo:!1,connected:!1,inputIndex:-1})}return p}const s=C0(n,o.type);if(!s?.input)return o.outputs?.some(g=>String(g.name||"").toLowerCase().includes("seed")&&String(g.type||"").toUpperCase().includes("INT"))&&Array.isArray(o.widgets_values)&&o.widgets_values.length>0?[{name:"seed",type:"INT",options:void 0,value:o.widgets_values[0],widgetIndex:0,isCombo:!1,connected:!1,inputIndex:-1}]:[];const l=s.input_order?.required||Object.keys(s.input.required||{}),i=s.input_order?.optional||Object.keys(s.input.optional||{}),c=[];let f=0;const m=(p,g)=>{if(!g)return;const[b,x]=g,w=o.inputs.findIndex(R=>R.name===p),k=w>=0?o.inputs[w]:void 0,N=k?.link!=null,S=!!k?.widget&&!N,j=!!k,C=Object.prototype.hasOwnProperty.call(x??{},"default"),T=Iu(b)||S||!j||C,V=Array.isArray(b),U=V?{...x??{},options:b}:x;if(T){const R=da(o,p,f);c.push({name:p,type:V?"COMBO":String(b),options:U,value:R,widgetIndex:f,isCombo:V,connected:!!N,inputIndex:w})}T&&(f+=1,String(b)==="INT"&&(p==="seed"||p==="noise_seed")&&(f+=1))};for(const p of l){const g=s.input.required?.[p];g&&m(p,g)}for(const p of i){const g=s.input.optional?.[p];g&&m(p,g)}return c}catch(s){return console.error(`Error collecting widget definitions for node ${o.id} (${o.type}):`,s),[]}}function lp(n,o){return ob(n,o).filter(s=>!s.isCombo).map(s=>({name:s.name,type:s.type,options:s.options,value:s.value,widgetIndex:s.widgetIndex,connected:s.connected,inputIndex:s.inputIndex}))}function ap(n,o){return ob(n,o).filter(s=>s.isCombo).map(s=>({name:s.name,type:s.type,value:s.value,options:s.options,widgetIndex:s.widgetIndex,connected:s.connected,inputIndex:s.inputIndex}))}function cw(n){let o=5381;for(let s=0;s<n.length;s+=1)o=(o<<5)+o+n.charCodeAt(s),o&=4294967295;return(o>>>0).toString(16).padStart(8,"0")}function dw(n,o){if(!n)return!1;const s=lp(n,o).filter(i=>!i.connected),l=ap(n,o).filter(i=>!i.connected);return s.length===0&&l.length===0}function fw(n){const o=n.nodes??[],s=n.definitions?.subgraphs?.flatMap(l=>l.nodes??[])??[];return[...o,...s]}function Xd(n,o){const i=fw(n).filter(c=>!dw(o,c)).map(c=>c.type).sort().join("|");return`wf_${cw(i)}`}const k0="__mobile_origin",qi="__mobile_subgraph_group_map";function Zd(n,o,s){const l={...n.properties??{}};return s&&l[k0]===void 0&&(l[k0]=s),{...n,id:o,inputs:(n.inputs??[]).map(i=>({...i,link:null})),outputs:(n.outputs??[]).map(i=>({...i,links:[]})),widgets_values:n.widgets_values??[],flags:n.flags??{},properties:l,mode:n.mode??0,order:n.order??0}}function pw(n,o){if(!o||o.length===0)return null;const s=[...o].sort((g,b)=>g.id-b.id),[l,i]=n.pos,[c,f]=n.size,m=l+c/2,p=i+f/2;for(const g of s){const[b,x,w,k]=g.bounding;if(m>=b&&m<=b+w&&p>=x&&p<=x+k)return g.id}return null}function j0(n,o){const s=new Map,l=new Map;return o.forEach((i,c)=>{i?.name&&l.set(i.name,c)}),n.forEach((i,c)=>{const f=i?.name;if(f&&l.has(f)){s.set(c,l.get(f));return}c<o.length&&s.set(c,c)}),s}function hw(n,o){const s=new Map;for(const l of n)l.inputs=(l.inputs??[]).map(i=>({...i,link:null})),l.outputs=(l.outputs??[]).map(i=>({...i,links:[]})),s.set(l.id,l);for(const l of o){const[i,c,f,m,p]=l,g=s.get(c),b=s.get(m),x=g?.outputs?.[f],w=b?.inputs?.[p];x&&(x.links||(x.links=[]),x.links.push(i)),w&&(w.link=i)}return n}function mw(n,o){const s=n.nodes.filter(N=>o.has(N.type));if(s.length===0)return{workflow:n,changed:!1};const l=new Set(s.map(N=>N.id));let i=Math.max(0,...n.nodes.map(N=>N.id))+1;const c=[],f=n.groups??[],m=n.extra??{},p=typeof m[qi]=="object"&&m[qi]!==null?m[qi]:{},g={};for(const[N,S]of Object.entries(p))(typeof S=="number"||S===null)&&(g[N]=S);const b=new Map;for(const N of n.nodes){if(!l.has(N.id)){c.push(Zd(N,N.id,{scope:"root",nodeId:N.id}));continue}const S=o.get(N.type);if(!S){c.push(Zd(N,N.id,{scope:"root",nodeId:N.id}));continue}const j=pw(N,f);g[S.id]=j??null;const C=j0(N.inputs??[],S.inputs??[]),T=j0(N.outputs??[],S.outputs??[]),V=new Map,U=new Map,R=new Map,z=[];for(const L of S.nodes??[]){const $=i++;V.set(L.id,$),c.push(Zd(L,$,{scope:"subgraph",subgraphId:S.id,nodeId:L.id}))}for(const L of S.links??[]){const $=L.origin_id,Q=L.target_id;if($===-10){const de=V.get(Q);if(de!==void 0){const Ie=U.get(L.origin_slot)??[];Ie.push({origin_id:-10,origin_slot:L.origin_slot,target_id:de,target_slot:L.target_slot,type:L.type}),U.set(L.origin_slot,Ie)}continue}if(Q===-20){const de=V.get($);if(de!==void 0){const Ie=R.get(L.target_slot)??[];Ie.push({origin_id:de,origin_slot:L.origin_slot,target_id:-20,target_slot:L.target_slot,type:L.type}),R.set(L.target_slot,Ie)}continue}const ue=V.get($),fe=V.get(Q);ue!==void 0&&fe!==void 0&&z.push({origin_id:ue,origin_slot:L.origin_slot,target_id:fe,target_slot:L.target_slot,type:L.type})}b.set(N.id,{inputSlotMap:C,outputSlotMap:T,inputTargets:U,outputSources:R,internalLinks:z})}const x=[],w=n.links??[];for(const N of w){const[,S,j,C,T,V]=N,U=l.has(S),R=l.has(C);if(!U&&!R){x.push({origin_id:S,origin_slot:j,target_id:C,target_slot:T,type:V});continue}if(U&&R){const z=b.get(S),L=b.get(C),$=z?.outputSlotMap.get(j),Q=L?.inputSlotMap.get(T);if($===void 0||Q===void 0)continue;const ue=z?.outputSources.get($)??[],fe=L?.inputTargets.get(Q)??[];for(const de of ue)for(const Ie of fe)x.push({origin_id:de.origin_id,origin_slot:de.origin_slot,target_id:Ie.target_id,target_slot:Ie.target_slot,type:de.type});continue}if(U){const z=b.get(S),L=z?.outputSlotMap.get(j);if(L===void 0)continue;const $=z?.outputSources.get(L)??[];for(const Q of $)x.push({origin_id:Q.origin_id,origin_slot:Q.origin_slot,target_id:C,target_slot:T,type:Q.type});continue}if(R){const z=b.get(C),L=z?.inputSlotMap.get(T);if(L===void 0)continue;const $=z?.inputTargets.get(L)??[];for(const Q of $)x.push({origin_id:S,origin_slot:j,target_id:Q.target_id,target_slot:Q.target_slot,type:Q.type})}}for(const N of b.values())x.push(...N.internalLinks);const k=x.map((N,S)=>[S+1,N.origin_id,N.origin_slot,N.target_id,N.target_slot,N.type]);return hw(c,k),{workflow:{...n,extra:{...m,[qi]:g},nodes:c,links:k,last_node_id:Math.max(0,...c.map(N=>N.id)),last_link_id:k.length},changed:!0}}function gw(n){const o=n.definitions?.subgraphs??[];if(o.length===0)return n;const s=new Map;for(const i of o)i?.id&&s.set(i.id,i);let l=n;for(let i=0;i<o.length+4;i+=1){const{workflow:c,changed:f}=mw(l,s);if(!f)break;l=c}return l}function yw(n){const o=new Map,s=new Map,l=new Map;for(const i of n.nodes)o.set(i.id,i),s.set(i.id,[]),l.set(i.id,[]);for(const i of n.links){const[,c,,f]=i,m=s.get(f);m&&!m.includes(c)&&m.push(c);const p=l.get(c);p&&!p.includes(f)&&p.push(f)}return{nodes:o,dependencies:s,dependents:l}}function bw(n){return["SaveImage","PreviewImage","SaveAnimatedWEBP","SaveAnimatedPNG","SaveVideo","SaveAudio"].some(s=>n.type.includes(s))||n.outputs.length===0||n.outputs.every(s=>!s.links||s.links.length===0)}function xw(n){if(n.nodes.length===0)return[];const o=yw(n),s=new Set,l=[];function i(f){if(s.has(f))return;s.add(f);const m=o.nodes.get(f);if(!m)return;const p=o.dependencies.get(f)||[];for(const g of p)i(g);l.push(m)}const c=n.nodes.filter(bw);if(c.length===0)for(const f of n.nodes)(o.dependents.get(f.id)||[]).length===0&&c.push(f);for(const f of c)i(f.id);for(const f of n.nodes)s.has(f.id)||i(f.id);return l}function ll(n,o,s){const l=n.nodes.find(g=>g.id===o);if(!l||!l.inputs[s])return null;const i=l.inputs[s].link;if(i===null)return null;const c=n.links.find(g=>g[0]===i);if(!c)return null;const[,f,m]=c,p=n.nodes.find(g=>g.id===f);return p?{node:p,outputIndex:m}:null}function pa(n,o,s){const l=n.nodes.find(f=>f.id===o);if(!l||!l.outputs[s])return[];const i=l.outputs[s].links||[],c=[];for(const f of i){const m=n.links.find(x=>x[0]===f);if(!m)continue;const[,,,p,g]=m,b=n.nodes.find(x=>x.id===p);b&&c.push({node:b,inputIndex:g})}return c}function ha(n){if(n==null)return[];if(Array.isArray(n))return n.flatMap(s=>ha(s)).filter(Boolean);const o=String(n);return o?o.split(",").map(s=>s.trim().toUpperCase()).filter(Boolean):[]}function M0(n){return!(n==="*"||n==="OPT_CONNECTION")}function O0(n,o){const s=ha(n),l=ha(o);return s.length===0||l.length===0?!1:s.includes("*")||l.includes("*")?!0:s.some(i=>l.includes(i))}function Ru(n,o){const s=ha(n).filter(M0),l=ha(o).filter(M0);return s.length===0||l.length===0?!1:s.some(i=>l.includes(i))}function vw(n,o,s,l){const i=n.nodes.find(m=>m.id===s);if(!i)return[];const c=i.inputs[l];if(!c)return[];const f=[];for(const m of n.nodes)if(m.id!==s&&m.mode!==4)for(let p=0;p<m.outputs.length;p++){const g=m.outputs[p];if(Ru(g.type,c.type)){f.push({node:m,outputIndex:p});break}}return f}function ww(n,o){const s=[];for(const[l,i]of Object.entries(n)){const c=i.output??[];for(let f=0;f<c.length;f++)if(Ru(c[f],o)){s.push({typeName:l,def:i,outputIndex:f});break}}return s}function Sw(n){const o=n.input?.required??{},s=n.input?.optional??{},l=n.input_order?.required??Object.keys(o),i=n.input_order?.optional??Object.keys(s),c=[],f=(m,p)=>{if(!Array.isArray(p)||p.length===0)return;const[g]=p;if(Array.isArray(g))return;const b=String(g).toUpperCase();["INT","FLOAT","BOOLEAN","STRING"].includes(b)||c.push({inputIndex:c.length,inputName:m,inputType:String(g)})};for(const m of l)f(m,o[m]);for(const m of i)f(m,s[m]);return c}function Nw(n,o){const s=[];for(const[l,i]of Object.entries(n)){const c=Sw(i);for(const f of c)if(Ru(o,f.inputType)){s.push({typeName:l,def:i,inputIndex:f.inputIndex,inputName:f.inputName,inputType:f.inputType});break}}return s}function Cw(n,o,s){const l=n.nodes.find(f=>f.id===o);if(!l)return[];const i=l.outputs?.[s];if(!i)return[];const c=[];for(const f of n.nodes)if(f.id!==o&&f.mode!==4)for(let m=0;m<(f.inputs?.length??0);m+=1){const p=f.inputs[m];Ru(i.type,p.type)&&c.push({node:f,inputIndex:m})}return c}function ma(n,o){const s=new Map;if(!o||o.length===0)return s;const l=[...o].sort((i,c)=>{const f=i.bounding[2]*i.bounding[3],m=c.bounding[2]*c.bounding[3];return f!==m?f-m:i.id-c.id});for(const i of n){const[c,f]=i.pos,[m,p]=i.size,g=c+m/2,b=f+p/2;for(const x of l){const[w,k,N,S]=x.bounding;if(g>=w&&g<=w+N&&b>=k&&b<=k+S){s.set(i.id,x.id);break}}}return s}function iu(){return{root:[],groups:{},groupParents:{},subgraphs:{},hiddenBlocks:{}}}function ip(n){const o=n.split("/").filter(Boolean);if(o.length===0||o[0]!=="root")return null;const s=o.slice(1);if(s.length===0)return null;const l=m=>{const p=m.indexOf(":");if(p<=0)return null;const g=m.slice(0,p),b=m.slice(p+1);return g!=="node"&&g!=="group"&&g!=="subgraph"||b.length===0?null:{type:g,rawId:b}};let i=null;for(let m=0;m<s.length-1;m+=1){const p=l(s[m]);if(!p||p.type==="node")return null;p.type==="subgraph"&&(i=p.rawId)}const c=l(s[s.length-1]);if(!c)return null;if(c.type==="subgraph")return{type:"subgraph",subgraphId:c.rawId};const f=Number(c.rawId);return Number.isFinite(f)?c.type==="group"?{type:"group",groupId:f,subgraphId:i}:{type:"node",nodeId:f,subgraphId:i}:null}function mn(n){if(n.type==="group"&&n.groupKey)return n.groupKey;const o=n.subgraphId==null?"root":`root/subgraph:${n.subgraphId}`;return n.type==="group"?`${o}/group:${n.groupId}`:n.type==="node"?`${o}/node:${n.nodeId}`:`root/subgraph:${n.subgraphId}`}function kw(n,o){return n.type!==o.type?!1:n.type==="node"&&o.type==="node"?n.id===o.id:n.type==="group"&&o.type==="group"?n.stableKey===o.stableKey:n.type==="subgraph"&&o.type==="subgraph"?n.id===o.id:n.type==="hiddenBlock"&&o.type==="hiddenBlock"?n.blockId===o.blockId:!1}function jw(n){const s=n.properties?.__mobile_origin;if(!s||typeof s!="object")return null;const l=s.scope;if(l==="root")return{scope:"root"};if(l==="subgraph"){const i=s.subgraphId;if(typeof i=="string")return{scope:"subgraph",subgraphId:i}}return null}function Mw(n,o,s){const l=o.groups??[],i=o.definitions?.subgraphs??[],c=new Map;for(const z of n){const L=jw(z);L?.scope==="subgraph"&&L.subgraphId&&c.set(z.id,L.subgraphId)}const f=n.filter(z=>!c.has(z.id)),m=ma(f,l),p=new Map;for(const z of i){const L=n.filter(Q=>c.get(Q.id)===z.id),$=z.groups??[];$.length>0&&p.set(z.id,ma(L,$))}const g=o.extra?.__mobile_subgraph_group_map,b=new Map;if(g&&typeof g=="object")for(const[z,L]of Object.entries(g))(typeof L=="number"||L===null)&&b.set(z,L);const x=iu();for(const z of i)x.subgraphs[z.id]=[];const w=z=>{const L=new Map;for(const $ of z){const[Q,ue,fe,de]=$.bounding,Ie=Q+fe/2,je=ue+de/2,Me=fe*de;let _=null,oe=Number.POSITIVE_INFINITY;for(const ce of z){if(ce.id===$.id)continue;const[Ke,Le,E,A]=ce.bounding,M=E*A;if(M<=Me)continue;const ee=Q>=Ke&&ue>=Le&&Q+fe<=Ke+E&&ue+de<=Le+A,Te=Ie>=Ke&&Ie<=Ke+E&&je>=Le&&je<=Le+A;!ee&&!Te||M<oe&&(oe=M,_=ce.id)}L.set($.id,_)}return L};function k(z,L,$){const Q=[];let ue=[],fe=0;const de=()=>{if(ue.length===0)return;const Ie=`hidden-${L}-${fe}`;fe++,x.hiddenBlocks[Ie]=[...ue],Q.push({type:"hiddenBlock",blockId:Ie}),ue=[]};for(const Ie of z)Ie.type==="node"&&s[mn({type:"node",nodeId:Ie.id,subgraphId:$})]?ue.push(Ie.id):(de(),Q.push(Ie));return de(),Q}for(const z of i){const L=n.filter(oe=>c.get(oe.id)===z.id),$=p.get(z.id),Q=z.groups??[],ue=w(Q),fe=new Map,de=new Map((z.groups??[]).map(oe=>[oe.id,oe])),Ie=new Set,je=[],Me=oe=>fe.get(oe)??`legacy-group-${z.id}-${oe}`,_=oe=>{const ce=[],Ke=new Set;let Le=oe;for(;Le!=null&&!Ke.has(Le);)ce.push(Le),Ke.add(Le),Le=ue.get(Le)??null;ce.reverse();for(const E of ce){if(Ie.has(E))continue;const A=ue.get(E)??null,M=de.get(E)?.stableKey??`legacy-group-${z.id}-${E}`;fe.set(E,M);const ee={type:"group",id:E,subgraphId:z.id,stableKey:M};if(A==null)je.push(ee),x.groupParents[M]={scope:"subgraph",subgraphId:z.id};else{const Te=Me(A);x.groups[Te]??=[],x.groups[Te].push(ee),x.groupParents[M]={scope:"group",groupKey:Te}}Ie.add(E)}};for(const oe of L){const ce=$?.get(oe.id);if(ce===void 0){je.push({type:"node",id:oe.id});continue}_(ce),x.groups[Me(ce)]??=[],x.groups[Me(ce)].push({type:"node",id:oe.id})}for(const oe of Q)_(oe.id);for(const oe of Q){const ce=Me(oe.id);x.groups[ce]=k(x.groups[ce]??[],`group-${ce}`,z.id)}x.subgraphs[z.id]=k(je,`subgraph-${z.id}`,z.id)}const N=w(l),S=new Set,j=new Set,C=[],T=new Map,V=new Map(l.map(z=>[z.id,z])),U=z=>T.get(z)??`legacy-group-root-${z}`,R=z=>{const L=[],$=new Set;let Q=z;for(;Q!=null&&!$.has(Q);)L.push(Q),$.add(Q),Q=N.get(Q)??null;L.reverse();for(const ue of L){if(S.has(ue))continue;const fe=N.get(ue)??null,de=V.get(ue)?.stableKey??`legacy-group-root-${ue}`;T.set(ue,de);const Ie={type:"group",id:ue,subgraphId:null,stableKey:de};if(fe==null)C.push(Ie),x.groupParents[de]={scope:"root"};else{const je=U(fe);x.groups[je]??=[],x.groups[je].push(Ie),x.groupParents[de]={scope:"group",groupKey:je}}S.add(ue)}};for(const z of f){const L=m.get(z.id);if(L===void 0){C.push({type:"node",id:z.id});continue}R(L),x.groups[U(L)]??=[],x.groups[U(L)].push({type:"node",id:z.id})}for(const z of i){if(j.has(z.id))continue;const L=b.get(z.id);L!=null?(R(L),x.groups[U(L)]??=[],x.groups[U(L)].push({type:"subgraph",id:z.id})):C.push({type:"subgraph",id:z.id}),j.add(z.id)}for(const z of l)R(z.id);for(const z of l){const L=U(z.id);x.groups[L]=k(x.groups[L]??[],`group-${L}`,null)}return x.root=k(C,"root",null),x}function T0(n,o){const s=f=>{const m=[];for(const p of f)if(!(p.type==="node"&&p.id===o)){if(p.type==="hiddenBlock"){const g=n.hiddenBlocks[p.blockId];if(g&&g.filter(x=>x!==o).length===0)continue}m.push(p)}return m},l={};for(const[f,m]of Object.entries(n.hiddenBlocks)){const p=m.filter(g=>g!==o);p.length>0&&(l[f]=p)}const i={};for(const[f,m]of Object.entries(n.groups))i[f]=s(m);const c={};for(const[f,m]of Object.entries(n.subgraphs))c[f]=s(m);return{root:s(n.root),groups:i,groupParents:n.groupParents??{},subgraphs:c,hiddenBlocks:l}}function Ow(n,o,s){const l={type:"node",id:o},i=(c,f)=>{const m=(p,g)=>{for(const b of p){if(b.type==="group"&&b.id===c&&g===f)return b.stableKey;if(b.type==="group"){const x=m(n.groups[b.stableKey]??[],g);if(x)return x;continue}if(b.type==="subgraph"){const x=m(n.subgraphs[b.id]??[],b.id);if(x)return x}}return null};return m(n.root,null)};if(s?.subgraphId){const c=n.subgraphs[s.subgraphId]??[];if(s.groupId!=null){const f=i(s.groupId,s.subgraphId);if(!f)return{...n,subgraphs:{...n.subgraphs,[s.subgraphId]:[...c,l]}};const m=n.groups[f]??[];return{...n,groups:{...n.groups,[f]:[...m,l]}}}return{...n,subgraphs:{...n.subgraphs,[s.subgraphId]:[...c,l]}}}if(s?.groupId!=null){const c=i(s.groupId,s.subgraphId??null);if(!c)return{...n,root:[...n.root,l]};const f=n.groups[c]??[];return{...n,groups:{...n.groups,[c]:[...f,l]}}}return{...n,root:[...n.root,l]}}function Tw(n,o){const s=n.groups[o]??[],l=g=>{const b=[];for(const x of g)x.type==="group"&&x.stableKey===o?b.push(...s):b.push(x);return b},i={...n.groups},c={...n.groupParents??{}},f=c[o];delete i[o],delete c[o];let m=n.root;n.root.some(g=>g.type==="group"&&g.stableKey===o)&&(m=l(n.root));for(const[g,b]of Object.entries(i))b.some(x=>x.type==="group"&&x.stableKey===o)&&(i[g]=l(b));const p={...n.subgraphs};for(const[g,b]of Object.entries(p))b.some(x=>x.type==="group"&&x.stableKey===o)&&(p[g]=l(b));for(const g of s)g.type==="group"&&(f?c[g.stableKey]=f:delete c[g.stableKey]);return{root:m,groups:i,groupParents:c,subgraphs:p,hiddenBlocks:n.hiddenBlocks}}function Ew(n,o,s,l,i,c){const f=n.groupParents??{},m=(N,S)=>S.scope==="root"?N.root:S.scope==="group"?N.groups[S.groupKey]??[]:N.subgraphs[S.subgraphId]??[],p=(N,S,j)=>S.scope==="root"?{...N,root:j}:S.scope==="group"?{...N,groups:{...N.groups,[S.groupKey]:j}}:{...N,subgraphs:{...N.subgraphs,[S.subgraphId]:j}},g=N=>N.scope==="root"?{scope:"root"}:N.scope==="group"?{scope:"group",groupKey:N.groupKey}:{scope:"subgraph",subgraphId:N.subgraphId};if(s.scope===i.scope&&(s.scope==="root"||s.scope==="group"&&i.scope==="group"&&s.groupKey===i.groupKey||s.scope==="subgraph"&&i.scope==="subgraph"&&s.subgraphId===i.subgraphId)){const N=[...m(n,s)],[S]=N.splice(l,1);if(!S)return n;const j=c>l?c-1:c;return N.splice(j,0,S),p(n,s,N)}const x=[...m(n,s)];x.splice(l,1);let w=p(n,s,x);const k=[...m(w,i)];return k.splice(c,0,o),w=p(w,i,k),o.type==="group"&&(w={...w,groupParents:{...w.groupParents??f,[o.stableKey]:g(i)}}),w}function rb(n){const o=[],s=l=>{for(const i of l)if(i.type==="node")o.push(i.id);else if(i.type==="group"){const c=n.groups[i.stableKey];c&&s(c)}else if(i.type==="subgraph"){const c=n.subgraphs[i.id];c&&s(c)}else if(i.type==="hiddenBlock"){const c=n.hiddenBlocks[i.blockId];c&&o.push(...c)}};return s(n.root),o}function Iw(n,o){return o.scope==="root"?n.root:o.scope==="group"?n.groups[o.groupKey]??[]:n.subgraphs[o.subgraphId]??[]}function sb(n,o){const s=(i,c)=>{const f=i.findIndex(m=>kw(m,o));return f>=0?{containerId:c,index:f}:null},l=s(n.root,{scope:"root"});if(l)return l;for(const[i,c]of Object.entries(n.groups)){const f=s(c,{scope:"group",groupKey:i});if(f)return f}for(const[i,c]of Object.entries(n.subgraphs)){const f=s(c,{scope:"subgraph",subgraphId:i});if(f)return f}return null}function Lw(n,o,s=250){const l=n.nodes.find(i=>i.id===o);return l?[l.pos[0]+s,l.pos[1]]:null}function E0(n){return n.nodes.length===0?[0,0]:[0,Math.max(...n.nodes.map(s=>s.pos[1]+(s.size?.[1]??100)))+80]}function Aw(n,o,s,l=24){const[i,c,f,m]=o.bounding,[p,g]=s,b=i+l,x=c+48,w=Math.max(b,i+f-p-l),k=Math.max(x,c+m-g-l);return[Math.min(Math.max(n[0],b),w),Math.min(Math.max(n[1],x),k)]}function lb(n,o){const s=(l,i,c,f)=>{for(const m of l){if(o({ref:m,groupKeys:i,subgraphIds:c,currentSubgraphId:f}))return{groupKeys:i,subgraphIds:c,currentSubgraphId:f};if(m.type==="group"){const p=s(n.groups[m.stableKey]??[],[...i,m.stableKey],c,f);if(p)return p;continue}if(m.type==="subgraph"){const p=s(n.subgraphs[m.id]??[],i,[...c,m.id],m.id);if(p)return p}}return null};return s(n.root,[],[],null)}const Tf="__mobile_origin",qr="__mobile_subgraph_group_map";let Rw=0;function fs(n,o){return Mw(xw(n),n,o)}function _w(){return typeof crypto<"u"&&typeof crypto.randomUUID=="function"?`sk_${crypto.randomUUID()}`:`sk_${Math.random().toString(36).slice(2)}_${Date.now().toString(36)}`}function Dw(n){const o=[],s=new Set,l=new Set,i=(c,f)=>{for(const m of c){if(m.type==="node"){o.push(mn({type:"node",nodeId:m.id,subgraphId:f}));continue}if(m.type==="group"){if(o.push(m.stableKey),s.has(m.stableKey))continue;s.add(m.stableKey),i(n.groups[m.stableKey]??[],f);continue}if(m.type==="subgraph"){const p=mn({type:"subgraph",subgraphId:m.id});if(o.push(p),l.has(m.id))continue;l.add(m.id),i(n.subgraphs[m.id]??[],m.id)}}};return i(n.root,null),o}function I0(n){const o=ip(n);return o?o.type==="node"?`node:${o.nodeId}`:o.type==="group"?`group:${o.subgraphId??"root"}:${o.groupId}`:`subgraph:${o.subgraphId}`:`unknown:${n}`}function Lo(n,o,s){const l=Dw(n),i=new Map;for(const[p,g]of Object.entries(s)){const b=I0(g),x=i.get(b)??[];x.push(p),i.set(b,x)}const c=new Set,f={},m={};for(const p of l){let g=o[p];if(g&&c.has(g)&&(g=void 0),!g){const b=I0(p),x=i.get(b)??[];for(;x.length>0;){const w=x.shift();if(!(!w||c.has(w))){g=w;break}}i.set(b,x)}g||(g=_w()),c.add(g),f[p]=g,m[g]=p}return{layoutToStable:f,stableToLayout:m}}function Bw(n,o){const s=new Set(o.nodes.map(i=>i.id)),l=new Set(rb(n));if(s.size!==l.size)return!1;for(const i of s)if(!l.has(i))return!1;return!0}function ga(n,o=null){return mn({type:"node",nodeId:n,subgraphId:o})}function zw(n){const o=po(n);return ga(n.id,o?.scope==="subgraph"?o.subgraphId:null)}const L0=new WeakMap;function Hw(n){const o=L0.get(n);if(o)return o;const s=new Map;for(const l of n.nodes){const i=zw(l),c=s.get(l.id);c?c.includes(i)||c.push(i):s.set(l.id,[i])}return L0.set(n,s),s}function ua(n,o,s=null){if(s!=null)return[ga(o,s)];const l=Hw(n).get(o)??[];return l.length>0?[...l]:[ga(o,null)]}function Jd(n,o){if(!o)return{};const s={};for(const[l,i]of Object.entries(o)){if(!i)continue;if(l.includes(":node:")||l.includes("/node:")){const f=ip(l);if(f?.type==="node"){s[ga(f.nodeId,f.subgraphId)]=!0;continue}const m=l.match(/^(root|subgraph:(.*)):node:(\d+)$/);if(!m)continue;const p=Number(m[3]);if(!Number.isFinite(p))continue;s[ga(p,m[1]==="root"?null:m[2]??null)]=!0;continue}const c=Number(l);if(Number.isFinite(c))for(const f of ua(n,c))s[f]=!0}return s}function A0(n){const o=i=>i.map(c=>c.type!=="group"?c:{...c}),s={};for(const[i,c]of Object.entries(n.groups)){const f=i,m=o(c);s[f]?s[f]=[...s[f],...m]:s[f]=m}const l={};for(const[i,c]of Object.entries(n.subgraphs))l[i]=o(c);return{...n,root:o(n.root),groups:s,subgraphs:l}}function Wi(n,o,s=null){const l=new Set,i=(c,f)=>{for(const m of c)m.type==="group"?(m.id===o&&f===s&&l.add(m.stableKey),i(n.groups[m.stableKey]??[],f)):m.type==="subgraph"&&i(n.subgraphs[m.id]??[],m.id)};return i(n.root,null),[...l]}function up(n,o){return o[n]??null}function Vw(n,o){const s=new Set,l=[];for(const i of n){const c=up(i,o);!c||s.has(c)||(s.add(c),l.push(c))}return l}function Kw(n,o,s=null){const l=[],i=new Set;for(const[c,f]of Object.entries(n)){if(i.has(f))continue;const m=ip(c);m?.type==="node"&&m.nodeId===o&&(s!==null&&m.subgraphId!==s||(i.add(f),l.push(f)))}return l}function ps(n,o,s,l=null){const i=Kw(o,s,l);return i.length>0?i:Vw(ua(n,s,l),o)}function $n(n,o,s){const l=n.nodes.find(i=>i.stableKey===o);if(l){const i=po(l);return{nodeId:l.id,subgraphId:i?.scope==="subgraph"?i.subgraphId:null}}return null}function Gi(n,o,s){const l=(n.groups??[]).find(i=>i.stableKey===o);if(l)return{type:"group",groupId:l.id,subgraphId:null,stableKey:o};for(const i of n.definitions?.subgraphs??[]){if(i.stableKey===o)return{type:"subgraph",subgraphId:i.id,stableKey:o};const c=(i.groups??[]).find(f=>f.stableKey===o);if(c)return{type:"group",groupId:c.id,subgraphId:i.id,stableKey:o}}return null}function Pi(n,o){return(n.definitions?.subgraphs??[]).find(l=>l.id===o)?.stableKey??null}function ab(n,o){const s=n.groupParents?.[o];return s?s.scope==="subgraph"?s.subgraphId:s.scope==="root"?null:ab(n,s.groupKey):null}function ef(n,o){if(!n)return{};const s={};for(const[l,i]of Object.entries(n)){if(!i)continue;const c=up(l,o);c&&(s[c]=!0)}return s}function Uw(n,o){if(!n)return{};const s={};for(const[l,i]of Object.entries(n)){if(i!==!0)continue;const c=up(l,o);c&&(s[c]=!0)}return s}function Yi(n,o,s){if(!n)return{};const l={};for(const[i,c]of Object.entries(n)){if(!c)continue;if(s[i]){l[i]=!0;continue}const f=o[i];f&&(l[f]=!0)}return l}function tf(n,o,s){if(!n)return{};const l={};for(const[i,c]of Object.entries(n)){if(c!==!0)continue;if(s[i]){l[i]=!0;continue}const f=o[i];f&&(l[f]=!0)}return l}function Qi(n,o){if(!n)return{};const s={};for(const[l,i]of Object.entries(n)){if(!i)continue;const c=o[l];c&&(s[c]=!0)}return s}function Ef(n){return n.map(o=>({...o,widgets_values:o.widgets_values??[],inputs:o.inputs??[],outputs:o.outputs??[],flags:o.flags??{},properties:o.properties??{},mode:o.mode??0,order:o.order??0}))}function R0(n){const o=JSON.parse(JSON.stringify(n));return o.nodes=Ef(o.nodes??[]),o.links=o.links??[],o.groups=o.groups??[],o.config=o.config??{},o.definitions?.subgraphs&&(o.definitions.subgraphs=o.definitions.subgraphs.map(s=>({...s,nodes:Ef(s.nodes??[]),links:s.links??[]}))),o.last_node_id=o.last_node_id??Math.max(0,...o.nodes.map(s=>s.id)),o.last_link_id=o.last_link_id??0,o.version=o.version??.4,o}function _0(n){if(!("stableKey"in n))return n;const{stableKey:o,...s}=n;return s}function D0(n){if(!("stableKey"in n))return n;const{stableKey:o,...s}=n;return s}function gu(n){const o=n.nodes.map(_0),s=(n.groups??[]).map(D0),l=o.some((m,p)=>m!==n.nodes[p])||s.some((m,p)=>m!==(n.groups??[])[p]),i=n.definitions?.subgraphs;if(!i)return l?{...n,nodes:o,groups:s}:n;let c=!1;const f=i.map(m=>{const p=m.nodes.map(_0),g=(m.groups??[]).map(D0);let b=p.some((k,N)=>k!==m.nodes[N])||g.some((k,N)=>k!==(m.groups??[])[N]);if(m.stableKey!=null&&(b=!0),!b)return m;c=!0;const{stableKey:x,...w}=m;return{...w,nodes:p,groups:g}});return!l&&!c?n:{...n,nodes:o,groups:s,definitions:{...n.definitions??{},subgraphs:f}}}function po(n){if(!n)return null;const s=n.properties?.[Tf];if(!s||typeof s!="object")return null;const l=s.scope;if(l==="root"){const i=s.nodeId;return typeof i=="number"?{scope:"root",nodeId:i}:null}if(l==="subgraph"){const i=s.nodeId,c=s.subgraphId;if(typeof i=="number"&&typeof c=="string")return{scope:"subgraph",subgraphId:c,nodeId:i}}return null}function $w(n){const o=po(n);return mn({type:"node",nodeId:n.id,subgraphId:o?.scope==="subgraph"?o.subgraphId:null})}function B0(n,o,s=null){return n.map(l=>{const i=s===null?$w(l):mn({type:"node",nodeId:l.id,subgraphId:s}),c=o[i];return!c||l.stableKey===c?l:{...l,stableKey:c}})}function z0(n,o,s){return n.map(l=>{const i=mn({type:"group",groupId:l.id,subgraphId:s}),c=o[i];return!c||l.stableKey===c?l:{...l,stableKey:c}})}function jo(n,o){const s=B0(n.nodes,o),l=z0(n.groups??[],o,null),i=s.some((g,b)=>g!==n.nodes[b]),c=l.some((g,b)=>g!==(n.groups??[])[b]),f=n.definitions?.subgraphs;if(!f)return i||c?{...n,nodes:s,groups:l}:n;let m=!1;const p=f.map(g=>{const b=B0(g.nodes??[],o,g.id),x=z0(g.groups??[],o,g.id),w=mn({type:"subgraph",subgraphId:g.id}),k=o[w];return b.some((S,j)=>S!==(g.nodes??[])[j])||x.some((S,j)=>S!==(g.groups??[])[j])||k!=null&&g.stableKey!==k?(m=!0,{...g,stableKey:k??g.stableKey,nodes:b,groups:x}):g});return!i&&!c&&!m?n:{...n,nodes:s,groups:l,definitions:{...n.definitions??{},subgraphs:p}}}function yu(n,o){const s=new Set,l=Array.from(n);for(;l.length>0;){const i=l.pop();if(!i||s.has(i))continue;s.add(i);const c=o.get(i);if(c)for(const f of c)s.has(f)||l.push(f)}return s}function Fw(n){const o=new Set(n.map(l=>l.id)),s=new Map;for(const l of n)for(const i of l.nodes??[]){if(!o.has(i.type))continue;const c=s.get(i.type)??[];c.push({parentId:l.id,nodeId:i.id}),s.set(i.type,c)}return s}function ra(n,o,s){return!s||s.length===0?null:ma(o,s).get(n)??null}function qw(n,o){const s=lb(n,({ref:l,currentSubgraphId:i})=>l.type==="node"&&o.type==="node"?l.id===o.id:l.type==="group"&&o.type==="group"?o.id===l.id&&(o.subgraphId??null)===i:l.type==="subgraph"&&o.type==="subgraph"?o.id===l.id:!1);return s?{groupKeys:s.groupKeys,subgraphIds:s.subgraphIds}:null}function If(n,o,s=null){const l=n.nodes??[],i=n.groups??[],c=n.definitions?.subgraphs??[],f=new Map(c.map(w=>[w.id,w])),m=new Set(c.map(w=>w.id)),p=new Map,g=[];for(const w of l){const k=po(w);if(k?.scope==="subgraph"){const N=p.get(k.subgraphId);N?N.push(w):p.set(k.subgraphId,[w])}else g.push(w)}const b=new Map;for(const w of c){const k=new Set;for(const N of w.nodes??[])m.has(N.type)&&k.add(N.type);k.size>0&&b.set(w.id,k)}const x=new Set;if(s){const w=f.get(s);if(!w)return x;const k=w.groups??[];if(!k.find(R=>R.id===o))return x;const S=w.nodes??[],j=ma(S,k),C=new Set,T=new Set;for(const R of S)j.get(R.id)===o&&(m.has(R.type)?C.add(R.type):T.add(R.id));const V=p.get(s)??[];for(const R of V){const z=po(R);z?.scope==="subgraph"&&T.has(z.nodeId)&&x.add(R.id)}const U=yu(C,b);for(const R of U){const z=p.get(R)??[];for(const L of z)x.add(L.id)}}else{if(!i.find(C=>C.id===o))return x;const k=ma(g,i);for(const C of g)k.get(C.id)===o&&x.add(C.id);const N=n.extra?.[qr],S=new Set;if(N&&typeof N=="object")for(const[C,T]of Object.entries(N))T===o&&S.add(C);const j=yu(S,b);for(const C of j){const T=p.get(C)??[];for(const V of T)x.add(V.id)}}return x}function ib(n){const o=n.definitions?.subgraphs??[],s=new Set(o.map(i=>i.id)),l=new Map;for(const i of o){const c=new Set;for(const f of i.nodes??[])s.has(f.type)&&c.add(f.type);c.size>0&&l.set(i.id,c)}return l}function H0(n,o){const s=ib(n),l=yu([o],s),i=new Set;for(const c of n.nodes??[]){const f=po(c);f?.scope==="subgraph"&&l.has(f.subgraphId)&&i.add(c.id)}return i}function Ww(n,o){return n.scope==="subgraph"?n.subgraphId:n.scope==="root"?null:ab(o,n.groupKey)}function Gw(n,o){const s=new Map;let l=Math.max(0,...o.map(c=>c.id))+1;const i=n.map(c=>{const f=l++;return s.set(c.id,f),{...c,id:f}});return{idMap:s,promotedGroups:i}}function V0(n,o){if(o.size===0)return n;const s=new Set;for(const c of n.links??[])(o.has(c[1])||o.has(c[3]))&&s.add(c[0]);const l=(n.links??[]).filter(c=>!s.has(c[0])),i=(n.nodes??[]).filter(c=>!o.has(c.id)).map(c=>{const f=(c.inputs??[]).map(p=>p.link!=null&&s.has(p.link)?{...p,link:null}:p),m=(c.outputs??[]).map(p=>{const g=(p.links??[]).filter(b=>!s.has(b));return{...p,links:g.length>0?g:null}});return{...c,inputs:f,outputs:m}});return{...n,nodes:i,links:l}}function Pw(n,o,s,l){if(!Array.isArray(n.widgets_values)){const c={...n.widgets_values||{}};return l?(c[l]=s,n.type==="VHS_VideoCombine"&&l==="save_image"&&"save_output"in c&&(c.save_output=s)):o>=0&&(c[String(o)]=s),{...n,widgets_values:c}}let i=[...n.widgets_values];return o>=i.length?i.push(s):i[o]=s,n.type==="Power Lora Loader (rgthree)"&&(i=i.filter(c=>c!==null)),{...n,widgets_values:i}}function Yw(n,o){if(!Array.isArray(n.widgets_values))return n;const s=[...n.widgets_values];for(const[l,i]of Object.entries(o)){const c=parseInt(l,10);s[c]=i}return{...n,widgets_values:s}}function Xi(n,o){const s=po(o)??{scope:"root",nodeId:o.id};if(s.scope==="root"){const c=n.nodes.map(f=>f.id===s.nodeId?{...f,widgets_values:o.widgets_values??[]}:f);return{...n,nodes:c}}const l=n.definitions?.subgraphs;if(!l)return n;const i=l.map(c=>{if(c.id!==s.subgraphId)return c;const f=c.nodes.map(m=>m.id===s.nodeId?{...m,widgets_values:o.widgets_values??[]}:m);return{...c,nodes:f}});return{...n,definitions:{...n.definitions,subgraphs:i}}}function nf(n,o,s){const l=["fixed","randomize","increment","decrement"];if(Array.isArray(s.widgets_values)){const c=s.widgets_values.find(f=>typeof f=="string"&&l.includes(f.toLowerCase()));if(typeof c=="string"){const f=c.toLowerCase();if(l.includes(f))return f}}const i=rl(n,o,s);if(i!==null&&Array.isArray(s.widgets_values)){const c=Number(s.widgets_values[i]),f=nb(c);if(f)return f;const p=(s.outputs??[]).some(w=>String(w.name||"").toLowerCase().includes("seed")&&String(w.type||"").toUpperCase().includes("INT")),g=s.widgets_values.slice(i+1),b=g.length>0&&g.every(w=>w===""||w===null||w===void 0),x=s.properties&&("randomMin"in s.properties||"randomMax"in s.properties);if(p&&b&&x)return"randomize"}return"fixed"}function Qw(n,o){const s={};for(const l of n.nodes){const i=o[l.type];if(!i?.input)continue;const c=i.input_order?.required||Object.keys(i.input.required||{}),f=i.input_order?.optional||Object.keys(i.input.optional||{}),m=[...c,...f];for(const p of m){const g=i.input.required?.[p]||i.input.optional?.[p];if(!g)continue;const[b]=g;if(!Array.isArray(b)||b.length===0||l.inputs.find(T=>T.name===p)?.link!=null)continue;const w=Wr(n,o,l,p);if(w===null)continue;const k=da(l,p,w);if(k==null)continue;const N=ep(k,b,{comboIndexToValue:!0}),S=String(N),j=S.split(/[\\/]/).pop()??S;if(!b.some(T=>{const V=String(T);return V===S||V===j})){const T=String(l.id);s[T]||(s[T]=[]),s[T].push({type:"workflow_load",message:`Missing value: ${S}`,details:"Not found on server.",inputName:p})}}}return s}const ae=Oo()(xr((n,o)=>{const s=H=>{const{hiddenItems:Y,workflow:D,stableKeyByPointer:K}=o();if(!D){dn.getState().setNodeErrors(H);return}const W=Object.keys(H).filter(Oe=>{const be=Number(Oe);return Number.isFinite(be)?ps(D,K,be).some(ke=>!!Y[ke]):!1});if(W.length>0){const Oe={...Y};for(const be of W){const ke=Number(be);if(Number.isFinite(ke))for(const J of ps(D,K,ke))delete Oe[J]}n({hiddenItems:Oe})}dn.getState().setNodeErrors(H)},l=(H,Y)=>{const{workflow:D,hiddenItems:K,connectionHighlightModes:X,mobileLayout:W,stableKeyByPointer:Oe,pointerByStableKey:be}=o();if(!D)return;const ke=$n(D,H);if(!ke)return;const{nodeId:J,subgraphId:xe}=ke;if(!D.nodes.some(Fe=>{if(Fe.id!==J)return!1;const at=po(Fe);return xe==null?at?.scope!=="subgraph":at?.scope==="subgraph"&&at.subgraphId===xe}))return;const I=new Set,B=D.links.filter(Fe=>{const at=Fe[3]===J;return at&&I.add(Fe[0]),at}),q=D.links.filter(Fe=>{const at=Fe[1]===J;return at&&I.add(Fe[0]),at});let he=D.last_link_id;const me=new Map,Se=new Map,F=[];if(Y)for(const Fe of q){const[,,,at,ht,Lt]=Fe,Gt=B.find(ft=>O0(ft[5],Lt));if(!Gt)continue;const[,Pt,$t]=Gt;he+=1;const Ge=[he,Pt,$t,at,ht,Lt];F.push(Ge);const He=`${at}:${ht}`;me.set(He,Ge[0]);const Ve=`${Pt}:${$t}`,et=Se.get(Ve)??[];et.push(Ge[0]),Se.set(Ve,et)}const ie=[...D.links.filter(Fe=>!I.has(Fe[0])),...F],Ae=D.nodes.filter(Fe=>Fe.id!==J).map(Fe=>{const at=Fe.inputs.map((Lt,Gt)=>{const Pt=`${Fe.id}:${Gt}`,$t=me.get(Pt);return $t!=null?{...Lt,link:$t}:Lt.link!=null&&I.has(Lt.link)?{...Lt,link:null}:Lt}),ht=Fe.outputs.map((Lt,Gt)=>{const $t=(Lt.links??[]).filter(et=>!I.has(et)),Ge=`${Fe.id}:${Gt}`,He=Se.get(Ge)??[],Ve=[...$t,...He];return{...Lt,links:Ve.length>0?Ve:null}});return{...Fe,inputs:at,outputs:ht}}),Ue={...K};for(const Fe of ps(D,Oe,J,xe))delete Ue[Fe];for(const Fe of ua(D,J,xe))delete Ue[Fe];const Je={...X};delete Je[J];const Pe=T0(W,J),st=Lo(Pe,Oe,be),$e=jo({...D,nodes:Ae,links:ie,last_link_id:he},st.layoutToStable);n({workflow:$e,hiddenItems:Ue,connectionHighlightModes:Je,mobileLayout:Pe,stableKeyByPointer:st.layoutToStable,pointerByStableKey:st.stableToLayout})},i=(H,Y,D,K,X)=>{const{workflow:W,pointerByStableKey:Oe}=o();if(!W)return;const be=$n(W,H),ke=$n(W,D);if(!be||!ke)return;const J=be.nodeId,xe=ke.nodeId,I=W.nodes.find(Ae=>Ae.id===J),B=W.nodes.find(Ae=>Ae.id===xe);if(!I||!B)return;let q=[...W.links],he=W.last_link_id;const me=B.inputs[K]?.link;me!=null&&(q=q.filter(Ae=>Ae[0]!==me)),he++;const Se=he,F=[Se,J,Y,xe,K,X];q.push(F);const ie=W.nodes.map(Ae=>{if(Ae.id===xe){const Ue=[...Ae.inputs];return Ue[K]={...Ue[K],link:Se},{...Ae,inputs:Ue}}if(Ae.id===J){const Ue=[...Ae.outputs],st=[...(Ue[Y]?.links??[]).filter($e=>$e!==me),Se];return Ue[Y]={...Ue[Y],links:st},{...Ae,outputs:Ue}}if(me!=null&&Ae.id!==J&&Ae.outputs.some(Je=>Je.links?.includes(me))){const Je=Ae.outputs.map(Pe=>{if(Pe.links?.includes(me)){const st=Pe.links.filter($e=>$e!==me);return{...Pe,links:st.length>0?st:null}}return Pe});return{...Ae,outputs:Je}}return Ae});n({workflow:{...W,nodes:ie,links:q,last_link_id:he}})},c=(H,Y)=>{const{workflow:D,pointerByStableKey:K}=o();if(!D)return;const X=$n(D,H);if(!X)return;const W=X.nodeId,Oe=D.nodes.find(xe=>xe.id===W);if(!Oe)return;const be=Oe.inputs[Y]?.link;if(be==null)return;const ke=D.links.filter(xe=>xe[0]!==be),J=D.nodes.map(xe=>{if(xe.id===W){const B=[...xe.inputs];return B[Y]={...B[Y],link:null},{...xe,inputs:B}}if(xe.outputs.some(B=>B.links?.includes(be))){const B=xe.outputs.map(q=>{if(q.links?.includes(be)){const he=q.links.filter(me=>me!==be);return{...q,links:he.length>0?he:null}}return q});return{...xe,outputs:B}}return xe});n({workflow:{...D,nodes:J,links:ke}})},f=(H,Y)=>{const{workflow:D,nodeTypes:K,mobileLayout:X}=o();if(!D||!K)return null;const W=K[H];if(!W)return null;const Oe=D.last_node_id+1,be=[],ke=W.input?.required??{},J=W.input?.optional??{},xe=W.input_order?.required??Object.keys(ke),I=W.input_order?.optional??Object.keys(J);for(const Pe of xe){const st=ke[Pe];if(!st)continue;const[$e]=st;if(Array.isArray($e))continue;const Fe=String($e).toUpperCase();["INT","FLOAT","BOOLEAN","STRING"].includes(Fe)||be.push({name:Pe,type:String($e),link:null})}for(const Pe of I){const st=J[Pe];if(!st)continue;const[$e]=st;if(Array.isArray($e))continue;const Fe=String($e).toUpperCase();["INT","FLOAT","BOOLEAN","STRING"].includes(Fe)||be.push({name:Pe,type:String($e),link:null})}const B=(W.output??[]).map((Pe,st)=>({name:W.output_name?.[st]??Pe,type:Pe,links:null,slot_index:st})),q=[];for(const Pe of xe){const st=ke[Pe];if(!st)continue;const[$e,Fe]=st;if(Array.isArray($e)){q.push($e[0]??"");continue}const at=String($e).toUpperCase();at==="INT"||at==="FLOAT"?q.push(Fe?.default??0):at==="STRING"?q.push(Fe?.default??""):at==="BOOLEAN"&&q.push(Fe?.default??!1)}for(const Pe of I){const st=J[Pe];if(!st)continue;const[$e,Fe]=st;if(Array.isArray($e)){q.push($e[0]??"");continue}const at=String($e).toUpperCase();at==="INT"||at==="FLOAT"?q.push(Fe?.default??0):at==="STRING"?q.push(Fe?.default??""):at==="BOOLEAN"&&q.push(Fe?.default??!1)}let he=[0,0];if(Y?.nearNodeStableKey){const Pe=$n(D,Y.nearNodeStableKey,o().pointerByStableKey);Pe&&(he=Lw(D,Pe.nodeId)??he)}else if(Y?.inSubgraphId){const Pe=D.nodes.filter(st=>{const $e=po(st);return $e?.scope==="subgraph"&&$e.subgraphId===Y.inSubgraphId});if(Pe.length>0){const st=Math.max(...Pe.map(Fe=>Fe.pos[1]+(Fe.size?.[1]??100)));he=[Math.min(...Pe.map(Fe=>Fe.pos[0])),st+80]}else he=E0(D)}else he=E0(D);if(Y?.inGroupId!=null){const st=[...D.groups??[],...(D.definitions?.subgraphs??[]).flatMap($e=>$e.groups??[])].find($e=>$e.id===Y.inGroupId);st&&(he=Aw(he,st,[200,100]))}const me={};Y?.inSubgraphId&&(me[Tf]={scope:"subgraph",subgraphId:Y.inSubgraphId,nodeId:Oe});const Se={id:Oe,type:H,pos:he,size:[200,100],flags:{},order:0,mode:0,inputs:be,outputs:B,properties:me,widgets_values:q},F=Ow(X,Oe,{groupId:Y?.inGroupId??void 0,subgraphId:Y?.inSubgraphId??void 0}),{stableKeyByPointer:ie,pointerByStableKey:Ae}=o(),Ue=Lo(F,ie,Ae),Je=jo({...D,nodes:[...D.nodes,Se],last_node_id:Oe},Ue.layoutToStable);return n({workflow:Je,mobileLayout:F,stableKeyByPointer:Ue.layoutToStable,pointerByStableKey:Ue.stableToLayout}),Oe},m=(H,Y,D)=>{const{workflow:K,nodeTypes:X,pointerByStableKey:W}=o();if(!K||!X)return null;const Oe=$n(K,Y);if(!Oe)return null;const be=Oe.nodeId,ke=K.nodes.find(Se=>Se.id===be);if(!ke)return null;const J=ke.inputs[D];if(!J)return null;const xe=X[H];if(!xe)return null;const I=J.type.toUpperCase(),B=(xe.output??[]).findIndex(Se=>O0(String(Se),I));if(B<0)return null;const q=o().addNode(H,{nearNodeStableKey:Y});if(q===null)return null;const he=mn({type:"node",nodeId:q,subgraphId:Oe.subgraphId}),me=o().stableKeyByPointer[he];return me?(o().connectNodes(me,B,Y,D,J.type),q):null},p=(H,Y)=>{n(D=>({...(()=>{const K=D.workflow?$n(D.workflow,H,D.pointerByStableKey):null;if(!K)return{};const X=String(K.nodeId);return{nodeOutputs:{...D.nodeOutputs,[X]:Y}}})()}))},g=H=>{n(Y=>{const D=Y.workflow?$n(Y.workflow,H,Y.pointerByStableKey):null;if(!D)return{};const K=D.nodeId,X=Y.connectionHighlightModes[K]??"off",W=X==="off"?"inputs":X==="inputs"?"outputs":X==="outputs"?"both":"off";return{connectionHighlightModes:{...Y.connectionHighlightModes,[K]:W}}})},b=(H,Y)=>{n(D=>({...(()=>{const K=D.workflow?$n(D.workflow,H,D.pointerByStableKey):null;return K?{connectionHighlightModes:{...D.connectionHighlightModes,[K.nodeId]:Y}}:{}})()}))},x=(H,Y)=>{H&&n(D=>{const K={...D.hiddenItems};return Y?K[H]=!0:delete K[H],{hiddenItems:K}})},w=H=>{const{workflow:Y,pointerByStableKey:D}=o();if(!Y)return;const K=$n(Y,H);if(!K)return;const X=Y.definitions?.subgraphs??[],W=K.subgraphId??null,Oe=Y.nodes.find(me=>{if(me.id!==K.nodeId)return!1;const Se=po(me);return W===null?Se?.scope!=="subgraph":Se?.scope==="subgraph"&&Se.subgraphId===W});if(!Oe)return;const be=new Map(X.map(me=>[me.id,me])),ke=Fw(X),J=po(Oe),xe=Y.nodes.filter(me=>po(me)?.scope!=="subgraph"),I=J?.scope==="subgraph"?J.nodeId:Oe.id,q=(()=>{const me=new Set,Se=[I];if(J?.scope==="subgraph"){const F=be.get(J.subgraphId),ie=new Map;for(F?.links?.forEach(Ae=>{const Ue=ie.get(Ae.target_id)??[];Ue.push(Ae.origin_id),ie.set(Ae.target_id,Ue)});Se.length>0;){const Ae=Se.pop();if(Ae===void 0)continue;(ie.get(Ae)??[]).forEach(Je=>{me.has(Je)||(me.add(Je),Se.push(Je))})}return me}for(;Se.length>0;){const F=Se.pop();if(F===void 0)continue;const ie=Y.nodes.find(Ae=>Ae.id===F);ie&&ie.inputs?.forEach((Ae,Ue)=>{if(Ae.link===null)return;const Je=ll(Y,F,Ue);if(!Je)return;const Pe=Je.node.id;me.has(Pe)||(me.add(Pe),Se.push(Pe))})}return me})(),he=J?.scope==="subgraph"?J.subgraphId:null;n(me=>{const Se={...me.hiddenItems};for(const Ue of ps(Y,me.stableKeyByPointer,K.nodeId,W))delete Se[Ue];q.forEach(Ue=>{for(const Je of ps(Y,me.stableKeyByPointer,Ue,he))delete Se[Je]});const F={...me.collapsedItems},ie=(Ue,Je=null)=>{if(Ue!=null)for(const Pe of Wi(me.mobileLayout,Ue,Je))delete Se[Pe],delete F[Pe]},Ae=Ue=>{if(!Ue)return;const Je=Pi(Y,Ue);Je&&(delete F[Je],delete Se[Je])};if(!J||J.scope==="root"){const Ue=ra(Oe.id,xe,Y.groups??[]);ie(Ue,null),q.forEach(Je=>{const Pe=ra(Je,xe,Y.groups??[]);ie(Pe,null)})}else{Ae(J.subgraphId);const Ue=be.get(J.subgraphId);if(Ue){const Fe=ra(J.nodeId,Ue.nodes??[],Ue.groups??[]);ie(Fe,J.subgraphId)}const Je=Y.extra?.[qr],Pe=Je&&typeof Je=="object"?Je[J.subgraphId]:void 0;typeof Pe=="number"&&ie(Pe,null),Ue&&q.forEach(Fe=>{const at=ra(Fe,Ue.nodes??[],Ue.groups??[]);ie(at,J.subgraphId)});const st=[J.subgraphId],$e=new Set;for(;st.length>0;){const Fe=st.pop();if(!Fe||$e.has(Fe))continue;$e.add(Fe);const at=ke.get(Fe)??[];for(const ht of at){Ae(ht.parentId);const Lt=be.get(ht.parentId);if(Lt){const Gt=ra(ht.nodeId,Lt.nodes??[],Lt.groups??[]);ie(Gt,ht.parentId)}$e.has(ht.parentId)||st.push(ht.parentId)}}}return{hiddenItems:Se,collapsedItems:F}})},k=(H,Y,D,K)=>{const{workflow:X,embedWorkflow:W,pointerByStableKey:Oe}=o();if(!X)return;const be=$n(X,H);if(!be)return;const ke=be.nodeId,J=X.nodes.map(B=>B.id===ke?Pw(B,Y,D,K):B),xe=J.find(B=>B.id===ke),I=W&&xe?Xi(W,xe):W;n({workflow:{...X,nodes:J},embedWorkflow:I}),dn.getState().clearNodeError(ke)},N=(H,Y)=>{const{workflow:D,embedWorkflow:K,pointerByStableKey:X}=o();if(!D)return;const W=$n(D,H);if(!W)return;const Oe=W.nodeId,be=D.nodes.map(xe=>xe.id===Oe?Yw(xe,Y):xe),ke=be.find(xe=>xe.id===Oe),J=K&&ke?Xi(K,ke):K;n({workflow:{...D,nodes:be},embedWorkflow:J}),dn.getState().clearNodeError(Oe)},S=(H,Y)=>{const{workflow:D,pointerByStableKey:K}=o();if(!D)return;const X=$n(D,H);if(!X)return;const W=X.nodeId,Oe=Y?.trim()??"",be=D.nodes.map(ke=>{if(ke.id!==W)return ke;const J={...ke.properties??{}},xe={...ke,properties:J};return Oe?(xe.title=Oe,J.title=Oe):(delete xe.title,delete J.title),xe});n({workflow:{...D,nodes:be}})},j=H=>{const{workflow:Y,pointerByStableKey:D}=o();if(!Y)return;const K=$n(Y,H);if(!K)return;const X=K.nodeId,W=Y.nodes.map(Oe=>{if(Oe.id===X){const ke=(Oe.mode||0)===4?0:4;return{...Oe,mode:ke}}return Oe});n({workflow:{...Y,nodes:W}})},C=(H,Y)=>{const{hiddenItems:D,workflow:K,pointerByStableKey:X}=o();if(!K)return;const W=$n(K,H);if(!W)return;const Oe=W.nodeId;if(D[H]&&o().setItemHidden(H,!1),document.body.dataset.textareaFocus==="true")return;o().setItemCollapsed(H,!1);const ke=(J,xe)=>{const I=document.getElementById(`node-anchor-${Oe}`)??document.getElementById(`node-${Oe}`),B=document.getElementById(`node-card-${Oe}`)??document.getElementById(`node-${Oe}`);if(!I||!B){J>0?requestAnimationFrame(()=>ke(J-1,xe)):xe>0&&setTimeout(()=>ke(10,xe-1),200);return}const q=I.closest('[data-node-list="true"]');if(q){const Ae=I.getBoundingClientRect(),Ue=q.getBoundingClientRect(),Je=Ae.top-Ue.top,Pe=Math.max(0,q.scrollTop+Je);q.scrollTo({top:Pe,behavior:"smooth"})}else I.scrollIntoView({behavior:"smooth",block:"start"});const he=q||window;let me=null;const Se=()=>{document.querySelectorAll(".highlight-pulse").forEach(Ae=>Ae.classList.remove("highlight-pulse")),B.classList.add("highlight-pulse"),setTimeout(()=>B.classList.remove("highlight-pulse"),1200),"vibrate"in navigator&&navigator.vibrate(10),Y&&window.dispatchEvent(new CustomEvent("node-show-label",{detail:{nodeId:Oe,label:Y}}))},F=()=>{me&&clearTimeout(me),me=setTimeout(()=>{ie(),Se()},120)},ie=()=>{me&&(clearTimeout(me),me=null),he.removeEventListener("scroll",F)};he.addEventListener("scroll",F,{passive:!0}),me=setTimeout(()=>{ie(),Se()},200)};ke(10,2)},T=(H,Y,D,K)=>{n(X=>{const W=Date.now(),Oe=H&&Y&&X.workflow?(()=>{const q=$n(X.workflow,Y,X.pointerByStableKey);return q?String(q.nodeId):null})():null,be=H?D??X.executingPromptId:null,ke=H?Oe??X.executingNodeId:null,J={isExecuting:H,executingNodeId:ke,executingPromptId:be,progress:K},xe=(q,he)=>{if(!q||he<=0||X.workflow?.nodes.find(Ue=>String(Ue.id)===q)?.mode===4)return X.nodeDurationStats;const Se=String(q),F=X.nodeDurationStats[Se],ie=(F?.count??0)+1,Ae=F?(F.avgMs*F.count+he)/ie:he;return{...X.nodeDurationStats,[Se]:{avgMs:Ae,count:ie}}};if(!H){if(X.currentNodeStartTime&&X.executingNodeId){const q=W-X.currentNodeStartTime;J.nodeDurationStats=xe(X.executingNodeId,q)}if(X.executionStartTime&&X.workflow){const q=W-X.executionStartTime,he=bu(X.workflow),me=X.workflowDurationStats[he],Se=(me?.count??0)+1,F=me?(me.avgMs*me.count+q)/Se:q;J.workflowDurationStats={...X.workflowDurationStats,[he]:{avgMs:F,count:Se}}}return J.executionStartTime=null,J.currentNodeStartTime=null,J}const I=be&&be!==X.executingPromptId,B=ke&&ke!==X.executingNodeId;if(I&&(J.executionStartTime=W,J.currentNodeStartTime=W),B&&X.currentNodeStartTime&&X.executingNodeId){const q=W-X.currentNodeStartTime;J.nodeDurationStats=xe(X.executingNodeId,q),J.currentNodeStartTime=W}else X.currentNodeStartTime||(J.currentNodeStartTime=W);return J})},V=H=>{n(Y=>{const D=A0(H),K=Lo(D,Y.stableKeyByPointer,Y.pointerByStableKey);return{workflow:Y.workflow?jo(Y.workflow,K.layoutToStable):Y.workflow,mobileLayout:D,stableKeyByPointer:K.layoutToStable,pointerByStableKey:K.stableToLayout}})},U=(H,Y,D)=>{const{currentFilename:K,savedWorkflowStates:X,nodeTypes:W}=o(),Oe=D?.fresh??!1,be=D?.source??{type:"other"};dn.getState().clearNodeErrors();const ke=gw(H),J=R0(H),xe=Ef(ke.nodes),I={...ke,nodes:xe,links:ke.links??[],groups:ke.groups??[],config:ke.config??{},last_node_id:ke.last_node_id??Math.max(0,...xe.map(ie=>ie.id)),last_link_id:ke.last_link_id??0,version:ke.version??.4},B=Xd(I,W),q=ho.getState(),he=Y?q.pinnedWidgets[Y]:void 0;if(he&&!q.pinnedWidgets[B]&&q.setPinnedWidget(he,B),q.restorePinnedWidgetForWorkflow(B,I),K&&o().saveCurrentWorkflowState(),Oe&&X[B]){const ie={...X};delete ie[B],n({savedWorkflowStates:ie})}const me={};if(W)for(const ie of I.nodes)rl(I,W,ie)!==null&&(me[ie.id]=nf(I,W,ie));let Se=Oe?null:X[B];!Se&&!Oe&&Y&&X[Y]&&(Se=X[Y],n({savedWorkflowStates:{...X,[B]:X[Y]}}));let F=I;if(Se){const ie=I.nodes.map(He=>{const Ve=Se.nodes[He.id];return Ve?{...He,mode:Ve.mode??He.mode,flags:Ve.flags??He.flags,widgets_values:Ve.widgets_values??He.widgets_values}:He}),Ae={...I,nodes:ie},Ue=Jd(Ae,o().hiddenItems),Je={...Se.collapsedItems??{}},Pe={...Se.hiddenItems??{}},st=fs(Ae,Ue),$e=Lo(st,o().stableKeyByPointer,o().pointerByStableKey),Fe=ef(Ue,$e.layoutToStable),at=Uw(Je,$e.layoutToStable),ht=ef(Pe,$e.layoutToStable),Lt=tf({...Je,...at},$e.layoutToStable,$e.stableToLayout),Gt=Yi({...Pe,...ht},$e.layoutToStable,$e.stableToLayout),Pt={},$t=jo(Ae,$e.layoutToStable);F=$t;let Ge=J;if(Ge)for(const He of $t.nodes)Ge=Xi(Ge,He);n({workflowSource:be,workflow:$t,embedWorkflow:Ge,originalWorkflow:JSON.parse(JSON.stringify($t)),currentFilename:Y||null,currentWorkflowKey:B,collapsedItems:{...Pt,...Lt},hiddenItems:{...Gt,...Fe},mobileLayout:st,stableKeyByPointer:$e.layoutToStable,pointerByStableKey:$e.stableToLayout,runCount:1,followQueue:!1,workflowLoadedAt:Date.now()}),Wn.getState().setSeedModes({...me,...Se.seedModes}),Wn.getState().setSeedLastValues({}),no.getState().setCurrentPanel("workflow"),Mo.getState().setViewerState({viewerOpen:!1,viewerImages:[],viewerIndex:0,viewerScale:1,viewerTranslate:{x:0,y:0}})}else{const ie=o(),Ae=ie.currentWorkflowKey===B,Ue=Jd(I,o().hiddenItems),Je=fs(I,Ue),Pe=Lo(Je,o().stableKeyByPointer,o().pointerByStableKey),st=jo(I,Pe.layoutToStable),$e=ef(Ue,Pe.layoutToStable),Fe={},at=Ae?tf(ie.collapsedItems,Pe.layoutToStable,Pe.stableToLayout):{};dn.getState().setError(null),n({workflowSource:be,workflow:st,embedWorkflow:J,originalWorkflow:JSON.parse(JSON.stringify(st)),currentFilename:Y||null,currentWorkflowKey:B,collapsedItems:{...Fe,...at},mobileLayout:Je,stableKeyByPointer:Pe.layoutToStable,pointerByStableKey:Pe.stableToLayout,hiddenItems:$e,runCount:1,followQueue:!1,workflowLoadedAt:Date.now()}),Wn.getState().setSeedModes(me),Wn.getState().setSeedLastValues({}),no.getState().setCurrentPanel("workflow"),Mo.getState().setViewerState({viewerOpen:!1,viewerImages:[],viewerIndex:0,viewerScale:1,viewerTranslate:{x:0,y:0}})}if(W){const ie=Qw(F,W),Ae=Object.values(ie).reduce((Ue,Je)=>Ue+Je.length,0);Ae>0?(s(ie),dn.getState().setError(`Workflow load error: ${Ae} input${Ae===1?"":"s"} reference missing options.`)):dn.getState().clearNodeErrors()}},R=()=>{const{currentWorkflowKey:H,savedWorkflowStates:Y}=o();if(H){const D={...Y};delete D[H],n({savedWorkflowStates:D})}dn.getState().clearNodeErrors(),n({workflowSource:null,workflow:null,embedWorkflow:null,originalWorkflow:null,currentFilename:null,currentWorkflowKey:null,collapsedItems:{},hiddenItems:{},mobileLayout:iu(),stableKeyByPointer:{},pointerByStableKey:{},runCount:1,nodeOutputs:{},promptOutputs:{},followQueue:!1,workflowLoadedAt:Date.now(),connectionHighlightModes:{}}),Wn.getState().clearSeedState(),ho.getState().clearCurrentPin(),no.getState().setCurrentPanel("workflow"),Mo.getState().setViewerState({viewerOpen:!1,viewerImages:[],viewerIndex:0,viewerScale:1,viewerTranslate:{x:0,y:0}})},z=(H,Y)=>{dn.getState().setError(null);const D=Xd(H,o().nodeTypes),K=fs(H,Qi(o().hiddenItems,o().pointerByStableKey)),X=Lo(K,o().stableKeyByPointer,o().pointerByStableKey),W=jo(H,X.layoutToStable);n({workflow:W,embedWorkflow:R0(W),originalWorkflow:JSON.parse(JSON.stringify(W)),currentFilename:Y,currentWorkflowKey:D,mobileLayout:K,stableKeyByPointer:X.layoutToStable,pointerByStableKey:X.stableToLayout})},L=H=>{n({nodeTypes:H});const{workflow:Y,currentWorkflowKey:D,currentFilename:K,savedWorkflowStates:X}=o();if(!Y)return;const W=Xd(Y,H);if(D===W)return;const Oe={...X};D&&Oe[D]&&!Oe[W]?(Oe[W]=Oe[D],delete Oe[D]):!D&&K&&Oe[K]&&!Oe[W]&&(Oe[W]=Oe[K]);const be=ho.getState(),ke=K?be.pinnedWidgets[K]:void 0,J=D?be.pinnedWidgets[D]:void 0;ke&&!be.pinnedWidgets[W]?be.setPinnedWidget(ke,W):J&&!be.pinnedWidgets[W]&&be.setPinnedWidget(J,W),n({currentWorkflowKey:W,savedWorkflowStates:Oe}),be.restorePinnedWidgetForWorkflow(W,Y)},$=()=>{const{workflow:H,currentWorkflowKey:Y,savedWorkflowStates:D,collapsedItems:K,hiddenItems:X}=o(),W=Wn.getState().seedModes;if(!H||!Y)return;const Oe=D[Y]?.bookmarkedItems??[],be={};for(const ke of H.nodes)be[ke.id]={mode:ke.mode,flags:ke.flags?{collapsed:!!ke.flags.collapsed}:void 0,widgets_values:ke.widgets_values};n({savedWorkflowStates:{...D,[Y]:{nodes:be,seedModes:{...W},collapsedItems:{...K},hiddenItems:{...X},bookmarkedItems:[...Oe]}}})},Q=()=>{n({nodeOutputs:{}})},ue=(H,Y)=>{!H||Y.length===0||n(D=>({promptOutputs:{...D.promptOutputs,[H]:[...D.promptOutputs[H]??[],...Y]}}))},fe=H=>{if(!H){n({promptOutputs:{}});return}n(Y=>{if(!Y.promptOutputs[H])return Y;const D={...Y.promptOutputs};return delete D[H],{promptOutputs:D}})},de=H=>{n({runCount:Math.max(1,Math.floor(H))})},Ie=H=>{n({followQueue:H})},je=()=>{n(H=>({connectionButtonsVisible:!H.connectionButtonsVisible}))},Me=()=>{n({hiddenItems:{}})},_=(H,Y)=>{n(D=>{const K={...D.collapsedItems};return Y?K[H]=!0:delete K[H],{collapsedItems:K}})},oe=(H,Y)=>{const{workflow:D,pointerByStableKey:K}=o();if(!D)return;const X=Gi(D,H);if(!X)return;if(X.type==="group"){const ke=If(D,X.groupId,X.subgraphId);if(ke.size===0)return;const J=Y?4:0,xe=(D.nodes??[]).map(I=>ke.has(I.id)?{...I,mode:J}:I);n({workflow:{...D,nodes:xe}});return}if(X.type!=="subgraph")return;const W=H0(D,X.subgraphId);if(W.size===0)return;const Oe=Y?4:0,be=(D.nodes??[]).map(ke=>W.has(ke.id)?{...ke,mode:Oe}:ke);n({workflow:{...D,nodes:be}})},ce=(H,Y)=>{const{workflow:D,stableKeyByPointer:K,pointerByStableKey:X}=o();if(!D)return;const W=Gi(D,H);if(!W)return;if(W.type==="group"){const{hiddenItems:He,connectionHighlightModes:Ve,mobileLayout:et,collapsedItems:ft}=o(),St=W.groupId,zt=W.subgraphId??null,le=Wi(et,St,zt),se=new Set(le);se.add(W.stableKey);const De=se.size>0?[...se]:[W.stableKey],Qe=Y?.deleteNodes??!1?If(D,St,zt):new Set;let rt=D;if(zt){const jt=(D.definitions?.subgraphs??[]).map(pt=>pt.id!==zt?pt:{...pt,groups:(pt.groups??[]).filter(At=>At.id!==St)});rt={...D,definitions:{...D.definitions??{},subgraphs:jt}}}else{let ct=D.extra;const jt=D.extra?.[qr];if(jt&&typeof jt=="object"){let pt=!1;const At={};for(const[tn,In]of Object.entries(jt))In===St?(At[tn]=null,pt=!0):At[tn]=In;pt&&(ct={...D.extra??{},[qr]:At})}rt={...D,groups:(D.groups??[]).filter(pt=>pt.id!==St),extra:ct}}Qe.size>0&&(rt=V0(rt,Qe));const Re={...He},gt={...Ve};for(const ct of Qe){for(const jt of ps(D,K,ct))delete Re[jt];for(const jt of ua(D,ct))delete Re[jt];delete gt[ct]}let bt=et;for(const ct of Qe)bt=T0(bt,ct);for(const ct of De)bt=Tw(bt,ct);const it={...ft};for(const ct of De)delete it[ct],delete Re[ct];const xt=Lo(bt,K,X),Nt=jo(rt,xt.layoutToStable);n({workflow:Nt,hiddenItems:Re,connectionHighlightModes:gt,mobileLayout:bt,stableKeyByPointer:xt.layoutToStable,pointerByStableKey:xt.stableToLayout,collapsedItems:it});return}if(W.type!=="subgraph")return;const{hiddenItems:Oe,connectionHighlightModes:be,mobileLayout:ke,collapsedItems:J}=o(),xe=Y?.deleteNodes??!1,I=W.subgraphId,B=D.definitions?.subgraphs??[],q=B.find(He=>He.id===I);if(!q)return;const me=sb(ke,{type:"subgraph",id:I}),Se=me?Ww(me.containerId,ke):null;if(xe){const He=ib(D),Ve=yu([I],He),et=H0(D,I),ft={...Oe},St={...be};for(const it of et){for(const xt of ps(D,K,it))delete ft[xt];for(const xt of ua(D,it))delete ft[xt];delete St[it]}const zt=B.filter(it=>!Ve.has(it.id));let le=D.extra;const se=D.extra?.[qr];if(se&&typeof se=="object"){const it={};for(const[xt,Nt]of Object.entries(se))Ve.has(xt)||(it[xt]=Nt);le={...D.extra??{},[qr]:it}}let De=V0(D,et);De={...De,definitions:{...De.definitions??{},subgraphs:zt},extra:le};const Ze=fs(De,Qi(ft,X)),Qe=Lo(Ze,K,X),rt=jo(De,Qe.layoutToStable),Re={...J},gt={...ft},bt=new Set(B.filter(it=>Ve.has(it.id)).map(it=>it.stableKey).filter(it=>typeof it=="string"));for(const it of bt)delete Re[it],delete gt[it];n({workflow:rt,hiddenItems:gt,connectionHighlightModes:St,mobileLayout:Ze,stableKeyByPointer:Qe.layoutToStable,pointerByStableKey:Qe.stableToLayout,collapsedItems:Re});return}const F=Se==null?D.groups??[]:B.find(He=>He.id===Se)?.groups??[],{idMap:ie,promotedGroups:Ae}=Gw(q.groups??[],F),Ue=(D.nodes??[]).map(He=>{const Ve=po(He);if(Ve?.scope!=="subgraph"||Ve.subgraphId!==I)return He;const et={...He.properties??{}};return et[Tf]=Se==null?{scope:"root",nodeId:Ve.nodeId}:{scope:"subgraph",subgraphId:Se,nodeId:Ve.nodeId},{...He,properties:et}}),Je=B.filter(He=>He.id!==I).map(He=>Se!=null&&He.id===Se?{...He,groups:[...He.groups??[],...Ae]}:He);let Pe=D.groups??[];Se==null&&Ae.length>0&&(Pe=[...Pe,...Ae]);let st=D.extra;const $e=D.extra?.[qr];if($e&&typeof $e=="object"){const He={};for(const[Ve,et]of Object.entries($e))Ve!==I&&(He[Ve]=et);st={...D.extra??{},[qr]:He}}const Fe={...D,nodes:Ue,groups:Pe,definitions:{...D.definitions??{},subgraphs:Je},extra:st},at=fs(Fe,Qi(Oe,X)),ht=Lo(at,K,X),Lt={...J},Gt={...Oe},Pt=q.stableKey??Pi(D,I);Pt&&(delete Lt[Pt],delete Gt[Pt]);const $t=He=>{const Ve={};for(const[et,ft]of Object.entries(He)){if(!ft)continue;const St=Gi(D,et);if(St?.type==="group"&&St.subgraphId===I){const zt=ie.get(St.groupId);if(zt==null)continue;const le=Wi(at,zt,Se);for(const se of le)Ve[se]=!0;continue}Ve[et]=!0}return Ve},Ge=jo(Fe,ht.layoutToStable);n(()=>({workflow:Ge,mobileLayout:at,stableKeyByPointer:ht.layoutToStable,pointerByStableKey:ht.stableToLayout,collapsedItems:$t(Lt),hiddenItems:Gt}))},Ke=(H,Y)=>{const{workflow:D,pointerByStableKey:K}=o();if(!D)return;const X=Gi(D,H);if(!X)return;const W=Y.trim();if(X.type==="group"){const{groupId:Oe,subgraphId:be}=X;if(be){const xe=(D.definitions?.subgraphs??[]).map(I=>{if(I.id!==be)return I;const q=(I.groups??[]).map(he=>he.id===Oe?{...he,title:W}:he);return{...I,groups:q}});dn.getState().setError(null),n({workflow:{...D,definitions:{...D.definitions??{},subgraphs:xe}}});return}const ke=(D.groups??[]).map(J=>J.id===Oe?{...J,title:W}:J);n({workflow:{...D,groups:ke}});return}if(X.type==="subgraph"){const Oe=X.subgraphId,ke=(D.definitions?.subgraphs??[]).map(J=>J.id===Oe?{...J,name:W}:J);n({workflow:{...D,definitions:{...D.definitions??{},subgraphs:ke}}})}},Le=H=>{n({searchQuery:H})},E=H=>{n({searchOpen:H})},A=H=>{n({addNodeModalRequest:{id:++Rw,groupId:H?.groupId??null,subgraphId:H?.subgraphId??null}})},M=()=>{n({addNodeModalRequest:null})},ee=H=>{n(Y=>{const D=qw(Y.mobileLayout,H);if(!D)return{};const K={...Y.collapsedItems};for(const X of D.groupKeys)delete K[X];for(const X of D.subgraphIds){const W=Y.workflow?Pi(Y.workflow,X):null;W&&delete K[W]}if(H.type==="group")for(const X of Wi(Y.mobileLayout,H.id,H.subgraphId??null))K[X]=!0;else if(H.type==="subgraph"){const X=Y.workflow?Pi(Y.workflow,H.id):null;X&&(K[X]=!0)}return{collapsedItems:K}})},Te=(H,Y)=>{!H||Y<=0||n(D=>{const K=D.workflowDurationStats[H],X=(K?.count??0)+1,W=K?(K.avgMs*K.count+Y)/X:Y;return{workflowDurationStats:{...D.workflowDurationStats,[H]:{avgMs:W,count:X}}}})},qe=()=>{const{currentWorkflowKey:H,savedWorkflowStates:Y,originalWorkflow:D,nodeTypes:K}=o(),X={...Y};if(H?(delete X[H],ho.getState().clearPinnedWidgetForKey(H)):ho.getState().clearCurrentPin(),!D){Wn.getState().setSeedModes({}),Wn.getState().setSeedLastValues({}),n({savedWorkflowStates:X});return}const W={};if(K)for(const be of D.nodes)rl(D,K,be)!==null&&(W[be.id]=nf(D,K,be));const Oe=JSON.parse(JSON.stringify(D));Wn.getState().setSeedModes(W),Wn.getState().setSeedLastValues({}),dn.getState().setError(null),n({savedWorkflowStates:X,...(()=>{const be=fs(Oe,Qi(o().hiddenItems,o().pointerByStableKey)),ke=Lo(be,{},{});return{workflow:jo(Oe,ke.layoutToStable),mobileLayout:be,stableKeyByPointer:ke.layoutToStable,pointerByStableKey:ke.stableToLayout}})(),runCount:1,workflowLoadedAt:Date.now()})},ye=()=>{const{workflow:H}=o();if(!H)return;let Y=!1;const D=H.nodes.map(K=>{if(K.type==="PrimitiveNode"){if(!Array.isArray(K.widgets_values))return K;const X=K.outputs?.[0]?.type,W=String(X).toUpperCase();if(W!=="INT"&&W!=="FLOAT")return K;const Oe=K.widgets_values?.[1];if(!Oe||Oe==="fixed")return K;const be=K.widgets_values?.[0];if(typeof be!="number")return K;let ke=be;if(Oe==="increment"?ke=W==="INT"?be+1:be+.01:Oe==="decrement"?ke=W==="INT"?be-1:be-.01:Oe==="randomize"&&(ke=W==="INT"?Math.floor(Math.random()*0xffffffffffff):Math.random()),ke!==be){Y=!0;const J=[...K.widgets_values];return J[0]=ke,{...K,widgets_values:J}}}return K});Y&&n({workflow:{...H,nodes:D}})},Ne=async H=>{const Y=Wn.getState(),D=Y.seedModes,K=Y.seedLastValues,{workflow:X,nodeTypes:W,embedWorkflow:Oe}=o();if(!X||!W){dn.getState().setError("Node types are still loading. Try again in a moment.");return}dn.getState().setError(null),n({isLoading:!0});try{let be=X,ke=Oe,J={...K};for(let xe=0;xe<H;xe++){const I={},B=be.nodes.map(F=>{const ie=rl(be,W,F);if(ie===null||!Array.isArray(F.widgets_values))return F;const Ae=D[F.id]??nf(be,W,F),Ue=ie+1;if(typeof F.widgets_values[Ue]=="string"){if(!Ae||Ae==="fixed")return F;const at=Number(F.widgets_values[ie])||0;let ht;switch(Ae){case"randomize":ht=fa(W,F);break;case"increment":ht=at+1;break;case"decrement":ht=at-1;break;default:return F}const Lt=[...F.widgets_values];return Lt[ie]=ht,{...F,widgets_values:Lt}}const st=Number(F.widgets_values[ie]),$e=J[F.id]??null;let Fe=null;return sp(st)?Fe=uw(st,$e,W,F):Ae&&Ae!=="fixed"&&(Ae==="randomize"?Fe=fa(W,F):Ae==="increment"?Fe=(typeof $e=="number"?$e:st)+1:Ae==="decrement"&&(Fe=(typeof $e=="number"?$e:st)-1)),Fe===null||(I[F.id]=Fe,J={...J,[F.id]:Fe}),F});if(be={...be,nodes:B},ke){let F=ke;for(const ie of B)F=Xi(F,ie);ke=F}Y.setSeedLastValues(J),n({workflow:be,embedWorkflow:ke});const q={},he=new Set,me=new Map;for(const F of be.nodes){if(F.mode===4)continue;let ie=null;if(W[F.type])ie=F.type;else{const Ae=Object.entries(W).find(([,Ue])=>Ue.display_name===F.type||Ue.name===F.type);Ae&&(ie=Ae[0])}ie&&(he.add(F.id),me.set(F.id,ie))}for(const F of be.nodes){if(F.mode===4)continue;const ie=me.get(F.id);if(!ie)continue;const Ae=$1(be,W,F,ie,he,Jf(be,F.id),I);q[String(F.id)]={class_type:ie,inputs:Ae}}const Se=await fetch(`${ln}/api/prompt`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:q,client_id:Zy,extra_data:{extra_pnginfo:{workflow:gu(ke??be)}}})});if(!Se.ok){const F=await Se.json(),ie={};if(F.node_errors)for(const[Ae,Ue]of Object.entries(F.node_errors)){const Je=Ue.errors;Je&&Je.length>0&&(ie[Ae]=Je.map(Pe=>({type:Pe.type,message:Pe.message,details:Pe.details,inputName:Pe.extra_info?.input_name})))}throw Object.keys(ie).length>0&&s(ie),new Error(F.error?.message||"Failed to queue prompt")}dn.getState().clearNodeErrors()}}catch(be){dn.getState().setError(be instanceof Error?be.message:"Failed to queue workflow")}finally{It.getState().fetchQueue(),n({isLoading:!1})}};return{workflowSource:null,workflow:null,embedWorkflow:null,originalWorkflow:null,currentFilename:null,currentWorkflowKey:null,nodeTypes:null,isLoading:!1,savedWorkflowStates:{},isExecuting:!1,executingNodeId:null,executingPromptId:null,progress:0,executionStartTime:null,currentNodeStartTime:null,nodeDurationStats:{},workflowDurationStats:{},nodeOutputs:{},promptOutputs:{},runCount:1,followQueue:!1,workflowLoadedAt:0,connectionHighlightModes:{},connectionButtonsVisible:!0,searchQuery:"",searchOpen:!1,addNodeModalRequest:null,collapsedItems:{},hiddenItems:{},stableKeyByPointer:{},pointerByStableKey:{},mobileLayout:iu(),setMobileLayout:V,addNode:f,addNodeAndConnect:m,deleteNode:l,deleteContainer:ce,connectNodes:i,disconnectInput:c,setNodeOutput:p,clearNodeOutputs:Q,requestAddNodeModal:A,clearAddNodeModalRequest:M,toggleBypass:j,bypassAllInContainer:oe,updateNodeWidget:k,updateNodeWidgets:N,updateNodeTitle:S,updateContainerTitle:Ke,setExecutionState:T,addPromptOutputs:ue,clearPromptOutputs:fe,queueWorkflow:Ne,applyControlAfterGenerate:ye,setRunCount:de,setFollowQueue:Ie,cycleConnectionHighlight:g,setConnectionHighlightMode:b,toggleConnectionButtonsVisible:je,setSearchQuery:Le,setSearchOpen:E,prepareRepositionScrollTarget:ee,scrollToNode:C,setItemHidden:x,revealNodeWithParents:w,showAllHiddenNodes:Me,setItemCollapsed:_,setNodeTypes:L,loadWorkflow:U,unloadWorkflow:R,setSavedWorkflow:z,clearWorkflowCache:qe,updateWorkflowDuration:Te,saveCurrentWorkflowState:$}},{name:"workflow-storage",storage:br(()=>localStorage),partialize:n=>({workflow:n.workflow,embedWorkflow:n.embedWorkflow,originalWorkflow:n.originalWorkflow,currentFilename:n.currentFilename,currentWorkflowKey:n.currentWorkflowKey,savedWorkflowStates:n.savedWorkflowStates,runCount:n.runCount,hiddenItems:n.hiddenItems,collapsedItems:n.collapsedItems,stableKeyByPointer:n.stableKeyByPointer,pointerByStableKey:n.pointerByStableKey,connectionButtonsVisible:n.connectionButtonsVisible,mobileLayout:n.mobileLayout,isExecuting:n.isExecuting,executingNodeId:n.executingNodeId,executingPromptId:n.executingPromptId,progress:n.progress,executionStartTime:n.executionStartTime,currentNodeStartTime:n.currentNodeStartTime,nodeDurationStats:n.nodeDurationStats,workflowDurationStats:n.workflowDurationStats}),onRehydrateStorage:()=>n=>{if(n)if(n.workflow){const o=n.mobileLayout?A0(n.mobileLayout):null,s=Jd(n.workflow,n.hiddenItems??{});n.mobileLayout=o&&Bw(o,n.workflow)?o:fs(n.workflow,s);const l=Lo(n.mobileLayout,n.stableKeyByPointer??{},n.pointerByStableKey??{});n.workflow=jo(n.workflow,l.layoutToStable),n.originalWorkflow&&(n.originalWorkflow=jo(n.originalWorkflow,l.layoutToStable)),n.stableKeyByPointer=l.layoutToStable,n.pointerByStableKey=l.stableToLayout,n.hiddenItems=Yi(n.hiddenItems,l.layoutToStable,l.stableToLayout),n.collapsedItems=tf(n.collapsedItems,l.layoutToStable,l.stableToLayout),n.hiddenItems=Yi(n.hiddenItems,l.layoutToStable,l.stableToLayout),n.hiddenItems=Yi(n.hiddenItems,l.layoutToStable,l.stableToLayout)}else n.mobileLayout=iu(),n.stableKeyByPointer={},n.pointerByStableKey={}}}));function bu(n){const o=[...n.nodes].sort((s,l)=>s.id-l.id).map(s=>({id:s.id,type:s.type,mode:s.mode,inputs:s.inputs?.map(l=>l.link??null)??[],outputs:s.outputs?.map(l=>l.links??[])??[]}));return JSON.stringify({nodes:o,links:n.links??[]})}const Lf=Oo(n=>({appMenuOpen:!1,setAppMenuOpen:o=>n({appMenuOpen:o})})),Pn=Oo((n,o)=>({history:[],isLoading:!1,addHistoryEntry:s=>{n(i=>i.history.some(c=>c.prompt_id===s.prompt_id)?i:{history:[s,...i.history]});const l=It.getState();if(l.queueItemExpanded[s.prompt_id]===void 0&&l.setQueueItemExpanded(s.prompt_id,!0),s.workflow&&s.durationSeconds){const i=bu(s.workflow);ae.getState().updateWorkflowDuration(i,s.durationSeconds*1e3)}},fetchHistory:async()=>{n({isLoading:!0});try{const s=await W1(50),l=Object.entries(s).map(([c,f])=>{const m=[];for(const j of Object.values(f.outputs))j.images&&m.push(...j.images),j.gifs&&m.push(...j.gifs),j.videos&&m.push(...j.videos);let p=Date.now(),g=null,b=null,x=!1;if(f.status?.messages)for(const[j,C]of f.status.messages)j==="execution_start"&&C.timestamp&&(p=C.timestamp,g=C.timestamp),(j==="execution_end"||j==="execution_success")&&C.timestamp&&(b=C.timestamp),j==="execution_error"&&(x=!0);g===null&&p&&(g=p);const w=g!==null&&b!==null&&b>=g?(b-g)/1e3:void 0,k=f.status?.status_str?.toLowerCase()||"",N=!x&&f.status?.completed!==!1&&!k.includes("error"),S=f.prompt?.[3]?.extra_pnginfo?.workflow;return{prompt_id:c,timestamp:p,durationSeconds:w,success:N,outputs:{images:m},prompt:f.prompt[2],workflow:S}});l.sort((c,f)=>f.timestamp-c.timestamp),n({history:l});const i=It.getState();for(const c of l)if(i.queueItemExpanded[c.prompt_id]===void 0&&i.setQueueItemExpanded(c.prompt_id,!0),c.workflow&&c.durationSeconds){const f=bu(c.workflow);ae.getState().updateWorkflowDuration(f,c.durationSeconds*1e3)}}catch(s){console.error("Failed to fetch history:",s)}finally{n({isLoading:!1})}},deleteItem:async s=>{try{await Z1(s),n(l=>({history:l.history.filter(i=>i.prompt_id!==s)}))}catch(l){console.error("Failed to delete history item:",l)}},clearHistory:async()=>{try{await J1()}catch(s){console.error("Failed to clear history:",s);try{const l=o().history.map(i=>i.prompt_id);await S0(l)}catch(l){console.error("Failed to delete history items:",l)}}finally{n({history:[]})}},clearEmptyItems:async()=>{const s=o().history.filter(l=>l.outputs.images.length===0).map(l=>l.prompt_id);if(s.length!==0)try{await S0(s),n(l=>({history:l.history.filter(i=>!s.includes(i.prompt_id))}))}catch(l){console.error("Failed to delete empty history items:",l)}}})),Wt=Oo()(xr((n,o)=>({source:"output",currentFolder:null,folders:[],files:[],isLoading:!1,error:null,viewMode:"grid",showHidden:!1,filter:{search:"",favoritesOnly:!1,type:"all"},sort:{mode:"modified"},favorites:[],selectionMode:!1,selectedIds:[],selectionActionOpen:!1,filterModalOpen:!1,newFolderModalOpen:!1,outputsViewerOpen:!1,setSource:s=>{n({source:s,currentFolder:null,files:[],folders:[],selectionMode:!1,selectedIds:[]}),o().fetchFolders(),o().fetchFiles()},setCurrentFolder:s=>{const{currentFolder:l}=o(),i=l?`${l}/${s}`:s;n({currentFolder:i,files:[],selectionMode:!1,selectedIds:[]}),o().fetchFiles()},navigateToPath:s=>{n({currentFolder:s,files:[],selectionMode:!1,selectedIds:[]}),o().fetchFiles()},navigateUp:()=>{const{currentFolder:s}=o();if(!s)return;const l=s.split("/");l.pop();const i=l.length>0?l.join("/"):null;n({currentFolder:i,files:[],selectionMode:!1,selectedIds:[]}),o().fetchFiles()},fetchFolders:async()=>{try{const{showHidden:s}=o(),l=await tw(s),{source:i}=o();n({folders:i==="output"?l.output:l.input})}catch(s){console.error("Failed to fetch folders:",s)}},fetchFiles:async()=>{const{source:s,currentFolder:l,sort:i,showHidden:c}=o();n({isLoading:!0,error:null});try{const f=await Mf(s,1e3,0,i.mode,!1,l,c);n({files:f,isLoading:!1})}catch(f){n({error:f.message,isLoading:!1})}},setFilter:s=>{n(l=>({filter:{...l.filter,...s}}))},setSort:s=>{n({sort:s}),o().fetchFiles()},setViewMode:s=>{n({viewMode:s})},toggleShowHidden:()=>{n(s=>({showHidden:!s.showHidden})),o().fetchFolders(),o().fetchFiles()},toggleFavorite:s=>{n(l=>({favorites:l.favorites.includes(s)?l.favorites.filter(c=>c!==s):[...l.favorites,s]}))},toggleSelectionMode:()=>{n(s=>({selectionMode:!s.selectionMode,selectedIds:[],selectionActionOpen:!1}))},toggleSelection:s=>{n(l=>({selectedIds:l.selectedIds.includes(s)?l.selectedIds.filter(c=>c!==s):[...l.selectedIds,s]}))},selectAll:()=>{const s=o().getDisplayedFiles();n({selectedIds:s.map(l=>l.id)})},selectIds:(s,l="add")=>{n(i=>{if(l==="replace")return{selectedIds:[...s]};const c=new Set(i.selectedIds);return s.forEach(f=>c.add(f)),{selectedIds:Array.from(c)}})},clearSelection:()=>{n({selectedIds:[],selectionActionOpen:!1})},setSelectionActionOpen:s=>{n({selectionActionOpen:s})},setFilterModalOpen:s=>{n({filterModalOpen:s})},setNewFolderModalOpen:s=>{n({newFolderModalOpen:s})},setOutputsViewerOpen:s=>{n({outputsViewerOpen:s})},addFavorites:s=>{n(l=>{const i=new Set(l.favorites);return s.forEach(c=>i.add(c)),{favorites:Array.from(i)}})},removeFavorites:s=>{n(l=>({favorites:l.favorites.filter(i=>!s.includes(i))}))},refresh:()=>{o().fetchFolders(),o().fetchFiles()},getDisplayedFiles:()=>{const{files:s,filter:l,favorites:i,showHidden:c,sort:f}=o();let m=[...s];if(c||(m=m.filter(g=>!g.name.startsWith("."))),l.search){const g=l.search.toLowerCase();m=m.filter(b=>b.name.toLowerCase().includes(g))}l.favoritesOnly&&(m=m.filter(g=>i.includes(g.id))),l.type!=="all"&&(m=m.filter(g=>g.type==="folder"||g.type===l.type));const p=f.mode.endsWith("-reverse")?-1:1;return f.mode.startsWith("name")?m.sort((g,b)=>g.name.localeCompare(b.name)*p):f.mode.startsWith("size")?m.sort((g,b)=>((g.size??0)-(b.size??0))*p):m.sort((g,b)=>((g.date??0)-(b.date??0))*p),m}}),{name:"outputs-storage",version:1,migrate:(n,o)=>{if(o===0){if(n.sort&&!n.sort.mode){const{field:s,order:l}=n.sort;s==="name"?n.sort={mode:l==="asc"?"name":"name-reverse"}:n.sort={mode:l==="desc"?"modified":"modified-reverse"}}n.filter&&!n.filter.type&&(n.filter.type="all")}return n},partialize:n=>({source:n.source,viewMode:n.viewMode,showHidden:n.showHidden,sort:n.sort,filter:n.filter,favorites:n.favorites})}));var En=Yy();function Xw({open:n,onClose:o,side:s,title:l,children:i}){const c=y.useRef(null);return y.useEffect(()=>{if(!n)return;const f=m=>{m.key==="Escape"&&o()};return document.addEventListener("keydown",f),()=>document.removeEventListener("keydown",f)},[n,o]),y.useEffect(()=>(n?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[n]),n?En.createPortal(u.jsxs("div",{className:"fixed inset-0 z-[2300]",children:[u.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm",onClick:o}),u.jsxs("div",{ref:c,className:`
          absolute top-0 bottom-0 w-[85%] max-w-sm bg-white shadow-xl
          flex flex-col overflow-hidden
          ${s==="left"?"left-0 animate-slide-in-left":"right-0 animate-slide-in-right"}
        `,style:{animation:`${s==="left"?"slideInLeft":"slideInRight"} 0.2s ease-out`},children:[l&&u.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[u.jsx("h2",{className:"text-xl font-bold text-gray-900",children:l}),u.jsx("button",{onClick:o,className:`w-10 h-10 flex items-center justify-center rounded-full
                         text-gray-500 hover:bg-gray-100 text-2xl`,children:""})]}),u.jsx("div",{className:"flex-1 overflow-auto p-4 overscroll-contain scroll-container",children:i})]}),u.jsx("style",{children:`
        @keyframes slideInLeft {
          from { transform: translateX(-100%); }
          to { transform: translateX(0); }
        }
        @keyframes slideInRight {
          from { transform: translateX(100%); }
          to { transform: translateX(0); }
        }
      `})]}),document.body):null}function Zw(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",...n,children:u.jsx("path",{d:"M12 11V16M12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12C21 16.9706 16.9706 21 12 21ZM12.0498 8V8.1L11.9502 8.1002V8H12.0498Z"})})}function ub({className:n}){return u.jsx(Zw,{className:n})}function Jw(n){return u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",...n,children:[u.jsx("path",{d:"M19 4H5L10.5 10.5V17L13.5 19V10.5L19 4Z"}),u.jsx("path",{d:"M2.5 9L4.5 7L6.5 9"}),u.jsx("path",{d:"M4.5 7V17"}),u.jsx("path",{d:"M2.5 15L4.5 17L6.5 15"})]})}function e2(n){return u.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...n,children:[u.jsx("path",{d:"M6 4h9l3 3v13a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2Z",stroke:"currentColor",strokeWidth:"1.5",fill:"none"}),u.jsx("path",{d:"M9 10h6M9 14h6",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]})}function t2(n){return u.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...n,children:[u.jsx("path",{d:"M6 4h9l3 3v13a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2Z",stroke:"currentColor",strokeWidth:"1.5",fill:"none"}),u.jsx("path",{d:"M9 10h6M9 14h6M9 18h4",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]})}function n2(n){return u.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...n,children:u.jsx("path",{d:"M4 20h16M6 16l4-4m0 0l4-4m-4 4l4 4",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none"})})}function o2(n){return u.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...n,children:[u.jsx("path",{d:"M3 7h18v10a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V7Z",stroke:"currentColor",strokeWidth:"1.5",fill:"none"}),u.jsx("path",{d:"M3 7l9 6 9-6",stroke:"currentColor",strokeWidth:"1.5",fill:"none"})]})}function r2(n){return u.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...n,style:{transform:"rotate(90deg)",...n.style??{}},children:[u.jsx("circle",{cx:"12",cy:"5",r:"2",fill:"currentColor"}),u.jsx("circle",{cx:"12",cy:"12",r:"2",fill:"currentColor"}),u.jsx("circle",{cx:"12",cy:"19",r:"2",fill:"currentColor"})]})}function gs(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",...n,children:u.jsx("path",{d:"M10 17l5-5-5-5v10z"})})}function to(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",...n,children:u.jsx("path",{d:"M7 10l5 5 5-5H7z"})})}function xu(n){return u.jsx("svg",{viewBox:"0 0 20 20","aria-hidden":"true",...n,children:u.jsx("g",{transform:"translate(-164 -6319)",fill:"currentColor",children:u.jsx("path",{d:"M170.673,6324.726 L170.669,6324.729 C170.266,6325.104 170.244,6325.735 170.62,6326.137 L171.577,6327.158 C171.876,6327.478 171.649,6328 171.212,6328 L165,6328 C164.447,6328 164,6328.448 164,6329 C164,6329.552 164.447,6330 165,6330 L171.197,6330 C171.637,6330 171.862,6330.527 171.558,6330.845 L170.63,6331.819 C170.248,6332.218 170.266,6332.852 170.669,6333.229 C171.068,6333.603 171.695,6333.584 172.071,6333.186 L174.76,6330.338 C175.49,6329.564 175.487,6328.354 174.753,6327.585 L172.067,6324.769 C171.692,6324.376 171.071,6324.357 170.673,6324.726 M182.222,6319 L175.777,6319 C174.8,6319 174,6319.68 174,6321.111 L174,6322.007 C174,6322.555 174.444,6323 174.993,6323 L175.006,6323 C175.555,6323 176,6322.555 176,6322.007 L176,6321.993 C176,6321.445 176.444,6321 176.993,6321 L181.006,6321 C181.555,6321 182,6321.445 182,6321.993 L182,6336.007 C182,6336.555 181.555,6337 181.006,6337 L176.993,6337 C176.444,6337 176,6336.555 176,6336.007 L176,6335.993 C176,6335.445 175.555,6335 175.006,6335 L174.993,6335 C174.444,6335 174,6335.445 174,6335.993 L174,6337.111 C174,6338.293 174.847,6339 175.777,6339 L182.222,6339 C183.204,6339 184,6338.204 184,6337.222 L184,6337.111 L184,6320.778 C184,6319.796 183.204,6319 182.222,6319"})})})}function cp(n){return u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",...n,children:[u.jsx("path",{d:"M18.4101 3.6512L20.5315 5.77252C21.4101 6.6512 21.4101 8.07582 20.5315 8.9545L9.54019 19.9458C9.17774 20.3082 8.70239 20.536 8.19281 20.5915L4.57509 20.9856C3.78097 21.072 3.11061 20.4017 3.1971 19.6076L3.59111 15.9898C3.64661 15.4803 3.87444 15.0049 4.23689 14.6425L15.2282 3.6512C16.1068 2.77252 17.5315 2.77252 18.4101 3.6512Z",stroke:"currentColor",strokeWidth:"1.5"}),u.jsx("path",{d:"M15.2282 3.6512C16.1068 2.77252 17.5315 2.77252 18.4101 3.6512L20.5315 5.77252C21.4101 6.6512 21.4101 8.07582 20.5315 8.9545L18.7283 10.7576L13.425 5.45432L15.2282 3.6512Z",stroke:"currentColor",strokeWidth:"1.5"})]})}function Na(n){return u.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...n,children:u.jsx("path",{d:"M6 6l12 12M18 6l-12 12",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round"})})}function Do(n){return u.jsx("svg",{viewBox:"0 0 16 16","aria-hidden":"true",...n,children:u.jsx("path",{d:"M6.4 11.2L3.2 8l1.1-1.1 2.1 2.1 5-5L12.5 5l-6.1 6.2Z",fill:"currentColor"})})}function s2(n){return u.jsx("svg",{viewBox:"0 0 16 16","aria-hidden":"true",...n,children:u.jsx("path",{d:"M4.2 4.2l7.6 7.6m0-7.6l-7.6 7.6",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"})})}function l2(n){return u.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...n,children:[u.jsx("path",{d:"M7 18a4 4 0 0 1 0-8 6 6 0 0 1 11.3-2.2A4.5 4.5 0 0 1 18 18H7Z",fill:"none",stroke:"currentColor",strokeWidth:"1.5"}),u.jsx("path",{d:"M12 10v7m0 0l-3-3m3 3l3-3",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]})}function pr(n){return u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2","aria-hidden":"true",...n,children:[u.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),u.jsx("circle",{cx:"12",cy:"12",r:"3"})]})}function Go(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2","aria-hidden":"true",...n,children:u.jsx("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24M1 1l22 22"})})}function Bo(n){return u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2","aria-hidden":"true",...n,children:[u.jsx("path",{d:"M3 6h18M8 6V4h8v2M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),u.jsx("path",{d:"M10 11v6M14 11v6"})]})}function a2(n){return u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2","aria-hidden":"true",...n,children:[u.jsx("circle",{cx:"12",cy:"12",r:"10"}),u.jsx("path",{d:"M15 9l-6 6M9 9l6 6"})]})}function dp(n){return u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2","aria-hidden":"true",...n,children:[u.jsx("path",{d:"M23 4v6h-6M1 20v-6h6"}),u.jsx("path",{d:"M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"})]})}function i2(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2","aria-hidden":"true",...n,children:u.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4M16 17l5-5-5-5M21 12H9"})})}function bs(n){return u.jsx("svg",{viewBox:"0 0 16 16",fill:"none","aria-hidden":"true",...n,children:u.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeWidth:"1.3",d:"M9.18613 3.09999H6.81377M9.18613 12.9H7.55288c-3.08678 0-5.35171-2.99581-4.60305-6.08843l.3054-1.26158M14.7486 2.1721l-.5931 2.45c-.132.54533-.6065.92789-1.1508.92789h-2.2993c-.77173 0-1.33797-.74895-1.1508-1.5221l.5931-2.45c.132-.54533.6065-.9279 1.1508-.9279h2.2993c.7717 0 1.3379.74896 1.1508 1.52211Zm-8.3033 0-.59309 2.45c-.13201.54533-.60646.92789-1.15076.92789H2.4021c-.7717 0-1.33793-.74895-1.15077-1.5221l.59309-2.45c.13201-.54533.60647-.9279 1.15077-.9279h2.29935c.77169 0 1.33792.74896 1.15076 1.52211Zm8.3033 9.8-.5931 2.45c-.132.5453-.6065.9279-1.1508.9279h-2.2993c-.77173 0-1.33797-.749-1.1508-1.5221l.5931-2.45c.132-.5453.6065-.9279 1.1508-.9279h2.2993c.7717 0 1.3379.7489 1.1508 1.5221Z"})})}function cb(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",...n,children:u.jsx("path",{d:"M13 20.74C12.9039 20.7541 12.8062 20.7541 12.71 20.74C12.5724 20.6823 12.4551 20.5849 12.3732 20.4602C12.2912 20.3355 12.2484 20.1892 12.25 20.04V16.7H3.00001C2.81189 16.6956 2.63208 16.6216 2.49538 16.4923C2.35868 16.363 2.27481 16.1876 2.26001 16V8.00002C2.25463 7.89856 2.26965 7.79706 2.30417 7.7015C2.3387 7.60595 2.39204 7.51829 2.46103 7.44371C2.53002 7.36913 2.61326 7.30913 2.70584 7.26727C2.79841 7.22542 2.89844 7.20255 3.00001 7.20002H12.25V4.01002C12.2498 3.86106 12.2946 3.71551 12.3784 3.59241C12.4623 3.4693 12.5813 3.37436 12.72 3.32002C12.8551 3.26039 13.0053 3.24376 13.1502 3.27238C13.2951 3.301 13.4277 3.37349 13.53 3.48002L21.53 11.48C21.6705 11.6206 21.7493 11.8113 21.7493 12.01C21.7493 12.2088 21.6705 12.3994 21.53 12.54L13.53 20.54C13.4601 20.6079 13.377 20.6608 13.2858 20.6952C13.1946 20.7296 13.0973 20.7448 13 20.74ZM3.76001 15.2H13C13.1981 15.2026 13.3874 15.2825 13.5275 15.4226C13.6676 15.5626 13.7474 15.7519 13.75 15.95V18.18L19.93 12L13.75 5.83002V8.00002C13.7477 8.19843 13.6689 8.3883 13.53 8.53002C13.3817 8.65257 13.1919 8.71343 13 8.70002H3.76001V15.2Z",fill:"currentColor"})})}function u2(n){return u.jsxs("svg",{viewBox:"0 0 16 16",fill:"none","aria-hidden":"true",...n,children:[u.jsx("path",{d:"M10.667 2.667c1.45.008 2.235.072 2.748.585C14 3.837 14 4.78 14 6.666v4c0 1.885 0 2.828-.585 3.414-.586.585-1.529.585-3.415.585H6c-1.886 0-2.829 0-3.414-.585C2 13.494 2 12.55 2 10.666v-4c0-1.886 0-2.829.586-3.414.512-.513 1.297-.577 2.747-.585",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round"}),u.jsx("path",{d:"M5.333 2.333c0-.552.448-1 1-1h3.334c.552 0 1 .448 1 1v.667c0 .553-.448 1-1 1H6.333c-.552 0-1-.447-1-1v-.667Z",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round"})]})}function c2(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2","aria-hidden":"true",...n,children:u.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M7 10l5 5 5-5M12 15V3"})})}function d2(n){return u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",...n,children:[u.jsx("rect",{x:"9",y:"9",width:"10",height:"12",rx:"2"}),u.jsx("path",{d:"M5 15V5a2 2 0 0 1 2-2h8"})]})}function f2(n){return u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",...n,children:[u.jsx("circle",{cx:"12",cy:"12",r:"9"}),u.jsx("path",{d:"M7 12h10"})]})}function vu(n){return u.jsx("svg",{viewBox:"0 0 20 20",fill:"none","aria-hidden":"true",...n,children:u.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M6 8l4 4 4-4"})})}function Gr(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"currentColor",strokeWidth:"2","aria-hidden":"true",...n,children:u.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})})}function db({showSlash:n=!1,...o}){return u.jsxs("svg",{viewBox:"0 0 32 32","aria-hidden":"true",overflow:"visible",...o,children:[u.jsx("path",{d:"M28 28H4a2.002 2.002 0 0 1-2-2V21h2v5h24v-5h2v5a2.002 2.002 0 0 1-2 2Z",fill:"currentColor"}),u.jsx("rect",{x:"7",y:"21",width:"18",height:"2",fill:"currentColor"}),u.jsx("rect",{x:"7",y:"16",width:"18",height:"2",fill:"currentColor"}),u.jsx("rect",{x:"7",y:"11",width:"18",height:"2",fill:"currentColor"}),u.jsx("rect",{x:"7",y:"6",width:"18",height:"2",fill:"currentColor"}),u.jsx("path",{d:"M16 -3l5 4H11l5-4Z",fill:"currentColor"}),n&&u.jsx("line",{x1:"2",y1:"30",x2:"28",y2:"4",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round"})]})}const Tt={transparent:"transparent",transparentBlack:"rgba(0, 0, 0, 0)",surface:{white:"#ffffff",darkPanel:"#151a23",gray100:"#f3f4f6",gray200:"#e5e7eb"},text:{primary:"#111827",secondary:"#6b7280",onDark:"#e5e7eb"},border:{gray200:"#e5e7eb",focusBlue:"#3b82f6"},status:{success:"#22c55e",successStrong:"rgba(34,197,94,0.9)",warning:"#facc15",danger:"#f97316"},brand:{blue500:"#3b82f6",subgraphBackground08:"rgba(59, 130, 246, 0.08)",subgraphBackground10:"rgba(59, 130, 246, 0.10)",subgraphBackground14:"rgba(59, 130, 246, 0.14)",subgraphBorder20:"rgba(59, 130, 246, 0.20)",subgraphBorder25:"rgba(59, 130, 246, 0.25)"},workflow:{defaultGroupDot:"#9ca3af",fastGroupBypassColors:{nocolor:"#353535",red:"#553333",brown:"#593930",green:"#335533",blue:"#333355",pale_blue:"#3f5159",cyan:"#335555",purple:"#553355",yellow:"#665533",black:"#000000"}}};function p2({progress:n,radius:o=11,...s}){const l=Math.min(100,Math.max(0,n)),i=2*Math.PI*o,c=i*(1-l/100);return u.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...s,children:u.jsx("circle",{cx:"12",cy:"12",r:o,fill:"none",stroke:Tt.status.successStrong,strokeWidth:"2",strokeLinecap:"round",strokeDasharray:i,strokeDashoffset:c})})}function fp(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","aria-hidden":"true",...n,children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}function zo(n){return u.jsx("svg",{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",...n,children:u.jsx("path",{fillRule:"evenodd",d:"M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z",clipRule:"evenodd"})})}function h2(n){return u.jsx("svg",{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",...n,children:u.jsx("path",{fillRule:"evenodd",d:"M4 10a1 1 0 011-1h10a1 1 0 110 2H5a1 1 0 01-1-1z",clipRule:"evenodd"})})}function fb(n){return u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",...n,children:[u.jsx("circle",{cx:"11",cy:"11",r:"7"}),u.jsx("path",{d:"M20 20l-3.5-3.5"})]})}function m2(n){return u.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...n,children:[u.jsx("rect",{x:"4",y:"4",width:"16",height:"16",rx:"3",stroke:"currentColor",strokeWidth:"1.5",fill:"none"}),u.jsx("circle",{cx:"9",cy:"9",r:"1.5",fill:"currentColor"}),u.jsx("circle",{cx:"15",cy:"15",r:"1.5",fill:"currentColor"}),u.jsx("circle",{cx:"15",cy:"9",r:"1.5",fill:"currentColor"}),u.jsx("circle",{cx:"9",cy:"15",r:"1.5",fill:"currentColor"}),u.jsx("circle",{cx:"12",cy:"12",r:"1.5",fill:"currentColor"})]})}function pb(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","aria-hidden":"true",...n,children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}function hb(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",...n,children:u.jsx("path",{d:"M12 2L1 21h22L12 2zm0 3.5L19.5 19h-15L12 5.5zM11 10v4h2v-4h-2zm0 6v2h2v-2h-2z"})})}function _u(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2","aria-hidden":"true",...n,children:u.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})})}function K0(n){return u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",...n,children:[u.jsx("rect",{x:"3",y:"7",width:"12",height:"10",rx:"2"}),u.jsx("path",{d:"M15 10l5-3v10l-5-3z"})]})}function ya(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",...n,children:u.jsx("path",{d:"M19.1835 7.80516L16.2188 4.83755C14.1921 2.8089 13.1788 1.79457 12.0904 2.03468C11.0021 2.2748 10.5086 3.62155 9.5217 6.31506L8.85373 8.1381C8.59063 8.85617 8.45908 9.2152 8.22239 9.49292C8.11619 9.61754 7.99536 9.72887 7.86251 9.82451C7.56644 10.0377 7.19811 10.1392 6.46145 10.3423C4.80107 10.8 3.97088 11.0289 3.65804 11.5721C3.5228 11.8069 3.45242 12.0735 3.45413 12.3446C3.45809 12.9715 4.06698 13.581 5.28476 14.8L6.69935 16.2163L2.22345 20.6964C1.92552 20.9946 1.92552 21.4782 2.22345 21.7764C2.52138 22.0746 3.00443 22.0746 3.30236 21.7764L7.77841 17.2961L9.24441 18.7635C10.4699 19.9902 11.0827 20.6036 11.7134 20.6045C11.9792 20.6049 12.2404 20.5358 12.4713 20.4041C13.0192 20.0914 13.2493 19.2551 13.7095 17.5825C13.9119 16.8472 14.013 16.4795 14.2254 16.1835C14.3184 16.054 14.4262 15.9358 14.5468 15.8314C14.8221 15.593 15.1788 15.459 15.8922 15.191L17.7362 14.4981C20.4 13.4973 21.7319 12.9969 21.9667 11.9115C22.2014 10.826 21.1954 9.81905 19.1835 7.80516Z"})})}function Af(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",...n,children:u.jsx("path",{d:"M15.9894 4.9502L16.52 4.42014L15.9894 4.9502ZM19.0716 8.03562L18.541 8.56568L19.0716 8.03562ZM8.73837 19.429L8.20777 19.9591L8.73837 19.429ZM4.62169 15.3081L5.15229 14.7781L4.62169 15.3081ZM17.5669 14.9943L17.3032 14.2922L17.5669 14.9943ZM15.6498 15.7146L15.9136 16.4167H15.9136L15.6498 15.7146ZM8.3322 8.38177L7.62798 8.12375L8.3322 8.38177ZM9.02665 6.48636L9.73087 6.74438V6.74438L9.02665 6.48636ZM5.84504 10.6735L6.04438 11.3965L5.84504 10.6735ZM7.30167 10.1351L6.86346 9.52646L6.86346 9.52646L7.30167 10.1351ZM7.67582 9.79038L8.24665 10.2768H8.24665L7.67582 9.79038ZM14.251 16.3805L14.742 16.9475L14.742 16.9475L14.251 16.3805ZM13.3806 18.2012L12.6574 18.0022V18.0022L13.3806 18.2012ZM13.9169 16.7466L13.3075 16.3094L13.3075 16.3094L13.9169 16.7466ZM2.71846 12.7552L1.96848 12.76L1.96848 12.76L2.71846 12.7552ZM2.93045 11.9521L2.28053 11.5778H2.28053L2.93045 11.9521ZM11.3052 21.3431L11.3064 20.5931H11.3064L11.3052 21.3431ZM12.0933 21.1347L11.7215 20.4833L11.7215 20.4833L12.0933 21.1347ZM11.6973 2.03606L11.8588 2.76845L11.6973 2.03606ZM1.4694 21.4699C1.17666 21.763 1.1769 22.2379 1.46994 22.5306C1.76298 22.8233 2.23786 22.8231 2.5306 22.5301L1.4694 21.4699ZM7.18383 17.8721C7.47657 17.5791 7.47633 17.1042 7.18329 16.8114C6.89024 16.5187 6.41537 16.5189 6.12263 16.812L7.18383 17.8721ZM15.4588 5.48026L18.541 8.56568L19.6022 7.50556L16.52 4.42014L15.4588 5.48026ZM9.26897 18.8989L5.15229 14.7781L4.09109 15.8382L8.20777 19.9591L9.26897 18.8989ZM17.3032 14.2922L15.386 15.0125L15.9136 16.4167L17.8307 15.6964L17.3032 14.2922ZM9.03642 8.63979L9.73087 6.74438L8.32243 6.22834L7.62798 8.12375L9.03642 8.63979ZM6.04438 11.3965C6.75583 11.2003 7.29719 11.0625 7.73987 10.7438L6.86346 9.52646C6.69053 9.65097 6.46601 9.72428 5.6457 9.95044L6.04438 11.3965ZM7.62798 8.12375C7.33502 8.92332 7.24338 9.14153 7.10499 9.30391L8.24665 10.2768C8.60041 9.86175 8.7823 9.33337 9.03642 8.63979L7.62798 8.12375ZM7.73987 10.7438C7.92696 10.6091 8.09712 10.4523 8.24665 10.2768L7.10499 9.30391C7.0337 9.38757 6.9526 9.46229 6.86346 9.52646L7.73987 10.7438ZM15.386 15.0125C14.697 15.2714 14.1716 15.4571 13.76 15.8135L14.742 16.9475C14.9028 16.8082 15.1192 16.7152 15.9136 16.4167L15.386 15.0125ZM14.1037 18.4001C14.329 17.5813 14.4021 17.3569 14.5263 17.1838L13.3075 16.3094C12.9902 16.7517 12.8529 17.2919 12.6574 18.0022L14.1037 18.4001ZM13.76 15.8135C13.5903 15.9605 13.4384 16.1269 13.3075 16.3094L14.5263 17.1838C14.5887 17.0968 14.6611 17.0175 14.742 16.9475L13.76 15.8135ZM5.15229 14.7781C4.50615 14.1313 4.06799 13.691 3.78366 13.3338C3.49835 12.9753 3.46889 12.8201 3.46845 12.7505L1.96848 12.76C1.97215 13.3422 2.26127 13.8297 2.61002 14.2679C2.95976 14.7073 3.47115 15.2176 4.09109 15.8382L5.15229 14.7781ZM5.6457 9.95044C4.80048 10.1835 4.10396 10.3743 3.58296 10.5835C3.06341 10.792 2.57116 11.0732 2.28053 11.5778L3.58038 12.3264C3.615 12.2663 3.71693 12.146 4.1418 11.9755C4.56523 11.8055 5.16337 11.6394 6.04438 11.3965L5.6457 9.95044ZM3.46845 12.7505C3.46751 12.6016 3.50616 12.4553 3.58038 12.3264L2.28053 11.5778C2.07354 11.9372 1.96586 12.3452 1.96848 12.76L3.46845 12.7505ZM8.20777 19.9591C8.83164 20.5836 9.34464 21.0987 9.78647 21.4506C10.227 21.8015 10.7179 22.0922 11.3041 22.0931L11.3064 20.5931C11.2369 20.593 11.0814 20.5644 10.721 20.2773C10.3618 19.9912 9.91923 19.5499 9.26897 18.8989L8.20777 19.9591ZM12.6574 18.0022C12.4133 18.8897 12.2462 19.4924 12.0751 19.9188C11.9033 20.3467 11.7821 20.4487 11.7215 20.4833L12.465 21.7861C12.974 21.4956 13.2573 21.0004 13.4671 20.4775C13.6776 19.9532 13.8694 19.2516 14.1037 18.4001L12.6574 18.0022ZM11.3041 22.0931C11.7112 22.0937 12.1114 21.9879 12.465 21.7861L11.7215 20.4833C11.595 20.5555 11.4519 20.5933 11.3064 20.5931L11.3041 22.0931ZM18.541 8.56568C19.6045 9.63022 20.3403 10.3695 20.7917 10.9788C21.2353 11.5774 21.2863 11.8959 21.2321 12.1464L22.6982 12.4634C22.8881 11.5854 22.5382 10.8162 21.9969 10.0857C21.4635 9.36592 20.6305 8.53486 19.6022 7.50556L18.541 8.56568ZM17.8307 15.6964C19.1921 15.1849 20.294 14.773 21.0771 14.3384C21.8718 13.8973 22.5083 13.3416 22.6982 12.4634L21.2321 12.1464C21.178 12.3968 21.0001 12.6655 20.3491 13.0268C19.6865 13.3946 18.7112 13.7632 17.3032 14.2922L17.8307 15.6964ZM16.52 4.42014C15.4841 3.3832 14.6481 2.54353 13.9246 2.00638C13.1908 1.46165 12.4175 1.10912 11.5357 1.30367L11.8588 2.76845C12.1086 2.71335 12.4277 2.7633 13.0304 3.21075C13.6433 3.66579 14.3876 4.40801 15.4588 5.48026L16.52 4.42014ZM9.73087 6.74438C10.2525 5.32075 10.6161 4.33403 10.9812 3.66315C11.3402 3.00338 11.609 2.82357 11.8588 2.76845L11.5357 1.30367C10.654 1.49819 10.1005 2.14332 9.66362 2.94618C9.23278 3.73793 8.82688 4.85154 8.32243 6.22834L9.73087 6.74438ZM2.5306 22.5301L7.18383 17.8721L6.12263 16.812L1.4694 21.4699L2.5306 22.5301Z"})})}function pp(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2","aria-hidden":"true",...n,children:u.jsx("path",{d:"M9 6l6 6-6 6"})})}function g2(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",...n,children:u.jsx("path",{d:"M15 19l-7-7 7-7"})})}function Rf({isBypassed:n,...o}){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2","aria-hidden":"true",...o,children:n?u.jsxs(u.Fragment,{children:[u.jsx("path",{d:"M5 12h14"}),u.jsx("path",{d:"M12 5l7 7-7 7"})]}):u.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})}function mb({nodeId:n,connectionHighlightMode:o,leftLineCount:s,rightLineCount:l,inactiveColor:i=Tt.text.secondary,inputHighlightColor:c=Tt.status.danger,outputHighlightColor:f=Tt.status.danger,offLineColor:m=i,...p}){const g=o==="inputs"||o==="both",b=o==="outputs"||o==="both",x=g?c:m,w=b?f:m;return u.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...p,children:[u.jsxs("defs",{children:[u.jsx("clipPath",{id:`node-rect-left-${n}`,children:u.jsx("rect",{x:"0",y:"0",width:"12",height:"24"})}),u.jsx("clipPath",{id:`node-rect-right-${n}`,children:u.jsx("rect",{x:"12",y:"0",width:"12",height:"24"})})]}),u.jsxs(u.Fragment,{children:[u.jsx("rect",{x:"7",y:"7",width:"10",height:"10",rx:"2",stroke:x,strokeWidth:"1.6",fill:"none",strokeLinejoin:"round",clipPath:`url(#node-rect-left-${n})`}),u.jsx("rect",{x:"7",y:"7",width:"10",height:"10",rx:"2",stroke:w,strokeWidth:"1.6",fill:"none",strokeLinejoin:"round",clipPath:`url(#node-rect-right-${n})`})]}),u.jsxs("g",{style:{color:x},children:[s===1&&u.jsx("line",{x1:"7",y1:"12",x2:"-4.25",y2:"12",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"}),s===2&&u.jsxs(u.Fragment,{children:[u.jsx("line",{x1:"7",y1:"12",x2:"-4.25",y2:"8.625",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"}),u.jsx("line",{x1:"7",y1:"12",x2:"-4.25",y2:"15.375",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"})]}),s>=3&&u.jsxs(u.Fragment,{children:[u.jsx("line",{x1:"7",y1:"12",x2:"-4.25",y2:"12",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"}),u.jsx("line",{x1:"7",y1:"12",x2:"-2.743",y2:"6.375",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"}),u.jsx("line",{x1:"7",y1:"12",x2:"-2.743",y2:"17.625",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"})]})]}),u.jsxs("g",{style:{color:w},children:[l===1&&u.jsx("line",{x1:"17",y1:"12",x2:"28.25",y2:"12",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"}),l===2&&u.jsxs(u.Fragment,{children:[u.jsx("line",{x1:"17",y1:"12",x2:"28.25",y2:"8.625",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"}),u.jsx("line",{x1:"17",y1:"12",x2:"28.25",y2:"15.375",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"})]}),l>=3&&u.jsxs(u.Fragment,{children:[u.jsx("line",{x1:"17",y1:"12",x2:"28.25",y2:"12",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"}),u.jsx("line",{x1:"17",y1:"12",x2:"26.743",y2:"6.375",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"}),u.jsx("line",{x1:"17",y1:"12",x2:"26.743",y2:"17.625",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"})]})]})]})}function y2(n){return u.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...n,children:[u.jsxs("defs",{children:[u.jsx("clipPath",{id:"legend-trace-left",children:u.jsx("rect",{x:"0",y:"0",width:"12",height:"24"})}),u.jsx("clipPath",{id:"legend-trace-right",children:u.jsx("rect",{x:"12",y:"0",width:"12",height:"24"})})]}),u.jsx("rect",{x:"7",y:"7",width:"10",height:"10",rx:"2",stroke:"currentColor",strokeWidth:"1.6",fill:"none",clipPath:"url(#legend-trace-left)",className:"text-gray-400"}),u.jsx("rect",{x:"7",y:"7",width:"10",height:"10",rx:"2",stroke:"currentColor",strokeWidth:"1.6",fill:"none",clipPath:"url(#legend-trace-right)",className:"text-orange-500"}),u.jsx("line",{x1:"7",y1:"12",x2:"-4.25",y2:"12",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round",className:"text-gray-400"}),u.jsx("line",{x1:"17",y1:"12",x2:"28.25",y2:"12",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round",className:"text-orange-500"})]})}function gb(n){return u.jsx("svg",{viewBox:"0 0 16 16",fill:"none","aria-hidden":"true",...n,children:u.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeWidth:"1.3",d:"m14.6685 5.7416.6425-2.57c.2028-.811-.4106-1.5967-1.2466-1.5967H2.5782a1.285 1.285 0 0 0-1.2467.9733l-.6425 2.57c-.2027.8111.4107 1.5968 1.2467 1.5968h11.4861a1.285 1.285 0 0 0 1.2467-.9734Zm0 7.7102.6425-2.5701c.2028-.811-.4106-1.5967-1.2466-1.5967h-5.061a1.285 1.285 0 0 0-1.2467.9734l-.6425 2.5701c-.2028.811.4106 1.5966 1.2466 1.5966h5.061a1.285 1.285 0 0 0 1.2467-.9733Zm-10.2802 0 .6425-2.5701c.2027-.811-.4107-1.5967-1.2467-1.5967H2.5782a1.285 1.285 0 0 0-1.2467.9734L.689 12.8285c-.2027.811.4107 1.5966 1.2467 1.5966h1.206a1.285 1.285 0 0 0 1.2466-.9733Z"})})}function b2(n){return u.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...n,children:u.jsx("path",{d:"M12 3v10m0 0l-4-4m4 4l4-4M5 19h14",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none"})})}function x2(n){return u.jsxs("svg",{viewBox:"0 0 16 16",fill:"none","aria-hidden":"true",...n,children:[u.jsx("path",{d:"M10.667 2.667c1.45.008 2.235.072 2.748.585C14 3.837 14 4.78 14 6.666v4c0 1.885 0 2.828-.585 3.414-.586.585-1.529.585-3.415.585H6c-1.886 0-2.829 0-3.414-.585C2 13.494 2 12.55 2 10.666v-4c0-1.886 0-2.829.586-3.414.512-.513 1.297-.577 2.747-.585",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round"}),u.jsx("path",{d:"M5.333 2.333c0-.552.448-1 1-1h3.334c.552 0 1 .448 1 1v.667c0 .553-.448 1-1 1H6.333c-.552 0-1-.447-1-1v-.667Z",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round"}),u.jsx("path",{d:"M8 6.667v4.666m0 0L5.667 9m2.333 2.333L10.333 9",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round"})]})}function hr(n){return u.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...n,children:[u.jsx("path",{d:"M3 7a2 2 0 0 1 2-2h4l2 2h8a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V7Z",stroke:"currentColor",strokeWidth:"1.5",fill:"none"}),u.jsx("path",{d:"M3 9h18",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]})}function yb(n){return u.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...n,children:[u.jsx("path",{d:"M5 4h12l3 3v13H4V5a1 1 0 0 1 1-1Z",stroke:"currentColor",strokeWidth:"1.5",fill:"none"}),u.jsx("rect",{x:"7",y:"4",width:"8",height:"4",fill:"currentColor"}),u.jsx("rect",{x:"7",y:"13",width:"10",height:"6",rx:"1",stroke:"currentColor",strokeWidth:"1.5",fill:"none"})]})}function bb(n){return u.jsxs("svg",{viewBox:"0 0 16 16",fill:"none","aria-hidden":"true",...n,children:[u.jsx("path",{d:"M12.667 14H3.333C2.597 14 2 13.403 2 12.667V3.333C2 2.597 2.597 2 3.333 2h7.334L14 5.333v7.334c0 .736-.597 1.333-1.333 1.333Z",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round"}),u.jsx("path",{d:"M11.333 14v-4H4.667v4M4.667 2v3.333h5.333",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round"})]})}function v2(n){return u.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...n,children:[u.jsx("circle",{cx:"12",cy:"12",r:"4",fill:"currentColor"}),u.jsx("path",{d:"M12 2v3M12 19v3M4.22 4.22l2.12 2.12M17.66 17.66l2.12 2.12M2 12h3M19 12h3M4.22 19.78l2.12-2.12M17.66 6.34l2.12-2.12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",fill:"none"})]})}function w2(n){return u.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...n,children:u.jsx("path",{d:"M21 14.5A9 9 0 0 1 9.5 3a7 7 0 1 0 11.5 11.5Z",fill:"currentColor"})})}function S2(n){return u.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",fill:"currentColor",...n,children:u.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z"})})}function U0(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","aria-hidden":"true",...n,children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})}function N2(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","aria-hidden":"true",...n,children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}function C2(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","aria-hidden":"true",...n,children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})}function k2(n){return u.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...n,children:u.jsx("path",{d:"M8 4h8M8 20h8M9 6h6l-1 4 1 4H9l1-4-1-4Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none"})})}function xb(n){return u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",...n,children:[u.jsx("path",{d:"M12 3v18"}),u.jsx("path",{d:"m8 7 4-4 4 4"}),u.jsx("path",{d:"m8 17 4 4 4-4"})]})}function j2({progress:n,radius:o=10,trackColor:s=Tt.border.gray200,progressColor:l=Tt.brand.blue500,...i}){const c=Math.min(100,Math.max(0,n)),f=2*Math.PI*o,m=f*(1-c/100);return u.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...i,children:[u.jsx("circle",{cx:"12",cy:"12",r:o,fill:"none",stroke:s,strokeWidth:"2"}),u.jsx("circle",{cx:"12",cy:"12",r:o,fill:"none",stroke:l,strokeWidth:"2",strokeLinecap:"round",strokeDasharray:f,strokeDashoffset:m})]})}function Ca({title:n,onBack:o,rightElement:s}){return u.jsxs("div",{className:"flex items-center mb-3",children:[u.jsxs("button",{onClick:o,className:"flex items-center gap-2 text-sm font-semibold text-gray-500 uppercase tracking-wide",children:[u.jsx(g2,{className:"w-5 h-5 text-gray-400"}),u.jsx("span",{children:n})]}),s&&u.jsx("div",{className:"ml-auto",children:s})]})}function M2({icon:n,title:o,description:s}){return u.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 bg-white border border-gray-100 rounded-lg shadow-sm",children:[n,u.jsxs("div",{children:[u.jsx("p",{className:"text-sm font-medium text-gray-900",children:o}),u.jsx("p",{className:"text-xs text-gray-500",children:s})]})]})}function O2(){return[{icon:u.jsx("div",{className:"w-8 h-8 flex items-center justify-center bg-blue-500 text-white rounded-lg font-bold text-xs shadow-sm",children:"Run"}),title:"Run",description:"Execute current workflow"},{icon:u.jsx("div",{className:"w-10 h-10 flex items-center justify-center bg-white border border-gray-200 rounded-lg text-gray-700 shadow-sm overflow-hidden",children:u.jsx(db,{className:"w-5 h-5"})}),title:"Queue / Follow",description:"View queue & follow execution"},{icon:u.jsx("div",{className:"w-10 h-10 flex items-center justify-center bg-yellow-500 text-white rounded-lg shadow-sm",children:u.jsx(ya,{className:"w-5 h-5"})}),title:"Pinned Widget",description:"Quick access to pinned parameter"},{icon:u.jsx("div",{className:"w-8 h-8 flex items-center justify-center bg-gray-100 rounded-full border border-gray-200 text-gray-700 font-bold",children:""}),title:"Input",description:"Node input connection point"},{icon:u.jsx("div",{className:"w-8 h-8 flex items-center justify-center bg-gray-100 rounded-full border border-gray-200 text-gray-700 font-bold",children:""}),title:"Output",description:"Node output connection point"},{icon:u.jsx("div",{className:"w-8 h-8 flex items-center justify-center text-gray-700",children:u.jsx(y2,{className:"w-6 h-6 overflow-visible"})}),title:"Trace Connections",description:"Highlight connected nodes"},{icon:u.jsx("div",{className:"w-8 h-8 flex items-center justify-center text-gray-500",children:u.jsx(to,{className:"w-6 h-6"})}),title:"Fold / Unfold",description:"Collapse or expand node card"},{icon:u.jsx("div",{className:"w-8 h-8 flex items-center justify-center text-gray-700",children:u.jsx(pb,{className:"w-5 h-5"})}),title:"Bypass",description:"Skip node execution"},{icon:u.jsx("div",{className:"w-8 h-8 flex items-center justify-center text-gray-700",children:u.jsx(Go,{className:"w-5 h-5"})}),title:"Hide",description:"Hide node from view"},{icon:u.jsx("div",{className:"w-8 h-8 flex items-center justify-center text-gray-700",children:u.jsx(pr,{className:"w-5 h-5"})}),title:"Show",description:"Make node visible again"},{icon:u.jsx("div",{className:"w-8 h-8 flex items-center justify-center text-gray-700",children:u.jsx(Af,{className:"w-5 h-5"})}),title:"Pin widget",description:"Pin widget to bottom bar"}]}function T2({onBack:n}){const o=O2();return u.jsxs("div",{className:"flex flex-col h-full",children:[u.jsx(Ca,{title:"Icon Legend",onBack:n}),u.jsx("div",{className:"space-y-3 overflow-y-auto flex-1 pb-4",children:o.map(s=>u.jsx(M2,{icon:s.icon,title:s.title,description:s.description},s.title))})]})}function ka({error:n,onDismiss:o}){return n?u.jsxs("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:[n,u.jsx("button",{onClick:o,className:"ml-2 text-red-500 font-medium",children:"Dismiss"})]}):null}function E2({error:n,workflow:o,currentFilename:s,isDirty:l,loading:i,theme:c,menuSectionsOpen:f,fileInputRef:m,loadSectionRef:p,saveSectionRef:g,appearanceSectionRef:b,infoSectionRef:x,onDismissError:w,onFileChange:k,onLoadFromFile:N,onToggleSection:S,onOpenUserWorkflows:j,onOpenTemplates:C,onOpenPasteJson:T,onSave:V,onOpenSaveAs:U,onToggleTheme:R,onOpenLegend:z}){return u.jsxs(u.Fragment,{children:[u.jsx("input",{ref:m,type:"file",accept:".json",onChange:k,className:"hidden"}),u.jsx(ka,{error:n,onDismiss:w}),u.jsxs("section",{ref:p,className:"mb-6",children:[u.jsxs("button",{type:"button",onClick:()=>S("load"),className:"w-full flex items-center justify-between text-sm font-semibold text-gray-500 uppercase tracking-wide mb-3","aria-expanded":f.load,children:[u.jsx("span",{children:"Load Workflow"}),u.jsx(to,{className:`w-5 h-5 text-gray-400 transition-transform ${f.load?"rotate-0":"-rotate-90"}`})]}),f.load&&u.jsxs("div",{className:"space-y-2",children:[u.jsxs("button",{onClick:j,className:`w-full flex items-center gap-3 p-4 bg-white border border-gray-200
                         rounded-xl text-left hover:bg-gray-50 min-h-[56px]`,children:[u.jsx(bs,{className:"w-6 h-6 text-gray-600"}),u.jsx("span",{className:"font-medium text-gray-900",children:"My Workflows"}),u.jsx("span",{className:"ml-auto text-gray-400",children:""})]}),u.jsxs("button",{onClick:C,className:`w-full flex items-center gap-3 p-4 bg-white border border-gray-200
                         rounded-xl text-left hover:bg-gray-50 min-h-[56px]`,children:[u.jsx(gb,{className:"w-6 h-6 text-gray-600"}),u.jsx("span",{className:"font-medium text-gray-900",children:"Templates"}),u.jsx("span",{className:"ml-auto text-gray-400",children:""})]}),u.jsxs("button",{onClick:T,className:`w-full flex items-center gap-3 p-4 bg-white border border-gray-200
                         rounded-xl text-left hover:bg-gray-50 min-h-[56px]`,children:[u.jsx(x2,{className:"w-6 h-6 text-gray-600"}),u.jsx("span",{className:"font-medium text-gray-900",children:"Paste JSON"}),u.jsx("span",{className:"ml-auto text-gray-400",children:""})]}),u.jsxs("button",{onClick:N,className:`w-full flex items-center gap-3 p-4 bg-white border border-gray-200
                         rounded-xl text-left hover:bg-gray-50 min-h-[56px]`,children:[u.jsx(hr,{className:"w-6 h-6 text-gray-600"}),u.jsx("span",{className:"font-medium text-gray-900",children:"From Device"})]})]})]}),u.jsxs("section",{ref:g,className:"mb-6",children:[u.jsxs("button",{type:"button",onClick:()=>S("save"),className:"w-full flex items-center justify-between text-sm font-semibold text-gray-500 uppercase tracking-wide mb-3","aria-expanded":f.save,children:[u.jsx("span",{children:"Save Workflow"}),u.jsx(to,{className:`w-5 h-5 text-gray-400 transition-transform ${f.save?"rotate-0":"-rotate-90"}`})]}),f.save&&u.jsxs("div",{className:"space-y-2",children:[s&&u.jsxs("button",{onClick:V,disabled:!o||!l||i,className:`w-full flex items-center gap-3 p-4 bg-white border border-gray-200
                           rounded-xl text-left hover:bg-gray-50 min-h-[56px]
                           disabled:opacity-50 disabled:cursor-not-allowed`,children:[u.jsx(yb,{className:"w-6 h-6 text-gray-600 shrink-0"}),u.jsxs("span",{className:"font-medium text-gray-900 truncate",children:["Save ",s.replace(".json","")]})]}),u.jsxs("button",{onClick:U,disabled:!o,className:`w-full flex items-center gap-3 p-4 bg-white border border-gray-200
                         rounded-xl text-left hover:bg-gray-50 min-h-[56px]`,children:[u.jsx(bb,{className:"w-6 h-6 text-gray-600"}),u.jsx("span",{className:"font-medium text-gray-900",children:"Save As..."}),u.jsx("span",{className:"ml-auto text-gray-400",children:""})]})]})]}),u.jsx("div",{className:"border-t border-gray-200 mb-6"}),u.jsxs("section",{ref:b,className:"mb-6",children:[u.jsxs("button",{type:"button",onClick:()=>S("appearance"),className:"w-full flex items-center justify-between text-sm font-semibold text-gray-500 uppercase tracking-wide mb-3","aria-expanded":f.appearance,children:[u.jsx("span",{children:"Appearance"}),u.jsx(to,{className:`w-5 h-5 text-gray-400 transition-transform ${f.appearance?"rotate-0":"-rotate-90"}`})]}),f.appearance&&u.jsx("div",{className:"space-y-2",children:u.jsxs("button",{onClick:R,className:`w-full flex items-center gap-3 p-4 bg-white border border-gray-200
                         rounded-xl text-left hover:bg-gray-50 min-h-[56px]`,children:[c==="dark"?u.jsx(w2,{className:"w-6 h-6 text-gray-600"}):u.jsx(v2,{className:"w-6 h-6 text-gray-600"}),u.jsx("span",{className:"font-medium text-gray-900",children:c==="dark"?"Dark mode":"Light mode"})]})})]}),u.jsxs("section",{ref:x,className:"mt-auto pt-6 border-t border-gray-200",children:[u.jsxs("button",{type:"button",onClick:()=>S("info"),className:"w-full flex items-center justify-between text-sm font-semibold text-gray-500 uppercase tracking-wide mb-3","aria-expanded":f.info,children:[u.jsx("span",{children:"About"}),u.jsx(to,{className:`w-5 h-5 text-gray-400 transition-transform ${f.info?"rotate-0":"-rotate-90"}`})]}),f.info&&u.jsxs("div",{className:"space-y-2 pb-4",children:[u.jsxs("a",{href:"https://github.com/cosmicbuffalo/comfyui-mobile-frontend",target:"_blank",rel:"noopener noreferrer",className:`w-full flex items-center gap-3 p-4 bg-white border border-gray-200
                         rounded-xl text-left hover:bg-gray-50 min-h-[56px]`,children:[u.jsx(S2,{className:"w-6 h-6 text-gray-600"}),u.jsx("span",{className:"font-medium text-gray-900",children:"Open in GitHub"}),u.jsx(U0,{className:"w-4 h-4 ml-auto text-gray-400"})]}),u.jsxs("button",{onClick:z,className:`w-full flex items-center gap-3 p-4 bg-white border border-gray-200
                         rounded-xl text-left hover:bg-gray-50 min-h-[56px]`,children:[u.jsx(N2,{className:"w-6 h-6 text-gray-600"}),u.jsx("span",{className:"font-medium text-gray-900",children:"Icon Legend"}),u.jsx("span",{className:"ml-auto text-gray-400",children:""})]}),u.jsxs("a",{href:"https://github.com/cosmicbuffalo/comfyui-mobile-frontend/blob/main/USER_GUIDE.md",target:"_blank",rel:"noopener noreferrer",className:`w-full flex items-center gap-3 p-4 bg-white border border-gray-200
                         rounded-xl text-left hover:bg-gray-50 min-h-[56px]`,children:[u.jsx(C2,{className:"w-6 h-6 text-gray-600"}),u.jsx("span",{className:"font-medium text-gray-900",children:"User Manual"}),u.jsx(U0,{className:"w-4 h-4 ml-auto text-gray-400"})]})]})]})]})}async function I2(n){if(navigator.clipboard?.writeText)try{await navigator.clipboard.writeText(n);return}catch{}const o=document.createElement("textarea");o.value=n,o.readOnly=!0,o.style.position="fixed",o.style.top="0",o.style.left="0",o.style.opacity="0",document.body.appendChild(o),o.focus(),o.select(),o.setSelectionRange(0,o.value.length),document.execCommand("copy"),document.body.removeChild(o)}function $0(n,o,s){const l=n.current;if(l){if(l.focus(),o)l.setSelectionRange(o.start,o.end);else if(s!==void 0){const i=s.length;l.setSelectionRange(i,i)}}}function L2(n){const o=n.current;if(!o)return;const l=o.closest('[data-textarea-root="true"]')?.querySelector('[data-textarea-header="true"]');l?l.scrollIntoView({block:"nearest",behavior:"auto"}):o.scrollIntoView({block:"nearest",behavior:"auto"})}function ca({value:n,onChange:o,textareaRef:s,className:l=""}){const[i,c]=y.useState(!1),f=y.useRef(null),m=y.useRef(null),p=()=>{c(!0),f.current&&clearTimeout(f.current),f.current=setTimeout(()=>c(!1),900)},g=w=>{w.preventDefault()},b=async()=>{const w=s.current;w&&(m.current={start:w.selectionStart??0,end:w.selectionEnd??0});const k=s.current?.value??n;await I2(k),requestAnimationFrame(()=>$0(s,m.current||void 0)),p()},x=()=>{o(""),requestAnimationFrame(()=>{$0(s,void 0,""),L2(s)})};return u.jsxs("div",{className:`flex items-center text-[11px] text-gray-500 ${l}`,children:[u.jsxs("button",{type:"button",className:"inline-flex items-center gap-1 px-1 py-0.5 text-gray-600",onMouseDown:g,onClick:b,"aria-label":"Copy to clipboard",children:[i?u.jsx(Do,{className:"w-3.5 h-3.5 text-green-500"}):u.jsx(d2,{className:"w-3.5 h-3.5"}),u.jsx("span",{children:"Copy"})]}),u.jsx("span",{className:"text-gray-500/50",children:"|"}),u.jsxs("button",{type:"button",className:"inline-flex items-center gap-1 px-1 py-0.5 text-red-600",onMouseDown:g,onClick:x,"aria-label":"Clear text",children:[u.jsx(f2,{className:"w-3.5 h-3.5"}),u.jsx("span",{children:"Clear"})]})]})}function A2({error:n,pastedJson:o,pasteTextareaRef:s,onBack:l,onDismissError:i,onChangeJson:c,onLoad:f}){return u.jsxs("div",{className:"flex flex-col h-full",children:[u.jsx(Ca,{title:"Paste JSON",onBack:l}),u.jsx(ka,{error:n,onDismiss:i}),u.jsxs("div",{className:"flex-1 flex flex-col space-y-4",children:[u.jsx("p",{className:"text-sm text-gray-600",children:"Paste your workflow JSON below."}),u.jsxs("div",{className:"group","data-textarea-root":"true",children:[u.jsxs("div",{className:"flex items-center justify-between mb-1","data-textarea-header":"true",children:[u.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Workflow JSON"}),u.jsx(ca,{value:o,onChange:c,textareaRef:s,className:"opacity-70 transition-opacity group-focus-within:opacity-100"})]}),u.jsx("textarea",{ref:s,value:o,onChange:m=>c(m.target.value),placeholder:'{"last_node_id": ...}',className:"w-full flex-1 p-3 border border-gray-300 rounded-lg font-mono text-xs resize-none outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),u.jsxs("div",{className:"flex gap-3 pt-2",children:[u.jsx("button",{onClick:l,className:"flex-1 py-3 bg-gray-100 text-gray-700 rounded-lg font-medium hover:bg-gray-200 min-h-[48px]",children:"Cancel"}),u.jsx("button",{onClick:f,disabled:!o.trim(),className:`flex-1 py-3 bg-blue-500 text-white rounded-lg font-medium hover:bg-blue-600
                       disabled:opacity-50 disabled:cursor-not-allowed min-h-[48px]`,children:"Load"})]})]})]})}function R2({error:n,loading:o,workflow:s,saveFilenameInput:l,onBack:i,onDismissError:c,onSaveFilenameChange:f,onSaveAs:m,onDownload:p}){return u.jsxs("div",{className:"flex flex-col h-full",children:[u.jsx(Ca,{title:"Save Workflow",onBack:i}),u.jsx(ka,{error:n,onDismiss:c}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"p-4 bg-white border border-gray-200 rounded-xl",children:[u.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Save to ComfyUI server:"}),u.jsx("input",{type:"text",value:l,onChange:g=>f(g.target.value),placeholder:"Enter filename (e.g., my_workflow.json)",className:"w-full p-3 border border-gray-300 rounded-lg mb-3"}),u.jsx("button",{onClick:m,disabled:!s||!l.trim()||o,className:`w-full py-3 bg-blue-500 text-white rounded-lg font-medium
                       disabled:opacity-50 disabled:cursor-not-allowed min-h-[48px]`,children:o?"Saving...":"Save As"})]}),u.jsxs("button",{onClick:p,disabled:!s,className:`w-full flex items-center gap-3 px-4 py-3 bg-white border border-gray-200
                     rounded-xl text-left hover:bg-gray-50 min-h-[56px]
                     disabled:opacity-50 disabled:cursor-not-allowed`,children:[u.jsx(b2,{className:"w-6 h-6 text-gray-600"}),u.jsx("span",{className:"font-medium text-gray-900",children:"Download to Device"})]})]})]})}function ja({value:n,onChange:o,onClear:s,placeholder:l="Search...",autoFocus:i=!1,className:c="",inputClassName:f="",disabled:m=!1,readOnly:p=!1,inputRef:g,showClearButton:b=!0}){const x=b&&n.trim().length>0&&!m&&!p;return u.jsxs("div",{className:`relative ${c}`.trim(),children:[u.jsx(fb,{className:"w-4 h-4 text-gray-400 absolute left-3 top-1/2 -translate-y-1/2 pointer-events-none"}),u.jsx("input",{ref:g,value:n,onChange:w=>o(w.target.value),placeholder:l,className:`w-full rounded-lg border border-gray-200 pl-9 pr-9 py-2 text-sm text-gray-900 placeholder:text-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent ${f}`.trim(),autoFocus:i,disabled:m,readOnly:p}),x&&u.jsx("button",{type:"button",onClick:()=>{if(s){s();return}o("")},className:"absolute right-2 top-1/2 -translate-y-1/2 p-1 text-gray-400 hover:text-gray-600","aria-label":"Clear search",children:u.jsx(Na,{className:"w-4 h-4"})})]})}const _2={sm:"w-4 h-4 border-2",md:"w-6 h-6 border-2",lg:"w-10 h-10 border-4"},D2={blue:"border-blue-500 border-t-transparent",gray:"border-gray-200 border-t-gray-500"};function hp({size:n="md",color:o="blue",className:s=""}){return u.jsx("div",{className:`animate-spin rounded-full ${_2[n]} ${D2[o]} ${s}`})}function B2({error:n,loading:o,templates:s,onBack:l,onDismissError:i,onLoadTemplate:c}){const[f,m]=y.useState(""),p=Object.entries(s),g=f.toLowerCase(),b=p.map(([w,k])=>[w,k.filter(N=>N.toLowerCase().includes(g))]).filter(([,w])=>w.length>0),x=p.length>0;return u.jsxs("div",{className:"flex flex-col h-full",children:[u.jsx(Ca,{title:"Templates",onBack:l}),u.jsx(ka,{error:n,onDismiss:i}),!o&&x&&u.jsx("div",{className:"py-2",children:u.jsx(ja,{value:f,onChange:m,placeholder:"Search",inputClassName:"bg-white"})}),o?u.jsx("div",{className:"flex items-center justify-center py-8",children:u.jsx(hp,{})}):x?b.length===0?u.jsx("p",{className:"text-gray-500 text-center py-8",children:"No matching templates"}):u.jsx("div",{className:"space-y-4 overflow-y-auto flex-1",children:b.map(([w,k])=>u.jsxs("div",{children:[u.jsx("h4",{className:"text-sm font-semibold text-gray-600 mb-2",children:w}),u.jsx("div",{className:"space-y-2",children:k.map(N=>u.jsxs("button",{onClick:()=>c(w,N),className:`w-full flex items-center gap-3 px-4 py-3 bg-white border border-gray-200
                               rounded-xl text-left hover:bg-gray-50 min-h-[56px]`,children:[u.jsx(gb,{className:"w-5 h-5 text-gray-600"}),u.jsx("span",{className:"font-medium text-gray-900 truncate",children:N.replace(/\.json$/,"")})]},N))})]},w))}):u.jsx("p",{className:"text-gray-500 text-center py-8",children:"No templates available"})]})}function z2(n){const o=new Date,s=new Date(n*1e3),l=o.getTime()-s.getTime(),i=Math.floor(l/(1e3*60*60*24)),c=String(s.getMonth()+1),f=String(s.getDate()),m=String(s.getFullYear()).slice(-2),p=`${c}/${f}/${m}`;return i===0?`${p} (Today)`:i===1?`${p} (Yesterday)`:`${p} (${i} days ago)`}function H2({error:n,loading:o,userWorkflows:s,onBack:l,onDismissError:i,onLoadWorkflow:c}){const[f,m]=y.useState(""),[p,g]=y.useState("name"),b=s.filter(w=>w.name.toLowerCase().includes(f.toLowerCase())).sort((w,k)=>p==="name"?w.name.localeCompare(k.name):(k.modified??0)-(w.modified??0)),x=u.jsxs("button",{onClick:()=>g(p==="name"?"date":"name"),className:"flex items-center gap-0.5 text-xs font-semibold text-blue-500",children:[u.jsx("span",{children:p==="name"?"NAME":"DATE"}),u.jsx("span",{children:""})]});return u.jsxs("div",{className:"flex flex-col h-full",children:[u.jsx(Ca,{title:"My Workflows",onBack:l,rightElement:x}),u.jsx(ka,{error:n,onDismiss:i}),!o&&s.length>0&&u.jsx("div",{className:"py-2",children:u.jsx(ja,{value:f,onChange:m,placeholder:"Search",inputClassName:"bg-white"})}),o?u.jsx("div",{className:"flex items-center justify-center py-8",children:u.jsx(hp,{})}):s.length===0?u.jsx("p",{className:"text-gray-500 text-center py-8",children:"No saved workflows yet"}):b.length===0?u.jsx("p",{className:"text-gray-500 text-center py-8",children:"No matching workflows"}):u.jsx("div",{className:"space-y-2 overflow-y-auto flex-1",children:b.map(w=>u.jsxs("button",{onClick:()=>c(w.name),className:`w-full flex items-center gap-3 px-4 py-3 bg-white border border-gray-200
                         rounded-xl text-left hover:bg-gray-50 min-h-[56px]`,children:[u.jsx(bs,{className:"w-5 h-5 text-gray-600"}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("p",{className:"font-medium text-gray-900 truncate",children:w.name.replace(/\.json$/,"")}),w.modified&&u.jsx("p",{className:"text-xs text-gray-500",children:z2(w.modified)})]})]},w.path))})]})}const al=Oo()(xr(n=>({theme:"dark",setTheme:o=>{n({theme:o})},toggleTheme:()=>{n(o=>({theme:o.theme==="dark"?"light":"dark"}))}}),{name:"theme-storage",storage:br(()=>localStorage)}));function V2({open:n,onClose:o}){const s=ae(Ne=>Ne.loadWorkflow),l=ae(Ne=>Ne.workflow),i=ae(Ne=>Ne.currentFilename),c=ae(Ne=>Ne.originalWorkflow),f=ae(Ne=>Ne.setSavedWorkflow),m=al(Ne=>Ne.theme),p=al(Ne=>Ne.toggleTheme),g=y.useRef(null),b=!!(l&&c&&JSON.stringify(l)!==JSON.stringify(c)),x=y.useRef(null),[w,k]=y.useState(null),[N,S]=y.useState("menu"),[j,C]=y.useState([]),[T,V]=y.useState({}),[U,R]=y.useState(!1),[z,L]=y.useState(i||""),[$,Q]=y.useState(""),[ue,fe]=y.useState({load:!0,save:!0,appearance:!0,info:!0}),de=y.useRef(null),Ie=y.useRef(null),je=y.useRef(null),Me=y.useRef(null),_=y.useRef(ue);y.useEffect(()=>{const Ne=_.current,H=ue;!Ne.load&&H.load?setTimeout(()=>de.current?.scrollIntoView({behavior:"smooth",block:"nearest"}),100):!Ne.save&&H.save?setTimeout(()=>Ie.current?.scrollIntoView({behavior:"smooth",block:"nearest"}),100):!Ne.appearance&&H.appearance?setTimeout(()=>je.current?.scrollIntoView({behavior:"smooth",block:"nearest"}),100):!Ne.info&&H.info&&setTimeout(()=>Me.current?.scrollIntoView({behavior:"smooth",block:"nearest"}),100),_.current=H},[ue]),y.useEffect(()=>{n||(S("menu"),k(null),L(i||""),Q(""),fe({load:!0,save:!0,appearance:!0,info:!0}))},[n,i]),y.useEffect(()=>{N==="userWorkflows"&&(R(!0),G1().then(C).catch(Ne=>k(Ne.message)).finally(()=>R(!1)))},[N]),y.useEffect(()=>{N==="templates"&&(R(!0),P1().then(V).catch(Ne=>k(Ne.message)).finally(()=>R(!1)))},[N]);const oe=Ne=>{"vibrate"in navigator&&navigator.vibrate(Ne)},ce=()=>{x.current?.click()},Ke=async Ne=>{const H=Ne.target.files?.[0];if(H){try{const Y=await H.text(),D=JSON.parse(Y);if(!D.nodes||!Array.isArray(D.nodes))throw new Error("Invalid workflow: missing nodes array");s(D,H.name),k(null),o(),oe(10)}catch(Y){k(Y instanceof Error?Y.message:"Failed to load workflow")}x.current&&(x.current.value="")}},Le=async Ne=>{try{R(!0);const H=await np(Ne);s(H,Ne,{fresh:!0,source:{type:"user",filename:Ne}}),k(null),o(),oe(10)}catch(H){k(H instanceof Error?H.message:"Failed to load workflow")}finally{R(!1)}},E=async(Ne,H)=>{try{R(!0);const Y=await op(Ne,H);s(Y,`${Ne}/${H}`,{fresh:!0,source:{type:"template",moduleName:Ne,templateName:H}}),k(null),o(),oe(10)}catch(Y){k(Y instanceof Error?Y.message:"Failed to load template")}finally{R(!1)}},A=async Ne=>{if(!l)return;const H=Ne.endsWith(".json")?Ne:`${Ne}.json`;try{R(!0),await eb(H,gu(l)),f(l,H),k(null),o(),oe(10)}catch(Y){k(Y instanceof Error?Y.message:"Failed to save workflow")}finally{R(!1)}},M=()=>{i?A(i):S("save")},ee=()=>{L(i||""),S("save")},Te=()=>{z.trim()?A(z):k("Please enter a filename.")},qe=()=>{if(!l)return;const Ne=JSON.stringify(gu(l),null,2),H=new Blob([Ne],{type:"application/json"}),Y=URL.createObjectURL(H),D=document.createElement("a");D.href=Y,D.download=`${i||`workflow-${Date.now()}`}.json`,D.click(),URL.revokeObjectURL(Y),oe(10),o()},ye=()=>{try{const Ne=JSON.parse($);if(!Ne.nodes||!Array.isArray(Ne.nodes))throw new Error("Invalid workflow: missing nodes array");const H=new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"});s(Ne,`Pasted workflow (${H})`),k(null),o(),oe(10),Q("")}catch(Ne){k(Ne instanceof Error?Ne.message:"Failed to parse JSON")}};return u.jsxs(Xw,{open:n,onClose:o,side:"left",title:"ComfyUI Mobile",children:[N==="menu"&&u.jsx(E2,{error:w,workflow:l,currentFilename:i,isDirty:b,loading:U,theme:m,menuSectionsOpen:ue,fileInputRef:x,loadSectionRef:de,saveSectionRef:Ie,appearanceSectionRef:je,infoSectionRef:Me,onDismissError:()=>k(null),onFileChange:Ke,onLoadFromFile:ce,onToggleSection:Ne=>fe(H=>({...H,[Ne]:!H[Ne]})),onOpenUserWorkflows:()=>S("userWorkflows"),onOpenTemplates:()=>S("templates"),onOpenPasteJson:()=>S("pasteJson"),onSave:M,onOpenSaveAs:ee,onToggleTheme:p,onOpenLegend:()=>S("aboutLegend")}),N==="userWorkflows"&&u.jsx(H2,{error:w,loading:U,userWorkflows:j,onBack:()=>S("menu"),onDismissError:()=>k(null),onLoadWorkflow:Le}),N==="templates"&&u.jsx(B2,{error:w,loading:U,templates:T,onBack:()=>S("menu"),onDismissError:()=>k(null),onLoadTemplate:E}),N==="save"&&u.jsx(R2,{error:w,loading:U,workflow:l,saveFilenameInput:z,onBack:()=>S("menu"),onDismissError:()=>k(null),onSaveFilenameChange:L,onSaveAs:Te,onDownload:qe}),N==="pasteJson"&&u.jsx(A2,{error:w,pastedJson:$,pasteTextareaRef:g,onBack:()=>S("menu"),onDismissError:()=>k(null),onChangeJson:Q,onLoad:ye}),N==="aboutLegend"&&u.jsx(T2,{onBack:()=>S("menu")})]})}function cl({open:n,onDismiss:o,triggerRef:s,contentRef:l,ignoreScrollWithinContent:i=!1}){y.useEffect(()=>{if(!n)return;const c=m=>{const p=m.target;s.current&&p&&s.current.contains(p)||l.current&&p&&l.current.contains(p)||o()},f=m=>{if(i){const p=m.target;if(l.current&&p&&l.current.contains(p))return}o()};return document.addEventListener("mousedown",c),document.addEventListener("scroll",f,!0),()=>{document.removeEventListener("mousedown",c),document.removeEventListener("scroll",f,!0)}},[n,o,s,l,i])}function Po({onClose:n,title:o,description:s,actions:l,actionsLayout:i="inline",zIndex:c=2200}){const f=m=>m==="danger"?"px-3 py-2 rounded-lg text-sm font-medium text-white bg-red-600 hover:bg-red-700":m==="primary"?"px-3 py-2 rounded-lg text-sm font-medium text-white bg-blue-600 hover:bg-blue-700":"px-3 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-100";return u.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4",style:{zIndex:c},onClick:n,role:"dialog","aria-modal":"true",children:u.jsxs("div",{className:"w-full max-w-sm bg-white border border-gray-200 rounded-xl shadow-lg p-4",onClick:m=>m.stopPropagation(),children:[u.jsx("div",{className:"text-gray-900 text-base font-semibold",children:o}),s&&u.jsx("div",{className:"text-gray-600 text-sm mt-1",children:s}),u.jsx("div",{className:i==="stack"?"mt-4 flex flex-col gap-2":"mt-4 flex justify-end gap-2",children:l.map(m=>u.jsx("button",{className:`${f(m.variant)} ${m.className??""}`.trim(),onClick:m.onClick,children:m.label},m.label))})]})})}function Pr({onClick:n,ariaLabel:o,buttonRef:s,icon:l,buttonSize:i=10,iconSize:c=5}){return u.jsx("button",{type:"button",onClick:n,"aria-label":o,className:`w-${i} h-${i} flex items-center justify-center rounded-lg bg-transparent hover:bg-transparent text-inherit`,ref:s,children:l??u.jsx(r2,{className:`w-${c} h-${c}`})})}const K2={default:{row:"text-gray-900 hover:bg-gray-50",icon:"text-gray-500"},muted:{row:"text-gray-600 hover:bg-gray-50",icon:"text-gray-500"},danger:{row:"text-red-600 hover:bg-red-50",icon:"text-red-500"},primary:{row:"text-blue-600 hover:bg-blue-50",icon:"text-blue-500"}};function gr({items:n,className:o,itemClassName:s}){return u.jsx("div",{className:`bg-white border border-gray-200 rounded-lg shadow-lg overflow-hidden ${o??""}`.trim(),children:n.map(l=>{if(l.type==="divider")return u.jsx("div",{className:`border-t border-gray-200 my-1 ${l.className??""}`.trim()},l.key);if(l.type==="custom")return l.hidden?null:u.jsx("div",{children:typeof l.render=="function"?l.render():l.render},l.key);if(l.hidden)return null;const i=K2[l.color??"default"];return u.jsxs("button",{type:"button",className:["w-full flex items-center gap-2 text-left px-3 py-2 text-sm",l.rightSlot?"justify-between":"",i.row,l.disabled?"opacity-50 cursor-not-allowed":"",s??"",l.className??""].join(" ").trim(),onClick:l.onClick,disabled:l.disabled,children:[u.jsxs("span",{className:"flex items-center gap-2 min-w-0",children:[l.icon?u.jsx("span",{className:i.icon,children:l.icon}):null,u.jsx("span",{className:"truncate",children:l.label})]}),l.rightSlot?u.jsx("span",{className:"shrink-0",children:l.rightSlot}):null]},l.key)})})}function U2({open:n,buttonRef:o,menuRef:s,onToggle:l,onClose:i,onGoToWorkflow:c,onOpenClearHistoryConfirm:f}){const m=It(A=>A.setQueueItemExpanded),p=It(A=>A.queueItemExpanded),g=It(A=>A.showQueueMetadata),b=It(A=>A.toggleShowQueueMetadata),x=It(A=>A.previewVisibility),w=It(A=>A.setPreviewVisibility),k=It(A=>A.previewVisibilityDefault),N=It(A=>A.setPreviewVisibilityDefault),S=It(A=>A.pending),j=It(A=>A.running),C=It(A=>A.clearQueue),T=Pn(A=>A.history),V=Pn(A=>A.clearEmptyItems),U=S.length>0,R=T.length>0,z=T.some(A=>A.outputs.images.length===0),L=S.length+j.length+T.length>0,$=y.useMemo(()=>{const A=new Set;return S.forEach(M=>A.add(M.prompt_id)),j.forEach(M=>A.add(M.prompt_id)),T.forEach(M=>{M.prompt_id&&A.add(String(M.prompt_id))}),Array.from(A)},[S,j,T]),Q=y.useMemo(()=>$.some(A=>p[A]===!1),[$,p]),ue=y.useMemo(()=>$.some(A=>p[A]!==!1),[$,p]),fe=y.useMemo(()=>{const A=new Set;return T.forEach(M=>{(M.outputs?.images??[]).some(qe=>qe.type!=="output")&&M.prompt_id&&A.add(String(M.prompt_id))}),Array.from(A)},[T]),de=L||fe.length>0||k,Ie=fe.length>0?fe.every(A=>x[A]??k):k,je=()=>{c(),i()},Me=async()=>{await C(),i()},_=()=>{$.forEach(A=>m(A,!1)),i()},oe=()=>{$.forEach(A=>m(A,!0)),i()},ce=()=>{b(),i()},Ke=()=>{const A=!Ie;N(A),fe.forEach(M=>w(M,A)),i()},Le=async()=>{await V(),i()},E=()=>{i(),f()};return u.jsxs("div",{id:"queue-menu-container",className:"relative",children:[u.jsx(Pr,{buttonRef:o,onClick:l,ariaLabel:"Queue options"}),n?u.jsx("div",{id:"queue-options-dropdown",ref:s,className:"absolute right-0 top-11 z-50 w-48",children:u.jsx(gr,{items:[{key:"go-to-workflow",label:"Go to workflow",icon:u.jsx(xu,{className:"w-3 h-3 rotate-180"}),onClick:je},{key:"cancel-pending",label:"Cancel all pending",icon:u.jsx(a2,{className:"w-4 h-4"}),onClick:Me,hidden:!U},{key:"fold-all",label:"Fold all",icon:u.jsx(gs,{className:"w-7 h-7 -ml-1"}),onClick:_,hidden:!ue},{key:"unfold-all",label:"Unfold all",icon:u.jsx(to,{className:"w-7 h-7 -ml-1"}),onClick:oe,hidden:!Q},{key:"toggle-metadata",label:g?"Hide metadata":"Show metadata",icon:u.jsx(ub,{className:"w-4 h-4"}),onClick:ce,hidden:!R},{key:"toggle-previews",label:Ie?"Hide previews":"Show previews",icon:Ie?u.jsx(Go,{className:"w-4 h-4"}):u.jsx(pr,{className:"w-4 h-4"}),onClick:Ke,hidden:!de},{key:"clear-empty",label:"Clear empty items",icon:u.jsx(Bo,{className:"w-4 h-4"}),onClick:Le,color:"muted",hidden:!z},{key:"clear-history",label:"Clear history",icon:u.jsx(Bo,{className:"w-4 h-4"}),onClick:E,color:"danger",hidden:!R}]})}):null]})}function $2(){const[n,o]=y.useState(!1),[s,l]=y.useState(!1),i=no(p=>p.setCurrentPanel),c=Pn(p=>p.clearHistory),f=y.useRef(null),m=y.useRef(null);return cl({open:n,onDismiss:()=>o(!1),triggerRef:f,contentRef:m}),u.jsxs(u.Fragment,{children:[u.jsx(U2,{open:n,buttonRef:f,menuRef:m,onToggle:()=>o(p=>!p),onClose:()=>o(!1),onGoToWorkflow:()=>i("workflow"),onOpenClearHistoryConfirm:()=>l(!0)}),s&&En.createPortal(u.jsx(Po,{onClose:()=>l(!1),title:"Clear history?",description:"This will permanently remove all completed generations from history. Generated files will still be present in your server's output folder.",actions:[{label:"Cancel",onClick:()=>l(!1),variant:"secondary"},{label:"Clear history",onClick:()=>{(async()=>(await c(),l(!1)))()},variant:"danger"}]}),document.body)]})}function F2({open:n,buttonRef:o,menuRef:s,onToggle:l,onClose:i,onGoToWorkflow:c}){const f=Wt(U=>U.source),m=Wt(U=>U.viewMode),p=Wt(U=>U.showHidden),g=Wt(U=>U.setSource),b=Wt(U=>U.setViewMode),x=Wt(U=>U.toggleShowHidden),w=Wt(U=>U.toggleSelectionMode),k=Wt(U=>U.setNewFolderModalOpen),N=()=>{k(!0),i()},S=()=>{g(f==="output"?"input":"output"),i()},j=()=>{c(),i()},C=()=>{w(),i()},T=()=>{x(),i()},V=()=>{b(m==="grid"?"list":"grid"),i()};return u.jsxs("div",{id:"outputs-topbar-actions",className:"relative flex items-center gap-1",children:[u.jsx(Pr,{buttonRef:o,onClick:l,ariaLabel:"Outputs options"}),n?u.jsx("div",{id:"outputs-options-dropdown",ref:s,className:"absolute right-0 top-11 z-50 w-48",children:u.jsx(gr,{items:[{key:"toggle-source",label:f==="output"?"Switch to inputs":"Switch to outputs",icon:u.jsx(dp,{className:"w-4 h-4"}),onClick:S},{key:"go-to-workflow",label:"Go to workflow",icon:u.jsx(xu,{className:"w-3 h-3"}),onClick:j},{key:"select",label:"Select",icon:u.jsx(Do,{className:"w-4 h-4"}),onClick:C},{key:"new-folder",label:"New folder",icon:u.jsx(hr,{className:"w-4 h-4"}),onClick:N},{key:"toggle-hidden",label:p?"Hide hidden files":"Show hidden files",icon:p?u.jsx(Go,{className:"w-4 h-4"}):u.jsx(pr,{className:"w-4 h-4"}),onClick:T},{key:"toggle-view",label:m==="grid"?"List view":"Grid view",icon:m==="grid"?u.jsx(t2,{className:"w-4 h-4"}):u.jsx(m2,{className:"w-4 h-4"}),onClick:V}]})}):null]})}function q2(){const[n,o]=y.useState(!1),s=no(c=>c.setCurrentPanel),l=y.useRef(null),i=y.useRef(null);return cl({open:n,onDismiss:()=>o(!1),triggerRef:l,contentRef:i}),u.jsx(F2,{open:n,buttonRef:l,menuRef:i,onToggle:()=>o(c=>!c),onClose:()=>o(!1),onGoToWorkflow:()=>s("workflow")})}const W2=5;function G2(n){const o={};for(const s of n)o[s.id]={mode:s.mode,flags:s.flags?{collapsed:!!s.flags.collapsed}:void 0,widgets_values:s.widgets_values};return o}function P2(n,o,s,l){return{nodes:G2(n.nodes),seedModes:{...o},collapsedItems:{...s},hiddenItems:{...l}}}function F0(n,o){if(n===o)return!0;if(n.length!==o.length)return!1;for(let s=0;s<n.length;s+=1)if(n[s]!==o[s])return!1;return!0}function q0(n){const{workflow:o}=ae.getState();if(!o)return[];const s=new Set;for(const c of o.nodes??[])c.stableKey&&s.add(c.stableKey);for(const c of o.groups??[])c.stableKey&&s.add(c.stableKey);for(const c of o.definitions?.subgraphs??[]){c.stableKey&&s.add(c.stableKey);for(const f of c.groups??[])f.stableKey&&s.add(f.stableKey)}const l=[],i=new Set;for(const c of n)!c||i.has(c)||s.has(c)&&(i.add(c),l.push(c));return l}const Gn=Oo()(xr((n,o)=>({bookmarkedItems:[],bookmarkBarSide:"right",bookmarkBarTop:null,bookmarkRepositioningActive:!1,toggleBookmark:s=>{if(!s)return;const{bookmarkedItems:l}=o(),{currentWorkflowKey:i,savedWorkflowStates:c,workflow:f,collapsedItems:m,hiddenItems:p}=ae.getState(),g=Wn.getState().seedModes,x=l.includes(s)?l.filter(w=>w!==s):l.length>=W2?l:[...l,s];if(x!==l){if(i){let k=c[i];!k&&f&&(k=P2(f,g,m,p)),k&&ae.setState({savedWorkflowStates:{...c,[i]:{...k,bookmarkedItems:[...x]}}})}n({bookmarkedItems:x})}},clearBookmarks:()=>{const{currentWorkflowKey:s,savedWorkflowStates:l}=ae.getState();if(s&&l[s]){const i=l[s];ae.setState({savedWorkflowStates:{...l,[s]:{...i,bookmarkedItems:[]}}})}n({bookmarkedItems:[]})},setBookmarkBarPosition:s=>{n(l=>({bookmarkBarSide:s.side??l.bookmarkBarSide,bookmarkBarTop:s.top??l.bookmarkBarTop}))},setBookmarkRepositioningActive:s=>{n({bookmarkRepositioningActive:s})}}),{name:"bookmark-bar-storage",storage:br(()=>localStorage),partialize:n=>({bookmarkBarSide:n.bookmarkBarSide,bookmarkBarTop:n.bookmarkBarTop})}));function Y2(){const{workflow:n,currentWorkflowKey:o,savedWorkflowStates:s}=ae.getState(),{bookmarkedItems:l}=Gn.getState();if(!n){l.length>0&&Gn.setState({bookmarkedItems:[]});return}if(!o){const f=q0(l);F0(l,f)||Gn.setState({bookmarkedItems:f});return}const i=s[o],c=q0(i?.bookmarkedItems??[]);F0(l,c)||Gn.setState({bookmarkedItems:c})}ae.subscribe(()=>{Y2()});function Q2({open:n,buttonRef:o,menuRef:s,onToggle:l,onClose:i,onGoToQueue:c,onGoToOutputs:f,onAddNode:m,onOpenWorkflowActions:p}){const g=ae(F=>F.workflow),b=ae(F=>F.nodeTypes),x=ae(F=>F.setItemCollapsed),w=ae(F=>F.setItemHidden),k=ae(F=>F.showAllHiddenNodes),N=ae(F=>F.hiddenItems),S=Gn(F=>F.bookmarkedItems),j=Gn(F=>F.clearBookmarks),C=ae(F=>F.collapsedItems),T=ae(F=>F.workflowSource),V=ae(F=>F.loadWorkflow),U=ae(F=>F.searchOpen),R=ae(F=>F.setSearchOpen),z=ae(F=>F.setSearchQuery),L=ae(F=>F.connectionButtonsVisible),$=ae(F=>F.toggleConnectionButtonsVisible),Q=Pn(F=>F.history),ue=y.useCallback((F,ie)=>!!F[ie],[]),fe=!!g,de=y.useMemo(()=>g?.nodes.map(F=>F.stableKey??null).filter(F=>F!=null)??[],[g]),Ie=y.useMemo(()=>[...g?.groups??[],...(g?.definitions?.subgraphs??[]).flatMap(ie=>ie.groups??[])].map(ie=>ie.stableKey??null).filter(ie=>ie!=null),[g]),je=y.useMemo(()=>(g?.definitions?.subgraphs?.map(F=>F.stableKey??null)??[]).filter(F=>F!=null),[g]),Me=y.useMemo(()=>g?.nodes.filter(F=>F.mode===4)??[],[g]),_=y.useMemo(()=>!g||!b?[]:g.nodes.filter(F=>{if(F.type==="Fast Groups Bypasser (rgthree)")return!1;const ie=lp(b,F).filter(Ue=>!Ue.connected),Ae=ap(b,F).filter(Ue=>!Ue.connected);return ie.length===0&&Ae.length===0}),[g,b]),oe=Me.length,ce=_.length,Ke=y.useMemo(()=>Object.values(N).filter(Boolean).length,[N]),Le=y.useMemo(()=>Me.filter(F=>(()=>{const ie=F.stableKey;return ie?N[ie]:!1})()).length,[Me,N]),E=y.useMemo(()=>_.filter(F=>(()=>{const ie=F.stableKey;return ie?N[ie]:!1})()).length,[_,N]),A=y.useMemo(()=>g?g.nodes.filter(F=>(()=>{const ie=F.stableKey;return ie?!N[ie]:!0})()):[],[g,N]),M=y.useMemo(()=>A.some(F=>{const ie=F.stableKey??null;return ie?C[ie]===!0:!1}),[C,A]),ee=y.useMemo(()=>A.some(F=>{const ie=F.stableKey??null;return ie?C[ie]!==!0:!0}),[C,A]),Te=y.useMemo(()=>Ie.some(F=>C[F]===!0),[Ie,C]),qe=y.useMemo(()=>Ie.some(F=>(C[F]??!1)===!1),[Ie,C]),ye=y.useMemo(()=>je.some(F=>C[F]??!1),[je,C]),Ne=y.useMemo(()=>je.some(F=>(C[F]??!1)===!1),[je,C]),H=M||Te||ye,Y=ee||qe||Ne,D=y.useMemo(()=>Ke>0||Ie.some(ie=>ue(N,ie))?!0:je.some(ie=>N[ie]===!0),[Ke,N,Ie,je,ue]),[K,X]=y.useState(!1),W=()=>{i()},Oe=()=>{c(),W()},be=()=>{f(),W()},ke=()=>{z(""),R(!0),W()},J=()=>{m(),W()},xe=()=>{de.forEach(F=>x(F,!0)),Ie.forEach(F=>x(F,!0)),je.forEach(F=>x(F,!0)),W()},I=()=>{de.forEach(F=>x(F,!1)),Ie.forEach(F=>x(F,!1)),je.forEach(F=>x(F,!1)),W()},B=()=>{k(),Ie.forEach(F=>w(F,!1)),je.forEach(F=>w(F,!1))},q=()=>{j(),W()},he=async()=>{if(!(!T||T.type!=="user")){try{const F=await np(T.filename);V(F,T.filename,{fresh:!0,source:T})}catch(F){console.error("Failed to reload workflow:",F)}W()}},me=async()=>{if(!(!T||T.type!=="template")){try{const F=await op(T.moduleName,T.templateName);V(F,`${T.moduleName}/${T.templateName}`,{fresh:!0,source:T})}catch(F){console.error("Failed to reload template:",F)}W()}},Se=()=>{if(!T||T.type!=="history")return;const F=Q.find(ie=>ie.prompt_id===T.promptId);F?.workflow&&V(F.workflow,`history-${T.promptId}.json`,{source:T}),W()};return u.jsxs("div",{id:"workflow-menu-container",className:"relative",children:[u.jsx(Pr,{buttonRef:o,onClick:l,ariaLabel:"Workflow options"}),n?u.jsx("div",{id:"workflow-options-dropdown",ref:s,className:"absolute right-0 top-11 z-50 w-52",children:u.jsx(gr,{items:[{key:"go-to-queue",label:"Go to queue",icon:u.jsx(xu,{className:"w-3 h-3"}),onClick:Oe},{key:"go-to-outputs",label:"Go to outputs",icon:u.jsx(xu,{className:"w-3 h-3 rotate-180"}),onClick:be},{key:"search",label:"Search",icon:u.jsx(fb,{className:"w-4 h-4"}),onClick:ke,hidden:U},{key:"add-node",label:"Add node",icon:u.jsx(zo,{className:"w-4 h-4"}),onClick:J,hidden:!fe},{key:"hide-show",label:"Hide / Show",icon:u.jsx(pr,{className:"w-4 h-4"}),onClick:()=>{X(!0),W()}},{key:"fold-all",label:"Fold all",icon:u.jsx(gs,{className:"w-6 h-6 -ml-1"}),onClick:xe,hidden:!Y},{key:"unfold-all",label:"Unfold all",icon:u.jsx(to,{className:"w-6 h-6 -ml-1"}),onClick:I,hidden:!H},{key:"clear-bookmarks",label:"Clear bookmarks",icon:u.jsx(Bo,{className:"w-4 h-4"}),onClick:q,hidden:S.length===0},{key:"reload-workflow",label:"Reload workflow",icon:u.jsx(dp,{className:"w-4 h-4"}),onClick:T?.type==="user"?he:T?.type==="template"?me:T?.type==="history"&&Q.find(F=>F.prompt_id===T.promptId)?.workflow?Se:void 0,hidden:!T||T.type==="history"&&!Q.find(F=>F.prompt_id===T.promptId)?.workflow},{key:"workflow-actions",label:"Workflow actions",icon:u.jsx(bs,{className:"w-4 h-4"}),onClick:()=>{p(),W()}}]})}):null,K&&u.jsx("div",{className:"fixed inset-0 z-[2150] bg-black/50 flex items-center justify-center p-4",onClick:()=>X(!1),role:"dialog","aria-modal":"true",children:u.jsxs("div",{className:"w-full max-w-sm bg-white border border-gray-200 rounded-xl shadow-lg overflow-hidden",onClick:F=>F.stopPropagation(),children:[u.jsx("div",{className:"px-4 py-3 text-sm font-semibold text-gray-700 border-b border-gray-100",children:"Hide / Show"}),u.jsx("div",{className:"max-h-[50vh] overflow-y-auto",children:u.jsx(gr,{itemClassName:"px-4 py-3",items:[{key:"static-nodes",label:E<ce?`Hide static nodes (${ce})`:`Show static nodes (${ce})`,icon:E<ce?u.jsx(Go,{className:"w-4 h-4"}):u.jsx(pr,{className:"w-4 h-4"}),onClick:()=>{E<ce?_.forEach(F=>{const ie=F.stableKey??null;ie&&w(ie,!0)}):_.forEach(F=>{const ie=F.stableKey??null;ie&&w(ie,!1)})},hidden:ce===0},{key:"bypassed-nodes",label:Le>0?`Show bypassed nodes (${oe})`:`Hide bypassed nodes (${oe})`,icon:Le>0?u.jsx(pr,{className:"w-4 h-4"}):u.jsx(Go,{className:"w-4 h-4"}),onClick:()=>{Le>0?Me.forEach(F=>{const ie=F.stableKey??null;ie&&w(ie,!1)}):Me.forEach(F=>{const ie=F.stableKey??null;ie&&w(ie,!0)})},hidden:oe===0},{key:"toggle-connection-buttons",label:L?"Hide connection buttons":"Show connection buttons",icon:L?u.jsx(Go,{className:"w-4 h-4"}):u.jsx(pr,{className:"w-4 h-4"}),onClick:$},{key:"show-all-hidden",label:"Show all hidden nodes",icon:u.jsx(pr,{className:"w-4 h-4"}),onClick:B,hidden:!D}]})}),u.jsx("div",{className:"px-4 py-3 border-t border-gray-100 flex justify-end",children:u.jsx("button",{className:"px-3 py-2 text-sm font-medium text-gray-600 hover:bg-gray-100 rounded-lg",onClick:()=>X(!1),children:"Cancel"})})]})})]})}function Xs({icon:n,label:o,onClick:s,disabled:l,description:i,tone:c="default"}){const f=c==="danger";return u.jsxs("button",{className:`w-full flex items-start gap-3 text-left px-4 py-3 disabled:opacity-50 ${f?"text-red-600 hover:bg-red-50":"hover:bg-gray-50"}`,onClick:s,disabled:l,children:[u.jsx("span",{className:"shrink-0 self-start mt-[3px]",children:n}),u.jsxs("span",{className:"flex flex-col min-w-0",children:[u.jsx("span",{className:`text-sm ${f?"text-red-600":"text-gray-900"}`,children:o}),i?u.jsx("span",{className:"text-xs text-gray-500",children:i}):null]})]})}function X2(){const[n,o]=y.useState(null),[s,l]=y.useState(null),[i,c]=y.useState(!1),[f,m]=y.useState(!1),[p,g]=y.useState(""),[b,x]=y.useState(null),[w,k]=y.useState(!1),N=ae(E=>E.workflow),S=ae(E=>E.originalWorkflow),j=ae(E=>E.currentFilename),C=ae(E=>E.workflowSource),T=ae(E=>E.loadWorkflow),V=ae(E=>E.setSavedWorkflow),U=ae(E=>E.clearWorkflowCache),R=ae(E=>E.unloadWorkflow),z=ae(E=>E.requestAddNodeModal),L=no(E=>E.setCurrentPanel),$=ae(E=>E.workflowLoadedAt),Q=Pn(E=>E.history),ue=y.useRef(null),fe=y.useRef(null),de=n!==null&&n===$,Ie=y.useMemo(()=>!!(N&&S&&JSON.stringify(N)!==JSON.stringify(S)),[N,S]);cl({open:de,onDismiss:()=>o(null),triggerRef:ue,contentRef:fe});const je=async()=>{if(localStorage.clear(),sessionStorage.clear(),"caches"in window){const E=await caches.keys();await Promise.all(E.map(A=>caches.delete(A)))}document.cookie.split(";").forEach(E=>{const[A]=E.split("=");document.cookie=`${A.trim()}=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/`}),window.location.reload()},Me=async E=>{if(!N)return;const A=E.endsWith(".json")?E:`${E}.json`;try{k(!0),await eb(A,gu(N)),V(N,A),x(null),m(!1),c(!1)}catch(M){x(M instanceof Error?M.message:"Failed to save workflow")}finally{k(!1)}},_=async()=>{if(!C){S&&T(S,j??void 0,{fresh:!0,source:{type:"other"}});return}if(C.type==="user"){const E=await np(C.filename);T(E,C.filename,{fresh:!0,source:C});return}if(C.type==="template"){const E=await op(C.moduleName,C.templateName);T(E,`${C.moduleName}/${C.templateName}`,{fresh:!0,source:C});return}if(C.type==="history"){const E=Q.find(A=>A.prompt_id===C.promptId);E?.workflow&&T(E.workflow,`history-${C.promptId}.json`,{fresh:!0,source:C});return}S&&T(S,j??void 0,{fresh:!0,source:C})},oe=E=>{if(Ie){l(E);return}E==="unload"?R():E==="clearWorkflowCache"?U():E==="clearAllCache"?je():_(),c(!1)},ce=async E=>{l(null);try{k(!0),E==="unload"?R():E==="clearWorkflowCache"?U():E==="clearAllCache"?await je():await _(),c(!1)}catch(A){x(A instanceof Error?A.message:"Failed to complete action")}finally{k(!1)}},Ke=()=>{o(null),x(null),c(!0)},Le=()=>{z({groupId:null,subgraphId:null})};return u.jsxs(u.Fragment,{children:[u.jsx(Q2,{open:de,buttonRef:ue,menuRef:fe,onToggle:()=>o(de?null:$),onClose:()=>o(null),onGoToQueue:()=>L("queue"),onGoToOutputs:()=>L("outputs"),onAddNode:Le,onOpenWorkflowActions:Ke}),i&&u.jsx("div",{className:"fixed inset-0 z-[1450] bg-black/50 flex items-center justify-center p-4",onClick:()=>c(!1),role:"dialog","aria-modal":"true",children:u.jsxs("div",{className:"w-full max-w-sm bg-white border border-gray-200 rounded-xl shadow-lg overflow-hidden",onClick:E=>E.stopPropagation(),children:[u.jsx("div",{className:"px-4 py-3 text-sm font-semibold text-gray-700 border-b border-gray-100",children:"Workflow actions"}),b&&u.jsx("div",{className:"px-4 py-2 text-sm text-red-700 bg-red-50 border-b border-red-100",children:b}),u.jsxs("div",{className:"max-h-[60vh] overflow-y-auto",children:[u.jsx(Xs,{icon:u.jsx(yb,{className:"w-4 h-4 text-gray-500"}),label:"Save",onClick:()=>{if(N){if(!j){g(j??""),m(!0);return}Me(j)}},disabled:!N||!Ie||w}),u.jsx(Xs,{icon:u.jsx(bb,{className:"w-4 h-4 text-gray-500"}),label:"Save as",onClick:()=>{g(j??""),m(!0)},disabled:!N||w}),Ie&&u.jsx(Xs,{icon:u.jsx(dp,{className:"w-4 h-4 text-red-500"}),label:"Discard changes",tone:"danger",onClick:()=>oe("discardChanges"),disabled:w}),u.jsx("div",{className:"border-t border-gray-200"}),u.jsx(Xs,{icon:u.jsx(Bo,{className:"w-5 h-5 text-gray-500"}),label:"Clear workflow cache",description:"(hidden nodes, folds, etc.)",onClick:()=>oe("clearWorkflowCache"),disabled:!N||w}),u.jsx(Xs,{icon:u.jsx(i2,{className:"w-5 h-5 text-red-500"}),label:"Unload workflow",description:"Close the current workflow panel state",tone:"danger",onClick:()=>oe("unload"),disabled:!N||w}),u.jsx(Xs,{icon:u.jsx(Bo,{className:"w-5 h-5 text-red-500"}),label:"Clear device cache",description:"Reset local storage and reload app",tone:"danger",onClick:()=>oe("clearAllCache"),disabled:w})]}),u.jsx("div",{className:"border-t border-gray-100 p-3",children:u.jsx("button",{className:"w-full px-4 py-2.5 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200",onClick:()=>c(!1),children:"Close"})})]})}),f&&u.jsx("div",{className:"fixed inset-0 z-[1460] bg-black/50 flex items-center justify-center p-4",onClick:()=>m(!1),role:"dialog","aria-modal":"true",children:u.jsxs("div",{className:"w-full max-w-sm bg-white border border-gray-200 rounded-xl shadow-lg p-4",onClick:E=>E.stopPropagation(),children:[u.jsx("div",{className:"text-base font-semibold text-gray-900 mb-3",children:"Save as"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"text",value:p,onChange:E=>g(E.target.value),className:"w-full border border-gray-300 rounded-lg px-3 pr-9 py-2 text-sm text-gray-900 focus:outline-none focus:border-2 focus:border-blue-500",placeholder:"workflow.json",autoFocus:!0}),p.length>0&&u.jsx("button",{type:"button",className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700",onClick:()=>g(""),"aria-label":"Clear filename",children:u.jsx(Na,{className:"w-4 h-4"})})]}),u.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[u.jsx("button",{className:"px-3 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-100",onClick:()=>m(!1),children:"Cancel"}),u.jsx("button",{className:"px-3 py-2 rounded-lg text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 disabled:opacity-50",onClick:()=>{const E=p.trim();if(!E){x("Please enter a filename.");return}Me(E)},disabled:!N||w,children:"Save"})]})]})}),s&&En.createPortal(u.jsx(Po,{onClose:()=>l(null),title:"Unsaved changes",description:"You have unsaved changes in the current workflow. Continue without saving?",actions:[{label:"Cancel",onClick:()=>l(null),className:"px-3 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-100"},{label:s==="discardChanges"?"Discard changes":"Continue",onClick:()=>{ce(s)},className:"px-3 py-2 rounded-lg text-sm font-medium text-white bg-red-600 hover:bg-red-700"}]}),document.body)]})}function Z2({onClick:n}){return u.jsx("button",{type:"button",onClick:n,"aria-label":"Menu",className:"w-10 h-10 flex items-center justify-center rounded-lg text-gray-700 hover:bg-gray-100",children:u.jsx(fp,{className:"w-6 h-6"})})}function J2({title:n,mode:o,isDirty:s,hasWorkflow:l,nodeCountLabel:i,historyLength:c,pendingLength:f,onTap:m}){return u.jsxs("div",{id:"top-bar-title-container",className:"flex-1 text-center min-w-0 px-2 cursor-pointer",onClick:m,children:[u.jsxs("h1",{id:"top-bar-title",className:"font-semibold text-gray-900 text-lg truncate flex items-center justify-center",children:[u.jsx("span",{className:"truncate",children:n}),o==="workflow"&&s&&u.jsx("span",{id:"dirty-indicator",className:"text-blue-500 ml-1 font-bold",children:"*"})]}),o==="workflow"&&l&&u.jsx("p",{className:"node-count-display text-xs text-gray-500",children:i}),o==="queue"&&u.jsxs("p",{className:"run-count-display text-xs text-gray-500",children:[c," ",c===1?"run":"runs",f>0&&` (${f} pending)`]})]})}function eS(n){return n==="queue"?['[data-queue-list="true"]','[data-node-list="true"]']:['[data-node-list="true"]','[data-queue-list="true"]']}function tS({mode:n="workflow"}){const o=y.useRef(null),s=y.useRef(0),l=Lf(C=>C.appMenuOpen),i=Lf(C=>C.setAppMenuOpen),c=y.useCallback(()=>{const C=Date.now(),T=C-s.current;if(s.current=C,T<300){if(n==="workflow"){window.dispatchEvent(new Event("workflow-scroll-to-top")),"vibrate"in navigator&&navigator.vibrate(10);return}if(n==="outputs"){const U=document.querySelector("#outputs-content-container");U&&(U.scrollTo({top:0,behavior:"auto"}),"vibrate"in navigator&&navigator.vibrate(10));return}const V=eS(n);for(const U of V){const R=document.querySelector(U);if(R&&R.scrollHeight>0&&!R.closest(".pointer-events-none")){R.scrollTo({top:0,behavior:"smooth"}),"vibrate"in navigator&&navigator.vibrate(10);break}}}},[n]),f=ae(C=>C.workflow),m=ae(C=>C.originalWorkflow),p=ae(C=>C.currentFilename),g=ae(C=>C.hiddenItems),b=It(C=>C.pending),x=Pn(C=>C.history),w=Wt(C=>C.source),k=f&&m&&JSON.stringify(f)!==JSON.stringify(m),N=y.useMemo(()=>{if(!f)return"";const C=f.nodes.length,T=Object.keys(g).length,V=Object.values(g).some(Boolean);if(T===0&&!V)return`${C} nodes ${k?"[Unsaved]":""}`.trim();const U=V?f.nodes.reduce((z,L)=>{const Q=L.properties?.__mobile_origin;if(!Q||typeof Q!="object"||Q.scope!=="subgraph")return z;const fe=Q.subgraphId,de=fe?f.definitions?.subgraphs?.find(Ie=>Ie.id===fe)?.stableKey:null;return de&&g[de]?z+1:z},0):0,R=T+U;return`${C} nodes (${R} hidden) ${k?"[Unsaved]":""}`.trim()},[f,g,k]);y.useEffect(()=>{const C=o.current;if(!C)return;const T=()=>{const U=C.getBoundingClientRect();document.documentElement.style.setProperty("--top-bar-offset",`${U.height}px`)};T();const V=new ResizeObserver(T);return V.observe(C),()=>V.disconnect()},[]);const S=y.useMemo(()=>{switch(n){case"queue":return"Queue";case"outputs":return w==="output"?"Outputs":"Inputs";default:return p?p.replace(".json",""):f?"Untitled":"ComfyUI Mobile"}},[n,w,p,f]),j=y.useMemo(()=>{switch(n){case"queue":return u.jsx($2,{});case"outputs":return u.jsx(q2,{});default:return u.jsx(X2,{})}},[n]);return u.jsxs("div",{id:"top-bar-root",ref:o,className:"fixed top-0 left-0 right-0 bg-white border-b border-gray-200 z-[2000] safe-area-top","data-top-bar":"true",children:[u.jsxs("div",{id:"top-bar-content",className:"flex items-center justify-between px-4 py-3",children:[u.jsx(Z2,{onClick:()=>i(!0)}),u.jsx(J2,{title:S,mode:n,isDirty:!!k,hasWorkflow:!!f,nodeCountLabel:N,historyLength:x.length,pendingLength:b.length,onTap:c}),u.jsx("div",{id:"top-bar-right-slot",className:"w-10 h-10 flex items-center justify-center",children:j})]}),u.jsx(V2,{open:l,onClose:()=>i(!1)})]})}function nS(){const n=ae(k=>k.setMobileLayout),o=ae(k=>k.mobileLayout),s=ae(k=>k.prepareRepositionScrollTarget),[l,i]=y.useState(!1),[c,f]=y.useState(null),[m,p]=y.useState(null),g=y.useCallback((k,N)=>{const S=(j,C)=>{for(const T of j){if(T.type==="group"){if(T.id===k&&C===N)return T.stableKey;const V=S(o.groups[T.stableKey]??[],C);if(V)return V;continue}if(T.type==="subgraph"){const V=S(o.subgraphs[T.id]??[],T.id);if(V)return V}}return null};return S(o.root,null)},[o]),b=y.useCallback(k=>{let N;if(k.type==="node")N=`[data-reposition-item="node-${k.id}"]`;else if(k.type==="group"){const j=g(k.id,k.subgraphId??null);if(!j)return;N=`[data-reposition-item="group-${j}"]`}else N=`[data-reposition-item="subgraph-${k.id}"]`;const S=document.querySelector(N);p(S?{viewportTop:S.getBoundingClientRect().top}:null),f(k),i(!0)},[g]),x=y.useCallback((k,N,S)=>{n(k),i(!1),f(null),p(null),s(N),requestAnimationFrame(()=>{requestAnimationFrame(()=>{let j;if(N.type==="node")j=`[data-reposition-item="node-${N.id}"]`;else if(N.type==="group"){const C=g(N.id,N.subgraphId??null);if(!C)return;j=`[data-reposition-item="group-${C}"]`}else j=`[data-reposition-item="subgraph-${N.id}"]`;if(j){const C=document.querySelector(j);if(!C)return;if(S){const T=document.querySelector('[data-node-list="true"]');if(T){const U=C.getBoundingClientRect().top-S.viewportTop;Math.abs(U)>.5&&(T.scrollTop+=U);return}}C.scrollIntoView({behavior:"auto",block:"center"})}})})},[s,g,n]),w=y.useCallback(()=>{i(!1),f(null),p(null)},[]);return{overlayOpen:l,initialTarget:c,initialViewportAnchor:m,openOverlay:b,commitAndClose:x,cancelOverlay:w}}function ba(n){const o=n.replace("#","").trim();return/^[0-9a-f]{3}$/i.test(o)?`#${o.replace(/(.)/g,"$1$1").toLowerCase()}`:/^[0-9a-f]{6}$/i.test(o)?`#${o.toLowerCase()}`:null}function vb(n){if(typeof document>"u"||!document.body)return null;const o=document.createElement("span");o.style.color=n,document.body.appendChild(o);const s=getComputedStyle(o).color;document.body.removeChild(o);const l=s.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)/i);if(!l)return null;const[,i,c,f]=l.map(Number);return[i,c,f].some(m=>Number.isNaN(m))?null:`#${[i,c,f].map(m=>m.toString(16).padStart(2,"0")).join("")}`}function W0(n,o){const s=new Set,l=n.trim().toLowerCase();if(l&&(s.add(l),o)){const f=o[l.replace(/\s+/g,"")]??o[l];f&&s.add(f)}const i=ba(n);if(i)return s.add(i),[...s];const c=vb(n);return c&&s.add(c),[...s]}function G0(n){const o=ba(n);if(!o)return null;const s=parseInt(o.slice(1,3),16)/255,l=parseInt(o.slice(3,5),16)/255,i=parseInt(o.slice(5,7),16)/255,c=Math.max(s,l,i),f=Math.min(s,l,i),m=c-f;let p=0;m!==0&&(c===s?p=(l-i)/m%6:c===l?p=(i-s)/m+2:p=(s-l)/m+4,p=Math.round(p*60),p<0&&(p+=360));const g=(c+f)/2,b=m===0?0:m/(1-Math.abs(2*g-1));return{h:p,s:b,l:g}}function oS(n,o,s,l={},i={}){const c=(S,j)=>{if(j in S)return!!S[j];const C=i[j];return C?!!S[C]:!!S[j]},f=(S,j,C)=>{if(j in S)return S[j]??C;const T=i[j];return T?S[T]??C:S[j]??C},m=new Map(o.nodes.map(S=>[S.id,S])),p=o.groups??[],g=o.definitions?.subgraphs??[],b=new Map(g.map(S=>[S.id,S])),x=new Map(p.map(S=>[S.id,S])),w=new Map;for(const S of g){const j=new Map;for(const C of S.groups??[])j.set(C.id,C);w.set(S.id,j)}const k=(S,j,C=new Set,T=new Set)=>{let V=0;for(const U of S)if(U.type==="node"){const R=mn({type:"node",nodeId:U.id,subgraphId:j});c(l,R)||(V+=1)}else if(U.type==="hiddenBlock"){const R=n.hiddenBlocks[U.blockId]??[];V+=R.filter(z=>{const L=mn({type:"node",nodeId:z,subgraphId:j});return!c(l,L)}).length}else if(U.type==="group"){if(C.has(U.stableKey))continue;C.add(U.stableKey),V+=k(n.groups[U.stableKey]??[],j,C,T),C.delete(U.stableKey)}else if(U.type==="subgraph"){if(T.has(U.id))continue;T.add(U.id),V+=k(n.subgraphs[U.id]??[],U.id,C,T),T.delete(U.id)}return V},N=(S,j,C,T=new Set,V=new Set)=>{const U=[];for(const R of S){if(R.type==="hiddenBlock"){const ue=n.hiddenBlocks[R.blockId]??[];if(ue.length===0)continue;U.push({type:"hiddenBlock",blockId:R.blockId,nodeIds:ue,count:ue.length});continue}if(R.type==="node"){const ue=mn({type:"node",nodeId:R.id,subgraphId:C});if(c(l,ue))continue;const fe=m.get(R.id);if(!fe)continue;U.push({type:"node",node:fe,groupId:j,subgraphId:C});continue}if(R.type==="group"){if(c(l,R.stableKey)||T.has(R.stableKey))continue;let ue;if(C&&(ue=w.get(C)?.get(R.id)),ue??=x.get(R.id),!ue)for(const je of w.values()){const Me=je.get(R.id);if(Me){ue=Me;break}}if(!ue)continue;const fe=n.groups[R.stableKey]??[],de=f(s,R.stableKey,!1);T.add(R.stableKey);const Ie=de?[]:N(fe,R.id,C,T,V);T.delete(R.stableKey),U.push({type:"group",group:ue,stableKey:R.stableKey,nodeCount:k(fe,C),isCollapsed:de,subgraphId:C,children:Ie});continue}if(c(l,mn({type:"subgraph",subgraphId:R.id}))||V.has(R.id))continue;const z=b.get(R.id);if(!z)continue;const L=n.subgraphs[R.id]??[],$=f(s,mn({type:"subgraph",subgraphId:R.id}),!1);V.add(R.id);const Q=$?[]:N(L,null,R.id,T,V);V.delete(R.id),U.push({type:"subgraph",subgraph:z,nodeCount:k(L,R.id),isCollapsed:$,groupId:j,children:Q})}return U};return N(n.root,null,null)}function Ro(n,o){const s=ba(n);if(!s)return Tt.transparentBlack;const l=s.slice(1),i=parseInt(l.slice(0,2),16),c=parseInt(l.slice(2,4),16),f=parseInt(l.slice(4,6),16);return`rgba(${i}, ${c}, ${f}, ${o})`}function P0({containerKey:n,indexLabel:o,targetKey:s,height:l}){return u.jsx("div",{"data-reposition-placeholder":"true",className:"mb-3",style:{height:`${l}px`}},`placeholder-${n}-${o}-${s}`)}function Y0({containerType:n,containerDataKey:o,dataKey:s,title:l,nodeCount:i,isTarget:c,isCollapsed:f,canToggleCollapse:m,isDragging:p,isDropTarget:g,isHighlighted:b,backgroundColor:x,borderColor:w,headerBackgroundColor:k,onToggleCollapse:N,childrenContent:S}){const j=`${i} node${i!==1?"s":""}${n==="subgraph"?" (subgraph)":""}`;return u.jsxs("div",{"data-container-type":n,className:`rounded-xl mb-3 shadow-md ${p?"overflow-visible":"overflow-hidden"} transition-shadow ${c?"border-blue-500 border-2 ring-2 ring-blue-400":"border"} ${b&&!c?"ring-2 ring-blue-500 transition-all":""} ${g?"ring-2 ring-blue-300 ring-dashed":""}`,style:{backgroundColor:x,borderColor:w,...c?{touchAction:"none"}:{},...c?{animation:p?"none":"node-card-wiggle 180ms ease-in-out infinite alternate"}:{}},"data-reposition-item":s,children:[u.jsxs("div",{"data-reposition-header":o,className:`flex items-center justify-between cursor-pointer gap-1 px-3 py-2 ${f?"rounded-xl":"rounded-t-xl mb-2"}`,style:{backgroundColor:k,borderColor:w},onClick:C=>{m&&(C.stopPropagation(),N())},children:[u.jsx("span",{"data-reposition-handle":s,className:"touch-none w-8 h-8 -ml-2 flex items-center justify-center shrink-0",children:u.jsx(fp,{className:`w-5 h-5 ${c?"text-blue-500":"text-gray-500"}`})}),u.jsx("span",{className:"font-semibold text-gray-900 flex-1 min-w-0 truncate",children:l}),u.jsx("span",{className:"ml-auto text-sm shrink-0 text-gray-500",children:j}),f?u.jsx(gs,{className:`w-6 h-6 shrink-0 ${m?"text-gray-500":"text-gray-500 opacity-50"}`}):u.jsx(to,{className:"w-6 h-6 shrink-0 text-gray-500"})]}),S,!f&&u.jsx("div",{"data-reposition-footer":o,className:`px-3 py-1.5 rounded-b-xl select-none ${m?"cursor-pointer":""}`,style:{backgroundColor:k,borderColor:w},onClick:C=>{m&&(C.stopPropagation(),N())},children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{className:"text-xs flex-1 min-w-0 truncate text-gray-500",children:l}),u.jsxs("div",{className:"ml-auto flex items-center gap-1",children:[u.jsx("span",{className:"text-xs shrink-0 text-gray-500",children:j}),u.jsx(to,{className:`w-6 h-6 shrink-0 rotate-180 ${m?"text-gray-500":"text-gray-500 opacity-50"}`})]})]})})]})}function rS({blockId:n,nodeCount:o}){return u.jsxs("div",{className:"bg-gray-200 rounded-lg px-3 py-2 mb-3 text-sm text-gray-500 text-center","data-reposition-item":`hidden-${n}`,children:[o," hidden node",o!==1?"s":""]},`hidden-${n}`)}function sS({dataKey:n,nodeId:o,displayName:s,isTarget:l,isBypassed:i,isDragging:c,borderClass:f,borderStyle:m,isHighlighted:p}){return u.jsxs("div",{className:`flex min-h-10 items-center gap-1 rounded-xl border-2 px-3 py-1 mb-3 shadow-md select-none ${f} ${i?"bg-purple-200":"bg-white"} ${p&&!l?"ring-2 ring-blue-500 transition-all":""}`,style:l?{...m??{},touchAction:"none",animation:c?"none":"node-card-wiggle 180ms ease-in-out infinite alternate"}:m,"data-reposition-item":n,children:[u.jsx("span",{"data-reposition-handle":n,className:"touch-none flex h-8 w-8 items-center justify-center -ml-2 shrink-0",children:u.jsx(fp,{className:`w-5 h-5 ${l?"text-blue-500":"text-gray-300"}`})}),u.jsx("span",{className:"font-semibold min-w-0 flex-1 truncate text-gray-900",children:s}),u.jsxs("span",{className:"text-xs text-gray-400 shrink-0",children:["#",o]})]},n)}const lS={secondary:"bg-white border border-gray-300 text-gray-700",primary:"bg-blue-600 text-white",danger:"bg-red-600 text-white"};function wb({actions:n,zIndex:o}){return u.jsx("div",{className:"fixed bottom-6 left-0 right-0 flex justify-center gap-4 px-4",style:{zIndex:o,paddingBottom:"env(safe-area-inset-bottom)"},children:n.map(s=>{const l=s.variant??"secondary";return u.jsx("button",{type:"button",className:`px-5 py-2.5 rounded-full text-sm font-medium shadow-lg disabled:opacity-50 disabled:cursor-not-allowed ${lS[l]}`,onClick:s.onClick,disabled:s.disabled,children:s.label},s.key)})})}function aS({nodeId:n,canShowConnectionsToggle:o,connectionHighlightEnabled:s,onToggleConnections:l,connectionMode:i,leftLineCount:c,rightLineCount:f,inputHighlightColor:m,outputHighlightColor:p}){return u.jsx("div",{className:"bg-white border-b border-gray-200",style:{height:"var(--top-bar-offset, 69px)"},children:u.jsxs("div",{className:"h-full px-4 flex items-center justify-between",children:[u.jsx("div",{className:"w-10 h-10"}),u.jsx("h2",{className:"text-lg font-semibold text-gray-900 text-center",children:"Reposition Nodes"}),u.jsx("div",{className:"w-10 h-10 flex items-center justify-center",children:o&&u.jsx("button",{type:"button",className:"w-8 h-8 flex items-center justify-center","aria-label":"Highlight node connections","aria-pressed":s,onClick:l,children:u.jsx(mb,{className:"w-6 h-6 overflow-visible",nodeId:n,connectionHighlightMode:i,leftLineCount:c,rightLineCount:f,inactiveColor:Tt.text.secondary,offLineColor:Tt.text.secondary,inputHighlightColor:m,outputHighlightColor:p})})})]})})}function iS({scrollContainerRef:n,isDragging:o,isPointerArmedForDrag:s,onPointerDown:l,onPointerMove:i,onPointerUp:c,onPointerCancel:f,children:m}){return u.jsx("div",{ref:n,className:"flex-1 overflow-auto px-4 pt-4 pb-40",style:{touchAction:o||s?"none":"pan-y"},onPointerDown:l,onPointerMove:i,onPointerUp:c,onPointerCancel:f,children:m})}function uu(n,o,s){let l=null;const i=(c,f)=>{for(const m of c){if(m.type==="group"){if(m.id===o&&l==null&&(l=m.stableKey),m.id===o&&f===s)return m.stableKey;const p=i(n.groups[m.stableKey]??[],f);if(p)return p;continue}if(m.type==="subgraph"){const p=i(n.subgraphs[m.id]??[],m.id);if(p)return p}}return null};return i(n.root,null)??l}function Sb(n,o){const s=n.groupParents?.[o];if(!s){const l=(i,c)=>{for(const f of i){if(f.type==="group"){if(f.stableKey===o)return c;const m=l(n.groups[f.stableKey]??[],c);if(m!==null)return m;continue}if(f.type==="subgraph"){const m=l(n.subgraphs[f.id]??[],f.id);if(m!==null)return m}}return null};return l(n.root,null)}return s.scope==="subgraph"?s.subgraphId:s.scope==="root"?null:Sb(n,s.groupKey)}function of(n,o){if(n.type==="node")return`node-${n.id}`;if(n.type==="group"){const s=o?uu(o,n.id,n.subgraphId??null):null;return s?`group-${s}`:`group-${mn({type:"group",groupId:n.id,subgraphId:n.subgraphId??null})}`}return`subgraph-${n.id}`}function uS(n){return n.type==="node"?`node-${n.id}`:n.type==="group"?`group-${n.stableKey}`:n.type==="subgraph"?`subgraph-${n.id}`:`hidden-${n.blockId}`}function Zs(n,o){return n.scope!==o.scope?!1:n.scope==="root"?!0:n.scope==="group"&&o.scope==="group"?n.groupKey===o.groupKey:n.scope==="subgraph"&&o.scope==="subgraph"?n.subgraphId===o.subgraphId:!1}function Zi(n){return n.scope==="root"?"root":n.scope==="group"?`group-${n.groupKey}`:`subgraph-${n.subgraphId}`}function cS(n){return{groupKeys:Object.keys(n.groups),subgraphIds:Object.keys(n.subgraphs)}}function Q0(n,o,s){const l=[];return o.forEach((i,c)=>{if(i===s)return;const f=n.querySelector(`[data-reposition-item="${i}"]`);if(!f)return;const m=f.getBoundingClientRect();l.push({idx:c,top:m.top,bottom:m.bottom,height:m.height})}),l}function dS(n,o,s){const l=Math.max(n.top,o.top),i=Math.min(n.bottom,o.bottom);return Math.max(0,i-l)>=n.height*s}function X0(n,o,s,l,i,c){if(!(n.bottom>=o.top&&n.top<=o.bottom))return!1;if(!s||!l)return dS(n,o,c);if(i){const g=n.bottom>s.top+s.height*c,b=n.bottom>l.top+l.height*c;return g&&!b}const m=n.top<l.bottom-l.height*c,p=n.top<s.bottom-s.height*c;return m&&!p}function Z0(n,o,s,l,i){if(n.length===0)return 0;if(o){let f=0;for(const m of n){const p=m.top+m.height*i;if(l>p){f=m.idx+1;continue}break}return f}let c=n.length;for(let f=n.length-1;f>=0;f-=1){const m=n[f],p=m.bottom-m.height*i;if(s<p){c=m.idx;continue}break}return c}const J0=5,Ji=.625,fS=1/6,ey=120,pS=640,hS=350,mS=300,rf=Tt.status.success,sf=Tt.status.warning,gS=Tt.status.danger,eu=Tt.brand.blue500;function yS({mobileLayout:n,initialTarget:o,initialViewportAnchor:s=null,onDone:l,onCancel:i}){const c=ae(le=>le.workflow),f=ae(le=>le.nodeTypes),m=ae(le=>le.executingNodeId),p=ae(le=>le.collapsedItems),g=ae(le=>le.stableKeyByPointer),b=dn(le=>le.nodeErrors),x=y.useCallback(le=>g[le]??le,[g]),[w,k]=y.useState(()=>JSON.parse(JSON.stringify(n))),[N,S]=y.useState(!1),[j,C]=y.useState(o),[T,V]=y.useState(null),[U,R]=y.useState(null),[z,L]=y.useState(!1),$=y.useRef(null),Q=y.useRef(0),ue=y.useRef(0),fe=y.useRef(0),de=y.useRef(!0),Ie=y.useRef(-1),je=y.useRef(null),Me=y.useRef(0),_=y.useRef(0),oe=y.useRef(0),ce=y.useRef(null),Ke=y.useRef(null),Le=y.useRef(null),E=y.useRef(null),A=y.useRef(null),M=y.useRef(null),ee=y.useRef(0),Te=y.useRef(0),qe=y.useRef(!1),ye=y.useRef(!1),Ne=y.useRef(!1),H=y.useRef(null),[Y,D]=y.useState(null),[K,X]=y.useState(()=>{const le={...p??{}};if(o.type==="group"){const se=uu(n,o.id,o.subgraphId??null);se&&(le[se]=!0)}return o.type==="subgraph"&&(le[x(mn({type:"subgraph",subgraphId:o.id}))]=!0),le}),[W,Oe]=y.useState(null),[be,ke]=y.useState(null),J=y.useRef(w);y.useEffect(()=>{J.current=w},[w]);const xe=y.useMemo(()=>of(j,w),[j,w]),I=W===xe,B=y.useMemo(()=>{const le=j.type==="node"?{type:"node",id:j.id}:j.type==="group"?(()=>{const Ze=uu(w,j.id,j.subgraphId??null);return Ze?{type:"group",id:j.id,subgraphId:j.subgraphId??null,stableKey:Ze}:null})():{type:"subgraph",id:j.id};if(!le)return{groupIds:new Set,subgraphIds:new Set};const se=(Ze,Qe)=>Ze.type!==Qe.type?!1:Ze.type==="node"&&Qe.type==="node"?Ze.id===Qe.id:Ze.type==="group"&&Qe.type==="group"?Ze.stableKey===Qe.stableKey:Ze.type==="subgraph"&&Qe.type==="subgraph"?Ze.id===Qe.id:Ze.type==="hiddenBlock"&&Qe.type==="hiddenBlock"?Ze.blockId===Qe.blockId:!1,De=(Ze,Qe,rt)=>{for(const Re of Ze){if(se(Re,le))return{groupIds:new Set(Qe),subgraphIds:new Set(rt)};if(Re.type==="group"){const gt=De(w.groups[Re.stableKey]??[],[...Qe,Re.stableKey],rt);if(gt)return gt}else if(Re.type==="subgraph"){const gt=De(w.subgraphs[Re.id]??[],Qe,[...rt,Re.id]);if(gt)return gt}}return null};return De(w.root,[],[])??{groupIds:new Set,subgraphIds:new Set}},[w,j]),q=y.useMemo(()=>{if(!c||j.type!=="node")return{hasConnections:!1,hasUpstream:!1,hasDownstream:!1,leftLineCount:0,rightLineCount:0,upstreamNodeIds:new Set,downstreamNodeIds:new Set};const le=c.nodes.find(rt=>rt.id===j.id);if(!le)return{hasConnections:!1,hasUpstream:!1,hasDownstream:!1,leftLineCount:0,rightLineCount:0,upstreamNodeIds:new Set,downstreamNodeIds:new Set};const se=new Set;le.inputs.forEach((rt,Re)=>{if(rt.link==null)return;const gt=ll(c,le.id,Re);gt&&se.add(gt.node.id)});const De=new Set;le.outputs.forEach((rt,Re)=>{if(!rt.links||rt.links.length===0)return;const gt=pa(c,le.id,Re);for(const bt of gt)De.add(bt.node.id)}),se.delete(le.id),De.delete(le.id);const Ze=le.inputs.filter(rt=>rt.link!=null).length,Qe=le.outputs.reduce((rt,Re)=>rt+(Re.links?.length??0),0);return{hasConnections:Ze>0||Qe>0,hasUpstream:se.size>0,hasDownstream:De.size>0,leftLineCount:Math.min(3,Ze),rightLineCount:Math.min(3,Qe),upstreamNodeIds:se,downstreamNodeIds:De}},[c,j]),he=y.useMemo(()=>new Map((c?.nodes??[]).map(le=>[le.id,le])),[c]),me=y.useMemo(()=>{const le=new Map;for(const De of c?.groups??[])le.set(De.id,De);const se=new Map;for(const De of c?.definitions?.subgraphs??[]){const Ze=new Map;for(const Qe of De.groups??[])Ze.set(Qe.id,Qe);se.set(De.id,Ze)}return{rootMap:le,bySubgraph:se}},[c]),Se=y.useMemo(()=>{const le=new Map;for(const se of c?.groups??[]){const De=se.stableKey??`legacy-group-root-${se.id}`;le.set(De,se)}for(const se of c?.definitions?.subgraphs??[])for(const De of se.groups??[]){const Ze=De.stableKey??`legacy-group-${se.id}-${De.id}`;le.set(Ze,De)}return le},[c]),F=y.useMemo(()=>new Map((c?.definitions?.subgraphs??[]).map(le=>[le.id,le])),[c]),ie=y.useMemo(()=>{const le=new Map,se=new Set,De=new Set,Ze=(Qe,rt)=>{for(const Re of Qe){if(Re.type==="group"){if(le.set(Re.stableKey,{id:Re.id,subgraphId:rt}),se.has(Re.stableKey))continue;se.add(Re.stableKey),Ze(w.groups[Re.stableKey]??[],rt);continue}if(Re.type==="subgraph"){if(De.has(Re.id))continue;De.add(Re.id),Ze(w.subgraphs[Re.id]??[],Re.id)}}};return Ze(w.root,null),le},[w]);y.useEffect(()=>{const le=of(j,J.current);let se=null;return qe.current?qe.current=!1:requestAnimationFrame(()=>{const De=E.current,Ze=De?.querySelector(`[data-reposition-item="${le}"]`);if(!Ze)return;const Qe=!ye.current;if(Qe&&!Ne.current&&s&&De){const gt=Ze.getBoundingClientRect().top-s.viewportTop;Math.abs(gt)>.5&&(De.scrollTop+=gt),Ne.current=!0,ye.current=!0;return}const rt=Qe?"auto":"smooth";Ze.scrollIntoView({behavior:rt,block:"center"}),ye.current=!0}),se=requestAnimationFrame(()=>{D(le)}),H.current!=null&&window.clearTimeout(H.current),H.current=window.setTimeout(()=>{D(null),H.current=null},1500),()=>{se!=null&&window.cancelAnimationFrame(se),H.current!=null&&window.clearTimeout(H.current)}},[j,s]);const Ae=y.useCallback(le=>{if(le.startsWith("node-")){const se=parseInt(le.slice(5),10);return Number.isFinite(se)?{target:{type:"node",id:se},itemRef:{type:"node",id:se}}:null}if(le.startsWith("group-")){const se=le.slice(6),De=ie.get(se);if(!De)return null;const{id:Ze,subgraphId:Qe}=De;return{target:{type:"group",id:Ze,subgraphId:Qe},itemRef:{type:"group",id:Ze,subgraphId:Qe,stableKey:se}}}if(le.startsWith("subgraph-")){const se=le.slice(9);return{target:{type:"subgraph",id:se},itemRef:{type:"subgraph",id:se}}}return null},[ie]),Ue=y.useCallback(le=>{const De=le.target.closest("[data-reposition-item]")?.dataset.repositionItem??null,rt=le.target.closest("[data-reposition-handle]")?.dataset.repositionHandle??null??(De===xe?xe:null);if(!rt)return;const Re=Ae(rt);if(!Re)return;const gt=sb(w,Re.itemRef);if(!gt)return;if(le.preventDefault(),rt!==xe){const ct=Re.target;if(ct.type==="group"){const jt=uu(w,ct.id,ct.subgraphId??null);if(!jt)return;X(pt=>({...pt,[jt]:!0}))}else if(ct.type==="subgraph"){const jt=ct.id;X(pt=>({...pt,[x(mn({type:"subgraph",subgraphId:jt}))]:!0}))}qe.current=!0,C(Re.target)}const bt=Re.itemRef.type==="node"||Re.itemRef.type==="group",it=bt?cS(w):{groupKeys:[],subgraphIds:[]},xt=new Set,Nt=new Set;if(Re.itemRef.type==="group"){const ct=jt=>{for(const pt of jt){if(pt.type==="group"){xt.has(pt.stableKey)||(xt.add(pt.stableKey),ct(w.groups[pt.stableKey]??[]));continue}pt.type==="subgraph"&&(Nt.has(pt.id)||(Nt.add(pt.id),ct(w.subgraphs[pt.id]??[])))}};xt.add(Re.itemRef.stableKey),ct(w.groups[Re.itemRef.stableKey]??[])}$.current={pointerId:le.pointerId,startX:le.clientX,startY:le.clientY,origIndex:gt.index,containerId:gt.containerId,targetKey:rt,targetRef:Re.itemRef,target:Re.target,allGroupKeys:it.groupKeys,allSubgraphIds:it.subgraphIds,crossContainerEnabled:bt,disallowedGroupKeys:xt,disallowedSubgraphIds:Nt},Q.current=0,Ie.current=gt.index,je.current=gt.containerId,fe.current=le.clientY,de.current=!0,L(!0),E.current&&(E.current.style.touchAction="none")},[w,xe,Ae,x]),Je=y.useCallback((le,se,De,Ze)=>{if(!se.crossContainerEnabled)return se.containerId;let Qe={scope:"root"},rt=1/0;for(const Re of se.allGroupKeys){if(se.targetRef.type==="group"&&se.targetRef.stableKey===Re||se.disallowedGroupKeys.has(Re)||(K[Re]??!1))continue;const gt=`group-${Re}`,bt=le.querySelector(`[data-reposition-item="${gt}"]`);if(!bt)continue;const it=bt.getBoundingClientRect(),xt=bt.querySelector(`[data-reposition-header="${gt}"]`),Nt=bt.querySelector(`[data-reposition-footer="${gt}"]`),ct=xt?.getBoundingClientRect()??null,jt=Nt?.getBoundingClientRect()??null;if(!X0(De,it,ct,jt,Ze,Ji))continue;const pt=it.width*it.height;pt<rt&&(rt=pt,Qe={scope:"group",groupKey:Re})}for(const Re of se.allSubgraphIds){if(se.targetRef.type==="subgraph"&&se.targetRef.id===Re||se.disallowedSubgraphIds.has(Re)||(K[x(mn({type:"subgraph",subgraphId:Re}))]??!1))continue;const gt=le.querySelector(`[data-reposition-item="subgraph-${Re}"]`);if(!gt)continue;const bt=gt.getBoundingClientRect(),it=gt.querySelector(`[data-reposition-header="subgraph-${Re}"]`),xt=gt.querySelector(`[data-reposition-footer="subgraph-${Re}"]`),Nt=it?.getBoundingClientRect()??null,ct=xt?.getBoundingClientRect()??null;if(!X0(De,bt,Nt,ct,Ze,Ji))continue;const jt=bt.width*bt.height;jt<rt&&(rt=jt,Qe={scope:"subgraph",subgraphId:Re})}return Qe},[K,x]),Pe=y.useCallback((le,se,De,Ze,Qe)=>{const Re=Iw(w,De).map(uS);if(Zs(De,se.containerId)){const it=Re.filter(ct=>ct!==se.targetKey),xt=Q0(le,it),Nt=Z0(xt,Qe,Ze.top,Ze.bottom,Ji);return Nt<=se.origIndex?Nt:Nt+1}const bt=Q0(le,Re);return Z0(bt,Qe,Ze.top,Ze.bottom,Ji)},[w]),st=y.useCallback((le,se,De,Ze)=>{ke(Qe=>{const rt={targetKey:le.targetKey,sourceContainer:le.containerId,sourceIndex:le.origIndex,hoverContainer:se,insertIndex:De,placeholderHeight:Ze};return Qe&&Qe.targetKey===rt.targetKey&&Zs(Qe.sourceContainer,rt.sourceContainer)&&Qe.sourceIndex===rt.sourceIndex&&Zs(Qe.hoverContainer,rt.hoverContainer)&&Qe.insertIndex===rt.insertIndex&&Qe.placeholderHeight===rt.placeholderHeight?Qe:rt})},[]),$e=y.useCallback(()=>{A.current!=null&&(window.cancelAnimationFrame(A.current),A.current=null),M.current=null,ee.current=0,Te.current=0},[]),Fe=y.useCallback(le=>{if(!E.current)return;const De=performance.now();if(M.current!==le&&(M.current=le,ee.current=De,Te.current=De),A.current!=null)return;const Ze=Qe=>{const rt=E.current,Re=M.current;if(!rt||Re==null||!$.current||!N){A.current=null;return}const gt=Te.current||Qe,bt=Math.max(0,Qe-gt);Te.current=Qe;const it=Math.max(0,Qe-ee.current-hS),xt=Math.min(1,it/mS),ct=(ey+(pS-ey)*xt)*bt/1e3,jt=rt.scrollTop,pt=Math.max(0,rt.scrollHeight-rt.clientHeight),At=Math.max(0,Math.min(pt,jt+Re*ct));if(rt.scrollTop=At,At===jt){A.current=null;return}A.current=window.requestAnimationFrame(Ze)};A.current=window.requestAnimationFrame(Ze)},[N]),at=y.useCallback(le=>{const se=$.current;if(!se||le.pointerId!==se.pointerId)return;const De=le.clientY-se.startY,Ze=le.clientX-se.startX;if(!N){if(Math.abs(Ze)>Math.abs(De)&&Math.abs(Ze)>J0){$.current=null,$e(),L(!1),E.current&&(E.current.style.touchAction="");return}if(Math.abs(De)<J0)return;S(!0);const cn=E.current;if(cn){const P=cn.querySelector(`[data-reposition-item="${se.targetKey}"]`);if(P){const Ee=P.getBoundingClientRect();Me.current=Ee.top,_.current=Ee.left,oe.current=P.offsetHeight||Ee.height,P.style.position="fixed",P.style.top=`${Ee.top}px`,P.style.left=`${Ee.left}px`,P.style.width=`${Ee.width}px`,P.style.zIndex="70",P.style.pointerEvents="none",ke({targetKey:se.targetKey,sourceContainer:se.containerId,sourceIndex:se.origIndex,hoverContainer:se.containerId,insertIndex:se.origIndex,placeholderHeight:oe.current})}}try{E.current?.setPointerCapture(le.pointerId)}catch{}fe.current=le.clientY,de.current=De>=0;return}Q.current=De,ue.current=Ze;const Qe=E.current;if(!Qe)return;const rt=Qe.getBoundingClientRect(),Re=rt.height*fS,gt=rt.top+Re,bt=rt.bottom-Re;le.clientY<=gt?Fe(-1):le.clientY>=bt?Fe(1):$e();const it=Qe.querySelector(`[data-reposition-item="${se.targetKey}"]`);it&&(it.style.top=`${Me.current+De}px`,it.style.left=`${_.current}px`);const xt=it?.getBoundingClientRect();if(!xt)return;const Nt=oe.current||it?.offsetHeight||xt.height,ct=le.clientY-fe.current;ct!==0&&(de.current=ct>0);const jt=de.current;fe.current=le.clientY;const pt=Je(Qe,se,xt,jt);je.current=pt;const At=Zs(pt,se.containerId),tn=pt.scope==="group"?`group-${pt.groupKey}`:pt.scope==="subgraph"?`subgraph-${pt.subgraphId}`:null,In=pt.scope==="group"?K[pt.groupKey]??!1:pt.scope==="subgraph"?K[x(mn({type:"subgraph",subgraphId:pt.subgraphId}))]??!1:!1;tn&&In&&!At?Ke.current!==tn&&(ce.current!=null&&window.clearTimeout(ce.current),Ke.current=tn,ce.current=window.setTimeout(()=>{const cn=je.current;cn&&(cn.scope==="group"?X(P=>({...P,[cn.groupKey]:!1})):cn.scope==="subgraph"&&X(P=>({...P,[x(mn({type:"subgraph",subgraphId:cn.subgraphId}))]:!1})),ce.current=null)},350)):ce.current!=null&&(window.clearTimeout(ce.current),ce.current=null,Ke.current=null),V(!At&&pt.scope==="group"?pt.groupKey:null),R(!At&&pt.scope==="subgraph"?pt.subgraphId:null),Ie.current=Pe(Qe,se,pt,xt,jt),st(se,pt,Ie.current,Nt)},[N,Je,Pe,st,K,x,Fe,$e]),ht=y.useCallback(()=>{const le=E.current;if(!le)return;le.querySelectorAll("[data-reposition-item]").forEach(De=>{De.style.transform="",De.style.zIndex="",De.style.position="",De.style.top="",De.style.left="",De.style.width="",De.style.pointerEvents="",De.style.transition="",De.style.marginTop=""})},[]),Lt=y.useCallback(le=>{const se=$.current;if(se&&le.pointerId===se.pointerId){if(N){$e();try{E.current?.releasePointerCapture(le.pointerId)}catch{}ht(),ce.current!=null&&(window.clearTimeout(ce.current),ce.current=null),Ke.current=null;const De=je.current??se.containerId,Ze=Ie.current;if(!Zs(De,se.containerId)||Ze!==se.origIndex){const rt=Ew(w,se.targetRef,se.containerId,se.origIndex,De,Ze);if(k(rt),se.target.type==="group"&&se.targetRef.type==="group"){const Re=Sb(rt,se.targetRef.stableKey),gt={type:"group",id:se.target.id,subgraphId:Re};qe.current=!0,C(gt),Le.current=gt}else Le.current=se.target}S(!1),V(null),R(null),ke(null)}$.current=null,$e(),Q.current=0,ue.current=0,Ie.current=-1,je.current=null,Me.current=0,_.current=0,oe.current=0,fe.current=0,de.current=!0,L(!1),E.current&&(E.current.style.touchAction="")}},[N,w,ht,$e]),Gt=y.useCallback(le=>{if($.current){if(N){$e();try{E.current?.releasePointerCapture(le.pointerId)}catch{}ht(),ce.current!=null&&(window.clearTimeout(ce.current),ce.current=null),Ke.current=null,S(!1),V(null),R(null),ke(null)}$.current=null,$e(),Q.current=0,ue.current=0,Ie.current=-1,je.current=null,Me.current=0,_.current=0,oe.current=0,fe.current=0,de.current=!0,L(!1),E.current&&(E.current.style.touchAction="")}},[N,ht,$e]);y.useEffect(()=>()=>{$e(),ce.current!=null&&window.clearTimeout(ce.current)},[$e]);const Pt=()=>{const le=Le.current??j,se=E.current?.querySelector(`[data-reposition-item="${of(le,w)}"]`),De=se?{viewportTop:se.getBoundingClientRect().top}:null;l(w,le,De)},$t=le=>{X(se=>{const De=se[le]??!1;return{...se,[le]:!De}})},Ge=le=>{const se=x(mn({type:"subgraph",subgraphId:le}));X(De=>{const Ze=De[se]??!1;return{...De,[se]:!Ze}})},He=le=>{const se=he.get(le);return se?(typeof se.title=="string"&&se.title.trim()?se.title.trim():null)||f?.[se.type]?.display_name||se.type:`Node #${le}`},Ve=le=>{if(xe===`node-${le}`)return"";const se=he.get(le);return se?b[String(le)]?.length>0?"border-red-700 shadow-red-200":m===String(le)?"border-green-500 shadow-green-200":se.mode===4?"border-purple-300":"border-transparent":"border-transparent"},et=le=>he.get(le)?.mode===4;function ft(le){let se=0;for(const De of le)De.type==="node"?se+=1:De.type==="hiddenBlock"?se+=w.hiddenBlocks[De.blockId]?.length??0:De.type==="group"?se+=ft(w.groups[De.stableKey]??[]):De.type==="subgraph"&&(se+=ft(w.subgraphs[De.id]??[]));return se}const St=(le,se)=>{const De=[],Ze=be!=null&&Zs(se,be.hoverContainer);let Qe=-1;Ze&&be&&(Qe=be.insertIndex,Qe<0&&(Qe=0),Qe>le.length&&(Qe=le.length));const rt=Re=>{!Ze||!be||Qe===Re&&De.push(u.jsx(P0,{containerKey:Zi(se),indexLabel:String(Re),targetKey:be.targetKey,height:be.placeholderHeight},`placeholder-${Zi(se)}-${Re}-${be.targetKey}`))};return le.forEach((Re,gt)=>{if(rt(gt),Re.type==="hiddenBlock"){const bt=w.hiddenBlocks[Re.blockId]??[];De.push(u.jsx(rS,{blockId:Re.blockId,nodeCount:bt.length},`hidden-${Re.blockId}`));return}if(Re.type==="node"){const bt=`node-${Re.id}`,it=bt===xe,xt=et(Re.id),Nt=I&&q.hasConnections,ct=Nt&&q.upstreamNodeIds.has(Re.id),jt=Nt&&q.downstreamNodeIds.has(Re.id),pt=it?"border-blue-500 ring-2 ring-blue-400":ct||jt?"":Ve(Re.id),At={},tn="7px";Nt&&(it?(At.borderTopColor=eu,At.borderBottomColor=eu,At.borderLeftColor=q.hasUpstream?rf:eu,At.borderRightColor=q.hasDownstream?sf:eu,q.hasUpstream&&(At.borderLeftWidth=tn),q.hasDownstream&&(At.borderRightWidth=tn)):(ct||jt)&&(At.borderColor=gS,ct&&(At.borderRightColor=rf,At.borderRightWidth=tn),jt&&(At.borderLeftColor=sf,At.borderLeftWidth=tn))),De.push(u.jsx(sS,{dataKey:bt,nodeId:Re.id,displayName:He(Re.id),isTarget:it,isBypassed:xt,isDragging:N,borderClass:pt,borderStyle:Object.keys(At).length>0?At:void 0,isHighlighted:Y===bt},bt));return}if(Re.type==="group"){const bt=ie.get(Re.stableKey),it=Se.get(Re.stableKey)??(bt?.subgraphId==null?me.rootMap.get(Re.id):me.bySubgraph.get(bt.subgraphId)?.get(Re.id));if(!it)return null;const xt=`group-${Re.stableKey}`,Nt=xt===xe,ct=K[Re.stableKey]??!1,jt=B.groupIds.has(Re.stableKey),pt=!Nt&&!jt,At=Ro(it.color,.15),tn=Nt?void 0:Ro(it.color,.4),In=it.title?.trim()||`Group ${Re.id}`,cn=w.groups[Re.stableKey]??[],P=ft(cn),Ee=T===Re.stableKey;De.push(u.jsx(Y0,{containerType:"group",containerDataKey:xt,dataKey:xt,title:In,nodeCount:P,isTarget:Nt,isCollapsed:ct,canToggleCollapse:pt,isDragging:N,isDropTarget:Ee,isHighlighted:Y===xt,backgroundColor:At,borderColor:tn,headerBackgroundColor:Ro(it.color,.22),onToggleCollapse:()=>$t(Re.stableKey),childrenContent:!ct&&cn.length>0?u.jsx("div",{className:"px-1",children:St(cn,{scope:"group",groupKey:Re.stableKey})}):null},xt));return}if(Re.type==="subgraph"){const bt=F.get(Re.id);if(!bt)return null;const it=`subgraph-${Re.id}`,xt=it===xe,Nt=K[x(mn({type:"subgraph",subgraphId:Re.id}))]??!1,ct=B.subgraphIds.has(Re.id),jt=!xt&&!ct,pt=bt.name||bt.id,At=w.subgraphs[Re.id]??[],tn=ft(At),In=U===Re.id;De.push(u.jsx(Y0,{containerType:"subgraph",containerDataKey:`subgraph-${Re.id}`,dataKey:it,title:pt,nodeCount:tn,isTarget:xt,isCollapsed:Nt,canToggleCollapse:jt,isDragging:N,isDropTarget:In,isHighlighted:Y===it,backgroundColor:Tt.brand.subgraphBackground08,borderColor:xt?void 0:Tt.brand.subgraphBorder25,headerBackgroundColor:Tt.brand.subgraphBackground14,onToggleCollapse:()=>Ge(Re.id),childrenContent:!Nt&&At.length>0?u.jsx("div",{className:"px-1",children:St(At,{scope:"subgraph",subgraphId:Re.id})}):null},it));return}}),Ze&&be&&Qe===le.length&&De.push(u.jsx(P0,{containerKey:Zi(se),indexLabel:"end",targetKey:be.targetKey,height:be.placeholderHeight},`placeholder-${Zi(se)}-end-${be.targetKey}`)),De},zt=y.useRef(null);return y.useEffect(()=>{const le=zt.current;if(!le)return;const se=De=>De.stopPropagation();return le.addEventListener("touchstart",se,!0),le.addEventListener("touchmove",se,!0),le.addEventListener("touchend",se,!0),le.addEventListener("touchcancel",se,!0),()=>{le.removeEventListener("touchstart",se,!0),le.removeEventListener("touchmove",se,!0),le.removeEventListener("touchend",se,!0),le.removeEventListener("touchcancel",se,!0)}},[]),En.createPortal(u.jsxs("div",{ref:zt,className:"fixed inset-0 z-[2300] bg-gray-100 flex flex-col",children:[u.jsx(aS,{nodeId:j.type==="node"?j.id:0,canShowConnectionsToggle:j.type==="node"&&q.hasConnections,connectionHighlightEnabled:I,onToggleConnections:()=>Oe(le=>le===xe?null:xe),connectionMode:I?q.hasUpstream&&q.hasDownstream?"both":q.hasUpstream?"inputs":"outputs":"off",leftLineCount:q.leftLineCount,rightLineCount:q.rightLineCount,inputHighlightColor:rf,outputHighlightColor:sf}),u.jsxs(iS,{scrollContainerRef:E,isDragging:N,isPointerArmedForDrag:z,onPointerDown:Ue,onPointerMove:at,onPointerUp:Lt,onPointerCancel:Gt,children:[St(w.root,{scope:"root"}),u.jsx("div",{"data-reposition-footer":"root",className:"h-10"})]}),u.jsx(wb,{zIndex:2301,actions:[{key:"cancel",label:"Cancel",onClick:i,variant:"secondary"},{key:"done",label:"Done",onClick:Pt,variant:"primary"}]})]}),document.body)}function _f(n,o,s){const l=s?.parentHidden??!1,i=s?.parentSubgraphId??null,c=s?.visitedGroups??new Set,f=s?.visitedSubgraphs??new Set,m=s?.hiddenNodeKeys??new Set,p=s?.hiddenGroupKeys??new Set,g=s?.hiddenSubgraphIds??new Set,{layout:b,hiddenItems:x,stableKeyByPointer:w}=o,k=(S,j)=>{if(j in S)return!!S[j];const C=w[j];return C?!!S[C]:!!S[j]};let N=0;for(const S of n){if(S.type==="node"){const V=mn({type:"node",nodeId:S.id,subgraphId:i});(l||k(x,V))&&(N+=1),k(x,V)&&m.add(V);continue}if(S.type==="hiddenBlock"){const V=b.hiddenBlocks[S.blockId]??[];for(const U of V){const R=mn({type:"node",nodeId:U,subgraphId:i});(l||k(x,R))&&(N+=1),k(x,R)&&m.add(R)}continue}if(S.type==="group"){if(c.has(S.stableKey))continue;const V=l||k(x,S.stableKey);k(x,S.stableKey)&&p.add(S.stableKey),c.add(S.stableKey);const U=_f(b.groups[S.stableKey]??[],o,{parentHidden:V,parentSubgraphId:i,visitedGroups:c,visitedSubgraphs:f,hiddenNodeKeys:m,hiddenGroupKeys:p,hiddenSubgraphIds:g});N+=U.hiddenNodeCount,c.delete(S.stableKey);continue}if(f.has(S.id))continue;const j=mn({type:"subgraph",subgraphId:S.id}),C=l||k(x,j);k(x,j)&&g.add(S.id),f.add(S.id);const T=_f(b.subgraphs[S.id]??[],o,{parentHidden:C,parentSubgraphId:S.id,visitedGroups:c,visitedSubgraphs:f,hiddenNodeKeys:m,hiddenGroupKeys:p,hiddenSubgraphIds:g});N+=T.hiddenNodeCount,f.delete(S.id)}return{hiddenNodeKeys:m,hiddenGroupKeys:p,hiddenSubgraphIds:g,hiddenNodeCount:N}}function Ma({workflow:n,runKey:o,isRunning:s,workflowDurationStats:l}){const[i,c]=y.useState(null),f=y.useRef(null),m=y.useRef(null),p=y.useRef(null),g=y.useRef(null),b=y.useRef(null),x=y.useRef(0),w=y.useRef(null);return y.useEffect(()=>{let k=null,N=null;const S=()=>{if(!n){w.current!==null&&(w.current=null,c(null)),p.current=null,g.current=null,b.current=null,f.current=null,x.current=0,m.current=null;return}const j=250,C=Date.now();let T=null;if(!o)m.current?(p.current=C+j,m.current=null,x.current=100,T=100):p.current&&C<p.current?T=100:(p.current=null,g.current=null,b.current=null,f.current=null,x.current=0,T=null);else if(p.current&&C<p.current)g.current=o,T=100;else if(g.current&&C>=(p.current??0)&&(m.current=g.current,g.current=null,f.current=C-j,x.current=0,p.current=null),m.current&&o!==m.current)b.current!==o&&(b.current=o,p.current=C+j,x.current=100),T=100;else{m.current!==o&&(f.current=C,m.current=o,x.current=0,p.current=null);const V=Math.max(0,C-(f.current??C)),U=bu(n),R=l[U]?.avgMs??null;let z;if(R){const $=V/R*100;z=Math.min(99,Math.max(0,$))}else{const $=V/1e3;$<=50?z=$:z=50+($-50)*.5,z=Math.min(90,z)}const L=Math.max(x.current,z);x.current=L,T=Math.round(L)}w.current!==T&&(w.current=T,c(T))};return n?(k=setTimeout(S,0),(s||p.current||o)&&(N=setInterval(S,200))):k=setTimeout(S,0),()=>{k&&clearTimeout(k),N&&clearInterval(N)}},[n,o,s,l]),i}function bS(){const n=ae(f=>f.workflowLoadedAt),[o,s]=y.useState(null),l=o===n,i=y.useCallback(f=>{s(f?n:null)},[n]),c=y.useCallback(()=>{s(null)},[]);return{errorPopoverOpen:l,setErrorPopoverOpen:i,resetErrorPopover:c}}const xS=new Set(["mp4","webm","mkv","mov","avi","m4v"]);function Oa(n){const o=n.split(".").pop()?.toLowerCase()??"";return xS.has(o)?"video":"image"}function el(n){return Oa(n)==="video"}function mp({open:n,buttonRef:o,menuRef:s,repositionToken:l,menuWidth:i=176,horizontalAnchorOffset:c=160,viewportPadding:f=8,bottomBarReserve:m=104}){const[p,g]=y.useState(null),b=y.useCallback(()=>{g(null)},[]);return y.useLayoutEffect(()=>{if(!n)return;const x=()=>{const N=o.current,S=s.current;if(!N||!S)return;const j=N.getBoundingClientRect(),C=S.getBoundingClientRect().height,T=j.bottom,V=j.top-C,U=window.innerHeight-m,R=T+C<=U,z=V>=f,$=Math.max(f,Math.min(R?T:z?V:T,U-C)),Q=Math.max(f,Math.min(j.right-c,window.innerWidth-i-f));g({top:$,left:Q})};x();const w=requestAnimationFrame(x),k=requestAnimationFrame(x);return window.addEventListener("resize",x),()=>{cancelAnimationFrame(w),cancelAnimationFrame(k),window.removeEventListener("resize",x)}},[n,o,s,i,c,f,m,l]),{menuPosition:p,menuStyle:{top:p?.top??-9999,left:p?.left??-9999,visibility:p?"visible":"hidden"},resetMenuPosition:b}}function vS({nodeId:n,nodeStableKey:o,isBypassed:s,onEditLabel:l,pinnableWidgets:i,singlePinnableWidget:c,isSingleWidgetPinned:f,hasPinnedWidget:m,toggleWidgetPin:p,setPinnedWidget:g,isNodeBookmarked:b,canAddNodeBookmark:x,onToggleNodeBookmark:w,toggleBypass:k,setItemHidden:N,onDeleteNode:S,onMoveNode:j,connectionHighlightMode:C,setConnectionHighlightMode:T,leftLineCount:V,rightLineCount:U}){const[R,z]=y.useState(!1),[L,$]=y.useState(!1),Q=y.useRef(null),ue=y.useRef(null),fe=()=>{z(!1),$(!1),Ie()},{menuStyle:de,resetMenuPosition:Ie}=mp({open:R,buttonRef:ue,menuRef:Q,repositionToken:L});cl({open:R,onDismiss:fe,triggerRef:ue,contentRef:Q,ignoreScrollWithinContent:!0});const je=V>0||U>0,Me=ee=>{if(ee.stopPropagation(),!o)return;const Te=V>0,qe=U>0;if(!Te&&!qe)return;const ye=Te&&qe?["off","inputs","outputs","both"]:Te?["off","inputs"]:["off","outputs"],Ne=ye.indexOf(C),H=ye[(Ne+1)%ye.length];T(o,H)},_=ee=>{ee.stopPropagation(),Ie(),z(Te=>!Te)},oe=ee=>{ee.stopPropagation(),l(),fe()},ce=ee=>{ee.stopPropagation(),o&&(k(o),fe())},Ke=ee=>{ee.stopPropagation(),o&&(N(o,!0),fe())},Le=ee=>{ee.stopPropagation(),c&&(p(c.widgetIndex,c.name,c.type,c.options),fe())},E=ee=>{ee.stopPropagation(),g(null),fe()},A=ee=>{ee.stopPropagation(),$(!L)},M=ee=>Te=>{Te.stopPropagation(),g({nodeId:n,widgetIndex:ee.widgetIndex,widgetName:ee.name,widgetType:ee.type,options:ee.options}),fe()};return u.jsxs("div",{className:"flex items-center gap-1 relative",onClick:ee=>ee.stopPropagation(),children:[je&&u.jsx("button",{type:"button",className:"w-8 h-8 flex items-center justify-center","aria-pressed":C!=="off","aria-label":"Highlight connected nodes",onClick:Me,children:u.jsx(mb,{className:"w-6 h-6 overflow-visible",nodeId:n,connectionHighlightMode:C,leftLineCount:V,rightLineCount:U})}),u.jsx(Pr,{onClick:_,buttonRef:ue,ariaLabel:"Node options",buttonSize:8,iconSize:5,icon:b?u.jsx(Gr,{className:"w-5 h-5 text-yellow-500"}):void 0}),R&&En.createPortal(u.jsx("div",{ref:Q,className:"fixed z-[1000] w-44",style:de,children:u.jsx(gr,{items:[{key:"edit-label",label:"Edit Label",icon:u.jsx(cp,{className:"w-4 h-4"}),onClick:oe},{key:"toggle-bookmark",label:b?"Remove bookmark":"Bookmark node",icon:b?u.jsx(_u,{className:"w-4 h-4"}):u.jsx(Gr,{className:"w-4 h-4 text-yellow-500"}),onClick:ee=>{ee.stopPropagation(),w(),fe()},hidden:!(b||x)},{type:"divider",key:"divider-node-actions"},{key:"toggle-bypass",label:s?"Engage node":"Bypass node",icon:u.jsx(Rf,{className:"w-4 h-4",isBypassed:s}),onClick:ce},{key:"hide-node",label:"Hide node",icon:u.jsx(Go,{className:"w-4 h-4"}),onClick:Ke},{key:"move-node",label:"Move",icon:u.jsx(xb,{className:"w-4 h-4"}),onClick:ee=>{ee.stopPropagation(),j(),fe()}},{type:"divider",key:"divider-pin",className:i.length>0?"":"hidden"},{key:"pin-single-widget",label:f?"Remove pin":"Pin widget",icon:f?u.jsx(ya,{className:"w-4 h-4 text-fuchsia-500"}):u.jsx(Af,{className:"w-4 h-4"}),onClick:Le,hidden:!(i.length>0&&c)},{key:"remove-pin",label:"Remove pin",icon:u.jsx(ya,{className:"w-4 h-4 text-fuchsia-500"}),onClick:E,hidden:!(i.length>0&&!c&&m)},{key:"pin-widget-submenu",label:"Pin widget",icon:u.jsx(Af,{className:"w-4 h-4"}),rightSlot:u.jsx(pp,{className:`w-4 h-4 text-gray-400 transition-transform ${L?"rotate-90":""}`}),onClick:A,hidden:!(i.length>0&&!c)},{type:"custom",key:"pin-widget-items",hidden:!(i.length>0&&!c&&L),render:u.jsx("div",{className:"border-t border-gray-100 bg-gray-50 max-h-48 overflow-auto",children:i.map(ee=>u.jsx("button",{className:"w-full text-left px-4 py-2 text-sm hover:bg-gray-100 text-gray-700",onClick:M(ee),children:ee.name},ee.widgetIndex))})},{type:"divider",key:"divider-delete"},{key:"delete-node",label:"Delete node",icon:u.jsx(Bo,{className:"w-4 h-4"}),color:"danger",onClick:ee=>{ee.stopPropagation(),S(),fe()}}]})}),document.body)]})}function wS({nodeId:n,open:o,errors:s,anchorRef:l,onClose:i}){const c=b=>{b.stopPropagation(),i()},[f,m]=y.useState(null),p=y.useRef(null),g=no(b=>b.currentPanel);return y.useEffect(()=>{o&&g!=="workflow"&&i()},[o,g,i]),y.useEffect(()=>{if(!o)return;const b=()=>{const k=l.current;if(!k)return;const N=k.getBoundingClientRect();m({top:N.bottom+8,left:Math.max(16,Math.min(N.left+N.width/2-140,window.innerWidth-296))})};b();const x=k=>{k.target&&(l.current?.contains(k.target)||p.current?.contains(k.target)||i())},w=()=>{i()};return document.addEventListener("pointerdown",x),document.addEventListener("scroll",w,!0),window.addEventListener("resize",b),()=>{document.removeEventListener("pointerdown",x),document.removeEventListener("scroll",w,!0),window.removeEventListener("resize",b)}},[o,n,i,l]),!o||s.length===0||!f?null:En.createPortal(u.jsxs("div",{ref:p,id:`error-popover-${n}`,className:"error-popover-root fixed z-[2000] bg-red-50 border border-red-700 rounded-lg shadow-lg w-72 max-h-64 overflow-hidden",style:{top:f.top,left:f.left},children:[u.jsxs("div",{id:`error-popover-header-${n}`,className:"popover-header flex items-center justify-between px-3 py-2 border-b border-red-200 bg-red-700",children:[u.jsxs("span",{id:`error-popover-title-${n}`,className:"popover-title text-sm font-semibold text-white",children:[s.length," ",s.length===1?"Error":"Errors"]}),u.jsx("button",{type:"button",onClick:c,className:"w-6 h-6 flex items-center justify-center text-red-200 hover:text-white rounded","aria-label":"Close",children:u.jsx(pb,{className:"w-4 h-4"})})]}),u.jsx("div",{id:`error-popover-body-${n}`,className:"popover-body p-3 space-y-2 bg-red-100",children:s.map((b,x)=>{const w=b.details?.toLowerCase().replace(/[_\s]/g,"")||"",k=b.inputName?.toLowerCase().replace(/[_\s]/g,"")||"",N=!b.details||b.details===b.message||b.inputName&&w===k;return u.jsxs("div",{className:"error-item flex items-start gap-2 text-sm",children:[u.jsx("span",{className:"error-dot mt-1.5 h-1.5 w-1.5 rounded-full bg-red-700 shrink-0","aria-hidden":"true"}),u.jsxs("div",{className:"error-content-wrapper min-w-0",children:[b.inputName&&u.jsx("div",{className:"error-input-name font-medium text-red-800 mb-0.5",children:b.inputName}),u.jsx("div",{className:"error-message-text text-red-800",children:b.message}),!N&&u.jsx("div",{className:"error-details-text text-xs text-red-700 mt-0.5 break-words",children:b.details})]})]},x)})})]}),document.body)}function SS({noteText:n,noteLinkified:o,noteWidgetIndex:s,isEditingNote:l,setIsEditingNote:i,onUpdateNote:c,noteTextareaRef:f,onNoteTap:m}){const p=b=>{s!==null&&c(b)},g=b=>{s!==null&&c(b.target.value)};return u.jsxs("div",{className:"mb-3 group","data-textarea-root":"true",children:[u.jsxs("div",{className:"flex items-center justify-between mb-1.5","data-textarea-header":"true",children:[u.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Note"}),l&&u.jsx(ca,{value:n,onChange:p,textareaRef:f,className:"opacity-70 transition-opacity group-focus-within:opacity-100"})]}),l?u.jsx("textarea",{ref:f,value:n,onChange:g,onBlur:()=>i(!1),className:"w-full p-3 border rounded-lg text-base resize-none note-display",rows:Math.min(8,Math.max(3,n.split(`
`).length))}):u.jsx("div",{className:"w-full p-3 border rounded-lg text-base whitespace-pre-wrap break-words note-display",onDoubleClick:()=>i(!0),onTouchEnd:m,children:o})]})}function NS({show:n,previewImage:o,displayName:s,onImageClick:l,isExecuting:i,overallProgress:c,displayNodeProgress:f}){return!n||!o?null:u.jsxs("div",{className:"mb-3",children:[u.jsx("div",{className:"text-xs text-gray-500 mb-1.5 uppercase tracking-wide",children:"Output Preview"}),u.jsxs("div",{className:"relative",children:[u.jsx("img",{src:mo(o.filename,o.subfolder,o.type),alt:`${s} output`,className:"w-full h-auto rounded-lg border border-gray-100",loading:"lazy",onClick:l},"preview"),i&&c!==null&&u.jsx("div",{className:"absolute inset-0 bg-black/40 rounded-lg flex items-end p-3",children:u.jsxs("div",{className:"w-full",children:[u.jsxs("div",{className:"flex items-center justify-between text-xs text-white/90 mb-1",children:[u.jsx("span",{children:"Progress"}),u.jsxs("span",{children:[f,"%"]})]}),u.jsx("div",{className:"h-2 rounded-full bg-white/30 overflow-hidden",children:u.jsx("div",{className:"h-full bg-green-500 transition-none",style:{width:`${Math.min(100,Math.max(0,f))}%`}})}),u.jsxs("div",{className:"flex items-center justify-between text-xs text-white/90 mt-2 mb-1",children:[u.jsx("span",{children:"Overall"}),u.jsxs("span",{children:[c,"%"]})]}),u.jsx("div",{className:"h-2 rounded-full bg-white/30 overflow-hidden",children:u.jsx("div",{className:"h-full bg-blue-500 transition-none",style:{width:`${Math.min(100,Math.max(0,c))}%`}})})]})})]})]})}function CS({nodeId:n,displayName:o,isEditingLabel:s,labelValue:l,labelInputRef:i,onLabelChange:c,onLabelBlur:f,isCollapsed:m,isBypassed:p,isExecuting:g,overallProgress:b,hasErrors:x,errorIconRef:w,errorPopoverOpen:k,setErrorPopoverOpen:N,toggleNodeFold:S,rightSlot:j}){const C=()=>{s||S()},T=U=>{U.stopPropagation(),S()},V=U=>{U.stopPropagation(),N(!k)};return u.jsxs("div",{id:`node-header-${n}`,className:`node-header flex items-center justify-between cursor-pointer gap-3 ${m?"":"mb-3 pb-2 border-b"} ${p?`bg-purple-200 border-purple-300 px-3 -mx-3 -mt-1 pt-1 rounded-t-xl ${m?"pb-1 -mb-1 rounded-b-xl":""}`:m?"":"border-gray-100"}`,onClick:C,children:[u.jsxs("div",{id:`node-title-container-${n}`,className:"flex items-center gap-1 min-w-0",children:[u.jsx("button",{onClick:T,className:"w-8 h-8 -ml-2 flex items-center justify-center text-gray-400 hover:text-gray-600 shrink-0",children:m?u.jsx(gs,{className:"w-6 h-6"}):u.jsx(to,{className:"w-6 h-6"})}),s?u.jsx("input",{ref:i,value:l,onChange:U=>c(U.target.value),onBlur:f,onKeyDown:U=>{(U.key==="Enter"||U.key==="Escape")&&U.currentTarget.blur()},onClick:U=>U.stopPropagation(),className:"font-semibold text-gray-900 flex-1 min-w-0 text-sm bg-white border border-gray-200 rounded px-2 py-1"}):u.jsx("h3",{id:`node-display-name-${n}`,className:`font-semibold text-gray-900 select-none flex-1 min-w-0 ${m?"whitespace-nowrap overflow-hidden text-ellipsis":"whitespace-normal break-words"}`,children:o}),u.jsxs("span",{id:`node-id-badge-${n}`,className:"text-xs text-gray-400 min-w-[2ch] text-right",children:["#",n]}),x&&u.jsx("button",{ref:w,type:"button",onClick:V,className:"w-5 h-5 flex items-center justify-center text-red-500 hover:text-red-600 shrink-0","aria-label":"View errors",children:u.jsx(hb,{className:"w-4 h-4"})}),g&&m&&b!==null?u.jsxs("div",{id:`node-progress-indicator-${n}`,className:"relative w-6 h-6 flex items-center justify-center",children:[u.jsx(j2,{className:"absolute",width:"24",height:"24",style:{transform:"rotate(-90deg)"},progress:b,radius:10}),u.jsx("span",{id:`node-progress-text-${n}`,className:"text-[8px] font-bold text-blue-600",children:b})]}):null,g&&!m?u.jsx("span",{id:`node-executing-pulse-${n}`,className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}):null]}),u.jsx("div",{id:`node-header-right-slot-${n}`,className:"header-right-slot",children:j})]})}function kS({nodeId:n,displayName:o,hasConnections:s,onCancel:l,onDelete:i}){const c=[s?{label:"Delete & Reconnect",onClick:()=>i(!0),className:"w-full px-4 py-2.5 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700 active:bg-red-800"}:null,{label:s?"Delete & Disconnect":"Delete",onClick:()=>i(!1),className:s?"w-full px-4 py-2.5 text-sm font-medium text-red-700 bg-red-50 rounded-lg hover:bg-red-100 active:bg-red-200":"w-full px-4 py-2.5 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700 active:bg-red-800"},{label:"Cancel",onClick:l,className:"w-full px-4 py-2.5 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 active:bg-gray-300"}].filter(f=>f!==null);return En.createPortal(u.jsx(Po,{onClose:l,title:"Delete node",description:u.jsxs(u.Fragment,{children:["Delete ",u.jsx("span",{className:"font-medium text-gray-700",children:o})," (#",n,")?"]}),actionsLayout:"stack",actions:c}),document.body)}function jS({label:n}){return u.jsx("div",{className:"absolute -top-6 left-1/2 -translate-x-1/2 z-[100] animate-in fade-in slide-in-from-bottom-2 duration-200",children:u.jsx("div",{className:"bg-red-600 text-white text-[10px] font-black px-2 py-0.5 rounded-full shadow-lg whitespace-nowrap uppercase tracking-tighter ring-2 ring-white",children:n})})}function Wo(n){return n.toLowerCase().replace(/[_-]+/g," ").replace(/\s+/g," ").trim()}function Df(n,o){if(!n.trim())return!0;const s=Wo(o);return Wo(n).split(" ").filter(Boolean).every(l=>s.includes(l))}function wu(n,o){if(!n)return!0;let s=0;for(const l of o)if(l===n[s]&&(s+=1),s>=n.length)return!0;return!1}function Ao(n,o){if(!n)return 0;const s=Wo(n),l=Wo(o);return l?l===s?120:l.startsWith(s)?90:l.includes(s)?70:wu(s,l)?40:0:0}function hs(n){return n.replace(/^custom_nodes\./,"").replace(/[._-]+/g," ").replace(/\s+/g," ").trim()}function Nb(n){const o=String(n).split(",")[0].trim().toUpperCase();return["IMAGE","LATENT","MODEL","CLIP","VAE","CONDITIONING","INT","FLOAT","STRING","BOOLEAN","MASK"].includes(o)?`type-${o}`:"type-default"}function lf(n){if(n==null)return null;const o=String(n).trim();if(!o)return null;const s=o.toLowerCase();return s==="null"||s==="undefined"?null:o}function ms(n,o){return lf(n?.display_name)??lf(n?.name)??lf(o)??o}function Bf(n,o,s,l){const i=o.trim(),c=n.map(f=>{const{displayName:m,typeName:p,category:g="",pack:b=""}=s(f),x=`${m} ${p} ${g} ${b}`;if(!(!i||Df(i,x)||wu(Wo(i),Wo(x))))return null;const k=i?Ao(i,m)*10+Ao(i,p)*4:0;return{item:f,score:k}}).filter(f=>f!==null);return c.sort((f,m)=>m.score!==f.score?m.score-f.score:l(f.item)-l(m.item)),c.map(f=>f.item)}function MS({nodeId:n,displayName:o,pack:s,outputName:l,outputType:i,inputName:c,isConnected:f,onSelect:m}){return u.jsx("button",{type:"button",className:`w-full text-left rounded-xl border px-4 py-3 shadow-sm transition ${f?"border-blue-300 bg-white":"border-gray-200 bg-white hover:border-gray-300 active:scale-[0.998]"}`,onClick:m,children:u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsxs("div",{className:"text-sm font-semibold text-gray-900 flex items-center gap-2 min-w-0",children:[u.jsxs("span",{className:"truncate",children:[o," ",u.jsxs("span",{className:"text-gray-400",children:["#",n]})]}),f&&u.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-blue-100 text-blue-700 text-[10px] font-medium shrink-0",children:[u.jsx(Do,{className:"w-3 h-3"}),"Currently connected"]})]}),u.jsx("div",{className:"text-xs text-gray-500 truncate mt-0.5",children:s||"Core"}),u.jsxs("div",{className:"text-xs text-gray-700 mt-1 inline-flex items-center gap-1.5",children:[u.jsx("span",{className:`inline-flex h-5 w-5 items-center justify-center rounded-full text-[11px] font-bold ${Nb(i)}`,children:""}),u.jsxs("span",{className:"truncate",children:[l," -> ",c]})]})]})})}function xa({onClick:n,ariaLabel:o="Close",variant:s="default",buttonSize:l=10,iconSize:i=6,isIdle:c,zIndex:f}){const m=typeof c=="boolean"||typeof f=="number",p=m?"viewer":s;return u.jsx("button",{onClick:n,className:`transition-colors flex items-center justify-center rounded-full ${p==="viewer"?`absolute top-3 right-3 w-${l} h-${l} text-white ${c?"bg-transparent":"bg-black/60"}`:p==="plain"?`w-${l} h-${l} text-gray-500 bg-transparent hover:bg-transparent`:`w-${l} h-${l} bg-gray-100 dark:bg-gray-800 text-gray-500 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700`}`.trim(),style:m&&typeof f=="number"?{zIndex:f}:void 0,"aria-label":o,children:u.jsx(Na,{className:`w-${i} h-${i}`})})}function Cb({isOpen:n,onClose:o,title:s,searchQuery:l,onSearchQueryChange:i,searchPlaceholder:c,onBack:f,backLabel:m="Back",children:p,footer:g,zIndex:b=2200}){return n?En.createPortal(u.jsx("div",{className:"fixed inset-0 bg-gray-400/40 backdrop-blur-sm",style:{zIndex:b},onClick:o,children:u.jsxs("div",{className:"w-full h-full flex flex-col",onClick:x=>x.stopPropagation(),children:[u.jsxs("div",{className:"bg-white border-b border-gray-200 px-4 py-3 flex items-center justify-between safe-area-inset-top",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[f&&u.jsx("button",{type:"button",className:"text-sm text-blue-600 font-medium",onClick:f,children:m}),u.jsx("h2",{className:"text-base font-semibold text-gray-900",children:s})]}),u.jsx(xa,{onClick:o,variant:"plain",buttonSize:8,iconSize:5})]}),u.jsx("div",{className:"bg-white px-4 py-2 border-b border-gray-100",children:u.jsx(ja,{value:l,onChange:i,placeholder:c,autoFocus:!0})}),p,g??u.jsx("div",{className:"flex-shrink-0 h-12 bg-white border-t border-gray-200 flex items-center justify-center",children:u.jsx("button",{type:"button",className:"text-sm text-gray-500 font-medium",onClick:o,children:"Cancel"})})]})}),document.body):null}function zf({title:n,subtitle:o,onSelect:s,outputType:l,outputName:i,inputName:c,titleClassName:f="text-sm font-semibold text-gray-900 truncate"}){return u.jsx("button",{type:"button",className:"w-full text-left rounded-xl border border-gray-200 bg-white px-4 py-3 shadow-sm hover:border-gray-300 active:scale-[0.998] transition",onClick:s,children:u.jsxs("div",{className:"min-w-0",children:[u.jsx("div",{className:f,children:n}),u.jsx("div",{className:"text-xs text-gray-500 truncate mt-0.5",children:o||"Core"}),l&&i&&c&&u.jsxs("div",{className:"text-xs text-gray-700 mt-1 inline-flex items-center gap-1.5",children:[u.jsx("span",{className:`inline-flex h-5 w-5 items-center justify-center rounded-full text-[11px] font-bold ${Nb(l)}`,children:""}),u.jsxs("span",{className:"truncate",children:[String(i)," -> ",c]})]})]})})}function aa({query:n,message:o}){return n.trim()?u.jsx("div",{className:"px-4 py-8 text-center text-sm text-gray-500",children:o}):null}function $o(n,o){return`${n}:${o}`}function OS(n,o){if(n.size!==o.size)return!1;for(const s of n)if(!o.has(s))return!1;return!0}function ty(n){const{isOpen:o,onClose:s,nodeId:l,mode:i}=n,c=ae(I=>I.workflow),f=ae(I=>I.nodeTypes),m=ae(I=>I.connectNodes),p=ae(I=>I.disconnectInput),g=ae(I=>I.addNode),b=ae(I=>I.addNodeAndConnect),x=ae(I=>I.scrollToNode),[w,k]=y.useState(""),[N,S]=y.useState("pick"),[j,C]=y.useState(()=>{if(i!=="output"||!c)return new Set;const I=new Set;for(const B of c.links){const[,q,he,me,Se]=B;q===l&&he===n.outputIndex&&I.add($o(me,Se))}return I}),[T,V]=y.useState(!1),[U,R]=y.useState(null),[z,L]=y.useState(new Set),$=y.useMemo(()=>c?c.nodes.find(B=>B.id===l)?.stableKey??null:null,[l,c]),Q=I=>{const B=ae.getState().workflow;return B?B.nodes.find(he=>he.id===I)?.stableKey??null:null},ue=y.useMemo(()=>i!=="input"||!c||!f?[]:vw(c,f,l,n.inputIndex),[i,c,f,l,n]),fe=y.useMemo(()=>{if(i!=="input")return[];const I=w.trim(),B=ue.map(q=>{const{node:he}=q,me=f?.[he.type],Se=he.title,F=typeof Se=="string"&&Se.trim()?Se.trim():me?.display_name||he.type,ie=`${F} ${me?.display_name??""} ${he.type} ${String(he.id)}`;if(!(!I||Df(I,ie)||wu(Wo(I),Wo(ie))))return null;const Ue=Ao(I,F)*4+Ao(I,me?.display_name??"")*3+Ao(I,he.type)*2+Ao(I,String(he.id));return{...q,score:Ue}}).filter(Boolean);return B.sort((q,he)=>he.score-q.score||q.node.id-he.node.id),B},[i,ue,w,f]),de=y.useMemo(()=>i!=="input"||!f?[]:ww(f,n.inputType).map((I,B)=>({...I,index:B})),[i,f,n]),Ie=y.useMemo(()=>i!=="output"||!f?[]:Nw(f,n.outputType).map((I,B)=>({...I,index:B})),[i,f,n]),je=y.useMemo(()=>i!=="input"?[]:Bf(de,w,I=>{const B=ms(I.def,I.typeName),q=ms({display_name:I.def.name,name:I.typeName},I.typeName),he=hs(I.def.python_module||I.def.category?.split("/")[0]||"Core");return{displayName:B,typeName:q,category:String(I.def.category??""),pack:he}},I=>I.index),[i,de,w]),Me=y.useMemo(()=>i!=="output"?[]:Bf(Ie,w,I=>{const B=ms(I.def,I.typeName),q=ms({display_name:I.def.name,name:I.typeName},I.typeName),he=hs(I.def.python_module||I.def.category?.split("/")[0]||"Core");return{displayName:B,typeName:q,category:String(I.def.category??""),pack:he}},I=>I.index),[i,Ie,w]),_=y.useMemo(()=>{if(i!=="output"||!c||!f)return[];const I=Cw(c,l,n.outputIndex),B=new Set;for(const Se of c.links){const[,F,ie,Ae,Ue]=Se;F===l&&ie===n.outputIndex&&B.add($o(Ae,Ue))}const q=w.trim(),me=I.map(({node:Se,inputIndex:F})=>{const ie=f[Se.type],Ae=Se.title,Ue=typeof Ae=="string"&&Ae.trim()?Ae.trim():ie?.display_name||Se.type,Je=hs(String(ie?.python_module??ie?.category?.split("/")[0]??"Core")),Pe=Se.inputs?.[F];if(!Pe)return null;const st=Pe.localized_name||Pe.name||`Input ${F+1}`,$e=String(Pe.type),Fe=$o(Se.id,F),at=B.has(Fe);let ht=!1,Lt=null;const Gt=Pe.link;if(Gt!=null&&!at){const He=c.links.find(Ve=>Ve[0]===Gt);if(He){ht=!0;const[,Ve]=He,et=c.nodes.find(ft=>ft.id===Ve);et&&(Lt=`${f[et.type]?.display_name||et.type} #${et.id}`)}}const Pt=`${Ue} ${ie?.display_name??""} ${Se.type} ${String(Se.id)} ${st}`;if(!(!q||Df(q,Pt)||wu(Wo(q),Wo(Pt))))return null;const Ge=Ao(q,Ue)*4+Ao(q,st)*3+Ao(q,ie?.display_name??"")*2+Ao(q,Se.type)*2+Ao(q,String(Se.id));return{nodeId:Se.id,inputIndex:F,displayName:Ue,pack:Je,inputName:st,inputType:$e,currentlyConnectedFromThisOutput:at,hasExistingLink:ht,existingSourceLabel:Lt,score:Ge}}).filter(Se=>Se!==null);return me.sort((Se,F)=>F.score-Se.score||Se.nodeId-F.nodeId),me},[i,c,f,l,n,w]),oe=y.useMemo(()=>i!=="output"?new Set:new Set(_.filter(I=>I.currentlyConnectedFromThisOutput).map(I=>$o(I.nodeId,I.inputIndex))),[i,_]),ce=y.useMemo(()=>{const I=new Map;for(const B of _)I.set($o(B.nodeId,B.inputIndex),B);return I},[_]),Ke=y.useMemo(()=>{if(i!=="output")return[];const I=new Map;for(const B of _){const q=I.get(B.nodeId);if(q){q.inputs.push(B),B.score>q.score&&(q.score=B.score);continue}I.set(B.nodeId,{nodeId:B.nodeId,displayName:B.displayName,pack:B.pack,score:B.score,inputs:[B]})}return Array.from(I.values()).sort((B,q)=>q.score-B.score||B.nodeId-q.nodeId)},[i,_]),Le=y.useMemo(()=>i!=="output"?!1:!OS(j,oe),[i,j,oe]),E=y.useMemo(()=>{if(i!=="output")return[];const I=[];for(const B of j){if(oe.has(B))continue;const q=ce.get(B);q?.hasExistingLink&&I.push(q)}return I},[i,j,oe,ce]),A=(I,B)=>{if(i!=="input")return;const q=Q(I);!q||!$||(m(q,B,$,n.inputIndex,n.inputType),s(),x(q))},M=()=>{i==="input"&&$&&(p($,n.inputIndex),s())},ee=I=>{if(i!=="input"||!$)return;const B=b(I,$,n.inputIndex);if(s(),B!==null){const q=Q(B);q&&x(q)}},Te=(I,B,q)=>{if(i!=="output"||!$)return;const he=g(I,{nearNodeStableKey:$});if(he===null)return;const me=Q(he);if(!me)return;const F=ae.getState().workflow?.nodes.find(Je=>Je.id===he);if(!F||!$)return;const ie=F.inputs.findIndex(Je=>Je.type.toUpperCase()===q.toUpperCase()),Ae=ie>=0?ie:B,Ue=F.inputs[Ae]?.type;Ue!=null&&(m($,n.outputIndex,me,Ae,Ue),s(),x(me))},qe=(I,B)=>{const q=$o(I,B);C(he=>{const me=new Set(he);return me.has(q)?me.delete(q):me.add(q),me})},ye=I=>{const B=new Set;for(const q of I.inputs){const he=$o(q.nodeId,q.inputIndex);j.has(he)&&B.add(he)}R(I.nodeId),L(B)},Ne=()=>{R(null),L(new Set)},H=I=>{L(B=>{const q=new Set(B);return q.has(I)?q.delete(I):q.add(I),q})},Y=()=>{if(U==null)return;const I=Ke.find(q=>q.nodeId===U);if(!I){Ne();return}const B=I.inputs.map(q=>$o(q.nodeId,q.inputIndex));C(q=>{const he=new Set(q);for(const me of B)he.delete(me);for(const me of z)he.add(me);return he}),Ne()},D=I=>{if(I.inputs.length>1){ye(I);return}const B=I.inputs[0];B&&qe(B.nodeId,B.inputIndex)},K=()=>{if(i==="output"){for(const I of oe){if(j.has(I))continue;const B=ce.get(I);if(!B)continue;const q=Q(B.nodeId);q&&p(q,B.inputIndex)}for(const I of j){if(oe.has(I))continue;const B=ce.get(I);if(!B)continue;const q=Q(B.nodeId);!q||!$||m($,n.outputIndex,q,B.inputIndex,B.inputType)}s()}},X=()=>{if(i==="output"){if(E.length>0){V(!0);return}K()}},W=i==="input"?N==="pick"?`Connect ${n.inputName}`:"Add new node":N==="pick"?`Connect ${n.outputName}`:"Add new node",Oe=i==="input"?N==="pick"?"Search existing nodes...":"Search node types...":N==="pick"?"Search target nodes...":"Search node types...",be=()=>{if(i!=="input")return null;const I=n;return u.jsxs("div",{className:"px-3 pt-3 pb-20 flex flex-col gap-2",children:[fe.map(({node:B,outputIndex:q})=>{const he=f?.[B.type],me=B.title,Se=typeof me=="string"&&me.trim()?me.trim():he?.display_name||B.type,F=hs(String(he?.python_module??he?.category?.split("/")[0]??"Core")),ie=B.outputs?.[q],Ae=ie?.localized_name||ie?.name||`Output ${q+1}`,Ue=String(ie?.type??I.inputType),Je=B.id===I.currentlyConnectedNodeId;return u.jsx(MS,{nodeId:B.id,displayName:Se,pack:F,outputName:Ae,outputType:Ue,inputName:I.inputName,isConnected:Je,onSelect:()=>A(B.id,q)},B.id)}),fe.length===0&&u.jsx(aa,{query:w,message:"No matching nodes found"}),u.jsxs("button",{type:"button",className:"w-full text-left rounded-xl border-2 border-gray-700 bg-white px-4 py-3 flex items-center gap-3 hover:bg-gray-100 active:scale-[0.998] transition shadow-sm",onClick:()=>{S("addNew"),k("")},children:[u.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-800 flex items-center justify-center flex-shrink-0",children:u.jsx(zo,{className:"w-4 h-4 text-white"})}),u.jsx("span",{className:"text-sm font-semibold text-gray-900",children:"Add new node..."})]}),I.currentlyConnectedNodeId!==null&&u.jsx("button",{type:"button",className:"w-full text-left rounded-xl border border-red-200 bg-red-50 px-4 py-3 text-sm font-semibold text-red-600 hover:bg-red-100 active:scale-[0.998] transition",onClick:M,children:"Disconnect"})]})},ke=()=>{if(i!=="input")return null;const I=n;return u.jsxs("div",{className:"px-3 pt-3 pb-20 flex flex-col gap-2",children:[je.length===0&&u.jsx(aa,{query:w,message:"No matching node types found"}),je.map(({typeName:B,def:q,outputIndex:he})=>{const me=hs(String(q.python_module??q.category?.split("/")[0]??"Core")),Se=String(q.output?.[he]??I.inputType),F=q.output_name?.[he]??q.output?.[he]??"Output";return u.jsx(zf,{title:ms(q,B),subtitle:me||"Core",outputType:Se,outputName:String(F),inputName:I.inputName,titleClassName:"text-sm font-medium text-gray-900 truncate",onSelect:()=>ee(B)},B)})]})},J=()=>{if(i!=="output")return null;const I=n;return u.jsxs("div",{className:"px-3 pt-3 pb-20 flex flex-col gap-2",children:[Ke.map(B=>{const he=B.inputs.filter(ie=>j.has($o(ie.nodeId,ie.inputIndex))).length>0,me=B.inputs.some(ie=>ie.hasExistingLink),Se=B.inputs.some(ie=>ie.currentlyConnectedFromThisOutput),F=B.inputs.length>1?`${B.inputs.length} compatible inputs`:`${I.outputName} -> ${B.inputs[0]?.inputName??"Input"}`;return u.jsx("button",{type:"button",className:`w-full text-left rounded-xl border px-4 py-3 shadow-sm transition ${he?"border-blue-300 bg-blue-50":"border-gray-200 bg-white hover:border-gray-300 active:scale-[0.998]"}`,onClick:()=>D(B),children:u.jsxs("div",{className:"flex items-start justify-between gap-3",children:[u.jsxs("div",{className:"min-w-0 flex-1",children:[u.jsxs("div",{className:"text-sm font-semibold text-gray-900 flex items-center gap-2 min-w-0",children:[u.jsxs("span",{className:"truncate",children:[B.displayName," ",u.jsxs("span",{className:"text-gray-400",children:["#",B.nodeId]})]}),Se&&u.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-blue-100 text-blue-700 text-[10px] font-medium shrink-0",children:[u.jsx(Do,{className:"w-3 h-3"}),"Connected"]}),me&&u.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full bg-amber-100 text-amber-700 text-[10px] font-medium shrink-0",children:"Already linked"})]}),u.jsx("div",{className:"text-xs text-gray-500 truncate mt-0.5",children:B.pack||"Core"}),u.jsx("div",{className:"text-xs text-gray-700 mt-1 truncate",children:F})]}),u.jsx("div",{className:`w-5 h-5 rounded border flex items-center justify-center ${he?"bg-blue-600 border-blue-600":"bg-white border-gray-300"}`,children:he&&u.jsx(Do,{className:"w-3 h-3 text-white"})})]})},`output-node-${B.nodeId}`)}),Ke.length===0&&u.jsx(aa,{query:w,message:"No matching target nodes found"}),u.jsxs("button",{type:"button",className:"w-full text-left rounded-xl border-2 border-gray-700 bg-white px-4 py-3 flex items-center gap-3 hover:bg-gray-100 active:scale-[0.998] transition shadow-sm",onClick:()=>{S("addNew"),k("")},children:[u.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-800 flex items-center justify-center flex-shrink-0",children:u.jsx(zo,{className:"w-4 h-4 text-white"})}),u.jsx("span",{className:"text-sm font-semibold text-gray-900",children:"Add new node..."})]})]})},xe=()=>{if(i!=="output")return null;const I=n;return u.jsxs("div",{className:"px-3 pt-3 pb-20 flex flex-col gap-2",children:[Me.length===0&&u.jsx(aa,{query:w,message:"No matching node types found"}),Me.map(({typeName:B,def:q,inputIndex:he,inputType:me,inputName:Se})=>{const F=hs(String(q.python_module??q.category?.split("/")[0]??"Core"));return u.jsx(zf,{title:ms(q,B),subtitle:F||"Core",outputType:I.outputType,outputName:I.outputName,inputName:String(Se),titleClassName:"text-sm font-medium text-gray-900 truncate",onSelect:()=>Te(B,he,me)},B)})]})};return u.jsxs(Cb,{isOpen:o,onClose:s,title:W,searchQuery:w,onSearchQueryChange:k,searchPlaceholder:Oe,onBack:N==="addNew"?()=>{S("pick"),k("")}:void 0,footer:u.jsx(wb,{zIndex:2201,actions:[{key:"cancel",label:"Cancel",onClick:s,variant:"secondary"},...i==="output"&&N==="pick"?[{key:"apply",label:"Apply",onClick:X,variant:"primary",disabled:!Le}]:[]]}),children:[u.jsx("div",{className:"flex-1 overflow-auto bg-white",children:i==="input"?N==="pick"?be():ke():N==="pick"?J():xe()}),i==="output"&&U!=null&&u.jsx("div",{className:"fixed inset-0 z-[2250] bg-black/40 flex items-center justify-center p-4",onClick:Ne,role:"dialog","aria-modal":"true",children:u.jsxs("div",{className:"w-full max-w-sm bg-white border border-gray-200 rounded-xl shadow-lg overflow-hidden",onClick:I=>I.stopPropagation(),children:[u.jsx("div",{className:"px-4 py-3 text-sm font-semibold text-gray-700 border-b border-gray-100",children:"Select compatible inputs"}),u.jsx("div",{className:"max-h-[45vh] overflow-y-auto",children:Ke.find(I=>I.nodeId===U)?.inputs.map(I=>{const B=$o(I.nodeId,I.inputIndex),q=z.has(B);return u.jsxs("button",{type:"button",className:`w-full flex items-center justify-between gap-3 text-left px-4 py-3 text-sm ${q?"bg-blue-50":"hover:bg-gray-50"}`,onClick:()=>H(B),children:[u.jsxs("span",{className:"min-w-0",children:[u.jsx("span",{className:"block text-gray-900 truncate",children:I.inputName}),u.jsx("span",{className:"block text-xs text-gray-500 truncate",children:I.inputType})]}),u.jsx("span",{className:`w-5 h-5 rounded border flex items-center justify-center shrink-0 ${q?"bg-blue-600 border-blue-600":"bg-white border-gray-300"}`,children:q?u.jsx(Do,{className:"w-3 h-3 text-white"}):null})]},`input-picker-${B}`)})}),u.jsxs("div",{className:"px-3 py-3 border-t border-gray-100 flex justify-end gap-2",children:[u.jsx("button",{type:"button",className:"px-3 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-100",onClick:Ne,children:"Cancel"}),u.jsx("button",{type:"button",className:"px-3 py-2 rounded-lg text-sm font-medium text-white bg-blue-600 hover:bg-blue-700",onClick:Y,children:"Apply"})]})]})}),i==="output"&&T&&u.jsx(Po,{onClose:()=>V(!1),title:"Overwrite existing connections?",description:"Some selected inputs are already connected. Continuing will disconnect their current source and reconnect to this output.",actions:[{label:"Cancel",onClick:()=>V(!1),className:"px-3 py-1.5 rounded-lg text-sm text-gray-700 border border-gray-300 hover:bg-gray-50"},{label:"Overwrite",onClick:()=>{V(!1),K()},className:"px-3 py-1.5 rounded-lg text-sm text-white bg-red-600 hover:bg-red-700"}]})]})}function TS(n,o,s,l){const i=n.nodes.find(b=>b.id===o);if(!i||i.type!=="Reroute")return l;let c=null;const f=[],m=new Set,p=i.inputs[0]?.link;if(p!=null){const b=n.links.find(x=>x[0]===p);if(b){const x=b[1],w=b[2],N=n.nodes.find(S=>S.id===x)?.outputs[w];c=N?.localized_name||N?.name||null}}for(const b of i.outputs){const x=b.links??[];for(const w of x){const k=n.links.find(V=>V[0]===w);if(!k)continue;const N=k[3],S=k[4],C=n.nodes.find(V=>V.id===N)?.inputs[S],T=C?.localized_name||C?.name||null;T&&!m.has(T)&&(m.add(T),f.push(T))}}const g=f.map((b,x)=>x<f.length-1?`${b}/`:b).join(`
`);return f.length>1?g:s==="input"?c||g||l:g||c||l}function ES({direction:n,hasConnection:o,isEmptyRequiredInput:s=!1,hideLabel:l,resolvedLabel:i,shouldWrapResolvedLabel:c,sizeClass:f,arrowClass:m,typeClass:p,buttonRef:g,connectionCount:b,onClick:x,onPointerDown:w,onPointerMove:k,onPointerUp:N}){const S=n==="input",j=S?!o&&!s:!1,C=!S&&!o,T=f.includes("w-7")?"w-3 h-3":"w-3.5 h-3.5";return u.jsxs(u.Fragment,{children:[S?null:!l&&u.jsx("span",{className:`text-sm text-gray-700 flex-1 min-w-0 ${c?"whitespace-pre-line break-words leading-tight text-right":"truncate"}`,children:i}),!S&&b>1&&u.jsx("span",{className:"bg-gray-200 text-gray-700 rounded-full px-2 py-0.5 text-xs font-medium flex-shrink-0",children:b}),u.jsx("button",{onClick:x,onPointerDown:w,onPointerMove:k,onPointerUp:N,onPointerCancel:N,disabled:j,ref:g,className:`
          flex items-center justify-center rounded-full font-medium box-border
          border-2
          ${f} flex-shrink-0
          transition-opacity
          ${p}
          ${S&&s?"opacity-100 cursor-pointer border-red-500":"border-transparent"}
          ${!S&&C?"border-dashed border-gray-400/70":""}
          ${j?"opacity-40 cursor-not-allowed":""}
          ${!j&&C?"opacity-50 cursor-pointer active:scale-95":""}
          ${!j&&!C?"opacity-100 cursor-pointer active:scale-95":""}
        `,children:S?u.jsxs(u.Fragment,{children:[o&&u.jsx("span",{className:m,children:""}),!o&&u.jsx(zo,{className:T})]}):o?u.jsx("span",{className:m,children:""}):u.jsx(zo,{className:T})}),!S&&l?null:S&&!l&&u.jsx("span",{className:`text-sm flex-1 min-w-0 ${c?"whitespace-pre-line break-words leading-tight":"truncate"} ${s?"text-red-600 font-medium":"text-gray-700"}`,children:i})]})}function IS(n){const o=String(n).split(",")[0].trim();return["IMAGE","LATENT","MODEL","CLIP","VAE","CONDITIONING","INT","FLOAT","STRING","BOOLEAN","MASK"].includes(o)?`type-${o}`:"type-default"}function ny(n){return String(n).split(",").map(o=>o.trim().toUpperCase()).filter(Boolean)}const oy=y.memo(function({slot:o,nodeId:s,direction:l,slotIndex:i,compact:c=!1,hideLabel:f=!1,isRequired:m=!1}){const p=ae(H=>H.workflow),g=ae(H=>H.scrollToNode),b=ae(H=>H.revealNodeWithParents),x=ae(H=>H.nodeTypes),w=ae(H=>H.hiddenItems),[k,N]=y.useState(!1),[S,j]=y.useState(!1),C=y.useRef(null),T=y.useRef(null),[V,U]=y.useState(null),R=y.useRef(null),z=y.useRef(null),L=y.useRef(null),$=y.useRef(!1),Q=y.useMemo(()=>{const H=o.localized_name||o.name;return p?TS(p,s,l,H):H},[p,l,o.localized_name,o.name,s]),ue=y.useMemo(()=>{if(!p)return[];const H=[];if(l==="input"){if(o.link!=null){const D=ll(p,s,i);D&&H.push(D.node)}}else{const Y=pa(p,s,i);for(const D of Y)H.push(D.node)}return H},[p,s,l,o,i]),{effectiveNodes:fe,directNodes:de,bypassedTargets:Ie}=y.useMemo(()=>{if(!p)return{effectiveNodes:[],directNodes:[],bypassedTargets:[]};if(Object.keys(w).length===0)return{effectiveNodes:ue,directNodes:ue,bypassedTargets:[]};const H=new Map(p.nodes.map(xe=>[xe.id,xe])),Y=xe=>!!(xe.stableKey&&w[xe.stableKey]),D=new Set,K=xe=>{if(D.has(xe))return[];D.add(xe);const I=H.get(xe);if(!I)return[];const B=[];return I.outputs?.forEach((q,he)=>{pa(p,xe,he).forEach(Se=>{const F=Se.node;Y(F)?B.push(...K(F.id)):B.push(F)})}),B},X=xe=>{if(D.has(xe))return[];D.add(xe);const I=H.get(xe);if(!I)return[];const B=[];return I.inputs?.forEach((q,he)=>{if(q.link===null)return;const me=ll(p,xe,he);me&&(Y(me.node)?B.push(...X(me.node.id)):B.push(me.node))}),B},W=[],Oe=[];ue.forEach(xe=>{Y(xe)?l==="input"?Oe.push(...X(xe.id)):Oe.push(...K(xe.id)):W.push(xe)});const be=new Set(W.map(xe=>xe.id));let J=(xe=>{const I=[],B=new Set;return xe.forEach(q=>{be.has(q.id)||B.has(q.id)||(B.add(q.id),I.push(q))}),I})(Oe);if(l==="input"&&J.length>1){const xe=new Set(ny(o.type)),I=J.filter(B=>B.outputs?.some(q=>ny(q.type).some(he=>xe.has(he))));I.length>0&&(J=I)}return{effectiveNodes:[...W,...J],directNodes:W,bypassedTargets:J}},[ue,p,l,o.type,w]),je=fe.length,Me=je===1?fe[0].id:null,_=je>0,oe=l==="input"&&!_&&m,ce=y.useCallback(()=>{z.current!=null&&(window.clearTimeout(z.current),z.current=null)},[]),Ke=y.useCallback(H=>H.stableKey??null,[]),Le=()=>{if($.current){$.current=!1;return}if(l==="output"&&!_){j(!0);return}if(oe){j(!0);return}if(_){if(je===1&&Me!==null){const H=fe[0],Y=H?Ke(H):null;Y&&(b(Y),g(Y));return}N(H=>!H)}},E=y.useCallback(H=>{(l!=="input"||_)&&(L.current={x:H.clientX,y:H.clientY},$.current=!1,z.current=window.setTimeout(()=>{z.current=null,$.current=!0,j(!0)},500))},[l,_]),A=y.useCallback(H=>{if(!L.current)return;const Y=H.clientX-L.current.x,D=H.clientY-L.current.y;Math.hypot(Y,D)>8&&ce()},[ce]),M=y.useCallback(()=>{ce(),L.current=null},[ce]),ee=H=>Y=>{Y.stopPropagation();const D=fe.find(X=>X.id===H),K=D?Ke(D):null;K&&(b(K),g(K)),N(!1)};y.useLayoutEffect(()=>{if(!k)return;const H=()=>{const Y=T.current;if(!Y)return;const D=Y.getBoundingClientRect(),K=8;U({top:D.bottom+6,...l==="input"?{left:Math.min(D.left,window.innerWidth-K)}:{right:Math.max(K,window.innerWidth-D.right)}})};return R.current=H,H(),()=>{}},[k,je,l]),y.useEffect(()=>{if(!k)return;const H=()=>R.current?.(),Y=K=>{!C.current||!K.target||T.current?.contains(K.target)||C.current.contains(K.target)||N(!1)},D=K=>{const X=K.target;C.current&&X&&C.current.contains(X)||N(!1)};return document.addEventListener("mousedown",Y),document.addEventListener("scroll",D,!0),window.addEventListener("resize",H),()=>{document.removeEventListener("mousedown",Y),document.removeEventListener("scroll",D,!0),window.removeEventListener("resize",H)}},[k]),y.useEffect(()=>()=>ce(),[ce]);const Te=c?"w-7 h-7":"w-10 h-10",qe=c?"text-sm":"text-base";if(!p)return null;const ye=l==="input"&&_&&Me!==null?Me:null,Ne=Q.includes("/")||Q.includes(`
`);return u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(ES,{direction:l,hasConnection:_,isEmptyRequiredInput:oe,hideLabel:f,resolvedLabel:Q,shouldWrapResolvedLabel:Ne,sizeClass:Te,arrowClass:qe,typeClass:IS(o.type),buttonRef:T,connectionCount:je,onClick:Le,onPointerDown:E,onPointerMove:A,onPointerUp:M}),k&&V&&En.createPortal(u.jsx("div",{ref:C,className:"fixed z-[1000]",style:{top:V.top,right:V.right,left:V.left,maxWidth:"calc(100vw - 16px)"},children:u.jsx(gr,{items:[...de.map(H=>{const D=x?.[H.type]?.display_name||H.type;return{key:`direct-${H.id}`,label:`${D} #${H.id}`,onClick:ee(H.id)}}),{type:"custom",key:"bypassed-label",hidden:!(de.length>0&&Ie.length>0),render:u.jsx("div",{className:"px-3 py-1",children:u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("div",{className:"h-px flex-1 bg-gray-200"}),u.jsx("span",{className:"text-[10px] text-gray-400",children:"(via bypassed)"}),u.jsx("div",{className:"h-px flex-1 bg-gray-200"})]})})},...Ie.map(H=>{const D=x?.[H.type]?.display_name||H.type;return{key:`bypassed-${H.id}`,label:`${D} #${H.id}`,onClick:ee(H.id)}})]})}),document.body),S&&(l==="input"?u.jsx(ty,{mode:"input",isOpen:S,onClose:()=>j(!1),nodeId:s,inputIndex:i,inputType:o.type,inputName:Q,currentlyConnectedNodeId:ye}):u.jsx(ty,{mode:"output",isOpen:S,onClose:()=>j(!1),nodeId:s,outputIndex:i,outputType:o.type,outputName:Q}))]})});function LS({nodeId:n,nodeType:o,inputs:s,outputs:l,allInputs:i,allOutputs:c}){const f=ae(g=>g.connectionButtonsVisible),m=ae(g=>g.nodeTypes),p=y.useMemo(()=>{if(!o||!m)return new Set;const g=m[o];return g?.input?.required?new Set(Object.keys(g.input.required)):new Set},[o,m]);return!f||s.length===0&&l.length===0?null:u.jsxs("div",{className:"node-connections mb-3 grid grid-cols-2 gap-3",children:[u.jsx("div",{children:s.length>0&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"text-xs text-gray-500 mb-1.5 uppercase tracking-wide",children:"Inputs"}),u.jsx("div",{className:"flex flex-col gap-1.5",children:s.map((g,b)=>{const x=i.indexOf(g),w=x>=0?x:b;return u.jsx(oy,{slot:g,nodeId:n,direction:"input",slotIndex:w,isRequired:p.has(g.name)},`input-${w}`)})})]})}),u.jsx("div",{className:"flex flex-col items-end",children:l.length>0&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"text-xs text-gray-500 mb-1.5 uppercase tracking-wide text-right w-full",children:"Outputs"}),u.jsx("div",{className:"flex flex-col gap-1.5 w-full items-end",children:l.map((g,b)=>{const x=c.indexOf(g),w=x>=0?x:b;return u.jsx(oy,{slot:g,nodeId:n,direction:"output",slotIndex:w},`output-${w}`)})})]})})]})}function AS({nodeId:n,nodeType:o,inputs:s,outputs:l,allInputs:i,allOutputs:c}){return u.jsx(LS,{nodeId:n,nodeType:o,inputs:s,outputs:l,allInputs:i,allOutputs:c})}function RS({title:n,onClose:o,headerActions:s,isDark:l}){return u.jsx("div",{className:"bg-white p-4 border-b border-gray-200 dark:border-gray-800 shadow-sm relative z-50 min-h-0 overflow-y-auto shrink-0",style:{maxHeight:"var(--top-bar-offset)",...l?{backgroundColor:Tt.surface.darkPanel}:{}},children:u.jsxs("div",{className:"flex justify-between items-start mb-2",children:[u.jsx("span",{className:"font-semibold text-gray-700 dark:text-gray-200 truncate pr-4 pt-1 flex-1",children:n}),u.jsxs("div",{className:"flex items-center gap-2",children:[s,u.jsx(xa,{onClick:o})]})]})})}function gp({isOpen:n,title:o,onClose:s,children:l,headerActions:i}){const f=al(m=>m.theme)==="dark";return y.useEffect(()=>{if(n){const m=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=m}}},[n]),n?En.createPortal(u.jsx("div",{className:"fixed inset-0 z-[2100] bg-gray-400/40 dark:bg-black/50 backdrop-blur-sm safe-area-top",onClick:s,children:u.jsxs("div",{className:"w-full h-full flex flex-col",style:{paddingTop:"env(--top-bar-offset, 0px)",paddingBottom:"var(--bottom-bar-offset, 0px)"},onClick:m=>m.stopPropagation(),children:[u.jsx(RS,{title:o,onClose:s,headerActions:i,isDark:f}),u.jsx("div",{className:"mt-2 px-4 pb-4",children:l}),u.jsx("div",{className:"flex-1",onClick:s})]})}),document.body):null}function nl({isPinned:n,onToggle:o}){if(!n||!o)return null;const s=l=>{l.preventDefault(),l.stopPropagation(),o()};return u.jsx("button",{type:"button",onClick:s,className:"flex items-center justify-center transition-colors text-fuchsia-500 hover:text-fuchsia-600","aria-label":"Remove pin",children:u.jsx(ya,{className:"w-5 h-5"})})}function kb(){return typeof window>"u"?!1:window.matchMedia("(pointer: coarse)").matches}function ry({containerClass:n,name:o,value:s,options:l,onChange:i,disabled:c=!1,hideLabel:f=!1,hasPin:m,isPinned:p=!1,onTogglePin:g,hasError:b=!1,forceModalOpen:x=!1,onModalClose:w}){const k=de=>{if(!Array.isArray(l))return l?.[de]},N=k("multiline"),S=k("placeholder"),j=String(s??""),C=de=>{i(de.target.value)},[T,V]=y.useState(!1),U=x||T,z=al(de=>de.theme)==="dark",L=kb(),$=x||L,Q=y.useRef(null),ue=y.useRef(null);y.useLayoutEffect(()=>{if(!N)return;const de=Q.current;de&&(de.style.height="0px",de.style.height=`${de.scrollHeight}px`)},[s,U,N]);const fe=()=>{V(!1),w?.()};return $?u.jsxs("div",{className:n,children:[N?u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"flex items-center justify-between mb-1 min-h-[18px]",children:[f?u.jsx("span",{className:"block text-sm font-medium text-gray-700"}):u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:o}),u.jsx(ca,{value:j,onChange:i,textareaRef:Q,className:"opacity-100"})]}),u.jsxs("div",{className:`relative w-full p-3 comfy-input min-h-[100px] text-base group cursor-text ${c?"opacity-60 cursor-not-allowed":""} ${m?"pr-10":""} ${b?"border-red-700 ring-1 ring-red-700":""}`,onClick:()=>!c&&V(!0),children:[u.jsx("div",{className:"whitespace-pre-wrap break-words text-gray-900",style:z?{color:Tt.text.onDark}:void 0,children:j||u.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:S})}),m&&u.jsx("div",{className:"absolute right-2 top-2 pointer-events-none",children:u.jsx("div",{className:"pointer-events-auto",children:u.jsx(nl,{isPinned:p,onToggle:g})})})]})]}):u.jsxs(u.Fragment,{children:[!f&&u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:o}),u.jsxs("div",{className:`relative w-full p-3 comfy-input text-base min-h-[46px] flex items-center cursor-text ${c?"opacity-60 cursor-not-allowed":""} ${m?"pr-16":"pr-6"} ${b?"border-red-700 ring-1 ring-red-700":""}`,onClick:()=>!c&&V(!0),children:[u.jsx("div",{className:"truncate min-w-0 flex-1 text-gray-900",style:z?{color:Tt.text.onDark}:void 0,children:j||u.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:S})}),m&&u.jsx("div",{className:"absolute right-0 top-0 bottom-0 flex items-center pointer-events-none",children:u.jsx("div",{className:"pointer-events-auto px-3",children:u.jsx(nl,{isPinned:p,onToggle:g})})})]})]}),u.jsx(gp,{title:o,isOpen:U,onClose:fe,headerActions:N?u.jsx(ca,{value:j,onChange:i,textareaRef:Q,className:"mr-2"}):null,children:N?u.jsx("textarea",{ref:Q,value:j,onChange:de=>i(de.target.value),placeholder:S,className:"w-full p-3 border border-gray-300 rounded-lg min-h-[150px] text-base resize-none outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500",autoFocus:!x,disabled:c}):u.jsx("input",{ref:ue,type:"text",value:j,onChange:de=>i(de.target.value),placeholder:S,className:"w-full p-3 border border-gray-300 rounded-lg text-base outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500",autoFocus:!x,disabled:c})})]}):N?u.jsxs("div",{className:`${n} group`,"data-textarea-root":"true",children:[u.jsxs("div",{className:"flex items-center justify-between mb-1 min-h-[18px]","data-textarea-header":"true",children:[f?u.jsx("span",{className:"block text-sm font-medium text-gray-700"}):u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:o}),u.jsx(ca,{value:j,onChange:i,textareaRef:Q,className:"opacity-70 transition-opacity group-focus-within:opacity-100"})]}),u.jsxs("div",{className:"relative",children:[u.jsx("textarea",{ref:Q,value:j,onChange:C,placeholder:S,className:`w-full p-3 comfy-input min-h-[100px] text-base resize-none overflow-hidden ${c?"opacity-60 cursor-not-allowed":""} ${m?"pr-10":""} ${b?"border-red-700 ring-1 ring-red-700":""}`,style:{overflowAnchor:"none"},disabled:c}),m&&u.jsx("div",{className:"absolute right-2 top-2",children:u.jsx(nl,{isPinned:p,onToggle:g})})]})]}):u.jsxs("div",{className:n,children:[!f&&u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:o}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"text",value:String(s??""),onChange:de=>i(de.target.value),placeholder:S,className:`w-full p-3 comfy-input text-base ${c?"opacity-60 cursor-not-allowed":""} ${m?"pr-16":""} ${b?"border-red-700 ring-1 ring-red-700":""}`,disabled:c}),m&&u.jsx("div",{className:"absolute right-0 top-0 bottom-0 flex items-center pointer-events-none",children:u.jsx("div",{className:"pointer-events-auto px-3",children:u.jsx(nl,{isPinned:p,onToggle:g})})})]})]})}function Hf({containerClass:n,name:o,value:s,options:l,onChange:i,disabled:c,type:f,min:m,max:p,step:g,isInt:b,hasError:x=!1}){const[w,k]=y.useState(String(s||0)),N=b??(f?f.toUpperCase()==="INT":Number.isInteger(s)),S=g??l?.step??(N?1:.1),j=m??(l?.min!==void 0?l.min:-1/0),C=p??(l?.max!==void 0?l.max:1/0);y.useEffect(()=>{k(String(s))},[s]);const T=L=>{k(L.target.value)},V=()=>{let L=N?parseInt(w,10):parseFloat(w);isNaN(L)&&(L=s),L=Math.max(j,Math.min(C,L)),i(L),k(String(L))},U=L=>{const $=(N?parseInt(w,10):parseFloat(w))||0,Q=Math.max(j,Math.min(C,$+L));i(Q)},R=[`number-input-field-${o}`,"w-full p-3 comfy-input text-base text-gray-900",c?"opacity-60 cursor-not-allowed":"",x?"border-red-700 ring-1 ring-red-700":""].filter(Boolean).join(" "),z=["w-10 h-10 flex items-center justify-center rounded-full bg-gray-100 text-gray-700 flex-shrink-0",c?"opacity-60 cursor-not-allowed":"active:scale-95 transition-all"].filter(Boolean).join(" ");return u.jsxs("div",{className:`${n??""} number-control-${o}`,children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:o}),u.jsxs("div",{className:`number-stepper-container-${o} flex items-center gap-2`,children:[u.jsx("input",{className:R,type:"number",value:w,onChange:T,onBlur:V,disabled:c,"aria-label":f?`${o} ${f}`:o}),u.jsx("button",{type:"button",onClick:()=>U(-S),className:z,"aria-label":"Decrease value",disabled:c,children:u.jsx(h2,{className:"w-4 h-4"})}),u.jsx("button",{type:"button",onClick:()=>U(S),className:z,"aria-label":"Increase value",disabled:c,children:u.jsx(zo,{className:"w-4 h-4"})})]})]})}function ys(n){"@babel/helpers - typeof";return ys=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(o){return typeof o}:function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},ys(n)}function _S(n,o){if(ys(n)!="object"||!n)return n;var s=n[Symbol.toPrimitive];if(s!==void 0){var l=s.call(n,o);if(ys(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(o==="string"?String:Number)(n)}function jb(n){var o=_S(n,"string");return ys(o)=="symbol"?o:o+""}function ia(n,o,s){return(o=jb(o))in n?Object.defineProperty(n,o,{value:s,enumerable:!0,configurable:!0,writable:!0}):n[o]=s,n}function sy(n,o){var s=Object.keys(n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(n);o&&(l=l.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),s.push.apply(s,l)}return s}function Ct(n){for(var o=1;o<arguments.length;o++){var s=arguments[o]!=null?arguments[o]:{};o%2?sy(Object(s),!0).forEach(function(l){ia(n,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(s)):sy(Object(s)).forEach(function(l){Object.defineProperty(n,l,Object.getOwnPropertyDescriptor(s,l))})}return n}function DS(n){if(Array.isArray(n))return n}function BS(n,o){var s=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(s!=null){var l,i,c,f,m=[],p=!0,g=!1;try{if(c=(s=s.call(n)).next,o===0){if(Object(s)!==s)return;p=!1}else for(;!(p=(l=c.call(s)).done)&&(m.push(l.value),m.length!==o);p=!0);}catch(b){g=!0,i=b}finally{try{if(!p&&s.return!=null&&(f=s.return(),Object(f)!==f))return}finally{if(g)throw i}}return m}}function Vf(n,o){(o==null||o>n.length)&&(o=n.length);for(var s=0,l=Array(o);s<o;s++)l[s]=n[s];return l}function Mb(n,o){if(n){if(typeof n=="string")return Vf(n,o);var s={}.toString.call(n).slice(8,-1);return s==="Object"&&n.constructor&&(s=n.constructor.name),s==="Map"||s==="Set"?Array.from(n):s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?Vf(n,o):void 0}}function zS(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mr(n,o){return DS(n)||BS(n,o)||Mb(n,o)||zS()}function HS(n,o){if(n==null)return{};var s={};for(var l in n)if({}.hasOwnProperty.call(n,l)){if(o.indexOf(l)!==-1)continue;s[l]=n[l]}return s}function vr(n,o){if(n==null)return{};var s,l,i=HS(n,o);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(n);for(l=0;l<c.length;l++)s=c[l],o.indexOf(s)===-1&&{}.propertyIsEnumerable.call(n,s)&&(i[s]=n[s])}return i}var VS=["defaultInputValue","defaultMenuIsOpen","defaultValue","inputValue","menuIsOpen","onChange","onInputChange","onMenuClose","onMenuOpen","value"];function KS(n){var o=n.defaultInputValue,s=o===void 0?"":o,l=n.defaultMenuIsOpen,i=l===void 0?!1:l,c=n.defaultValue,f=c===void 0?null:c,m=n.inputValue,p=n.menuIsOpen,g=n.onChange,b=n.onInputChange,x=n.onMenuClose,w=n.onMenuOpen,k=n.value,N=vr(n,VS),S=y.useState(m!==void 0?m:s),j=mr(S,2),C=j[0],T=j[1],V=y.useState(p!==void 0?p:i),U=mr(V,2),R=U[0],z=U[1],L=y.useState(k!==void 0?k:f),$=mr(L,2),Q=$[0],ue=$[1],fe=y.useCallback(function(ce,Ke){typeof g=="function"&&g(ce,Ke),ue(ce)},[g]),de=y.useCallback(function(ce,Ke){var Le;typeof b=="function"&&(Le=b(ce,Ke)),T(Le!==void 0?Le:ce)},[b]),Ie=y.useCallback(function(){typeof w=="function"&&w(),z(!0)},[w]),je=y.useCallback(function(){typeof x=="function"&&x(),z(!1)},[x]),Me=m!==void 0?m:C,_=p!==void 0?p:R,oe=k!==void 0?k:Q;return Ct(Ct({},N),{},{inputValue:Me,menuIsOpen:_,onChange:fe,onInputChange:de,onMenuClose:je,onMenuOpen:Ie,value:oe})}function Mt(){return Mt=Object.assign?Object.assign.bind():function(n){for(var o=1;o<arguments.length;o++){var s=arguments[o];for(var l in s)({}).hasOwnProperty.call(s,l)&&(n[l]=s[l])}return n},Mt.apply(null,arguments)}function US(n,o){if(!(n instanceof o))throw new TypeError("Cannot call a class as a function")}function ly(n,o){for(var s=0;s<o.length;s++){var l=o[s];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(n,jb(l.key),l)}}function $S(n,o,s){return o&&ly(n.prototype,o),s&&ly(n,s),Object.defineProperty(n,"prototype",{writable:!1}),n}function Kf(n,o){return Kf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,l){return s.__proto__=l,s},Kf(n,o)}function FS(n,o){if(typeof o!="function"&&o!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(o&&o.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),o&&Kf(n,o)}function Su(n){return Su=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(o){return o.__proto__||Object.getPrototypeOf(o)},Su(n)}function Ob(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Ob=function(){return!!n})()}function qS(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function WS(n,o){if(o&&(ys(o)=="object"||typeof o=="function"))return o;if(o!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return qS(n)}function GS(n){var o=Ob();return function(){var s,l=Su(n);if(o){var i=Su(this).constructor;s=Reflect.construct(l,arguments,i)}else s=l.apply(this,arguments);return WS(this,s)}}function PS(n){if(Array.isArray(n))return Vf(n)}function YS(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function QS(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yp(n){return PS(n)||YS(n)||Mb(n)||QS()}function XS(n){if(n.sheet)return n.sheet;for(var o=0;o<document.styleSheets.length;o++)if(document.styleSheets[o].ownerNode===n)return document.styleSheets[o]}function ZS(n){var o=document.createElement("style");return o.setAttribute("data-emotion",n.key),n.nonce!==void 0&&o.setAttribute("nonce",n.nonce),o.appendChild(document.createTextNode("")),o.setAttribute("data-s",""),o}var JS=(function(){function n(s){var l=this;this._insertTag=function(i){var c;l.tags.length===0?l.insertionPoint?c=l.insertionPoint.nextSibling:l.prepend?c=l.container.firstChild:c=l.before:c=l.tags[l.tags.length-1].nextSibling,l.container.insertBefore(i,c),l.tags.push(i)},this.isSpeedy=s.speedy===void 0?!0:s.speedy,this.tags=[],this.ctr=0,this.nonce=s.nonce,this.key=s.key,this.container=s.container,this.prepend=s.prepend,this.insertionPoint=s.insertionPoint,this.before=null}var o=n.prototype;return o.hydrate=function(l){l.forEach(this._insertTag)},o.insert=function(l){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(ZS(this));var i=this.tags[this.tags.length-1];if(this.isSpeedy){var c=XS(i);try{c.insertRule(l,c.cssRules.length)}catch{}}else i.appendChild(document.createTextNode(l));this.ctr++},o.flush=function(){this.tags.forEach(function(l){var i;return(i=l.parentNode)==null?void 0:i.removeChild(l)}),this.tags=[],this.ctr=0},n})(),Fn="-ms-",Nu="-moz-",Qt="-webkit-",Tb="comm",bp="rule",xp="decl",eN="@import",Eb="@keyframes",tN="@layer",nN=Math.abs,Du=String.fromCharCode,oN=Object.assign;function rN(n,o){return Vn(n,0)^45?(((o<<2^Vn(n,0))<<2^Vn(n,1))<<2^Vn(n,2))<<2^Vn(n,3):0}function Ib(n){return n.trim()}function sN(n,o){return(n=o.exec(n))?n[0]:n}function Xt(n,o,s){return n.replace(o,s)}function Uf(n,o){return n.indexOf(o)}function Vn(n,o){return n.charCodeAt(o)|0}function va(n,o,s){return n.slice(o,s)}function Fo(n){return n.length}function vp(n){return n.length}function tu(n,o){return o.push(n),n}function lN(n,o){return n.map(o).join("")}var Bu=1,il=1,Lb=0,oo=0,Tn=0,dl="";function zu(n,o,s,l,i,c,f){return{value:n,root:o,parent:s,type:l,props:i,children:c,line:Bu,column:il,length:f,return:""}}function sa(n,o){return oN(zu("",null,null,"",null,null,0),n,{length:-n.length},o)}function aN(){return Tn}function iN(){return Tn=oo>0?Vn(dl,--oo):0,il--,Tn===10&&(il=1,Bu--),Tn}function go(){return Tn=oo<Lb?Vn(dl,oo++):0,il++,Tn===10&&(il=1,Bu++),Tn}function Yo(){return Vn(dl,oo)}function cu(){return oo}function Ta(n,o){return va(dl,n,o)}function wa(n){switch(n){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function Ab(n){return Bu=il=1,Lb=Fo(dl=n),oo=0,[]}function Rb(n){return dl="",n}function du(n){return Ib(Ta(oo-1,$f(n===91?n+2:n===40?n+1:n)))}function uN(n){for(;(Tn=Yo())&&Tn<33;)go();return wa(n)>2||wa(Tn)>3?"":" "}function cN(n,o){for(;--o&&go()&&!(Tn<48||Tn>102||Tn>57&&Tn<65||Tn>70&&Tn<97););return Ta(n,cu()+(o<6&&Yo()==32&&go()==32))}function $f(n){for(;go();)switch(Tn){case n:return oo;case 34:case 39:n!==34&&n!==39&&$f(Tn);break;case 40:n===41&&$f(n);break;case 92:go();break}return oo}function dN(n,o){for(;go()&&n+Tn!==57;)if(n+Tn===84&&Yo()===47)break;return"/*"+Ta(o,oo-1)+"*"+Du(n===47?n:go())}function fN(n){for(;!wa(Yo());)go();return Ta(n,oo)}function pN(n){return Rb(fu("",null,null,null,[""],n=Ab(n),0,[0],n))}function fu(n,o,s,l,i,c,f,m,p){for(var g=0,b=0,x=f,w=0,k=0,N=0,S=1,j=1,C=1,T=0,V="",U=i,R=c,z=l,L=V;j;)switch(N=T,T=go()){case 40:if(N!=108&&Vn(L,x-1)==58){Uf(L+=Xt(du(T),"&","&\f"),"&\f")!=-1&&(C=-1);break}case 34:case 39:case 91:L+=du(T);break;case 9:case 10:case 13:case 32:L+=uN(N);break;case 92:L+=cN(cu()-1,7);continue;case 47:switch(Yo()){case 42:case 47:tu(hN(dN(go(),cu()),o,s),p);break;default:L+="/"}break;case 123*S:m[g++]=Fo(L)*C;case 125*S:case 59:case 0:switch(T){case 0:case 125:j=0;case 59+b:C==-1&&(L=Xt(L,/\f/g,"")),k>0&&Fo(L)-x&&tu(k>32?iy(L+";",l,s,x-1):iy(Xt(L," ","")+";",l,s,x-2),p);break;case 59:L+=";";default:if(tu(z=ay(L,o,s,g,b,i,m,V,U=[],R=[],x),c),T===123)if(b===0)fu(L,o,z,z,U,c,x,m,R);else switch(w===99&&Vn(L,3)===110?100:w){case 100:case 108:case 109:case 115:fu(n,z,z,l&&tu(ay(n,z,z,0,0,i,m,V,i,U=[],x),R),i,R,x,m,l?U:R);break;default:fu(L,z,z,z,[""],R,0,m,R)}}g=b=k=0,S=C=1,V=L="",x=f;break;case 58:x=1+Fo(L),k=N;default:if(S<1){if(T==123)--S;else if(T==125&&S++==0&&iN()==125)continue}switch(L+=Du(T),T*S){case 38:C=b>0?1:(L+="\f",-1);break;case 44:m[g++]=(Fo(L)-1)*C,C=1;break;case 64:Yo()===45&&(L+=du(go())),w=Yo(),b=x=Fo(V=L+=fN(cu())),T++;break;case 45:N===45&&Fo(L)==2&&(S=0)}}return c}function ay(n,o,s,l,i,c,f,m,p,g,b){for(var x=i-1,w=i===0?c:[""],k=vp(w),N=0,S=0,j=0;N<l;++N)for(var C=0,T=va(n,x+1,x=nN(S=f[N])),V=n;C<k;++C)(V=Ib(S>0?w[C]+" "+T:Xt(T,/&\f/g,w[C])))&&(p[j++]=V);return zu(n,o,s,i===0?bp:m,p,g,b)}function hN(n,o,s){return zu(n,o,s,Tb,Du(aN()),va(n,2,-2),0)}function iy(n,o,s,l){return zu(n,o,s,xp,va(n,0,l),va(n,l+1,-1),l)}function sl(n,o){for(var s="",l=vp(n),i=0;i<l;i++)s+=o(n[i],i,n,o)||"";return s}function mN(n,o,s,l){switch(n.type){case tN:if(n.children.length)break;case eN:case xp:return n.return=n.return||n.value;case Tb:return"";case Eb:return n.return=n.value+"{"+sl(n.children,l)+"}";case bp:n.value=n.props.join(",")}return Fo(s=sl(n.children,l))?n.return=n.value+"{"+s+"}":""}function gN(n){var o=vp(n);return function(s,l,i,c){for(var f="",m=0;m<o;m++)f+=n[m](s,l,i,c)||"";return f}}function yN(n){return function(o){o.root||(o=o.return)&&n(o)}}function bN(n){var o=Object.create(null);return function(s){return o[s]===void 0&&(o[s]=n(s)),o[s]}}var xN=function(o,s,l){for(var i=0,c=0;i=c,c=Yo(),i===38&&c===12&&(s[l]=1),!wa(c);)go();return Ta(o,oo)},vN=function(o,s){var l=-1,i=44;do switch(wa(i)){case 0:i===38&&Yo()===12&&(s[l]=1),o[l]+=xN(oo-1,s,l);break;case 2:o[l]+=du(i);break;case 4:if(i===44){o[++l]=Yo()===58?"&\f":"",s[l]=o[l].length;break}default:o[l]+=Du(i)}while(i=go());return o},wN=function(o,s){return Rb(vN(Ab(o),s))},uy=new WeakMap,SN=function(o){if(!(o.type!=="rule"||!o.parent||o.length<1)){for(var s=o.value,l=o.parent,i=o.column===l.column&&o.line===l.line;l.type!=="rule";)if(l=l.parent,!l)return;if(!(o.props.length===1&&s.charCodeAt(0)!==58&&!uy.get(l))&&!i){uy.set(o,!0);for(var c=[],f=wN(s,c),m=l.props,p=0,g=0;p<f.length;p++)for(var b=0;b<m.length;b++,g++)o.props[g]=c[p]?f[p].replace(/&\f/g,m[b]):m[b]+" "+f[p]}}},NN=function(o){if(o.type==="decl"){var s=o.value;s.charCodeAt(0)===108&&s.charCodeAt(2)===98&&(o.return="",o.value="")}};function _b(n,o){switch(rN(n,o)){case 5103:return Qt+"print-"+n+n;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Qt+n+n;case 5349:case 4246:case 4810:case 6968:case 2756:return Qt+n+Nu+n+Fn+n+n;case 6828:case 4268:return Qt+n+Fn+n+n;case 6165:return Qt+n+Fn+"flex-"+n+n;case 5187:return Qt+n+Xt(n,/(\w+).+(:[^]+)/,Qt+"box-$1$2"+Fn+"flex-$1$2")+n;case 5443:return Qt+n+Fn+"flex-item-"+Xt(n,/flex-|-self/,"")+n;case 4675:return Qt+n+Fn+"flex-line-pack"+Xt(n,/align-content|flex-|-self/,"")+n;case 5548:return Qt+n+Fn+Xt(n,"shrink","negative")+n;case 5292:return Qt+n+Fn+Xt(n,"basis","preferred-size")+n;case 6060:return Qt+"box-"+Xt(n,"-grow","")+Qt+n+Fn+Xt(n,"grow","positive")+n;case 4554:return Qt+Xt(n,/([^-])(transform)/g,"$1"+Qt+"$2")+n;case 6187:return Xt(Xt(Xt(n,/(zoom-|grab)/,Qt+"$1"),/(image-set)/,Qt+"$1"),n,"")+n;case 5495:case 3959:return Xt(n,/(image-set\([^]*)/,Qt+"$1$`$1");case 4968:return Xt(Xt(n,/(.+:)(flex-)?(.*)/,Qt+"box-pack:$3"+Fn+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Qt+n+n;case 4095:case 3583:case 4068:case 2532:return Xt(n,/(.+)-inline(.+)/,Qt+"$1$2")+n;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Fo(n)-1-o>6)switch(Vn(n,o+1)){case 109:if(Vn(n,o+4)!==45)break;case 102:return Xt(n,/(.+:)(.+)-([^]+)/,"$1"+Qt+"$2-$3$1"+Nu+(Vn(n,o+3)==108?"$3":"$2-$3"))+n;case 115:return~Uf(n,"stretch")?_b(Xt(n,"stretch","fill-available"),o)+n:n}break;case 4949:if(Vn(n,o+1)!==115)break;case 6444:switch(Vn(n,Fo(n)-3-(~Uf(n,"!important")&&10))){case 107:return Xt(n,":",":"+Qt)+n;case 101:return Xt(n,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Qt+(Vn(n,14)===45?"inline-":"")+"box$3$1"+Qt+"$2$3$1"+Fn+"$2box$3")+n}break;case 5936:switch(Vn(n,o+11)){case 114:return Qt+n+Fn+Xt(n,/[svh]\w+-[tblr]{2}/,"tb")+n;case 108:return Qt+n+Fn+Xt(n,/[svh]\w+-[tblr]{2}/,"tb-rl")+n;case 45:return Qt+n+Fn+Xt(n,/[svh]\w+-[tblr]{2}/,"lr")+n}return Qt+n+Fn+n+n}return n}var CN=function(o,s,l,i){if(o.length>-1&&!o.return)switch(o.type){case xp:o.return=_b(o.value,o.length);break;case Eb:return sl([sa(o,{value:Xt(o.value,"@","@"+Qt)})],i);case bp:if(o.length)return lN(o.props,function(c){switch(sN(c,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return sl([sa(o,{props:[Xt(c,/:(read-\w+)/,":"+Nu+"$1")]})],i);case"::placeholder":return sl([sa(o,{props:[Xt(c,/:(plac\w+)/,":"+Qt+"input-$1")]}),sa(o,{props:[Xt(c,/:(plac\w+)/,":"+Nu+"$1")]}),sa(o,{props:[Xt(c,/:(plac\w+)/,Fn+"input-$1")]})],i)}return""})}},kN=[CN],jN=function(o){var s=o.key;if(s==="css"){var l=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(l,function(S){var j=S.getAttribute("data-emotion");j.indexOf(" ")!==-1&&(document.head.appendChild(S),S.setAttribute("data-s",""))})}var i=o.stylisPlugins||kN,c={},f,m=[];f=o.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+s+' "]'),function(S){for(var j=S.getAttribute("data-emotion").split(" "),C=1;C<j.length;C++)c[j[C]]=!0;m.push(S)});var p,g=[SN,NN];{var b,x=[mN,yN(function(S){b.insert(S)})],w=gN(g.concat(i,x)),k=function(j){return sl(pN(j),w)};p=function(j,C,T,V){b=T,k(j?j+"{"+C.styles+"}":C.styles),V&&(N.inserted[C.name]=!0)}}var N={key:s,sheet:new JS({key:s,container:f,nonce:o.nonce,speedy:o.speedy,prepend:o.prepend,insertionPoint:o.insertionPoint}),nonce:o.nonce,inserted:c,registered:{},insert:p};return N.sheet.hydrate(m),N},af={exports:{}},Zt={};var cy;function MN(){if(cy)return Zt;cy=1;var n=typeof Symbol=="function"&&Symbol.for,o=n?Symbol.for("react.element"):60103,s=n?Symbol.for("react.portal"):60106,l=n?Symbol.for("react.fragment"):60107,i=n?Symbol.for("react.strict_mode"):60108,c=n?Symbol.for("react.profiler"):60114,f=n?Symbol.for("react.provider"):60109,m=n?Symbol.for("react.context"):60110,p=n?Symbol.for("react.async_mode"):60111,g=n?Symbol.for("react.concurrent_mode"):60111,b=n?Symbol.for("react.forward_ref"):60112,x=n?Symbol.for("react.suspense"):60113,w=n?Symbol.for("react.suspense_list"):60120,k=n?Symbol.for("react.memo"):60115,N=n?Symbol.for("react.lazy"):60116,S=n?Symbol.for("react.block"):60121,j=n?Symbol.for("react.fundamental"):60117,C=n?Symbol.for("react.responder"):60118,T=n?Symbol.for("react.scope"):60119;function V(R){if(typeof R=="object"&&R!==null){var z=R.$$typeof;switch(z){case o:switch(R=R.type,R){case p:case g:case l:case c:case i:case x:return R;default:switch(R=R&&R.$$typeof,R){case m:case b:case N:case k:case f:return R;default:return z}}case s:return z}}}function U(R){return V(R)===g}return Zt.AsyncMode=p,Zt.ConcurrentMode=g,Zt.ContextConsumer=m,Zt.ContextProvider=f,Zt.Element=o,Zt.ForwardRef=b,Zt.Fragment=l,Zt.Lazy=N,Zt.Memo=k,Zt.Portal=s,Zt.Profiler=c,Zt.StrictMode=i,Zt.Suspense=x,Zt.isAsyncMode=function(R){return U(R)||V(R)===p},Zt.isConcurrentMode=U,Zt.isContextConsumer=function(R){return V(R)===m},Zt.isContextProvider=function(R){return V(R)===f},Zt.isElement=function(R){return typeof R=="object"&&R!==null&&R.$$typeof===o},Zt.isForwardRef=function(R){return V(R)===b},Zt.isFragment=function(R){return V(R)===l},Zt.isLazy=function(R){return V(R)===N},Zt.isMemo=function(R){return V(R)===k},Zt.isPortal=function(R){return V(R)===s},Zt.isProfiler=function(R){return V(R)===c},Zt.isStrictMode=function(R){return V(R)===i},Zt.isSuspense=function(R){return V(R)===x},Zt.isValidElementType=function(R){return typeof R=="string"||typeof R=="function"||R===l||R===g||R===c||R===i||R===x||R===w||typeof R=="object"&&R!==null&&(R.$$typeof===N||R.$$typeof===k||R.$$typeof===f||R.$$typeof===m||R.$$typeof===b||R.$$typeof===j||R.$$typeof===C||R.$$typeof===T||R.$$typeof===S)},Zt.typeOf=V,Zt}var dy;function ON(){return dy||(dy=1,af.exports=MN()),af.exports}var uf,fy;function TN(){if(fy)return uf;fy=1;var n=ON(),o={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},s={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},l={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},i={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},c={};c[n.ForwardRef]=l,c[n.Memo]=i;function f(N){return n.isMemo(N)?i:c[N.$$typeof]||o}var m=Object.defineProperty,p=Object.getOwnPropertyNames,g=Object.getOwnPropertySymbols,b=Object.getOwnPropertyDescriptor,x=Object.getPrototypeOf,w=Object.prototype;function k(N,S,j){if(typeof S!="string"){if(w){var C=x(S);C&&C!==w&&k(N,C,j)}var T=p(S);g&&(T=T.concat(g(S)));for(var V=f(N),U=f(S),R=0;R<T.length;++R){var z=T[R];if(!s[z]&&!(j&&j[z])&&!(U&&U[z])&&!(V&&V[z])){var L=b(S,z);try{m(N,z,L)}catch{}}}}return N}return uf=k,uf}TN();var EN=!0;function IN(n,o,s){var l="";return s.split(" ").forEach(function(i){n[i]!==void 0?o.push(n[i]+";"):i&&(l+=i+" ")}),l}var Db=function(o,s,l){var i=o.key+"-"+s.name;(l===!1||EN===!1)&&o.registered[i]===void 0&&(o.registered[i]=s.styles)},LN=function(o,s,l){Db(o,s,l);var i=o.key+"-"+s.name;if(o.inserted[s.name]===void 0){var c=s;do o.insert(s===c?"."+i:"",c,o.sheet,!0),c=c.next;while(c!==void 0)}};function AN(n){for(var o=0,s,l=0,i=n.length;i>=4;++l,i-=4)s=n.charCodeAt(l)&255|(n.charCodeAt(++l)&255)<<8|(n.charCodeAt(++l)&255)<<16|(n.charCodeAt(++l)&255)<<24,s=(s&65535)*1540483477+((s>>>16)*59797<<16),s^=s>>>24,o=(s&65535)*1540483477+((s>>>16)*59797<<16)^(o&65535)*1540483477+((o>>>16)*59797<<16);switch(i){case 3:o^=(n.charCodeAt(l+2)&255)<<16;case 2:o^=(n.charCodeAt(l+1)&255)<<8;case 1:o^=n.charCodeAt(l)&255,o=(o&65535)*1540483477+((o>>>16)*59797<<16)}return o^=o>>>13,o=(o&65535)*1540483477+((o>>>16)*59797<<16),((o^o>>>15)>>>0).toString(36)}var RN={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},_N=/[A-Z]|^ms/g,DN=/_EMO_([^_]+?)_([^]*?)_EMO_/g,Bb=function(o){return o.charCodeAt(1)===45},py=function(o){return o!=null&&typeof o!="boolean"},cf=bN(function(n){return Bb(n)?n:n.replace(_N,"-$&").toLowerCase()}),hy=function(o,s){switch(o){case"animation":case"animationName":if(typeof s=="string")return s.replace(DN,function(l,i,c){return qo={name:i,styles:c,next:qo},i})}return RN[o]!==1&&!Bb(o)&&typeof s=="number"&&s!==0?s+"px":s};function Sa(n,o,s){if(s==null)return"";var l=s;if(l.__emotion_styles!==void 0)return l;switch(typeof s){case"boolean":return"";case"object":{var i=s;if(i.anim===1)return qo={name:i.name,styles:i.styles,next:qo},i.name;var c=s;if(c.styles!==void 0){var f=c.next;if(f!==void 0)for(;f!==void 0;)qo={name:f.name,styles:f.styles,next:qo},f=f.next;var m=c.styles+";";return m}return BN(n,o,s)}case"function":{if(n!==void 0){var p=qo,g=s(n);return qo=p,Sa(n,o,g)}break}}var b=s;return b}function BN(n,o,s){var l="";if(Array.isArray(s))for(var i=0;i<s.length;i++)l+=Sa(n,o,s[i])+";";else for(var c in s){var f=s[c];if(typeof f!="object"){var m=f;py(m)&&(l+=cf(c)+":"+hy(c,m)+";")}else if(Array.isArray(f)&&typeof f[0]=="string"&&o==null)for(var p=0;p<f.length;p++)py(f[p])&&(l+=cf(c)+":"+hy(c,f[p])+";");else{var g=Sa(n,o,f);switch(c){case"animation":case"animationName":{l+=cf(c)+":"+g+";";break}default:l+=c+"{"+g+"}"}}}return l}var my=/label:\s*([^\s;{]+)\s*(;|$)/g,qo;function zb(n,o,s){if(n.length===1&&typeof n[0]=="object"&&n[0]!==null&&n[0].styles!==void 0)return n[0];var l=!0,i="";qo=void 0;var c=n[0];if(c==null||c.raw===void 0)l=!1,i+=Sa(s,o,c);else{var f=c;i+=f[0]}for(var m=1;m<n.length;m++)if(i+=Sa(s,o,n[m]),l){var p=c;i+=p[m]}my.lastIndex=0;for(var g="",b;(b=my.exec(i))!==null;)g+="-"+b[1];var x=AN(i)+g;return{name:x,styles:i,next:qo}}var zN=function(o){return o()},HN=p0.useInsertionEffect?p0.useInsertionEffect:!1,VN=HN||zN,Hb=y.createContext(typeof HTMLElement<"u"?jN({key:"css"}):null);Hb.Provider;var KN=function(o){return y.forwardRef(function(s,l){var i=y.useContext(Hb);return o(s,i,l)})},UN=y.createContext({}),wp={}.hasOwnProperty,Ff="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",$N=function(o,s){var l={};for(var i in s)wp.call(s,i)&&(l[i]=s[i]);return l[Ff]=o,l},FN=function(o){var s=o.cache,l=o.serialized,i=o.isStringTag;return Db(s,l,i),VN(function(){return LN(s,l,i)}),null},qN=KN(function(n,o,s){var l=n.css;typeof l=="string"&&o.registered[l]!==void 0&&(l=o.registered[l]);var i=n[Ff],c=[l],f="";typeof n.className=="string"?f=IN(o.registered,c,n.className):n.className!=null&&(f=n.className+" ");var m=zb(c,void 0,y.useContext(UN));f+=o.key+"-"+m.name;var p={};for(var g in n)wp.call(n,g)&&g!=="css"&&g!==Ff&&(p[g]=n[g]);return p.className=f,s&&(p.ref=s),y.createElement(y.Fragment,null,y.createElement(FN,{cache:o,serialized:m,isStringTag:typeof i=="string"}),y.createElement(i,p))}),WN=qN,wt=function(o,s){var l=arguments;if(s==null||!wp.call(s,"css"))return y.createElement.apply(void 0,l);var i=l.length,c=new Array(i);c[0]=WN,c[1]=$N(o,s);for(var f=2;f<i;f++)c[f]=l[f];return y.createElement.apply(null,c)};(function(n){var o;o||(o=n.JSX||(n.JSX={}))})(wt||(wt={}));function Sp(){for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return zb(o)}function GN(){var n=Sp.apply(void 0,arguments),o="animation-"+n.name;return{name:o,styles:"@keyframes "+o+"{"+n.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}function PN(n,o){return o||(o=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(o)}}))}const YN=Math.min,QN=Math.max,Cu=Math.round,nu=Math.floor,ku=n=>({x:n,y:n});function XN(n){const{x:o,y:s,width:l,height:i}=n;return{width:l,height:i,top:s,left:o,right:o+l,bottom:s+i,x:o,y:s}}function Hu(){return typeof window<"u"}function Vb(n){return Ub(n)?(n.nodeName||"").toLowerCase():"#document"}function yr(n){var o;return(n==null||(o=n.ownerDocument)==null?void 0:o.defaultView)||window}function Kb(n){var o;return(o=(Ub(n)?n.ownerDocument:n.document)||window.document)==null?void 0:o.documentElement}function Ub(n){return Hu()?n instanceof Node||n instanceof yr(n).Node:!1}function ZN(n){return Hu()?n instanceof Element||n instanceof yr(n).Element:!1}function Np(n){return Hu()?n instanceof HTMLElement||n instanceof yr(n).HTMLElement:!1}function gy(n){return!Hu()||typeof ShadowRoot>"u"?!1:n instanceof ShadowRoot||n instanceof yr(n).ShadowRoot}const JN=new Set(["inline","contents"]);function $b(n){const{overflow:o,overflowX:s,overflowY:l,display:i}=Cp(n);return/auto|scroll|overlay|hidden|clip/.test(o+l+s)&&!JN.has(i)}function eC(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const tC=new Set(["html","body","#document"]);function nC(n){return tC.has(Vb(n))}function Cp(n){return yr(n).getComputedStyle(n)}function oC(n){if(Vb(n)==="html")return n;const o=n.assignedSlot||n.parentNode||gy(n)&&n.host||Kb(n);return gy(o)?o.host:o}function Fb(n){const o=oC(n);return nC(o)?n.ownerDocument?n.ownerDocument.body:n.body:Np(o)&&$b(o)?o:Fb(o)}function ju(n,o,s){var l;o===void 0&&(o=[]),s===void 0&&(s=!0);const i=Fb(n),c=i===((l=n.ownerDocument)==null?void 0:l.body),f=yr(i);if(c){const m=qf(f);return o.concat(f,f.visualViewport||[],$b(i)?i:[],m&&s?ju(m):[])}return o.concat(i,ju(i,[],s))}function qf(n){return n.parent&&Object.getPrototypeOf(n.parent)?n.frameElement:null}function rC(n){const o=Cp(n);let s=parseFloat(o.width)||0,l=parseFloat(o.height)||0;const i=Np(n),c=i?n.offsetWidth:s,f=i?n.offsetHeight:l,m=Cu(s)!==c||Cu(l)!==f;return m&&(s=c,l=f),{width:s,height:l,$:m}}function kp(n){return ZN(n)?n:n.contextElement}function yy(n){const o=kp(n);if(!Np(o))return ku(1);const s=o.getBoundingClientRect(),{width:l,height:i,$:c}=rC(o);let f=(c?Cu(s.width):s.width)/l,m=(c?Cu(s.height):s.height)/i;return(!f||!Number.isFinite(f))&&(f=1),(!m||!Number.isFinite(m))&&(m=1),{x:f,y:m}}const sC=ku(0);function lC(n){const o=yr(n);return!eC()||!o.visualViewport?sC:{x:o.visualViewport.offsetLeft,y:o.visualViewport.offsetTop}}function aC(n,o,s){return!1}function by(n,o,s,l){o===void 0&&(o=!1);const i=n.getBoundingClientRect(),c=kp(n);let f=ku(1);o&&(f=yy(n));const m=aC()?lC(c):ku(0);let p=(i.left+m.x)/f.x,g=(i.top+m.y)/f.y,b=i.width/f.x,x=i.height/f.y;if(c){const w=yr(c),k=l;let N=w,S=qf(N);for(;S&&l&&k!==N;){const j=yy(S),C=S.getBoundingClientRect(),T=Cp(S),V=C.left+(S.clientLeft+parseFloat(T.paddingLeft))*j.x,U=C.top+(S.clientTop+parseFloat(T.paddingTop))*j.y;p*=j.x,g*=j.y,b*=j.x,x*=j.y,p+=V,g+=U,N=yr(S),S=qf(N)}}return XN({width:b,height:x,x:p,y:g})}function qb(n,o){return n.x===o.x&&n.y===o.y&&n.width===o.width&&n.height===o.height}function iC(n,o){let s=null,l;const i=Kb(n);function c(){var m;clearTimeout(l),(m=s)==null||m.disconnect(),s=null}function f(m,p){m===void 0&&(m=!1),p===void 0&&(p=1),c();const g=n.getBoundingClientRect(),{left:b,top:x,width:w,height:k}=g;if(m||o(),!w||!k)return;const N=nu(x),S=nu(i.clientWidth-(b+w)),j=nu(i.clientHeight-(x+k)),C=nu(b),V={rootMargin:-N+"px "+-S+"px "+-j+"px "+-C+"px",threshold:QN(0,YN(1,p))||1};let U=!0;function R(z){const L=z[0].intersectionRatio;if(L!==p){if(!U)return f();L?f(!1,L):l=setTimeout(()=>{f(!1,1e-7)},1e3)}L===1&&!qb(g,n.getBoundingClientRect())&&f(),U=!1}try{s=new IntersectionObserver(R,{...V,root:i.ownerDocument})}catch{s=new IntersectionObserver(R,V)}s.observe(n)}return f(!0),c}function uC(n,o,s,l){l===void 0&&(l={});const{ancestorScroll:i=!0,ancestorResize:c=!0,elementResize:f=typeof ResizeObserver=="function",layoutShift:m=typeof IntersectionObserver=="function",animationFrame:p=!1}=l,g=kp(n),b=i||c?[...g?ju(g):[],...ju(o)]:[];b.forEach(C=>{i&&C.addEventListener("scroll",s,{passive:!0}),c&&C.addEventListener("resize",s)});const x=g&&m?iC(g,s):null;let w=-1,k=null;f&&(k=new ResizeObserver(C=>{let[T]=C;T&&T.target===g&&k&&(k.unobserve(o),cancelAnimationFrame(w),w=requestAnimationFrame(()=>{var V;(V=k)==null||V.observe(o)})),s()}),g&&!p&&k.observe(g),k.observe(o));let N,S=p?by(n):null;p&&j();function j(){const C=by(n);S&&!qb(S,C)&&s(),S=C,N=requestAnimationFrame(j)}return s(),()=>{var C;b.forEach(T=>{i&&T.removeEventListener("scroll",s),c&&T.removeEventListener("resize",s)}),x?.(),(C=k)==null||C.disconnect(),k=null,p&&cancelAnimationFrame(N)}}var Wf=y.useLayoutEffect,cC=["className","clearValue","cx","getStyles","getClassNames","getValue","hasValue","isMulti","isRtl","options","selectOption","selectProps","setValue","theme"],Mu=function(){};function dC(n,o){return o?o[0]==="-"?n+o:n+"__"+o:n}function fC(n,o){for(var s=arguments.length,l=new Array(s>2?s-2:0),i=2;i<s;i++)l[i-2]=arguments[i];var c=[].concat(l);if(o&&n)for(var f in o)o.hasOwnProperty(f)&&o[f]&&c.push("".concat(dC(n,f)));return c.filter(function(m){return m}).map(function(m){return String(m).trim()}).join(" ")}var xy=function(o){return wC(o)?o.filter(Boolean):ys(o)==="object"&&o!==null?[o]:[]},Wb=function(o){o.className,o.clearValue,o.cx,o.getStyles,o.getClassNames,o.getValue,o.hasValue,o.isMulti,o.isRtl,o.options,o.selectOption,o.selectProps,o.setValue,o.theme;var s=vr(o,cC);return Ct({},s)},xn=function(o,s,l){var i=o.cx,c=o.getStyles,f=o.getClassNames,m=o.className;return{css:c(s,o),className:i(l??{},f(s,o),m)}};function Vu(n){return[document.documentElement,document.body,window].indexOf(n)>-1}function pC(n){return Vu(n)?window.innerHeight:n.clientHeight}function Gb(n){return Vu(n)?window.pageYOffset:n.scrollTop}function Ou(n,o){if(Vu(n)){window.scrollTo(0,o);return}n.scrollTop=o}function hC(n){var o=getComputedStyle(n),s=o.position==="absolute",l=/(auto|scroll)/;if(o.position==="fixed")return document.documentElement;for(var i=n;i=i.parentElement;)if(o=getComputedStyle(i),!(s&&o.position==="static")&&l.test(o.overflow+o.overflowY+o.overflowX))return i;return document.documentElement}function mC(n,o,s,l){return s*((n=n/l-1)*n*n+1)+o}function ou(n,o){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:200,l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Mu,i=Gb(n),c=o-i,f=10,m=0;function p(){m+=f;var g=mC(m,i,c,s);Ou(n,g),m<s?window.requestAnimationFrame(p):l(n)}p()}function vy(n,o){var s=n.getBoundingClientRect(),l=o.getBoundingClientRect(),i=o.offsetHeight/3;l.bottom+i>s.bottom?Ou(n,Math.min(o.offsetTop+o.clientHeight-n.offsetHeight+i,n.scrollHeight)):l.top-i<s.top&&Ou(n,Math.max(o.offsetTop-i,0))}function gC(n){var o=n.getBoundingClientRect();return{bottom:o.bottom,height:o.height,left:o.left,right:o.right,top:o.top,width:o.width}}function wy(){try{return document.createEvent("TouchEvent"),!0}catch{return!1}}function yC(){try{return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}catch{return!1}}var Pb=!1,bC={get passive(){return Pb=!0}},ru=typeof window<"u"?window:{};ru.addEventListener&&ru.removeEventListener&&(ru.addEventListener("p",Mu,bC),ru.removeEventListener("p",Mu,!1));var xC=Pb;function vC(n){return n!=null}function wC(n){return Array.isArray(n)}function su(n,o,s){return n?o:s}var SC=function(o){for(var s=arguments.length,l=new Array(s>1?s-1:0),i=1;i<s;i++)l[i-1]=arguments[i];var c=Object.entries(o).filter(function(f){var m=mr(f,1),p=m[0];return!l.includes(p)});return c.reduce(function(f,m){var p=mr(m,2),g=p[0],b=p[1];return f[g]=b,f},{})},NC=["children","innerProps"],CC=["children","innerProps"];function kC(n){var o=n.maxHeight,s=n.menuEl,l=n.minHeight,i=n.placement,c=n.shouldScroll,f=n.isFixedPosition,m=n.controlHeight,p=hC(s),g={placement:"bottom",maxHeight:o};if(!s||!s.offsetParent)return g;var b=p.getBoundingClientRect(),x=b.height,w=s.getBoundingClientRect(),k=w.bottom,N=w.height,S=w.top,j=s.offsetParent.getBoundingClientRect(),C=j.top,T=f?window.innerHeight:pC(p),V=Gb(p),U=parseInt(getComputedStyle(s).marginBottom,10),R=parseInt(getComputedStyle(s).marginTop,10),z=C-R,L=T-S,$=z+V,Q=x-V-S,ue=k-T+V+U,fe=V+S-R,de=160;switch(i){case"auto":case"bottom":if(L>=N)return{placement:"bottom",maxHeight:o};if(Q>=N&&!f)return c&&ou(p,ue,de),{placement:"bottom",maxHeight:o};if(!f&&Q>=l||f&&L>=l){c&&ou(p,ue,de);var Ie=f?L-U:Q-U;return{placement:"bottom",maxHeight:Ie}}if(i==="auto"||f){var je=o,Me=f?z:$;return Me>=l&&(je=Math.min(Me-U-m,o)),{placement:"top",maxHeight:je}}if(i==="bottom")return c&&Ou(p,ue),{placement:"bottom",maxHeight:o};break;case"top":if(z>=N)return{placement:"top",maxHeight:o};if($>=N&&!f)return c&&ou(p,fe,de),{placement:"top",maxHeight:o};if(!f&&$>=l||f&&z>=l){var _=o;return(!f&&$>=l||f&&z>=l)&&(_=f?z-R:$-R),c&&ou(p,fe,de),{placement:"top",maxHeight:_}}return{placement:"bottom",maxHeight:o};default:throw new Error('Invalid placement provided "'.concat(i,'".'))}return g}function jC(n){var o={bottom:"top",top:"bottom"};return n?o[n]:"bottom"}var Yb=function(o){return o==="auto"?"bottom":o},MC=function(o,s){var l,i=o.placement,c=o.theme,f=c.borderRadius,m=c.spacing,p=c.colors;return Ct((l={label:"menu"},ia(l,jC(i),"100%"),ia(l,"position","absolute"),ia(l,"width","100%"),ia(l,"zIndex",1),l),s?{}:{backgroundColor:p.neutral0,borderRadius:f,boxShadow:"0 0 0 1px hsla(0, 0%, 0%, 0.1), 0 4px 11px hsla(0, 0%, 0%, 0.1)",marginBottom:m.menuGutter,marginTop:m.menuGutter})},Qb=y.createContext(null),OC=function(o){var s=o.children,l=o.minMenuHeight,i=o.maxMenuHeight,c=o.menuPlacement,f=o.menuPosition,m=o.menuShouldScrollIntoView,p=o.theme,g=y.useContext(Qb)||{},b=g.setPortalPlacement,x=y.useRef(null),w=y.useState(i),k=mr(w,2),N=k[0],S=k[1],j=y.useState(null),C=mr(j,2),T=C[0],V=C[1],U=p.spacing.controlHeight;return Wf(function(){var R=x.current;if(R){var z=f==="fixed",L=m&&!z,$=kC({maxHeight:i,menuEl:R,minHeight:l,placement:c,shouldScroll:L,isFixedPosition:z,controlHeight:U});S($.maxHeight),V($.placement),b?.($.placement)}},[i,c,f,m,l,b,U]),s({ref:x,placerProps:Ct(Ct({},o),{},{placement:T||Yb(c),maxHeight:N})})},TC=function(o){var s=o.children,l=o.innerRef,i=o.innerProps;return wt("div",Mt({},xn(o,"menu",{menu:!0}),{ref:l},i),s)},EC=TC,IC=function(o,s){var l=o.maxHeight,i=o.theme.spacing.baseUnit;return Ct({maxHeight:l,overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},s?{}:{paddingBottom:i,paddingTop:i})},LC=function(o){var s=o.children,l=o.innerProps,i=o.innerRef,c=o.isMulti;return wt("div",Mt({},xn(o,"menuList",{"menu-list":!0,"menu-list--is-multi":c}),{ref:i},l),s)},Xb=function(o,s){var l=o.theme,i=l.spacing.baseUnit,c=l.colors;return Ct({textAlign:"center"},s?{}:{color:c.neutral40,padding:"".concat(i*2,"px ").concat(i*3,"px")})},AC=Xb,RC=Xb,_C=function(o){var s=o.children,l=s===void 0?"No options":s,i=o.innerProps,c=vr(o,NC);return wt("div",Mt({},xn(Ct(Ct({},c),{},{children:l,innerProps:i}),"noOptionsMessage",{"menu-notice":!0,"menu-notice--no-options":!0}),i),l)},DC=function(o){var s=o.children,l=s===void 0?"Loading...":s,i=o.innerProps,c=vr(o,CC);return wt("div",Mt({},xn(Ct(Ct({},c),{},{children:l,innerProps:i}),"loadingMessage",{"menu-notice":!0,"menu-notice--loading":!0}),i),l)},BC=function(o){var s=o.rect,l=o.offset,i=o.position;return{left:s.left,position:i,top:l,width:s.width,zIndex:1}},zC=function(o){var s=o.appendTo,l=o.children,i=o.controlElement,c=o.innerProps,f=o.menuPlacement,m=o.menuPosition,p=y.useRef(null),g=y.useRef(null),b=y.useState(Yb(f)),x=mr(b,2),w=x[0],k=x[1],N=y.useMemo(function(){return{setPortalPlacement:k}},[]),S=y.useState(null),j=mr(S,2),C=j[0],T=j[1],V=y.useCallback(function(){if(i){var L=gC(i),$=m==="fixed"?0:window.pageYOffset,Q=L[w]+$;(Q!==C?.offset||L.left!==C?.rect.left||L.width!==C?.rect.width)&&T({offset:Q,rect:L})}},[i,m,w,C?.offset,C?.rect.left,C?.rect.width]);Wf(function(){V()},[V]);var U=y.useCallback(function(){typeof g.current=="function"&&(g.current(),g.current=null),i&&p.current&&(g.current=uC(i,p.current,V,{elementResize:"ResizeObserver"in window}))},[i,V]);Wf(function(){U()},[U]);var R=y.useCallback(function(L){p.current=L,U()},[U]);if(!s&&m!=="fixed"||!C)return null;var z=wt("div",Mt({ref:R},xn(Ct(Ct({},o),{},{offset:C.offset,position:m,rect:C.rect}),"menuPortal",{"menu-portal":!0}),c),l);return wt(Qb.Provider,{value:N},s?En.createPortal(z,s):z)},HC=function(o){var s=o.isDisabled,l=o.isRtl;return{label:"container",direction:l?"rtl":void 0,pointerEvents:s?"none":void 0,position:"relative"}},VC=function(o){var s=o.children,l=o.innerProps,i=o.isDisabled,c=o.isRtl;return wt("div",Mt({},xn(o,"container",{"--is-disabled":i,"--is-rtl":c}),l),s)},KC=function(o,s){var l=o.theme.spacing,i=o.isMulti,c=o.hasValue,f=o.selectProps.controlShouldRenderValue;return Ct({alignItems:"center",display:i&&c&&f?"flex":"grid",flex:1,flexWrap:"wrap",WebkitOverflowScrolling:"touch",position:"relative",overflow:"hidden"},s?{}:{padding:"".concat(l.baseUnit/2,"px ").concat(l.baseUnit*2,"px")})},UC=function(o){var s=o.children,l=o.innerProps,i=o.isMulti,c=o.hasValue;return wt("div",Mt({},xn(o,"valueContainer",{"value-container":!0,"value-container--is-multi":i,"value-container--has-value":c}),l),s)},$C=function(){return{alignItems:"center",alignSelf:"stretch",display:"flex",flexShrink:0}},FC=function(o){var s=o.children,l=o.innerProps;return wt("div",Mt({},xn(o,"indicatorsContainer",{indicators:!0}),l),s)},Sy,qC=["size"],WC=["innerProps","isRtl","size"],GC={name:"8mmkcg",styles:"display:inline-block;fill:currentColor;line-height:1;stroke:currentColor;stroke-width:0"},Zb=function(o){var s=o.size,l=vr(o,qC);return wt("svg",Mt({height:s,width:s,viewBox:"0 0 20 20","aria-hidden":"true",focusable:"false",css:GC},l))},jp=function(o){return wt(Zb,Mt({size:20},o),wt("path",{d:"M14.348 14.849c-0.469 0.469-1.229 0.469-1.697 0l-2.651-3.030-2.651 3.029c-0.469 0.469-1.229 0.469-1.697 0-0.469-0.469-0.469-1.229 0-1.697l2.758-3.15-2.759-3.152c-0.469-0.469-0.469-1.228 0-1.697s1.228-0.469 1.697 0l2.652 3.031 2.651-3.031c0.469-0.469 1.228-0.469 1.697 0s0.469 1.229 0 1.697l-2.758 3.152 2.758 3.15c0.469 0.469 0.469 1.229 0 1.698z"}))},Jb=function(o){return wt(Zb,Mt({size:20},o),wt("path",{d:"M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"}))},ex=function(o,s){var l=o.isFocused,i=o.theme,c=i.spacing.baseUnit,f=i.colors;return Ct({label:"indicatorContainer",display:"flex",transition:"color 150ms"},s?{}:{color:l?f.neutral60:f.neutral20,padding:c*2,":hover":{color:l?f.neutral80:f.neutral40}})},PC=ex,YC=function(o){var s=o.children,l=o.innerProps;return wt("div",Mt({},xn(o,"dropdownIndicator",{indicator:!0,"dropdown-indicator":!0}),l),s||wt(Jb,null))},QC=ex,XC=function(o){var s=o.children,l=o.innerProps;return wt("div",Mt({},xn(o,"clearIndicator",{indicator:!0,"clear-indicator":!0}),l),s||wt(jp,null))},ZC=function(o,s){var l=o.isDisabled,i=o.theme,c=i.spacing.baseUnit,f=i.colors;return Ct({label:"indicatorSeparator",alignSelf:"stretch",width:1},s?{}:{backgroundColor:l?f.neutral10:f.neutral20,marginBottom:c*2,marginTop:c*2})},JC=function(o){var s=o.innerProps;return wt("span",Mt({},s,xn(o,"indicatorSeparator",{"indicator-separator":!0})))},e3=GN(Sy||(Sy=PN([`
  0%, 80%, 100% { opacity: 0; }
  40% { opacity: 1; }
`]))),t3=function(o,s){var l=o.isFocused,i=o.size,c=o.theme,f=c.colors,m=c.spacing.baseUnit;return Ct({label:"loadingIndicator",display:"flex",transition:"color 150ms",alignSelf:"center",fontSize:i,lineHeight:1,marginRight:i,textAlign:"center",verticalAlign:"middle"},s?{}:{color:l?f.neutral60:f.neutral20,padding:m*2})},df=function(o){var s=o.delay,l=o.offset;return wt("span",{css:Sp({animation:"".concat(e3," 1s ease-in-out ").concat(s,"ms infinite;"),backgroundColor:"currentColor",borderRadius:"1em",display:"inline-block",marginLeft:l?"1em":void 0,height:"1em",verticalAlign:"top",width:"1em"},"","")})},n3=function(o){var s=o.innerProps,l=o.isRtl,i=o.size,c=i===void 0?4:i,f=vr(o,WC);return wt("div",Mt({},xn(Ct(Ct({},f),{},{innerProps:s,isRtl:l,size:c}),"loadingIndicator",{indicator:!0,"loading-indicator":!0}),s),wt(df,{delay:0,offset:l}),wt(df,{delay:160,offset:!0}),wt(df,{delay:320,offset:!l}))},o3=function(o,s){var l=o.isDisabled,i=o.isFocused,c=o.theme,f=c.colors,m=c.borderRadius,p=c.spacing;return Ct({label:"control",alignItems:"center",cursor:"default",display:"flex",flexWrap:"wrap",justifyContent:"space-between",minHeight:p.controlHeight,outline:"0 !important",position:"relative",transition:"all 100ms"},s?{}:{backgroundColor:l?f.neutral5:f.neutral0,borderColor:l?f.neutral10:i?f.primary:f.neutral20,borderRadius:m,borderStyle:"solid",borderWidth:1,boxShadow:i?"0 0 0 1px ".concat(f.primary):void 0,"&:hover":{borderColor:i?f.primary:f.neutral30}})},r3=function(o){var s=o.children,l=o.isDisabled,i=o.isFocused,c=o.innerRef,f=o.innerProps,m=o.menuIsOpen;return wt("div",Mt({ref:c},xn(o,"control",{control:!0,"control--is-disabled":l,"control--is-focused":i,"control--menu-is-open":m}),f,{"aria-disabled":l||void 0}),s)},s3=r3,l3=["data"],a3=function(o,s){var l=o.theme.spacing;return s?{}:{paddingBottom:l.baseUnit*2,paddingTop:l.baseUnit*2}},i3=function(o){var s=o.children,l=o.cx,i=o.getStyles,c=o.getClassNames,f=o.Heading,m=o.headingProps,p=o.innerProps,g=o.label,b=o.theme,x=o.selectProps;return wt("div",Mt({},xn(o,"group",{group:!0}),p),wt(f,Mt({},m,{selectProps:x,theme:b,getStyles:i,getClassNames:c,cx:l}),g),wt("div",null,s))},u3=function(o,s){var l=o.theme,i=l.colors,c=l.spacing;return Ct({label:"group",cursor:"default",display:"block"},s?{}:{color:i.neutral40,fontSize:"75%",fontWeight:500,marginBottom:"0.25em",paddingLeft:c.baseUnit*3,paddingRight:c.baseUnit*3,textTransform:"uppercase"})},c3=function(o){var s=Wb(o);s.data;var l=vr(s,l3);return wt("div",Mt({},xn(o,"groupHeading",{"group-heading":!0}),l))},d3=i3,f3=["innerRef","isDisabled","isHidden","inputClassName"],p3=function(o,s){var l=o.isDisabled,i=o.value,c=o.theme,f=c.spacing,m=c.colors;return Ct(Ct({visibility:l?"hidden":"visible",transform:i?"translateZ(0)":""},h3),s?{}:{margin:f.baseUnit/2,paddingBottom:f.baseUnit/2,paddingTop:f.baseUnit/2,color:m.neutral80})},tx={gridArea:"1 / 2",font:"inherit",minWidth:"2px",border:0,margin:0,outline:0,padding:0},h3={flex:"1 1 auto",display:"inline-grid",gridArea:"1 / 1 / 2 / 3",gridTemplateColumns:"0 min-content","&:after":Ct({content:'attr(data-value) " "',visibility:"hidden",whiteSpace:"pre"},tx)},m3=function(o){return Ct({label:"input",color:"inherit",background:0,opacity:o?0:1,width:"100%"},tx)},g3=function(o){var s=o.cx,l=o.value,i=Wb(o),c=i.innerRef,f=i.isDisabled,m=i.isHidden,p=i.inputClassName,g=vr(i,f3);return wt("div",Mt({},xn(o,"input",{"input-container":!0}),{"data-value":l||""}),wt("input",Mt({className:s({input:!0},p),ref:c,style:m3(m),disabled:f},g)))},y3=g3,b3=function(o,s){var l=o.theme,i=l.spacing,c=l.borderRadius,f=l.colors;return Ct({label:"multiValue",display:"flex",minWidth:0},s?{}:{backgroundColor:f.neutral10,borderRadius:c/2,margin:i.baseUnit/2})},x3=function(o,s){var l=o.theme,i=l.borderRadius,c=l.colors,f=o.cropWithEllipsis;return Ct({overflow:"hidden",textOverflow:f||f===void 0?"ellipsis":void 0,whiteSpace:"nowrap"},s?{}:{borderRadius:i/2,color:c.neutral80,fontSize:"85%",padding:3,paddingLeft:6})},v3=function(o,s){var l=o.theme,i=l.spacing,c=l.borderRadius,f=l.colors,m=o.isFocused;return Ct({alignItems:"center",display:"flex"},s?{}:{borderRadius:c/2,backgroundColor:m?f.dangerLight:void 0,paddingLeft:i.baseUnit,paddingRight:i.baseUnit,":hover":{backgroundColor:f.dangerLight,color:f.danger}})},nx=function(o){var s=o.children,l=o.innerProps;return wt("div",l,s)},w3=nx,S3=nx;function N3(n){var o=n.children,s=n.innerProps;return wt("div",Mt({role:"button"},s),o||wt(jp,{size:14}))}var C3=function(o){var s=o.children,l=o.components,i=o.data,c=o.innerProps,f=o.isDisabled,m=o.removeProps,p=o.selectProps,g=l.Container,b=l.Label,x=l.Remove;return wt(g,{data:i,innerProps:Ct(Ct({},xn(o,"multiValue",{"multi-value":!0,"multi-value--is-disabled":f})),c),selectProps:p},wt(b,{data:i,innerProps:Ct({},xn(o,"multiValueLabel",{"multi-value__label":!0})),selectProps:p},s),wt(x,{data:i,innerProps:Ct(Ct({},xn(o,"multiValueRemove",{"multi-value__remove":!0})),{},{"aria-label":"Remove ".concat(s||"option")},m),selectProps:p}))},k3=C3,j3=function(o,s){var l=o.isDisabled,i=o.isFocused,c=o.isSelected,f=o.theme,m=f.spacing,p=f.colors;return Ct({label:"option",cursor:"default",display:"block",fontSize:"inherit",width:"100%",userSelect:"none",WebkitTapHighlightColor:"rgba(0, 0, 0, 0)"},s?{}:{backgroundColor:c?p.primary:i?p.primary25:"transparent",color:l?p.neutral20:c?p.neutral0:"inherit",padding:"".concat(m.baseUnit*2,"px ").concat(m.baseUnit*3,"px"),":active":{backgroundColor:l?void 0:c?p.primary:p.primary50}})},M3=function(o){var s=o.children,l=o.isDisabled,i=o.isFocused,c=o.isSelected,f=o.innerRef,m=o.innerProps;return wt("div",Mt({},xn(o,"option",{option:!0,"option--is-disabled":l,"option--is-focused":i,"option--is-selected":c}),{ref:f,"aria-disabled":l},m),s)},O3=M3,T3=function(o,s){var l=o.theme,i=l.spacing,c=l.colors;return Ct({label:"placeholder",gridArea:"1 / 1 / 2 / 3"},s?{}:{color:c.neutral50,marginLeft:i.baseUnit/2,marginRight:i.baseUnit/2})},E3=function(o){var s=o.children,l=o.innerProps;return wt("div",Mt({},xn(o,"placeholder",{placeholder:!0}),l),s)},I3=E3,L3=function(o,s){var l=o.isDisabled,i=o.theme,c=i.spacing,f=i.colors;return Ct({label:"singleValue",gridArea:"1 / 1 / 2 / 3",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},s?{}:{color:l?f.neutral40:f.neutral80,marginLeft:c.baseUnit/2,marginRight:c.baseUnit/2})},A3=function(o){var s=o.children,l=o.isDisabled,i=o.innerProps;return wt("div",Mt({},xn(o,"singleValue",{"single-value":!0,"single-value--is-disabled":l}),i),s)},R3=A3,ox={ClearIndicator:XC,Control:s3,DropdownIndicator:YC,DownChevron:Jb,CrossIcon:jp,Group:d3,GroupHeading:c3,IndicatorsContainer:FC,IndicatorSeparator:JC,Input:y3,LoadingIndicator:n3,Menu:EC,MenuList:LC,MenuPortal:zC,LoadingMessage:DC,NoOptionsMessage:_C,MultiValue:k3,MultiValueContainer:w3,MultiValueLabel:S3,MultiValueRemove:N3,Option:O3,Placeholder:I3,SelectContainer:VC,SingleValue:R3,ValueContainer:UC},_3=function(o){return Ct(Ct({},ox),o.components)},Ny=Number.isNaN||function(o){return typeof o=="number"&&o!==o};function D3(n,o){return!!(n===o||Ny(n)&&Ny(o))}function B3(n,o){if(n.length!==o.length)return!1;for(var s=0;s<n.length;s++)if(!D3(n[s],o[s]))return!1;return!0}function z3(n,o){o===void 0&&(o=B3);var s=null;function l(){for(var i=[],c=0;c<arguments.length;c++)i[c]=arguments[c];if(s&&s.lastThis===this&&o(i,s.lastArgs))return s.lastResult;var f=n.apply(this,i);return s={lastResult:f,lastArgs:i,lastThis:this},f}return l.clear=function(){s=null},l}var H3={name:"7pg0cj-a11yText",styles:"label:a11yText;z-index:9999;border:0;clip:rect(1px, 1px, 1px, 1px);height:1px;width:1px;position:absolute;overflow:hidden;padding:0;white-space:nowrap"},V3=function(o){return wt("span",Mt({css:H3},o))},Cy=V3,K3={guidance:function(o){var s=o.isSearchable,l=o.isMulti,i=o.tabSelectsValue,c=o.context,f=o.isInitialFocus;switch(c){case"menu":return"Use Up and Down to choose options, press Enter to select the currently focused option, press Escape to exit the menu".concat(i?", press Tab to select the option and exit the menu":"",".");case"input":return f?"".concat(o["aria-label"]||"Select"," is focused ").concat(s?",type to refine list":"",", press Down to open the menu, ").concat(l?" press left to focus selected values":""):"";case"value":return"Use left and right to toggle between focused values, press Backspace to remove the currently focused value";default:return""}},onChange:function(o){var s=o.action,l=o.label,i=l===void 0?"":l,c=o.labels,f=o.isDisabled;switch(s){case"deselect-option":case"pop-value":case"remove-value":return"option ".concat(i,", deselected.");case"clear":return"All selected options have been cleared.";case"initial-input-focus":return"option".concat(c.length>1?"s":""," ").concat(c.join(","),", selected.");case"select-option":return f?"option ".concat(i," is disabled. Select another option."):"option ".concat(i,", selected.");default:return""}},onFocus:function(o){var s=o.context,l=o.focused,i=o.options,c=o.label,f=c===void 0?"":c,m=o.selectValue,p=o.isDisabled,g=o.isSelected,b=o.isAppleDevice,x=function(S,j){return S&&S.length?"".concat(S.indexOf(j)+1," of ").concat(S.length):""};if(s==="value"&&m)return"value ".concat(f," focused, ").concat(x(m,l),".");if(s==="menu"&&b){var w=p?" disabled":"",k="".concat(g?" selected":"").concat(w);return"".concat(f).concat(k,", ").concat(x(i,l),".")}return""},onFilter:function(o){var s=o.inputValue,l=o.resultsMessage;return"".concat(l).concat(s?" for search term "+s:"",".")}},U3=function(o){var s=o.ariaSelection,l=o.focusedOption,i=o.focusedValue,c=o.focusableOptions,f=o.isFocused,m=o.selectValue,p=o.selectProps,g=o.id,b=o.isAppleDevice,x=p.ariaLiveMessages,w=p.getOptionLabel,k=p.inputValue,N=p.isMulti,S=p.isOptionDisabled,j=p.isSearchable,C=p.menuIsOpen,T=p.options,V=p.screenReaderStatus,U=p.tabSelectsValue,R=p.isLoading,z=p["aria-label"],L=p["aria-live"],$=y.useMemo(function(){return Ct(Ct({},K3),x||{})},[x]),Q=y.useMemo(function(){var Me="";if(s&&$.onChange){var _=s.option,oe=s.options,ce=s.removedValue,Ke=s.removedValues,Le=s.value,E=function(Ne){return Array.isArray(Ne)?null:Ne},A=ce||_||E(Le),M=A?w(A):"",ee=oe||Ke||void 0,Te=ee?ee.map(w):[],qe=Ct({isDisabled:A&&S(A,m),label:M,labels:Te},s);Me=$.onChange(qe)}return Me},[s,$,S,m,w]),ue=y.useMemo(function(){var Me="",_=l||i,oe=!!(l&&m&&m.includes(l));if(_&&$.onFocus){var ce={focused:_,label:w(_),isDisabled:S(_,m),isSelected:oe,options:c,context:_===l?"menu":"value",selectValue:m,isAppleDevice:b};Me=$.onFocus(ce)}return Me},[l,i,w,S,$,c,m,b]),fe=y.useMemo(function(){var Me="";if(C&&T.length&&!R&&$.onFilter){var _=V({count:c.length});Me=$.onFilter({inputValue:k,resultsMessage:_})}return Me},[c,k,C,$,T,V,R]),de=s?.action==="initial-input-focus",Ie=y.useMemo(function(){var Me="";if($.guidance){var _=i?"value":C?"menu":"input";Me=$.guidance({"aria-label":z,context:_,isDisabled:l&&S(l,m),isMulti:N,isSearchable:j,tabSelectsValue:U,isInitialFocus:de})}return Me},[z,l,i,N,S,j,C,$,m,U,de]),je=wt(y.Fragment,null,wt("span",{id:"aria-selection"},Q),wt("span",{id:"aria-focused"},ue),wt("span",{id:"aria-results"},fe),wt("span",{id:"aria-guidance"},Ie));return wt(y.Fragment,null,wt(Cy,{id:g},de&&je),wt(Cy,{"aria-live":L,"aria-atomic":"false","aria-relevant":"additions text",role:"log"},f&&!de&&je))},$3=U3,Gf=[{base:"A",letters:"A"},{base:"AA",letters:""},{base:"AE",letters:""},{base:"AO",letters:""},{base:"AU",letters:""},{base:"AV",letters:""},{base:"AY",letters:""},{base:"B",letters:"B"},{base:"C",letters:"C"},{base:"D",letters:"D"},{base:"DZ",letters:""},{base:"Dz",letters:""},{base:"E",letters:"E"},{base:"F",letters:"F"},{base:"G",letters:"G"},{base:"H",letters:"H"},{base:"I",letters:"I"},{base:"J",letters:"J"},{base:"K",letters:"K"},{base:"L",letters:"L"},{base:"LJ",letters:""},{base:"Lj",letters:""},{base:"M",letters:"M"},{base:"N",letters:"N"},{base:"NJ",letters:""},{base:"Nj",letters:""},{base:"O",letters:"O"},{base:"OI",letters:""},{base:"OO",letters:""},{base:"OU",letters:""},{base:"P",letters:"P"},{base:"Q",letters:"Q"},{base:"R",letters:"R"},{base:"S",letters:"S"},{base:"T",letters:"T"},{base:"TZ",letters:""},{base:"U",letters:"U"},{base:"V",letters:"V"},{base:"VY",letters:""},{base:"W",letters:"W"},{base:"X",letters:"X"},{base:"Y",letters:"Y"},{base:"Z",letters:"Z"},{base:"a",letters:"a"},{base:"aa",letters:""},{base:"ae",letters:""},{base:"ao",letters:""},{base:"au",letters:""},{base:"av",letters:""},{base:"ay",letters:""},{base:"b",letters:"b"},{base:"c",letters:"c"},{base:"d",letters:"d"},{base:"dz",letters:""},{base:"e",letters:"e"},{base:"f",letters:"f"},{base:"g",letters:"g"},{base:"h",letters:"h"},{base:"hv",letters:""},{base:"i",letters:"i"},{base:"j",letters:"j"},{base:"k",letters:"k"},{base:"l",letters:"l"},{base:"lj",letters:""},{base:"m",letters:"m"},{base:"n",letters:"n"},{base:"nj",letters:""},{base:"o",letters:"o"},{base:"oi",letters:""},{base:"ou",letters:""},{base:"oo",letters:""},{base:"p",letters:"p"},{base:"q",letters:"q"},{base:"r",letters:"r"},{base:"s",letters:"s"},{base:"t",letters:"t"},{base:"tz",letters:""},{base:"u",letters:"u"},{base:"v",letters:"v"},{base:"vy",letters:""},{base:"w",letters:"w"},{base:"x",letters:"x"},{base:"y",letters:"y"},{base:"z",letters:"z"}],F3=new RegExp("["+Gf.map(function(n){return n.letters}).join("")+"]","g"),rx={};for(var ff=0;ff<Gf.length;ff++)for(var pf=Gf[ff],hf=0;hf<pf.letters.length;hf++)rx[pf.letters[hf]]=pf.base;var sx=function(o){return o.replace(F3,function(s){return rx[s]})},q3=z3(sx),ky=function(o){return o.replace(/^\s+|\s+$/g,"")},W3=function(o){return"".concat(o.label," ").concat(o.value)},Pf=function(o){return function(s,l){if(s.data.__isNew__)return!0;var i=Ct({ignoreCase:!0,ignoreAccents:!0,stringify:W3,trim:!0,matchFrom:"any"},o),c=i.ignoreCase,f=i.ignoreAccents,m=i.stringify,p=i.trim,g=i.matchFrom,b=p?ky(l):l,x=p?ky(m(s)):m(s);return c&&(b=b.toLowerCase(),x=x.toLowerCase()),f&&(b=q3(b),x=sx(x)),g==="start"?x.substr(0,b.length)===b:x.indexOf(b)>-1}},G3=["innerRef"];function P3(n){var o=n.innerRef,s=vr(n,G3),l=SC(s,"onExited","in","enter","exit","appear");return wt("input",Mt({ref:o},l,{css:Sp({label:"dummyInput",background:0,border:0,caretColor:"transparent",fontSize:"inherit",gridArea:"1 / 1 / 2 / 3",outline:0,padding:0,width:1,color:"transparent",left:-100,opacity:0,position:"relative",transform:"scale(.01)"},"","")}))}var Y3=function(o){o.cancelable&&o.preventDefault(),o.stopPropagation()};function Q3(n){var o=n.isEnabled,s=n.onBottomArrive,l=n.onBottomLeave,i=n.onTopArrive,c=n.onTopLeave,f=y.useRef(!1),m=y.useRef(!1),p=y.useRef(0),g=y.useRef(null),b=y.useCallback(function(j,C){if(g.current!==null){var T=g.current,V=T.scrollTop,U=T.scrollHeight,R=T.clientHeight,z=g.current,L=C>0,$=U-R-V,Q=!1;$>C&&f.current&&(l&&l(j),f.current=!1),L&&m.current&&(c&&c(j),m.current=!1),L&&C>$?(s&&!f.current&&s(j),z.scrollTop=U,Q=!0,f.current=!0):!L&&-C>V&&(i&&!m.current&&i(j),z.scrollTop=0,Q=!0,m.current=!0),Q&&Y3(j)}},[s,l,i,c]),x=y.useCallback(function(j){b(j,j.deltaY)},[b]),w=y.useCallback(function(j){p.current=j.changedTouches[0].clientY},[]),k=y.useCallback(function(j){var C=p.current-j.changedTouches[0].clientY;b(j,C)},[b]),N=y.useCallback(function(j){if(j){var C=xC?{passive:!1}:!1;j.addEventListener("wheel",x,C),j.addEventListener("touchstart",w,C),j.addEventListener("touchmove",k,C)}},[k,w,x]),S=y.useCallback(function(j){j&&(j.removeEventListener("wheel",x,!1),j.removeEventListener("touchstart",w,!1),j.removeEventListener("touchmove",k,!1))},[k,w,x]);return y.useEffect(function(){if(o){var j=g.current;return N(j),function(){S(j)}}},[o,N,S]),function(j){g.current=j}}var jy=["boxSizing","height","overflow","paddingRight","position"],My={boxSizing:"border-box",overflow:"hidden",position:"relative",height:"100%"};function Oy(n){n.cancelable&&n.preventDefault()}function Ty(n){n.stopPropagation()}function Ey(){var n=this.scrollTop,o=this.scrollHeight,s=n+this.offsetHeight;n===0?this.scrollTop=1:s===o&&(this.scrollTop=n-1)}function Iy(){return"ontouchstart"in window||navigator.maxTouchPoints}var Ly=!!(typeof window<"u"&&window.document&&window.document.createElement),la=0,Js={capture:!1,passive:!1};function X3(n){var o=n.isEnabled,s=n.accountForScrollbars,l=s===void 0?!0:s,i=y.useRef({}),c=y.useRef(null),f=y.useCallback(function(p){if(Ly){var g=document.body,b=g&&g.style;if(l&&jy.forEach(function(N){var S=b&&b[N];i.current[N]=S}),l&&la<1){var x=parseInt(i.current.paddingRight,10)||0,w=document.body?document.body.clientWidth:0,k=window.innerWidth-w+x||0;Object.keys(My).forEach(function(N){var S=My[N];b&&(b[N]=S)}),b&&(b.paddingRight="".concat(k,"px"))}g&&Iy()&&(g.addEventListener("touchmove",Oy,Js),p&&(p.addEventListener("touchstart",Ey,Js),p.addEventListener("touchmove",Ty,Js))),la+=1}},[l]),m=y.useCallback(function(p){if(Ly){var g=document.body,b=g&&g.style;la=Math.max(la-1,0),l&&la<1&&jy.forEach(function(x){var w=i.current[x];b&&(b[x]=w)}),g&&Iy()&&(g.removeEventListener("touchmove",Oy,Js),p&&(p.removeEventListener("touchstart",Ey,Js),p.removeEventListener("touchmove",Ty,Js)))}},[l]);return y.useEffect(function(){if(o){var p=c.current;return f(p),function(){m(p)}}},[o,f,m]),function(p){c.current=p}}var Z3=function(o){var s=o.target;return s.ownerDocument.activeElement&&s.ownerDocument.activeElement.blur()},J3={name:"1kfdb0e",styles:"position:fixed;left:0;bottom:0;right:0;top:0"};function e4(n){var o=n.children,s=n.lockEnabled,l=n.captureEnabled,i=l===void 0?!0:l,c=n.onBottomArrive,f=n.onBottomLeave,m=n.onTopArrive,p=n.onTopLeave,g=Q3({isEnabled:i,onBottomArrive:c,onBottomLeave:f,onTopArrive:m,onTopLeave:p}),b=X3({isEnabled:s}),x=function(k){g(k),b(k)};return wt(y.Fragment,null,s&&wt("div",{onClick:Z3,css:J3}),o(x))}var t4={name:"1a0ro4n-requiredInput",styles:"label:requiredInput;opacity:0;pointer-events:none;position:absolute;bottom:0;left:0;right:0;width:100%"},n4=function(o){var s=o.name,l=o.onFocus;return wt("input",{required:!0,name:s,tabIndex:-1,"aria-hidden":"true",onFocus:l,css:t4,value:"",onChange:function(){}})},o4=n4;function Mp(n){var o;return typeof window<"u"&&window.navigator!=null?n.test(((o=window.navigator.userAgentData)===null||o===void 0?void 0:o.platform)||window.navigator.platform):!1}function r4(){return Mp(/^iPhone/i)}function lx(){return Mp(/^Mac/i)}function s4(){return Mp(/^iPad/i)||lx()&&navigator.maxTouchPoints>1}function l4(){return r4()||s4()}function a4(){return lx()||l4()}var i4=function(o){return o.label},u4=function(o){return o.label},c4=function(o){return o.value},d4=function(o){return!!o.isDisabled},f4={clearIndicator:QC,container:HC,control:o3,dropdownIndicator:PC,group:a3,groupHeading:u3,indicatorsContainer:$C,indicatorSeparator:ZC,input:p3,loadingIndicator:t3,loadingMessage:RC,menu:MC,menuList:IC,menuPortal:BC,multiValue:b3,multiValueLabel:x3,multiValueRemove:v3,noOptionsMessage:AC,option:j3,placeholder:T3,singleValue:L3,valueContainer:KC},p4={primary:"#2684FF",primary75:"#4C9AFF",primary50:"#B2D4FF",primary25:"#DEEBFF",danger:"#DE350B",dangerLight:"#FFBDAD",neutral0:"hsl(0, 0%, 100%)",neutral5:"hsl(0, 0%, 95%)",neutral10:"hsl(0, 0%, 90%)",neutral20:"hsl(0, 0%, 80%)",neutral30:"hsl(0, 0%, 70%)",neutral40:"hsl(0, 0%, 60%)",neutral50:"hsl(0, 0%, 50%)",neutral60:"hsl(0, 0%, 40%)",neutral70:"hsl(0, 0%, 30%)",neutral80:"hsl(0, 0%, 20%)",neutral90:"hsl(0, 0%, 10%)"},h4=4,ax=4,m4=38,g4=ax*2,y4={baseUnit:ax,controlHeight:m4,menuGutter:g4},mf={borderRadius:h4,colors:p4,spacing:y4},b4={"aria-live":"polite",backspaceRemovesValue:!0,blurInputOnSelect:wy(),captureMenuScroll:!wy(),classNames:{},closeMenuOnSelect:!0,closeMenuOnScroll:!1,components:{},controlShouldRenderValue:!0,escapeClearsValue:!1,filterOption:Pf(),formatGroupLabel:i4,getOptionLabel:u4,getOptionValue:c4,isDisabled:!1,isLoading:!1,isMulti:!1,isRtl:!1,isSearchable:!0,isOptionDisabled:d4,loadingMessage:function(){return"Loading..."},maxMenuHeight:300,minMenuHeight:140,menuIsOpen:!1,menuPlacement:"bottom",menuPosition:"absolute",menuShouldBlockScroll:!1,menuShouldScrollIntoView:!yC(),noOptionsMessage:function(){return"No options"},openMenuOnFocus:!1,openMenuOnClick:!0,options:[],pageSize:5,placeholder:"Select...",screenReaderStatus:function(o){var s=o.count;return"".concat(s," result").concat(s!==1?"s":""," available")},styles:{},tabIndex:0,tabSelectsValue:!0,unstyled:!1};function Ay(n,o,s,l){var i=cx(n,o,s),c=dx(n,o,s),f=ux(n,o),m=Tu(n,o);return{type:"option",data:o,isDisabled:i,isSelected:c,label:f,value:m,index:l}}function pu(n,o){return n.options.map(function(s,l){if("options"in s){var i=s.options.map(function(f,m){return Ay(n,f,o,m)}).filter(function(f){return _y(n,f)});return i.length>0?{type:"group",data:s,options:i,index:l}:void 0}var c=Ay(n,s,o,l);return _y(n,c)?c:void 0}).filter(vC)}function ix(n){return n.reduce(function(o,s){return s.type==="group"?o.push.apply(o,yp(s.options.map(function(l){return l.data}))):o.push(s.data),o},[])}function Ry(n,o){return n.reduce(function(s,l){return l.type==="group"?s.push.apply(s,yp(l.options.map(function(i){return{data:i.data,id:"".concat(o,"-").concat(l.index,"-").concat(i.index)}}))):s.push({data:l.data,id:"".concat(o,"-").concat(l.index)}),s},[])}function x4(n,o){return ix(pu(n,o))}function _y(n,o){var s=n.inputValue,l=s===void 0?"":s,i=o.data,c=o.isSelected,f=o.label,m=o.value;return(!px(n)||!c)&&fx(n,{label:f,value:m,data:i},l)}function v4(n,o){var s=n.focusedValue,l=n.selectValue,i=l.indexOf(s);if(i>-1){var c=o.indexOf(s);if(c>-1)return s;if(i<o.length)return o[i]}return null}function w4(n,o){var s=n.focusedOption;return s&&o.indexOf(s)>-1?s:o[0]}var gf=function(o,s){var l,i=(l=o.find(function(c){return c.data===s}))===null||l===void 0?void 0:l.id;return i||null},ux=function(o,s){return o.getOptionLabel(s)},Tu=function(o,s){return o.getOptionValue(s)};function cx(n,o,s){return typeof n.isOptionDisabled=="function"?n.isOptionDisabled(o,s):!1}function dx(n,o,s){if(s.indexOf(o)>-1)return!0;if(typeof n.isOptionSelected=="function")return n.isOptionSelected(o,s);var l=Tu(n,o);return s.some(function(i){return Tu(n,i)===l})}function fx(n,o,s){return n.filterOption?n.filterOption(o,s):!0}var px=function(o){var s=o.hideSelectedOptions,l=o.isMulti;return s===void 0?l:s},S4=1,hx=(function(n){FS(s,n);var o=GS(s);function s(l){var i;if(US(this,s),i=o.call(this,l),i.state={ariaSelection:null,focusedOption:null,focusedOptionId:null,focusableOptionsWithIds:[],focusedValue:null,inputIsHidden:!1,isFocused:!1,selectValue:[],clearFocusValueOnUpdate:!1,prevWasFocused:!1,inputIsHiddenAfterUpdate:void 0,prevProps:void 0,instancePrefix:"",isAppleDevice:!1},i.blockOptionHover=!1,i.isComposing=!1,i.commonProps=void 0,i.initialTouchX=0,i.initialTouchY=0,i.openAfterFocus=!1,i.scrollToFocusedOptionOnUpdate=!1,i.userIsDragging=void 0,i.controlRef=null,i.getControlRef=function(p){i.controlRef=p},i.focusedOptionRef=null,i.getFocusedOptionRef=function(p){i.focusedOptionRef=p},i.menuListRef=null,i.getMenuListRef=function(p){i.menuListRef=p},i.inputRef=null,i.getInputRef=function(p){i.inputRef=p},i.focus=i.focusInput,i.blur=i.blurInput,i.onChange=function(p,g){var b=i.props,x=b.onChange,w=b.name;g.name=w,i.ariaOnChange(p,g),x(p,g)},i.setValue=function(p,g,b){var x=i.props,w=x.closeMenuOnSelect,k=x.isMulti,N=x.inputValue;i.onInputChange("",{action:"set-value",prevInputValue:N}),w&&(i.setState({inputIsHiddenAfterUpdate:!k}),i.onMenuClose()),i.setState({clearFocusValueOnUpdate:!0}),i.onChange(p,{action:g,option:b})},i.selectOption=function(p){var g=i.props,b=g.blurInputOnSelect,x=g.isMulti,w=g.name,k=i.state.selectValue,N=x&&i.isOptionSelected(p,k),S=i.isOptionDisabled(p,k);if(N){var j=i.getOptionValue(p);i.setValue(k.filter(function(C){return i.getOptionValue(C)!==j}),"deselect-option",p)}else if(!S)x?i.setValue([].concat(yp(k),[p]),"select-option",p):i.setValue(p,"select-option");else{i.ariaOnChange(p,{action:"select-option",option:p,name:w});return}b&&i.blurInput()},i.removeValue=function(p){var g=i.props.isMulti,b=i.state.selectValue,x=i.getOptionValue(p),w=b.filter(function(N){return i.getOptionValue(N)!==x}),k=su(g,w,w[0]||null);i.onChange(k,{action:"remove-value",removedValue:p}),i.focusInput()},i.clearValue=function(){var p=i.state.selectValue;i.onChange(su(i.props.isMulti,[],null),{action:"clear",removedValues:p})},i.popValue=function(){var p=i.props.isMulti,g=i.state.selectValue,b=g[g.length-1],x=g.slice(0,g.length-1),w=su(p,x,x[0]||null);b&&i.onChange(w,{action:"pop-value",removedValue:b})},i.getFocusedOptionId=function(p){return gf(i.state.focusableOptionsWithIds,p)},i.getFocusableOptionsWithIds=function(){return Ry(pu(i.props,i.state.selectValue),i.getElementId("option"))},i.getValue=function(){return i.state.selectValue},i.cx=function(){for(var p=arguments.length,g=new Array(p),b=0;b<p;b++)g[b]=arguments[b];return fC.apply(void 0,[i.props.classNamePrefix].concat(g))},i.getOptionLabel=function(p){return ux(i.props,p)},i.getOptionValue=function(p){return Tu(i.props,p)},i.getStyles=function(p,g){var b=i.props.unstyled,x=f4[p](g,b);x.boxSizing="border-box";var w=i.props.styles[p];return w?w(x,g):x},i.getClassNames=function(p,g){var b,x;return(b=(x=i.props.classNames)[p])===null||b===void 0?void 0:b.call(x,g)},i.getElementId=function(p){return"".concat(i.state.instancePrefix,"-").concat(p)},i.getComponents=function(){return _3(i.props)},i.buildCategorizedOptions=function(){return pu(i.props,i.state.selectValue)},i.getCategorizedOptions=function(){return i.props.menuIsOpen?i.buildCategorizedOptions():[]},i.buildFocusableOptions=function(){return ix(i.buildCategorizedOptions())},i.getFocusableOptions=function(){return i.props.menuIsOpen?i.buildFocusableOptions():[]},i.ariaOnChange=function(p,g){i.setState({ariaSelection:Ct({value:p},g)})},i.onMenuMouseDown=function(p){p.button===0&&(p.stopPropagation(),p.preventDefault(),i.focusInput())},i.onMenuMouseMove=function(p){i.blockOptionHover=!1},i.onControlMouseDown=function(p){if(!p.defaultPrevented){var g=i.props.openMenuOnClick;i.state.isFocused?i.props.menuIsOpen?p.target.tagName!=="INPUT"&&p.target.tagName!=="TEXTAREA"&&i.onMenuClose():g&&i.openMenu("first"):(g&&(i.openAfterFocus=!0),i.focusInput()),p.target.tagName!=="INPUT"&&p.target.tagName!=="TEXTAREA"&&p.preventDefault()}},i.onDropdownIndicatorMouseDown=function(p){if(!(p&&p.type==="mousedown"&&p.button!==0)&&!i.props.isDisabled){var g=i.props,b=g.isMulti,x=g.menuIsOpen;i.focusInput(),x?(i.setState({inputIsHiddenAfterUpdate:!b}),i.onMenuClose()):i.openMenu("first"),p.preventDefault()}},i.onClearIndicatorMouseDown=function(p){p&&p.type==="mousedown"&&p.button!==0||(i.clearValue(),p.preventDefault(),i.openAfterFocus=!1,p.type==="touchend"?i.focusInput():setTimeout(function(){return i.focusInput()}))},i.onScroll=function(p){typeof i.props.closeMenuOnScroll=="boolean"?p.target instanceof HTMLElement&&Vu(p.target)&&i.props.onMenuClose():typeof i.props.closeMenuOnScroll=="function"&&i.props.closeMenuOnScroll(p)&&i.props.onMenuClose()},i.onCompositionStart=function(){i.isComposing=!0},i.onCompositionEnd=function(){i.isComposing=!1},i.onTouchStart=function(p){var g=p.touches,b=g&&g.item(0);b&&(i.initialTouchX=b.clientX,i.initialTouchY=b.clientY,i.userIsDragging=!1)},i.onTouchMove=function(p){var g=p.touches,b=g&&g.item(0);if(b){var x=Math.abs(b.clientX-i.initialTouchX),w=Math.abs(b.clientY-i.initialTouchY),k=5;i.userIsDragging=x>k||w>k}},i.onTouchEnd=function(p){i.userIsDragging||(i.controlRef&&!i.controlRef.contains(p.target)&&i.menuListRef&&!i.menuListRef.contains(p.target)&&i.blurInput(),i.initialTouchX=0,i.initialTouchY=0)},i.onControlTouchEnd=function(p){i.userIsDragging||i.onControlMouseDown(p)},i.onClearIndicatorTouchEnd=function(p){i.userIsDragging||i.onClearIndicatorMouseDown(p)},i.onDropdownIndicatorTouchEnd=function(p){i.userIsDragging||i.onDropdownIndicatorMouseDown(p)},i.handleInputChange=function(p){var g=i.props.inputValue,b=p.currentTarget.value;i.setState({inputIsHiddenAfterUpdate:!1}),i.onInputChange(b,{action:"input-change",prevInputValue:g}),i.props.menuIsOpen||i.onMenuOpen()},i.onInputFocus=function(p){i.props.onFocus&&i.props.onFocus(p),i.setState({inputIsHiddenAfterUpdate:!1,isFocused:!0}),(i.openAfterFocus||i.props.openMenuOnFocus)&&i.openMenu("first"),i.openAfterFocus=!1},i.onInputBlur=function(p){var g=i.props.inputValue;if(i.menuListRef&&i.menuListRef.contains(document.activeElement)){i.inputRef.focus();return}i.props.onBlur&&i.props.onBlur(p),i.onInputChange("",{action:"input-blur",prevInputValue:g}),i.onMenuClose(),i.setState({focusedValue:null,isFocused:!1})},i.onOptionHover=function(p){if(!(i.blockOptionHover||i.state.focusedOption===p)){var g=i.getFocusableOptions(),b=g.indexOf(p);i.setState({focusedOption:p,focusedOptionId:b>-1?i.getFocusedOptionId(p):null})}},i.shouldHideSelectedOptions=function(){return px(i.props)},i.onValueInputFocus=function(p){p.preventDefault(),p.stopPropagation(),i.focus()},i.onKeyDown=function(p){var g=i.props,b=g.isMulti,x=g.backspaceRemovesValue,w=g.escapeClearsValue,k=g.inputValue,N=g.isClearable,S=g.isDisabled,j=g.menuIsOpen,C=g.onKeyDown,T=g.tabSelectsValue,V=g.openMenuOnFocus,U=i.state,R=U.focusedOption,z=U.focusedValue,L=U.selectValue;if(!S&&!(typeof C=="function"&&(C(p),p.defaultPrevented))){switch(i.blockOptionHover=!0,p.key){case"ArrowLeft":if(!b||k)return;i.focusValue("previous");break;case"ArrowRight":if(!b||k)return;i.focusValue("next");break;case"Delete":case"Backspace":if(k)return;if(z)i.removeValue(z);else{if(!x)return;b?i.popValue():N&&i.clearValue()}break;case"Tab":if(i.isComposing||p.shiftKey||!j||!T||!R||V&&i.isOptionSelected(R,L))return;i.selectOption(R);break;case"Enter":if(p.keyCode===229)break;if(j){if(!R||i.isComposing)return;i.selectOption(R);break}return;case"Escape":j?(i.setState({inputIsHiddenAfterUpdate:!1}),i.onInputChange("",{action:"menu-close",prevInputValue:k}),i.onMenuClose()):N&&w&&i.clearValue();break;case" ":if(k)return;if(!j){i.openMenu("first");break}if(!R)return;i.selectOption(R);break;case"ArrowUp":j?i.focusOption("up"):i.openMenu("last");break;case"ArrowDown":j?i.focusOption("down"):i.openMenu("first");break;case"PageUp":if(!j)return;i.focusOption("pageup");break;case"PageDown":if(!j)return;i.focusOption("pagedown");break;case"Home":if(!j)return;i.focusOption("first");break;case"End":if(!j)return;i.focusOption("last");break;default:return}p.preventDefault()}},i.state.instancePrefix="react-select-"+(i.props.instanceId||++S4),i.state.selectValue=xy(l.value),l.menuIsOpen&&i.state.selectValue.length){var c=i.getFocusableOptionsWithIds(),f=i.buildFocusableOptions(),m=f.indexOf(i.state.selectValue[0]);i.state.focusableOptionsWithIds=c,i.state.focusedOption=f[m],i.state.focusedOptionId=gf(c,f[m])}return i}return $S(s,[{key:"componentDidMount",value:function(){this.startListeningComposition(),this.startListeningToTouch(),this.props.closeMenuOnScroll&&document&&document.addEventListener&&document.addEventListener("scroll",this.onScroll,!0),this.props.autoFocus&&this.focusInput(),this.props.menuIsOpen&&this.state.focusedOption&&this.menuListRef&&this.focusedOptionRef&&vy(this.menuListRef,this.focusedOptionRef),a4()&&this.setState({isAppleDevice:!0})}},{key:"componentDidUpdate",value:function(i){var c=this.props,f=c.isDisabled,m=c.menuIsOpen,p=this.state.isFocused;(p&&!f&&i.isDisabled||p&&m&&!i.menuIsOpen)&&this.focusInput(),p&&f&&!i.isDisabled?this.setState({isFocused:!1},this.onMenuClose):!p&&!f&&i.isDisabled&&this.inputRef===document.activeElement&&this.setState({isFocused:!0}),this.menuListRef&&this.focusedOptionRef&&this.scrollToFocusedOptionOnUpdate&&(vy(this.menuListRef,this.focusedOptionRef),this.scrollToFocusedOptionOnUpdate=!1)}},{key:"componentWillUnmount",value:function(){this.stopListeningComposition(),this.stopListeningToTouch(),document.removeEventListener("scroll",this.onScroll,!0)}},{key:"onMenuOpen",value:function(){this.props.onMenuOpen()}},{key:"onMenuClose",value:function(){this.onInputChange("",{action:"menu-close",prevInputValue:this.props.inputValue}),this.props.onMenuClose()}},{key:"onInputChange",value:function(i,c){this.props.onInputChange(i,c)}},{key:"focusInput",value:function(){this.inputRef&&this.inputRef.focus()}},{key:"blurInput",value:function(){this.inputRef&&this.inputRef.blur()}},{key:"openMenu",value:function(i){var c=this,f=this.state,m=f.selectValue,p=f.isFocused,g=this.buildFocusableOptions(),b=i==="first"?0:g.length-1;if(!this.props.isMulti){var x=g.indexOf(m[0]);x>-1&&(b=x)}this.scrollToFocusedOptionOnUpdate=!(p&&this.menuListRef),this.setState({inputIsHiddenAfterUpdate:!1,focusedValue:null,focusedOption:g[b],focusedOptionId:this.getFocusedOptionId(g[b])},function(){return c.onMenuOpen()})}},{key:"focusValue",value:function(i){var c=this.state,f=c.selectValue,m=c.focusedValue;if(this.props.isMulti){this.setState({focusedOption:null});var p=f.indexOf(m);m||(p=-1);var g=f.length-1,b=-1;if(f.length){switch(i){case"previous":p===0?b=0:p===-1?b=g:b=p-1;break;case"next":p>-1&&p<g&&(b=p+1);break}this.setState({inputIsHidden:b!==-1,focusedValue:f[b]})}}}},{key:"focusOption",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"first",c=this.props.pageSize,f=this.state.focusedOption,m=this.getFocusableOptions();if(m.length){var p=0,g=m.indexOf(f);f||(g=-1),i==="up"?p=g>0?g-1:m.length-1:i==="down"?p=(g+1)%m.length:i==="pageup"?(p=g-c,p<0&&(p=0)):i==="pagedown"?(p=g+c,p>m.length-1&&(p=m.length-1)):i==="last"&&(p=m.length-1),this.scrollToFocusedOptionOnUpdate=!0,this.setState({focusedOption:m[p],focusedValue:null,focusedOptionId:this.getFocusedOptionId(m[p])})}}},{key:"getTheme",value:(function(){return this.props.theme?typeof this.props.theme=="function"?this.props.theme(mf):Ct(Ct({},mf),this.props.theme):mf})},{key:"getCommonProps",value:function(){var i=this.clearValue,c=this.cx,f=this.getStyles,m=this.getClassNames,p=this.getValue,g=this.selectOption,b=this.setValue,x=this.props,w=x.isMulti,k=x.isRtl,N=x.options,S=this.hasValue();return{clearValue:i,cx:c,getStyles:f,getClassNames:m,getValue:p,hasValue:S,isMulti:w,isRtl:k,options:N,selectOption:g,selectProps:x,setValue:b,theme:this.getTheme()}}},{key:"hasValue",value:function(){var i=this.state.selectValue;return i.length>0}},{key:"hasOptions",value:function(){return!!this.getFocusableOptions().length}},{key:"isClearable",value:function(){var i=this.props,c=i.isClearable,f=i.isMulti;return c===void 0?f:c}},{key:"isOptionDisabled",value:function(i,c){return cx(this.props,i,c)}},{key:"isOptionSelected",value:function(i,c){return dx(this.props,i,c)}},{key:"filterOption",value:function(i,c){return fx(this.props,i,c)}},{key:"formatOptionLabel",value:function(i,c){if(typeof this.props.formatOptionLabel=="function"){var f=this.props.inputValue,m=this.state.selectValue;return this.props.formatOptionLabel(i,{context:c,inputValue:f,selectValue:m})}else return this.getOptionLabel(i)}},{key:"formatGroupLabel",value:function(i){return this.props.formatGroupLabel(i)}},{key:"startListeningComposition",value:(function(){document&&document.addEventListener&&(document.addEventListener("compositionstart",this.onCompositionStart,!1),document.addEventListener("compositionend",this.onCompositionEnd,!1))})},{key:"stopListeningComposition",value:function(){document&&document.removeEventListener&&(document.removeEventListener("compositionstart",this.onCompositionStart),document.removeEventListener("compositionend",this.onCompositionEnd))}},{key:"startListeningToTouch",value:(function(){document&&document.addEventListener&&(document.addEventListener("touchstart",this.onTouchStart,!1),document.addEventListener("touchmove",this.onTouchMove,!1),document.addEventListener("touchend",this.onTouchEnd,!1))})},{key:"stopListeningToTouch",value:function(){document&&document.removeEventListener&&(document.removeEventListener("touchstart",this.onTouchStart),document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onTouchEnd))}},{key:"renderInput",value:(function(){var i=this.props,c=i.isDisabled,f=i.isSearchable,m=i.inputId,p=i.inputValue,g=i.tabIndex,b=i.form,x=i.menuIsOpen,w=i.required,k=this.getComponents(),N=k.Input,S=this.state,j=S.inputIsHidden,C=S.ariaSelection,T=this.commonProps,V=m||this.getElementId("input"),U=Ct(Ct(Ct({"aria-autocomplete":"list","aria-expanded":x,"aria-haspopup":!0,"aria-errormessage":this.props["aria-errormessage"],"aria-invalid":this.props["aria-invalid"],"aria-label":this.props["aria-label"],"aria-labelledby":this.props["aria-labelledby"],"aria-required":w,role:"combobox","aria-activedescendant":this.state.isAppleDevice?void 0:this.state.focusedOptionId||""},x&&{"aria-controls":this.getElementId("listbox")}),!f&&{"aria-readonly":!0}),this.hasValue()?C?.action==="initial-input-focus"&&{"aria-describedby":this.getElementId("live-region")}:{"aria-describedby":this.getElementId("placeholder")});return f?y.createElement(N,Mt({},T,{autoCapitalize:"none",autoComplete:"off",autoCorrect:"off",id:V,innerRef:this.getInputRef,isDisabled:c,isHidden:j,onBlur:this.onInputBlur,onChange:this.handleInputChange,onFocus:this.onInputFocus,spellCheck:"false",tabIndex:g,form:b,type:"text",value:p},U)):y.createElement(P3,Mt({id:V,innerRef:this.getInputRef,onBlur:this.onInputBlur,onChange:Mu,onFocus:this.onInputFocus,disabled:c,tabIndex:g,inputMode:"none",form:b,value:""},U))})},{key:"renderPlaceholderOrValue",value:function(){var i=this,c=this.getComponents(),f=c.MultiValue,m=c.MultiValueContainer,p=c.MultiValueLabel,g=c.MultiValueRemove,b=c.SingleValue,x=c.Placeholder,w=this.commonProps,k=this.props,N=k.controlShouldRenderValue,S=k.isDisabled,j=k.isMulti,C=k.inputValue,T=k.placeholder,V=this.state,U=V.selectValue,R=V.focusedValue,z=V.isFocused;if(!this.hasValue()||!N)return C?null:y.createElement(x,Mt({},w,{key:"placeholder",isDisabled:S,isFocused:z,innerProps:{id:this.getElementId("placeholder")}}),T);if(j)return U.map(function($,Q){var ue=$===R,fe="".concat(i.getOptionLabel($),"-").concat(i.getOptionValue($));return y.createElement(f,Mt({},w,{components:{Container:m,Label:p,Remove:g},isFocused:ue,isDisabled:S,key:fe,index:Q,removeProps:{onClick:function(){return i.removeValue($)},onTouchEnd:function(){return i.removeValue($)},onMouseDown:function(Ie){Ie.preventDefault()}},data:$}),i.formatOptionLabel($,"value"))});if(C)return null;var L=U[0];return y.createElement(b,Mt({},w,{data:L,isDisabled:S}),this.formatOptionLabel(L,"value"))}},{key:"renderClearIndicator",value:function(){var i=this.getComponents(),c=i.ClearIndicator,f=this.commonProps,m=this.props,p=m.isDisabled,g=m.isLoading,b=this.state.isFocused;if(!this.isClearable()||!c||p||!this.hasValue()||g)return null;var x={onMouseDown:this.onClearIndicatorMouseDown,onTouchEnd:this.onClearIndicatorTouchEnd,"aria-hidden":"true"};return y.createElement(c,Mt({},f,{innerProps:x,isFocused:b}))}},{key:"renderLoadingIndicator",value:function(){var i=this.getComponents(),c=i.LoadingIndicator,f=this.commonProps,m=this.props,p=m.isDisabled,g=m.isLoading,b=this.state.isFocused;if(!c||!g)return null;var x={"aria-hidden":"true"};return y.createElement(c,Mt({},f,{innerProps:x,isDisabled:p,isFocused:b}))}},{key:"renderIndicatorSeparator",value:function(){var i=this.getComponents(),c=i.DropdownIndicator,f=i.IndicatorSeparator;if(!c||!f)return null;var m=this.commonProps,p=this.props.isDisabled,g=this.state.isFocused;return y.createElement(f,Mt({},m,{isDisabled:p,isFocused:g}))}},{key:"renderDropdownIndicator",value:function(){var i=this.getComponents(),c=i.DropdownIndicator;if(!c)return null;var f=this.commonProps,m=this.props.isDisabled,p=this.state.isFocused,g={onMouseDown:this.onDropdownIndicatorMouseDown,onTouchEnd:this.onDropdownIndicatorTouchEnd,"aria-hidden":"true"};return y.createElement(c,Mt({},f,{innerProps:g,isDisabled:m,isFocused:p}))}},{key:"renderMenu",value:function(){var i=this,c=this.getComponents(),f=c.Group,m=c.GroupHeading,p=c.Menu,g=c.MenuList,b=c.MenuPortal,x=c.LoadingMessage,w=c.NoOptionsMessage,k=c.Option,N=this.commonProps,S=this.state.focusedOption,j=this.props,C=j.captureMenuScroll,T=j.inputValue,V=j.isLoading,U=j.loadingMessage,R=j.minMenuHeight,z=j.maxMenuHeight,L=j.menuIsOpen,$=j.menuPlacement,Q=j.menuPosition,ue=j.menuPortalTarget,fe=j.menuShouldBlockScroll,de=j.menuShouldScrollIntoView,Ie=j.noOptionsMessage,je=j.onMenuScrollToTop,Me=j.onMenuScrollToBottom;if(!L)return null;var _=function(M,ee){var Te=M.type,qe=M.data,ye=M.isDisabled,Ne=M.isSelected,H=M.label,Y=M.value,D=S===qe,K=ye?void 0:function(){return i.onOptionHover(qe)},X=ye?void 0:function(){return i.selectOption(qe)},W="".concat(i.getElementId("option"),"-").concat(ee),Oe={id:W,onClick:X,onMouseMove:K,onMouseOver:K,tabIndex:-1,role:"option","aria-selected":i.state.isAppleDevice?void 0:Ne};return y.createElement(k,Mt({},N,{innerProps:Oe,data:qe,isDisabled:ye,isSelected:Ne,key:W,label:H,type:Te,value:Y,isFocused:D,innerRef:D?i.getFocusedOptionRef:void 0}),i.formatOptionLabel(M.data,"menu"))},oe;if(this.hasOptions())oe=this.getCategorizedOptions().map(function(A){if(A.type==="group"){var M=A.data,ee=A.options,Te=A.index,qe="".concat(i.getElementId("group"),"-").concat(Te),ye="".concat(qe,"-heading");return y.createElement(f,Mt({},N,{key:qe,data:M,options:ee,Heading:m,headingProps:{id:ye,data:A.data},label:i.formatGroupLabel(A.data)}),A.options.map(function(Ne){return _(Ne,"".concat(Te,"-").concat(Ne.index))}))}else if(A.type==="option")return _(A,"".concat(A.index))});else if(V){var ce=U({inputValue:T});if(ce===null)return null;oe=y.createElement(x,N,ce)}else{var Ke=Ie({inputValue:T});if(Ke===null)return null;oe=y.createElement(w,N,Ke)}var Le={minMenuHeight:R,maxMenuHeight:z,menuPlacement:$,menuPosition:Q,menuShouldScrollIntoView:de},E=y.createElement(OC,Mt({},N,Le),function(A){var M=A.ref,ee=A.placerProps,Te=ee.placement,qe=ee.maxHeight;return y.createElement(p,Mt({},N,Le,{innerRef:M,innerProps:{onMouseDown:i.onMenuMouseDown,onMouseMove:i.onMenuMouseMove},isLoading:V,placement:Te}),y.createElement(e4,{captureEnabled:C,onTopArrive:je,onBottomArrive:Me,lockEnabled:fe},function(ye){return y.createElement(g,Mt({},N,{innerRef:function(H){i.getMenuListRef(H),ye(H)},innerProps:{role:"listbox","aria-multiselectable":N.isMulti,id:i.getElementId("listbox")},isLoading:V,maxHeight:qe,focusedOption:S}),oe)}))});return ue||Q==="fixed"?y.createElement(b,Mt({},N,{appendTo:ue,controlElement:this.controlRef,menuPlacement:$,menuPosition:Q}),E):E}},{key:"renderFormField",value:function(){var i=this,c=this.props,f=c.delimiter,m=c.isDisabled,p=c.isMulti,g=c.name,b=c.required,x=this.state.selectValue;if(b&&!this.hasValue()&&!m)return y.createElement(o4,{name:g,onFocus:this.onValueInputFocus});if(!(!g||m))if(p)if(f){var w=x.map(function(S){return i.getOptionValue(S)}).join(f);return y.createElement("input",{name:g,type:"hidden",value:w})}else{var k=x.length>0?x.map(function(S,j){return y.createElement("input",{key:"i-".concat(j),name:g,type:"hidden",value:i.getOptionValue(S)})}):y.createElement("input",{name:g,type:"hidden",value:""});return y.createElement("div",null,k)}else{var N=x[0]?this.getOptionValue(x[0]):"";return y.createElement("input",{name:g,type:"hidden",value:N})}}},{key:"renderLiveRegion",value:function(){var i=this.commonProps,c=this.state,f=c.ariaSelection,m=c.focusedOption,p=c.focusedValue,g=c.isFocused,b=c.selectValue,x=this.getFocusableOptions();return y.createElement($3,Mt({},i,{id:this.getElementId("live-region"),ariaSelection:f,focusedOption:m,focusedValue:p,isFocused:g,selectValue:b,focusableOptions:x,isAppleDevice:this.state.isAppleDevice}))}},{key:"render",value:function(){var i=this.getComponents(),c=i.Control,f=i.IndicatorsContainer,m=i.SelectContainer,p=i.ValueContainer,g=this.props,b=g.className,x=g.id,w=g.isDisabled,k=g.menuIsOpen,N=this.state.isFocused,S=this.commonProps=this.getCommonProps();return y.createElement(m,Mt({},S,{className:b,innerProps:{id:x,onKeyDown:this.onKeyDown},isDisabled:w,isFocused:N}),this.renderLiveRegion(),y.createElement(c,Mt({},S,{innerRef:this.getControlRef,innerProps:{onMouseDown:this.onControlMouseDown,onTouchEnd:this.onControlTouchEnd},isDisabled:w,isFocused:N,menuIsOpen:k}),y.createElement(p,Mt({},S,{isDisabled:w}),this.renderPlaceholderOrValue(),this.renderInput()),y.createElement(f,Mt({},S,{isDisabled:w}),this.renderClearIndicator(),this.renderLoadingIndicator(),this.renderIndicatorSeparator(),this.renderDropdownIndicator())),this.renderMenu(),this.renderFormField())}}],[{key:"getDerivedStateFromProps",value:function(i,c){var f=c.prevProps,m=c.clearFocusValueOnUpdate,p=c.inputIsHiddenAfterUpdate,g=c.ariaSelection,b=c.isFocused,x=c.prevWasFocused,w=c.instancePrefix,k=i.options,N=i.value,S=i.menuIsOpen,j=i.inputValue,C=i.isMulti,T=xy(N),V={};if(f&&(N!==f.value||k!==f.options||S!==f.menuIsOpen||j!==f.inputValue)){var U=S?x4(i,T):[],R=S?Ry(pu(i,T),"".concat(w,"-option")):[],z=m?v4(c,T):null,L=w4(c,U),$=gf(R,L);V={selectValue:T,focusedOption:L,focusedOptionId:$,focusableOptionsWithIds:R,focusedValue:z,clearFocusValueOnUpdate:!1}}var Q=p!=null&&i!==f?{inputIsHidden:p,inputIsHiddenAfterUpdate:void 0}:{},ue=g,fe=b&&x;return b&&!fe&&(ue={value:su(C,T,T[0]||null),options:T,action:"initial-input-focus"},fe=!x),g?.action==="initial-input-focus"&&(ue=null),Ct(Ct(Ct({},V),Q),{},{prevProps:i,ariaSelection:ue,prevWasFocused:fe})}}]),s})(y.Component);hx.defaultProps=b4;var N4=y.forwardRef(function(n,o){var s=KS(n);return y.createElement(hx,Mt({ref:o},s))}),Dy=N4;function yf({containerClass:n,name:o,value:s,options:l,onChange:i,disabled:c=!1,hideLabel:f=!1,hasPin:m,isPinned:p=!1,onTogglePin:g,hasError:b=!1,forceModalOpen:x=!1,onModalClose:w}){const k=ae(I=>I.setNodeTypes),S=al(I=>I.theme)==="dark",[j,C]=y.useState(!1),T=y.useRef(null),V=y.useRef(null),[U,R]=y.useState([]),[z,L]=y.useState(!1),$=x||j,Q=kb(),ue=I=>{if(!Array.isArray(l))return l?.[I]},fe=Array.isArray(l)?l:ue("options")??[],de=!!ue("image_upload"),Ie=ue("image_folder")??"input",je="__null__",Me=fe.some(I=>I===null),_=fe.filter(I=>I!==null).map(I=>String(I)),oe=Array.from(new Set([..._,...U])),ce=s===null?je:String(s??""),Ke=ce.split(/[\\/]/).pop()??ce,Le=oe.includes(ce)||oe.includes(Ke),E=s!=null&&ce!==""&&!Le,A=Le?oe.includes(ce)?ce:Ke:ce,M=[];(s===null||Me)&&M.push({value:je,label:"None"}),E&&M.push({value:ce,label:ce,isMissing:!0}),M.push(...oe.map(I=>({value:I,label:I})));const ee=M.find(I=>I.value===A)??null,Te=fe.filter(I=>I!==null).length,qe=x?!0:Q&&!(Te>0&&Te<5),ye=de&&Ie==="input",Ne=I=>{const B=I.replace(/\\/g,"/"),q=B.lastIndexOf("/"),he=q>=0?B.slice(q+1):B,me=q>=0?B.slice(0,q):"";return mo(he,me,"input")},H=y.useMemo(()=>ye?{DropdownIndicator:null,IndicatorSeparator:null,Option:B=>{const{data:q}=B,me=q.value!==je&&!q.isMissing&&!!q.value?Ne(q.value):null;return u.jsx(ox.Option,{...B,children:u.jsxs("div",{className:"flex items-center gap-2",children:[me&&u.jsx("img",{src:me,alt:"",className:"w-[72px] h-[72px] rounded-sm object-cover bg-gray-100 shrink-0",loading:"lazy",decoding:"async"}),u.jsx("span",{className:"truncate",children:q.label})]})})}}:{DropdownIndicator:null,IndicatorSeparator:null},[ye]),Y=["rs-container",m?"rs-has-pin":"rs-no-pin",b?"rs-error":"",E?"rs-missing":"",c?"rs-disabled":""].filter(Boolean).join(" "),D=typeof document>"u"?null:document.body,K=()=>{C(!1),w?.()},X=I=>{I&&i(I.value===je?null:I.value)},W=I=>{X(I),K()},Oe=()=>{c||z||V.current?.click()},be=async I=>{const B=I.target.files?.[0];if(B){L(!0);try{const q=await tb(B,{type:Ie}),he=q.subfolder?`${q.subfolder}/${q.name}`:q.name;R(me=>me.includes(he)?me:[...me,he]);try{const me=await tp();k(me)}catch{}i(he)}catch(q){console.error("Failed to upload image:",q)}finally{L(!1),I.target.value=""}}},ke=de?u.jsx("button",{type:"button",className:`w-full py-2 px-3 rounded-lg border text-sm font-medium transition-colors ${c||z?"opacity-60 cursor-not-allowed border-gray-200 text-gray-400 bg-white":"border-gray-200 text-gray-700 bg-white hover:border-gray-300 hover:text-gray-900"}`,onClick:Oe,disabled:c||z,children:u.jsxs("span",{className:"inline-flex items-center justify-center gap-2",children:[u.jsx(zo,{className:"w-4 h-4"}),z?"Uploading...":"Load from camera roll"]})}):null,J=Tt.text.primary,xe=Tt.text.secondary;return qe?u.jsxs("div",{className:`${n} combo-control-root combo-control-modal`,children:[!f&&u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:o}),u.jsxs("div",{className:`combo-control-trigger relative w-full p-3 comfy-input text-base flex items-center justify-between min-h-[46px] ${c?"opacity-60 cursor-not-allowed":""} ${b?"border-red-700 ring-1 ring-red-700":""}`,onClick:()=>!c&&C(!0),children:[u.jsx("span",{className:`combo-control-trigger-label truncate min-w-0 flex-1 ${ee?"text-gray-900":"text-gray-400 dark:text-gray-500"} ${m?"pr-16":"pr-6"}`,style:ee&&S?{color:Tt.text.onDark}:void 0,children:ee?ee.label:"Select..."}),u.jsxs("div",{className:"combo-control-trigger-icons flex items-center absolute right-0 top-0 bottom-0 pointer-events-none",children:[u.jsx("div",{className:"combo-control-chevron px-2 text-gray-400",children:u.jsx(vu,{className:"w-5 h-5"})}),m&&u.jsx("div",{className:"combo-control-pin pointer-events-auto px-2",children:u.jsx(nl,{isPinned:p,onToggle:g})})]})]}),E&&u.jsx("div",{className:"mt-1 text-xs text-red-700",children:"Missing on ComfyUI server"}),de&&u.jsxs("div",{className:"combo-control-upload mt-2",children:[ke,u.jsx("input",{ref:V,type:"file",accept:"image/*",className:"hidden",onChange:be})]}),u.jsx(gp,{title:o,isOpen:$,onClose:K,children:u.jsx(Dy,{className:Y,classNamePrefix:"rs",options:M,value:ee,onChange:W,isSearchable:!0,autoFocus:!x,menuIsOpen:x?void 0:!0,controlShouldRenderValue:!0,placeholder:"Search...",filterOption:Pf({ignoreAccents:!0,ignoreCase:!0,trim:!0,matchFrom:"any"}),styles:{menu:I=>({...I,position:"static",boxShadow:"none",border:"none",marginTop:"0.5rem",borderRadius:0,backgroundColor:S?Tt.transparent:Tt.surface.white}),menuList:I=>({...I,maxHeight:"calc(100vh - 160px)",height:"auto",paddingBottom:"2rem",overflowY:"auto",overflowX:"auto",overscrollBehaviorY:"contain",overscrollBehaviorX:"contain",touchAction:"pan-y"}),option:(I,B)=>S?I:{...I,color:J,backgroundColor:B.isSelected?Tt.surface.gray200:B.isFocused?Tt.surface.gray100:Tt.transparent},singleValue:I=>({...I,color:S?I.color:J}),input:I=>({...I,color:S?I.color:J}),placeholder:I=>({...I,color:S?I.color:xe}),control:I=>({...I,borderColor:Tt.border.focusBlue,boxShadow:`0 0 0 1px ${Tt.border.focusBlue}`,backgroundColor:S?I.backgroundColor:Tt.surface.white,color:S?I.color:J})},components:H,noOptionsMessage:()=>"No matches"})})]}):u.jsxs("div",{className:`${n} combo-control-root combo-control-inline`,children:[!f&&u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:o}),u.jsxs("div",{className:"combo-control-input-wrapper relative rs-scroll-target",ref:T,children:[u.jsx(Dy,{className:Y,classNamePrefix:"rs",options:M,value:ee,onChange:X,isSearchable:!0,isDisabled:c,filterOption:Pf({ignoreAccents:!0,ignoreCase:!0,trim:!0,matchFrom:"any"}),menuPortalTarget:D,menuPosition:"fixed",menuPlacement:"bottom",menuShouldScrollIntoView:!1,styles:{menuPortal:I=>({...I,zIndex:200}),menuList:I=>({...I,overflowY:"auto",overflowX:"auto",overscrollBehaviorY:"contain",overscrollBehaviorX:"contain",touchAction:"pan-y"}),option:(I,B)=>S?I:{...I,color:J,backgroundColor:B.isSelected?Tt.surface.gray200:B.isFocused?Tt.surface.gray100:Tt.transparent},singleValue:I=>({...I,color:S?I.color:J}),input:I=>({...I,color:S?I.color:J}),placeholder:I=>({...I,color:S?I.color:xe})},components:H,noOptionsMessage:()=>"No matches"}),u.jsxs("div",{className:"combo-control-icons absolute right-0 top-0 bottom-0 flex items-center pointer-events-none",children:[u.jsx("div",{className:"combo-control-chevron px-2 text-gray-400",children:u.jsx(vu,{className:"w-5 h-5"})}),m&&u.jsx("div",{className:"combo-control-pin pointer-events-auto px-2",children:u.jsx(nl,{isPinned:p,onToggle:g})}),!m&&u.jsx("div",{className:"w-3"})]})]}),E&&u.jsx("div",{className:"mt-1 text-xs text-red-700",children:"Missing on ComfyUI server"}),de&&u.jsxs("div",{className:"mt-2",children:[ke,u.jsx("input",{ref:V,type:"file",accept:"image/*",className:"hidden",onChange:be})]})]})}function _o({name:n,type:o,value:s,options:l,onChange:i,disabled:c=!1,hasError:f=!1,hideLabel:m=!1,compact:p=!1,forceModalOpen:g=!1,onModalClose:b,seedMode:x,onSeedModeChange:w,hasPin:k,isPinned:N=!1,onTogglePin:S,containerClass:j}){const[C,T]=y.useState(!1),V=()=>{c||T(!0)},U=()=>{T(!1),b?.()},R=o==="COMBO"||Array.isArray(l?.options),z=["INT","FLOAT"].includes(o.toUpperCase()),L=o.toUpperCase()==="STRING",$=n.replace(/_/g," "),Q=k??(!!S||N),ue=j??"space-y-2 w-full",fe=j??(p?"mb-0":"mb-3"),de={name:n,value:s,options:l,onChange:i,disabled:c,hideLabel:m,hasError:f,forceModalOpen:g,onModalClose:b,containerClass:ue,hasPin:Q,isPinned:N,onTogglePin:S},Ie=()=>R?u.jsx(yf,{...de}):z?u.jsx(Hf,{...de,type:o,seedMode:x,onSeedModeChange:w}):L?u.jsx(ry,{...de}):u.jsxs("div",{className:"unsupported-widget-type text-xs text-gray-400 italic",children:["Unsupported: ",o]}),je=g||C;if(o==="POWER_LORA_HEADER")return u.jsx("div",{className:`${fe} power-lora-header flex items-center justify-between p-3 bg-blue-50/50 dark:bg-blue-900/20 rounded-lg`,children:u.jsxs("div",{className:"power-lora-header-content flex items-center gap-3",children:[u.jsx("input",{type:"checkbox",onChange:Me=>i(Me.target.checked),className:"w-5 h-5 rounded cursor-pointer",disabled:c}),u.jsx("span",{className:"power-lora-header-label text-sm font-semibold text-blue-900 dark:text-blue-100 uppercase tracking-wider",children:"Toggle All Loras"})]})});if(o==="POWER_LORA"){const Me=s||{on:!0,lora:"",strength:1},_=l||{},oe=_.choices,ce=_.showSeparate,Ke=(Le,E)=>{i({...Me,[Le]:E})};return u.jsxs("div",{className:`${fe} power-lora-row flex flex-col gap-2 p-3 border border-gray-200 dark:border-gray-800 rounded-lg bg-gray-50/50 dark:bg-gray-900/50 ${Me.on?"":"opacity-60"}`,children:[u.jsxs("div",{className:"power-lora-row-actions flex items-center gap-2",children:[u.jsx("button",{type:"button",onClick:()=>Ke("on",!Me.on),className:`power-lora-enabled-button flex-1 py-2 rounded-lg text-sm font-semibold transition-colors ${Me.on?"bg-blue-600 text-white":"bg-gray-700 text-white"} ${c?"opacity-60 cursor-not-allowed":""}`,disabled:c,children:Me.on?"Enabled":"Disabled"}),u.jsx("button",{type:"button",onClick:()=>i(null),className:`power-lora-remove-button flex-1 py-2 rounded-lg text-sm font-semibold bg-red-600 text-white hover:bg-red-700 transition-colors ${c?"opacity-60 cursor-not-allowed":""}`,disabled:c,children:"Remove"})]}),u.jsx("div",{className:"power-lora-row-header flex items-center gap-3",children:u.jsx("div",{className:"power-lora-select flex-grow min-w-0",children:u.jsx(_o,{name:"",hideLabel:!0,compact:!0,type:"COMBO",value:Me.lora,options:oe,onChange:Le=>Ke("lora",Le),disabled:c})})}),u.jsxs("div",{className:"power-lora-strengths flex flex-col",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 ml-1",children:ce?"Model strength":"Strength"}),u.jsx("div",{className:"power-lora-strength-row flex items-center gap-3",children:u.jsx("div",{className:"power-lora-strength-input flex-grow",children:u.jsx(_o,{name:"",hideLabel:!0,compact:!0,type:"FLOAT",value:Me.strength,options:{min:-10,max:10,step:.01},onChange:Le=>Ke("strength",Le),disabled:c})})}),ce&&u.jsx("label",{className:"block text-sm font-medium text-gray-700 ml-1",children:"Clip strength"}),ce&&u.jsx("div",{className:"power-lora-strength-row flex items-center gap-3",children:u.jsx("div",{className:"power-lora-strength-input flex-grow",children:u.jsx(_o,{name:"",hideLabel:!0,compact:!0,type:"FLOAT",value:Me.strengthTwo??Me.strength,options:{min:-10,max:10,step:.01},onChange:Le=>Ke("strengthTwo",Le),disabled:c})})})]})]})}if(o==="POWER_LORA_ADD"){const Me=()=>{i({on:!0,lora:"None",strength:1,model_strength:1,clip_strength:1})};return u.jsx("div",{className:`${fe} power-lora-add`,children:u.jsxs("button",{onClick:Me,className:"w-full py-2 px-4 border-2 border-dashed border-gray-300 dark:border-gray-700 rounded-lg text-sm font-medium text-gray-500 hover:text-blue-500 hover:border-blue-500 transition-all flex items-center justify-center gap-2",disabled:c,children:[u.jsx(zo,{className:"w-5 h-5"}),"Add Lora"]})})}return L?u.jsx(ry,{...de}):R?u.jsx(yf,{...de}):z?u.jsx(Hf,{...de,type:o,seedMode:x,onSeedModeChange:w}):o.toUpperCase()==="BOOLEAN"?u.jsx(yf,{...de,value:String(!!s),options:["true","false"],onChange:Me=>i(String(Me).toLowerCase()==="true")}):u.jsxs("div",{id:`widget-control-${n}`,className:`widget-control-root ${p?"compact-control":""}`,children:[!m&&u.jsxs("div",{id:`widget-label-container-${n}`,className:"flex items-center justify-between mb-1.5 px-1",children:[u.jsx("label",{id:`widget-label-${n}`,className:"text-[10px] font-bold text-gray-500 uppercase tracking-wider truncate mr-2",children:$}),f&&u.jsx("div",{id:`widget-error-icon-${n}`,className:"text-red-500",title:"Error in this input",children:u.jsx(hb,{className:"w-3.5 h-3.5"})})]}),u.jsx("div",{id:`widget-trigger-${n}`,className:`
          control-trigger
          relative flex items-center justify-between
          bg-gray-50 border border-gray-200 rounded-xl px-3 py-2.5
          active:bg-gray-100 active:border-gray-300 transition-all
          ${c?"opacity-50 grayscale pointer-events-none":"cursor-pointer"}
          ${f?"border-red-300 bg-red-50/30":""}
        `,onClick:V,children:u.jsx("div",{id:`widget-value-display-${n}`,className:"value-display flex-1 truncate text-sm font-medium text-gray-900",children:R?s||"Select...":s!=null?String(s):"Empty"})}),u.jsx(gp,{isOpen:je,title:$,onClose:U,children:u.jsx("div",{id:`modal-control-wrapper-${n}`,className:"p-2",children:Ie()})})]})}function C4({node:n,isBypassed:o,isKSampler:s,workflowExists:l,nodeTypesExists:i,visibleInputWidgets:c,visibleWidgets:f,errorInputNames:m,onUpdateNodeWidget:p,onUpdateNodeWidgets:g,getWidgetIndexForInput:b,findSeedWidgetIndex:x,setSeedMode:w,isWidgetPinned:k,toggleWidgetPin:N}){const S=Array.isArray(n.widgets_values)?n.widgets_values:[],j=ae(M=>M.nodeTypes),C=ae(M=>M.workflow),T=ae(M=>M.bypassAllInContainer),V=Wn(M=>M.seedModes[n.id]),U=Wn(M=>M.seedLastValues[n.id]??null),R=n.type==="Fast Groups Bypasser (rgthree)",z=!s&&l&&i?x():null,L=z!==null?z+1:null,$=L!==null?S[L]:void 0,Q=typeof $=="string",ue=!s&&z!==null&&!Q,fe=ue?c.filter(M=>M.name!=="seed"&&M.name!=="noise_seed"):c,de=ue?f.filter(M=>M.name!=="seed"&&M.name!=="noise_seed"):f,Ie=f.length>0||c.length>0,je=y.useMemo(()=>{if(!R||!C)return[];const M=n.properties??{},ee=typeof M.matchColors=="string"?M.matchColors:"",Te=typeof M.matchTitle=="string"?M.matchTitle:"",qe=M.showAllGraphs!==!1,ye=typeof M.sort=="string"?M.sort:"position",Ne=typeof M.customSortAlphabet=="string"?M.customSortAlphabet:"",H=Tt.workflow.fastGroupBypassColors,Y=ee.split(",").map(B=>B.trim()).filter(Boolean).flatMap(B=>W0(B,H)),D=new Set(Y),K=Y.map(B=>ba(B)??vb(B)).filter(B=>!!B).map(B=>G0(B)).filter(B=>!!B);let X=null;if(Te.trim())try{X=new RegExp(Te,"i")}catch(B){return console.error(B),[]}let W=null;if(ye==="custom alphabet"){const B=Ne.replace(/\n/g,"").trim().toLowerCase();B&&(W=B.includes(",")?B.split(",").map(q=>q.trim()).filter(Boolean):B.split("")),W?.length||(W=null)}const Oe=new Map(C.nodes.map(B=>[B.id,B])),be=[],ke=B=>{if(D.size>0){const q=B.color?W0(B.color,H):[],he=B.color?ba(B.color):null,me=he?G0(he):null,Se=q.some(ie=>D.has(ie))||(he?D.has(he):!1),F=!!(me&&K.some(ie=>{const Ae=Math.abs(ie.h-me.h);return Math.min(Ae,360-Ae)<=25}));if(!Se&&!F)return!1}return!(X&&!X.test(B.title||""))},J=(B,q)=>{if(!ke(B))return;const he=B.stableKey??null;if(!he)return;const me=If(C,B.id,q);let Se=!1;for(const F of me){const ie=Oe.get(F);if(!(!ie||ie.mode===4)){Se=!0;break}}be.push({key:`${q??"root"}-${B.id}`,label:B.title?.trim()||`Group ${B.id}`,stableKey:he,color:B.color,isEngaged:Se,isDisabled:me.size===0,group:B})},xe=n.properties?.__mobile_origin,I=xe?.scope==="subgraph"?xe.subgraphId:null;if(qe){for(const B of C.groups??[])J(B,null);for(const B of C.definitions?.subgraphs??[])for(const q of B.groups??[])J(q,B.id)}else if(I){const B=C.definitions?.subgraphs?.find(q=>q.id===I);for(const q of B?.groups??[])J(q,I)}else for(const B of C.groups??[])J(B,null);return ye==="alphanumeric"?be.sort((B,q)=>B.label.localeCompare(q.label)):W?.length?be.sort((B,q)=>{const he=B.label.toLowerCase(),me=q.label.toLowerCase();let Se=-1,F=-1;for(const[ie,Ae]of W.entries())if(Se<0&&he.startsWith(Ae)&&(Se=ie),F<0&&me.startsWith(Ae)&&(F=ie),Se>-1&&F>-1)break;if(Se>-1&&F>-1){const ie=Se-F;return ie===0?he.localeCompare(me):ie}return Se>-1?-1:F>-1?1:he.localeCompare(me)}):be.sort((B,q)=>{const he=B.group.bounding,me=q.group.bounding;return he[1]!==me[1]?he[1]-me[1]:he[0]-me[0]}),be},[R,n.properties,C]),Me=M=>()=>{M.isDisabled||T(M.stableKey,M.isEngaged)},_=M=>{typeof M=="string"&&["fixed","randomize","increment","decrement"].includes(M)&&w(n.id,M)},oe=M=>ee=>{p(M,ee),_(ee)},ce=M=>ee=>{p(M,ee,"seed"),w(n.id,"fixed")},Ke=M=>()=>{if(!j)return;const ee=fa(j,n);p(M,ee,"seed"),w(n.id,"fixed")},Le=M=>()=>{typeof U=="number"&&(p(M,U,"seed"),w(n.id,"fixed"))},E=M=>ee=>{p(M.widgetIndex,ee,M.name)},A=M=>ee=>{if(M.type==="POWER_LORA_HEADER"&&typeof ee=="boolean"){const{loraIndices:Te}=M.options||{};if(Te){const qe={},ye=n.widgets_values;Array.isArray(ye)&&(Te.forEach(Ne=>{const H=ye[Ne];qe[Ne]={...H,on:ee}}),g(qe))}}else p(M.widgetIndex,ee,M.name)};return!Ie&&je.length===0?null:u.jsxs("div",{className:"node-parameters mb-2",children:[je.length>0&&u.jsxs("div",{className:"mb-4",children:[u.jsx("div",{className:"text-xs text-gray-400 dark:text-gray-300 mb-1.5 uppercase tracking-wide",children:"Groups"}),u.jsx("div",{className:"space-y-2",children:je.map(M=>u.jsxs("div",{className:`flex items-center justify-between gap-3 rounded-lg border px-3 py-2 bg-gray-50/40 dark:bg-gray-900/60 ${M.isDisabled?"border-gray-200 dark:border-white/10 opacity-60":"border-gray-200 dark:border-white/15"}`,children:[u.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[u.jsx("span",{className:"h-2.5 w-2.5 rounded-full",style:{backgroundColor:M.color||Tt.workflow.defaultGroupDot}}),u.jsx("span",{className:"text-sm font-medium text-gray-800 dark:text-gray-100 truncate",children:M.label})]}),u.jsx("button",{type:"button",role:"switch","aria-checked":M.isEngaged,onClick:Me(M),className:`relative inline-flex h-6 w-11 items-center rounded-full transition ${M.isEngaged?"bg-emerald-500":"bg-gray-300"} ${M.isDisabled?"cursor-not-allowed":"cursor-pointer"}`,children:u.jsx("span",{className:`inline-block h-5 w-5 transform rounded-full bg-white transition ${M.isEngaged?"translate-x-5":"translate-x-1"}`})})]},M.key))})]}),Ie&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"text-xs text-gray-500 mb-1.5 uppercase tracking-wide",children:"Parameters"}),s&&l&&i&&(()=>{const M=b("seed");if(M===null)return null;const ee=S[M],Te=M+1,qe=S[Te],ye=["fixed","increment","decrement","randomize"],H=!!n.inputs.find(Y=>Y.name==="noise_seed")?.link;return u.jsxs("div",{className:"mb-3",children:[u.jsx(_o,{name:"seed",type:"INT",value:ee,onChange:Y=>p(M,Y,"seed"),disabled:o,hasError:m.has("seed")}),Te<S.length&&!H&&u.jsx(_o,{name:"Control mode",type:"COMBO",value:qe,options:ye,onChange:oe(Te)})]})})(),!s&&l&&i&&(()=>{const M=z;if(M===null)return null;const ee=["fixed","randomize","increment","decrement"],Te=typeof $=="string"&&!ee.includes($)?[...ee,$]:ee;if(n.inputs.find(ke=>ke.name==="seed"||ke.name==="noise_seed")?.link!=null)return null;if(Q){const ke=M+1;return u.jsx("div",{className:"mb-3",children:u.jsx(_o,{name:"Seed control",type:"COMBO",value:$,options:Te,onChange:oe(ke)})})}const Ne=c.find(ke=>ke.name==="seed"||ke.name==="noise_seed")?.options??{},H=typeof Ne.min=="number"?Ne.min:void 0,Y=typeof Ne.max=="number"?Ne.max:void 0,D=typeof Ne.step=="number"?Ne.step:void 0,K=Number(S[M]??0),X=nb(K),W=V??X??"fixed",Oe=sp(K)?typeof U=="number"?U:0:K,be=m.has("seed")||m.has("noise_seed");return u.jsxs("div",{className:"mb-3",children:[u.jsx(Hf,{name:"seed",value:Oe,onChange:ce(M),disabled:o,min:H,max:Y,step:D,hasError:be}),u.jsx(_o,{name:"Seed control",type:"COMBO",value:W,options:ee,onChange:_}),u.jsxs("div",{className:"grid gap-2 mt-2",children:[u.jsx("button",{type:"button",className:"w-full py-2 px-3 border border-gray-200 rounded-lg text-sm font-medium text-gray-600 hover:text-blue-600 hover:border-blue-500 transition",onClick:()=>w(n.id,"randomize"),disabled:o,children:"Randomize each time"}),u.jsx("button",{type:"button",className:"w-full py-2 px-3 border border-gray-200 rounded-lg text-sm font-medium text-gray-600 hover:text-blue-600 hover:border-blue-500 transition",onClick:Ke(M),disabled:o,children:"New fixed random"}),u.jsx("button",{type:"button",className:"w-full py-2 px-3 border border-gray-200 rounded-lg text-sm font-medium text-gray-600 hover:text-blue-600 hover:border-blue-500 transition",onClick:Le(M),disabled:o||typeof U!="number",children:"Use last queued seed"})]})]})})(),fe.map(M=>u.jsx("div",{className:o?"opacity-80":"",children:u.jsx(_o,{name:M.name,type:M.type,value:M.value,options:M.options,onChange:E(M),disabled:o,isPinned:k(M.widgetIndex),onTogglePin:()=>N(M.widgetIndex,M.name,M.type,M.options),hasError:m.has(M.name)})},`input-widget-${M.name}`)),de.map(M=>u.jsx("div",{className:o?"opacity-80":"",children:u.jsx(_o,{name:M.name,type:M.type,value:M.value,options:M.options,onChange:A(M),disabled:o,isPinned:k(M.widgetIndex),onTogglePin:()=>N(M.widgetIndex,M.name,M.type,M.options),hasError:m.has(M.name)})},`widget-${M.widgetIndex}`)),n.type==="PrimitiveNode"&&(()=>{const M=n.outputs?.[0]?.type,ee=String(M).toUpperCase();if(ee!=="INT"&&ee!=="FLOAT"||S.length<2)return null;const Te=S[1],qe=["fixed","increment","decrement","randomize"];return u.jsx("div",{className:"mb-3",children:u.jsx(_o,{name:"Control mode",type:"COMBO",value:Te,options:qe,onChange:ye=>p(1,ye),disabled:o})})})()]})]})}function k4(n,o,s){if(!o)return null;const l=Wr(n,o,s,"image")??Wr(n,o,s,"filename")??Wr(n,o,s,"file");if(l==null||!Array.isArray(s.widgets_values))return null;const i=s.widgets_values[l];return j4(i)}function j4(n){if(typeof n=="string"&&n.trim()){const{filename:m,subfolder:p}=By(n.trim());return{filename:m,subfolder:p,type:"input"}}if(!n||typeof n!="object")return null;const o=n,s=typeof o.filename=="string"?o.filename:typeof o.name=="string"?o.name:null;if(!s||!s.trim())return null;const l=typeof o.subfolder=="string"?o.subfolder:"",i=typeof o.type=="string"?o.type:"input",{filename:c,subfolder:f}=By(s.trim());return{filename:c,subfolder:l||f,type:i}}function By(n){const o=n.replace(/^\/+/,""),s=o.split("/").filter(Boolean);return s.length<=1?{filename:o,subfolder:""}:{filename:s.pop()??o,subfolder:s.join("/")}}const M4=[],O4=y.memo(function({node:o,isExecuting:s,isConnectionHighlighted:l=!1,errorBadgeLabel:i,onImageClick:c,inGroup:f=!1,onMoveNode:m}){const p=ae(te=>te.nodeTypes),g=ae(te=>te.workflow),b=ae(te=>te.updateNodeWidget),x=ae(te=>te.updateNodeWidgets),w=ae(te=>te.updateNodeTitle),k=ae(te=>te.toggleBypass),N=ae(te=>te.setItemCollapsed),S=ae(te=>te.setItemHidden),j=ae(te=>te.collapsedItems),C=o.stableKey??null,T=ae(te=>te.setConnectionHighlightMode),V=ae(te=>te.connectionHighlightModes[o.id]??"off"),U=Wn(te=>te.setSeedMode),R=ae(te=>te.currentWorkflowKey),z=ho(te=>te.pinnedWidget?.nodeId===o.id?te.pinnedWidget:null),L=ho(te=>te.setPinnedWidget),$=Gn(te=>te.bookmarkedItems),Q=Gn(te=>te.toggleBookmark),ue=ae(te=>te.nodeOutputs[String(o.id)]),fe=dn(te=>te.nodeErrors[String(o.id)]),de=ae(te=>te.progress),Ie=ae(te=>te.executingPromptId),je=ae(te=>te.workflowDurationStats),Me=ae(te=>te.isExecuting),_=It(te=>te.running),oe=Ie||(_[0]?.prompt_id??null),ce=Ma({workflow:g,runKey:oe,isRunning:Me||_.length>0,workflowDurationStats:je}),Ke=ce===100?100:de,Le=y.useCallback((te,We)=>{C&&U(te,We,{workflow:g,nodeTypes:p,updateNodeWidgets:(nt,ut)=>x(C,ut)})},[C,p,U,x,g]),E=y.useCallback(te=>{L(te,R)},[R,L]),A=ue??M4,[M,ee]=y.useState(null),{errorPopoverOpen:Te,setErrorPopoverOpen:qe,resetErrorPopover:ye}=bS(),Ne=y.useRef(null),[H,Y]=y.useState(!1),[D,K]=y.useState(!1),[X,W]=y.useState(""),Oe=y.useRef(null),be=y.useRef(0),ke=y.useRef(null),[J,xe]=y.useState(null),[I,B]=y.useState(!1),q=ae(te=>te.deleteNode);y.useEffect(()=>{const te=We=>{const nt=We.detail;if(nt.nodeId===o.id){xe(nt.label);const ut=setTimeout(()=>xe(null),1e3);return()=>clearTimeout(ut)}};return window.addEventListener("node-show-label",te),()=>window.removeEventListener("node-show-label",te)},[o.id]);const he=fe&&fe.length>0,me=y.useMemo(()=>fe?new Set(fe.map(te=>te.inputName).filter(te=>!!te)):new Set,[fe]),Se=A.length>0?A[A.length-1]:null,F=Se?`${Se.filename}|${Se.subfolder}|${Se.type}`:null,ie=M?`${M.filename}|${M.subfolder}|${M.type}`:null;y.useEffect(()=>{if(!Se||F===ie)return;const te=mo(Se.filename,Se.subfolder,Se.type),We=new Image;We.onload=()=>ee(Se),We.src=te},[F,ie,Se]);const Ae=p?.[o.type],Ue=y.useMemo(()=>{const te=o.title;return typeof te=="string"&&te.trim()?te.trim():null},[o]),Je=Ue||Ae?.display_name||o.type,Pe=o.type==="KSampler",st=o.mode===4,$e=C?!!j[C]:!1,Fe=/LoadImage/i.test(o.type),ht=y.useMemo(()=>!Fe||!g||!p?null:k4(g,p,o),[Fe,o,p,g])??M,Lt=y.useMemo(()=>{const te=lp(p,o);return Pe?te.filter(We=>We.name!=="seed"):te},[p,o,Pe]),Gt=y.useMemo(()=>ap(p,o),[p,o]),Pt=y.useMemo(()=>Gt.filter(te=>!te.connected),[Gt]),$t=y.useMemo(()=>Lt.filter(te=>!te.connected),[Lt]),Ge=y.useMemo(()=>{const te=o.properties,We=["text","note","description","label","title"];if(te)for(const ut of We){const _t=te[ut];if(typeof _t=="string"&&_t.trim())return _t}if(/note|comment|sticky|label/i.test(o.type)&&Array.isArray(o.widgets_values)){const ut=o.widgets_values.find(_t=>typeof _t=="string"&&_t.trim());if(typeof ut=="string"&&ut.trim())return ut}return null},[o.properties,o.widgets_values,o.type]),He=y.useMemo(()=>{if(!/note|comment|sticky|label/i.test(o.type)||!Array.isArray(o.widgets_values))return null;const We=o.widgets_values.findIndex(nt=>typeof nt=="string"&&nt.trim());return We>=0?We:null},[o.type,o.widgets_values]),Ve=te=>!g||!p?null:Wr(g,p,o,te),et=()=>!g||!p?null:rl(g,p,o),ft=te=>{He!==null&&C&&b(C,He,te)},St=y.useMemo(()=>{if(!Ge)return null;const te=[],We=/(https?:\/\/[^\s]+)/g;let nt=0,ut,_t=0;for(;(ut=We.exec(Ge))!==null;){const[nn]=ut,Ln=ut.index;Ln>nt&&te.push(Ge.slice(nt,Ln)),te.push(u.jsx("a",{href:nn,target:"_blank",rel:"noreferrer",className:"text-blue-600 underline break-all",children:nn},`note-link-${_t++}`)),nt=Ln+nn.length}return nt<Ge.length&&te.push(Ge.slice(nt)),te},[Ge]),zt=()=>{const te=Date.now();te-be.current<300&&Y(!0),be.current=te},le=y.useMemo(()=>{const te=[];return Pt.forEach(We=>{te.push({widgetIndex:We.widgetIndex,name:We.name,type:We.type,options:We.options})}),$t.forEach(We=>{te.push({widgetIndex:We.widgetIndex,name:We.name,type:We.type,options:We.options})}),te},[Pt,$t]),se=y.useCallback(te=>{if(te.link!=null)return!1;if(te.widget)return!0;const We=Ae?.input?.required?.[te.name]||Ae?.input?.optional?.[te.name];if(!We)return!1;const[nt,ut]=We;if(Array.isArray(nt))return!0;const _t=String(nt).toUpperCase(),nn=Object.prototype.hasOwnProperty.call(ut??{},"default");return["INT","FLOAT","BOOLEAN","STRING"].includes(_t)||nn},[Ae]),De=y.useMemo(()=>o.inputs.filter(te=>!(se(te)||String(te.type).toUpperCase()==="OPT_CONNECTION"&&te.link==null)),[o.inputs,se]),Ze=y.useMemo(()=>o.outputs.filter(te=>!((te.name||"").toLowerCase().replace(/[_\s]/g,"")==="showhelp"||String(te.type).toUpperCase()==="OPT_CONNECTION"&&!te.links?.length)),[o.outputs]),Qe=o.outputs.some(te=>String(te.type).toUpperCase()==="IMAGE"),rt=!!(Ae?.output_node||/PreviewImage|SaveImage|SaveAnimatedPNG|SaveAnimatedWEBP|SaveVideo/i.test(o.type)),Re=te=>z?.widgetIndex===te,gt=(te,We,nt,ut)=>{Re(te)?E(null):E({nodeId:o.id,widgetIndex:te,widgetName:We,widgetType:nt,options:ut})},bt=le.length===1?le[0]:null,it=bt?Re(bt.widgetIndex):!1,xt=!!z,Nt=C?$.includes(C):!1,jt=$.length<5||Nt,pt=(Qe||rt)&&!!ht,At=o.inputs?.filter(te=>te.link!=null).length??0,tn=o.outputs?.reduce((te,We)=>te+(We.links?.length??0),0)??0,In=At>0||tn>0,cn=Math.min(3,At),P=Math.min(3,tn),Ee=ht?(()=>{const{filename:te,subfolder:We,type:nt}=ht,ut=mo(te,We,nt),_t=We?`${We}/${te}`:te,nn=Oa(te);return[{src:ut,alt:Je,filename:te,mediaType:nn,file:{id:`${nt}/${_t}`,name:te,type:nn==="video"?"video":"image",fullUrl:ut}}]})():[];y.useEffect(()=>{if(!D)return;const te=Oe.current;te&&(te.focus(),te.select())},[D]);const ne=()=>{W(Je),K(!0)},ot=()=>{const te=X.trim();C&&(w(C,te.length>0?te:null),K(!1))},tt=y.useCallback((te,We,nt)=>{C&&b(C,te,We,nt)},[C,b]),Xe=y.useCallback(te=>{C&&x(C,te)},[C,x]),Ye=!!(J&&!/^error\b/i.test(J));return u.jsxs("div",{id:`node-card-wrapper-${o.id}`,className:"relative node-card-outer",children:[u.jsx("div",{id:`node-anchor-${o.id}`,className:"absolute -top-3 left-0 right-0 h-0 node-scroll-anchor"}),Ye&&u.jsx(jS,{label:J??""}),i&&u.jsx("div",{className:"absolute top-2 right-2 z-[110] animate-in fade-in duration-150",children:u.jsx("div",{className:"bg-red-600 text-white text-[10px] font-black px-2 py-0.5 rounded-full shadow-lg whitespace-nowrap uppercase tracking-tighter ring-2 ring-white",children:i})}),u.jsxs("div",{id:`node-card-${o.id}`,className:`
        node-card-inner
        ${f?"rounded-lg shadow-sm py-1":"rounded-xl shadow-md px-2 py-1 mb-3"}
        border-2
        ${he?"border-red-700 shadow-red-200":l?"border-orange-500 shadow-orange-200":s?"border-green-500 shadow-green-200":st?"border-purple-300":"border-transparent"}
        ${st?$e?"bg-purple-200":"bg-purple-100/50":"bg-white"}
      `,style:{overflow:"visible"},children:[u.jsx(CS,{nodeId:o.id,displayName:Je,isEditingLabel:D,labelValue:X,labelInputRef:Oe,onLabelChange:W,onLabelBlur:ot,isCollapsed:$e,isBypassed:st,isExecuting:s,overallProgress:ce,hasErrors:he,errorIconRef:ke,errorPopoverOpen:Te,setErrorPopoverOpen:qe,toggleNodeFold:()=>{C&&N(C,!$e)},rightSlot:u.jsx(vS,{nodeId:o.id,nodeStableKey:C,isBypassed:st,onEditLabel:ne,pinnableWidgets:le,singlePinnableWidget:bt,isSingleWidgetPinned:it,hasPinnedWidget:xt,toggleWidgetPin:gt,setPinnedWidget:E,isNodeBookmarked:Nt,canAddNodeBookmark:jt,onToggleNodeBookmark:()=>C?Q(C):void 0,toggleBypass:k,setItemHidden:S,onDeleteNode:()=>B(!0),onMoveNode:m??(()=>{}),connectionHighlightMode:V,setConnectionHighlightMode:T,leftLineCount:cn,rightLineCount:P})}),u.jsx("div",{className:`grid transition-[grid-template-rows] duration-200 ease-out ${$e?"grid-rows-[0fr]":"grid-rows-[1fr]"}`,children:u.jsxs("div",{className:`collapse-container overflow-hidden transition-opacity px-1 duration-200 ease-out ${$e?"opacity-0":"opacity-100"}`,children:[Ue&&u.jsx("div",{className:"node-card-subtitle text-[10px] text-center font-semibold uppercase tracking-wider text-gray-400 mb-2 px-1",children:Ae?.display_name||o.type}),u.jsxs("div",{id:`node-content-${o.id}`,className:`node-expanded-content ${st?"opacity-60 grayscale":""}`,children:[u.jsx(AS,{nodeId:o.id,nodeType:o.type,inputs:De,outputs:Ze,allInputs:o.inputs,allOutputs:o.outputs}),u.jsx(C4,{node:o,isBypassed:st,isKSampler:Pe,workflowExists:!!g,nodeTypesExists:!!p,visibleInputWidgets:Pt,visibleWidgets:$t,errorInputNames:me,onUpdateNodeWidget:tt,onUpdateNodeWidgets:Xe,getWidgetIndexForInput:Ve,findSeedWidgetIndex:et,setSeedMode:Le,isWidgetPinned:Re,toggleWidgetPin:gt}),Ge&&u.jsx(SS,{noteText:Ge,noteLinkified:St,noteWidgetIndex:He,isEditingNote:H,setIsEditingNote:Y,onUpdateNote:ft,noteTextareaRef:Ne,onNoteTap:zt}),u.jsx(NS,{show:pt,previewImage:ht,displayName:Je,onImageClick:()=>c?.(Ee,0),isExecuting:!!s,overallProgress:ce,displayNodeProgress:Ke})]})]})})]}),u.jsx(wS,{nodeId:o.id,open:Te&&he,errors:fe??[],anchorRef:ke,onClose:ye}),I&&u.jsx(kS,{nodeId:o.id,displayName:Je,hasConnections:In,onCancel:()=>B(!1),onDelete:te=>{C&&q(C,te),B(!1)}})]})});function T4({onClick:n}){return u.jsxs("button",{type:"button",onClick:n,className:"w-full mb-3 py-4 rounded-xl border-2 border-dashed border-gray-300 flex items-center justify-center gap-2 text-sm font-medium text-gray-400 hover:border-gray-400 hover:text-gray-500 active:bg-gray-50 transition-colors",children:[u.jsx(zo,{className:"w-4 h-4"}),"Add node"]})}function zy({id:n,headerId:o,title:s,nodeCount:l,backgroundColor:i,borderColor:c,textClassName:f,className:m=""}){const p=()=>{document.getElementById(o)?.scrollIntoView({behavior:"smooth",block:"start"})};return u.jsx("div",{id:n,className:`px-3 py-1.5 -mx-1 rounded-b-xl cursor-pointer ${m}`,onClick:p,style:{backgroundColor:i,borderColor:c},children:u.jsxs("div",{className:"flex items-center justify-between gap-3",children:[u.jsx("span",{className:`text-xs select-none ${f}`,children:s}),typeof l=="number"&&u.jsxs("span",{className:`text-xs select-none ${f}`,children:[l," node",l!==1?"s":""]})]})})}function Hy({containerType:n,containerId:o,title:s,nodeCount:l,isCollapsed:i,hiddenNodeCount:c,isBookmarked:f,canShowBookmarkAction:m,foldAllLabel:p,backgroundColor:g,borderColor:b,onToggleCollapse:x,onToggleFoldAll:w,onToggleBookmark:k,onBypassAll:N,onHide:S,onAddNode:j,onDelete:C,onShowHiddenNodes:T,onMove:V,onCommitTitle:U}){const[R,z]=y.useState(!1),[L,$]=y.useState(!1),[Q,ue]=y.useState(""),fe=y.useRef(null),de=y.useRef(null),Ie=y.useRef(null),{menuStyle:je,resetMenuPosition:Me}=mp({open:R,buttonRef:Ie,menuRef:de}),_=s.trim()||`${n} ${o}`,oe=c>0,ce=f||m,Ke=n==="subgraph"?"text-blue-600":"text-gray-500",Le=()=>{z(!1),Me()};cl({open:R,onDismiss:()=>{z(!1),Me()},triggerRef:Ie,contentRef:de,ignoreScrollWithinContent:!0}),y.useEffect(()=>{if(!L)return;const A=fe.current;A&&(A.focus(),A.select())},[L]);const E=()=>{L||x()};return u.jsxs("div",{id:`${n}-header-${o}`,className:`flex items-center justify-between cursor-pointer gap-3 px-3 py-2 ${i?"rounded-xl":"rounded-t-xl mb-2"}`,style:{backgroundColor:g,borderColor:b},onClick:E,children:[u.jsxs("div",{className:"flex items-center gap-1 min-w-0 flex-1",children:[u.jsx("button",{onClick:A=>{A.stopPropagation(),x()},className:"w-8 h-8 -ml-2 flex items-center justify-center text-gray-500 hover:text-gray-700 shrink-0",children:i?u.jsx(gs,{className:"w-6 h-6"}):u.jsx(to,{className:"w-6 h-6"})}),L?u.jsx("input",{ref:fe,value:Q,onChange:A=>ue(A.target.value),onBlur:()=>{U(Q),$(!1)},onKeyDown:A=>{(A.key==="Enter"||A.key==="Escape")&&A.currentTarget.blur()},onClick:A=>A.stopPropagation(),className:"font-semibold text-gray-900 flex-1 min-w-0 text-sm bg-white border border-gray-200 rounded px-2 py-1"}):u.jsx("h3",{className:"font-semibold text-gray-900 select-none flex-1 min-w-0 whitespace-nowrap overflow-hidden text-ellipsis",children:_}),u.jsxs("span",{className:`text-sm shrink-0 ${Ke}`,children:[l," node",l!==1?"s":""]})]}),u.jsx(Pr,{onClick:A=>{A.stopPropagation(),Me(),z(M=>!M)},ariaLabel:`${n} options`,buttonRef:Ie,buttonSize:8,iconSize:5,icon:f?u.jsx(Gr,{className:"w-5 h-5 text-blue-500"}):n==="subgraph"?u.jsx(bs,{className:"w-5 h-5 -scale-x-100 text-blue-500"}):void 0}),R&&En.createPortal(u.jsx("div",{ref:de,className:"fixed z-[1000] w-44",style:je,children:u.jsx(gr,{items:[{key:"edit-label",label:"Edit label",icon:u.jsx(cp,{className:"w-4 h-4"}),onClick:A=>{A.stopPropagation(),ue(_),$(!0),Le()}},{key:"add-node",label:"Add node",icon:u.jsx(zo,{className:"w-4 h-4"}),onClick:A=>{A.stopPropagation(),j(),Le()}},{key:"fold-all",label:p,icon:p==="Fold all"?u.jsx(gs,{className:"w-4 h-4"}):u.jsx(to,{className:"w-4 h-4"}),onClick:A=>{A.stopPropagation(),w(),Le()}},{key:"bypass-all",label:"Bypass all nodes",icon:u.jsx(Rf,{isBypassed:!0,className:"w-4 h-4"}),onClick:A=>{A.stopPropagation(),N(!0),Le()}},{key:"unbypass-all",label:"Un-bypass all nodes",icon:u.jsx(Rf,{isBypassed:!1,className:"w-4 h-4"}),onClick:A=>{A.stopPropagation(),N(!1),Le()}},{key:"toggle-bookmark",label:f?"Remove bookmark":"Bookmark container",icon:f?u.jsx(Gr,{className:"w-4 h-4 text-blue-500"}):u.jsx(_u,{className:"w-4 h-4"}),onClick:A=>{A.stopPropagation(),k(),Le()},hidden:!ce},{key:"show-hidden-nodes",label:"Show hidden nodes",icon:u.jsx(Go,{className:"w-4 h-4"}),onClick:A=>{A.stopPropagation(),T(),Le()},hidden:!oe},{key:"hide-container",label:`Hide ${n}`,icon:u.jsx(Go,{className:"w-4 h-4"}),onClick:A=>{A.stopPropagation(),S(),Le()}},{key:"move-container",label:`Move ${n}`,icon:u.jsx(xb,{className:"w-4 h-4"}),onClick:A=>{A.stopPropagation(),V(),Le()}},{key:"delete-container",label:`Delete ${n}`,icon:u.jsx(Bo,{className:"w-4 h-4"}),color:"danger",onClick:A=>{A.stopPropagation(),C(),Le()}}]})}),document.body)]})}function Vy({containerType:n,containerId:o,hiddenNodeCount:s=0,borderColor:l,dashedBorderColor:i,onClick:c}){const f=n==="group"?"group":"subgraph";return u.jsx("div",{id:`${n}-placeholder-${o}`,className:"flex items-center justify-center px-4 pb-4 pt-2",style:{borderColor:l},children:u.jsxs("button",{type:"button",onClick:c,className:"w-full rounded-lg border-2 border-dashed flex flex-col items-center justify-center py-4 hover:bg-white/40 transition-colors",style:{borderColor:i},children:[u.jsx("span",{className:"text-sm text-gray-400 select-none",children:s>0?`${s} hidden node${s!==1?"s":""} in ${f}`:`No nodes in ${f}`}),u.jsxs("span",{className:"text-xs text-gray-500 select-none mt-1 inline-flex items-center gap-1",children:[u.jsx(zo,{className:"w-3 h-3"}),"Click to add a node"]})]})})}function E4({isOpen:n,onClose:o,addInGroupId:s=null,addInSubgraphId:l=null,onNodeAdded:i}){const c=ae(k=>k.nodeTypes),f=ae(k=>k.addNode),m=ae(k=>k.scrollToNode),[p,g]=y.useState(""),b=y.useMemo(()=>c?Object.entries(c).map(([k,N],S)=>({index:S,name:k,displayName:ms(N,k),pack:hs(String(N.python_module??N.category?.split("/")[0]??"Core")),category:String(N.category??"Other"),description:String(N.description??"")})):[],[c]),x=y.useMemo(()=>Bf(b,p,k=>({displayName:k.displayName,typeName:k.name,category:k.category,pack:k.pack}),k=>k.index),[b,p]),w=k=>{const N=s==null&&l==null?void 0:{...s==null?{}:{inGroupId:s},...l==null?{}:{inSubgraphId:l}},S=f(k,N);if(o(),S!==null){i?.(S);const j=ae.getState().workflow?.nodes.find(C=>C.id===S)?.stableKey??null;j&&m(j)}};return u.jsx(Cb,{isOpen:n,onClose:o,title:"Add node",searchQuery:p,onSearchQueryChange:g,searchPlaceholder:"Search node types...",children:u.jsxs("div",{className:"flex-1 overflow-auto bg-white",children:[x.length===0&&u.jsx(aa,{query:p,message:"No matching node types found"}),u.jsx("div",{className:"px-3 pt-3 pb-20 flex flex-col gap-2",children:x.map(k=>u.jsx(zf,{title:k.displayName,subtitle:k.pack||"Core",onSelect:()=>w(k.name)},k.name))})]})})}function I4({containerTypeLabel:n,containerIdLabel:o,displayName:s,nodeCount:l,onCancel:i,onDeleteContainerOnly:c,onDeleteContainerAndNodes:f}){const m=n;return En.createPortal(u.jsx(Po,{onClose:i,title:`Delete ${m}`,description:u.jsxs(u.Fragment,{children:[u.jsx("span",{className:"font-medium text-gray-700",children:s})," (",o,") has ",l," node",l===1?"":"s","."]}),actionsLayout:"stack",actions:[{label:`Delete ${m} only`,onClick:c,className:"w-full px-4 py-2.5 text-sm font-medium text-red-700 bg-red-50 rounded-lg hover:bg-red-100 active:bg-red-200"},{label:`Delete ${m} and nodes`,onClick:f,className:"w-full px-4 py-2.5 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700 active:bg-red-800"},{label:"Cancel",onClick:i,className:"w-full px-4 py-2.5 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 active:bg-gray-300"}]}),document.body)}function lu(n){return String(n).split(",").map(o=>o.trim().toUpperCase()).filter(Boolean)}function Ky(n){return n.toLowerCase().replace(/[_-]+/g," ").replace(/\s+/g," ").trim()}function L4(n,o){let s=0;for(const l of o)if(l===n[s]&&(s+=1,s>=n.length))return!0;return n.length===0}function bf(n,o){if(!n.trim())return!0;const s=Ky(o);return Ky(n).split(" ").filter(Boolean).every(l=>s.includes(l)||L4(l,s))}function A4({visible:n,onImageClick:o}){const s=ae(P=>P.workflow),l=ae(P=>P.executingNodeId),i=ae(P=>P.connectionHighlightModes),c=Gn(P=>P.bookmarkBarSide),f=Gn(P=>P.bookmarkBarTop),m=Gn(P=>P.setBookmarkBarPosition),p=Gn(P=>P.setBookmarkRepositioningActive),g=ae(P=>P.setItemCollapsed),b=ae(P=>P.scrollToNode),x=ae(P=>P.revealNodeWithParents),w=ae(P=>P.nodeTypes),k=dn(P=>P.nodeErrors),N=ae(P=>P.searchOpen),S=ae(P=>P.searchQuery),j=ae(P=>P.setSearchQuery),C=ae(P=>P.setSearchOpen),T=ae(P=>P.addNodeModalRequest),V=ae(P=>P.clearAddNodeModalRequest),U=ae(P=>P.collapsedItems),R=ae(P=>P.hiddenItems),z=ae(P=>P.setItemHidden),L=ae(P=>P.bypassAllInContainer),$=ae(P=>P.deleteContainer),Q=ae(P=>P.updateContainerTitle),ue=ae(P=>P.mobileLayout),fe=ae(P=>P.stableKeyByPointer),de=Gn(P=>P.bookmarkedItems),Ie=Gn(P=>P.toggleBookmark),je=y.useRef(null),Me=y.useRef(null),_=y.useRef(null),oe=y.useRef(null),[ce,Ke]=y.useState(0),[Le,E]=y.useState(!1),[A,M]=y.useState(!1),[ee,Te]=y.useState(null),[qe,ye]=y.useState(!1),[Ne,H]=y.useState(null),[Y,D]=y.useState(null),[K,X]=y.useState(null),W=nS(),[Oe,be]=y.useState({}),ke=y.useRef(new Map),J=y.useRef(null),xe=y.useRef(null),I=y.useRef(null),B=y.useRef(null),q=y.useMemo(()=>new Map((s?.nodes??[]).map(P=>[P.id,P.stableKey??null])),[s]),he=y.useMemo(()=>new Map((s?.definitions?.subgraphs??[]).map(P=>[P.id,P.stableKey??null])),[s]),me=()=>{j(""),C(!1)},Se=y.useMemo(()=>{const P=new Map,Ee=new Set,ne=new Set,ot=(tt,Xe)=>{tt.forEach(Ye=>{if(Ye.type==="node"){const te=q.get(Ye.id)??null;te&&P.set(te,{stableKey:te,type:"node",nodeId:Ye.id,subgraphId:Xe,text:String(Ye.id)});return}if(Ye.type==="group"){const te=Ye.stableKey;if(te&&P.set(te,{stableKey:te,type:"group",groupId:Ye.id,subgraphId:Xe,groupKey:Ye.stableKey,text:`G${Ye.id}`}),Ee.has(Ye.stableKey))return;Ee.add(Ye.stableKey),ot(ue.groups[Ye.stableKey]??[],Xe);return}if(Ye.type==="subgraph"){const te=he.get(Ye.id)??null;if(te&&P.set(te,{stableKey:te,type:"subgraph",subgraphId:Ye.id,text:"SG"}),ne.has(Ye.id))return;ne.add(Ye.id),ot(ue.subgraphs[Ye.id]??[],Ye.id)}})};return ot(ue.root,null),P},[ue,q,he]),F=y.useMemo(()=>de.map(P=>Se.get(P)).filter(P=>P!=null),[Se,de]),ie=y.useCallback(P=>{const Ee=lb(ue,({ref:ne})=>ne.type==="node"?(q.get(ne.id)??null)===P:ne.type==="group"?ne.stableKey===P:ne.type==="subgraph"?(he.get(ne.id)??null)===P:!1);return Ee?{groupKeys:Ee.groupKeys,subgraphIds:Ee.subgraphIds}:null},[ue,q,he]),Ae=y.useCallback((P,Ee,ne)=>{x(P),b(P,ne),window.dispatchEvent(new CustomEvent("workflow-scroll-to-node",{detail:{nodeId:Ee,label:ne}}))},[x,b]),Ue=y.useCallback((P,Ee,ne,ot)=>{const tt=ie(P);if(tt){for(const We of tt.subgraphIds){const nt=he.get(We)??null;nt&&(z(nt,!1),g(nt,!1))}for(const We of tt.groupKeys){const nt=fe[We];nt&&(z(nt,!1),g(nt,!1))}}if(ot){const We=he.get(ot)??null;We&&(z(We,!1),g(We,!1))}z(P,!1),g(P,!1);const Ye=`[data-group-id="${ne}"][data-subgraph-id="${ot??"root"}"]`,te=`[data-reposition-item="group-${Ee}"]`;requestAnimationFrame(()=>{requestAnimationFrame(()=>{const We=document.querySelector(Ye),nt=document.querySelector(te);(We??nt)?.scrollIntoView({behavior:"smooth",block:"start"})})})},[ie,g,z,fe,he]),Je=y.useCallback((P,Ee)=>{const ne=ie(P);if(ne){for(const Xe of ne.subgraphIds){const Ye=he.get(Xe)??null;Ye&&(z(Ye,!1),g(Ye,!1))}for(const Xe of ne.groupKeys){const Ye=fe[Xe];Ye&&(z(Ye,!1),g(Ye,!1))}}z(P,!1),g(P,!1);const ot=`[data-subgraph-header-id="${Ee}"]`,tt=`[data-reposition-item="subgraph-${Ee}"]`;requestAnimationFrame(()=>{requestAnimationFrame(()=>{const Xe=document.querySelector(ot),Ye=document.querySelector(tt);(Xe??Ye)?.scrollIntoView({behavior:"smooth",block:"start"})})})},[ie,g,z,fe,he]),Pe=y.useCallback((P,Ee)=>()=>{if(Le){E(!1),M(!1),Te(null);return}Ke(Ee),P.type==="node"?Ae(P.stableKey,P.nodeId):P.type==="group"?Ue(P.stableKey,P.groupKey,P.groupId,P.subgraphId):Je(P.stableKey,P.subgraphId)},[Le,Ue,Ae,Je]),st=y.useCallback(()=>{if(Le){E(!1),M(!1),Te(null);return}const P=(ce+1)%F.length;Ke(P);const Ee=F[P];Ee&&(Ee.type==="node"?Ae(Ee.stableKey,Ee.nodeId):Ee.type==="group"?Ue(Ee.stableKey,Ee.groupKey,Ee.groupId,Ee.subgraphId):Je(Ee.stableKey,Ee.subgraphId))},[F,ce,Le,Ue,Ae,Je]),$e=y.useCallback(()=>{J.current!=null&&(window.clearTimeout(J.current),J.current=null)},[]),Fe=y.useCallback(()=>{const P=getComputedStyle(document.documentElement).getPropertyValue("--bottom-bar-offset"),Ee=Number.parseFloat(P);return Number.isFinite(Ee)?Ee:0},[]),at=y.useCallback(()=>{const P=je.current,Ee=Me.current;if(!P||!Ee)return null;const ne=P.getBoundingClientRect().height,ot=Ee.getBoundingClientRect().height,tt=16,Xe=Fe()+8,Ye=Math.max(tt,ne-ot-Xe);return{minTop:tt,maxTop:Ye}},[Fe]),ht=y.useCallback(P=>{const Ee=at();return Ee?Math.min(Math.max(P,Ee.minTop),Ee.maxTop):P},[at]),Lt=y.useCallback((P,Ee)=>{const ne=je.current,ot=I.current;if(!ne||!ot)return;const tt=ne.getBoundingClientRect(),Xe=P-tt.left-ot.x,Ye=ht(Ee-tt.top-ot.y);Te({x:Xe,y:Ye})},[ht]),Gt=y.useCallback((P,Ee)=>{const ne=je.current,ot=Me.current;if(!ne||!ot)return;const tt=ot.getBoundingClientRect(),Xe=ne.getBoundingClientRect();I.current={x:P-tt.left,y:Ee-tt.top};const Ye=tt.left-Xe.left,te=ht(tt.top-Xe.top);Te({x:Ye,y:te}),M(!0)},[ht]),Pt=y.useCallback(P=>{P.pointerType==="mouse"&&P.button!==0||P.target.closest("button")&&!Le||(P.preventDefault(),xe.current={startX:P.clientX,startY:P.clientY,startTime:Date.now(),pointerId:P.pointerId},Le?Gt(P.clientX,P.clientY):J.current=window.setTimeout(()=>{E(!0),Gt(P.clientX,P.clientY)},500),P.currentTarget.setPointerCapture(P.pointerId))},[Le,Gt]),$t=y.useCallback(P=>{if(A){Lt(P.clientX,P.clientY);return}const Ee=xe.current;if(!Ee)return;const ne=P.clientX-Ee.startX,ot=P.clientY-Ee.startY;Math.hypot(ne,ot)>8&&$e()},[$e,A,Lt]),Ge=y.useCallback(()=>{const P=je.current,Ee=Me.current;if(!P||!Ee||!ee)return;const ne=P.getBoundingClientRect(),ot=Ee.getBoundingClientRect().width,Xe=ee.x+ot/2<ne.width/2?"left":"right",Ye=ht(ee.y);m({side:Xe,top:Ye}),Te(null)},[ee,ht,m]),He=y.useCallback(P=>{$e();const Ee=xe.current;if(xe.current=null,A){Ge(),M(!1);return}if(Le||!Ee)return;const ne=P.clientX-Ee.startX,ot=P.clientY-Ee.startY,tt=Date.now()-Ee.startTime;Math.abs(ne)>40&&Math.abs(ne)>Math.abs(ot)&&tt<500&&m({side:c==="left"?"right":"left"})},[c,$e,Ge,A,Le,m]),Ve=y.useCallback(()=>{$e(),xe.current=null,M(!1),Te(null)},[$e]),et=y.useMemo(()=>{if(!s)return[];const P=rb(ue),Ee=new Map(s.nodes.map(tt=>[tt.id,tt])),ne=[];for(const tt of P){const Xe=Ee.get(tt);Xe&&ne.push(Xe)}const ot=new Set(P);for(const tt of s.nodes)ot.has(tt.id)||ne.push(tt);return Object.keys(R).length===0?ne:ne.filter(tt=>{const Xe=tt.stableKey??null;return Xe?!R[Xe]:!0})},[s,R,ue]),ft=S.trim(),St=N&&ft.length>0,zt=y.useMemo(()=>{if(!St||!s)return new Set;const P=[...s.groups??[],...(s.definitions?.subgraphs??[]).flatMap(ne=>ne.groups??[])],Ee=new Set;for(const ne of P)bf(ft,ne.title)&&Ee.add(ne.id);return Ee},[s,St,ft]),le=y.useMemo(()=>{if(!St||!s)return new Set;const P=s.definitions?.subgraphs??[],Ee=new Set;for(const ne of P){const ot=ne.name||ne.id;bf(ft,`${ot} ${ne.id}`)&&Ee.add(ne.id)}return Ee},[s,St,ft]),se=y.useMemo(()=>St?et.filter(P=>{const Ee=w?.[P.type],ne=P.title,ot=[typeof ne=="string"?ne:"",Ee?.display_name??"",P.type,String(P.id)];return bf(ft,ot.join(" "))}):et,[et,St,ft,w]),De=y.useMemo(()=>new Set(se.map(P=>P.id)),[se]),Ze=y.useMemo(()=>s?oS(ue,s,U,R,fe):[],[ue,s,U,R,fe]),Qe=y.useMemo(()=>{if(!s)return[];if(St){const P=ne=>{let ot=0;for(const tt of ne)tt.type==="hiddenBlock"?ot+=tt.count:tt.type==="node"?ot+=1:ot+=P(tt.children);return ot},Ee=(ne,ot=!1)=>{const tt=[];for(const Xe of ne){if(Xe.type==="hiddenBlock")continue;if(Xe.type==="node"){(ot||De.has(Xe.node.id))&&tt.push(Xe);continue}if(ot){const We=Ee(Xe.children,!0);tt.push({...Xe,isCollapsed:!1,nodeCount:P(We),children:We});continue}if(Xe.type==="group"){const We=zt.has(Xe.group.id),nt=Ee(Xe.children,We);(We||nt.length>0)&&tt.push({...Xe,isCollapsed:!1,nodeCount:P(nt),children:nt});continue}const Ye=le.has(Xe.subgraph.id),te=Ee(Xe.children,!1);(Ye||te.length>0)&&tt.push({...Xe,isCollapsed:!1,nodeCount:P(te),children:te})}return tt};return Ee(Ze)}return Ze},[Ze,De,zt,le,St,s]),rt=y.useMemo(()=>{const P=new Map;let Ee=0;for(const ne of et){const ot=k[String(ne.id)];ot&&ot.length>0&&(Ee+=1,P.set(ne.id,Ee))}return P},[et,k]),Re=y.useMemo(()=>{if(!s)return new Set;const P=Object.entries(i).filter(([,Ye])=>Ye!=="off").map(([Ye,te])=>({id:Number(Ye),mode:te}));if(P.length===0)return new Set;const Ee=new Map(s.nodes.map(Ye=>[Ye.id,Ye])),ne=new Set,ot=Ye=>!!(Ye.stableKey&&R[Ye.stableKey]),tt=(Ye,te,We)=>{if(te.has(Ye))return[];te.add(Ye);const nt=Ee.get(Ye);if(!nt)return[];const ut=[];return nt.outputs?.forEach((_t,nn)=>{const Ln=lu(_t.type);if(We.size>0&&!Ln.some(An=>We.has(An)))return;pa(s,Ye,nn).forEach(An=>{const Sn=An.node;ot(Sn)?ut.push(...tt(Sn.id,te,We)):ut.push(Sn)})}),ut},Xe=(Ye,te,We)=>{if(te.has(Ye))return[];te.add(Ye);const nt=Ee.get(Ye);if(!nt)return[];const ut=[];return nt.inputs?.forEach((_t,nn)=>{if(_t.link===null)return;const Ln=lu(_t.type);if(We.size>0&&!Ln.some(An=>We.has(An)))return;const an=ll(s,Ye,nn);an&&(ot(an.node)?ut.push(...Xe(an.node.id,te,We)):ut.push(an.node))}),ut};return P.forEach(({id:Ye,mode:te})=>{const We=Ee.get(Ye);We&&((te==="inputs"||te==="both")&&We.inputs?.forEach((nt,ut)=>{if(nt.link===null)return;const _t=ll(s,We.id,ut);if(!_t)return;if(!ot(_t.node)){ne.add(_t.node.id);return}const nn=new Set(lu(nt.type));Xe(_t.node.id,new Set,nn).forEach(an=>ne.add(an.id))}),(te==="outputs"||te==="both")&&We.outputs?.forEach((nt,ut)=>{const _t=new Set(lu(nt.type));pa(s,We.id,ut).forEach(Ln=>{const an=Ln.node;if(!ot(an)){ne.add(an.id);return}tt(an.id,new Set,_t).forEach(Sn=>ne.add(Sn.id))})}))}),ne},[s,i,R]);y.useEffect(()=>{const P=Ee=>{const ne=Ee.detail,ot=typeof ne=="number"?ne:ne.nodeId,tt=typeof ne=="object"?ne.label:void 0;if(typeof ot!="number"||!se.some(ut=>ut.id===ot))return;const Ye=rt.get(ot),te=tt??(Ye?`Error #${Ye}`:"Error");be(ut=>({...ut,[ot]:te}));const We=ke.current.get(ot);We&&window.clearTimeout(We);const nt=window.setTimeout(()=>{be(ut=>{const _t={...ut};return delete _t[ot],_t}),ke.current.delete(ot)},2e3);ke.current.set(ot,nt)};return window.addEventListener("workflow-label-error-node",P),()=>window.removeEventListener("workflow-label-error-node",P)},[se,rt]),y.useEffect(()=>{const P=ke.current;return()=>{P.forEach(Ee=>window.clearTimeout(Ee)),P.clear()}},[]),y.useEffect(()=>{const P=Ee=>{const ne=Ee.detail,ot=typeof ne=="number"?ne:ne.nodeId,tt=typeof ne=="object"?ne.label:void 0;if(typeof ot!="number")return;const Ye=s?.nodes.find(We=>We.id===ot)?.stableKey??null;if(!Ye)return;g(Ye,!1);const te=(typeof Ye=="string"?document.querySelector(`[data-stable-key="${Ye}"]`):null)??document.querySelector(`[data-reposition-item="node-${ot}"]`);te&&te.scrollIntoView({behavior:"smooth",block:"start"}),requestAnimationFrame(()=>b(Ye,tt))};return window.addEventListener("workflow-scroll-to-node",P),()=>window.removeEventListener("workflow-scroll-to-node",P)},[g,b,s]),y.useEffect(()=>{N&&(_.current&&_.current.scrollTo({top:0,behavior:"auto"}),requestAnimationFrame(()=>{oe.current?.focus();const P=je.current,Ee=Me.current,ne=oe.current?.closest(".node-search-bar");if(!P||!Ee||!ne)return;const ot=P.getBoundingClientRect(),tt=ne.getBoundingClientRect(),Xe=Ee.getBoundingClientRect(),Ye=tt.bottom-ot.top,te=Xe.top-ot.top,We=8;te<Ye+We&&m({top:Ye+We})}))},[N,m]),y.useEffect(()=>(p(Le),()=>p(!1)),[Le,p]),y.useEffect(()=>{if(!F.length)return;const P=window.requestAnimationFrame(()=>{const Ee=at();if(!Ee)return;const{minTop:ne,maxTop:ot}=Ee;if(f==null)m({top:ot});else{const tt=Math.min(Math.max(f,ne),ot);tt!==f&&m({top:tt})}});return()=>window.cancelAnimationFrame(P)},[F.length,f,at,m]),y.useEffect(()=>{if(!Le)return;const P=Ee=>{const ne=Me.current;!ne||!Ee.target||ne.contains(Ee.target)||(E(!1),M(!1),Te(null),$e())};return document.addEventListener("pointerdown",P),()=>{document.removeEventListener("pointerdown",P)}},[$e,Le]),y.useEffect(()=>{if(!T||B.current===T.id)return;B.current=T.id;const P=window.requestAnimationFrame(()=>{H(T.groupId),D(T.subgraphId),ye(!0),V()});return()=>window.cancelAnimationFrame(P)},[T,V]);const gt=P=>{for(const Ee of P)if(Ee.type!=="hiddenBlock"){if(Ee.type==="node"){const ne=Ee.node.stableKey??null;if(!ne||!U[ne])return!0;continue}if(!Ee.isCollapsed||gt(Ee.children))return!0}return!1},bt=y.useCallback((P,Ee)=>{const ne=ot=>{for(const tt of ot){if(tt.type==="hiddenBlock")continue;if(tt.type==="node"){const Ye=tt.node.stableKey??null;Ye&&g(Ye,Ee);continue}if(tt.type==="group"){const Ye=tt.stableKey;if(!Ye){ne(tt.children);continue}g(Ye,Ee),ne(tt.children);continue}const Xe=he.get(tt.subgraph.id)??null;Xe&&g(Xe,Ee),ne(tt.children)}};ne(P)},[g,he]),it=y.useCallback(P=>_f(P,{layout:ue,hiddenItems:R,stableKeyByPointer:fe}),[R,ue,fe]),xt=y.useCallback(P=>it(ue.groups[P]??[]),[it,ue]),Nt=y.useCallback(P=>it(ue.subgraphs[P]??[]),[it,ue]),ct=y.useCallback(P=>{for(const Ee of P.hiddenGroupKeys){const ne=fe[Ee];ne&&z(ne,!1)}for(const Ee of P.hiddenSubgraphIds){const ne=he.get(Ee)??null;ne&&z(ne,!1)}for(const Ee of P.hiddenNodeKeys){const ne=fe[Ee];ne&&z(ne,!1)}},[z,fe,he]),jt=(P,Ee)=>P.map((ne,ot)=>{const tt=`${Ee}-${ot}`;if(ne.type==="hiddenBlock")return null;if(ne.type==="group"){const Xe=ne.group,Ye=Ro(Xe.color,.15),te=Ro(Xe.color,.4),We=gt(ne.children),nt=ne.children.some(Nn=>Nn.type!=="hiddenBlock"),ut=ne.stableKey;if(!ut)return null;const _t=xt(ut),nn=ut?de.includes(ut):!1,Ln=de.length<5||nn,an=_t.hiddenNodeCount,An=We?"Fold all":"Unfold all",Sn=()=>{!We&&ut&&g(ut,!1),bt(ne.children,We)};return u.jsxs("div",{className:"group-wrapper shadow-md rounded-xl border mb-3",style:{backgroundColor:Ye,borderColor:te},"data-reposition-item":`group-${ut}`,"data-stable-key":ut,children:[u.jsx(Hy,{containerType:"group",containerId:Xe.id,title:Xe.title?.trim()||`Group ${Xe.id}`,nodeCount:ne.nodeCount,isCollapsed:ne.isCollapsed,backgroundColor:Ro(Xe.color,.22),borderColor:Ro(Xe.color,.4),hiddenNodeCount:an,isBookmarked:nn,canShowBookmarkAction:Ln,foldAllLabel:An,onToggleCollapse:()=>ut&&g(ut,!ne.isCollapsed),onToggleBookmark:()=>ut?Ie(ut):void 0,onShowHiddenNodes:()=>{an>0&&ct(_t)},onToggleFoldAll:Sn,onBypassAll:Nn=>ut&&L(ut,Nn),onHide:()=>ut&&z(ut,!0),onAddNode:()=>{H(ne.group.id),D(ne.subgraphId??null),ye(!0)},onDelete:()=>{if(ut){if(ne.nodeCount===0){$(ut,{deleteNodes:!1});return}X({stableKey:ut,containerTypeLabel:"group",containerIdLabel:`#${ne.group.id}`,displayName:ne.group.title?.trim()||`Group ${ne.group.id}`,nodeCount:ne.nodeCount})}},onMove:()=>W.openOverlay({type:"group",id:ne.group.id,subgraphId:ne.subgraphId??null}),onCommitTitle:Nn=>ut&&Q(ut,Nn)}),u.jsx("div",{className:`grid transition-[grid-template-rows] duration-200 ease-out ${ne.isCollapsed?"grid-rows-[0fr]":"grid-rows-[1fr]"}`,children:u.jsxs("div",{className:`overflow-hidden px-1 transition-opacity duration-200 ease-out ${ne.isCollapsed?"opacity-0":"opacity-100"}`,children:[an>0&&ne.nodeCount>0&&u.jsxs("div",{className:"px-3 pb-2 -mt-1 text-xs text-gray-400 text-center",children:[an," hidden node",an===1?"":"s"]}),nt?jt(ne.children,tt):!St||zt.has(ne.group.id)?u.jsx(Vy,{containerType:"group",containerId:ne.group.id,hiddenNodeCount:an,borderColor:Ro(ne.group.color,.3),dashedBorderColor:Ro(ne.group.color,.4),onClick:()=>{H(ne.group.id),D(ne.subgraphId??null),ye(!0)}}):null,u.jsx(zy,{id:`group-footer-${ne.group.id}`,headerId:`group-header-${ne.group.id}`,title:ne.group.title,nodeCount:ne.nodeCount,backgroundColor:Ro(ne.group.color,.15),borderColor:Ro(ne.group.color,.3),textClassName:"text-gray-500 dark:text-gray-400",className:"group-footer"})]})})]},`group-${ne.group.id}-${tt}`)}if(ne.type==="subgraph"){const Xe=Tt.brand.subgraphBackground08,Ye=Tt.brand.subgraphBorder25,te=Nt(ne.subgraph.id),We=te.hiddenNodeCount,nt=he.get(ne.subgraph.id)??null,ut=nt?de.includes(nt):!1,_t=de.length<5||ut,nn=gt(ne.children),Ln=nn?"Fold all":"Unfold all",an=()=>{!nn&&nt&&g(nt,!1),bt(ne.children,nn)};return u.jsxs("div",{className:"subgraph-wrapper shadow-md rounded-xl border mb-3",style:{backgroundColor:`var(--subgraph-bg, ${Xe})`,borderColor:`var(--subgraph-border, ${Ye})`,"--subgraph-bg":Xe,"--subgraph-border":Ye},"data-reposition-item":`subgraph-${ne.subgraph.id}`,"data-stable-key":nt??void 0,children:[u.jsx(Hy,{containerType:"subgraph",containerId:ne.subgraph.id,title:(ne.subgraph.name||ne.subgraph.id).trim(),nodeCount:ne.nodeCount,isCollapsed:ne.isCollapsed,backgroundColor:Tt.brand.subgraphBackground14,borderColor:Tt.brand.subgraphBorder25,hiddenNodeCount:We,isBookmarked:ut,canShowBookmarkAction:_t,foldAllLabel:Ln,onToggleCollapse:()=>nt&&g(nt,!ne.isCollapsed),onToggleBookmark:()=>nt?Ie(nt):void 0,onBypassAll:An=>nt&&L(nt,An),onToggleFoldAll:an,onShowHiddenNodes:()=>{We>0&&ct(te)},onHide:()=>nt&&z(nt,!0),onDelete:()=>{if(nt){if(ne.nodeCount===0){$(nt,{deleteNodes:!1});return}X({stableKey:nt,containerTypeLabel:"subgraph",containerIdLabel:ne.subgraph.id,displayName:ne.subgraph.name?.trim()||ne.subgraph.id,nodeCount:ne.nodeCount})}},onAddNode:()=>{H(null),D(ne.subgraph.id),ye(!0)},onMove:()=>W.openOverlay({type:"subgraph",id:ne.subgraph.id}),onCommitTitle:An=>nt&&Q(nt,An)}),u.jsx("div",{className:`grid transition-[grid-template-rows] duration-200 ease-out ${ne.isCollapsed?"grid-rows-[0fr]":"grid-rows-[1fr]"}`,children:u.jsxs("div",{className:`overflow-hidden px-1 transition-opacity duration-200 ease-out ${ne.isCollapsed?"opacity-0":"opacity-100"}`,children:[We>0&&ne.nodeCount>0&&u.jsxs("div",{className:"px-3 pb-2 -mt-1 text-xs text-gray-400 text-center",children:[We," hidden node",We===1?"":"s"]}),ne.children.length>0?jt(ne.children,tt):!St||le.has(ne.subgraph.id)?u.jsx(Vy,{containerType:"subgraph",containerId:ne.subgraph.id,hiddenNodeCount:We,borderColor:Tt.brand.subgraphBorder20,dashedBorderColor:Tt.brand.subgraphBorder25,onClick:()=>{H(null),D(ne.subgraph.id),ye(!0)}}):null,u.jsx(zy,{id:`subgraph-footer-${ne.subgraph.id}`,headerId:`subgraph-header-${ne.subgraph.id}`,title:ne.subgraph.name||ne.subgraph.id,nodeCount:ne.nodeCount,backgroundColor:Tt.brand.subgraphBackground10,borderColor:Tt.brand.subgraphBorder20,textClassName:"text-blue-600 dark:text-blue-500",className:"subgraph-footer"})]})})]},`subgraph-${ne.subgraph.id}-${tt}`)}return u.jsx("div",{"data-reposition-item":`node-${ne.node.id}`,"data-stable-key":ne.node.stableKey??void 0,children:u.jsx(O4,{node:ne.node,isExecuting:l===String(ne.node.id),isConnectionHighlighted:Re.has(ne.node.id),errorBadgeLabel:Oe[ne.node.id]??null,onImageClick:o,onMoveNode:()=>W.openOverlay({type:"node",id:ne.node.id})})},`node-${ne.node.id}-${tt}`)});let pt;s?et.length===0?pt=u.jsx("div",{id:"node-list-empty",className:"flex items-center justify-center h-full text-gray-500",children:u.jsxs("div",{id:"empty-workflow-content",className:"text-center p-8",children:[u.jsx("div",{id:"empty-workflow-icon-container",className:"flex items-center justify-center mb-4",children:u.jsx(n2,{className:"w-10 h-10 text-gray-300"})}),u.jsx("p",{id:"empty-workflow-title",className:"text-lg font-medium",children:"Empty workflow"}),u.jsx("p",{id:"empty-workflow-description",className:"text-sm mt-2",children:"This workflow has no nodes"}),u.jsx("div",{className:"mt-6 w-64 max-w-full mx-auto",children:u.jsx(T4,{onClick:()=>{H(null),D(null),ye(!0)}})})]})}):pt=u.jsxs("div",{id:"node-list-shell",className:"h-full flex flex-col",children:[N&&u.jsx("div",{className:"node-search-bar bg-gray-100 px-4 py-2",children:u.jsx(ja,{inputRef:oe,value:S,onChange:j,onClear:me,placeholder:"Search nodes...",inputClassName:"comfy-input border-gray-300"})}),u.jsx("div",{id:"node-list-container",ref:_,className:"flex-1 overflow-auto px-4 pt-4 overscroll-contain scroll-container",style:{paddingBottom:"10rem"},"data-node-list":"true",children:Qe.length===0?u.jsx("div",{className:"flex items-center justify-center h-full text-gray-500",children:u.jsxs("div",{className:"text-center p-8",children:[u.jsx("p",{className:"text-sm font-medium",children:"No matching nodes"}),u.jsx("p",{className:"text-xs mt-2",children:"Try a different search."})]})}):u.jsx("div",{id:"node-list-inner",children:jt(Qe,"root")})})]}):pt=u.jsx("div",{id:"node-list-no-workflow",className:"flex items-center justify-center h-full text-gray-500",children:u.jsxs("div",{id:"no-workflow-content",className:"text-center p-8",children:[u.jsx("div",{id:"no-workflow-icon-container",className:"flex items-center justify-center mb-4",children:u.jsx(e2,{className:"w-10 h-10 text-gray-300"})}),u.jsx("p",{id:"no-workflow-title",className:"text-lg font-medium",children:"No workflow loaded"}),u.jsx("p",{id:"no-workflow-description",className:"text-sm mt-2",children:"Open the menu to load a workflow"})]})});const At=ee?.y??f??0,tn=ee?`${ee.x}px`:c==="left"?"0.75rem":void 0,In=ee?void 0:c==="right"?"0.75rem":void 0,cn={top:`${At}px`,left:tn,right:In,opacity:f==null&&ee==null?0:1,touchAction:Le?"none":"pan-y",pointerEvents:f==null&&ee==null?"none":"auto"};return u.jsxs("div",{id:"node-list-wrapper",ref:je,className:"absolute inset-x-0 top-[69px] bottom-0 bg-gray-100",style:{display:n?"block":"none"},children:[pt,u.jsx(E4,{isOpen:qe,addInGroupId:Ne,addInSubgraphId:Y,onClose:()=>{ye(!1),H(null),D(null)}}),K&&u.jsx(I4,{containerTypeLabel:K.containerTypeLabel,containerIdLabel:K.containerIdLabel,displayName:K.displayName,nodeCount:K.nodeCount,onCancel:()=>X(null),onDeleteContainerOnly:()=>{$(K.stableKey,{deleteNodes:!1}),X(null)},onDeleteContainerAndNodes:()=>{$(K.stableKey,{deleteNodes:!0}),X(null)}}),W.overlayOpen&&W.initialTarget&&u.jsx(yS,{mobileLayout:ue,initialTarget:W.initialTarget,initialViewportAnchor:W.initialViewportAnchor,onDone:W.commitAndClose,onCancel:W.cancelOverlay}),F.length>0&&u.jsx("div",{ref:Me,className:`absolute z-[200] flex flex-col items-center gap-2 pointer-events-auto ${Le?"rounded-2xl ring-2 ring-blue-400/70 bg-white/30 shadow-lg":""}`,style:cn,onPointerDown:Pt,onPointerMove:$t,onPointerUp:He,onPointerCancel:Ve,children:u.jsxs("div",{className:`flex flex-col items-center gap-2 ${Le?"p-2 cursor-grab":""}`,children:[F.map((P,Ee)=>u.jsx("button",{type:"button",className:"w-10 h-10 rounded-full border border-transparent bg-gray-900/10 text-[11px] font-bold text-gray-800 shadow-sm backdrop-blur-sm dark:bg-white/10 dark:text-gray-100 select-none",onClick:Pe(P,Ee),children:P.text},P.stableKey)),F.length>1&&u.jsx("button",{type:"button",className:"w-10 h-10 rounded-full border border-transparent bg-gray-900/10 text-gray-600 shadow-sm backdrop-blur-sm flex items-center justify-center dark:bg-white/10 dark:text-gray-200 select-none","aria-label":"Cycle bookmarks",onClick:st,children:u.jsx(to,{className:"w-4 h-4"})})]})})]})}function R4(){const n=no(M=>M.currentPanel),o=Mo(M=>M.viewerOpen),s=ae(M=>M.workflow),l=ae(M=>M.isExecuting),i=ae(M=>M.progress),c=ae(M=>M.executingNodeId),f=ae(M=>M.executingPromptId),m=ae(M=>M.workflowDurationStats),p=dn(M=>M.error),g=dn(M=>M.nodeErrors),b=dn(M=>M.errorsDismissed),x=dn(M=>M.setErrorsDismissed),w=ae(M=>M.scrollToNode),k=dn(M=>M.errorCycleIndex),N=dn(M=>M.setErrorCycleIndex),S=ae(M=>M.revealNodeWithParents),j=ae(M=>M.nodeTypes),C=It(M=>M.running),[T,V]=y.useState(null),z=!(n==="queue")&&!(n==="outputs")&&!o,L=Object.values(g).reduce((M,ee)=>M+ee.length,0),$=L>0,Q=!!p?.startsWith("Workflow load error")||$,ue=Q?"Workflow load error":"Prompt error",fe=Q&&p?p.replace(/^Workflow load error:\s*/i,""):p??($?`${L} inputs reference missing options.`:null),de=(!!p||$)&&!b,Ie=y.useMemo(()=>{if(!s||!c)return null;const M=s.nodes.find(Te=>String(Te.id)===c);return M?j?.[M.type]?.display_name||M.type:`Node ${c}`},[s,c,j]),je=f||(C[0]?.prompt_id??null),Me=Ma({workflow:s,runKey:je,isRunning:l||C.length>0,workflowDurationStats:m}),_=Me===100?100:i,oe=()=>{if(!s||!$)return;const M=s.nodes.filter(H=>g[String(H.id)]?.length);if(M.length===0)return;const ee=k%M.length,Te=M[ee];if(!Te)return;const qe=Te.id,ye=Te.stableKey;if(!ye)return;const Ne=`Error #${ee+1}`;S(ye),N((ee+1)%M.length),window.dispatchEvent(new CustomEvent("workflow-label-error-node",{detail:{nodeId:qe,label:Ne}})),window.dispatchEvent(new CustomEvent("workflow-scroll-to-node",{detail:{nodeId:qe,label:Ne}})),w(ye,Ne)},ce=M=>{(M.key==="Enter"||M.key===" ")&&(M.preventDefault(),oe())},Ke=M=>{M.stopPropagation()},Le=M=>{M.stopPropagation(),x(!0)},E=()=>{je&&V(je)},A=T!==null&&T===je;return z?u.jsxs("div",{id:"bottom-status-overlay",className:"fixed inset-x-0 bottom-20 z-[2000] flex flex-col items-center gap-3 pointer-events-none",children:[de&&u.jsxs("div",{id:"error-notification-wrapper",className:"relative pointer-events-auto",children:[u.jsx("div",{id:"error-notification-toast",className:"bg-red-100 text-red-900 rounded-xl shadow-lg px-4 py-3 w-[70vw] max-w-sm",role:"button",tabIndex:0,onClick:oe,onKeyDown:ce,children:u.jsx("div",{className:"error-toast-content flex items-start justify-between gap-3",children:u.jsxs("div",{className:"error-text-container pr-16",children:[u.jsx("div",{className:"error-title text-sm font-semibold text-red-800",children:ue}),u.jsx("div",{className:"error-message mt-1 text-xs text-red-800 break-words",children:fe})]})})}),u.jsx("button",{id:"error-dismiss-button",type:"button","aria-label":"Dismiss error",className:"absolute top-3 right-3 shrink-0 px-3 py-1 text-xs font-semibold bg-red-700 text-white rounded-full z-10",onPointerDown:Ke,onClick:Le,children:"Dismiss"})]}),Me!==null&&!A&&u.jsxs("div",{id:"execution-progress-card",className:"relative bg-white border border-gray-200 rounded-xl shadow-lg px-4 py-2 w-[70vw] max-w-sm pointer-events-auto",children:[u.jsx("button",{type:"button","aria-label":"Dismiss progress",className:"absolute top-2 right-2 w-7 h-7 rounded-full flex items-center justify-center text-gray-400 hover:text-gray-600",onClick:E,children:u.jsx(Na,{className:"w-4 h-4"})}),u.jsx("div",{className:"executing-node-name text-sm font-semibold text-gray-900",children:Ie||"Running"}),u.jsxs("div",{className:"node-progress-info mt-2 flex items-center justify-between text-xs text-gray-500",children:[u.jsx("span",{children:"Progress"}),u.jsxs("span",{children:[_,"%"]})]}),u.jsx("div",{className:"node-progress-track mt-1 h-2 rounded-full bg-gray-200 overflow-hidden",children:u.jsx("div",{className:"node-progress-bar h-full bg-green-500 transition-none",style:{width:`${Math.min(100,Math.max(0,_))}%`}})}),Me!==null&&u.jsxs("div",{className:"overall-progress-container",children:[u.jsxs("div",{className:"overall-progress-info mt-3 flex items-center justify-between text-xs text-gray-500",children:[u.jsx("span",{children:"Overall"}),u.jsxs("span",{children:[Me,"%"]})]}),u.jsx("div",{className:"overall-progress-track mt-1 h-2 rounded-full bg-gray-200 overflow-hidden",children:u.jsx("div",{className:"overall-progress-bar h-full bg-blue-500 transition-none",style:{width:`${Math.min(100,Math.max(0,Me))}%`}})})]})]})]}):null}function _4({viewerOpen:n,followQueue:o,queueSize:s,overallProgress:l,onToggleFollowQueue:i,onOpenFollowQueue:c}){const f=y.useCallback(()=>{n?i?.():c?.()},[n,i,c]),m=y.useMemo(()=>n?o?"Disable follow queue":"Enable follow queue":"Open image viewer",[n,o]),p=y.useMemo(()=>n&&o?"bg-green-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200",[n,o]);return u.jsxs("button",{onClick:f,className:`relative w-12 h-12 rounded-xl flex items-center justify-center text-2xl transition-colors ${p}`,"aria-label":m,children:[u.jsx("span",{className:"absolute inset-0 flex items-center justify-center",children:u.jsx(db,{className:"w-6 h-6",showSlash:n&&!o})}),s>0&&u.jsxs("div",{className:`queue-badge absolute top-0 right-0 translate-x-[18px] -translate-y-[18px] w-6 h-6 rounded-full bg-blue-500 text-white
                     flex items-center justify-center font-bold text-xs border-2 border-white relative z-20`,children:[l!==null&&u.jsx(p2,{className:"absolute z-10 pointer-events-none",width:"24",height:"24",style:{top:"50%",left:"50%",transform:"translate(-50%, -50%) rotate(-90deg)"},progress:l}),s]})]})}function D4(){const n=ae(p=>p.workflow),o=ho(p=>p.pinnedWidget),s=ho(p=>p.pinOverlayOpen),l=ho(p=>p.togglePinOverlay),i=ae(p=>p.updateNodeWidget),c=y.useMemo(()=>{if(!o||!n)return;const p=n.nodes.find(g=>g.id===o.nodeId);if(p)return da(p,o.widgetName,o.widgetIndex)},[o,n]);if(!s||!o)return null;const m=n?.nodes.find(p=>p.id===o.nodeId)?.stableKey??null;return u.jsx("div",{id:"pin-overlay-hidden-anchor",className:"hidden",children:u.jsx(_o,{name:o.widgetName,type:o.widgetType,value:c,options:o.options,onChange:p=>m?i(m,o.widgetIndex,p,o.widgetName):void 0,hideLabel:!0,compact:!0,forceModalOpen:!0,onModalClose:l})})}function B4(){const n=Wt(o=>o.setFilterModalOpen);return u.jsx("button",{onClick:()=>n(!0),className:"relative w-12 h-12 rounded-xl flex items-center justify-center text-2xl transition-colors bg-gray-100 text-gray-700 hover:bg-gray-200","aria-label":"Filter and sort",children:u.jsx(Jw,{className:"w-6 h-6"})})}function z4(){const n=Wt(l=>l.selectedIds.length),o=Wt(l=>l.setSelectionActionOpen),s=n===0;return u.jsx("button",{onClick:()=>o(!0),disabled:s,className:`relative w-12 h-12 rounded-xl flex items-center justify-center text-2xl transition-colors ${s?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,"aria-label":"Selection actions",children:u.jsx("div",{className:`w-6 h-6 rounded-full border-2 flex items-center justify-center shadow-sm ${s?"border-gray-300 bg-transparent":"bg-blue-600 border-blue-600 text-white"}`,children:!s&&u.jsx(Do,{className:"w-4 h-4"})})})}function H4(){return Wt(o=>o.selectionMode)?u.jsx(z4,{}):u.jsx(B4,{})}function V4(){const n=ho(l=>l.pinnedWidget),o=ho(l=>l.pinOverlayOpen),s=ho(l=>l.togglePinOverlay);return n?u.jsx("button",{onClick:s,className:`relative w-12 h-12 rounded-xl flex items-center justify-center text-2xl transition-colors ${o?"bg-fuchsia-500 text-white":"bg-gray-100 text-fuchsia-500 hover:bg-gray-200"}`,"aria-label":o?"Close pin editor":"Open pin editor",children:u.jsx(ya,{className:"w-6 h-6"})}):null}function K4(){const n=ae(c=>c.workflow),o=ae(c=>c.runCount),s=ae(c=>c.queueWorkflow),l=n!==null,i=()=>{l&&(s(o),"vibrate"in navigator&&navigator.vibrate(20))};return u.jsx("button",{onClick:i,disabled:!l,className:"flex-1 py-3 px-6 rounded-xl font-semibold text-lg min-h-[48px] transition-all "+(l?"bg-blue-500 text-white active:bg-blue-600":"bg-gray-300 text-gray-500 cursor-not-allowed"),children:"Run"})}function U4(){const n=ae(i=>i.runCount),o=ae(i=>i.setRunCount),s=()=>{o(n-1)},l=()=>{o(n+1)};return u.jsxs("div",{id:"run-count-selector",className:"flex items-center gap-1 bg-gray-100 rounded-lg p-1",children:[u.jsx("button",{onClick:s,disabled:n<=1,className:`w-10 h-10 rounded-lg bg-white shadow-sm flex items-center justify-center
                   text-lg font-medium text-gray-700 disabled:opacity-40 disabled:shadow-none`,children:""}),u.jsx("span",{className:"w-8 text-center font-semibold text-gray-900",children:n}),u.jsx("button",{onClick:l,className:`w-10 h-10 rounded-lg bg-white shadow-sm flex items-center justify-center
                   text-lg font-medium text-gray-700`,children:"+"})]})}function $4(n){const{currentPanel:o,viewerOpen:s=!1,followQueue:l=!1,onToggleFollowQueue:i,onOpenFollowQueue:c}=n,f=o==="outputs",m=ae(C=>C.workflow),p=ae(C=>C.isExecuting),g=ae(C=>C.executingPromptId),b=ae(C=>C.workflowDurationStats),x=It(C=>C.pending),w=It(C=>C.running),k=y.useRef(null),N=x.length+w.length,S=g||(w[0]?.prompt_id??null),j=Ma({workflow:m,runKey:S,isRunning:p||w.length>0,workflowDurationStats:b});return y.useEffect(()=>{const C=k.current;if(!C)return;const T=()=>{const V=C.getBoundingClientRect();document.documentElement.style.setProperty("--bottom-bar-offset",`${V.height}px`)};return T(),window.addEventListener("resize",T),()=>window.removeEventListener("resize",T)},[]),u.jsxs("div",{id:"bottom-bar-root",ref:k,className:"fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 shadow-lg safe-area-bottom z-[2200]",children:[u.jsxs("div",{id:"bottom-bar-content",className:"flex items-center gap-3 px-3 py-2 max-w-lg mx-auto",children:[u.jsx(U4,{}),u.jsx(K4,{}),f&&u.jsx(H4,{}),!f&&u.jsx(V4,{}),u.jsx(_4,{viewerOpen:s,followQueue:l,queueSize:N,overallProgress:j,onToggleFollowQueue:i,onOpenFollowQueue:c})]}),u.jsx(D4,{}),u.jsx(R4,{})]})}const Uy=n=>Symbol.iterator in n,$y=n=>"entries"in n,Fy=(n,o)=>{const s=n instanceof Map?n:new Map(n.entries()),l=o instanceof Map?o:new Map(o.entries());if(s.size!==l.size)return!1;for(const[i,c]of s)if(!l.has(i)||!Object.is(c,l.get(i)))return!1;return!0},F4=(n,o)=>{const s=n[Symbol.iterator](),l=o[Symbol.iterator]();let i=s.next(),c=l.next();for(;!i.done&&!c.done;){if(!Object.is(i.value,c.value))return!1;i=s.next(),c=l.next()}return!!i.done&&!!c.done};function q4(n,o){return Object.is(n,o)?!0:typeof n!="object"||n===null||typeof o!="object"||o===null||Object.getPrototypeOf(n)!==Object.getPrototypeOf(o)?!1:Uy(n)&&Uy(o)?$y(n)&&$y(o)?Fy(n,o):F4(n,o):Fy({entries:()=>Object.entries(n)},{entries:()=>Object.entries(o)})}function W4(n){const o=tl.useRef(void 0);return s=>{const l=n(s);return q4(o.current,l)?o.current:o.current=l}}function xf(n){return!!n&&typeof n=="object"&&!Array.isArray(n)}function mx(n){return Array.isArray(n)&&n.length>=2&&(typeof n[0]=="string"||typeof n[0]=="number")&&typeof n[1]=="number"}function Ku(n){return n.class_type??n.type??null}function Op(n,o){for(const s of o){const l=n.inputs?.[s];if(!mx(l)&&l!==void 0)return l}}function ol(n,o){const s=Op(n,o);if(s!=null)return typeof s=="string"?s:String(s)}function vf(n,o){if(!mx(o))return null;const s=String(o[0]);return n[s]??null}function G4(n){if(!n)return;const o=ol(n,["sampler_name","sampler","name"]);if(o)return o;if(Ku(n)==="KSamplerSelect"&&Array.isArray(n.widgets_values)){const l=n.widgets_values[0];return l==null?void 0:String(l)}}function P4(n){if(!n)return;const o=ol(n,["scheduler","scheduler_name","name"]);if(o)return o;if(Ku(n)==="BasicScheduler"&&Array.isArray(n.widgets_values)){const l=n.widgets_values[0];return l==null?void 0:String(l)}}function Y4(n){if(!n)return;const o=Op(n,["steps","step_count"]);if(o!==void 0)return o;if(Ku(n)==="BasicScheduler"&&Array.isArray(n.widgets_values)){const l=n.widgets_values[1];return l??void 0}}function Q4(n){if(!n)return;const o=Op(n,["cfg","guidance","guidance_scale"]);if(o!==void 0)return o;if(Array.isArray(n.widgets_values)){const s=n.widgets_values[0];return s??void 0}}function Tp(n){const o={};if(!xf(n)&&!Array.isArray(n))return o;let s=null;if(Array.isArray(n)&&n.length>=3&&xf(n[2])?s=n[2]:xf(n)&&(s=n),!s)return o;const i=Object.entries(s).sort((c,f)=>Number(c[0])-Number(f[0])).map(([,c])=>c);for(const c of i){const f=Ku(c);if(f){if(f==="CheckpointLoaderSimple"||f==="CheckpointLoader"){const m=c.inputs?.ckpt_name;typeof m=="string"?o.model=m.replace(/\.(safetensors|ckpt|pt)$/i,""):m!=null&&(o.model=String(m).replace(/\.(safetensors|ckpt|pt)$/i,""))}if(f==="KSampler"||f==="KSamplerAdvanced"){if(o.steps===void 0&&c.inputs?.steps!==void 0&&(o.steps=c.inputs.steps),o.cfg===void 0&&c.inputs?.cfg!==void 0&&(o.cfg=c.inputs.cfg),o.sampler===void 0){const m=ol(c,["sampler_name"]);m&&(o.sampler=m)}if(o.scheduler===void 0){const m=ol(c,["scheduler"]);m&&(o.scheduler=m)}}if(f==="SamplerCustom"||f==="SamplerCustomAdvanced"){if(o.steps===void 0&&c.inputs?.steps!==void 0&&(o.steps=c.inputs.steps),o.cfg===void 0&&c.inputs?.cfg!==void 0&&(o.cfg=c.inputs.cfg),o.sampler===void 0){const m=ol(c,["sampler","sampler_name"]),p=vf(s,c.inputs?.sampler),g=m??G4(p);g&&(o.sampler=g)}if(o.scheduler===void 0){const m=ol(c,["scheduler","scheduler_name"]),p=vf(s,c.inputs?.sigmas??c.inputs?.scheduler),g=m??P4(p);g&&(o.scheduler=g)}if(o.steps===void 0){const m=vf(s,c.inputs?.sigmas??c.inputs?.scheduler),p=Y4(m);p!==void 0&&(o.steps=p)}}if(f==="FluxGuidance"&&o.cfg===void 0){const m=Q4(c);m!==void 0&&(o.cfg=m)}}}return o}function Ep(n,o={}){const{onlyOutput:s=!1,alt:l}=o,i=[];return n.forEach((c,f)=>{const m=c.outputs?.images??[],p=Tp(c.prompt),g=c.durationSeconds,b=c.success!==!1;m.forEach((x,w)=>{if(s&&x.type!=="output")return;const k=typeof l=="function"?l(w,f):l,N=x.subfolder?`${x.subfolder}/${x.filename}`:x.filename,S=Oa(x.filename),j=S==="video"?"video":"image";i.push({src:mo(x.filename,x.subfolder,x.type),alt:k,mediaType:S,metadata:p,durationSeconds:g,success:b,filename:x.filename,file:{id:`${x.type}/${N}`,name:x.filename,type:j,fullUrl:mo(x.filename,x.subfolder,x.type)}})})}),i}function X4({menuState:n,unifiedList:o,onClose:s,onLoadWorkflow:l,onCopyWorkflow:i,onDownload:c,onBatchDownload:f,onDeleteHistory:m,getBatchSources:p}){const g=n?.promptId??"",b=It(C=>C.queueItemHideImages[g]),x=It(C=>C.toggleQueueItemHideImages),w=()=>{n?.workflow&&n.promptId&&l(n.workflow,n.promptId),s()},k=()=>{i(n?.workflow),s()},N=async()=>{const C=n?.promptId?p(n.promptId,o):[];C.length>1?await f(C):n&&await c(n.imageSrc),s()},S=()=>{x(g),s()},j=()=>{n?.promptId&&m(n.promptId),s()};return n?.open?En.createPortal(u.jsx("div",{id:"queue-image-menu",className:"fixed z-[1200] w-44",style:{top:n.top,right:n.right},children:u.jsx(gr,{items:[{key:"load-workflow",label:"Load workflow",icon:u.jsx(bs,{className:"w-4 h-4"}),onClick:w,disabled:!n.workflow},{key:"copy-workflow",label:"Copy workflow",icon:u.jsx(u2,{className:"w-4 h-4"}),onClick:k,disabled:!n.workflow},{key:"download",label:n.promptId&&p(n.promptId,o).length>1?"Download batch":"Download",icon:u.jsx(c2,{className:"w-4 h-4"}),onClick:N},{key:"toggle-images",label:b?"Show images":"Hide images",icon:b?u.jsx(pr,{className:"w-4 h-4"}):u.jsx(Go,{className:"w-4 h-4"}),onClick:S,hidden:!(n.hasVideoOutputs&&n.hasImageOutputs&&n.promptId)},{key:"delete",label:"Delete",icon:u.jsx(Bo,{className:"w-4 h-4"}),onClick:j,color:"danger"}]})}),document.body):null}function Z4({message:n}){return n?En.createPortal(u.jsx("div",{className:"fixed top-20 left-1/2 -translate-x-1/2 z-[1300] bg-gray-800 text-white px-4 py-2 rounded-lg shadow-lg text-sm font-medium animate-in fade-in slide-in-from-top-2 duration-200",children:n}),document.body):null}function gx(n){return"outputs"in n}function J4(n,o){const s=o.find(i=>i.id===n);return!s||s.status!=="done"?[]:gx(s.data)?(s.data.outputs.images??[]).filter(i=>i.type==="output").map(i=>mo(i.filename,i.subfolder,i.type)):[]}async function yx(n,o="image.png",s){try{const i=await(await fetch(n)).blob(),c=URL.createObjectURL(i),f=document.createElement("a");f.href=c,f.download=o,document.body.appendChild(f),f.click(),f.remove(),URL.revokeObjectURL(c),s?.(n)}catch(l){console.error("Failed to download image:",l)}}async function ek(n,o){for(const s of n)await yx(s,"image.png",o)}async function tk(n){try{if(navigator.clipboard?.writeText)await navigator.clipboard.writeText(n);else{const o=document.createElement("textarea");o.value=n,o.style.position="fixed",o.style.opacity="0",document.body.appendChild(o),o.select(),document.execCommand("copy"),document.body.removeChild(o)}return!0}catch(o){return console.error("Failed to copy to clipboard:",o),!1}}function nk({item:n,isActuallyRunning:o,progress:s,overallProgress:l,executingNodeLabel:i,onDelete:c,onStop:f,onImageClick:m,viewerImages:p,runningImages:g,onOpenMenu:b,downloaded:x,isTopDoneItem:w}){const k=It(J=>J.previewVisibility),N=It(J=>J.previewVisibilityDefault),S=It(J=>J.showQueueMetadata),j=It(J=>J.queueItemExpanded[n.id]),C=It(J=>J.setQueueItemExpanded),T=It(J=>J.queueItemHideImages[n.id]),V=y.useRef(new Map),U=y.useRef(new Set),[R,z]=y.useState(new Set),L=n.status==="pending"&&!o,$=n.status==="running"||o,Q=n.status==="done",ue=j!==void 0,fe=ue?j:!1,de=y.useRef(Q);y.useEffect(()=>{ue||C(n.id,!1)},[ue,n.id,C]),y.useEffect(()=>{!de.current&&Q&&C(n.id,!0),de.current=Q},[Q,n.id,C]),y.useEffect(()=>{U.current.clear(),z(new Set)},[n.id]);const Ie=()=>{C(n.id,!fe)},je=Q&&gx(n.data)?n.data:null,Me=y.useMemo(()=>je?je.outputs.images:$?g:[],[je,$,g]),_=!!(n.data.prompt_id?k[n.data.prompt_id]??N:N),{savedImages:oe,displayImages:ce}=y.useMemo(()=>{const J=Me.filter(B=>B.type==="output"),xe=Me.filter(B=>B.type!=="output"),I=_||J.length===0&&xe.length>0;return{savedImages:J,displayImages:I?[...J,...xe]:J}},[_,Me]),Ke=y.useMemo(()=>Me.some(J=>el(J.filename)),[Me]),Le=y.useMemo(()=>Me.some(J=>!el(J.filename)),[Me]),E=y.useMemo(()=>!T||!Ke?ce:ce.filter(J=>el(J.filename)),[ce,Ke,T]),A=oe.map(J=>({src:mo(J.filename,J.subfolder,J.type),alt:"Generation"})),M="aspect-square w-full bg-gray-100 flex flex-col items-center justify-center text-gray-400",ee=je?.durationSeconds,Te=je?je.success!==!1:!0,qe=ok(ee),ye=l===100?100:s,Ne=y.useMemo(()=>!S||!n.data.prompt?null:Tp(n.data.prompt),[S,n.data.prompt]),H=y.useMemo(()=>$?E.map(J=>({src:mo(J.filename,J.subfolder,J.type),alt:"Generation",mediaType:Oa(J.filename)})):p,[$,p,E]);y.useEffect(()=>{fe&&E.forEach(J=>{if(!el(J.filename))return;const xe=mo(J.filename,J.subfolder,J.type);if(U.current.has(xe))return;U.current.add(xe);const I=V.current.get(xe);if(!I)return;I.currentTime=0,z(q=>{const he=new Set(q);return he.delete(xe),he});const B=I.play();B&&typeof B.catch=="function"&&B.catch(()=>{})})},[fe,E]);const Y=J=>{J.stopPropagation(),Ie()},D=J=>{J.stopPropagation(),f()},K=J=>{J.stopPropagation(),c()},X=J=>{J.stopPropagation();const xe=J.currentTarget.getBoundingClientRect(),I=Math.max(8,window.innerWidth-xe.right),B=A[0]?.src||"";b({top:xe.bottom+6,right:I,imageSrc:B,workflow:je?.workflow,promptId:n.data.prompt_id||n.id,hasVideoOutputs:Ke,hasImageOutputs:Le})},W=J=>()=>{z(xe=>new Set(xe).add(J))},Oe=J=>()=>{z(xe=>{const I=new Set(xe);return I.delete(J),I})},be=(J,xe,I)=>()=>{const B=H.findIndex(q=>q.src===J);m?.(H,B>=0?B:xe,I)},ke=J=>xe=>{xe.stopPropagation();const I=V.current.get(J);if(!I)return;I.currentTime=0;const B=I.play();B&&typeof B.catch=="function"&&B.catch(()=>{})};return u.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden transition-all duration-300",children:[u.jsxs("div",{onClick:Ie,className:`px-3 py-2 border-b flex justify-between items-center cursor-pointer select-none ${$?"bg-blue-50 border-blue-100":"bg-gray-50 border-gray-100"}`,children:[u.jsxs("div",{className:"flex items-center gap-1 min-w-0",children:[u.jsx("button",{onClick:Y,className:"w-8 h-8 -ml-2 flex items-center justify-center text-gray-400 hover:text-gray-600 shrink-0",children:fe?u.jsx(to,{className:"w-6 h-6"}):u.jsx(gs,{className:"w-6 h-6"})}),$&&u.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"}),L&&u.jsx("span",{className:"text-xs font-bold text-gray-400",children:"PENDING"}),$&&u.jsx("span",{className:"text-xs font-bold text-blue-600",children:"GENERATING"}),Q&&u.jsx("span",{className:"text-xs font-bold text-gray-500",children:new Date(n.timestamp||0).toLocaleTimeString()}),$&&!fe&&o&&l!=null&&u.jsxs("span",{className:"ml-1 text-xs font-semibold text-blue-600",children:[Math.min(100,Math.max(0,l)),"%"]})]}),u.jsx("div",{className:"flex items-center gap-2",children:$?u.jsx("button",{onClick:D,className:"px-2 py-1 text-xs font-semibold text-white bg-red-600 rounded hover:bg-red-700",children:"Stop"}):Q?u.jsx(Pr,{onClick:X,ariaLabel:"Image options",buttonSize:7,iconSize:4}):u.jsx("button",{onClick:K,className:"text-gray-400 hover:text-red-500 px-2",title:L?"Remove from Queue":"Delete from History","aria-label":L?"Remove from Queue":"Delete from History",children:u.jsx(Na,{className:"w-4 h-4"})})})]}),fe&&u.jsx("div",{className:"relative w-full animate-in fade-in duration-200",children:E.length>0?u.jsx("div",{className:"flex flex-col",children:(()=>{let J=0,xe=0;return E.map((I,B)=>{const q=I.type!=="output",he=q?++xe:++J,me=`${q?"Preview":"Save"} #${he}`,Se=mo(I.filename,I.subfolder,I.type),F=x[Se],ie=E.length>1;return u.jsxs("div",{className:"relative",children:[qe&&u.jsxs("div",{className:`absolute top-2 left-2 flex items-center gap-1 px-2 py-1 rounded text-xs font-semibold ${Te?"bg-green-600/90 text-white":"bg-red-600/90 text-white"}`,children:[Te?u.jsx(Do,{className:"w-3.5 h-3.5"}):u.jsx(s2,{className:"w-3.5 h-3.5"}),u.jsx("span",{children:qe})]}),el(I.filename)?u.jsxs(u.Fragment,{children:[u.jsx("video",{src:Se,className:"w-full h-auto block",muted:!0,playsInline:!0,preload:"metadata",ref:Ae=>{Ae?V.current.set(Se,Ae):V.current.delete(Se)},onEnded:W(Se),onPlay:Oe(Se),onClick:be(Se,B,w)}),R.has(Se)&&u.jsx("button",{type:"button",className:"absolute inset-0 flex items-center justify-center bg-black/35 text-white",onClick:ke(Se),"aria-label":"Replay video",children:u.jsx("span",{className:"flex h-12 w-12 items-center justify-center rounded-full bg-black/60 text-2xl",children:""})})]}):u.jsx("img",{src:Se,alt:"Generation",className:"w-full h-auto block",loading:"lazy",onClick:be(Se,B,w)}),F&&u.jsx("div",{className:"absolute bottom-2 right-2 w-7 h-7 rounded-full bg-black/60 text-white flex items-center justify-center",children:u.jsx(l2,{className:"w-4 h-4"})}),ie&&u.jsx("div",{className:"absolute bottom-2 left-2 px-2 py-1 bg-black/60 text-white text-xs font-medium rounded backdrop-blur-sm shadow-sm pointer-events-none",children:me}),Ne&&u.jsxs("div",{className:`absolute right-2 flex flex-col-reverse items-end gap-1 pointer-events-none ${F?"bottom-10":"bottom-2"}`,children:[Ne.model&&u.jsxs("div",{className:"px-1.5 py-0.5 bg-black/50 text-white text-[10px] rounded backdrop-blur-sm",children:["model: ",Ne.model]}),Ne.sampler&&u.jsxs("div",{className:"px-1.5 py-0.5 bg-black/50 text-white text-[10px] rounded backdrop-blur-sm",children:["sampler: ",Ne.sampler]}),Ne.steps&&u.jsxs("div",{className:"px-1.5 py-0.5 bg-black/50 text-white text-[10px] rounded backdrop-blur-sm",children:["steps: ",Ne.steps]}),Ne.cfg&&u.jsxs("div",{className:"px-1.5 py-0.5 bg-black/50 text-white text-[10px] rounded backdrop-blur-sm",children:["cfg: ",Ne.cfg]})]})]},B)})})()}):Q?u.jsx("div",{className:M,children:u.jsx("span",{className:"text-sm",children:"No images saved"})}):$?u.jsx("div",{className:M,style:{minHeight:"300px"},children:o&&l!=null?u.jsxs("div",{className:"w-full max-w-xs px-4",children:[u.jsxs("p",{className:"font-semibold text-base text-gray-900 mb-3",children:["Executing: ",i||"Running"]}),u.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 mb-1",children:[u.jsx("span",{children:"Progress"}),u.jsxs("span",{children:[ye,"%"]})]}),u.jsx("div",{className:"h-2 rounded-full bg-gray-200 overflow-hidden",children:u.jsx("div",{className:"h-full bg-green-500 transition-none",style:{width:`${Math.min(100,Math.max(0,ye))}%`}})}),u.jsxs("div",{className:"mt-3 flex items-center justify-between text-xs text-gray-500 mb-1",children:[u.jsx("span",{children:"Overall"}),u.jsxs("span",{children:[l,"%"]})]}),u.jsx("div",{className:"h-2 rounded-full bg-gray-200 overflow-hidden",children:u.jsx("div",{className:"h-full bg-blue-500 transition-none",style:{width:`${Math.min(100,Math.max(0,l))}%`}})})]}):u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"w-12 h-12 border-4 border-blue-200 border-t-blue-500 rounded-full animate-spin mb-4"}),u.jsx("p",{className:"font-medium text-lg text-blue-600",children:"Generating..."})]})}):u.jsxs("div",{className:M,style:{minHeight:"100px"},children:[u.jsx(k2,{className:"w-8 h-8 text-gray-300"}),u.jsx("span",{className:"text-xs mt-2 opacity-40",children:"Waiting to start..."})]})})]})}function ok(n){const o=n===void 0||Number.isNaN(n)?0:n;return o<10?`${o.toFixed(1)}s`:`${Math.round(o)}s`}function rk({listRef:n,unifiedList:o,visibleCount:s,hasLoadedOnce:l,effectiveExecutingId:i,progress:c,overallProgress:f,executingNodeLabel:m,onDeleteItem:p,onStop:g,onImageClick:b,viewerImages:x,promptOutputs:w,onOpenMenu:k,downloaded:N,firstDoneItemId:S,onScroll:j}){return u.jsxs("div",{ref:n,className:"flex-1 overflow-y-auto p-4 space-y-4 overscroll-contain scroll-container","data-queue-list":"true",onScroll:j,children:[o.length===0&&!l&&u.jsx("div",{className:"flex items-center justify-center min-h-[calc(100vh-180px)] text-gray-400",children:u.jsxs("div",{className:"text-center",children:[u.jsx(hp,{size:"lg",color:"gray",className:"mx-auto mb-4"}),u.jsx("p",{className:"text-lg",children:"Loading..."})]})}),o.length===0&&l&&u.jsx("div",{className:"flex items-center justify-center min-h-[calc(100vh-180px)] text-gray-500",children:u.jsxs("div",{className:"text-center p-8",children:[u.jsx("div",{className:"flex items-center justify-center mb-4",children:u.jsx(o2,{className:"w-10 h-10 text-gray-300"})}),u.jsx("p",{className:"text-lg font-medium",children:"Queue is empty"}),u.jsx("p",{className:"text-sm mt-2",children:"Run a workflow to see items here"})]})}),o.slice(0,s).map(C=>u.jsx(nk,{item:C,isActuallyRunning:C.id===i,progress:c,overallProgress:f,executingNodeLabel:m,onDelete:()=>p(C),onStop:g,onImageClick:b,viewerImages:x,runningImages:w[C.id]??[],onOpenMenu:k,downloaded:N,isTopDoneItem:C.id===S},C.id)),u.jsx("div",{className:"h-20"})]})}function sk(n,o,s){y.useEffect(()=>{if(!n)return;const l=()=>o(),i=c=>{const f=c.target,m=document.getElementById(s);m&&f&&m.contains(f)||o()};return document.addEventListener("scroll",l,!0),document.addEventListener("mousedown",i),()=>{document.removeEventListener("scroll",l,!0),document.removeEventListener("mousedown",i)}},[n,o,s])}function lk({visible:n,onImageClick:o}){const s=It(K=>K.running),l=It(K=>K.pending),i=It(K=>K.fetchQueue),c=It(K=>K.deleteItem),f=It(K=>K.interrupt),m=ae(K=>K.loadWorkflow),p=no(K=>K.setCurrentPanel),g=ae(K=>K.workflow),b=ae(K=>K.nodeTypes),x=ae(K=>K.executingNodeId),w=ae(K=>K.workflowDurationStats),k=ae(K=>K.promptOutputs),N=Pn(K=>K.history),S=Pn(K=>K.fetchHistory),j=Pn(K=>K.deleteItem),{isExecuting:C,progress:T,executingPromptId:V}=ae(W4(K=>({isExecuting:K.isExecuting,progress:K.progress,executingPromptId:K.executingPromptId}))),U=V||(s.length===1?s[0].prompt_id:null),R=y.useMemo(()=>{if(!g||!x)return null;const K=g.nodes.find(W=>String(W.id)===x);return K?b?.[K.type]?.display_name||K.type:`Node ${x}`},[g,x,b]),z=Ma({workflow:g,runKey:V||U,isRunning:C||!!U,workflowDurationStats:w}),[L,$]=y.useState(null),[Q,ue]=y.useState({}),[fe,de]=y.useState(null),[Ie,je]=y.useState(!1),[Me,_]=y.useState(0),oe=y.useRef(null),ce=y.useRef(0),Ke=y.useRef(!1),Le=y.useRef(!1);y.useEffect(()=>{n&&(Ke.current||Le.current&&oe.current&&(oe.current.scrollTop=0),Promise.all([i(),S()]).then(()=>{je(!0)})),Ke.current=n,Le.current||(Le.current=!0)},[n,i,S]),y.useEffect(()=>{!C&&n&&S()},[C,n,S]),sk(!!L?.open,()=>$(null),"queue-image-menu");const E=async K=>{if(!K)return;const X=JSON.stringify(K,null,2),W=await tk(X);de(W?"Copied to clipboard":"Failed to copy"),setTimeout(()=>de(null),2e3)},A=async K=>{await yx(K,"image.png",X=>{ue(W=>({...W,[X]:!0}))})},M=y.useMemo(()=>{const K={};N.forEach(W=>{K[W.prompt_id]={id:W.prompt_id,status:"done",data:W,timestamp:W.timestamp}}),s.forEach(W=>{K[W.prompt_id]||(K[W.prompt_id]={id:W.prompt_id,status:"running",data:W})}),l.forEach(W=>{K[W.prompt_id]||(K[W.prompt_id]={id:W.prompt_id,status:"pending",data:W})}),V&&K[V]&&(K[V].status="running");const X=Object.values(K);return X.sort((W,Oe)=>{const be={pending:0,running:1,done:2};if(be[W.status]!==be[Oe.status])return be[W.status]-be[Oe.status];if(W.status==="pending"){const ke=W.data.number;return Oe.data.number-ke}return W.status==="done"?(Oe.timestamp||0)-(W.timestamp||0):0}),X},[l,s,N,V]),ee=y.useMemo(()=>{if(M.length===0)return 0;const K=M.filter(be=>be.status==="pending").length,X=M.filter(be=>be.status==="running").length,Oe=M.filter(be=>be.status==="done").length>0?1:0;return Math.min(M.length,K+X+Oe)},[M]),Te=y.useMemo(()=>{const K=M.filter(X=>X.status==="done").map(X=>X.data);return Ep(K,{onlyOutput:!0,alt:"Generation"})},[M]),qe=y.useMemo(()=>M.find(X=>X.status==="done")?.id??null,[M]);y.useEffect(()=>{n&&(ce.current=M.length,queueMicrotask(()=>{_(K=>Math.max(K,ee))}))},[n,M.length,ee]),y.useEffect(()=>{if(!n)return;const K=oe.current;K&&(Me>=M.length||K.scrollHeight<=K.clientHeight+20&&queueMicrotask(()=>{_(X=>Math.min(M.length,X+10))}))},[n,Me,M.length]);const ye=K=>{K.status==="pending"&&c(K.id),K.status==="done"&&j(K.id)},Ne=K=>{const{top:X,right:W,imageSrc:Oe,workflow:be,promptId:ke,hasVideoOutputs:J,hasImageOutputs:xe}=K;$({open:!0,top:X,right:W,imageSrc:Oe,workflow:be,promptId:ke,hasVideoOutputs:J,hasImageOutputs:xe})},H=()=>{const K=oe.current;if(!K)return;K.scrollHeight-K.scrollTop-K.clientHeight<400&&_(W=>Math.min(ce.current,W+10))},Y=(K,X)=>{m(K,`history-${X}.json`,{source:{type:"history",promptId:X}}),p("workflow")},D=async K=>{await ek(K,X=>{ue(W=>({...W,[X]:!0}))})};return u.jsx("div",{id:"queue-panel-wrapper",className:"absolute inset-x-0 top-[69px] bottom-0",style:{display:n?"block":"none"},children:u.jsxs("div",{className:"flex flex-col bg-gray-100 min-h-full",children:[u.jsx(rk,{listRef:oe,unifiedList:M,visibleCount:Me,hasLoadedOnce:Ie,effectiveExecutingId:U,progress:T,overallProgress:z,executingNodeLabel:R,onDeleteItem:ye,onStop:f,onImageClick:o,viewerImages:Te,promptOutputs:k,onOpenMenu:Ne,downloaded:Q,firstDoneItemId:qe,onScroll:H}),u.jsx(X4,{menuState:L,unifiedList:M,onClose:()=>$(null),onLoadWorkflow:Y,onCopyWorkflow:E,onDownload:K=>A(K),onBatchDownload:D,onDeleteHistory:K=>j(K),getBatchSources:J4}),u.jsx(Z4,{message:fe})]})})}let wf=null,hu=[];function qy(n){return encodeURIComponent(n)}async function ak(){if(hu.length===0)return;const n=[...hu];hu=[];const o=n.map(s=>{const l=new Date(s.timestamp).toISOString(),i=s.data!==void 0?` | ${JSON.stringify(s.data)}`:"";return`${l} ${s.message}${i}`}).join(`
`)+`
`;try{let s="";try{const i=await fetch(`${ln}/api/userdata/${qy("mobile-debug.log")}`);i.ok&&(s=await i.text())}catch{}const l=s+o;await fetch(`${ln}/api/userdata/${qy("mobile-debug.log")}?overwrite=true`,{method:"POST",headers:{"Content-Type":"text/plain"},body:l})}catch(s){console.error("[debugLog] Failed to write to server:",s)}}function ik(){wf||(wf=setTimeout(()=>{wf=null,ak()},500))}function Yf(n,o){const s={timestamp:Date.now(),message:n,data:o};hu.push(s),o!==void 0?console.log(`[DEBUG] ${n}`,o):console.log(`[DEBUG] ${n}`),ik()}function uk(n,o,s){const l=n.closest("[data-textarea-root]")?.querySelector("[data-textarea-header]"),i=getComputedStyle(document.documentElement),c=parseFloat(i.getPropertyValue("--top-bar-offset"))||0,f=window.visualViewport?.offsetTop??0,m=window.visualViewport?.height??window.innerHeight,p=c+8,g=bx(n),b=l?.getBoundingClientRect(),x=g===window?{type:"window",scrollY:window.scrollY}:(()=>{const z=g;return{type:"element",tag:z.tagName.toLowerCase(),scrollTop:z.scrollTop,height:z.clientHeight}})();Yf("textarea-scroll: start",{reason:s,behavior:o,headerTop:b?.top??null,layoutTopEdge:p,viewportTopEdge:f+c+8,viewportTop:f,viewportHeight:m,topBarOffset:c,container:x,selectionStart:n.selectionStart});const w=dk(n),k=f+c+m*.25,N=f+m-24,S=b?b.top-p:null,j=w-k,C=w>N?w-N:0;let T=0;const V=S!==null&&S>2,U=V?w-S:w,R=U<=N;V&&R?T=S??0:!V&&w<=N?T=0:(T=j,C>T&&(T=C)),T<0&&(T=0),b&&S!==null&&b.top>p+2&&T>S&&(T=S),Yf("textarea-scroll: align",{caretTop:w,targetTop:k,visibilityBottom:N,deltaHeader:S,deltaCaret:j,deltaCaretMin:C,caretAfterHeader:U,caretVisibleAfterHeader:R,canAlignHeader:V,delta:T}),Math.abs(T)>8&&xx(g,T,o)}function ck(n){const o=n.closest("[data-textarea-root]")?.querySelector("[data-textarea-header]");if(!o)return;const s=getComputedStyle(document.documentElement),i=(parseFloat(s.getPropertyValue("--top-bar-offset"))||0)+8,c=o.getBoundingClientRect(),f=c.top-i;if(Math.abs(f)<2)return;const m=bx(n);Yf("textarea-scroll: align-header-request",{headerTop:c.top,layoutTopEdge:i,delta:f}),xx(m,f,"auto")}function dk(n){const o=n.getBoundingClientRect(),s=fk(n);return o.top+s-n.scrollTop}function fk(n){const o=n.selectionStart??0,s=n.value,l=document.createElement("div"),i=getComputedStyle(n),c=l.style;c.position="absolute",c.top="0",c.left="-9999px",c.visibility="hidden",c.whiteSpace="pre-wrap",c.wordWrap="break-word",c.overflowWrap="break-word",c.boxSizing=i.boxSizing,c.width=`${n.clientWidth}px`,c.padding=i.padding,c.border=i.border,c.fontFamily=i.fontFamily,c.fontSize=i.fontSize,c.fontWeight=i.fontWeight,c.fontStyle=i.fontStyle,c.letterSpacing=i.letterSpacing,c.lineHeight=i.lineHeight,c.textTransform=i.textTransform,c.textIndent=i.textIndent,c.tabSize=i.tabSize;const f=document.createTextNode(s.slice(0,o)),m=document.createElement("span");m.textContent=s.slice(o,o+1)||" ",m.style.display="inline-block",m.style.width="1px",l.appendChild(f),l.appendChild(m),document.body.appendChild(l);const p=l.getBoundingClientRect(),b=m.getBoundingClientRect().top-p.top;return document.body.removeChild(l),b}function Sf(n){n?document.body.dataset.textareaFocus="true":delete document.body.dataset.textareaFocus}function bx(n){let o=n?.parentElement??null;for(;o;){const l=getComputedStyle(o).overflowY;if((l==="auto"||l==="scroll")&&o.scrollHeight>o.clientHeight)return o;o=o.parentElement}return window}function xx(n,o,s="smooth"){if(Math.abs(o)<1)return;if(n===window){window.scrollBy({top:o,behavior:s});return}const l=n;l.scrollTo({top:l.scrollTop+o,behavior:s})}function vx(){const[n,o]=y.useState(!1),s=y.useRef(null),l=y.useRef(null),i=y.useRef(null);return y.useEffect(()=>{const c=m=>{const p=m.target;if(!(p instanceof HTMLElement))return;const g=p.tagName.toLowerCase();if((p.isContentEditable||g==="input"||g==="textarea"||g==="select")&&o(!0),p instanceof HTMLTextAreaElement){Sf(!0);const b=()=>uk(p,"smooth","focus");s.current&&clearTimeout(s.current),l.current&&window.visualViewport&&(window.visualViewport.removeEventListener("resize",l.current),l.current=null),i.current&&(document.removeEventListener("selectionchange",i.current),i.current=null);const x=()=>{document.activeElement===p&&(b(),i.current&&(document.removeEventListener("selectionchange",i.current),i.current=null))};if(i.current=x,document.addEventListener("selectionchange",x),setTimeout(()=>{i.current&&(document.removeEventListener("selectionchange",i.current),i.current=null)},1200),window.visualViewport){let w=!1;const k=()=>{w=!0,b(),l.current&&(window.visualViewport?.removeEventListener("resize",l.current),l.current=null)};l.current=k,window.visualViewport.addEventListener("resize",k),s.current=setTimeout(()=>{w||b(),setTimeout(b,300),l.current&&(window.visualViewport?.removeEventListener("resize",l.current),l.current=null)},600)}else requestAnimationFrame(b)}},f=()=>{const m=document.activeElement;if(!(m instanceof HTMLElement)){o(!1),Sf(!1),i.current&&(document.removeEventListener("selectionchange",i.current),i.current=null);return}const p=m.tagName.toLowerCase(),g=m.isContentEditable||p==="input"||p==="textarea"||p==="select";o(g),Sf(m instanceof HTMLTextAreaElement)};return document.addEventListener("focusin",c),document.addEventListener("focusout",f),()=>{document.removeEventListener("focusin",c),document.removeEventListener("focusout",f),s.current&&clearTimeout(s.current),l.current&&window.visualViewport&&(window.visualViewport.removeEventListener("resize",l.current),l.current=null),i.current&&(document.removeEventListener("selectionchange",i.current),i.current=null)}},[]),y.useEffect(()=>{const c=f=>{const p=f.detail?.textarea;p&&ck(p)};return document.addEventListener("textarea-align-header",c),()=>{document.removeEventListener("textarea-align-header",c)}},[]),{isInputFocused:n}}function pk({index:n,total:o,displayName:s}){return u.jsx("div",{id:"media-viewer-header",className:"absolute top-0 inset-x-0 px-3 pt-3 pb-4 bg-gradient-to-b from-black/50 to-transparent",children:u.jsxs("div",{className:"grid grid-cols-3 items-center",children:[u.jsxs("div",{className:"flex items-center gap-3 text-white text-sm",children:[n+1," / ",o]}),u.jsx("div",{className:"justify-self-center text-white/90 text-sm font-medium max-w-[70vw] truncate",children:s}),u.jsx("div",{})]})})}function hk({onClick:n}){return u.jsx("button",{type:"button",onClick:n,"aria-label":"Delete output",className:"pointer-events-auto w-9 h-9 rounded-full bg-black/40 text-red-500 flex items-center justify-center hover:bg-black/60 transition-colors",children:u.jsx(Bo,{className:"w-5 h-5"})})}function mk({onClick:n}){return u.jsx("button",{type:"button",onClick:n,"aria-label":"Load workflow",className:"pointer-events-auto w-9 h-9 rounded-full bg-black/40 text-white flex items-center justify-center hover:bg-black/60 transition-colors",children:u.jsx(bs,{className:"w-5 h-5"})})}function gk({onClick:n}){return u.jsx("button",{type:"button",onClick:n,"aria-label":"Use in workflow",className:"pointer-events-auto w-9 h-9 rounded-full bg-black/40 text-white flex items-center justify-center hover:bg-black/60 transition-colors",children:u.jsx(cb,{className:"w-5 h-5"})})}function yk({onClick:n,disabled:o}){return u.jsx("button",{type:"button",onClick:n,"aria-label":"Toggle metadata",className:`pointer-events-auto w-9 h-9 rounded-full bg-black/40 text-white flex items-center justify-center hover:bg-black/60 transition-colors ${o?"opacity-40":""}`,disabled:o,children:u.jsx(ub,{className:"w-5 h-5"})})}function bk({isVideo:n,showMetadataToggle:o,canToggleMetadata:s,onDelete:l,onLoadWorkflow:i,onUseInWorkflow:c,onToggleMetadata:f}){return u.jsxs("div",{className:"absolute inset-x-0 px-3 pb-2 pt-2 flex items-center justify-between",style:{bottom:"calc(var(--bottom-bar-offset, 0px) + 4px)"},children:[u.jsx(hk,{onClick:l}),!n&&u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(mk,{onClick:i}),u.jsx(gk,{onClick:c}),o&&u.jsx(yk,{onClick:f,disabled:!s})]})]})}function xk({isVideo:n,showMetadataToggle:o,showMetadataOverlay:s,metadataIsLoading:l,metadata:i,durationLabel:c}){return o?u.jsx("div",{className:`absolute right-3 flex flex-col items-end gap-1 pointer-events-none transition-opacity duration-300 ${s?"opacity-100":"opacity-0"}`,style:{bottom:n?"calc(var(--bottom-bar-offset, 0px) + 120px)":"calc(var(--bottom-bar-offset, 0px) + 64px)"},children:l?u.jsx("div",{className:"px-1.5 py-0.5 bg-black/50 text-white text-[10px] rounded backdrop-blur-sm",children:"Loading metadata..."}):i?u.jsxs(u.Fragment,{children:[i.model&&u.jsxs("div",{className:"px-1.5 py-0.5 bg-black/50 text-white text-[10px] rounded backdrop-blur-sm",children:["model: ",i.model]}),i.sampler&&u.jsxs("div",{className:"px-1.5 py-0.5 bg-black/50 text-white text-[10px] rounded backdrop-blur-sm",children:["sampler: ",i.sampler]}),i.steps&&u.jsxs("div",{className:"px-1.5 py-0.5 bg-black/50 text-white text-[10px] rounded backdrop-blur-sm",children:["steps: ",i.steps]}),i.cfg&&u.jsxs("div",{className:"px-1.5 py-0.5 bg-black/50 text-white text-[10px] rounded backdrop-blur-sm",children:["cfg: ",i.cfg]}),c&&u.jsxs("div",{className:"px-1.5 py-0.5 bg-black/50 text-white text-[10px] rounded backdrop-blur-sm",children:["time: ",c]})]}):u.jsx("div",{className:"px-1.5 py-0.5 bg-black/50 text-white text-[10px] rounded backdrop-blur-sm",children:"No metadata found"})}):null}const vk={x:0,y:0},Qf=2100,Nf=Qf+10;function wx({open:n,items:o,index:s,onIndexChange:l,onClose:i,onDelete:c,onLoadWorkflow:f,onLoadInWorkflow:m,showMetadataToggle:p=!1,showLoadingPlaceholder:g=!1,loadingProgress:b=0,loadingLabel:x,initialScale:w=1,initialTranslate:k=vk,onTransformChange:N,zoomResetKey:S}){const j=y.useRef(null),C=y.useRef(null),T=y.useRef(null),V=y.useRef(null),[U,R]=y.useState(1),[z,L]=y.useState({x:0,y:0}),$=y.useRef(1),Q=y.useRef({x:0,y:0}),ue=y.useRef(null),fe=y.useRef(null),de=y.useRef(null),Ie=y.useRef(null),[je,Me]=y.useState(null),[_,oe]=y.useState(null),[ce,Ke]=y.useState(!1),[Le,E]=y.useState(!1),A=y.useRef(null),M=y.useRef("fit"),[ee,Te]=y.useState({}),[qe,ye]=y.useState({}),[Ne,H]=y.useState(!1),{isInputFocused:Y}=vx(),D=s>=0?o[s]??o[0]??null:null,K=D?.filename??D?.file?.name??D?.alt??D?.src??"",X=!!(D?.mediaType==="video"||D?.file?.type==="video"||K&&el(K)),W=D?.file?.id??null,Oe=W?ee[W]:void 0,be=D?.metadata??(Oe===void 0?void 0:Oe),ke=wk(D?.durationSeconds),J=D?.filename||D?.alt||"Output",xe=Le&&!ce,I=p,B=W?!!qe[W]:!1,q=y.useCallback(()=>{Ke(!1),A.current&&clearTimeout(A.current),A.current=setTimeout(()=>{Ke(!0)},3e3)},[]),he=y.useCallback(()=>{q(),E(Ge=>!Ge)},[q]),me=y.useCallback(()=>{D&&(q(),c(D))},[D,c,q]),Se=y.useCallback(()=>{D&&(q(),f(D))},[D,f,q]),F=y.useCallback(()=>{D&&(q(),m(D))},[D,m,q]);y.useEffect(()=>(n?queueMicrotask(q):A.current&&clearTimeout(A.current),()=>{A.current&&clearTimeout(A.current)}),[n,q]),y.useLayoutEffect(()=>{n&&(R(w),L(k),$.current=w,Q.current=k,ue.current=null,fe.current=null,de.current=null,Ie.current=null,M.current="fit")},[n,s,w,k]),y.useEffect(()=>{V.current=null,Me(null),H(!1)},[D?.src]),y.useEffect(()=>{if(n)return document.body.style.overflow="hidden",()=>{document.body.style.overflow=""}},[n]),y.useEffect(()=>{n&&N&&N(U,z)},[n,U,z,N]),y.useEffect(()=>{if(!n)return;const Ge=He=>{He.key==="Escape"&&i()};return document.addEventListener("keydown",Ge),()=>document.removeEventListener("keydown",Ge)},[n,i]),y.useEffect(()=>{if(!n||!p||!D?.file||D.metadata||!W||be!==void 0||B)return;const Ge=W.startsWith("input/")?"input":"output",He=W.startsWith(`${Ge}/`)?W.slice(Ge.length+1):W;ye(Ve=>({...Ve,[W]:!0})),ow(He,Ge).then(Ve=>{const et=Ve?.prompt?Tp(Ve.prompt):null,ft=et&&Object.keys(et).length>0?et:null;Te(St=>({...St,[W]:ft}))}).catch(()=>{Te(Ve=>({...Ve,[W]:null}))}).finally(()=>{ye(Ve=>({...Ve,[W]:!1}))})},[n,p,D,W,be,B]);const ie=y.useMemo(()=>!je||!_?null:_.height/je.height,[je,_]),Ae=y.useMemo(()=>ie===null?1:Math.min(1,ie),[ie]),Ue=y.useMemo(()=>ie===null?1:Math.max(1,ie),[ie]),Je=(Ge=U,He=je)=>{if(!He||!_)return{x:0,y:0};const Ve=He.width*Ge,et=He.height*Ge;return{x:Ve<_.width?(_.width-Ve)/2:0,y:et<_.height?(_.height-et)/2:0}},Pe=y.useCallback((Ge,He=U)=>{if(!je||!_)return Ge;const Ve=_.width,et=_.height,ft=je.width*He,St=je.height*He,zt=ft<=Ve?0:Math.max(Ve-ft,Math.min(0,Ge.x)),le=St<=et?0:Math.max(et-St,Math.min(0,Ge.y));return{x:zt,y:le}},[je,_,U]),st=y.useRef(Pe),$e=y.useCallback(Ge=>{let He=Ae;if(Ge==="cover"?He=Ue:He=Ae,M.current=Ge,$.current=He,R(He),!je||!_)Q.current={x:0,y:0},L({x:0,y:0});else{const Ve=je.width*He,et=je.height*He,ft={x:(_.width-Ve)/2,y:(_.height-et)/2},St=Pe(ft,He);Q.current=St,L(St)}},[je,Pe,_,Ue,Ae]),Fe=y.useRef($e);y.useEffect(()=>{st.current=Pe},[Pe]),y.useEffect(()=>{Fe.current=$e},[$e]);const at=Ge=>{const He=Ge.currentTarget;V.current={width:He.naturalWidth,height:He.naturalHeight};const Ve=j.current;if(!Ve||He.naturalWidth===0)return;const et=Ve.clientWidth,ft=Ve.clientHeight,St=et/He.naturalWidth;Me({width:et,height:He.naturalHeight*St}),oe({width:et,height:ft})};y.useEffect(()=>{if(X||!n)return;const Ge=C.current,He=j.current;if(!Ge||!He)return;const Ve=()=>{const ft=V.current,St=He.clientWidth,zt=He.clientHeight;if(oe({width:St,height:zt}),!ft||ft.width===0)return;const le=St/ft.width,se=ft.height*le;Me({width:St,height:se});const De=st.current(Q.current);Q.current=De,L(De)};Ve();const et=new ResizeObserver(Ve);return et.observe(He),()=>et.disconnect()},[n,D?.src,X]),y.useEffect(()=>{X||!n||!je||!_||Fe.current(M.current)},[n,D?.src,je,_,X]),y.useEffect(()=>{n&&S!==void 0&&Fe.current(M.current)},[n,S]);const ht=()=>{const Ge=C.current;if(!Ge)return;const He=$.current,Ve=Q.current,et=Je(He);Ge.style.transform=`translate3d(${et.x+Ve.x}px, ${et.y+Ve.y}px, 0) scale(${He})`},Lt=Ge=>{if(X){const Ve=T.current;if(Ve&&Ge.target===Ve){const et=Ve.getBoundingClientRect();if(Ge.clientY>et.bottom-60)return}}Ge.currentTarget.setPointerCapture(Ge.pointerId);const He=Cf(j.current);if(He.set(Ge.pointerId,{x:Ge.clientX,y:Ge.clientY}),He.size===1){if(fe.current={x:Ge.clientX,y:Ge.clientY,time:Date.now()},!X){ue.current={x:Ge.clientX-Q.current.x,y:Ge.clientY-Q.current.y};const Ve=C.current;Ve&&(Ve.style.transition="none")}}else if(He.size===2&&!X){const[Ve,et]=Array.from(He.values()),ft=Math.hypot(et.x-Ve.x,et.y-Ve.y),St=(Ve.x+et.x)/2,zt=(Ve.y+et.y)/2,le=j.current?.getBoundingClientRect(),se=$.current,De=Q.current,Ze=Je(se),Qe=le?{x:(St-le.left-Ze.x-De.x)/se,y:(zt-le.top-Ze.y-De.y)/se}:void 0;de.current={distance:ft,scale:se,centerX:St,centerY:zt,imagePoint:Qe}}},Gt=Ge=>{const He=Cf(j.current);if(He.has(Ge.pointerId)){if(He.set(Ge.pointerId,{x:Ge.clientX,y:Ge.clientY}),He.size===2&&de.current&&!X){const Ve=de.current,[et,ft]=Array.from(He.values()),St=Math.hypot(ft.x-et.x,ft.y-et.y),le=Math.max(Ae,Math.min(5,Ve.scale*(St/Ve.distance)));$.current=le;const se=j.current?.getBoundingClientRect(),De=(et.x+ft.x)/2,Ze=(et.y+ft.y)/2;if(se&&Ve.imagePoint){const Qe=Je(le),rt={x:De-se.left-Qe.x-Ve.imagePoint.x*le,y:Ze-se.top-Qe.y-Ve.imagePoint.y*le};Q.current=Pe(rt,le)}else Q.current=Pe(Q.current,le);ht();return}if(He.size===1&&!X){const Ve=$.current;(Ve>1||je&&j.current&&je.height*Ve>j.current.clientHeight+1)&&ue.current&&(Q.current=Pe({x:Ge.clientX-ue.current.x,y:Ge.clientY-ue.current.y},Ve),ht())}}},Pt=Ge=>{const He=Cf(j.current);if(He.delete(Ge.pointerId),He.size<2){if(He.size===1&&de.current){const[Ve]=Array.from(He.values());ue.current={x:Ve.x-Q.current.x,y:Ve.y-Q.current.y}}de.current=null}if(He.size===0){const Ve=C.current;Ve&&(Ve.style.transition="transform 0.05s linear");const et=Date.now(),ft=Ie.current,St=ft?Ge.clientX-ft.x:0,zt=ft?Ge.clientY-ft.y:0,le=!!(ft&&et-ft.time<300&&Math.hypot(St,zt)<24);if(!X&&le){Ie.current=null;const se=M.current;$e(se==="fit"?"cover":"fit"),q()}else{Ie.current={time:et,x:Ge.clientX,y:Ge.clientY};const se=fe.current;if(!Y&&se){const De=Ge.clientX-se.x,Ze=Ge.clientY-se.y,Qe=Date.now()-se.time,rt=Math.abs(De),Re=Math.abs(Ze),gt=$.current,bt=Math.abs(gt-Ae)<.05||Math.abs(gt-Ue)<.05,it=Qe<250&&rt<10&&Re<10;Qe<=350&&rt>60&&rt>Re&&bt?De<0?s<o.length-1&&l(s+1):De>0&&s>0&&l(s-1):it&&q()}R($.current),L(Q.current)}ue.current=null}},$t=Ge=>{if(X||!Ge.ctrlKey)return;Ge.preventDefault();const He=-Ge.deltaY*.005,Ve=Math.max(Ae,Math.min(5,$.current+He));$.current=Ve,R(Ve);const et=Pe(Q.current,Ve);Q.current=et,L(et)};return n?!D&&!g?En.createPortal(u.jsxs("div",{className:"fixed inset-0 bg-black flex flex-col items-center justify-center text-white",style:{zIndex:Qf},role:"dialog","aria-modal":"true",children:[u.jsx(xa,{onClick:i,buttonSize:9,iconSize:6,zIndex:Nf}),u.jsx("p",{className:"text-gray-400 mb-2",children:"No images to display"}),u.jsxs("p",{className:"text-gray-500 text-sm",children:["images: ",o.length,", index: ",s]})]}),document.body):En.createPortal(u.jsxs("div",{id:"media-viewer-overlay",className:"fixed inset-0 bg-black",style:{zIndex:Qf},onWheel:$t,children:[u.jsx("div",{ref:j,className:`absolute inset-x-0 top-0 overflow-hidden ${X?"":"touch-none"}`,style:{overscrollBehavior:"contain",height:"calc(100vh - var(--bottom-bar-offset, 0px))",zIndex:1},onPointerDown:Lt,onPointerMove:Gt,onPointerUp:Pt,onPointerCancel:Pt,children:g?u.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center text-white",children:[u.jsx("div",{className:"w-12 h-12 border-4 border-gray-600 border-t-white rounded-full animate-spin"}),u.jsx("div",{className:"mt-4 w-48 h-2 rounded-full bg-gray-700 overflow-hidden",children:u.jsx("div",{className:"h-full bg-white transition-all duration-300",style:{width:`${Math.min(100,Math.max(0,b))}%`}})}),u.jsx("div",{className:"mt-2 text-sm text-gray-300",children:x??`${Math.min(100,Math.max(0,b))}%`})]}):D&&u.jsx(u.Fragment,{children:X?u.jsxs(u.Fragment,{children:[u.jsx("video",{ref:T,src:D.src,controls:!0,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,className:"w-full h-full object-contain select-none",onDragStart:Ge=>Ge.preventDefault(),onError:()=>H(!0)}),Ne&&u.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-white text-sm bg-black/60",children:"Unable to play this video."})]}):u.jsx("img",{ref:C,src:D.src,alt:D.alt||"Generation",className:"w-full h-auto block select-none relative",draggable:!1,onLoad:at,style:{transform:`translate3d(${Je(U).x+z.x}px, ${Je(U).y+z.y}px, 0) scale(${U})`,transformOrigin:"top left",willChange:"transform",backfaceVisibility:"hidden",WebkitBackfaceVisibility:"hidden"}})})}),u.jsx(xa,{onClick:i,buttonSize:9,iconSize:6,isIdle:ce,zIndex:Nf}),u.jsx("div",{className:`absolute inset-0 pointer-events-none transition-opacity duration-300 ${ce?"opacity-0":"opacity-100"}`,style:{zIndex:Nf},children:D&&u.jsxs(u.Fragment,{children:[u.jsx(pk,{index:s,total:o.length,displayName:J}),u.jsx(bk,{isVideo:X,showMetadataToggle:p,canToggleMetadata:I,onDelete:me,onLoadWorkflow:Se,onUseInWorkflow:F,onToggleMetadata:he}),u.jsx(xk,{isVideo:X,showMetadataToggle:p,showMetadataOverlay:xe,metadataIsLoading:B,metadata:be,durationLabel:ke})]})})]}),document.body):null}function Cf(n){const o=n;return o?(o.__activePointers||(o.__activePointers=new Map),o.__activePointers):new Map}function wk(n){const o=n===void 0||Number.isNaN(n)?0:n;return o===0?"":o<10?`${o.toFixed(1)}s`:`${Math.round(o)}s`}function Eu(n){return n.id.startsWith("input/")?"input":"output"}function ul(n,o){const l=`${o??Eu(n)}/`;return n.id.startsWith(l)?n.id.slice(l.length):n.id}function Sk(n){return`output-${n.replace(/[\\/]/g,"_")}.json`}async function Sx(n){const{file:o,source:s,loadWorkflow:l,onLoaded:i,onError:c}=n;try{const f=s??Eu(o),m=ul(o,f),p=await nw(m,f);l(p,Sk(m),{source:{type:"other"}}),i?.()}catch(f){throw c?.(f),f}}function Nk(n){const{workflow:o,nodeTypes:s,nodeId:l}=n;if(!o||!s)return null;const i=o.nodes.find(f=>f.id===l);if(!i)return null;const c=["image","filename","file"];for(const f of c){const m=Wr(o,s,i,f);if(m!==null)return{node:i,index:m,name:f}}return null}function Wy(n,o){const s=n.title,l=typeof s=="string"&&s.trim()?s.trim():null,i=o?.[n.type];return l||i?.display_name||n.type}function Ck(n){const o=n.replace(/^\/+/,""),s=o.split("/").filter(Boolean);return s.length<=1?{filename:o,subfolder:""}:{filename:s.pop()??o,subfolder:s.join("/")}}async function kk(n,o){if(o==="input")return ul(n,o);const s=ul(n,o),{filename:l,subfolder:i}=Ck(s),c=n.fullUrl||mo(l,i,o),f=await fetch(c);if(!f.ok)throw new Error("Failed to fetch image data.");const m=await f.blob(),p=l||n.name||"image.png",g=new File([m],p,{type:m.type||"image/png"}),b=await tb(g,{type:"input",overwrite:!0}),x=b.subfolder?`${b.subfolder}/${b.name}`:b.name;if(!(await fetch(mo(b.name,b.subfolder??"","input"))).ok)throw new Error("Uploaded image was not found in inputs.");return x}function Nx({open:n,file:o,source:s,onClose:l,onLoaded:i}){const c=ae(T=>T.workflow),f=ae(T=>T.nodeTypes),m=ae(T=>T.setNodeTypes),p=ae(T=>T.updateNodeWidget),g=dn(T=>T.clearNodeError),b=ae(T=>T.scrollToNode),x=no(T=>T.setCurrentPanel),[w,k]=y.useState(null),[N,S]=y.useState(null),j=y.useMemo(()=>c?c.nodes.filter(T=>/loadimage/i.test(T.type)).map(T=>({node:T,stableKey:T.stableKey??null})).filter(T=>T.stableKey!==null):[],[c]);y.useEffect(()=>{n||(k(null),S(null))},[n]);const C=async T=>{if(!(!o||!c)){S(T),k(null);try{const V=c.nodes.find(z=>z.stableKey===T);if(!V)throw new Error("Could not resolve selected node.");const U=Nk({workflow:c,nodeTypes:f,nodeId:V.id});if(!U)throw new Error("Selected node does not accept image inputs.");const R=await kk(o,s);if(s!=="input")try{const z=await tp();m(z)}catch(z){console.warn("Failed to refresh node types after upload:",z)}p(T,U.index,R,U.name),g(U.node.id),x("workflow"),i?.(),setTimeout(()=>{b(T,Wy(U.node,f))},150)}catch(V){console.error("Failed to load image into node:",V),k(V instanceof Error?V.message:"Failed to load image.")}finally{S(null)}}};return!n||!o?null:u.jsx("div",{id:"outputs-load-node-overlay",className:"fixed inset-0 z-[2150] bg-black/50 flex items-center justify-center p-4",onClick:l,role:"dialog","aria-modal":"true",children:u.jsxs("div",{id:"outputs-load-node-modal",className:"w-full max-w-sm bg-white border border-gray-200 rounded-xl shadow-lg overflow-hidden",onClick:T=>T.stopPropagation(),children:[u.jsx("div",{className:"px-4 py-3 text-sm font-semibold text-gray-700 border-b border-gray-100",children:"Load image into node"}),u.jsx("div",{className:"px-4 pt-3 text-xs text-gray-500",children:o.name}),u.jsxs("div",{className:"max-h-[50vh] overflow-y-auto",children:[j.length===0&&u.jsx("div",{className:"px-4 py-3 text-sm text-gray-400",children:"No Load Image nodes found in the current workflow."}),j.map(({node:T,stableKey:V})=>{const U=Wy(T,f),R=N===V;return u.jsxs("button",{className:"w-full text-left px-4 py-3 text-sm hover:bg-gray-50 flex items-center gap-2 disabled:opacity-60 disabled:cursor-not-allowed",onClick:()=>C(V),disabled:N!==null,children:[u.jsxs("span",{className:"text-gray-500 dark:text-gray-300",children:["#",T.id]}),u.jsx("span",{className:"flex-1 text-gray-900 dark:text-gray-100 truncate",children:U}),R&&u.jsx("span",{className:"text-xs text-gray-400",children:"Loading"})]},`load-node-${V}`)})]}),w&&u.jsx("div",{className:"px-4 py-2 text-xs text-red-600 border-t border-gray-100",children:w}),u.jsx("div",{className:"px-4 py-3 border-t border-gray-100 flex justify-end",children:u.jsx("button",{className:"px-3 py-2 text-sm font-medium text-gray-600 hover:bg-gray-100 rounded-lg disabled:opacity-60",onClick:l,disabled:N!==null,children:"Close"})})]})})}function jk({onClose:n}){const o=Mo(ye=>ye.viewerOpen),s=Mo(ye=>ye.viewerImages),l=Mo(ye=>ye.viewerIndex),i=Mo(ye=>ye.viewerScale),c=Mo(ye=>ye.viewerTranslate),f=ae(ye=>ye.followQueue),m=Mo(ye=>ye.setViewerState),p=ae(ye=>ye.workflow),g=ae(ye=>ye.originalWorkflow),b=ae(ye=>ye.workflowDurationStats),x=ae(ye=>ye.isExecuting),w=ae(ye=>ye.executingPromptId),k=no(ye=>ye.setCurrentPanel),N=ae(ye=>ye.loadWorkflow),S=It(ye=>ye.running),j=Pn(ye=>ye.history),[C,T]=y.useState(null),[V,U]=y.useState(null),[R,z]=y.useState(null),[L,$]=y.useState(!1),Q=y.useRef(null),ue=y.useMemo(()=>!!(p&&g&&JSON.stringify(p)!==JSON.stringify(g)),[p,g]),fe=y.useMemo(()=>!o||!f?null:j[0]?.prompt_id??null,[o,f,j]),de=w||(S.length===1?S[0].prompt_id:null),Ie=Ma({workflow:p,runKey:de,isRunning:x||S.length>0,workflowDurationStats:b}),je=x||S.length>0,Me=Math.min(100,Math.max(0,Ie??0)),oe=!(l>=0?s[l]??s[0]??null:null)&&(f||je)||l<0&&je;y.useEffect(()=>{if(!o||!f){Q.current=null;return}!Q.current&&j[0]?.prompt_id&&(Q.current=j[0]?.prompt_id??null)},[o,f,j]),y.useEffect(()=>{if(!o||!f||j.length===0)return;const ye=j[0];if(Q.current===ye.prompt_id||ye.outputs.images.filter(Y=>Y.type==="output").length===0)return;const H=Ep(j,{onlyOutput:!0,alt:"Generation"});H.length!==0&&(Q.current=ye.prompt_id,m({viewerImages:H,viewerIndex:0,viewerScale:1,viewerTranslate:{x:0,y:0}}))},[o,f,j,m]);const ce=ye=>{m({viewerIndex:ye})},Ke=(ye,Ne)=>{m({viewerScale:ye,viewerTranslate:Ne})},Le=ye=>{ye.file&&T(ye.file)},E=async()=>{if(!C)return;const ye=C;try{const Ne=ul(ye);await Of(Ne,Eu(ye));const H=s.filter(K=>K.file?.id!==ye.id),Y=s.findIndex(K=>K.file?.id===ye.id),D=H.length===0?0:Y<0?l:Y<l?l-1:Y===l?Math.min(l,H.length-1):l;m({viewerImages:H,viewerIndex:D}),H.length===0&&n()}catch(Ne){console.error("Failed to delete file:",Ne),window.alert("Failed to delete file.")}finally{T(null)}},A=ye=>{if(ye.file){if(ue){U(ye.file);return}M(ye.file)}},M=async ye=>{try{await Sx({file:ye,loadWorkflow:N,onLoaded:()=>{n(),queueMicrotask(()=>k("workflow"))}})}catch(Ne){console.error("Failed to load workflow from file:",Ne),window.alert("Failed to load workflow from file.")}finally{U(null)}},ee=ye=>{!ye.file||ye.file.type!=="image"||(z(ye.file),$(!0))},Te=()=>{$(!1),z(null)},qe=()=>{Te(),n(),queueMicrotask(()=>k("workflow"))};return o?u.jsxs(u.Fragment,{children:[u.jsx(wx,{open:o,items:s,index:l,onIndexChange:ce,onClose:n,onDelete:Le,onLoadWorkflow:A,onLoadInWorkflow:ee,showMetadataToggle:!0,showLoadingPlaceholder:oe,loadingProgress:Me,loadingLabel:je?`${Me}%`:"Waiting for output",initialScale:i,initialTranslate:c,onTransformChange:Ke,zoomResetKey:fe}),V&&En.createPortal(u.jsx(Po,{onClose:()=>U(null),title:"Unsaved changes",description:"Are you sure you want to load this workflow? You have unsaved changes.",actions:[{label:"Cancel",onClick:()=>U(null),className:"px-3 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-100"},{label:"Continue",onClick:()=>{(async()=>(await M(V),U(null)))()},className:"px-3 py-2 rounded-lg text-sm font-medium text-white bg-red-600 hover:bg-red-700"}]}),document.body),u.jsx(Nx,{open:L,file:R,source:R?Eu(R):"output",onClose:Te,onLoaded:qe}),C&&En.createPortal(u.jsx(Po,{onClose:()=>T(null),title:"Delete file?",description:`This will permanently delete "${C.name}" from the server. This cannot be undone.`,actions:[{label:"Cancel",onClick:()=>T(null),className:"px-3 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-100"},{label:"Delete",onClick:()=>{E()},className:"px-3 py-2 rounded-lg text-sm font-medium text-white bg-red-600 hover:bg-red-700"}]}),document.body)]}):null}function Mk(){const[n,o]=y.useState(!1),s=y.useRef(null),l=y.useRef(null),i=y.useRef({}),c=y.useRef({setExecutionState:ae.getState().setExecutionState,setNodeOutput:ae.getState().setNodeOutput,clearNodeOutputs:ae.getState().clearNodeOutputs,addPromptOutputs:ae.getState().addPromptOutputs,clearPromptOutputs:ae.getState().clearPromptOutputs,applyControlAfterGenerate:ae.getState().applyControlAfterGenerate,updateFromStatus:It.getState().updateFromStatus,fetchQueue:It.getState().fetchQueue,addHistoryEntry:Pn.getState().addHistoryEntry,fetchHistory:Pn.getState().fetchHistory});y.useEffect(()=>{c.current={setExecutionState:ae.getState().setExecutionState,setNodeOutput:ae.getState().setNodeOutput,clearNodeOutputs:ae.getState().clearNodeOutputs,addPromptOutputs:ae.getState().addPromptOutputs,clearPromptOutputs:ae.getState().clearPromptOutputs,applyControlAfterGenerate:ae.getState().applyControlAfterGenerate,updateFromStatus:It.getState().updateFromStatus,fetchQueue:It.getState().fetchQueue,addHistoryEntry:Pn.getState().addHistoryEntry,fetchHistory:Pn.getState().fetchHistory}},[]);const f=y.useRef(null);return y.useEffect(()=>{const m=x=>{if(x==null)return null;const w=Number(x);if(!Number.isFinite(w))return null;const N=ae.getState().workflow;if(!N)return null;const S=N.nodes.filter(C=>C.id===w);return S.length===0?null:(S.find(C=>C.stableKey)??S[0])?.stableKey??null},p=x=>{const{setExecutionState:w,setNodeOutput:k,addPromptOutputs:N,clearPromptOutputs:S,updateFromStatus:j,fetchQueue:C,addHistoryEntry:T,fetchHistory:V}=c.current,U=x;switch(U.type){case"status":{const z=U.data.status.exec_info.queue_remaining;j(z),z===0&&w(!1,null,null,0);break}case"progress":{const R=U,{value:z,max:L,node:$,prompt_id:Q}=R.data,ue=Math.round(z/L*100);w(!0,m($),Q||null,ue);break}case"executing":{const R=U,z=R.data.node,L=R.data.prompt_id;if(z===null){if(w(!1,null,null,0),c.current.applyControlAfterGenerate(),L){const $=It.getState().running.find(ue=>ue.prompt_id===L),Q=i.current[L]||[];$&&T({prompt_id:L,timestamp:Date.now(),outputs:{images:Q},prompt:$.prompt}),delete i.current[L],S(L)}C(),V()}else{L&&L!==f.current&&(f.current=L),w(!0,m(z),L||null,0);const $=It.getState();L&&!$.running.some(Q=>Q.prompt_id===L)&&C()}break}case"executed":{const R=U,{node:z,prompt_id:L,output:$}=R.data;if($.images){i.current[L]||(i.current[L]=[]),i.current[L].push(...$.images),N(L,$.images);const Q=m(z);Q&&k(Q,$.images)}break}case"execution_error":{w(!1,null,null,0),S(),C(),V();break}}},g=()=>{s.current?.readyState!==WebSocket.OPEN&&(s.current=ew(Zy,p,async()=>{o(!0);const{fetchQueue:x,fetchHistory:w,setExecutionState:k}=c.current;await x(),w();const N=It.getState(),S=ae.getState();if(N.running.length>0&&!S.executingPromptId){const j=N.running[0];k(!0,null,j.prompt_id,0)}},()=>{o(!1),l.current=setTimeout(g,2e3)},()=>{o(!1)}))};g();const b=setInterval(()=>{const{fetchQueue:x,fetchHistory:w}=c.current;It.getState().running.length>0&&(x(),w())},2e3);return()=>{l.current&&clearTimeout(l.current),s.current&&s.current.close(),clearInterval(b)}},[]),{isConnected:n}}function Ok({onSwipeLeft:n,onSwipeRight:o,onSwipeUp:s,onSwipeDown:l,enabled:i=!0,threshold:c=50,preventScroll:f=!0,deferResetOnSwipe:m=!1,deferResetDurationMs:p=350}){const[g,b]=y.useState(0),[x,w]=y.useState(!1),[k,N]=y.useState(i),S=y.useRef(null),j=y.useRef(null);y.useEffect(()=>{N(i)},[i]);const C=y.useCallback(()=>{S.current=null,w(!1),b(0)},[]),T=y.useCallback(V=>{N(V)},[]);return y.useEffect(()=>{if(!k)return;const V=L=>{if(!(L instanceof HTMLElement))return!1;if(L.isContentEditable)return!0;const $=L.tagName.toLowerCase();return $==="input"||$==="textarea"||$==="select"},U=L=>{if(V(L.target)||V(document.activeElement))return;j.current!==null&&(window.clearTimeout(j.current),j.current=null);const $=L.touches[0];S.current={startX:$.clientX,startY:$.clientY,currentX:$.clientX,currentY:$.clientY,isHorizontal:null,isTracking:!0}},R=L=>{const $=S.current;if(!$?.isTracking)return;const Q=L.touches[0],ue=Q.clientX-$.startX,fe=Q.clientY-$.startY;if($.isHorizontal===null){if(Math.abs(ue)>20||Math.abs(fe)>20){const de=Math.abs(ue)>Math.abs(fe);$.isHorizontal=de,de?(ue>0?!!o:!!n)?w(!0):$.isTracking=!1:(fe>0?l:s)||($.isTracking=!1)}return}$.isHorizontal?(f&&L.cancelable&&L.preventDefault(),$.currentX=Q.clientX,b(Q.clientX-$.startX)):$.currentY=Q.clientY},z=()=>{const L=S.current;if(!L?.isTracking){C();return}const $=L.currentX-L.startX,Q=L.currentY-L.startY,ue=c||window.innerWidth*.25;let fe=!1;L.isHorizontal===!0?$<-ue&&n?(n(),fe=!0):$>ue&&o&&(o(),fe=!0):L.isHorizontal===!1&&(Q<-ue&&s?(s(),fe=!0):Q>ue&&l&&(l(),fe=!0)),fe?m?(S.current=null,w(!1),j.current!==null&&window.clearTimeout(j.current),j.current=window.setTimeout(()=>{C(),j.current=null},p)):requestAnimationFrame(()=>{C()}):C()};return document.addEventListener("touchstart",U,{passive:!0}),document.addEventListener("touchmove",R,{passive:!1}),document.addEventListener("touchend",z,{passive:!0}),document.addEventListener("touchcancel",z,{passive:!0}),()=>{document.removeEventListener("touchstart",U),document.removeEventListener("touchmove",R),document.removeEventListener("touchend",z),document.removeEventListener("touchcancel",z),j.current!==null&&(window.clearTimeout(j.current),j.current=null),C()}},[k,n,o,s,l,c,f,m,p,C]),{swipeOffset:g,isSwiping:x,setSwipeEnabled:T,resetSwipeState:C}}function Gy({idPrefix:n,title:o,items:s,selectedValue:l,onSelect:i,gridClassName:c="grid grid-cols-2 gap-2",buttonClassName:f=""}){return u.jsxs("div",{id:`${n}-container`,children:[u.jsx("h4",{id:`${n}-label`,className:"text-sm font-medium text-gray-700 mb-2",children:o}),u.jsx("div",{id:`${n}-options`,className:c,children:s.map(m=>{const p=l===m.value;return u.jsxs("button",{className:`px-3 py-2 rounded-lg text-sm border ${f} ${p?"bg-blue-500 border-blue-500 text-white shadow-sm":"border-gray-200 text-gray-700 hover:bg-gray-50"}`,onClick:()=>i(m.value),children:[m.label,p&&m.suffix?m.suffix:""]},m.value)})})]})}function Tk({checked:n,onChange:o}){return u.jsxs("div",{id:"favorites-toggle-container",className:"flex items-center gap-2",children:[u.jsx("input",{type:"checkbox",id:"favOnly",checked:n,onChange:s=>o(s.target.checked),className:"rounded text-blue-600 focus:ring-blue-500"}),u.jsx("label",{htmlFor:"favOnly",className:"text-sm text-gray-700",children:"Show Favorites Only"})]})}function Ek({open:n,onClose:o,filter:s,sort:l,onChangeFilter:i,onChangeSort:c}){if(!n)return null;const f=l?.mode||"modified",m=f.includes("name")?"name":f.includes("size")?"size":"date",p=(()=>{const b=f.endsWith("reverse");return m==="date"?b?"asc":"desc":b?"desc":"asc"})(),g=(b,x)=>{let w;b==="name"?w=x==="asc"?"name":"name-reverse":b==="size"?w=x==="asc"?"size":"size-reverse":w=x==="desc"?"modified":"modified-reverse",c({mode:w})};return u.jsx("div",{id:"filter-modal-root",className:"fixed inset-0 z-[1600] bg-black/50 flex items-center justify-center p-4",onClick:o,children:u.jsxs("div",{id:"filter-modal-content",className:"bg-white rounded-xl shadow-lg w-full max-w-sm max-h-[90vh] overflow-y-auto",onClick:b=>b.stopPropagation(),children:[u.jsxs("div",{id:"filter-modal-header",className:"p-4 border-b border-gray-100 flex items-center justify-between",children:[u.jsx("h3",{id:"filter-modal-title",className:"font-semibold text-gray-900",children:"Filter & Sort"}),u.jsx(xa,{variant:"plain",onClick:o,buttonSize:8,iconSize:6})]}),u.jsxs("div",{id:"filter-modal-body",className:"p-4 space-y-6",children:[u.jsx(Gy,{idPrefix:"sort-group",title:"Sort By",items:[{value:"name",label:"Name",suffix:m==="name"?p==="asc"?" ":" ":void 0},{value:"date",label:"Date",suffix:m==="date"?p==="asc"?" ":" ":void 0},{value:"size",label:"Size",suffix:m==="size"?p==="asc"?" ":" ":void 0}],selectedValue:m,onSelect:b=>{g(b,m===b?p==="asc"?"desc":"asc":b==="name"?"asc":"desc")}}),u.jsx(Gy,{idPrefix:"filter-type-group",title:"File Type",items:[{value:"all",label:"All"},{value:"image",label:"Image"},{value:"video",label:"Video"}],selectedValue:s.type,onSelect:b=>i({type:b}),gridClassName:"flex gap-2",buttonClassName:"flex-1"}),u.jsxs("div",{id:"search-input-container",children:[u.jsx("label",{id:"search-input-label",className:"block text-sm font-medium text-gray-700 mb-1",children:"Search"}),u.jsx(ja,{placeholder:"Search by filename...",value:s.search,onChange:b=>i({search:b})})]}),u.jsx(Tk,{checked:s.favoritesOnly,onChange:b=>i({favoritesOnly:b})})]}),u.jsx("div",{id:"filter-modal-footer",className:"p-4 border-t border-gray-100 bg-gray-50 flex justify-end",children:u.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700",onClick:o,children:"Apply"})})]})})}function au({onClose:n,zIndex:o=2200,children:s}){return u.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4",style:{zIndex:o},onClick:n,role:"dialog","aria-modal":"true",children:u.jsx("div",{className:"w-full max-w-sm bg-white border border-gray-200 rounded-xl shadow-lg overflow-hidden",onClick:l=>l.stopPropagation(),children:s})})}function Ik({breadcrumbs:n,selectionMode:o,selectedCount:s,onClearSelection:l}){return u.jsx("div",{id:"outputs-panel-header",className:"px-4 py-3 flex flex-col gap-3 border-b border-gray-100",children:u.jsxs("div",{id:"outputs-header-top-row",className:"flex items-center justify-between min-h-[24px]",children:[n,o&&u.jsxs("div",{className:"selection-status-container flex items-center gap-2 shrink-0 ml-2",children:[u.jsxs("span",{className:"text-[10px] font-bold text-blue-600 uppercase",children:[s," selected"]}),u.jsx("button",{onClick:l,className:"text-[10px] text-gray-500 underline uppercase font-bold",children:"Clear"})]})]})})}function Xf({file:n,viewMode:o,selectionMode:s,isSelected:l,isFavorited:i,onNavigateFolder:c,onOpen:f,onMenu:m,onToggleSelection:p}){const g=n.type==="folder",[b,x]=y.useState(!1);y.useEffect(()=>{x(!1)},[n.previewUrl,n.id]);const w=()=>{s?p(n.id):g?c(n.name):f(n)},k=N=>{N.stopPropagation(),m(n,N)};return o==="list"?u.jsxs("div",{className:`file-card-list-item flex items-center gap-3 p-2 hover:bg-gray-50 border-b border-gray-100 last:border-0 ${l?"bg-blue-50":""}`,onClick:w,children:[s&&u.jsx("div",{className:`selection-checkbox w-5 h-5 rounded border flex items-center justify-center flex-shrink-0 ${l?"bg-blue-600 border-blue-600 text-white":"border-gray-300 bg-white"}`,children:l&&u.jsx(Do,{className:"w-3.5 h-3.5"})}),u.jsx("div",{className:`file-preview-container w-10 h-10 flex-shrink-0 flex items-center justify-center rounded text-gray-500 overflow-hidden relative ${g?"":"bg-gray-100"}`,children:g?u.jsx(hr,{className:"w-6 h-6 text-amber-500"}):n.previewUrl&&!b?u.jsx("img",{src:n.previewUrl,className:"w-full h-full object-cover",loading:"lazy",onError:()=>x(!0)}):n.type==="video"?u.jsx(K0,{className:"w-5 h-5 text-gray-500"}):u.jsx("span",{className:"text-xs font-bold",children:"IMG"})}),u.jsx("div",{className:"file-info-container flex-1 min-w-0",children:u.jsx("div",{className:"file-name text-sm font-medium text-gray-900 truncate",children:n.name})}),u.jsxs("div",{className:"file-actions-container flex items-center gap-2",children:[i&&u.jsx(Gr,{className:"w-4 h-4 text-yellow-500"}),u.jsx(Pr,{onClick:k,ariaLabel:"File options",buttonSize:8,iconSize:5})]})]}):u.jsxs("div",{className:"file-card-grid-item flex flex-col gap-1",children:[u.jsxs("div",{className:`relative aspect-square bg-gray-100 rounded-lg overflow-hidden transition-all ${l?"ring-4 ring-blue-500 ring-offset-2":""}`,onClick:w,children:[g?u.jsx("div",{className:"folder-grid-content w-full h-full flex flex-col items-center justify-center text-gray-500",children:u.jsx(hr,{className:"w-12 h-12 mb-2 text-amber-500"})}):n.previewUrl&&!b?u.jsx("img",{src:n.previewUrl,className:"w-full h-full object-cover",loading:"lazy",onError:()=>x(!0)}):u.jsx("div",{className:"media-placeholder w-full h-full flex items-center justify-center bg-gray-800 text-white font-bold",children:n.type==="video"?u.jsx(K0,{className:"w-10 h-10 text-white/80"}):"IMG"}),s?u.jsx("div",{className:"selection-badge-container absolute top-2 left-2",children:u.jsx("div",{className:`selection-badge w-6 h-6 rounded-full border-2 flex items-center justify-center shadow-sm ${l?"bg-blue-600 border-blue-600 text-white":"border-white bg-black/20"}`,children:l&&u.jsx(Do,{className:"w-4 h-4"})})}):u.jsxs("div",{className:"file-menu-trigger-container absolute top-1 right-1 flex flex-col items-center gap-1 text-white",children:[u.jsx(Pr,{onClick:k,ariaLabel:"File options",buttonSize:7,iconSize:4}),i&&u.jsx(Gr,{className:"w-4 h-4 text-yellow-400 drop-shadow"})]}),n.type==="video"&&u.jsx("div",{className:"video-label absolute top-1 left-1 bg-black/50 px-1 rounded text-[10px] text-white",children:"VID"})]}),u.jsx("div",{className:"file-name text-xs text-gray-700 truncate px-1",children:n.name})]})}function Lk({folders:n,foldersCollapsed:o,toggleFoldersCollapsed:s,selectionMode:l,selectedIds:i,favorites:c,setCurrentFolder:f,handleOpen:m,handleMenu:p,toggleSelection:g}){return n.length===0?null:u.jsxs("div",{id:"outputs-folders-section",className:"mb-4",children:[u.jsxs("button",{onClick:s,className:"flex items-center gap-2 w-full text-left mb-2 py-1 text-sm font-medium text-gray-600 hover:text-gray-900",children:[o?u.jsx(pp,{className:"w-4 h-4"}):u.jsx(vu,{className:"w-4 h-4"}),u.jsxs("span",{children:["Folders (",n.length,")"]})]}),!o&&u.jsx("div",{className:"flex flex-col border border-gray-200 rounded-lg overflow-hidden",children:n.map(b=>u.jsx(Xf,{file:b,viewMode:"list",selectionMode:l,isSelected:i.includes(b.id),isFavorited:c.includes(b.id),onNavigateFolder:f,onOpen:m,onMenu:p,onToggleSelection:g},b.id))})]})}function Ak({fileSections:n,collapsedSections:o,viewMode:s,selectionMode:l,selectedIds:i,favorites:c,setCurrentFolder:f,handleOpen:m,handleMenu:p,toggleSelection:g,toggleSectionCollapsed:b,selectIds:x}){return u.jsx("div",{id:"outputs-files-section",className:"flex flex-col gap-4",children:n.map(w=>u.jsxs("div",{className:"flex flex-col gap-2",children:[u.jsxs("div",{className:"flex items-center justify-between gap-3",children:[u.jsxs("button",{className:"flex items-center gap-2 text-[11px] font-semibold uppercase tracking-wide text-gray-500 hover:text-gray-800",onClick:()=>b(w.key),children:[o[w.key]?u.jsx(pp,{className:"w-3.5 h-3.5"}):u.jsx(vu,{className:"w-3.5 h-3.5"}),u.jsxs("span",{children:[w.label," (",w.files.length,")"]})]}),l&&u.jsx("button",{className:"text-[10px] font-bold uppercase text-blue-600 hover:text-blue-700",onClick:()=>x(w.files.map(k=>k.id)),children:"Select all"})]}),!o[w.key]&&(s==="grid"?u.jsx("div",{className:"grid grid-cols-2 gap-4 auto-rows-min",children:w.files.map(k=>u.jsx(Xf,{file:k,viewMode:s,selectionMode:l,isSelected:i.includes(k.id),isFavorited:c.includes(k.id),onNavigateFolder:f,onOpen:m,onMenu:p,onToggleSelection:g},k.id))}):u.jsx("div",{className:"flex flex-col",children:w.files.map(k=>u.jsx(Xf,{file:k,viewMode:s,selectionMode:l,isSelected:i.includes(k.id),isFavorited:c.includes(k.id),onNavigateFolder:f,onOpen:m,onMenu:p,onToggleSelection:g},k.id))}))]},w.key))})}function Rk({menuTarget:n,favorites:o,setMenuTarget:s,menuRef:l,menuStyle:i,handleFavorite:c,handleSelectSingle:f,handleMoveSingle:m,handleRenameRequest:p,handleLoadWorkflow:g,handleLoadInWorkflow:b,handleDeleteRequest:x}){if(!n)return null;const w=[{key:"favorite",label:o.includes(n.file.id)?"Unfavorite":"Favorite",icon:o.includes(n.file.id)?u.jsx(Gr,{className:"w-4 h-4"}):u.jsx(_u,{className:"w-4 h-4"}),onClick:()=>c()},{key:"select",label:"Select",icon:u.jsx(Do,{className:"w-4 h-4"}),onClick:()=>f()},{key:"move",label:"Move",icon:u.jsx(hr,{className:"w-4 h-4"}),onClick:()=>m()},{key:"rename",label:"Rename",icon:u.jsx(cp,{className:"w-4 h-4"}),onClick:()=>p()},{key:"load-workflow",label:"Load workflow",icon:u.jsx(bs,{className:"w-4 h-4"}),onClick:()=>g(),hidden:n.file.type!=="image"},{key:"use-in-workflow",label:"Use in workflow",icon:u.jsx(cb,{className:"w-4 h-4"}),onClick:()=>b(),hidden:n.file.type!=="image"},{key:"delete",label:"Delete",icon:u.jsx(Bo,{className:"w-4 h-4"}),onClick:()=>x(),color:"danger"}];return u.jsxs(u.Fragment,{children:[u.jsx("div",{id:"outputs-context-menu-overlay",className:"fixed inset-0 z-[1690]",onClick:()=>s(null),onPointerDown:k=>k.stopPropagation()}),u.jsx("div",{id:"outputs-context-menu",ref:l,className:"fixed z-[1700] min-w-44 w-max",style:i,onPointerDown:k=>k.stopPropagation(),onClick:k=>k.stopPropagation(),children:u.jsx(gr,{items:w})})]})}const Py="outputs-folders-collapsed",_k=1440*60*1e3;function Dk(n){if(!n)return"Unknown date";const o=new Date,s=new Date(o.getFullYear(),o.getMonth(),o.getDate()),l=new Date(n),i=new Date(l.getFullYear(),l.getMonth(),l.getDate()),c=Math.round((s.getTime()-i.getTime())/_k);return c===0?"Today":c===1?"Yesterday":l.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})}function Bk({visible:n}){const{source:o,currentFolder:s,isLoading:l,viewMode:i,showHidden:c,filter:f,sort:m,favorites:p,selectionMode:g,selectedIds:b,setCurrentFolder:x,navigateToPath:w,fetchFolders:k,fetchFiles:N,toggleFavorite:S,toggleSelection:j,getDisplayedFiles:C,refresh:T,selectIds:V,toggleSelectionMode:U,setFilter:R,setSort:z}=Wt(),L=Wt(we=>we.selectionActionOpen),$=Wt(we=>we.setSelectionActionOpen),Q=Wt(we=>we.filterModalOpen),ue=Wt(we=>we.setFilterModalOpen),fe=Wt(we=>we.newFolderModalOpen),de=Wt(we=>we.setNewFolderModalOpen),Ie=Wt(we=>we.setOutputsViewerOpen),je=Wt(we=>we.addFavorites),Me=Wt(we=>we.removeFavorites),_=Wt(we=>we.clearSelection),oe=ae(we=>we.loadWorkflow),ce=no(we=>we.setCurrentPanel),Ke=ae(we=>we.workflow),Le=ae(we=>we.originalWorkflow),E=y.useMemo(()=>!!(Ke&&Le&&JSON.stringify(Ke)!==JSON.stringify(Le)),[Ke,Le]),[A,M]=y.useState(null),[ee,Te]=y.useState(null),[qe,ye]=y.useState(null),[Ne,H]=y.useState(null),[Y,D]=y.useState(!1),[K,X]=y.useState(null),[W,Oe]=y.useState(""),[be,ke]=y.useState(!1),[J,xe]=y.useState(!1),[I,B]=y.useState(null),[q,he]=y.useState([]),[me,Se]=y.useState(!1),[F,ie]=y.useState(""),[Ae,Ue]=y.useState([]),[Je,Pe]=y.useState(null),[st,$e]=y.useState(""),[Fe,at]=y.useState(!1),[ht,Lt]=y.useState([]),[Gt,Pt]=y.useState(0),$t=y.useRef(null),Ge=y.useRef(null),He=y.useRef(!1),[Ve,et]=y.useState(()=>localStorage.getItem(Py)==="true"),[ft,St]=y.useState({}),zt=y.useRef(null),le=y.useRef(null),se=y.useRef(!1),De=()=>{Te(null),zt.current=null},Ze=()=>{D(!1),ye(null),le.current=null},Qe=(we,lt)=>{zt.current=lt?.onDeleted??null,Te(we)},rt=(we,lt)=>{we.type==="image"&&(le.current=lt?.onLoaded??null,ye(we),D(!0))},{menuStyle:Re,resetMenuPosition:gt}=mp({open:!!A,buttonRef:Ge,menuRef:$t,repositionToken:A?.file.id,menuWidth:176,horizontalAnchorOffset:160,viewportPadding:8,bottomBarReserve:104});cl({open:!!A,onDismiss:()=>{M(null),gt()},triggerRef:Ge,contentRef:$t}),y.useEffect(()=>{He.current=!1},[o]),y.useEffect(()=>{n&&!He.current&&!l&&(He.current=!0,k(),N())},[n,k,N,l]),y.useEffect(()=>{!n&&Fe&&(at(!1),Ie(!1))},[n,Fe,Ie]),y.useEffect(()=>{!n&&Q&&ue(!1)},[n,Q,ue]);const bt=C(),it=Wt(we=>we.sort.mode),xt=we=>{const yt=C().filter(Ht=>(Ht.type==="image"||Ht.type==="video")&&Ht.fullUrl),fn=yt.map(Ht=>({src:Ht.fullUrl,alt:Ht.name,mediaType:Oa(Ht.name),file:Ht,filename:Ht.name})),Cn=yt.findIndex(Ht=>Ht.id===we.id);Cn>=0&&(Lt(fn),Pt(Cn),at(!0),Ie(!0))},Nt=()=>{at(!1),Ie(!1)},ct=we=>{we.file&&Qe(we.file,{onDeleted:lt=>{Lt(yt=>{const fn=yt.findIndex(Ht=>Ht.file?.id===lt.id),Cn=yt.filter(Ht=>Ht.file?.id!==lt.id);return Pt(Ht=>Cn.length===0?0:fn===-1?Ht:fn<Ht?Ht-1:fn===Ht?Math.min(Ht,Cn.length-1):Ht),Cn.length===0&&(at(!1),Ie(!1)),Cn})}})},jt=we=>{!we.file||we.file.type!=="image"||rt(we.file,{onLoaded:()=>{at(!1),Ie(!1)}})},pt=we=>{we.file&&Ln(we.file,{closeViewer:!0})},{folders:At,nonFolders:tn}=y.useMemo(()=>{const we=[],lt=[];for(const yt of bt)yt.type==="folder"?we.push(yt):lt.push(yt);return{folders:we,nonFolders:lt}},[bt]),In=it.startsWith("name"),cn=it.startsWith("size"),P=f.favoritesOnly||!In&&!cn,Ee=y.useMemo(()=>{if(In){const lt=[];for(const yt of tn){const fn=yt.name?.trim()?.charAt(0).toUpperCase()||"#",Cn=`Starting with ${fn}`,Ht=lt[lt.length-1];Ht&&Ht.key===fn?Ht.files.push(yt):lt.push({key:fn,label:Cn,files:[yt]})}return lt}if(cn){const lt=[];for(const yt of tn){const Cn=(yt.size??0)/(1024*1024),Ht=Cn<1?0:Math.round(Cn),yo=Ht===0?"<1MB":`${Ht}MB`,hl=Ht===0?"<1MB":`${Ht}MB`,Yr=lt[lt.length-1];Yr&&Yr.key===yo?Yr.files.push(yt):lt.push({key:yo,label:hl,files:[yt]})}return lt}if(!P)return[{key:"all",label:"All files",files:tn}];const we=[];for(const lt of tn){const yt=lt.date?new Date(lt.date).toISOString().slice(0,10):"unknown",fn=Dk(lt.date),Cn=we[we.length-1];Cn&&Cn.key===yt?Cn.files.push(lt):we.push({key:yt,label:fn,files:[lt]})}return we},[tn,P,In,cn]),ne=()=>{const we=!Ve;et(we),localStorage.setItem(Py,String(we))},ot=we=>{St(lt=>({...lt,[we]:!lt[we]}))},tt=we=>{xt(we)},Xe=(we,lt)=>{lt.preventDefault(),lt.stopPropagation(),Ge.current=lt.currentTarget,M({file:we})},Ye=()=>{A&&(S(A.file.id),M(null))},te=()=>{A&&(g||U(),V([A.file.id],"replace"),M(null))},We=()=>{A&&A.file.type==="image"&&(ye(A.file),D(!0),M(null))},nt=()=>{A&&(Te(A.file),M(null))},ut=()=>{A&&(X(A.file),Oe(A.file.name),M(null))},_t=()=>{b.length!==0&&($(!1),ke(!0))},nn=async(we,lt)=>{try{await Sx({file:we,source:o,loadWorkflow:oe,onLoaded:()=>{ce("workflow"),lt?.closeViewer&&(at(!1),Ie(!1))}})}catch(yt){console.error("Failed to load workflow from file:",yt),window.alert("Failed to load workflow from file.")}},Ln=(we,lt)=>{if(we.type==="folder"){window.alert("Workflow metadata is not available for folders.");return}if(E){se.current=!!lt?.closeViewer,H(we);return}nn(we,lt)},an=()=>{if(!A)return;const we=A.file;M(null),Ln(we,{closeViewer:!1})},An=async()=>{if(!Ne)return;const we=Ne,lt=se.current;se.current=!1,H(null),await nn(we,{closeViewer:lt})},Sn=()=>{se.current=!1,H(null)},Nn=async()=>{if(!ee)return;const we=ee;try{const lt=ul(ee,o);await Of(lt,o),T(),zt.current?.(we),zt.current=null}catch(lt){console.error("Failed to delete file:",lt),window.alert("Failed to delete file.")}finally{Te(null)}},Ea=async()=>{if(b.length===0){ke(!1);return}try{const we=`${o}/`,lt=b.map(yt=>yt.startsWith(we)?yt.slice(we.length):yt);await Promise.all(lt.map(yt=>Of(yt,o))),T(),_()}catch(we){console.error("Failed to delete selected files:",we),window.alert("Failed to delete selected files.")}finally{ke(!1)}},Uu=()=>{if(b.length===0)return;b.every(lt=>p.includes(lt))?Me(b):je(b),$(!1)},fl=()=>{b.length!==0&&($(!1),Ue([...b]),Pe(s),B(s),xe(!0))},Ia=()=>{A&&(Ue([A.file.id]),Pe(s),B(s),xe(!0),M(null))},Qo=()=>{X(null),Oe("")},La=async()=>{if(!K)return;const we=W.trim();if(we){if(we===K.name){Qo();return}try{const lt=ul(K,o);await sw(lt,we,o),T(),Qo()}catch(lt){console.error("Failed to rename item:",lt),window.alert("Failed to rename item.")}}},Kn=()=>{xe(!1),Ue([]),Pe(null)},pl=async()=>{if(Ae.length!==0)try{const we=`${o}/`,lt=Ae.map(yt=>yt.startsWith(we)?yt.slice(we.length):yt);await rw(lt,I,o),T(),g&&(_(),U())}catch(we){console.error("Failed to move selected files:",we),window.alert("Failed to move selected files.")}finally{Kn()}},Aa=async()=>{const we=F.trim();if(!we)return;const lt=I?`${I}/${we}`:we;try{await N0(lt,o),ie(""),Se(!0);const yt=await Mf(o,1e3,0,"modified",!1,I,c);he(yt.filter(fn=>fn.type==="folder"))}catch(yt){console.error("Failed to create folder:",yt),window.alert("Failed to create folder.")}finally{Se(!1)}},xs=async()=>{const we=st.trim();if(!we)return;const lt=s?`${s}/${we}`:we;try{await N0(lt,o),$e(""),de(!1),T()}catch(yt){console.error("Failed to create folder:",yt),window.alert("Failed to create folder.")}},ro=y.useMemo(()=>{const lt=[{name:o==="output"?"Outputs":"Inputs",path:null}];if(s){const yt=s.split("/");yt.forEach((fn,Cn)=>{lt.push({name:fn,path:yt.slice(0,Cn+1).join("/")})})}return lt},[o,s]),Ra=()=>{const we=ro.length,lt=[];return we<=3?ro.forEach((yt,fn)=>{lt.push({...yt,isClickable:fn<we-1})}):(lt.push({...ro[0],isClickable:!0}),lt.push({name:"...",path:ro[we-3].path,isEllipsis:!0,isClickable:!0}),lt.push({...ro[we-2],isClickable:!0}),lt.push({...ro[we-1],isClickable:!1})),u.jsx("div",{id:"outputs-breadcrumb-trail",className:"flex items-center text-sm overflow-hidden whitespace-nowrap",children:lt.map((yt,fn)=>u.jsxs("div",{className:"flex items-center min-w-0",children:[fn>0&&u.jsx("span",{className:"mx-1.5 text-gray-400 shrink-0",children:"/"}),u.jsx("button",{onClick:()=>yt.isClickable&&w(yt.path),disabled:!yt.isClickable,className:`
                truncate transition-colors
                ${yt.isClickable?"text-blue-600 hover:text-blue-700 active:opacity-70":"text-gray-700 font-medium"}
                ${yt.isEllipsis?"px-1 bg-gray-100 rounded":""}
              `,title:yt.name,children:yt.name})]},fn))})};y.useEffect(()=>{if(!J)return;let we=!1;return(async()=>{Se(!0);try{const yt=await Mf(o,1e3,0,"modified",!1,I,c);if(we)return;he(yt.filter(fn=>fn.type==="folder"))}catch(yt){if(we)return;console.error("Failed to load folders:",yt),he([])}finally{we||Se(!1)}})(),()=>{we=!0}},[J,I,o,c]),y.useEffect(()=>{L&&b.length===0&&$(!1)},[L,b.length,$]);const _a=()=>{const we=Wt.getState();we.clearSelection(),we.toggleSelectionMode()},wr=()=>{if(!I)return;const we=I.split("/");we.pop(),B(we.length?we.join("/"):null)},$u=we=>()=>{B(I?`${I}/${we}`:we)};return u.jsx("div",{id:"outputs-panel-wrapper",className:"absolute inset-x-0 top-[60px] bottom-0",style:{display:n?"block":"none"},children:u.jsxs("div",{id:"outputs-panel-root",className:"h-full bg-white flex flex-col pt-[4px] pb-[80px]",children:[u.jsx(Ik,{breadcrumbs:Ra(),selectionMode:g,selectedCount:b.length,onClearSelection:_a}),u.jsxs("div",{id:"outputs-content-container",className:"flex-1 overflow-y-auto p-4",children:[u.jsx(Lk,{folders:At,foldersCollapsed:Ve,toggleFoldersCollapsed:ne,selectionMode:g,selectedIds:b,favorites:p,setCurrentFolder:x,handleOpen:tt,handleMenu:Xe,toggleSelection:j}),u.jsx(Ak,{fileSections:Ee,collapsedSections:ft,viewMode:i,selectionMode:g,selectedIds:b,favorites:p,setCurrentFolder:x,handleOpen:tt,handleMenu:Xe,toggleSelection:j,toggleSectionCollapsed:ot,selectIds:V}),l&&u.jsx("div",{id:"outputs-loading-indicator",className:"py-4 flex justify-center",children:u.jsx("span",{className:"text-gray-400 text-sm",children:"Loading..."})}),!l&&bt.length===0&&u.jsx("div",{id:"outputs-empty-message",className:"text-center text-gray-400 py-8",children:s?"No images in this folder":o==="output"?"No generated images yet":"No imported images"})]}),u.jsx(Rk,{menuTarget:A,favorites:p,setMenuTarget:M,menuRef:$t,menuStyle:Re,handleFavorite:Ye,handleSelectSingle:te,handleMoveSingle:Ia,handleRenameRequest:ut,handleLoadWorkflow:an,handleLoadInWorkflow:We,handleDeleteRequest:nt}),L&&u.jsxs(au,{onClose:()=>$(!1),zIndex:1800,children:[u.jsxs("div",{className:"px-4 py-3 text-sm font-semibold text-gray-700 border-b border-gray-100",children:[b.length," selected"]}),u.jsxs("button",{className:"w-full text-left px-4 py-3 text-sm hover:bg-gray-50 flex items-center gap-2",onClick:Uu,children:[b.every(we=>p.includes(we))?u.jsx(_u,{className:"w-4 h-4"}):u.jsx(Gr,{className:"w-4 h-4"}),b.every(we=>p.includes(we))?"Unfavorite":"Favorite"]}),u.jsxs("button",{className:"w-full text-left px-4 py-3 text-sm hover:bg-gray-50 flex items-center gap-2",onClick:fl,children:[u.jsx(hr,{className:"w-4 h-4 text-gray-500"}),"Move"]}),u.jsxs("button",{className:"w-full text-left px-4 py-3 text-sm text-red-600 hover:bg-red-50 flex items-center gap-2",onClick:_t,children:[u.jsx(Bo,{className:"w-4 h-4"}),"Delete"]}),u.jsx("button",{className:"w-full text-left px-4 py-3 text-sm text-gray-600 hover:bg-gray-50",onClick:()=>$(!1),children:"Cancel"})]}),J&&u.jsxs(au,{onClose:Kn,zIndex:1850,children:[u.jsx("div",{className:"px-4 py-3 text-sm font-semibold text-gray-700 border-b border-gray-100",children:I!==Je?u.jsxs(u.Fragment,{children:["Move to ",u.jsx(hr,{className:"w-4 h-4 text-amber-500 inline"})," ",I||"root"]}):"Move to..."}),u.jsxs("div",{className:"max-h-[50vh] overflow-y-auto",children:[me&&u.jsx("div",{className:"px-4 py-3 text-sm text-gray-400",children:"Loading folders..."}),!me&&I&&u.jsx("button",{className:"w-full text-left px-4 py-3 text-sm hover:bg-gray-50 flex items-center gap-2",onClick:wr,children:u.jsx("span",{className:"text-gray-500",children:".."})}),!me&&q.filter(we=>!Ae.includes(we.id)).length===0&&u.jsx("div",{className:"px-4 py-3 text-sm text-gray-400",children:"No folders"}),!me&&q.filter(we=>!Ae.includes(we.id)).map(we=>u.jsxs("button",{className:"w-full text-left px-4 py-3 text-sm hover:bg-gray-50 flex items-center gap-2",onClick:$u(we.name),children:[u.jsx(hr,{className:"w-4 h-4 text-amber-500"}),we.name]},we.id)),u.jsx("div",{className:"px-4 py-3 border-t border-gray-100",children:u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("input",{value:F,onChange:we=>ie(we.target.value),placeholder:"New folder",className:"flex-1 border border-gray-200 rounded-lg px-3 py-2 text-sm"}),u.jsx("button",{className:"px-3 py-2 text-sm font-medium text-blue-600 hover:text-blue-700",onClick:Aa,children:"Create"})]})})]}),u.jsxs("div",{className:"px-4 py-3 border-t border-gray-100 flex justify-end gap-2",children:[u.jsx("button",{className:"px-3 py-2 text-sm font-medium text-gray-600 hover:bg-gray-100 rounded-lg",onClick:Kn,children:"Cancel"}),u.jsx("button",{className:`px-3 py-2 text-sm font-medium rounded-lg ${I!==Je?"text-white bg-blue-600 hover:bg-blue-700":"text-gray-400 bg-gray-200 cursor-not-allowed"}`,onClick:pl,disabled:I===Je,children:"Submit"})]})]}),ee&&u.jsx(Po,{onClose:De,title:"Delete file?",description:ee.type==="folder"?`This will permanently delete the folder "${ee.name}" and all of its contents from the server. This cannot be undone.`:`This will permanently delete "${ee.name}" from the server. This cannot be undone.`,actions:[{label:"Cancel",onClick:De,className:"px-3 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-100"},{label:"Delete",onClick:Nn,className:"px-3 py-2 rounded-lg text-sm font-medium text-white bg-red-600 hover:bg-red-700"}]}),be&&u.jsx(Po,{onClose:()=>ke(!1),title:"Delete selected files?",description:`This will permanently delete ${b.length} selected file${b.length===1?"":"s"} from the server. This cannot be undone.`,zIndex:1800,actions:[{label:"Cancel",onClick:()=>ke(!1),className:"px-3 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-100"},{label:"Delete",onClick:Ea,className:"px-3 py-2 rounded-lg text-sm font-medium text-white bg-red-600 hover:bg-red-700"}]}),K&&u.jsx(au,{onClose:Qo,zIndex:1850,children:u.jsxs("div",{className:"p-4",children:[u.jsxs("div",{className:"text-gray-900 text-base font-semibold",children:["Rename ",K.type==="folder"?"folder":"file"]}),u.jsxs("div",{className:"text-gray-600 text-sm mt-1 truncate",children:["Current: ",K.name]}),u.jsx("input",{value:W,onChange:we=>Oe(we.target.value),onKeyDown:we=>{we.key==="Enter"&&La()},placeholder:K.type==="folder"?"Folder name":"File name",className:"mt-3 w-full border border-gray-200 rounded-lg px-3 py-2 text-sm",autoFocus:!0}),u.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[u.jsx("button",{className:"px-3 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-100",onClick:Qo,children:"Cancel"}),u.jsx("button",{className:`px-3 py-2 rounded-lg text-sm font-medium ${W.trim()&&W.trim()!==K.name?"text-white bg-blue-600 hover:bg-blue-700":"text-gray-400 bg-gray-200 cursor-not-allowed"}`,onClick:()=>{La()},disabled:!W.trim()||W.trim()===K.name,children:"Rename"})]})]})}),fe&&u.jsx(au,{onClose:()=>{de(!1),$e("")},zIndex:1850,children:u.jsxs("div",{className:"p-4",children:[u.jsx("div",{className:"text-gray-900 text-base font-semibold",children:"New folder"}),u.jsxs("div",{className:"text-gray-600 text-sm mt-1",children:["Create a new folder in ",s?u.jsxs(u.Fragment,{children:[u.jsx(hr,{className:"w-3.5 h-3.5 text-amber-500 inline"})," ",s]}):"root"]}),u.jsx("input",{value:st,onChange:we=>$e(we.target.value),onKeyDown:we=>{we.key==="Enter"&&xs()},placeholder:"Folder name",className:"mt-3 w-full border border-gray-200 rounded-lg px-3 py-2 text-sm",autoFocus:!0}),u.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[u.jsx("button",{className:"px-3 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-100",onClick:()=>{de(!1),$e("")},children:"Cancel"}),u.jsx("button",{className:`px-3 py-2 rounded-lg text-sm font-medium ${st.trim()?"text-white bg-blue-600 hover:bg-blue-700":"text-gray-400 bg-gray-200 cursor-not-allowed"}`,onClick:xs,disabled:!st.trim(),children:"Create"})]})]})}),u.jsx(Nx,{open:Y,file:qe,source:o,onClose:Ze,onLoaded:()=>{D(!1),ye(null),le.current?.(),le.current=null}}),u.jsx(Ek,{open:Q,onClose:()=>ue(!1),filter:f,sort:m,onChangeFilter:R,onChangeSort:z}),Ne&&En.createPortal(u.jsx(Po,{onClose:Sn,title:"Unsaved changes",description:"Are you sure you want to load this workflow? You have unsaved changes.",actions:[{label:"Cancel",onClick:Sn,className:"px-3 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-100"},{label:"Continue",onClick:()=>{An()},className:"px-3 py-2 rounded-lg text-sm font-medium text-white bg-red-600 hover:bg-red-700"}]}),document.body),u.jsx(wx,{open:Fe,items:ht,index:Gt,onClose:Nt,onIndexChange:Pt,onDelete:ct,onLoadInWorkflow:jt,onLoadWorkflow:pt,showMetadataToggle:!0})]})})}function zk(){const n=no(_=>_.currentPanel),o=no(_=>_.setCurrentPanel),s=Lf(_=>_.appMenuOpen),l=Mo(_=>_.viewerOpen),i=Mo(_=>_.setViewerState),c=ae(_=>_.followQueue),f=ae(_=>_.setFollowQueue),m=Gn(_=>_.bookmarkRepositioningActive),p=y.useRef(null),{isInputFocused:g}=vx(),b=Wt(_=>_.outputsViewerOpen),x=Wt(_=>_.selectionMode),w=Wt(_=>_.filterModalOpen),k=Wt(_=>_.selectionActionOpen),N=Wt(_=>_.currentFolder),S=Wt(_=>_.navigateUp);Mk();const j=y.useCallback(()=>{n==="workflow"?o("queue"):n==="outputs"&&o("workflow")},[n,o]),C=y.useCallback(()=>{n==="outputs"&&N?S():n==="workflow"?o("outputs"):n==="queue"&&o("workflow")},[n,N,S,o]),T=n==="workflow"||n==="outputs",V=n==="workflow"||n==="queue"||n==="outputs"&&!!N,{swipeOffset:U,isSwiping:R,setSwipeEnabled:z,resetSwipeState:L}=Ok({onSwipeLeft:T?j:void 0,onSwipeRight:V?C:void 0,enabled:!g&&!l&&!s&&!b&&!m&&!x&&!w&&!k}),$=ae(_=>_.setNodeTypes),Q=al(_=>_.theme),ue=ae(_=>_.workflowLoadedAt),fe=It(_=>_.fetchQueue),de=Pn(_=>_.history);y.useEffect(()=>{!R&&U!==0&&L()},[R,U,L]),y.useEffect(()=>{b&&L()},[b,L]);const Ie=()=>{i({viewerOpen:!1}),f(!1),z(!0),L()};y.useEffect(()=>{tp().then(_=>{$(_)}).catch(_=>{console.error("Failed to load node types:",_)})},[$]),y.useEffect(()=>{fe()},[fe]);const je=(_,oe,ce=!0)=>{z(!1),L(),i({viewerImages:_,viewerIndex:oe,viewerScale:1,viewerTranslate:{x:0,y:0},viewerOpen:!0}),f(ce)},Me=()=>{const _=Ep(de,{onlyOutput:!0,alt:"Generation"});z(!1),L();const oe=_.length>0?0:-1;i({viewerImages:_,viewerIndex:oe,viewerScale:1,viewerTranslate:{x:0,y:0},viewerOpen:!0}),f(!0)};return y.useLayoutEffect(()=>{const _=document.documentElement;_.classList.toggle("dark",Q==="dark"),_.style.colorScheme=Q},[Q]),y.useEffect(()=>{ue&&queueMicrotask(()=>{f(!1)})},[ue,f]),u.jsxs("div",{id:"app-root",className:"min-h-screen bg-gray-100",children:[u.jsx(tS,{mode:n}),u.jsxs("main",{id:"main-content",ref:p,className:"pt-[69px] pb-[80px] min-h-screen relative",children:[u.jsxs(u.Fragment,{children:[u.jsx(Bk,{visible:n==="outputs"}),u.jsx(A4,{visible:n==="workflow",onImageClick:je}),u.jsx(lk,{visible:n==="queue",onImageClick:je})]}),u.jsx("div",{id:"bottom-bar-spacer",className:"fixed inset-x-0 bottom-0 bg-gray-100 pointer-events-none z-[1500]",style:{height:"var(--bottom-bar-offset, 80px)"}})]}),u.jsx($4,{currentPanel:n,viewerOpen:l,followQueue:c,onToggleFollowQueue:()=>f(!c),onOpenFollowQueue:Me}),u.jsx(jk,{onClose:Ie})]})}D1.createRoot(document.getElementById("root")).render(u.jsx(y.StrictMode,{children:u.jsx(zk,{})}));
//# sourceMappingURL=index-B8sWHZhc.js.map
