function pw(n,o){for(var s=0;s<o.length;s++){const a=o[s];if(typeof a!="string"&&!Array.isArray(a)){for(const l in a)if(l!=="default"&&!(l in n)){const c=Object.getOwnPropertyDescriptor(a,l);c&&Object.defineProperty(n,l,c.get?c:{enumerable:!0,get:()=>a[l]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))a(l);new MutationObserver(l=>{for(const c of l)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&a(d)}).observe(document,{childList:!0,subtree:!0});function s(l){const c={};return l.integrity&&(c.integrity=l.integrity),l.referrerPolicy&&(c.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?c.credentials="include":l.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function a(l){if(l.ep)return;l.ep=!0;const c=s(l);fetch(l.href,c)}})();function hw(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var pf={exports:{}},ul={};var D0;function gw(){if(D0)return ul;D0=1;var n=Symbol.for("react.transitional.element"),o=Symbol.for("react.fragment");function s(a,l,c){var d=null;if(c!==void 0&&(d=""+c),l.key!==void 0&&(d=""+l.key),"key"in l){c={};for(var h in l)h!=="key"&&(c[h]=l[h])}else c=l;return l=c.ref,{$$typeof:n,type:a,key:d,ref:l!==void 0?l:null,props:c}}return ul.Fragment=o,ul.jsx=s,ul.jsxs=s,ul}var B0;function mw(){return B0||(B0=1,pf.exports=gw()),pf.exports}var u=mw(),hf={exports:{}},Rt={};var z0;function yw(){if(z0)return Rt;z0=1;var n=Symbol.for("react.transitional.element"),o=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),c=Symbol.for("react.consumer"),d=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),x=Symbol.for("react.activity"),v=Symbol.iterator;function C(M){return M===null||typeof M!="object"?null:(M=v&&M[v]||M["@@iterator"],typeof M=="function"?M:null)}var N={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,j={};function k(M,L,K){this.props=M,this.context=L,this.refs=j,this.updater=K||N}k.prototype.isReactComponent={},k.prototype.setState=function(M,L){if(typeof M!="object"&&typeof M!="function"&&M!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,M,L,"setState")},k.prototype.forceUpdate=function(M){this.updater.enqueueForceUpdate(this,M,"forceUpdate")};function O(){}O.prototype=k.prototype;function R(M,L,K){this.props=M,this.context=L,this.refs=j,this.updater=K||N}var D=R.prototype=new O;D.constructor=R,w(D,k.prototype),D.isPureReactComponent=!0;var I=Array.isArray;function H(){}var A={H:null,A:null,T:null,S:null},V=Object.prototype.hasOwnProperty;function J(M,L,K){var je=K.ref;return{$$typeof:n,type:M,key:L,ref:je!==void 0?je:null,props:K}}function X(M,L){return J(M.type,L,M.props)}function re(M){return typeof M=="object"&&M!==null&&M.$$typeof===n}function te(M){var L={"=":"=0",":":"=2"};return"$"+M.replace(/[=:]/g,function(K){return L[K]})}var me=/\/+/g;function Te(M,L){return typeof M=="object"&&M!==null&&M.key!=null?te(""+M.key):L.toString(36)}function F(M){switch(M.status){case"fulfilled":return M.value;case"rejected":throw M.reason;default:switch(typeof M.status=="string"?M.then(H,H):(M.status="pending",M.then(function(L){M.status==="pending"&&(M.status="fulfilled",M.value=L)},function(L){M.status==="pending"&&(M.status="rejected",M.reason=L)})),M.status){case"fulfilled":return M.value;case"rejected":throw M.reason}}throw M}function _(M,L,K,je,We){var Re=typeof M;(Re==="undefined"||Re==="boolean")&&(M=null);var Se=!1;if(M===null)Se=!0;else switch(Re){case"bigint":case"string":case"number":Se=!0;break;case"object":switch(M.$$typeof){case n:case o:Se=!0;break;case y:return Se=M._init,_(Se(M._payload),L,K,je,We)}}if(Se)return We=We(M),Se=je===""?"."+Te(M,0):je,I(We)?(K="",Se!=null&&(K=Se.replace(me,"$&/")+"/"),_(We,L,K,"",function(se){return se})):We!=null&&(re(We)&&(We=X(We,K+(We.key==null||M&&M.key===We.key?"":(""+We.key).replace(me,"$&/")+"/")+Se)),L.push(We)),1;Se=0;var Ee=je===""?".":je+":";if(I(M))for(var xe=0;xe<M.length;xe++)je=M[xe],Re=Ee+Te(je,xe),Se+=_(je,L,K,Re,We);else if(xe=C(M),typeof xe=="function")for(M=xe.call(M),xe=0;!(je=M.next()).done;)je=je.value,Re=Ee+Te(je,xe++),Se+=_(je,L,K,Re,We);else if(Re==="object"){if(typeof M.then=="function")return _(F(M),L,K,je,We);throw L=String(M),Error("Objects are not valid as a React child (found: "+(L==="[object Object]"?"object with keys {"+Object.keys(M).join(", ")+"}":L)+"). If you meant to render a collection of children, use an array instead.")}return Se}function q(M,L,K){if(M==null)return M;var je=[],We=0;return _(M,je,"","",function(Re){return L.call(K,Re,We++)}),je}function de(M){if(M._status===-1){var L=M._result;L=L(),L.then(function(K){(M._status===0||M._status===-1)&&(M._status=1,M._result=K)},function(K){(M._status===0||M._status===-1)&&(M._status=2,M._result=K)}),M._status===-1&&(M._status=0,M._result=L)}if(M._status===1)return M._result.default;throw M._result}var Me=typeof reportError=="function"?reportError:function(M){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var L=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof M=="object"&&M!==null&&typeof M.message=="string"?String(M.message):String(M),error:M});if(!window.dispatchEvent(L))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",M);return}console.error(M)},Ne={map:q,forEach:function(M,L,K){q(M,function(){L.apply(this,arguments)},K)},count:function(M){var L=0;return q(M,function(){L++}),L},toArray:function(M){return q(M,function(L){return L})||[]},only:function(M){if(!re(M))throw Error("React.Children.only expected to receive a single React element child.");return M}};return Rt.Activity=x,Rt.Children=Ne,Rt.Component=k,Rt.Fragment=s,Rt.Profiler=l,Rt.PureComponent=R,Rt.StrictMode=a,Rt.Suspense=p,Rt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=A,Rt.__COMPILER_RUNTIME={__proto__:null,c:function(M){return A.H.useMemoCache(M)}},Rt.cache=function(M){return function(){return M.apply(null,arguments)}},Rt.cacheSignal=function(){return null},Rt.cloneElement=function(M,L,K){if(M==null)throw Error("The argument must be a React element, but you passed "+M+".");var je=w({},M.props),We=M.key;if(L!=null)for(Re in L.key!==void 0&&(We=""+L.key),L)!V.call(L,Re)||Re==="key"||Re==="__self"||Re==="__source"||Re==="ref"&&L.ref===void 0||(je[Re]=L[Re]);var Re=arguments.length-2;if(Re===1)je.children=K;else if(1<Re){for(var Se=Array(Re),Ee=0;Ee<Re;Ee++)Se[Ee]=arguments[Ee+2];je.children=Se}return J(M.type,We,je)},Rt.createContext=function(M){return M={$$typeof:d,_currentValue:M,_currentValue2:M,_threadCount:0,Provider:null,Consumer:null},M.Provider=M,M.Consumer={$$typeof:c,_context:M},M},Rt.createElement=function(M,L,K){var je,We={},Re=null;if(L!=null)for(je in L.key!==void 0&&(Re=""+L.key),L)V.call(L,je)&&je!=="key"&&je!=="__self"&&je!=="__source"&&(We[je]=L[je]);var Se=arguments.length-2;if(Se===1)We.children=K;else if(1<Se){for(var Ee=Array(Se),xe=0;xe<Se;xe++)Ee[xe]=arguments[xe+2];We.children=Ee}if(M&&M.defaultProps)for(je in Se=M.defaultProps,Se)We[je]===void 0&&(We[je]=Se[je]);return J(M,Re,We)},Rt.createRef=function(){return{current:null}},Rt.forwardRef=function(M){return{$$typeof:h,render:M}},Rt.isValidElement=re,Rt.lazy=function(M){return{$$typeof:y,_payload:{_status:-1,_result:M},_init:de}},Rt.memo=function(M,L){return{$$typeof:m,type:M,compare:L===void 0?null:L}},Rt.startTransition=function(M){var L=A.T,K={};A.T=K;try{var je=M(),We=A.S;We!==null&&We(K,je),typeof je=="object"&&je!==null&&typeof je.then=="function"&&je.then(H,Me)}catch(Re){Me(Re)}finally{L!==null&&K.types!==null&&(L.types=K.types),A.T=L}},Rt.unstable_useCacheRefresh=function(){return A.H.useCacheRefresh()},Rt.use=function(M){return A.H.use(M)},Rt.useActionState=function(M,L,K){return A.H.useActionState(M,L,K)},Rt.useCallback=function(M,L){return A.H.useCallback(M,L)},Rt.useContext=function(M){return A.H.useContext(M)},Rt.useDebugValue=function(){},Rt.useDeferredValue=function(M,L){return A.H.useDeferredValue(M,L)},Rt.useEffect=function(M,L){return A.H.useEffect(M,L)},Rt.useEffectEvent=function(M){return A.H.useEffectEvent(M)},Rt.useId=function(){return A.H.useId()},Rt.useImperativeHandle=function(M,L,K){return A.H.useImperativeHandle(M,L,K)},Rt.useInsertionEffect=function(M,L){return A.H.useInsertionEffect(M,L)},Rt.useLayoutEffect=function(M,L){return A.H.useLayoutEffect(M,L)},Rt.useMemo=function(M,L){return A.H.useMemo(M,L)},Rt.useOptimistic=function(M,L){return A.H.useOptimistic(M,L)},Rt.useReducer=function(M,L,K){return A.H.useReducer(M,L,K)},Rt.useRef=function(M){return A.H.useRef(M)},Rt.useState=function(M){return A.H.useState(M)},Rt.useSyncExternalStore=function(M,L,K){return A.H.useSyncExternalStore(M,L,K)},Rt.useTransition=function(){return A.H.useTransition()},Rt.version="19.2.3",Rt}var H0;function wp(){return H0||(H0=1,hf.exports=yw()),hf.exports}var b=wp();const ia=hw(b),V0=pw({__proto__:null,default:ia},[b]);var gf={exports:{}},cl={},mf={exports:{}},yf={};var $0;function bw(){return $0||($0=1,(function(n){function o(_,q){var de=_.length;_.push(q);e:for(;0<de;){var Me=de-1>>>1,Ne=_[Me];if(0<l(Ne,q))_[Me]=q,_[de]=Ne,de=Me;else break e}}function s(_){return _.length===0?null:_[0]}function a(_){if(_.length===0)return null;var q=_[0],de=_.pop();if(de!==q){_[0]=de;e:for(var Me=0,Ne=_.length,M=Ne>>>1;Me<M;){var L=2*(Me+1)-1,K=_[L],je=L+1,We=_[je];if(0>l(K,de))je<Ne&&0>l(We,K)?(_[Me]=We,_[je]=de,Me=je):(_[Me]=K,_[L]=de,Me=L);else if(je<Ne&&0>l(We,de))_[Me]=We,_[je]=de,Me=je;else break e}}return q}function l(_,q){var de=_.sortIndex-q.sortIndex;return de!==0?de:_.id-q.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var c=performance;n.unstable_now=function(){return c.now()}}else{var d=Date,h=d.now();n.unstable_now=function(){return d.now()-h}}var p=[],m=[],y=1,x=null,v=3,C=!1,N=!1,w=!1,j=!1,k=typeof setTimeout=="function"?setTimeout:null,O=typeof clearTimeout=="function"?clearTimeout:null,R=typeof setImmediate<"u"?setImmediate:null;function D(_){for(var q=s(m);q!==null;){if(q.callback===null)a(m);else if(q.startTime<=_)a(m),q.sortIndex=q.expirationTime,o(p,q);else break;q=s(m)}}function I(_){if(w=!1,D(_),!N)if(s(p)!==null)N=!0,H||(H=!0,te());else{var q=s(m);q!==null&&F(I,q.startTime-_)}}var H=!1,A=-1,V=5,J=-1;function X(){return j?!0:!(n.unstable_now()-J<V)}function re(){if(j=!1,H){var _=n.unstable_now();J=_;var q=!0;try{e:{N=!1,w&&(w=!1,O(A),A=-1),C=!0;var de=v;try{t:{for(D(_),x=s(p);x!==null&&!(x.expirationTime>_&&X());){var Me=x.callback;if(typeof Me=="function"){x.callback=null,v=x.priorityLevel;var Ne=Me(x.expirationTime<=_);if(_=n.unstable_now(),typeof Ne=="function"){x.callback=Ne,D(_),q=!0;break t}x===s(p)&&a(p),D(_)}else a(p);x=s(p)}if(x!==null)q=!0;else{var M=s(m);M!==null&&F(I,M.startTime-_),q=!1}}break e}finally{x=null,v=de,C=!1}q=void 0}}finally{q?te():H=!1}}}var te;if(typeof R=="function")te=function(){R(re)};else if(typeof MessageChannel<"u"){var me=new MessageChannel,Te=me.port2;me.port1.onmessage=re,te=function(){Te.postMessage(null)}}else te=function(){k(re,0)};function F(_,q){A=k(function(){_(n.unstable_now())},q)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(_){_.callback=null},n.unstable_forceFrameRate=function(_){0>_||125<_?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):V=0<_?Math.floor(1e3/_):5},n.unstable_getCurrentPriorityLevel=function(){return v},n.unstable_next=function(_){switch(v){case 1:case 2:case 3:var q=3;break;default:q=v}var de=v;v=q;try{return _()}finally{v=de}},n.unstable_requestPaint=function(){j=!0},n.unstable_runWithPriority=function(_,q){switch(_){case 1:case 2:case 3:case 4:case 5:break;default:_=3}var de=v;v=_;try{return q()}finally{v=de}},n.unstable_scheduleCallback=function(_,q,de){var Me=n.unstable_now();switch(typeof de=="object"&&de!==null?(de=de.delay,de=typeof de=="number"&&0<de?Me+de:Me):de=Me,_){case 1:var Ne=-1;break;case 2:Ne=250;break;case 5:Ne=1073741823;break;case 4:Ne=1e4;break;default:Ne=5e3}return Ne=de+Ne,_={id:y++,callback:q,priorityLevel:_,startTime:de,expirationTime:Ne,sortIndex:-1},de>Me?(_.sortIndex=de,o(m,_),s(p)===null&&_===s(m)&&(w?(O(A),A=-1):w=!0,F(I,de-Me))):(_.sortIndex=Ne,o(p,_),N||C||(N=!0,H||(H=!0,te()))),_},n.unstable_shouldYield=X,n.unstable_wrapCallback=function(_){var q=v;return function(){var de=v;v=q;try{return _.apply(this,arguments)}finally{v=de}}}})(yf)),yf}var K0;function xw(){return K0||(K0=1,mf.exports=bw()),mf.exports}var bf={exports:{}},Wn={};var U0;function vw(){if(U0)return Wn;U0=1;var n=wp();function o(p){var m="https://react.dev/errors/"+p;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var y=2;y<arguments.length;y++)m+="&args[]="+encodeURIComponent(arguments[y])}return"Minified React error #"+p+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(){}var a={d:{f:s,r:function(){throw Error(o(522))},D:s,C:s,L:s,m:s,X:s,S:s,M:s},p:0,findDOMNode:null},l=Symbol.for("react.portal");function c(p,m,y){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:l,key:x==null?null:""+x,children:p,containerInfo:m,implementation:y}}var d=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function h(p,m){if(p==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return Wn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,Wn.createPortal=function(p,m){var y=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(o(299));return c(p,m,null,y)},Wn.flushSync=function(p){var m=d.T,y=a.p;try{if(d.T=null,a.p=2,p)return p()}finally{d.T=m,a.p=y,a.d.f()}},Wn.preconnect=function(p,m){typeof p=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,a.d.C(p,m))},Wn.prefetchDNS=function(p){typeof p=="string"&&a.d.D(p)},Wn.preinit=function(p,m){if(typeof p=="string"&&m&&typeof m.as=="string"){var y=m.as,x=h(y,m.crossOrigin),v=typeof m.integrity=="string"?m.integrity:void 0,C=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;y==="style"?a.d.S(p,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:x,integrity:v,fetchPriority:C}):y==="script"&&a.d.X(p,{crossOrigin:x,integrity:v,fetchPriority:C,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},Wn.preinitModule=function(p,m){if(typeof p=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var y=h(m.as,m.crossOrigin);a.d.M(p,{crossOrigin:y,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&a.d.M(p)},Wn.preload=function(p,m){if(typeof p=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var y=m.as,x=h(y,m.crossOrigin);a.d.L(p,y,{crossOrigin:x,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},Wn.preloadModule=function(p,m){if(typeof p=="string")if(m){var y=h(m.as,m.crossOrigin);a.d.m(p,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:y,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else a.d.m(p)},Wn.requestFormReset=function(p){a.d.r(p)},Wn.unstable_batchedUpdates=function(p,m){return p(m)},Wn.useFormState=function(p,m,y){return d.H.useFormState(p,m,y)},Wn.useFormStatus=function(){return d.H.useHostTransitionStatus()},Wn.version="19.2.3",Wn}var W0;function Eb(){if(W0)return bf.exports;W0=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(o){console.error(o)}}return n(),bf.exports=vw(),bf.exports}var F0;function ww(){if(F0)return cl;F0=1;var n=xw(),o=wp(),s=Eb();function a(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var r=2;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function c(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function d(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function h(e){if(e.tag===31){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function p(e){if(c(e)!==e)throw Error(a(188))}function m(e){var t=e.alternate;if(!t){if(t=c(e),t===null)throw Error(a(188));return t!==e?null:e}for(var r=e,i=t;;){var f=r.return;if(f===null)break;var g=f.alternate;if(g===null){if(i=f.return,i!==null){r=i;continue}break}if(f.child===g.child){for(g=f.child;g;){if(g===r)return p(f),e;if(g===i)return p(f),t;g=g.sibling}throw Error(a(188))}if(r.return!==i.return)r=f,i=g;else{for(var S=!1,E=f.child;E;){if(E===r){S=!0,r=f,i=g;break}if(E===i){S=!0,i=f,r=g;break}E=E.sibling}if(!S){for(E=g.child;E;){if(E===r){S=!0,r=g,i=f;break}if(E===i){S=!0,i=g,r=f;break}E=E.sibling}if(!S)throw Error(a(189))}}if(r.alternate!==i)throw Error(a(190))}if(r.tag!==3)throw Error(a(188));return r.stateNode.current===r?e:t}function y(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e;for(e=e.child;e!==null;){if(t=y(e),t!==null)return t;e=e.sibling}return null}var x=Object.assign,v=Symbol.for("react.element"),C=Symbol.for("react.transitional.element"),N=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),j=Symbol.for("react.strict_mode"),k=Symbol.for("react.profiler"),O=Symbol.for("react.consumer"),R=Symbol.for("react.context"),D=Symbol.for("react.forward_ref"),I=Symbol.for("react.suspense"),H=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),V=Symbol.for("react.lazy"),J=Symbol.for("react.activity"),X=Symbol.for("react.memo_cache_sentinel"),re=Symbol.iterator;function te(e){return e===null||typeof e!="object"?null:(e=re&&e[re]||e["@@iterator"],typeof e=="function"?e:null)}var me=Symbol.for("react.client.reference");function Te(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===me?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case w:return"Fragment";case k:return"Profiler";case j:return"StrictMode";case I:return"Suspense";case H:return"SuspenseList";case J:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case N:return"Portal";case R:return e.displayName||"Context";case O:return(e._context.displayName||"Context")+".Consumer";case D:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case A:return t=e.displayName||null,t!==null?t:Te(e.type)||"Memo";case V:t=e._payload,e=e._init;try{return Te(e(t))}catch{}}return null}var F=Array.isArray,_=o.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,q=s.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,de={pending:!1,data:null,method:null,action:null},Me=[],Ne=-1;function M(e){return{current:e}}function L(e){0>Ne||(e.current=Me[Ne],Me[Ne]=null,Ne--)}function K(e,t){Ne++,Me[Ne]=e.current,e.current=t}var je=M(null),We=M(null),Re=M(null),Se=M(null);function Ee(e,t){switch(K(Re,t),K(We,e),K(je,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?s0(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)t=s0(t),e=a0(t,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}L(je),K(je,e)}function xe(){L(je),L(We),L(Re)}function se(e){e.memoizedState!==null&&K(Se,e);var t=je.current,r=a0(t,e.type);t!==r&&(K(We,e),K(je,r))}function Z(e){We.current===e&&(L(je),L(We)),Se.current===e&&(L(Se),sl._currentValue=de)}var T,ie;function G(e){if(T===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);T=t&&t[1]||"",ie=-1<r.stack.indexOf(`
    at`)?" (<anonymous>)":-1<r.stack.indexOf("@")?"@unknown:0:0":""}return`
`+T+e+ie}var ge=!1;function B(e,t){if(!e||ge)return"";ge=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var i={DetermineComponentFrameRoot:function(){try{if(t){var Ue=function(){throw Error()};if(Object.defineProperty(Ue.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ue,[])}catch(Le){var Ce=Le}Reflect.construct(e,[],Ue)}else{try{Ue.call()}catch(Le){Ce=Le}e.call(Ue.prototype)}}else{try{throw Error()}catch(Le){Ce=Le}(Ue=e())&&typeof Ue.catch=="function"&&Ue.catch(function(){})}}catch(Le){if(Le&&Ce&&typeof Le.stack=="string")return[Le.stack,Ce.stack]}return[null,null]}};i.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var f=Object.getOwnPropertyDescriptor(i.DetermineComponentFrameRoot,"name");f&&f.configurable&&Object.defineProperty(i.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var g=i.DetermineComponentFrameRoot(),S=g[0],E=g[1];if(S&&E){var Y=S.split(`
`),we=E.split(`
`);for(f=i=0;i<Y.length&&!Y[i].includes("DetermineComponentFrameRoot");)i++;for(;f<we.length&&!we[f].includes("DetermineComponentFrameRoot");)f++;if(i===Y.length||f===we.length)for(i=Y.length-1,f=we.length-1;1<=i&&0<=f&&Y[i]!==we[f];)f--;for(;1<=i&&0<=f;i--,f--)if(Y[i]!==we[f]){if(i!==1||f!==1)do if(i--,f--,0>f||Y[i]!==we[f]){var ze=`
`+Y[i].replace(" at new "," at ");return e.displayName&&ze.includes("<anonymous>")&&(ze=ze.replace("<anonymous>",e.displayName)),ze}while(1<=i&&0<=f);break}}}finally{ge=!1,Error.prepareStackTrace=r}return(r=e?e.displayName||e.name:"")?G(r):""}function ne(e,t){switch(e.tag){case 26:case 27:case 5:return G(e.type);case 16:return G("Lazy");case 13:return e.child!==t&&t!==null?G("Suspense Fallback"):G("Suspense");case 19:return G("SuspenseList");case 0:case 15:return B(e.type,!1);case 11:return B(e.type.render,!1);case 1:return B(e.type,!0);case 31:return G("Activity");default:return""}}function W(e){try{var t="",r=null;do t+=ne(e,r),r=e,e=e.return;while(e);return t}catch(i){return`
Error generating stack: `+i.message+`
`+i.stack}}var P=Object.prototype.hasOwnProperty,z=n.unstable_scheduleCallback,$=n.unstable_cancelCallback,ee=n.unstable_shouldYield,pe=n.unstable_requestPaint,ae=n.unstable_now,ke=n.unstable_getCurrentPriorityLevel,U=n.unstable_ImmediatePriority,ce=n.unstable_UserBlockingPriority,He=n.unstable_NormalPriority,Ve=n.unstable_LowPriority,qe=n.unstable_IdlePriority,ot=n.log,Ge=n.unstable_setDisableYieldValue,Xe=null,Ie=null;function _e(e){if(typeof ot=="function"&&Ge(e),Ie&&typeof Ie.setStrictMode=="function")try{Ie.setStrictMode(Xe,e)}catch{}}var Ze=Math.clz32?Math.clz32:Lt,wt=Math.log,pt=Math.LN2;function Lt(e){return e>>>=0,e===0?32:31-(wt(e)/pt|0)|0}var _t=256,Vt=262144,Pe=4194304;function Fe(e){var t=e&42;if(t!==0)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Ke(e,t,r){var i=e.pendingLanes;if(i===0)return 0;var f=0,g=e.suspendedLanes,S=e.pingedLanes;e=e.warmLanes;var E=i&134217727;return E!==0?(i=E&~g,i!==0?f=Fe(i):(S&=E,S!==0?f=Fe(S):r||(r=E&~e,r!==0&&(f=Fe(r))))):(E=i&~g,E!==0?f=Fe(E):S!==0?f=Fe(S):r||(r=i&~e,r!==0&&(f=Fe(r)))),f===0?0:t!==0&&t!==f&&(t&g)===0&&(g=f&-f,r=t&-t,g>=r||g===32&&(r&4194048)!==0)?t:f}function Je(e,t){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)===0}function mt(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Et(){var e=Pe;return Pe<<=1,(Pe&62914560)===0&&(Pe=4194304),e}function be(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function ye(e,t){e.pendingLanes|=t,t!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function De(e,t,r,i,f,g){var S=e.pendingLanes;e.pendingLanes=r,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=r,e.entangledLanes&=r,e.errorRecoveryDisabledLanes&=r,e.shellSuspendCounter=0;var E=e.entanglements,Y=e.expirationTimes,we=e.hiddenUpdates;for(r=S&~r;0<r;){var ze=31-Ze(r),Ue=1<<ze;E[ze]=0,Y[ze]=-1;var Ce=we[ze];if(Ce!==null)for(we[ze]=null,ze=0;ze<Ce.length;ze++){var Le=Ce[ze];Le!==null&&(Le.lane&=-536870913)}r&=~Ue}i!==0&&Ye(e,i,0),g!==0&&f===0&&e.tag!==0&&(e.suspendedLanes|=g&~(S&~t))}function Ye(e,t,r){e.pendingLanes|=t,e.suspendedLanes&=~t;var i=31-Ze(t);e.entangledLanes|=t,e.entanglements[i]=e.entanglements[i]|1073741824|r&261930}function et(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var i=31-Ze(r),f=1<<i;f&t|e[i]&t&&(e[i]|=t),r&=~f}}function rt(e,t){var r=t&-t;return r=(r&42)!==0?1:Be(r),(r&(e.suspendedLanes|t))!==0?0:r}function Be(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function ct(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function St(){var e=q.p;return e!==0?e:(e=window.event,e===void 0?32:T0(e.type))}function bt(e,t){var r=q.p;try{return q.p=e,t()}finally{q.p=r}}var lt=Math.random().toString(36).slice(2),ht="__reactFiber$"+lt,Ct="__reactProps$"+lt,Nt="__reactContainer$"+lt,ut="__reactEvents$"+lt,At="__reactListeners$"+lt,tn="__reactHandles$"+lt,kn="__reactResources$"+lt,nn="__reactMarker$"+lt;function Q(e){delete e[ht],delete e[Ct],delete e[ut],delete e[At],delete e[tn]}function Ae(e){var t=e[ht];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Nt]||r[ht]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=p0(e);e!==null;){if(r=e[ht])return r;e=p0(e)}return t}e=r,r=e.parentNode}return null}function le(e){if(e=e[ht]||e[Nt]){var t=e.tag;if(t===5||t===6||t===13||t===31||t===26||t===27||t===3)return e}return null}function st(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e.stateNode;throw Error(a(33))}function nt(e){var t=e[kn];return t||(t=e[kn]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function tt(e){e[nn]=!0}var Qe=new Set,Mt={};function gt(e,t){xt(e,t),xt(e+"Capture",t)}function xt(e,t){for(Mt[e]=t,e=0;e<t.length;e++)Qe.add(t[e])}var ue=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),vt={},dt={};function Kt(e){return P.call(dt,e)?!0:P.call(vt,e)?!1:ue.test(e)?dt[e]=!0:(vt[e]=!0,!1)}function Bt(e,t,r){if(Kt(t))if(r===null)e.removeAttribute(t);else{switch(typeof r){case"undefined":case"function":case"symbol":e.removeAttribute(t);return;case"boolean":var i=t.toLowerCase().slice(0,5);if(i!=="data-"&&i!=="aria-"){e.removeAttribute(t);return}}e.setAttribute(t,""+r)}}function ln(e,t,r){if(r===null)e.removeAttribute(t);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttribute(t,""+r)}}function bn(e,t,r,i){if(i===null)e.removeAttribute(r);else{switch(typeof i){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(r);return}e.setAttributeNS(t,r,""+i)}}function jn(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Kl(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function uc(e,t,r){var i=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&typeof i<"u"&&typeof i.get=="function"&&typeof i.set=="function"){var f=i.get,g=i.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return f.call(this)},set:function(S){r=""+S,g.call(this,S)}}),Object.defineProperty(e,t,{enumerable:i.enumerable}),{getValue:function(){return r},setValue:function(S){r=""+S},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function xa(e){if(!e._valueTracker){var t=Kl(e)?"checked":"value";e._valueTracker=uc(e,t,""+e[t])}}function Ul(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),i="";return e&&(i=Kl(e)?e.checked?"true":"false":e.value),e=i,e!==r?(t.setValue(e),!0):!1}function Xo(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var Wl=/[\n"\\]/g;function Un(e){return e.replace(Wl,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function va(e,t,r,i,f,g,S,E){e.name="",S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?e.type=S:e.removeAttribute("type"),t!=null?S==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+jn(t)):e.value!==""+jn(t)&&(e.value=""+jn(t)):S!=="submit"&&S!=="reset"||e.removeAttribute("value"),t!=null?ks(e,S,jn(t)):r!=null?ks(e,S,jn(r)):i!=null&&e.removeAttribute("value"),f==null&&g!=null&&(e.defaultChecked=!!g),f!=null&&(e.checked=f&&typeof f!="function"&&typeof f!="symbol"),E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"?e.name=""+jn(E):e.removeAttribute("name")}function Fl(e,t,r,i,f,g,S,E){if(g!=null&&typeof g!="function"&&typeof g!="symbol"&&typeof g!="boolean"&&(e.type=g),t!=null||r!=null){if(!(g!=="submit"&&g!=="reset"||t!=null)){xa(e);return}r=r!=null?""+jn(r):"",t=t!=null?""+jn(t):r,E||t===e.value||(e.value=t),e.defaultValue=t}i=i??f,i=typeof i!="function"&&typeof i!="symbol"&&!!i,e.checked=E?e.checked:!!i,e.defaultChecked=!!i,S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"&&(e.name=S),xa(e)}function ks(e,t,r){t==="number"&&Xo(e.ownerDocument)===e||e.defaultValue===""+r||(e.defaultValue=""+r)}function so(e,t,r,i){if(e=e.options,t){t={};for(var f=0;f<r.length;f++)t["$"+r[f]]=!0;for(r=0;r<e.length;r++)f=t.hasOwnProperty("$"+e[r].value),e[r].selected!==f&&(e[r].selected=f),f&&i&&(e[r].defaultSelected=!0)}else{for(r=""+jn(r),t=null,f=0;f<e.length;f++){if(e[f].value===r){e[f].selected=!0,i&&(e[f].defaultSelected=!0);return}t!==null||e[f].disabled||(t=e[f])}t!==null&&(t.selected=!0)}}function ql(e,t,r){if(t!=null&&(t=""+jn(t),t!==e.value&&(e.value=t),r==null)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=r!=null?""+jn(r):""}function Gl(e,t,r,i){if(t==null){if(i!=null){if(r!=null)throw Error(a(92));if(F(i)){if(1<i.length)throw Error(a(93));i=i[0]}r=i}r==null&&(r=""),t=r}r=jn(t),e.defaultValue=r,i=e.textContent,i===r&&i!==""&&i!==null&&(e.value=i),xa(e)}function Cr(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var cc=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Oe(e,t,r){var i=t.indexOf("--")===0;r==null||typeof r=="boolean"||r===""?i?e.setProperty(t,""):t==="float"?e.cssFloat="":e[t]="":i?e.setProperty(t,r):typeof r!="number"||r===0||cc.has(t)?t==="float"?e.cssFloat=r:e[t]=(""+r).trim():e[t]=r+"px"}function at(e,t,r){if(t!=null&&typeof t!="object")throw Error(a(62));if(e=e.style,r!=null){for(var i in r)!r.hasOwnProperty(i)||t!=null&&t.hasOwnProperty(i)||(i.indexOf("--")===0?e.setProperty(i,""):i==="float"?e.cssFloat="":e[i]="");for(var f in t)i=t[f],t.hasOwnProperty(f)&&r[f]!==i&&Oe(e,f,i)}else for(var g in t)t.hasOwnProperty(g)&&Oe(e,g,t[g])}function yt(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var gn=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Mn=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ft(e){return Mn.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function xo(){}var wa=null;function Xr(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var js=null,Ms=null;function rh(e){var t=le(e);if(t&&(e=t.stateNode)){var r=e[Ct]||null;e:switch(e=t.stateNode,t.type){case"input":if(va(e,r.value,r.defaultValue,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll('input[name="'+Un(""+t)+'"][type="radio"]'),t=0;t<r.length;t++){var i=r[t];if(i!==e&&i.form===e.form){var f=i[Ct]||null;if(!f)throw Error(a(90));va(i,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name)}}for(t=0;t<r.length;t++)i=r[t],i.form===e.form&&Ul(i)}break e;case"textarea":ql(e,r.value,r.defaultValue);break e;case"select":t=r.value,t!=null&&so(e,!!r.multiple,t,!1)}}}var dc=!1;function sh(e,t,r){if(dc)return e(t,r);dc=!0;try{var i=e(t);return i}finally{if(dc=!1,(js!==null||Ms!==null)&&(Ai(),js&&(t=js,e=Ms,Ms=js=null,rh(t),e)))for(t=0;t<e.length;t++)rh(e[t])}}function Sa(e,t){var r=e.stateNode;if(r===null)return null;var i=r[Ct]||null;if(i===null)return null;r=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(e=e.type,i=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!i;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(a(231,t,typeof r));return r}var Zo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),fc=!1;if(Zo)try{var Na={};Object.defineProperty(Na,"passive",{get:function(){fc=!0}}),window.addEventListener("test",Na,Na),window.removeEventListener("test",Na,Na)}catch{fc=!1}var kr=null,pc=null,Pl=null;function ah(){if(Pl)return Pl;var e,t=pc,r=t.length,i,f="value"in kr?kr.value:kr.textContent,g=f.length;for(e=0;e<r&&t[e]===f[e];e++);var S=r-e;for(i=1;i<=S&&t[r-i]===f[g-i];i++);return Pl=f.slice(e,1<i?1-i:void 0)}function Yl(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Ql(){return!0}function lh(){return!1}function Qn(e){function t(r,i,f,g,S){this._reactName=r,this._targetInst=f,this.type=i,this.nativeEvent=g,this.target=S,this.currentTarget=null;for(var E in e)e.hasOwnProperty(E)&&(r=e[E],this[E]=r?r(g):g[E]);return this.isDefaultPrevented=(g.defaultPrevented!=null?g.defaultPrevented:g.returnValue===!1)?Ql:lh,this.isPropagationStopped=lh,this}return x(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Ql)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Ql)},persist:function(){},isPersistent:Ql}),t}var Zr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Xl=Qn(Zr),Ca=x({},Zr,{view:0,detail:0}),dv=Qn(Ca),hc,gc,ka,Zl=x({},Ca,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:yc,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ka&&(ka&&e.type==="mousemove"?(hc=e.screenX-ka.screenX,gc=e.screenY-ka.screenY):gc=hc=0,ka=e),hc)},movementY:function(e){return"movementY"in e?e.movementY:gc}}),ih=Qn(Zl),fv=x({},Zl,{dataTransfer:0}),pv=Qn(fv),hv=x({},Ca,{relatedTarget:0}),mc=Qn(hv),gv=x({},Zr,{animationName:0,elapsedTime:0,pseudoElement:0}),mv=Qn(gv),yv=x({},Zr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bv=Qn(yv),xv=x({},Zr,{data:0}),uh=Qn(xv),vv={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wv={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Sv={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Nv(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Sv[e])?!!t[e]:!1}function yc(){return Nv}var Cv=x({},Ca,{key:function(e){if(e.key){var t=vv[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Yl(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?wv[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:yc,charCode:function(e){return e.type==="keypress"?Yl(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Yl(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),kv=Qn(Cv),jv=x({},Zl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ch=Qn(jv),Mv=x({},Ca,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:yc}),Ov=Qn(Mv),Tv=x({},Zr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ev=Qn(Tv),Iv=x({},Zl,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Lv=Qn(Iv),_v=x({},Zr,{newState:0,oldState:0}),Av=Qn(_v),Rv=[9,13,27,32],bc=Zo&&"CompositionEvent"in window,ja=null;Zo&&"documentMode"in document&&(ja=document.documentMode);var Dv=Zo&&"TextEvent"in window&&!ja,dh=Zo&&(!bc||ja&&8<ja&&11>=ja),fh=" ",ph=!1;function hh(e,t){switch(e){case"keyup":return Rv.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function gh(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Os=!1;function Bv(e,t){switch(e){case"compositionend":return gh(t);case"keypress":return t.which!==32?null:(ph=!0,fh);case"textInput":return e=t.data,e===fh&&ph?null:e;default:return null}}function zv(e,t){if(Os)return e==="compositionend"||!bc&&hh(e,t)?(e=ah(),Pl=pc=kr=null,Os=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return dh&&t.locale!=="ko"?null:t.data;default:return null}}var Hv={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function mh(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Hv[e.type]:t==="textarea"}function yh(e,t,r,i){js?Ms?Ms.push(i):Ms=[i]:js=i,t=$i(t,"onChange"),0<t.length&&(r=new Xl("onChange","change",null,r,i),e.push({event:r,listeners:t}))}var Ma=null,Oa=null;function Vv(e){Jm(e,0)}function Jl(e){var t=st(e);if(Ul(t))return e}function bh(e,t){if(e==="change")return t}var xh=!1;if(Zo){var xc;if(Zo){var vc="oninput"in document;if(!vc){var vh=document.createElement("div");vh.setAttribute("oninput","return;"),vc=typeof vh.oninput=="function"}xc=vc}else xc=!1;xh=xc&&(!document.documentMode||9<document.documentMode)}function wh(){Ma&&(Ma.detachEvent("onpropertychange",Sh),Oa=Ma=null)}function Sh(e){if(e.propertyName==="value"&&Jl(Oa)){var t=[];yh(t,Oa,e,Xr(e)),sh(Vv,t)}}function $v(e,t,r){e==="focusin"?(wh(),Ma=t,Oa=r,Ma.attachEvent("onpropertychange",Sh)):e==="focusout"&&wh()}function Kv(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Jl(Oa)}function Uv(e,t){if(e==="click")return Jl(t)}function Wv(e,t){if(e==="input"||e==="change")return Jl(t)}function Fv(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ao=typeof Object.is=="function"?Object.is:Fv;function Ta(e,t){if(ao(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),i=Object.keys(t);if(r.length!==i.length)return!1;for(i=0;i<r.length;i++){var f=r[i];if(!P.call(t,f)||!ao(e[f],t[f]))return!1}return!0}function Nh(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Ch(e,t){var r=Nh(e);e=0;for(var i;r;){if(r.nodeType===3){if(i=e+r.textContent.length,e<=t&&i>=t)return{node:r,offset:t-e};e=i}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Nh(r)}}function kh(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?kh(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function jh(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var t=Xo(e.document);t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Xo(e.document)}return t}function wc(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}var qv=Zo&&"documentMode"in document&&11>=document.documentMode,Ts=null,Sc=null,Ea=null,Nc=!1;function Mh(e,t,r){var i=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Nc||Ts==null||Ts!==Xo(i)||(i=Ts,"selectionStart"in i&&wc(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),Ea&&Ta(Ea,i)||(Ea=i,i=$i(Sc,"onSelect"),0<i.length&&(t=new Xl("onSelect","select",null,t,r),e.push({event:t,listeners:i}),t.target=Ts)))}function Jr(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Es={animationend:Jr("Animation","AnimationEnd"),animationiteration:Jr("Animation","AnimationIteration"),animationstart:Jr("Animation","AnimationStart"),transitionrun:Jr("Transition","TransitionRun"),transitionstart:Jr("Transition","TransitionStart"),transitioncancel:Jr("Transition","TransitionCancel"),transitionend:Jr("Transition","TransitionEnd")},Cc={},Oh={};Zo&&(Oh=document.createElement("div").style,"AnimationEvent"in window||(delete Es.animationend.animation,delete Es.animationiteration.animation,delete Es.animationstart.animation),"TransitionEvent"in window||delete Es.transitionend.transition);function es(e){if(Cc[e])return Cc[e];if(!Es[e])return e;var t=Es[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in Oh)return Cc[e]=t[r];return e}var Th=es("animationend"),Eh=es("animationiteration"),Ih=es("animationstart"),Gv=es("transitionrun"),Pv=es("transitionstart"),Yv=es("transitioncancel"),Lh=es("transitionend"),_h=new Map,kc="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");kc.push("scrollEnd");function Io(e,t){_h.set(e,t),gt(t,[e])}var ei=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},vo=[],Is=0,jc=0;function ti(){for(var e=Is,t=jc=Is=0;t<e;){var r=vo[t];vo[t++]=null;var i=vo[t];vo[t++]=null;var f=vo[t];vo[t++]=null;var g=vo[t];if(vo[t++]=null,i!==null&&f!==null){var S=i.pending;S===null?f.next=f:(f.next=S.next,S.next=f),i.pending=f}g!==0&&Ah(r,f,g)}}function ni(e,t,r,i){vo[Is++]=e,vo[Is++]=t,vo[Is++]=r,vo[Is++]=i,jc|=i,e.lanes|=i,e=e.alternate,e!==null&&(e.lanes|=i)}function Mc(e,t,r,i){return ni(e,t,r,i),oi(e)}function ts(e,t){return ni(e,null,null,t),oi(e)}function Ah(e,t,r){e.lanes|=r;var i=e.alternate;i!==null&&(i.lanes|=r);for(var f=!1,g=e.return;g!==null;)g.childLanes|=r,i=g.alternate,i!==null&&(i.childLanes|=r),g.tag===22&&(e=g.stateNode,e===null||e._visibility&1||(f=!0)),e=g,g=g.return;return e.tag===3?(g=e.stateNode,f&&t!==null&&(f=31-Ze(r),e=g.hiddenUpdates,i=e[f],i===null?e[f]=[t]:i.push(t),t.lane=r|536870912),g):null}function oi(e){if(50<Za)throw Za=0,Dd=null,Error(a(185));for(var t=e.return;t!==null;)e=t,t=e.return;return e.tag===3?e.stateNode:null}var Ls={};function Qv(e,t,r,i){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function lo(e,t,r,i){return new Qv(e,t,r,i)}function Oc(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Jo(e,t){var r=e.alternate;return r===null?(r=lo(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&65011712,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r.refCleanup=e.refCleanup,r}function Rh(e,t){e.flags&=65011714;var r=e.alternate;return r===null?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=r.childLanes,e.lanes=r.lanes,e.child=r.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=r.memoizedProps,e.memoizedState=r.memoizedState,e.updateQueue=r.updateQueue,e.type=r.type,t=r.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function ri(e,t,r,i,f,g){var S=0;if(i=e,typeof e=="function")Oc(e)&&(S=1);else if(typeof e=="string")S=tw(e,r,je.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case J:return e=lo(31,r,t,f),e.elementType=J,e.lanes=g,e;case w:return ns(r.children,f,g,t);case j:S=8,f|=24;break;case k:return e=lo(12,r,t,f|2),e.elementType=k,e.lanes=g,e;case I:return e=lo(13,r,t,f),e.elementType=I,e.lanes=g,e;case H:return e=lo(19,r,t,f),e.elementType=H,e.lanes=g,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case R:S=10;break e;case O:S=9;break e;case D:S=11;break e;case A:S=14;break e;case V:S=16,i=null;break e}S=29,r=Error(a(130,e===null?"null":typeof e,"")),i=null}return t=lo(S,r,t,f),t.elementType=e,t.type=i,t.lanes=g,t}function ns(e,t,r,i){return e=lo(7,e,i,t),e.lanes=r,e}function Tc(e,t,r){return e=lo(6,e,null,t),e.lanes=r,e}function Dh(e){var t=lo(18,null,null,0);return t.stateNode=e,t}function Ec(e,t,r){return t=lo(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Bh=new WeakMap;function wo(e,t){if(typeof e=="object"&&e!==null){var r=Bh.get(e);return r!==void 0?r:(t={value:e,source:t,stack:W(t)},Bh.set(e,t),t)}return{value:e,source:t,stack:W(t)}}var _s=[],As=0,si=null,Ia=0,So=[],No=0,jr=null,Vo=1,$o="";function er(e,t){_s[As++]=Ia,_s[As++]=si,si=e,Ia=t}function zh(e,t,r){So[No++]=Vo,So[No++]=$o,So[No++]=jr,jr=e;var i=Vo;e=$o;var f=32-Ze(i)-1;i&=~(1<<f),r+=1;var g=32-Ze(t)+f;if(30<g){var S=f-f%5;g=(i&(1<<S)-1).toString(32),i>>=S,f-=S,Vo=1<<32-Ze(t)+f|r<<f|i,$o=g+e}else Vo=1<<g|r<<f|i,$o=e}function Ic(e){e.return!==null&&(er(e,1),zh(e,1,0))}function Lc(e){for(;e===si;)si=_s[--As],_s[As]=null,Ia=_s[--As],_s[As]=null;for(;e===jr;)jr=So[--No],So[No]=null,$o=So[--No],So[No]=null,Vo=So[--No],So[No]=null}function Hh(e,t){So[No++]=Vo,So[No++]=$o,So[No++]=jr,Vo=t.id,$o=t.overflow,jr=e}var Dn=null,mn=null,Pt=!1,Mr=null,Co=!1,_c=Error(a(519));function Or(e){var t=Error(a(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw La(wo(t,e)),_c}function Vh(e){var t=e.stateNode,r=e.type,i=e.memoizedProps;switch(t[ht]=e,t[Ct]=i,r){case"dialog":Wt("cancel",t),Wt("close",t);break;case"iframe":case"object":case"embed":Wt("load",t);break;case"video":case"audio":for(r=0;r<el.length;r++)Wt(el[r],t);break;case"source":Wt("error",t);break;case"img":case"image":case"link":Wt("error",t),Wt("load",t);break;case"details":Wt("toggle",t);break;case"input":Wt("invalid",t),Fl(t,i.value,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name,!0);break;case"select":Wt("invalid",t);break;case"textarea":Wt("invalid",t),Gl(t,i.value,i.defaultValue,i.children)}r=i.children,typeof r!="string"&&typeof r!="number"&&typeof r!="bigint"||t.textContent===""+r||i.suppressHydrationWarning===!0||o0(t.textContent,r)?(i.popover!=null&&(Wt("beforetoggle",t),Wt("toggle",t)),i.onScroll!=null&&Wt("scroll",t),i.onScrollEnd!=null&&Wt("scrollend",t),i.onClick!=null&&(t.onclick=xo),t=!0):t=!1,t||Or(e,!0)}function $h(e){for(Dn=e.return;Dn;)switch(Dn.tag){case 5:case 31:case 13:Co=!1;return;case 27:case 3:Co=!0;return;default:Dn=Dn.return}}function Rs(e){if(e!==Dn)return!1;if(!Pt)return $h(e),Pt=!0,!1;var t=e.tag,r;if((r=t!==3&&t!==27)&&((r=t===5)&&(r=e.type,r=!(r!=="form"&&r!=="button")||Xd(e.type,e.memoizedProps)),r=!r),r&&mn&&Or(e),$h(e),t===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(a(317));mn=f0(e)}else if(t===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(a(317));mn=f0(e)}else t===27?(t=mn,Kr(e.type)?(e=nf,nf=null,mn=e):mn=t):mn=Dn?jo(e.stateNode.nextSibling):null;return!0}function os(){mn=Dn=null,Pt=!1}function Ac(){var e=Mr;return e!==null&&(eo===null?eo=e:eo.push.apply(eo,e),Mr=null),e}function La(e){Mr===null?Mr=[e]:Mr.push(e)}var Rc=M(null),rs=null,tr=null;function Tr(e,t,r){K(Rc,t._currentValue),t._currentValue=r}function nr(e){e._currentValue=Rc.current,L(Rc)}function Dc(e,t,r){for(;e!==null;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,i!==null&&(i.childLanes|=t)):i!==null&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===r)break;e=e.return}}function Bc(e,t,r,i){var f=e.child;for(f!==null&&(f.return=e);f!==null;){var g=f.dependencies;if(g!==null){var S=f.child;g=g.firstContext;e:for(;g!==null;){var E=g;g=f;for(var Y=0;Y<t.length;Y++)if(E.context===t[Y]){g.lanes|=r,E=g.alternate,E!==null&&(E.lanes|=r),Dc(g.return,r,e),i||(S=null);break e}g=E.next}}else if(f.tag===18){if(S=f.return,S===null)throw Error(a(341));S.lanes|=r,g=S.alternate,g!==null&&(g.lanes|=r),Dc(S,r,e),S=null}else S=f.child;if(S!==null)S.return=f;else for(S=f;S!==null;){if(S===e){S=null;break}if(f=S.sibling,f!==null){f.return=S.return,S=f;break}S=S.return}f=S}}function Ds(e,t,r,i){e=null;for(var f=t,g=!1;f!==null;){if(!g){if((f.flags&524288)!==0)g=!0;else if((f.flags&262144)!==0)break}if(f.tag===10){var S=f.alternate;if(S===null)throw Error(a(387));if(S=S.memoizedProps,S!==null){var E=f.type;ao(f.pendingProps.value,S.value)||(e!==null?e.push(E):e=[E])}}else if(f===Se.current){if(S=f.alternate,S===null)throw Error(a(387));S.memoizedState.memoizedState!==f.memoizedState.memoizedState&&(e!==null?e.push(sl):e=[sl])}f=f.return}e!==null&&Bc(t,e,r,i),t.flags|=262144}function ai(e){for(e=e.firstContext;e!==null;){if(!ao(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function ss(e){rs=e,tr=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function Bn(e){return Kh(rs,e)}function li(e,t){return rs===null&&ss(e),Kh(e,t)}function Kh(e,t){var r=t._currentValue;if(t={context:t,memoizedValue:r,next:null},tr===null){if(e===null)throw Error(a(308));tr=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else tr=tr.next=t;return r}var Xv=typeof AbortController<"u"?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(r,i){e.push(i)}};this.abort=function(){t.aborted=!0,e.forEach(function(r){return r()})}},Zv=n.unstable_scheduleCallback,Jv=n.unstable_NormalPriority,On={$$typeof:R,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function zc(){return{controller:new Xv,data:new Map,refCount:0}}function _a(e){e.refCount--,e.refCount===0&&Zv(Jv,function(){e.controller.abort()})}var Aa=null,Hc=0,Bs=0,zs=null;function e1(e,t){if(Aa===null){var r=Aa=[];Hc=0,Bs=Kd(),zs={status:"pending",value:void 0,then:function(i){r.push(i)}}}return Hc++,t.then(Uh,Uh),t}function Uh(){if(--Hc===0&&Aa!==null){zs!==null&&(zs.status="fulfilled");var e=Aa;Aa=null,Bs=0,zs=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function t1(e,t){var r=[],i={status:"pending",value:null,reason:null,then:function(f){r.push(f)}};return e.then(function(){i.status="fulfilled",i.value=t;for(var f=0;f<r.length;f++)(0,r[f])(t)},function(f){for(i.status="rejected",i.reason=f,f=0;f<r.length;f++)(0,r[f])(void 0)}),i}var Wh=_.S;_.S=function(e,t){Mm=ae(),typeof t=="object"&&t!==null&&typeof t.then=="function"&&e1(e,t),Wh!==null&&Wh(e,t)};var as=M(null);function Vc(){var e=as.current;return e!==null?e:fn.pooledCache}function ii(e,t){t===null?K(as,as.current):K(as,t.pool)}function Fh(){var e=Vc();return e===null?null:{parent:On._currentValue,pool:e}}var Hs=Error(a(460)),$c=Error(a(474)),ui=Error(a(542)),ci={then:function(){}};function qh(e){return e=e.status,e==="fulfilled"||e==="rejected"}function Gh(e,t,r){switch(r=e[r],r===void 0?e.push(t):r!==t&&(t.then(xo,xo),t=r),t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,Yh(e),e;default:if(typeof t.status=="string")t.then(xo,xo);else{if(e=fn,e!==null&&100<e.shellSuspendCounter)throw Error(a(482));e=t,e.status="pending",e.then(function(i){if(t.status==="pending"){var f=t;f.status="fulfilled",f.value=i}},function(i){if(t.status==="pending"){var f=t;f.status="rejected",f.reason=i}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,Yh(e),e}throw is=t,Hs}}function ls(e){try{var t=e._init;return t(e._payload)}catch(r){throw r!==null&&typeof r=="object"&&typeof r.then=="function"?(is=r,Hs):r}}var is=null;function Ph(){if(is===null)throw Error(a(459));var e=is;return is=null,e}function Yh(e){if(e===Hs||e===ui)throw Error(a(483))}var Vs=null,Ra=0;function di(e){var t=Ra;return Ra+=1,Vs===null&&(Vs=[]),Gh(Vs,e,t)}function Da(e,t){t=t.props.ref,e.ref=t!==void 0?t:null}function fi(e,t){throw t.$$typeof===v?Error(a(525)):(e=Object.prototype.toString.call(t),Error(a(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)))}function Qh(e){function t(he,oe){if(e){var ve=he.deletions;ve===null?(he.deletions=[oe],he.flags|=16):ve.push(oe)}}function r(he,oe){if(!e)return null;for(;oe!==null;)t(he,oe),oe=oe.sibling;return null}function i(he){for(var oe=new Map;he!==null;)he.key!==null?oe.set(he.key,he):oe.set(he.index,he),he=he.sibling;return oe}function f(he,oe){return he=Jo(he,oe),he.index=0,he.sibling=null,he}function g(he,oe,ve){return he.index=ve,e?(ve=he.alternate,ve!==null?(ve=ve.index,ve<oe?(he.flags|=67108866,oe):ve):(he.flags|=67108866,oe)):(he.flags|=1048576,oe)}function S(he){return e&&he.alternate===null&&(he.flags|=67108866),he}function E(he,oe,ve,$e){return oe===null||oe.tag!==6?(oe=Tc(ve,he.mode,$e),oe.return=he,oe):(oe=f(oe,ve),oe.return=he,oe)}function Y(he,oe,ve,$e){var kt=ve.type;return kt===w?ze(he,oe,ve.props.children,$e,ve.key):oe!==null&&(oe.elementType===kt||typeof kt=="object"&&kt!==null&&kt.$$typeof===V&&ls(kt)===oe.type)?(oe=f(oe,ve.props),Da(oe,ve),oe.return=he,oe):(oe=ri(ve.type,ve.key,ve.props,null,he.mode,$e),Da(oe,ve),oe.return=he,oe)}function we(he,oe,ve,$e){return oe===null||oe.tag!==4||oe.stateNode.containerInfo!==ve.containerInfo||oe.stateNode.implementation!==ve.implementation?(oe=Ec(ve,he.mode,$e),oe.return=he,oe):(oe=f(oe,ve.children||[]),oe.return=he,oe)}function ze(he,oe,ve,$e,kt){return oe===null||oe.tag!==7?(oe=ns(ve,he.mode,$e,kt),oe.return=he,oe):(oe=f(oe,ve),oe.return=he,oe)}function Ue(he,oe,ve){if(typeof oe=="string"&&oe!==""||typeof oe=="number"||typeof oe=="bigint")return oe=Tc(""+oe,he.mode,ve),oe.return=he,oe;if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case C:return ve=ri(oe.type,oe.key,oe.props,null,he.mode,ve),Da(ve,oe),ve.return=he,ve;case N:return oe=Ec(oe,he.mode,ve),oe.return=he,oe;case V:return oe=ls(oe),Ue(he,oe,ve)}if(F(oe)||te(oe))return oe=ns(oe,he.mode,ve,null),oe.return=he,oe;if(typeof oe.then=="function")return Ue(he,di(oe),ve);if(oe.$$typeof===R)return Ue(he,li(he,oe),ve);fi(he,oe)}return null}function Ce(he,oe,ve,$e){var kt=oe!==null?oe.key:null;if(typeof ve=="string"&&ve!==""||typeof ve=="number"||typeof ve=="bigint")return kt!==null?null:E(he,oe,""+ve,$e);if(typeof ve=="object"&&ve!==null){switch(ve.$$typeof){case C:return ve.key===kt?Y(he,oe,ve,$e):null;case N:return ve.key===kt?we(he,oe,ve,$e):null;case V:return ve=ls(ve),Ce(he,oe,ve,$e)}if(F(ve)||te(ve))return kt!==null?null:ze(he,oe,ve,$e,null);if(typeof ve.then=="function")return Ce(he,oe,di(ve),$e);if(ve.$$typeof===R)return Ce(he,oe,li(he,ve),$e);fi(he,ve)}return null}function Le(he,oe,ve,$e,kt){if(typeof $e=="string"&&$e!==""||typeof $e=="number"||typeof $e=="bigint")return he=he.get(ve)||null,E(oe,he,""+$e,kt);if(typeof $e=="object"&&$e!==null){switch($e.$$typeof){case C:return he=he.get($e.key===null?ve:$e.key)||null,Y(oe,he,$e,kt);case N:return he=he.get($e.key===null?ve:$e.key)||null,we(oe,he,$e,kt);case V:return $e=ls($e),Le(he,oe,ve,$e,kt)}if(F($e)||te($e))return he=he.get(ve)||null,ze(oe,he,$e,kt,null);if(typeof $e.then=="function")return Le(he,oe,ve,di($e),kt);if($e.$$typeof===R)return Le(he,oe,ve,li(oe,$e),kt);fi(oe,$e)}return null}function it(he,oe,ve,$e){for(var kt=null,Yt=null,ft=oe,$t=oe=0,Gt=null;ft!==null&&$t<ve.length;$t++){ft.index>$t?(Gt=ft,ft=null):Gt=ft.sibling;var Qt=Ce(he,ft,ve[$t],$e);if(Qt===null){ft===null&&(ft=Gt);break}e&&ft&&Qt.alternate===null&&t(he,ft),oe=g(Qt,oe,$t),Yt===null?kt=Qt:Yt.sibling=Qt,Yt=Qt,ft=Gt}if($t===ve.length)return r(he,ft),Pt&&er(he,$t),kt;if(ft===null){for(;$t<ve.length;$t++)ft=Ue(he,ve[$t],$e),ft!==null&&(oe=g(ft,oe,$t),Yt===null?kt=ft:Yt.sibling=ft,Yt=ft);return Pt&&er(he,$t),kt}for(ft=i(ft);$t<ve.length;$t++)Gt=Le(ft,he,$t,ve[$t],$e),Gt!==null&&(e&&Gt.alternate!==null&&ft.delete(Gt.key===null?$t:Gt.key),oe=g(Gt,oe,$t),Yt===null?kt=Gt:Yt.sibling=Gt,Yt=Gt);return e&&ft.forEach(function(Gr){return t(he,Gr)}),Pt&&er(he,$t),kt}function Tt(he,oe,ve,$e){if(ve==null)throw Error(a(151));for(var kt=null,Yt=null,ft=oe,$t=oe=0,Gt=null,Qt=ve.next();ft!==null&&!Qt.done;$t++,Qt=ve.next()){ft.index>$t?(Gt=ft,ft=null):Gt=ft.sibling;var Gr=Ce(he,ft,Qt.value,$e);if(Gr===null){ft===null&&(ft=Gt);break}e&&ft&&Gr.alternate===null&&t(he,ft),oe=g(Gr,oe,$t),Yt===null?kt=Gr:Yt.sibling=Gr,Yt=Gr,ft=Gt}if(Qt.done)return r(he,ft),Pt&&er(he,$t),kt;if(ft===null){for(;!Qt.done;$t++,Qt=ve.next())Qt=Ue(he,Qt.value,$e),Qt!==null&&(oe=g(Qt,oe,$t),Yt===null?kt=Qt:Yt.sibling=Qt,Yt=Qt);return Pt&&er(he,$t),kt}for(ft=i(ft);!Qt.done;$t++,Qt=ve.next())Qt=Le(ft,he,$t,Qt.value,$e),Qt!==null&&(e&&Qt.alternate!==null&&ft.delete(Qt.key===null?$t:Qt.key),oe=g(Qt,oe,$t),Yt===null?kt=Qt:Yt.sibling=Qt,Yt=Qt);return e&&ft.forEach(function(fw){return t(he,fw)}),Pt&&er(he,$t),kt}function dn(he,oe,ve,$e){if(typeof ve=="object"&&ve!==null&&ve.type===w&&ve.key===null&&(ve=ve.props.children),typeof ve=="object"&&ve!==null){switch(ve.$$typeof){case C:e:{for(var kt=ve.key;oe!==null;){if(oe.key===kt){if(kt=ve.type,kt===w){if(oe.tag===7){r(he,oe.sibling),$e=f(oe,ve.props.children),$e.return=he,he=$e;break e}}else if(oe.elementType===kt||typeof kt=="object"&&kt!==null&&kt.$$typeof===V&&ls(kt)===oe.type){r(he,oe.sibling),$e=f(oe,ve.props),Da($e,ve),$e.return=he,he=$e;break e}r(he,oe);break}else t(he,oe);oe=oe.sibling}ve.type===w?($e=ns(ve.props.children,he.mode,$e,ve.key),$e.return=he,he=$e):($e=ri(ve.type,ve.key,ve.props,null,he.mode,$e),Da($e,ve),$e.return=he,he=$e)}return S(he);case N:e:{for(kt=ve.key;oe!==null;){if(oe.key===kt)if(oe.tag===4&&oe.stateNode.containerInfo===ve.containerInfo&&oe.stateNode.implementation===ve.implementation){r(he,oe.sibling),$e=f(oe,ve.children||[]),$e.return=he,he=$e;break e}else{r(he,oe);break}else t(he,oe);oe=oe.sibling}$e=Ec(ve,he.mode,$e),$e.return=he,he=$e}return S(he);case V:return ve=ls(ve),dn(he,oe,ve,$e)}if(F(ve))return it(he,oe,ve,$e);if(te(ve)){if(kt=te(ve),typeof kt!="function")throw Error(a(150));return ve=kt.call(ve),Tt(he,oe,ve,$e)}if(typeof ve.then=="function")return dn(he,oe,di(ve),$e);if(ve.$$typeof===R)return dn(he,oe,li(he,ve),$e);fi(he,ve)}return typeof ve=="string"&&ve!==""||typeof ve=="number"||typeof ve=="bigint"?(ve=""+ve,oe!==null&&oe.tag===6?(r(he,oe.sibling),$e=f(oe,ve),$e.return=he,he=$e):(r(he,oe),$e=Tc(ve,he.mode,$e),$e.return=he,he=$e),S(he)):r(he,oe)}return function(he,oe,ve,$e){try{Ra=0;var kt=dn(he,oe,ve,$e);return Vs=null,kt}catch(ft){if(ft===Hs||ft===ui)throw ft;var Yt=lo(29,ft,null,he.mode);return Yt.lanes=$e,Yt.return=he,Yt}}}var us=Qh(!0),Xh=Qh(!1),Er=!1;function Kc(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Uc(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function Ir(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function Lr(e,t,r){var i=e.updateQueue;if(i===null)return null;if(i=i.shared,(Zt&2)!==0){var f=i.pending;return f===null?t.next=t:(t.next=f.next,f.next=t),i.pending=t,t=oi(e),Ah(e,null,r),t}return ni(e,i,t,r),oi(e)}function Ba(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194048)!==0)){var i=t.lanes;i&=e.pendingLanes,r|=i,t.lanes=r,et(e,r)}}function Wc(e,t){var r=e.updateQueue,i=e.alternate;if(i!==null&&(i=i.updateQueue,r===i)){var f=null,g=null;if(r=r.firstBaseUpdate,r!==null){do{var S={lane:r.lane,tag:r.tag,payload:r.payload,callback:null,next:null};g===null?f=g=S:g=g.next=S,r=r.next}while(r!==null);g===null?f=g=t:g=g.next=t}else f=g=t;r={baseState:i.baseState,firstBaseUpdate:f,lastBaseUpdate:g,shared:i.shared,callbacks:i.callbacks},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}var Fc=!1;function za(){if(Fc){var e=zs;if(e!==null)throw e}}function Ha(e,t,r,i){Fc=!1;var f=e.updateQueue;Er=!1;var g=f.firstBaseUpdate,S=f.lastBaseUpdate,E=f.shared.pending;if(E!==null){f.shared.pending=null;var Y=E,we=Y.next;Y.next=null,S===null?g=we:S.next=we,S=Y;var ze=e.alternate;ze!==null&&(ze=ze.updateQueue,E=ze.lastBaseUpdate,E!==S&&(E===null?ze.firstBaseUpdate=we:E.next=we,ze.lastBaseUpdate=Y))}if(g!==null){var Ue=f.baseState;S=0,ze=we=Y=null,E=g;do{var Ce=E.lane&-536870913,Le=Ce!==E.lane;if(Le?(qt&Ce)===Ce:(i&Ce)===Ce){Ce!==0&&Ce===Bs&&(Fc=!0),ze!==null&&(ze=ze.next={lane:0,tag:E.tag,payload:E.payload,callback:null,next:null});e:{var it=e,Tt=E;Ce=t;var dn=r;switch(Tt.tag){case 1:if(it=Tt.payload,typeof it=="function"){Ue=it.call(dn,Ue,Ce);break e}Ue=it;break e;case 3:it.flags=it.flags&-65537|128;case 0:if(it=Tt.payload,Ce=typeof it=="function"?it.call(dn,Ue,Ce):it,Ce==null)break e;Ue=x({},Ue,Ce);break e;case 2:Er=!0}}Ce=E.callback,Ce!==null&&(e.flags|=64,Le&&(e.flags|=8192),Le=f.callbacks,Le===null?f.callbacks=[Ce]:Le.push(Ce))}else Le={lane:Ce,tag:E.tag,payload:E.payload,callback:E.callback,next:null},ze===null?(we=ze=Le,Y=Ue):ze=ze.next=Le,S|=Ce;if(E=E.next,E===null){if(E=f.shared.pending,E===null)break;Le=E,E=Le.next,Le.next=null,f.lastBaseUpdate=Le,f.shared.pending=null}}while(!0);ze===null&&(Y=Ue),f.baseState=Y,f.firstBaseUpdate=we,f.lastBaseUpdate=ze,g===null&&(f.shared.lanes=0),Br|=S,e.lanes=S,e.memoizedState=Ue}}function Zh(e,t){if(typeof e!="function")throw Error(a(191,e));e.call(t)}function Jh(e,t){var r=e.callbacks;if(r!==null)for(e.callbacks=null,e=0;e<r.length;e++)Zh(r[e],t)}var $s=M(null),pi=M(0);function eg(e,t){e=dr,K(pi,e),K($s,t),dr=e|t.baseLanes}function qc(){K(pi,dr),K($s,$s.current)}function Gc(){dr=pi.current,L($s),L(pi)}var io=M(null),ko=null;function _r(e){var t=e.alternate;K(Nn,Nn.current&1),K(io,e),ko===null&&(t===null||$s.current!==null||t.memoizedState!==null)&&(ko=e)}function Pc(e){K(Nn,Nn.current),K(io,e),ko===null&&(ko=e)}function tg(e){e.tag===22?(K(Nn,Nn.current),K(io,e),ko===null&&(ko=e)):Ar()}function Ar(){K(Nn,Nn.current),K(io,io.current)}function uo(e){L(io),ko===e&&(ko=null),L(Nn)}var Nn=M(0);function hi(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||ef(r)||tf(r)))return t}else if(t.tag===19&&(t.memoizedProps.revealOrder==="forwards"||t.memoizedProps.revealOrder==="backwards"||t.memoizedProps.revealOrder==="unstable_legacy-backwards"||t.memoizedProps.revealOrder==="together")){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var or=0,zt=null,un=null,Tn=null,gi=!1,Ks=!1,cs=!1,mi=0,Va=0,Us=null,n1=0;function vn(){throw Error(a(321))}function Yc(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!ao(e[r],t[r]))return!1;return!0}function Qc(e,t,r,i,f,g){return or=g,zt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,_.H=e===null||e.memoizedState===null?zg:dd,cs=!1,g=r(i,f),cs=!1,Ks&&(g=og(t,r,i,f)),ng(e),g}function ng(e){_.H=Ua;var t=un!==null&&un.next!==null;if(or=0,Tn=un=zt=null,gi=!1,Va=0,Us=null,t)throw Error(a(300));e===null||En||(e=e.dependencies,e!==null&&ai(e)&&(En=!0))}function og(e,t,r,i){zt=e;var f=0;do{if(Ks&&(Us=null),Va=0,Ks=!1,25<=f)throw Error(a(301));if(f+=1,Tn=un=null,e.updateQueue!=null){var g=e.updateQueue;g.lastEffect=null,g.events=null,g.stores=null,g.memoCache!=null&&(g.memoCache.index=0)}_.H=Hg,g=t(r,i)}while(Ks);return g}function o1(){var e=_.H,t=e.useState()[0];return t=typeof t.then=="function"?$a(t):t,e=e.useState()[0],(un!==null?un.memoizedState:null)!==e&&(zt.flags|=1024),t}function Xc(){var e=mi!==0;return mi=0,e}function Zc(e,t,r){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r}function Jc(e){if(gi){for(e=e.memoizedState;e!==null;){var t=e.queue;t!==null&&(t.pending=null),e=e.next}gi=!1}or=0,Tn=un=zt=null,Ks=!1,Va=mi=0,Us=null}function qn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Tn===null?zt.memoizedState=Tn=e:Tn=Tn.next=e,Tn}function Cn(){if(un===null){var e=zt.alternate;e=e!==null?e.memoizedState:null}else e=un.next;var t=Tn===null?zt.memoizedState:Tn.next;if(t!==null)Tn=t,un=e;else{if(e===null)throw zt.alternate===null?Error(a(467)):Error(a(310));un=e,e={memoizedState:un.memoizedState,baseState:un.baseState,baseQueue:un.baseQueue,queue:un.queue,next:null},Tn===null?zt.memoizedState=Tn=e:Tn=Tn.next=e}return Tn}function yi(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function $a(e){var t=Va;return Va+=1,Us===null&&(Us=[]),e=Gh(Us,e,t),t=zt,(Tn===null?t.memoizedState:Tn.next)===null&&(t=t.alternate,_.H=t===null||t.memoizedState===null?zg:dd),e}function bi(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return $a(e);if(e.$$typeof===R)return Bn(e)}throw Error(a(438,String(e)))}function ed(e){var t=null,r=zt.updateQueue;if(r!==null&&(t=r.memoCache),t==null){var i=zt.alternate;i!==null&&(i=i.updateQueue,i!==null&&(i=i.memoCache,i!=null&&(t={data:i.data.map(function(f){return f.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),r===null&&(r=yi(),zt.updateQueue=r),r.memoCache=t,r=t.data[t.index],r===void 0)for(r=t.data[t.index]=Array(e),i=0;i<e;i++)r[i]=X;return t.index++,r}function rr(e,t){return typeof t=="function"?t(e):t}function xi(e){var t=Cn();return td(t,un,e)}function td(e,t,r){var i=e.queue;if(i===null)throw Error(a(311));i.lastRenderedReducer=r;var f=e.baseQueue,g=i.pending;if(g!==null){if(f!==null){var S=f.next;f.next=g.next,g.next=S}t.baseQueue=f=g,i.pending=null}if(g=e.baseState,f===null)e.memoizedState=g;else{t=f.next;var E=S=null,Y=null,we=t,ze=!1;do{var Ue=we.lane&-536870913;if(Ue!==we.lane?(qt&Ue)===Ue:(or&Ue)===Ue){var Ce=we.revertLane;if(Ce===0)Y!==null&&(Y=Y.next={lane:0,revertLane:0,gesture:null,action:we.action,hasEagerState:we.hasEagerState,eagerState:we.eagerState,next:null}),Ue===Bs&&(ze=!0);else if((or&Ce)===Ce){we=we.next,Ce===Bs&&(ze=!0);continue}else Ue={lane:0,revertLane:we.revertLane,gesture:null,action:we.action,hasEagerState:we.hasEagerState,eagerState:we.eagerState,next:null},Y===null?(E=Y=Ue,S=g):Y=Y.next=Ue,zt.lanes|=Ce,Br|=Ce;Ue=we.action,cs&&r(g,Ue),g=we.hasEagerState?we.eagerState:r(g,Ue)}else Ce={lane:Ue,revertLane:we.revertLane,gesture:we.gesture,action:we.action,hasEagerState:we.hasEagerState,eagerState:we.eagerState,next:null},Y===null?(E=Y=Ce,S=g):Y=Y.next=Ce,zt.lanes|=Ue,Br|=Ue;we=we.next}while(we!==null&&we!==t);if(Y===null?S=g:Y.next=E,!ao(g,e.memoizedState)&&(En=!0,ze&&(r=zs,r!==null)))throw r;e.memoizedState=g,e.baseState=S,e.baseQueue=Y,i.lastRenderedState=g}return f===null&&(i.lanes=0),[e.memoizedState,i.dispatch]}function nd(e){var t=Cn(),r=t.queue;if(r===null)throw Error(a(311));r.lastRenderedReducer=e;var i=r.dispatch,f=r.pending,g=t.memoizedState;if(f!==null){r.pending=null;var S=f=f.next;do g=e(g,S.action),S=S.next;while(S!==f);ao(g,t.memoizedState)||(En=!0),t.memoizedState=g,t.baseQueue===null&&(t.baseState=g),r.lastRenderedState=g}return[g,i]}function rg(e,t,r){var i=zt,f=Cn(),g=Pt;if(g){if(r===void 0)throw Error(a(407));r=r()}else r=t();var S=!ao((un||f).memoizedState,r);if(S&&(f.memoizedState=r,En=!0),f=f.queue,sd(lg.bind(null,i,f,e),[e]),f.getSnapshot!==t||S||Tn!==null&&Tn.memoizedState.tag&1){if(i.flags|=2048,Ws(9,{destroy:void 0},ag.bind(null,i,f,r,t),null),fn===null)throw Error(a(349));g||(or&127)!==0||sg(i,t,r)}return r}function sg(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=zt.updateQueue,t===null?(t=yi(),zt.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function ag(e,t,r,i){t.value=r,t.getSnapshot=i,ig(t)&&ug(e)}function lg(e,t,r){return r(function(){ig(t)&&ug(e)})}function ig(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!ao(e,r)}catch{return!0}}function ug(e){var t=ts(e,2);t!==null&&to(t,e,2)}function od(e){var t=qn();if(typeof e=="function"){var r=e;if(e=r(),cs){_e(!0);try{r()}finally{_e(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:rr,lastRenderedState:e},t}function cg(e,t,r,i){return e.baseState=r,td(e,un,typeof i=="function"?i:rr)}function r1(e,t,r,i,f){if(Si(e))throw Error(a(485));if(e=t.action,e!==null){var g={payload:f,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(S){g.listeners.push(S)}};_.T!==null?r(!0):g.isTransition=!1,i(g),r=t.pending,r===null?(g.next=t.pending=g,dg(t,g)):(g.next=r.next,t.pending=r.next=g)}}function dg(e,t){var r=t.action,i=t.payload,f=e.state;if(t.isTransition){var g=_.T,S={};_.T=S;try{var E=r(f,i),Y=_.S;Y!==null&&Y(S,E),fg(e,t,E)}catch(we){rd(e,t,we)}finally{g!==null&&S.types!==null&&(g.types=S.types),_.T=g}}else try{g=r(f,i),fg(e,t,g)}catch(we){rd(e,t,we)}}function fg(e,t,r){r!==null&&typeof r=="object"&&typeof r.then=="function"?r.then(function(i){pg(e,t,i)},function(i){return rd(e,t,i)}):pg(e,t,r)}function pg(e,t,r){t.status="fulfilled",t.value=r,hg(t),e.state=r,t=e.pending,t!==null&&(r=t.next,r===t?e.pending=null:(r=r.next,t.next=r,dg(e,r)))}function rd(e,t,r){var i=e.pending;if(e.pending=null,i!==null){i=i.next;do t.status="rejected",t.reason=r,hg(t),t=t.next;while(t!==i)}e.action=null}function hg(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function gg(e,t){return t}function mg(e,t){if(Pt){var r=fn.formState;if(r!==null){e:{var i=zt;if(Pt){if(mn){t:{for(var f=mn,g=Co;f.nodeType!==8;){if(!g){f=null;break t}if(f=jo(f.nextSibling),f===null){f=null;break t}}g=f.data,f=g==="F!"||g==="F"?f:null}if(f){mn=jo(f.nextSibling),i=f.data==="F!";break e}}Or(i)}i=!1}i&&(t=r[0])}}return r=qn(),r.memoizedState=r.baseState=t,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:gg,lastRenderedState:t},r.queue=i,r=Rg.bind(null,zt,i),i.dispatch=r,i=od(!1),g=cd.bind(null,zt,!1,i.queue),i=qn(),f={state:t,dispatch:null,action:e,pending:null},i.queue=f,r=r1.bind(null,zt,f,g,r),f.dispatch=r,i.memoizedState=e,[t,r,!1]}function yg(e){var t=Cn();return bg(t,un,e)}function bg(e,t,r){if(t=td(e,t,gg)[0],e=xi(rr)[0],typeof t=="object"&&t!==null&&typeof t.then=="function")try{var i=$a(t)}catch(S){throw S===Hs?ui:S}else i=t;t=Cn();var f=t.queue,g=f.dispatch;return r!==t.memoizedState&&(zt.flags|=2048,Ws(9,{destroy:void 0},s1.bind(null,f,r),null)),[i,g,e]}function s1(e,t){e.action=t}function xg(e){var t=Cn(),r=un;if(r!==null)return bg(t,r,e);Cn(),t=t.memoizedState,r=Cn();var i=r.queue.dispatch;return r.memoizedState=e,[t,i,!1]}function Ws(e,t,r,i){return e={tag:e,create:r,deps:i,inst:t,next:null},t=zt.updateQueue,t===null&&(t=yi(),zt.updateQueue=t),r=t.lastEffect,r===null?t.lastEffect=e.next=e:(i=r.next,r.next=e,e.next=i,t.lastEffect=e),e}function vg(){return Cn().memoizedState}function vi(e,t,r,i){var f=qn();zt.flags|=e,f.memoizedState=Ws(1|t,{destroy:void 0},r,i===void 0?null:i)}function wi(e,t,r,i){var f=Cn();i=i===void 0?null:i;var g=f.memoizedState.inst;un!==null&&i!==null&&Yc(i,un.memoizedState.deps)?f.memoizedState=Ws(t,g,r,i):(zt.flags|=e,f.memoizedState=Ws(1|t,g,r,i))}function wg(e,t){vi(8390656,8,e,t)}function sd(e,t){wi(2048,8,e,t)}function a1(e){zt.flags|=4;var t=zt.updateQueue;if(t===null)t=yi(),zt.updateQueue=t,t.events=[e];else{var r=t.events;r===null?t.events=[e]:r.push(e)}}function Sg(e){var t=Cn().memoizedState;return a1({ref:t,nextImpl:e}),function(){if((Zt&2)!==0)throw Error(a(440));return t.impl.apply(void 0,arguments)}}function Ng(e,t){return wi(4,2,e,t)}function Cg(e,t){return wi(4,4,e,t)}function kg(e,t){if(typeof t=="function"){e=e();var r=t(e);return function(){typeof r=="function"?r():t(null)}}if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function jg(e,t,r){r=r!=null?r.concat([e]):null,wi(4,4,kg.bind(null,t,e),r)}function ad(){}function Mg(e,t){var r=Cn();t=t===void 0?null:t;var i=r.memoizedState;return t!==null&&Yc(t,i[1])?i[0]:(r.memoizedState=[e,t],e)}function Og(e,t){var r=Cn();t=t===void 0?null:t;var i=r.memoizedState;if(t!==null&&Yc(t,i[1]))return i[0];if(i=e(),cs){_e(!0);try{e()}finally{_e(!1)}}return r.memoizedState=[i,t],i}function ld(e,t,r){return r===void 0||(or&1073741824)!==0&&(qt&261930)===0?e.memoizedState=t:(e.memoizedState=r,e=Tm(),zt.lanes|=e,Br|=e,r)}function Tg(e,t,r,i){return ao(r,t)?r:$s.current!==null?(e=ld(e,r,i),ao(e,t)||(En=!0),e):(or&42)===0||(or&1073741824)!==0&&(qt&261930)===0?(En=!0,e.memoizedState=r):(e=Tm(),zt.lanes|=e,Br|=e,t)}function Eg(e,t,r,i,f){var g=q.p;q.p=g!==0&&8>g?g:8;var S=_.T,E={};_.T=E,cd(e,!1,t,r);try{var Y=f(),we=_.S;if(we!==null&&we(E,Y),Y!==null&&typeof Y=="object"&&typeof Y.then=="function"){var ze=t1(Y,i);Ka(e,t,ze,po(e))}else Ka(e,t,i,po(e))}catch(Ue){Ka(e,t,{then:function(){},status:"rejected",reason:Ue},po())}finally{q.p=g,S!==null&&E.types!==null&&(S.types=E.types),_.T=S}}function l1(){}function id(e,t,r,i){if(e.tag!==5)throw Error(a(476));var f=Ig(e).queue;Eg(e,f,t,de,r===null?l1:function(){return Lg(e),r(i)})}function Ig(e){var t=e.memoizedState;if(t!==null)return t;t={memoizedState:de,baseState:de,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:rr,lastRenderedState:de},next:null};var r={};return t.next={memoizedState:r,baseState:r,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:rr,lastRenderedState:r},next:null},e.memoizedState=t,e=e.alternate,e!==null&&(e.memoizedState=t),t}function Lg(e){var t=Ig(e);t.next===null&&(t=e.alternate.memoizedState),Ka(e,t.next.queue,{},po())}function ud(){return Bn(sl)}function _g(){return Cn().memoizedState}function Ag(){return Cn().memoizedState}function i1(e){for(var t=e.return;t!==null;){switch(t.tag){case 24:case 3:var r=po();e=Ir(r);var i=Lr(t,e,r);i!==null&&(to(i,t,r),Ba(i,t,r)),t={cache:zc()},e.payload=t;return}t=t.return}}function u1(e,t,r){var i=po();r={lane:i,revertLane:0,gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null},Si(e)?Dg(t,r):(r=Mc(e,t,r,i),r!==null&&(to(r,e,i),Bg(r,t,i)))}function Rg(e,t,r){var i=po();Ka(e,t,r,i)}function Ka(e,t,r,i){var f={lane:i,revertLane:0,gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null};if(Si(e))Dg(t,f);else{var g=e.alternate;if(e.lanes===0&&(g===null||g.lanes===0)&&(g=t.lastRenderedReducer,g!==null))try{var S=t.lastRenderedState,E=g(S,r);if(f.hasEagerState=!0,f.eagerState=E,ao(E,S))return ni(e,t,f,0),fn===null&&ti(),!1}catch{}if(r=Mc(e,t,f,i),r!==null)return to(r,e,i),Bg(r,t,i),!0}return!1}function cd(e,t,r,i){if(i={lane:2,revertLane:Kd(),gesture:null,action:i,hasEagerState:!1,eagerState:null,next:null},Si(e)){if(t)throw Error(a(479))}else t=Mc(e,r,i,2),t!==null&&to(t,e,2)}function Si(e){var t=e.alternate;return e===zt||t!==null&&t===zt}function Dg(e,t){Ks=gi=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function Bg(e,t,r){if((r&4194048)!==0){var i=t.lanes;i&=e.pendingLanes,r|=i,t.lanes=r,et(e,r)}}var Ua={readContext:Bn,use:bi,useCallback:vn,useContext:vn,useEffect:vn,useImperativeHandle:vn,useLayoutEffect:vn,useInsertionEffect:vn,useMemo:vn,useReducer:vn,useRef:vn,useState:vn,useDebugValue:vn,useDeferredValue:vn,useTransition:vn,useSyncExternalStore:vn,useId:vn,useHostTransitionStatus:vn,useFormState:vn,useActionState:vn,useOptimistic:vn,useMemoCache:vn,useCacheRefresh:vn};Ua.useEffectEvent=vn;var zg={readContext:Bn,use:bi,useCallback:function(e,t){return qn().memoizedState=[e,t===void 0?null:t],e},useContext:Bn,useEffect:wg,useImperativeHandle:function(e,t,r){r=r!=null?r.concat([e]):null,vi(4194308,4,kg.bind(null,t,e),r)},useLayoutEffect:function(e,t){return vi(4194308,4,e,t)},useInsertionEffect:function(e,t){vi(4,2,e,t)},useMemo:function(e,t){var r=qn();t=t===void 0?null:t;var i=e();if(cs){_e(!0);try{e()}finally{_e(!1)}}return r.memoizedState=[i,t],i},useReducer:function(e,t,r){var i=qn();if(r!==void 0){var f=r(t);if(cs){_e(!0);try{r(t)}finally{_e(!1)}}}else f=t;return i.memoizedState=i.baseState=f,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:f},i.queue=e,e=e.dispatch=u1.bind(null,zt,e),[i.memoizedState,e]},useRef:function(e){var t=qn();return e={current:e},t.memoizedState=e},useState:function(e){e=od(e);var t=e.queue,r=Rg.bind(null,zt,t);return t.dispatch=r,[e.memoizedState,r]},useDebugValue:ad,useDeferredValue:function(e,t){var r=qn();return ld(r,e,t)},useTransition:function(){var e=od(!1);return e=Eg.bind(null,zt,e.queue,!0,!1),qn().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,r){var i=zt,f=qn();if(Pt){if(r===void 0)throw Error(a(407));r=r()}else{if(r=t(),fn===null)throw Error(a(349));(qt&127)!==0||sg(i,t,r)}f.memoizedState=r;var g={value:r,getSnapshot:t};return f.queue=g,wg(lg.bind(null,i,g,e),[e]),i.flags|=2048,Ws(9,{destroy:void 0},ag.bind(null,i,g,r,t),null),r},useId:function(){var e=qn(),t=fn.identifierPrefix;if(Pt){var r=$o,i=Vo;r=(i&~(1<<32-Ze(i)-1)).toString(32)+r,t="_"+t+"R_"+r,r=mi++,0<r&&(t+="H"+r.toString(32)),t+="_"}else r=n1++,t="_"+t+"r_"+r.toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:ud,useFormState:mg,useActionState:mg,useOptimistic:function(e){var t=qn();t.memoizedState=t.baseState=e;var r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=r,t=cd.bind(null,zt,!0,r),r.dispatch=t,[e,t]},useMemoCache:ed,useCacheRefresh:function(){return qn().memoizedState=i1.bind(null,zt)},useEffectEvent:function(e){var t=qn(),r={impl:e};return t.memoizedState=r,function(){if((Zt&2)!==0)throw Error(a(440));return r.impl.apply(void 0,arguments)}}},dd={readContext:Bn,use:bi,useCallback:Mg,useContext:Bn,useEffect:sd,useImperativeHandle:jg,useInsertionEffect:Ng,useLayoutEffect:Cg,useMemo:Og,useReducer:xi,useRef:vg,useState:function(){return xi(rr)},useDebugValue:ad,useDeferredValue:function(e,t){var r=Cn();return Tg(r,un.memoizedState,e,t)},useTransition:function(){var e=xi(rr)[0],t=Cn().memoizedState;return[typeof e=="boolean"?e:$a(e),t]},useSyncExternalStore:rg,useId:_g,useHostTransitionStatus:ud,useFormState:yg,useActionState:yg,useOptimistic:function(e,t){var r=Cn();return cg(r,un,e,t)},useMemoCache:ed,useCacheRefresh:Ag};dd.useEffectEvent=Sg;var Hg={readContext:Bn,use:bi,useCallback:Mg,useContext:Bn,useEffect:sd,useImperativeHandle:jg,useInsertionEffect:Ng,useLayoutEffect:Cg,useMemo:Og,useReducer:nd,useRef:vg,useState:function(){return nd(rr)},useDebugValue:ad,useDeferredValue:function(e,t){var r=Cn();return un===null?ld(r,e,t):Tg(r,un.memoizedState,e,t)},useTransition:function(){var e=nd(rr)[0],t=Cn().memoizedState;return[typeof e=="boolean"?e:$a(e),t]},useSyncExternalStore:rg,useId:_g,useHostTransitionStatus:ud,useFormState:xg,useActionState:xg,useOptimistic:function(e,t){var r=Cn();return un!==null?cg(r,un,e,t):(r.baseState=e,[e,r.queue.dispatch])},useMemoCache:ed,useCacheRefresh:Ag};Hg.useEffectEvent=Sg;function fd(e,t,r,i){t=e.memoizedState,r=r(i,t),r=r==null?t:x({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var pd={enqueueSetState:function(e,t,r){e=e._reactInternals;var i=po(),f=Ir(i);f.payload=t,r!=null&&(f.callback=r),t=Lr(e,f,i),t!==null&&(to(t,e,i),Ba(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var i=po(),f=Ir(i);f.tag=1,f.payload=t,r!=null&&(f.callback=r),t=Lr(e,f,i),t!==null&&(to(t,e,i),Ba(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=po(),i=Ir(r);i.tag=2,t!=null&&(i.callback=t),t=Lr(e,i,r),t!==null&&(to(t,e,r),Ba(t,e,r))}};function Vg(e,t,r,i,f,g,S){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(i,g,S):t.prototype&&t.prototype.isPureReactComponent?!Ta(r,i)||!Ta(f,g):!0}function $g(e,t,r,i){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,i),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,i),t.state!==e&&pd.enqueueReplaceState(t,t.state,null)}function ds(e,t){var r=t;if("ref"in t){r={};for(var i in t)i!=="ref"&&(r[i]=t[i])}if(e=e.defaultProps){r===t&&(r=x({},r));for(var f in e)r[f]===void 0&&(r[f]=e[f])}return r}function Kg(e){ei(e)}function Ug(e){console.error(e)}function Wg(e){ei(e)}function Ni(e,t){try{var r=e.onUncaughtError;r(t.value,{componentStack:t.stack})}catch(i){setTimeout(function(){throw i})}}function Fg(e,t,r){try{var i=e.onCaughtError;i(r.value,{componentStack:r.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(f){setTimeout(function(){throw f})}}function hd(e,t,r){return r=Ir(r),r.tag=3,r.payload={element:null},r.callback=function(){Ni(e,t)},r}function qg(e){return e=Ir(e),e.tag=3,e}function Gg(e,t,r,i){var f=r.type.getDerivedStateFromError;if(typeof f=="function"){var g=i.value;e.payload=function(){return f(g)},e.callback=function(){Fg(t,r,i)}}var S=r.stateNode;S!==null&&typeof S.componentDidCatch=="function"&&(e.callback=function(){Fg(t,r,i),typeof f!="function"&&(zr===null?zr=new Set([this]):zr.add(this));var E=i.stack;this.componentDidCatch(i.value,{componentStack:E!==null?E:""})})}function c1(e,t,r,i,f){if(r.flags|=32768,i!==null&&typeof i=="object"&&typeof i.then=="function"){if(t=r.alternate,t!==null&&Ds(t,r,f,!0),r=io.current,r!==null){switch(r.tag){case 31:case 13:return ko===null?Ri():r.alternate===null&&wn===0&&(wn=3),r.flags&=-257,r.flags|=65536,r.lanes=f,i===ci?r.flags|=16384:(t=r.updateQueue,t===null?r.updateQueue=new Set([i]):t.add(i),Hd(e,i,f)),!1;case 22:return r.flags|=65536,i===ci?r.flags|=16384:(t=r.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([i])},r.updateQueue=t):(r=t.retryQueue,r===null?t.retryQueue=new Set([i]):r.add(i)),Hd(e,i,f)),!1}throw Error(a(435,r.tag))}return Hd(e,i,f),Ri(),!1}if(Pt)return t=io.current,t!==null?((t.flags&65536)===0&&(t.flags|=256),t.flags|=65536,t.lanes=f,i!==_c&&(e=Error(a(422),{cause:i}),La(wo(e,r)))):(i!==_c&&(t=Error(a(423),{cause:i}),La(wo(t,r))),e=e.current.alternate,e.flags|=65536,f&=-f,e.lanes|=f,i=wo(i,r),f=hd(e.stateNode,i,f),Wc(e,f),wn!==4&&(wn=2)),!1;var g=Error(a(520),{cause:i});if(g=wo(g,r),Xa===null?Xa=[g]:Xa.push(g),wn!==4&&(wn=2),t===null)return!0;i=wo(i,r),r=t;do{switch(r.tag){case 3:return r.flags|=65536,e=f&-f,r.lanes|=e,e=hd(r.stateNode,i,e),Wc(r,e),!1;case 1:if(t=r.type,g=r.stateNode,(r.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(zr===null||!zr.has(g))))return r.flags|=65536,f&=-f,r.lanes|=f,f=qg(f),Gg(f,e,r,i),Wc(r,f),!1}r=r.return}while(r!==null);return!1}var gd=Error(a(461)),En=!1;function zn(e,t,r,i){t.child=e===null?Xh(t,null,r,i):us(t,e.child,r,i)}function Pg(e,t,r,i,f){r=r.render;var g=t.ref;if("ref"in i){var S={};for(var E in i)E!=="ref"&&(S[E]=i[E])}else S=i;return ss(t),i=Qc(e,t,r,S,g,f),E=Xc(),e!==null&&!En?(Zc(e,t,f),sr(e,t,f)):(Pt&&E&&Ic(t),t.flags|=1,zn(e,t,i,f),t.child)}function Yg(e,t,r,i,f){if(e===null){var g=r.type;return typeof g=="function"&&!Oc(g)&&g.defaultProps===void 0&&r.compare===null?(t.tag=15,t.type=g,Qg(e,t,g,i,f)):(e=ri(r.type,null,i,t,t.mode,f),e.ref=t.ref,e.return=t,t.child=e)}if(g=e.child,!Nd(e,f)){var S=g.memoizedProps;if(r=r.compare,r=r!==null?r:Ta,r(S,i)&&e.ref===t.ref)return sr(e,t,f)}return t.flags|=1,e=Jo(g,i),e.ref=t.ref,e.return=t,t.child=e}function Qg(e,t,r,i,f){if(e!==null){var g=e.memoizedProps;if(Ta(g,i)&&e.ref===t.ref)if(En=!1,t.pendingProps=i=g,Nd(e,f))(e.flags&131072)!==0&&(En=!0);else return t.lanes=e.lanes,sr(e,t,f)}return md(e,t,r,i,f)}function Xg(e,t,r,i){var f=i.children,g=e!==null?e.memoizedState:null;if(e===null&&t.stateNode===null&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.mode==="hidden"){if((t.flags&128)!==0){if(g=g!==null?g.baseLanes|r:r,e!==null){for(i=t.child=e.child,f=0;i!==null;)f=f|i.lanes|i.childLanes,i=i.sibling;i=f&~g}else i=0,t.child=null;return Zg(e,t,g,r,i)}if((r&536870912)!==0)t.memoizedState={baseLanes:0,cachePool:null},e!==null&&ii(t,g!==null?g.cachePool:null),g!==null?eg(t,g):qc(),tg(t);else return i=t.lanes=536870912,Zg(e,t,g!==null?g.baseLanes|r:r,r,i)}else g!==null?(ii(t,g.cachePool),eg(t,g),Ar(),t.memoizedState=null):(e!==null&&ii(t,null),qc(),Ar());return zn(e,t,f,r),t.child}function Wa(e,t){return e!==null&&e.tag===22||t.stateNode!==null||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function Zg(e,t,r,i,f){var g=Vc();return g=g===null?null:{parent:On._currentValue,pool:g},t.memoizedState={baseLanes:r,cachePool:g},e!==null&&ii(t,null),qc(),tg(t),e!==null&&Ds(e,t,i,!0),t.childLanes=f,null}function Ci(e,t){return t=ji({mode:t.mode,children:t.children},e.mode),t.ref=e.ref,e.child=t,t.return=e,t}function Jg(e,t,r){return us(t,e.child,null,r),e=Ci(t,t.pendingProps),e.flags|=2,uo(t),t.memoizedState=null,e}function d1(e,t,r){var i=t.pendingProps,f=(t.flags&128)!==0;if(t.flags&=-129,e===null){if(Pt){if(i.mode==="hidden")return e=Ci(t,i),t.lanes=536870912,Wa(null,e);if(Pc(t),(e=mn)?(e=d0(e,Co),e=e!==null&&e.data==="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:jr!==null?{id:Vo,overflow:$o}:null,retryLane:536870912,hydrationErrors:null},r=Dh(e),r.return=t,t.child=r,Dn=t,mn=null)):e=null,e===null)throw Or(t);return t.lanes=536870912,null}return Ci(t,i)}var g=e.memoizedState;if(g!==null){var S=g.dehydrated;if(Pc(t),f)if(t.flags&256)t.flags&=-257,t=Jg(e,t,r);else if(t.memoizedState!==null)t.child=e.child,t.flags|=128,t=null;else throw Error(a(558));else if(En||Ds(e,t,r,!1),f=(r&e.childLanes)!==0,En||f){if(i=fn,i!==null&&(S=rt(i,r),S!==0&&S!==g.retryLane))throw g.retryLane=S,ts(e,S),to(i,e,S),gd;Ri(),t=Jg(e,t,r)}else e=g.treeContext,mn=jo(S.nextSibling),Dn=t,Pt=!0,Mr=null,Co=!1,e!==null&&Hh(t,e),t=Ci(t,i),t.flags|=4096;return t}return e=Jo(e.child,{mode:i.mode,children:i.children}),e.ref=t.ref,t.child=e,e.return=t,e}function ki(e,t){var r=t.ref;if(r===null)e!==null&&e.ref!==null&&(t.flags|=4194816);else{if(typeof r!="function"&&typeof r!="object")throw Error(a(284));(e===null||e.ref!==r)&&(t.flags|=4194816)}}function md(e,t,r,i,f){return ss(t),r=Qc(e,t,r,i,void 0,f),i=Xc(),e!==null&&!En?(Zc(e,t,f),sr(e,t,f)):(Pt&&i&&Ic(t),t.flags|=1,zn(e,t,r,f),t.child)}function em(e,t,r,i,f,g){return ss(t),t.updateQueue=null,r=og(t,i,r,f),ng(e),i=Xc(),e!==null&&!En?(Zc(e,t,g),sr(e,t,g)):(Pt&&i&&Ic(t),t.flags|=1,zn(e,t,r,g),t.child)}function tm(e,t,r,i,f){if(ss(t),t.stateNode===null){var g=Ls,S=r.contextType;typeof S=="object"&&S!==null&&(g=Bn(S)),g=new r(i,g),t.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=pd,t.stateNode=g,g._reactInternals=t,g=t.stateNode,g.props=i,g.state=t.memoizedState,g.refs={},Kc(t),S=r.contextType,g.context=typeof S=="object"&&S!==null?Bn(S):Ls,g.state=t.memoizedState,S=r.getDerivedStateFromProps,typeof S=="function"&&(fd(t,r,S,i),g.state=t.memoizedState),typeof r.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(S=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),S!==g.state&&pd.enqueueReplaceState(g,g.state,null),Ha(t,i,g,f),za(),g.state=t.memoizedState),typeof g.componentDidMount=="function"&&(t.flags|=4194308),i=!0}else if(e===null){g=t.stateNode;var E=t.memoizedProps,Y=ds(r,E);g.props=Y;var we=g.context,ze=r.contextType;S=Ls,typeof ze=="object"&&ze!==null&&(S=Bn(ze));var Ue=r.getDerivedStateFromProps;ze=typeof Ue=="function"||typeof g.getSnapshotBeforeUpdate=="function",E=t.pendingProps!==E,ze||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(E||we!==S)&&$g(t,g,i,S),Er=!1;var Ce=t.memoizedState;g.state=Ce,Ha(t,i,g,f),za(),we=t.memoizedState,E||Ce!==we||Er?(typeof Ue=="function"&&(fd(t,r,Ue,i),we=t.memoizedState),(Y=Er||Vg(t,r,Y,i,Ce,we,S))?(ze||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount()),typeof g.componentDidMount=="function"&&(t.flags|=4194308)):(typeof g.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=we),g.props=i,g.state=we,g.context=S,i=Y):(typeof g.componentDidMount=="function"&&(t.flags|=4194308),i=!1)}else{g=t.stateNode,Uc(e,t),S=t.memoizedProps,ze=ds(r,S),g.props=ze,Ue=t.pendingProps,Ce=g.context,we=r.contextType,Y=Ls,typeof we=="object"&&we!==null&&(Y=Bn(we)),E=r.getDerivedStateFromProps,(we=typeof E=="function"||typeof g.getSnapshotBeforeUpdate=="function")||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(S!==Ue||Ce!==Y)&&$g(t,g,i,Y),Er=!1,Ce=t.memoizedState,g.state=Ce,Ha(t,i,g,f),za();var Le=t.memoizedState;S!==Ue||Ce!==Le||Er||e!==null&&e.dependencies!==null&&ai(e.dependencies)?(typeof E=="function"&&(fd(t,r,E,i),Le=t.memoizedState),(ze=Er||Vg(t,r,ze,i,Ce,Le,Y)||e!==null&&e.dependencies!==null&&ai(e.dependencies))?(we||typeof g.UNSAFE_componentWillUpdate!="function"&&typeof g.componentWillUpdate!="function"||(typeof g.componentWillUpdate=="function"&&g.componentWillUpdate(i,Le,Y),typeof g.UNSAFE_componentWillUpdate=="function"&&g.UNSAFE_componentWillUpdate(i,Le,Y)),typeof g.componentDidUpdate=="function"&&(t.flags|=4),typeof g.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof g.componentDidUpdate!="function"||S===e.memoizedProps&&Ce===e.memoizedState||(t.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||S===e.memoizedProps&&Ce===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=Le),g.props=i,g.state=Le,g.context=Y,i=ze):(typeof g.componentDidUpdate!="function"||S===e.memoizedProps&&Ce===e.memoizedState||(t.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||S===e.memoizedProps&&Ce===e.memoizedState||(t.flags|=1024),i=!1)}return g=i,ki(e,t),i=(t.flags&128)!==0,g||i?(g=t.stateNode,r=i&&typeof r.getDerivedStateFromError!="function"?null:g.render(),t.flags|=1,e!==null&&i?(t.child=us(t,e.child,null,f),t.child=us(t,null,r,f)):zn(e,t,r,f),t.memoizedState=g.state,e=t.child):e=sr(e,t,f),e}function nm(e,t,r,i){return os(),t.flags|=256,zn(e,t,r,i),t.child}var yd={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function bd(e){return{baseLanes:e,cachePool:Fh()}}function xd(e,t,r){return e=e!==null?e.childLanes&~r:0,t&&(e|=fo),e}function om(e,t,r){var i=t.pendingProps,f=!1,g=(t.flags&128)!==0,S;if((S=g)||(S=e!==null&&e.memoizedState===null?!1:(Nn.current&2)!==0),S&&(f=!0,t.flags&=-129),S=(t.flags&32)!==0,t.flags&=-33,e===null){if(Pt){if(f?_r(t):Ar(),(e=mn)?(e=d0(e,Co),e=e!==null&&e.data!=="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:jr!==null?{id:Vo,overflow:$o}:null,retryLane:536870912,hydrationErrors:null},r=Dh(e),r.return=t,t.child=r,Dn=t,mn=null)):e=null,e===null)throw Or(t);return tf(e)?t.lanes=32:t.lanes=536870912,null}var E=i.children;return i=i.fallback,f?(Ar(),f=t.mode,E=ji({mode:"hidden",children:E},f),i=ns(i,f,r,null),E.return=t,i.return=t,E.sibling=i,t.child=E,i=t.child,i.memoizedState=bd(r),i.childLanes=xd(e,S,r),t.memoizedState=yd,Wa(null,i)):(_r(t),vd(t,E))}var Y=e.memoizedState;if(Y!==null&&(E=Y.dehydrated,E!==null)){if(g)t.flags&256?(_r(t),t.flags&=-257,t=wd(e,t,r)):t.memoizedState!==null?(Ar(),t.child=e.child,t.flags|=128,t=null):(Ar(),E=i.fallback,f=t.mode,i=ji({mode:"visible",children:i.children},f),E=ns(E,f,r,null),E.flags|=2,i.return=t,E.return=t,i.sibling=E,t.child=i,us(t,e.child,null,r),i=t.child,i.memoizedState=bd(r),i.childLanes=xd(e,S,r),t.memoizedState=yd,t=Wa(null,i));else if(_r(t),tf(E)){if(S=E.nextSibling&&E.nextSibling.dataset,S)var we=S.dgst;S=we,i=Error(a(419)),i.stack="",i.digest=S,La({value:i,source:null,stack:null}),t=wd(e,t,r)}else if(En||Ds(e,t,r,!1),S=(r&e.childLanes)!==0,En||S){if(S=fn,S!==null&&(i=rt(S,r),i!==0&&i!==Y.retryLane))throw Y.retryLane=i,ts(e,i),to(S,e,i),gd;ef(E)||Ri(),t=wd(e,t,r)}else ef(E)?(t.flags|=192,t.child=e.child,t=null):(e=Y.treeContext,mn=jo(E.nextSibling),Dn=t,Pt=!0,Mr=null,Co=!1,e!==null&&Hh(t,e),t=vd(t,i.children),t.flags|=4096);return t}return f?(Ar(),E=i.fallback,f=t.mode,Y=e.child,we=Y.sibling,i=Jo(Y,{mode:"hidden",children:i.children}),i.subtreeFlags=Y.subtreeFlags&65011712,we!==null?E=Jo(we,E):(E=ns(E,f,r,null),E.flags|=2),E.return=t,i.return=t,i.sibling=E,t.child=i,Wa(null,i),i=t.child,E=e.child.memoizedState,E===null?E=bd(r):(f=E.cachePool,f!==null?(Y=On._currentValue,f=f.parent!==Y?{parent:Y,pool:Y}:f):f=Fh(),E={baseLanes:E.baseLanes|r,cachePool:f}),i.memoizedState=E,i.childLanes=xd(e,S,r),t.memoizedState=yd,Wa(e.child,i)):(_r(t),r=e.child,e=r.sibling,r=Jo(r,{mode:"visible",children:i.children}),r.return=t,r.sibling=null,e!==null&&(S=t.deletions,S===null?(t.deletions=[e],t.flags|=16):S.push(e)),t.child=r,t.memoizedState=null,r)}function vd(e,t){return t=ji({mode:"visible",children:t},e.mode),t.return=e,e.child=t}function ji(e,t){return e=lo(22,e,null,t),e.lanes=0,e}function wd(e,t,r){return us(t,e.child,null,r),e=vd(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function rm(e,t,r){e.lanes|=t;var i=e.alternate;i!==null&&(i.lanes|=t),Dc(e.return,t,r)}function Sd(e,t,r,i,f,g){var S=e.memoizedState;S===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:r,tailMode:f,treeForkCount:g}:(S.isBackwards=t,S.rendering=null,S.renderingStartTime=0,S.last=i,S.tail=r,S.tailMode=f,S.treeForkCount=g)}function sm(e,t,r){var i=t.pendingProps,f=i.revealOrder,g=i.tail;i=i.children;var S=Nn.current,E=(S&2)!==0;if(E?(S=S&1|2,t.flags|=128):S&=1,K(Nn,S),zn(e,t,i,r),i=Pt?Ia:0,!E&&e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&rm(e,r,t);else if(e.tag===19)rm(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(f){case"forwards":for(r=t.child,f=null;r!==null;)e=r.alternate,e!==null&&hi(e)===null&&(f=r),r=r.sibling;r=f,r===null?(f=t.child,t.child=null):(f=r.sibling,r.sibling=null),Sd(t,!1,f,r,g,i);break;case"backwards":case"unstable_legacy-backwards":for(r=null,f=t.child,t.child=null;f!==null;){if(e=f.alternate,e!==null&&hi(e)===null){t.child=f;break}e=f.sibling,f.sibling=r,r=f,f=e}Sd(t,!0,r,null,g,i);break;case"together":Sd(t,!1,null,null,void 0,i);break;default:t.memoizedState=null}return t.child}function sr(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Br|=t.lanes,(r&t.childLanes)===0)if(e!==null){if(Ds(e,t,r,!1),(r&t.childLanes)===0)return null}else return null;if(e!==null&&t.child!==e.child)throw Error(a(153));if(t.child!==null){for(e=t.child,r=Jo(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Jo(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function Nd(e,t){return(e.lanes&t)!==0?!0:(e=e.dependencies,!!(e!==null&&ai(e)))}function f1(e,t,r){switch(t.tag){case 3:Ee(t,t.stateNode.containerInfo),Tr(t,On,e.memoizedState.cache),os();break;case 27:case 5:se(t);break;case 4:Ee(t,t.stateNode.containerInfo);break;case 10:Tr(t,t.type,t.memoizedProps.value);break;case 31:if(t.memoizedState!==null)return t.flags|=128,Pc(t),null;break;case 13:var i=t.memoizedState;if(i!==null)return i.dehydrated!==null?(_r(t),t.flags|=128,null):(r&t.child.childLanes)!==0?om(e,t,r):(_r(t),e=sr(e,t,r),e!==null?e.sibling:null);_r(t);break;case 19:var f=(e.flags&128)!==0;if(i=(r&t.childLanes)!==0,i||(Ds(e,t,r,!1),i=(r&t.childLanes)!==0),f){if(i)return sm(e,t,r);t.flags|=128}if(f=t.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),K(Nn,Nn.current),i)break;return null;case 22:return t.lanes=0,Xg(e,t,r,t.pendingProps);case 24:Tr(t,On,e.memoizedState.cache)}return sr(e,t,r)}function am(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps)En=!0;else{if(!Nd(e,r)&&(t.flags&128)===0)return En=!1,f1(e,t,r);En=(e.flags&131072)!==0}else En=!1,Pt&&(t.flags&1048576)!==0&&zh(t,Ia,t.index);switch(t.lanes=0,t.tag){case 16:e:{var i=t.pendingProps;if(e=ls(t.elementType),t.type=e,typeof e=="function")Oc(e)?(i=ds(e,i),t.tag=1,t=tm(null,t,e,i,r)):(t.tag=0,t=md(null,t,e,i,r));else{if(e!=null){var f=e.$$typeof;if(f===D){t.tag=11,t=Pg(null,t,e,i,r);break e}else if(f===A){t.tag=14,t=Yg(null,t,e,i,r);break e}}throw t=Te(e)||e,Error(a(306,t,""))}}return t;case 0:return md(e,t,t.type,t.pendingProps,r);case 1:return i=t.type,f=ds(i,t.pendingProps),tm(e,t,i,f,r);case 3:e:{if(Ee(t,t.stateNode.containerInfo),e===null)throw Error(a(387));i=t.pendingProps;var g=t.memoizedState;f=g.element,Uc(e,t),Ha(t,i,null,r);var S=t.memoizedState;if(i=S.cache,Tr(t,On,i),i!==g.cache&&Bc(t,[On],r,!0),za(),i=S.element,g.isDehydrated)if(g={element:i,isDehydrated:!1,cache:S.cache},t.updateQueue.baseState=g,t.memoizedState=g,t.flags&256){t=nm(e,t,i,r);break e}else if(i!==f){f=wo(Error(a(424)),t),La(f),t=nm(e,t,i,r);break e}else for(e=t.stateNode.containerInfo,e.nodeType===9?e=e.body:e=e.nodeName==="HTML"?e.ownerDocument.body:e,mn=jo(e.firstChild),Dn=t,Pt=!0,Mr=null,Co=!0,r=Xh(t,null,i,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(os(),i===f){t=sr(e,t,r);break e}zn(e,t,i,r)}t=t.child}return t;case 26:return ki(e,t),e===null?(r=y0(t.type,null,t.pendingProps,null))?t.memoizedState=r:Pt||(r=t.type,e=t.pendingProps,i=Ki(Re.current).createElement(r),i[ht]=t,i[Ct]=e,Hn(i,r,e),tt(i),t.stateNode=i):t.memoizedState=y0(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return se(t),e===null&&Pt&&(i=t.stateNode=h0(t.type,t.pendingProps,Re.current),Dn=t,Co=!0,f=mn,Kr(t.type)?(nf=f,mn=jo(i.firstChild)):mn=f),zn(e,t,t.pendingProps.children,r),ki(e,t),e===null&&(t.flags|=4194304),t.child;case 5:return e===null&&Pt&&((f=i=mn)&&(i=K1(i,t.type,t.pendingProps,Co),i!==null?(t.stateNode=i,Dn=t,mn=jo(i.firstChild),Co=!1,f=!0):f=!1),f||Or(t)),se(t),f=t.type,g=t.pendingProps,S=e!==null?e.memoizedProps:null,i=g.children,Xd(f,g)?i=null:S!==null&&Xd(f,S)&&(t.flags|=32),t.memoizedState!==null&&(f=Qc(e,t,o1,null,null,r),sl._currentValue=f),ki(e,t),zn(e,t,i,r),t.child;case 6:return e===null&&Pt&&((e=r=mn)&&(r=U1(r,t.pendingProps,Co),r!==null?(t.stateNode=r,Dn=t,mn=null,e=!0):e=!1),e||Or(t)),null;case 13:return om(e,t,r);case 4:return Ee(t,t.stateNode.containerInfo),i=t.pendingProps,e===null?t.child=us(t,null,i,r):zn(e,t,i,r),t.child;case 11:return Pg(e,t,t.type,t.pendingProps,r);case 7:return zn(e,t,t.pendingProps,r),t.child;case 8:return zn(e,t,t.pendingProps.children,r),t.child;case 12:return zn(e,t,t.pendingProps.children,r),t.child;case 10:return i=t.pendingProps,Tr(t,t.type,i.value),zn(e,t,i.children,r),t.child;case 9:return f=t.type._context,i=t.pendingProps.children,ss(t),f=Bn(f),i=i(f),t.flags|=1,zn(e,t,i,r),t.child;case 14:return Yg(e,t,t.type,t.pendingProps,r);case 15:return Qg(e,t,t.type,t.pendingProps,r);case 19:return sm(e,t,r);case 31:return d1(e,t,r);case 22:return Xg(e,t,r,t.pendingProps);case 24:return ss(t),i=Bn(On),e===null?(f=Vc(),f===null&&(f=fn,g=zc(),f.pooledCache=g,g.refCount++,g!==null&&(f.pooledCacheLanes|=r),f=g),t.memoizedState={parent:i,cache:f},Kc(t),Tr(t,On,f)):((e.lanes&r)!==0&&(Uc(e,t),Ha(t,null,null,r),za()),f=e.memoizedState,g=t.memoizedState,f.parent!==i?(f={parent:i,cache:i},t.memoizedState=f,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=f),Tr(t,On,i)):(i=g.cache,Tr(t,On,i),i!==f.cache&&Bc(t,[On],r,!0))),zn(e,t,t.pendingProps.children,r),t.child;case 29:throw t.pendingProps}throw Error(a(156,t.tag))}function ar(e){e.flags|=4}function Cd(e,t,r,i,f){if((t=(e.mode&32)!==0)&&(t=!1),t){if(e.flags|=16777216,(f&335544128)===f)if(e.stateNode.complete)e.flags|=8192;else if(_m())e.flags|=8192;else throw is=ci,$c}else e.flags&=-16777217}function lm(e,t){if(t.type!=="stylesheet"||(t.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!S0(t))if(_m())e.flags|=8192;else throw is=ci,$c}function Mi(e,t){t!==null&&(e.flags|=4),e.flags&16384&&(t=e.tag!==22?Et():536870912,e.lanes|=t,Ps|=t)}function Fa(e,t){if(!Pt)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var i=null;r!==null;)r.alternate!==null&&(i=r),r=r.sibling;i===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:i.sibling=null}}function yn(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,i=0;if(t)for(var f=e.child;f!==null;)r|=f.lanes|f.childLanes,i|=f.subtreeFlags&65011712,i|=f.flags&65011712,f.return=e,f=f.sibling;else for(f=e.child;f!==null;)r|=f.lanes|f.childLanes,i|=f.subtreeFlags,i|=f.flags,f.return=e,f=f.sibling;return e.subtreeFlags|=i,e.childLanes=r,t}function p1(e,t,r){var i=t.pendingProps;switch(Lc(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return yn(t),null;case 1:return yn(t),null;case 3:return r=t.stateNode,i=null,e!==null&&(i=e.memoizedState.cache),t.memoizedState.cache!==i&&(t.flags|=2048),nr(On),xe(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(Rs(t)?ar(t):e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,Ac())),yn(t),null;case 26:var f=t.type,g=t.memoizedState;return e===null?(ar(t),g!==null?(yn(t),lm(t,g)):(yn(t),Cd(t,f,null,i,r))):g?g!==e.memoizedState?(ar(t),yn(t),lm(t,g)):(yn(t),t.flags&=-16777217):(e=e.memoizedProps,e!==i&&ar(t),yn(t),Cd(t,f,e,i,r)),null;case 27:if(Z(t),r=Re.current,f=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==i&&ar(t);else{if(!i){if(t.stateNode===null)throw Error(a(166));return yn(t),null}e=je.current,Rs(t)?Vh(t):(e=h0(f,i,r),t.stateNode=e,ar(t))}return yn(t),null;case 5:if(Z(t),f=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==i&&ar(t);else{if(!i){if(t.stateNode===null)throw Error(a(166));return yn(t),null}if(g=je.current,Rs(t))Vh(t);else{var S=Ki(Re.current);switch(g){case 1:g=S.createElementNS("http://www.w3.org/2000/svg",f);break;case 2:g=S.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;default:switch(f){case"svg":g=S.createElementNS("http://www.w3.org/2000/svg",f);break;case"math":g=S.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;case"script":g=S.createElement("div"),g.innerHTML="<script><\/script>",g=g.removeChild(g.firstChild);break;case"select":g=typeof i.is=="string"?S.createElement("select",{is:i.is}):S.createElement("select"),i.multiple?g.multiple=!0:i.size&&(g.size=i.size);break;default:g=typeof i.is=="string"?S.createElement(f,{is:i.is}):S.createElement(f)}}g[ht]=t,g[Ct]=i;e:for(S=t.child;S!==null;){if(S.tag===5||S.tag===6)g.appendChild(S.stateNode);else if(S.tag!==4&&S.tag!==27&&S.child!==null){S.child.return=S,S=S.child;continue}if(S===t)break e;for(;S.sibling===null;){if(S.return===null||S.return===t)break e;S=S.return}S.sibling.return=S.return,S=S.sibling}t.stateNode=g;e:switch(Hn(g,f,i),f){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}i&&ar(t)}}return yn(t),Cd(t,t.type,e===null?null:e.memoizedProps,t.pendingProps,r),null;case 6:if(e&&t.stateNode!=null)e.memoizedProps!==i&&ar(t);else{if(typeof i!="string"&&t.stateNode===null)throw Error(a(166));if(e=Re.current,Rs(t)){if(e=t.stateNode,r=t.memoizedProps,i=null,f=Dn,f!==null)switch(f.tag){case 27:case 5:i=f.memoizedProps}e[ht]=t,e=!!(e.nodeValue===r||i!==null&&i.suppressHydrationWarning===!0||o0(e.nodeValue,r)),e||Or(t,!0)}else e=Ki(e).createTextNode(i),e[ht]=t,t.stateNode=e}return yn(t),null;case 31:if(r=t.memoizedState,e===null||e.memoizedState!==null){if(i=Rs(t),r!==null){if(e===null){if(!i)throw Error(a(318));if(e=t.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(a(557));e[ht]=t}else os(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;yn(t),e=!1}else r=Ac(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=r),e=!0;if(!e)return t.flags&256?(uo(t),t):(uo(t),null);if((t.flags&128)!==0)throw Error(a(558))}return yn(t),null;case 13:if(i=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(f=Rs(t),i!==null&&i.dehydrated!==null){if(e===null){if(!f)throw Error(a(318));if(f=t.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(a(317));f[ht]=t}else os(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;yn(t),f=!1}else f=Ac(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=f),f=!0;if(!f)return t.flags&256?(uo(t),t):(uo(t),null)}return uo(t),(t.flags&128)!==0?(t.lanes=r,t):(r=i!==null,e=e!==null&&e.memoizedState!==null,r&&(i=t.child,f=null,i.alternate!==null&&i.alternate.memoizedState!==null&&i.alternate.memoizedState.cachePool!==null&&(f=i.alternate.memoizedState.cachePool.pool),g=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(g=i.memoizedState.cachePool.pool),g!==f&&(i.flags|=2048)),r!==e&&r&&(t.child.flags|=8192),Mi(t,t.updateQueue),yn(t),null);case 4:return xe(),e===null&&qd(t.stateNode.containerInfo),yn(t),null;case 10:return nr(t.type),yn(t),null;case 19:if(L(Nn),i=t.memoizedState,i===null)return yn(t),null;if(f=(t.flags&128)!==0,g=i.rendering,g===null)if(f)Fa(i,!1);else{if(wn!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(g=hi(e),g!==null){for(t.flags|=128,Fa(i,!1),e=g.updateQueue,t.updateQueue=e,Mi(t,e),t.subtreeFlags=0,e=r,r=t.child;r!==null;)Rh(r,e),r=r.sibling;return K(Nn,Nn.current&1|2),Pt&&er(t,i.treeForkCount),t.child}e=e.sibling}i.tail!==null&&ae()>Li&&(t.flags|=128,f=!0,Fa(i,!1),t.lanes=4194304)}else{if(!f)if(e=hi(g),e!==null){if(t.flags|=128,f=!0,e=e.updateQueue,t.updateQueue=e,Mi(t,e),Fa(i,!0),i.tail===null&&i.tailMode==="hidden"&&!g.alternate&&!Pt)return yn(t),null}else 2*ae()-i.renderingStartTime>Li&&r!==536870912&&(t.flags|=128,f=!0,Fa(i,!1),t.lanes=4194304);i.isBackwards?(g.sibling=t.child,t.child=g):(e=i.last,e!==null?e.sibling=g:t.child=g,i.last=g)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=ae(),e.sibling=null,r=Nn.current,K(Nn,f?r&1|2:r&1),Pt&&er(t,i.treeForkCount),e):(yn(t),null);case 22:case 23:return uo(t),Gc(),i=t.memoizedState!==null,e!==null?e.memoizedState!==null!==i&&(t.flags|=8192):i&&(t.flags|=8192),i?(r&536870912)!==0&&(t.flags&128)===0&&(yn(t),t.subtreeFlags&6&&(t.flags|=8192)):yn(t),r=t.updateQueue,r!==null&&Mi(t,r.retryQueue),r=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(r=e.memoizedState.cachePool.pool),i=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(i=t.memoizedState.cachePool.pool),i!==r&&(t.flags|=2048),e!==null&&L(as),null;case 24:return r=null,e!==null&&(r=e.memoizedState.cache),t.memoizedState.cache!==r&&(t.flags|=2048),nr(On),yn(t),null;case 25:return null;case 30:return null}throw Error(a(156,t.tag))}function h1(e,t){switch(Lc(t),t.tag){case 1:return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return nr(On),xe(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 26:case 27:case 5:return Z(t),null;case 31:if(t.memoizedState!==null){if(uo(t),t.alternate===null)throw Error(a(340));os()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 13:if(uo(t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(a(340));os()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return L(Nn),null;case 4:return xe(),null;case 10:return nr(t.type),null;case 22:case 23:return uo(t),Gc(),e!==null&&L(as),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 24:return nr(On),null;case 25:return null;default:return null}}function im(e,t){switch(Lc(t),t.tag){case 3:nr(On),xe();break;case 26:case 27:case 5:Z(t);break;case 4:xe();break;case 31:t.memoizedState!==null&&uo(t);break;case 13:uo(t);break;case 19:L(Nn);break;case 10:nr(t.type);break;case 22:case 23:uo(t),Gc(),e!==null&&L(as);break;case 24:nr(On)}}function qa(e,t){try{var r=t.updateQueue,i=r!==null?r.lastEffect:null;if(i!==null){var f=i.next;r=f;do{if((r.tag&e)===e){i=void 0;var g=r.create,S=r.inst;i=g(),S.destroy=i}r=r.next}while(r!==f)}}catch(E){an(t,t.return,E)}}function Rr(e,t,r){try{var i=t.updateQueue,f=i!==null?i.lastEffect:null;if(f!==null){var g=f.next;i=g;do{if((i.tag&e)===e){var S=i.inst,E=S.destroy;if(E!==void 0){S.destroy=void 0,f=t;var Y=r,we=E;try{we()}catch(ze){an(f,Y,ze)}}}i=i.next}while(i!==g)}}catch(ze){an(t,t.return,ze)}}function um(e){var t=e.updateQueue;if(t!==null){var r=e.stateNode;try{Jh(t,r)}catch(i){an(e,e.return,i)}}}function cm(e,t,r){r.props=ds(e.type,e.memoizedProps),r.state=e.memoizedState;try{r.componentWillUnmount()}catch(i){an(e,t,i)}}function Ga(e,t){try{var r=e.ref;if(r!==null){switch(e.tag){case 26:case 27:case 5:var i=e.stateNode;break;case 30:i=e.stateNode;break;default:i=e.stateNode}typeof r=="function"?e.refCleanup=r(i):r.current=i}}catch(f){an(e,t,f)}}function Ko(e,t){var r=e.ref,i=e.refCleanup;if(r!==null)if(typeof i=="function")try{i()}catch(f){an(e,t,f)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof r=="function")try{r(null)}catch(f){an(e,t,f)}else r.current=null}function dm(e){var t=e.type,r=e.memoizedProps,i=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":r.autoFocus&&i.focus();break e;case"img":r.src?i.src=r.src:r.srcSet&&(i.srcset=r.srcSet)}}catch(f){an(e,e.return,f)}}function kd(e,t,r){try{var i=e.stateNode;D1(i,e.type,r,t),i[Ct]=t}catch(f){an(e,e.return,f)}}function fm(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&Kr(e.type)||e.tag===4}function jd(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||fm(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&Kr(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Md(e,t,r){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r).insertBefore(e,t):(t=r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,t.appendChild(e),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=xo));else if(i!==4&&(i===27&&Kr(e.type)&&(r=e.stateNode,t=null),e=e.child,e!==null))for(Md(e,t,r),e=e.sibling;e!==null;)Md(e,t,r),e=e.sibling}function Oi(e,t,r){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(i!==4&&(i===27&&Kr(e.type)&&(r=e.stateNode),e=e.child,e!==null))for(Oi(e,t,r),e=e.sibling;e!==null;)Oi(e,t,r),e=e.sibling}function pm(e){var t=e.stateNode,r=e.memoizedProps;try{for(var i=e.type,f=t.attributes;f.length;)t.removeAttributeNode(f[0]);Hn(t,i,r),t[ht]=e,t[Ct]=r}catch(g){an(e,e.return,g)}}var lr=!1,In=!1,Od=!1,hm=typeof WeakSet=="function"?WeakSet:Set,Rn=null;function g1(e,t){if(e=e.containerInfo,Yd=Yi,e=jh(e),wc(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var i=r.getSelection&&r.getSelection();if(i&&i.rangeCount!==0){r=i.anchorNode;var f=i.anchorOffset,g=i.focusNode;i=i.focusOffset;try{r.nodeType,g.nodeType}catch{r=null;break e}var S=0,E=-1,Y=-1,we=0,ze=0,Ue=e,Ce=null;t:for(;;){for(var Le;Ue!==r||f!==0&&Ue.nodeType!==3||(E=S+f),Ue!==g||i!==0&&Ue.nodeType!==3||(Y=S+i),Ue.nodeType===3&&(S+=Ue.nodeValue.length),(Le=Ue.firstChild)!==null;)Ce=Ue,Ue=Le;for(;;){if(Ue===e)break t;if(Ce===r&&++we===f&&(E=S),Ce===g&&++ze===i&&(Y=S),(Le=Ue.nextSibling)!==null)break;Ue=Ce,Ce=Ue.parentNode}Ue=Le}r=E===-1||Y===-1?null:{start:E,end:Y}}else r=null}r=r||{start:0,end:0}}else r=null;for(Qd={focusedElem:e,selectionRange:r},Yi=!1,Rn=t;Rn!==null;)if(t=Rn,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Rn=e;else for(;Rn!==null;){switch(t=Rn,g=t.alternate,e=t.flags,t.tag){case 0:if((e&4)!==0&&(e=t.updateQueue,e=e!==null?e.events:null,e!==null))for(r=0;r<e.length;r++)f=e[r],f.ref.impl=f.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&g!==null){e=void 0,r=t,f=g.memoizedProps,g=g.memoizedState,i=r.stateNode;try{var it=ds(r.type,f);e=i.getSnapshotBeforeUpdate(it,g),i.__reactInternalSnapshotBeforeUpdate=e}catch(Tt){an(r,r.return,Tt)}}break;case 3:if((e&1024)!==0){if(e=t.stateNode.containerInfo,r=e.nodeType,r===9)Jd(e);else if(r===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Jd(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(a(163))}if(e=t.sibling,e!==null){e.return=t.return,Rn=e;break}Rn=t.return}}function gm(e,t,r){var i=r.flags;switch(r.tag){case 0:case 11:case 15:ur(e,r),i&4&&qa(5,r);break;case 1:if(ur(e,r),i&4)if(e=r.stateNode,t===null)try{e.componentDidMount()}catch(S){an(r,r.return,S)}else{var f=ds(r.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(f,t,e.__reactInternalSnapshotBeforeUpdate)}catch(S){an(r,r.return,S)}}i&64&&um(r),i&512&&Ga(r,r.return);break;case 3:if(ur(e,r),i&64&&(e=r.updateQueue,e!==null)){if(t=null,r.child!==null)switch(r.child.tag){case 27:case 5:t=r.child.stateNode;break;case 1:t=r.child.stateNode}try{Jh(e,t)}catch(S){an(r,r.return,S)}}break;case 27:t===null&&i&4&&pm(r);case 26:case 5:ur(e,r),t===null&&i&4&&dm(r),i&512&&Ga(r,r.return);break;case 12:ur(e,r);break;case 31:ur(e,r),i&4&&bm(e,r);break;case 13:ur(e,r),i&4&&xm(e,r),i&64&&(e=r.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(r=C1.bind(null,r),W1(e,r))));break;case 22:if(i=r.memoizedState!==null||lr,!i){t=t!==null&&t.memoizedState!==null||In,f=lr;var g=In;lr=i,(In=t)&&!g?cr(e,r,(r.subtreeFlags&8772)!==0):ur(e,r),lr=f,In=g}break;case 30:break;default:ur(e,r)}}function mm(e){var t=e.alternate;t!==null&&(e.alternate=null,mm(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&Q(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var xn=null,Xn=!1;function ir(e,t,r){for(r=r.child;r!==null;)ym(e,t,r),r=r.sibling}function ym(e,t,r){if(Ie&&typeof Ie.onCommitFiberUnmount=="function")try{Ie.onCommitFiberUnmount(Xe,r)}catch{}switch(r.tag){case 26:In||Ko(r,t),ir(e,t,r),r.memoizedState?r.memoizedState.count--:r.stateNode&&(r=r.stateNode,r.parentNode.removeChild(r));break;case 27:In||Ko(r,t);var i=xn,f=Xn;Kr(r.type)&&(xn=r.stateNode,Xn=!1),ir(e,t,r),nl(r.stateNode),xn=i,Xn=f;break;case 5:In||Ko(r,t);case 6:if(i=xn,f=Xn,xn=null,ir(e,t,r),xn=i,Xn=f,xn!==null)if(Xn)try{(xn.nodeType===9?xn.body:xn.nodeName==="HTML"?xn.ownerDocument.body:xn).removeChild(r.stateNode)}catch(g){an(r,t,g)}else try{xn.removeChild(r.stateNode)}catch(g){an(r,t,g)}break;case 18:xn!==null&&(Xn?(e=xn,u0(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,r.stateNode),na(e)):u0(xn,r.stateNode));break;case 4:i=xn,f=Xn,xn=r.stateNode.containerInfo,Xn=!0,ir(e,t,r),xn=i,Xn=f;break;case 0:case 11:case 14:case 15:Rr(2,r,t),In||Rr(4,r,t),ir(e,t,r);break;case 1:In||(Ko(r,t),i=r.stateNode,typeof i.componentWillUnmount=="function"&&cm(r,t,i)),ir(e,t,r);break;case 21:ir(e,t,r);break;case 22:In=(i=In)||r.memoizedState!==null,ir(e,t,r),In=i;break;default:ir(e,t,r)}}function bm(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{na(e)}catch(r){an(t,t.return,r)}}}function xm(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{na(e)}catch(r){an(t,t.return,r)}}function m1(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return t===null&&(t=e.stateNode=new hm),t;case 22:return e=e.stateNode,t=e._retryCache,t===null&&(t=e._retryCache=new hm),t;default:throw Error(a(435,e.tag))}}function Ti(e,t){var r=m1(e);t.forEach(function(i){if(!r.has(i)){r.add(i);var f=k1.bind(null,e,i);i.then(f,f)}})}function Zn(e,t){var r=t.deletions;if(r!==null)for(var i=0;i<r.length;i++){var f=r[i],g=e,S=t,E=S;e:for(;E!==null;){switch(E.tag){case 27:if(Kr(E.type)){xn=E.stateNode,Xn=!1;break e}break;case 5:xn=E.stateNode,Xn=!1;break e;case 3:case 4:xn=E.stateNode.containerInfo,Xn=!0;break e}E=E.return}if(xn===null)throw Error(a(160));ym(g,S,f),xn=null,Xn=!1,g=f.alternate,g!==null&&(g.return=null),f.return=null}if(t.subtreeFlags&13886)for(t=t.child;t!==null;)vm(t,e),t=t.sibling}var Lo=null;function vm(e,t){var r=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Zn(t,e),Jn(e),i&4&&(Rr(3,e,e.return),qa(3,e),Rr(5,e,e.return));break;case 1:Zn(t,e),Jn(e),i&512&&(In||r===null||Ko(r,r.return)),i&64&&lr&&(e=e.updateQueue,e!==null&&(i=e.callbacks,i!==null&&(r=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=r===null?i:r.concat(i))));break;case 26:var f=Lo;if(Zn(t,e),Jn(e),i&512&&(In||r===null||Ko(r,r.return)),i&4){var g=r!==null?r.memoizedState:null;if(i=e.memoizedState,r===null)if(i===null)if(e.stateNode===null){e:{i=e.type,r=e.memoizedProps,f=f.ownerDocument||f;t:switch(i){case"title":g=f.getElementsByTagName("title")[0],(!g||g[nn]||g[ht]||g.namespaceURI==="http://www.w3.org/2000/svg"||g.hasAttribute("itemprop"))&&(g=f.createElement(i),f.head.insertBefore(g,f.querySelector("head > title"))),Hn(g,i,r),g[ht]=e,tt(g),i=g;break e;case"link":var S=v0("link","href",f).get(i+(r.href||""));if(S){for(var E=0;E<S.length;E++)if(g=S[E],g.getAttribute("href")===(r.href==null||r.href===""?null:r.href)&&g.getAttribute("rel")===(r.rel==null?null:r.rel)&&g.getAttribute("title")===(r.title==null?null:r.title)&&g.getAttribute("crossorigin")===(r.crossOrigin==null?null:r.crossOrigin)){S.splice(E,1);break t}}g=f.createElement(i),Hn(g,i,r),f.head.appendChild(g);break;case"meta":if(S=v0("meta","content",f).get(i+(r.content||""))){for(E=0;E<S.length;E++)if(g=S[E],g.getAttribute("content")===(r.content==null?null:""+r.content)&&g.getAttribute("name")===(r.name==null?null:r.name)&&g.getAttribute("property")===(r.property==null?null:r.property)&&g.getAttribute("http-equiv")===(r.httpEquiv==null?null:r.httpEquiv)&&g.getAttribute("charset")===(r.charSet==null?null:r.charSet)){S.splice(E,1);break t}}g=f.createElement(i),Hn(g,i,r),f.head.appendChild(g);break;default:throw Error(a(468,i))}g[ht]=e,tt(g),i=g}e.stateNode=i}else w0(f,e.type,e.stateNode);else e.stateNode=x0(f,i,e.memoizedProps);else g!==i?(g===null?r.stateNode!==null&&(r=r.stateNode,r.parentNode.removeChild(r)):g.count--,i===null?w0(f,e.type,e.stateNode):x0(f,i,e.memoizedProps)):i===null&&e.stateNode!==null&&kd(e,e.memoizedProps,r.memoizedProps)}break;case 27:Zn(t,e),Jn(e),i&512&&(In||r===null||Ko(r,r.return)),r!==null&&i&4&&kd(e,e.memoizedProps,r.memoizedProps);break;case 5:if(Zn(t,e),Jn(e),i&512&&(In||r===null||Ko(r,r.return)),e.flags&32){f=e.stateNode;try{Cr(f,"")}catch(it){an(e,e.return,it)}}i&4&&e.stateNode!=null&&(f=e.memoizedProps,kd(e,f,r!==null?r.memoizedProps:f)),i&1024&&(Od=!0);break;case 6:if(Zn(t,e),Jn(e),i&4){if(e.stateNode===null)throw Error(a(162));i=e.memoizedProps,r=e.stateNode;try{r.nodeValue=i}catch(it){an(e,e.return,it)}}break;case 3:if(Fi=null,f=Lo,Lo=Ui(t.containerInfo),Zn(t,e),Lo=f,Jn(e),i&4&&r!==null&&r.memoizedState.isDehydrated)try{na(t.containerInfo)}catch(it){an(e,e.return,it)}Od&&(Od=!1,wm(e));break;case 4:i=Lo,Lo=Ui(e.stateNode.containerInfo),Zn(t,e),Jn(e),Lo=i;break;case 12:Zn(t,e),Jn(e);break;case 31:Zn(t,e),Jn(e),i&4&&(i=e.updateQueue,i!==null&&(e.updateQueue=null,Ti(e,i)));break;case 13:Zn(t,e),Jn(e),e.child.flags&8192&&e.memoizedState!==null!=(r!==null&&r.memoizedState!==null)&&(Ii=ae()),i&4&&(i=e.updateQueue,i!==null&&(e.updateQueue=null,Ti(e,i)));break;case 22:f=e.memoizedState!==null;var Y=r!==null&&r.memoizedState!==null,we=lr,ze=In;if(lr=we||f,In=ze||Y,Zn(t,e),In=ze,lr=we,Jn(e),i&8192)e:for(t=e.stateNode,t._visibility=f?t._visibility&-2:t._visibility|1,f&&(r===null||Y||lr||In||fs(e)),r=null,t=e;;){if(t.tag===5||t.tag===26){if(r===null){Y=r=t;try{if(g=Y.stateNode,f)S=g.style,typeof S.setProperty=="function"?S.setProperty("display","none","important"):S.display="none";else{E=Y.stateNode;var Ue=Y.memoizedProps.style,Ce=Ue!=null&&Ue.hasOwnProperty("display")?Ue.display:null;E.style.display=Ce==null||typeof Ce=="boolean"?"":(""+Ce).trim()}}catch(it){an(Y,Y.return,it)}}}else if(t.tag===6){if(r===null){Y=t;try{Y.stateNode.nodeValue=f?"":Y.memoizedProps}catch(it){an(Y,Y.return,it)}}}else if(t.tag===18){if(r===null){Y=t;try{var Le=Y.stateNode;f?c0(Le,!0):c0(Y.stateNode,!1)}catch(it){an(Y,Y.return,it)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;r===t&&(r=null),t=t.return}r===t&&(r=null),t.sibling.return=t.return,t=t.sibling}i&4&&(i=e.updateQueue,i!==null&&(r=i.retryQueue,r!==null&&(i.retryQueue=null,Ti(e,r))));break;case 19:Zn(t,e),Jn(e),i&4&&(i=e.updateQueue,i!==null&&(e.updateQueue=null,Ti(e,i)));break;case 30:break;case 21:break;default:Zn(t,e),Jn(e)}}function Jn(e){var t=e.flags;if(t&2){try{for(var r,i=e.return;i!==null;){if(fm(i)){r=i;break}i=i.return}if(r==null)throw Error(a(160));switch(r.tag){case 27:var f=r.stateNode,g=jd(e);Oi(e,g,f);break;case 5:var S=r.stateNode;r.flags&32&&(Cr(S,""),r.flags&=-33);var E=jd(e);Oi(e,E,S);break;case 3:case 4:var Y=r.stateNode.containerInfo,we=jd(e);Md(e,we,Y);break;default:throw Error(a(161))}}catch(ze){an(e,e.return,ze)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function wm(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var t=e;wm(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),e=e.sibling}}function ur(e,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)gm(e,t.alternate,t),t=t.sibling}function fs(e){for(e=e.child;e!==null;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:Rr(4,t,t.return),fs(t);break;case 1:Ko(t,t.return);var r=t.stateNode;typeof r.componentWillUnmount=="function"&&cm(t,t.return,r),fs(t);break;case 27:nl(t.stateNode);case 26:case 5:Ko(t,t.return),fs(t);break;case 22:t.memoizedState===null&&fs(t);break;case 30:fs(t);break;default:fs(t)}e=e.sibling}}function cr(e,t,r){for(r=r&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var i=t.alternate,f=e,g=t,S=g.flags;switch(g.tag){case 0:case 11:case 15:cr(f,g,r),qa(4,g);break;case 1:if(cr(f,g,r),i=g,f=i.stateNode,typeof f.componentDidMount=="function")try{f.componentDidMount()}catch(we){an(i,i.return,we)}if(i=g,f=i.updateQueue,f!==null){var E=i.stateNode;try{var Y=f.shared.hiddenCallbacks;if(Y!==null)for(f.shared.hiddenCallbacks=null,f=0;f<Y.length;f++)Zh(Y[f],E)}catch(we){an(i,i.return,we)}}r&&S&64&&um(g),Ga(g,g.return);break;case 27:pm(g);case 26:case 5:cr(f,g,r),r&&i===null&&S&4&&dm(g),Ga(g,g.return);break;case 12:cr(f,g,r);break;case 31:cr(f,g,r),r&&S&4&&bm(f,g);break;case 13:cr(f,g,r),r&&S&4&&xm(f,g);break;case 22:g.memoizedState===null&&cr(f,g,r),Ga(g,g.return);break;case 30:break;default:cr(f,g,r)}t=t.sibling}}function Td(e,t){var r=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(r=e.memoizedState.cachePool.pool),e=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(e=t.memoizedState.cachePool.pool),e!==r&&(e!=null&&e.refCount++,r!=null&&_a(r))}function Ed(e,t){e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&_a(e))}function _o(e,t,r,i){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)Sm(e,t,r,i),t=t.sibling}function Sm(e,t,r,i){var f=t.flags;switch(t.tag){case 0:case 11:case 15:_o(e,t,r,i),f&2048&&qa(9,t);break;case 1:_o(e,t,r,i);break;case 3:_o(e,t,r,i),f&2048&&(e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&_a(e)));break;case 12:if(f&2048){_o(e,t,r,i),e=t.stateNode;try{var g=t.memoizedProps,S=g.id,E=g.onPostCommit;typeof E=="function"&&E(S,t.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(Y){an(t,t.return,Y)}}else _o(e,t,r,i);break;case 31:_o(e,t,r,i);break;case 13:_o(e,t,r,i);break;case 23:break;case 22:g=t.stateNode,S=t.alternate,t.memoizedState!==null?g._visibility&2?_o(e,t,r,i):Pa(e,t):g._visibility&2?_o(e,t,r,i):(g._visibility|=2,Fs(e,t,r,i,(t.subtreeFlags&10256)!==0||!1)),f&2048&&Td(S,t);break;case 24:_o(e,t,r,i),f&2048&&Ed(t.alternate,t);break;default:_o(e,t,r,i)}}function Fs(e,t,r,i,f){for(f=f&&((t.subtreeFlags&10256)!==0||!1),t=t.child;t!==null;){var g=e,S=t,E=r,Y=i,we=S.flags;switch(S.tag){case 0:case 11:case 15:Fs(g,S,E,Y,f),qa(8,S);break;case 23:break;case 22:var ze=S.stateNode;S.memoizedState!==null?ze._visibility&2?Fs(g,S,E,Y,f):Pa(g,S):(ze._visibility|=2,Fs(g,S,E,Y,f)),f&&we&2048&&Td(S.alternate,S);break;case 24:Fs(g,S,E,Y,f),f&&we&2048&&Ed(S.alternate,S);break;default:Fs(g,S,E,Y,f)}t=t.sibling}}function Pa(e,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var r=e,i=t,f=i.flags;switch(i.tag){case 22:Pa(r,i),f&2048&&Td(i.alternate,i);break;case 24:Pa(r,i),f&2048&&Ed(i.alternate,i);break;default:Pa(r,i)}t=t.sibling}}var Ya=8192;function qs(e,t,r){if(e.subtreeFlags&Ya)for(e=e.child;e!==null;)Nm(e,t,r),e=e.sibling}function Nm(e,t,r){switch(e.tag){case 26:qs(e,t,r),e.flags&Ya&&e.memoizedState!==null&&nw(r,Lo,e.memoizedState,e.memoizedProps);break;case 5:qs(e,t,r);break;case 3:case 4:var i=Lo;Lo=Ui(e.stateNode.containerInfo),qs(e,t,r),Lo=i;break;case 22:e.memoizedState===null&&(i=e.alternate,i!==null&&i.memoizedState!==null?(i=Ya,Ya=16777216,qs(e,t,r),Ya=i):qs(e,t,r));break;default:qs(e,t,r)}}function Cm(e){var t=e.alternate;if(t!==null&&(e=t.child,e!==null)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(e!==null)}}function Qa(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var r=0;r<t.length;r++){var i=t[r];Rn=i,jm(i,e)}Cm(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)km(e),e=e.sibling}function km(e){switch(e.tag){case 0:case 11:case 15:Qa(e),e.flags&2048&&Rr(9,e,e.return);break;case 3:Qa(e);break;case 12:Qa(e);break;case 22:var t=e.stateNode;e.memoizedState!==null&&t._visibility&2&&(e.return===null||e.return.tag!==13)?(t._visibility&=-3,Ei(e)):Qa(e);break;default:Qa(e)}}function Ei(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var r=0;r<t.length;r++){var i=t[r];Rn=i,jm(i,e)}Cm(e)}for(e=e.child;e!==null;){switch(t=e,t.tag){case 0:case 11:case 15:Rr(8,t,t.return),Ei(t);break;case 22:r=t.stateNode,r._visibility&2&&(r._visibility&=-3,Ei(t));break;default:Ei(t)}e=e.sibling}}function jm(e,t){for(;Rn!==null;){var r=Rn;switch(r.tag){case 0:case 11:case 15:Rr(8,r,t);break;case 23:case 22:if(r.memoizedState!==null&&r.memoizedState.cachePool!==null){var i=r.memoizedState.cachePool.pool;i!=null&&i.refCount++}break;case 24:_a(r.memoizedState.cache)}if(i=r.child,i!==null)i.return=r,Rn=i;else e:for(r=e;Rn!==null;){i=Rn;var f=i.sibling,g=i.return;if(mm(i),i===r){Rn=null;break e}if(f!==null){f.return=g,Rn=f;break e}Rn=g}}}var y1={getCacheForType:function(e){var t=Bn(On),r=t.data.get(e);return r===void 0&&(r=e(),t.data.set(e,r)),r},cacheSignal:function(){return Bn(On).controller.signal}},b1=typeof WeakMap=="function"?WeakMap:Map,Zt=0,fn=null,Ut=null,qt=0,sn=0,co=null,Dr=!1,Gs=!1,Id=!1,dr=0,wn=0,Br=0,ps=0,Ld=0,fo=0,Ps=0,Xa=null,eo=null,_d=!1,Ii=0,Mm=0,Li=1/0,_i=null,zr=null,An=0,Hr=null,Ys=null,fr=0,Ad=0,Rd=null,Om=null,Za=0,Dd=null;function po(){return(Zt&2)!==0&&qt!==0?qt&-qt:_.T!==null?Kd():St()}function Tm(){if(fo===0)if((qt&536870912)===0||Pt){var e=Vt;Vt<<=1,(Vt&3932160)===0&&(Vt=262144),fo=e}else fo=536870912;return e=io.current,e!==null&&(e.flags|=32),fo}function to(e,t,r){(e===fn&&(sn===2||sn===9)||e.cancelPendingCommit!==null)&&(Qs(e,0),Vr(e,qt,fo,!1)),ye(e,r),((Zt&2)===0||e!==fn)&&(e===fn&&((Zt&2)===0&&(ps|=r),wn===4&&Vr(e,qt,fo,!1)),Uo(e))}function Em(e,t,r){if((Zt&6)!==0)throw Error(a(327));var i=!r&&(t&127)===0&&(t&e.expiredLanes)===0||Je(e,t),f=i?w1(e,t):zd(e,t,!0),g=i;do{if(f===0){Gs&&!i&&Vr(e,t,0,!1);break}else{if(r=e.current.alternate,g&&!x1(r)){f=zd(e,t,!1),g=!1;continue}if(f===2){if(g=t,e.errorRecoveryDisabledLanes&g)var S=0;else S=e.pendingLanes&-536870913,S=S!==0?S:S&536870912?536870912:0;if(S!==0){t=S;e:{var E=e;f=Xa;var Y=E.current.memoizedState.isDehydrated;if(Y&&(Qs(E,S).flags|=256),S=zd(E,S,!1),S!==2){if(Id&&!Y){E.errorRecoveryDisabledLanes|=g,ps|=g,f=4;break e}g=eo,eo=f,g!==null&&(eo===null?eo=g:eo.push.apply(eo,g))}f=S}if(g=!1,f!==2)continue}}if(f===1){Qs(e,0),Vr(e,t,0,!0);break}e:{switch(i=e,g=f,g){case 0:case 1:throw Error(a(345));case 4:if((t&4194048)!==t)break;case 6:Vr(i,t,fo,!Dr);break e;case 2:eo=null;break;case 3:case 5:break;default:throw Error(a(329))}if((t&62914560)===t&&(f=Ii+300-ae(),10<f)){if(Vr(i,t,fo,!Dr),Ke(i,0,!0)!==0)break e;fr=t,i.timeoutHandle=l0(Im.bind(null,i,r,eo,_i,_d,t,fo,ps,Ps,Dr,g,"Throttled",-0,0),f);break e}Im(i,r,eo,_i,_d,t,fo,ps,Ps,Dr,g,null,-0,0)}}break}while(!0);Uo(e)}function Im(e,t,r,i,f,g,S,E,Y,we,ze,Ue,Ce,Le){if(e.timeoutHandle=-1,Ue=t.subtreeFlags,Ue&8192||(Ue&16785408)===16785408){Ue={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:xo},Nm(t,g,Ue);var it=(g&62914560)===g?Ii-ae():(g&4194048)===g?Mm-ae():0;if(it=ow(Ue,it),it!==null){fr=g,e.cancelPendingCommit=it(Hm.bind(null,e,t,g,r,i,f,S,E,Y,ze,Ue,null,Ce,Le)),Vr(e,g,S,!we);return}}Hm(e,t,g,r,i,f,S,E,Y)}function x1(e){for(var t=e;;){var r=t.tag;if((r===0||r===11||r===15)&&t.flags&16384&&(r=t.updateQueue,r!==null&&(r=r.stores,r!==null)))for(var i=0;i<r.length;i++){var f=r[i],g=f.getSnapshot;f=f.value;try{if(!ao(g(),f))return!1}catch{return!1}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Vr(e,t,r,i){t&=~Ld,t&=~ps,e.suspendedLanes|=t,e.pingedLanes&=~t,i&&(e.warmLanes|=t),i=e.expirationTimes;for(var f=t;0<f;){var g=31-Ze(f),S=1<<g;i[g]=-1,f&=~S}r!==0&&Ye(e,r,t)}function Ai(){return(Zt&6)===0?(Ja(0),!1):!0}function Bd(){if(Ut!==null){if(sn===0)var e=Ut.return;else e=Ut,tr=rs=null,Jc(e),Vs=null,Ra=0,e=Ut;for(;e!==null;)im(e.alternate,e),e=e.return;Ut=null}}function Qs(e,t){var r=e.timeoutHandle;r!==-1&&(e.timeoutHandle=-1,H1(r)),r=e.cancelPendingCommit,r!==null&&(e.cancelPendingCommit=null,r()),fr=0,Bd(),fn=e,Ut=r=Jo(e.current,null),qt=t,sn=0,co=null,Dr=!1,Gs=Je(e,t),Id=!1,Ps=fo=Ld=ps=Br=wn=0,eo=Xa=null,_d=!1,(t&8)!==0&&(t|=t&32);var i=e.entangledLanes;if(i!==0)for(e=e.entanglements,i&=t;0<i;){var f=31-Ze(i),g=1<<f;t|=e[f],i&=~g}return dr=t,ti(),r}function Lm(e,t){zt=null,_.H=Ua,t===Hs||t===ui?(t=Ph(),sn=3):t===$c?(t=Ph(),sn=4):sn=t===gd?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,co=t,Ut===null&&(wn=1,Ni(e,wo(t,e.current)))}function _m(){var e=io.current;return e===null?!0:(qt&4194048)===qt?ko===null:(qt&62914560)===qt||(qt&536870912)!==0?e===ko:!1}function Am(){var e=_.H;return _.H=Ua,e===null?Ua:e}function Rm(){var e=_.A;return _.A=y1,e}function Ri(){wn=4,Dr||(qt&4194048)!==qt&&io.current!==null||(Gs=!0),(Br&134217727)===0&&(ps&134217727)===0||fn===null||Vr(fn,qt,fo,!1)}function zd(e,t,r){var i=Zt;Zt|=2;var f=Am(),g=Rm();(fn!==e||qt!==t)&&(_i=null,Qs(e,t)),t=!1;var S=wn;e:do try{if(sn!==0&&Ut!==null){var E=Ut,Y=co;switch(sn){case 8:Bd(),S=6;break e;case 3:case 2:case 9:case 6:io.current===null&&(t=!0);var we=sn;if(sn=0,co=null,Xs(e,E,Y,we),r&&Gs){S=0;break e}break;default:we=sn,sn=0,co=null,Xs(e,E,Y,we)}}v1(),S=wn;break}catch(ze){Lm(e,ze)}while(!0);return t&&e.shellSuspendCounter++,tr=rs=null,Zt=i,_.H=f,_.A=g,Ut===null&&(fn=null,qt=0,ti()),S}function v1(){for(;Ut!==null;)Dm(Ut)}function w1(e,t){var r=Zt;Zt|=2;var i=Am(),f=Rm();fn!==e||qt!==t?(_i=null,Li=ae()+500,Qs(e,t)):Gs=Je(e,t);e:do try{if(sn!==0&&Ut!==null){t=Ut;var g=co;t:switch(sn){case 1:sn=0,co=null,Xs(e,t,g,1);break;case 2:case 9:if(qh(g)){sn=0,co=null,Bm(t);break}t=function(){sn!==2&&sn!==9||fn!==e||(sn=7),Uo(e)},g.then(t,t);break e;case 3:sn=7;break e;case 4:sn=5;break e;case 7:qh(g)?(sn=0,co=null,Bm(t)):(sn=0,co=null,Xs(e,t,g,7));break;case 5:var S=null;switch(Ut.tag){case 26:S=Ut.memoizedState;case 5:case 27:var E=Ut;if(S?S0(S):E.stateNode.complete){sn=0,co=null;var Y=E.sibling;if(Y!==null)Ut=Y;else{var we=E.return;we!==null?(Ut=we,Di(we)):Ut=null}break t}}sn=0,co=null,Xs(e,t,g,5);break;case 6:sn=0,co=null,Xs(e,t,g,6);break;case 8:Bd(),wn=6;break e;default:throw Error(a(462))}}S1();break}catch(ze){Lm(e,ze)}while(!0);return tr=rs=null,_.H=i,_.A=f,Zt=r,Ut!==null?0:(fn=null,qt=0,ti(),wn)}function S1(){for(;Ut!==null&&!ee();)Dm(Ut)}function Dm(e){var t=am(e.alternate,e,dr);e.memoizedProps=e.pendingProps,t===null?Di(e):Ut=t}function Bm(e){var t=e,r=t.alternate;switch(t.tag){case 15:case 0:t=em(r,t,t.pendingProps,t.type,void 0,qt);break;case 11:t=em(r,t,t.pendingProps,t.type.render,t.ref,qt);break;case 5:Jc(t);default:im(r,t),t=Ut=Rh(t,dr),t=am(r,t,dr)}e.memoizedProps=e.pendingProps,t===null?Di(e):Ut=t}function Xs(e,t,r,i){tr=rs=null,Jc(t),Vs=null,Ra=0;var f=t.return;try{if(c1(e,f,t,r,qt)){wn=1,Ni(e,wo(r,e.current)),Ut=null;return}}catch(g){if(f!==null)throw Ut=f,g;wn=1,Ni(e,wo(r,e.current)),Ut=null;return}t.flags&32768?(Pt||i===1?e=!0:Gs||(qt&536870912)!==0?e=!1:(Dr=e=!0,(i===2||i===9||i===3||i===6)&&(i=io.current,i!==null&&i.tag===13&&(i.flags|=16384))),zm(t,e)):Di(t)}function Di(e){var t=e;do{if((t.flags&32768)!==0){zm(t,Dr);return}e=t.return;var r=p1(t.alternate,t,dr);if(r!==null){Ut=r;return}if(t=t.sibling,t!==null){Ut=t;return}Ut=t=e}while(t!==null);wn===0&&(wn=5)}function zm(e,t){do{var r=h1(e.alternate,e);if(r!==null){r.flags&=32767,Ut=r;return}if(r=e.return,r!==null&&(r.flags|=32768,r.subtreeFlags=0,r.deletions=null),!t&&(e=e.sibling,e!==null)){Ut=e;return}Ut=e=r}while(e!==null);wn=6,Ut=null}function Hm(e,t,r,i,f,g,S,E,Y){e.cancelPendingCommit=null;do Bi();while(An!==0);if((Zt&6)!==0)throw Error(a(327));if(t!==null){if(t===e.current)throw Error(a(177));if(g=t.lanes|t.childLanes,g|=jc,De(e,r,g,S,E,Y),e===fn&&(Ut=fn=null,qt=0),Ys=t,Hr=e,fr=r,Ad=g,Rd=f,Om=i,(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,j1(He,function(){return Wm(),null})):(e.callbackNode=null,e.callbackPriority=0),i=(t.flags&13878)!==0,(t.subtreeFlags&13878)!==0||i){i=_.T,_.T=null,f=q.p,q.p=2,S=Zt,Zt|=4;try{g1(e,t,r)}finally{Zt=S,q.p=f,_.T=i}}An=1,Vm(),$m(),Km()}}function Vm(){if(An===1){An=0;var e=Hr,t=Ys,r=(t.flags&13878)!==0;if((t.subtreeFlags&13878)!==0||r){r=_.T,_.T=null;var i=q.p;q.p=2;var f=Zt;Zt|=4;try{vm(t,e);var g=Qd,S=jh(e.containerInfo),E=g.focusedElem,Y=g.selectionRange;if(S!==E&&E&&E.ownerDocument&&kh(E.ownerDocument.documentElement,E)){if(Y!==null&&wc(E)){var we=Y.start,ze=Y.end;if(ze===void 0&&(ze=we),"selectionStart"in E)E.selectionStart=we,E.selectionEnd=Math.min(ze,E.value.length);else{var Ue=E.ownerDocument||document,Ce=Ue&&Ue.defaultView||window;if(Ce.getSelection){var Le=Ce.getSelection(),it=E.textContent.length,Tt=Math.min(Y.start,it),dn=Y.end===void 0?Tt:Math.min(Y.end,it);!Le.extend&&Tt>dn&&(S=dn,dn=Tt,Tt=S);var he=Ch(E,Tt),oe=Ch(E,dn);if(he&&oe&&(Le.rangeCount!==1||Le.anchorNode!==he.node||Le.anchorOffset!==he.offset||Le.focusNode!==oe.node||Le.focusOffset!==oe.offset)){var ve=Ue.createRange();ve.setStart(he.node,he.offset),Le.removeAllRanges(),Tt>dn?(Le.addRange(ve),Le.extend(oe.node,oe.offset)):(ve.setEnd(oe.node,oe.offset),Le.addRange(ve))}}}}for(Ue=[],Le=E;Le=Le.parentNode;)Le.nodeType===1&&Ue.push({element:Le,left:Le.scrollLeft,top:Le.scrollTop});for(typeof E.focus=="function"&&E.focus(),E=0;E<Ue.length;E++){var $e=Ue[E];$e.element.scrollLeft=$e.left,$e.element.scrollTop=$e.top}}Yi=!!Yd,Qd=Yd=null}finally{Zt=f,q.p=i,_.T=r}}e.current=t,An=2}}function $m(){if(An===2){An=0;var e=Hr,t=Ys,r=(t.flags&8772)!==0;if((t.subtreeFlags&8772)!==0||r){r=_.T,_.T=null;var i=q.p;q.p=2;var f=Zt;Zt|=4;try{gm(e,t.alternate,t)}finally{Zt=f,q.p=i,_.T=r}}An=3}}function Km(){if(An===4||An===3){An=0,pe();var e=Hr,t=Ys,r=fr,i=Om;(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?An=5:(An=0,Ys=Hr=null,Um(e,e.pendingLanes));var f=e.pendingLanes;if(f===0&&(zr=null),ct(r),t=t.stateNode,Ie&&typeof Ie.onCommitFiberRoot=="function")try{Ie.onCommitFiberRoot(Xe,t,void 0,(t.current.flags&128)===128)}catch{}if(i!==null){t=_.T,f=q.p,q.p=2,_.T=null;try{for(var g=e.onRecoverableError,S=0;S<i.length;S++){var E=i[S];g(E.value,{componentStack:E.stack})}}finally{_.T=t,q.p=f}}(fr&3)!==0&&Bi(),Uo(e),f=e.pendingLanes,(r&261930)!==0&&(f&42)!==0?e===Dd?Za++:(Za=0,Dd=e):Za=0,Ja(0)}}function Um(e,t){(e.pooledCacheLanes&=t)===0&&(t=e.pooledCache,t!=null&&(e.pooledCache=null,_a(t)))}function Bi(){return Vm(),$m(),Km(),Wm()}function Wm(){if(An!==5)return!1;var e=Hr,t=Ad;Ad=0;var r=ct(fr),i=_.T,f=q.p;try{q.p=32>r?32:r,_.T=null,r=Rd,Rd=null;var g=Hr,S=fr;if(An=0,Ys=Hr=null,fr=0,(Zt&6)!==0)throw Error(a(331));var E=Zt;if(Zt|=4,km(g.current),Sm(g,g.current,S,r),Zt=E,Ja(0,!1),Ie&&typeof Ie.onPostCommitFiberRoot=="function")try{Ie.onPostCommitFiberRoot(Xe,g)}catch{}return!0}finally{q.p=f,_.T=i,Um(e,t)}}function Fm(e,t,r){t=wo(r,t),t=hd(e.stateNode,t,2),e=Lr(e,t,2),e!==null&&(ye(e,2),Uo(e))}function an(e,t,r){if(e.tag===3)Fm(e,e,r);else for(;t!==null;){if(t.tag===3){Fm(t,e,r);break}else if(t.tag===1){var i=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(zr===null||!zr.has(i))){e=wo(r,e),r=qg(2),i=Lr(t,r,2),i!==null&&(Gg(r,i,t,e),ye(i,2),Uo(i));break}}t=t.return}}function Hd(e,t,r){var i=e.pingCache;if(i===null){i=e.pingCache=new b1;var f=new Set;i.set(t,f)}else f=i.get(t),f===void 0&&(f=new Set,i.set(t,f));f.has(r)||(Id=!0,f.add(r),e=N1.bind(null,e,t,r),t.then(e,e))}function N1(e,t,r){var i=e.pingCache;i!==null&&i.delete(t),e.pingedLanes|=e.suspendedLanes&r,e.warmLanes&=~r,fn===e&&(qt&r)===r&&(wn===4||wn===3&&(qt&62914560)===qt&&300>ae()-Ii?(Zt&2)===0&&Qs(e,0):Ld|=r,Ps===qt&&(Ps=0)),Uo(e)}function qm(e,t){t===0&&(t=Et()),e=ts(e,t),e!==null&&(ye(e,t),Uo(e))}function C1(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),qm(e,r)}function k1(e,t){var r=0;switch(e.tag){case 31:case 13:var i=e.stateNode,f=e.memoizedState;f!==null&&(r=f.retryLane);break;case 19:i=e.stateNode;break;case 22:i=e.stateNode._retryCache;break;default:throw Error(a(314))}i!==null&&i.delete(t),qm(e,r)}function j1(e,t){return z(e,t)}var zi=null,Zs=null,Vd=!1,Hi=!1,$d=!1,$r=0;function Uo(e){e!==Zs&&e.next===null&&(Zs===null?zi=Zs=e:Zs=Zs.next=e),Hi=!0,Vd||(Vd=!0,O1())}function Ja(e,t){if(!$d&&Hi){$d=!0;do for(var r=!1,i=zi;i!==null;){if(e!==0){var f=i.pendingLanes;if(f===0)var g=0;else{var S=i.suspendedLanes,E=i.pingedLanes;g=(1<<31-Ze(42|e)+1)-1,g&=f&~(S&~E),g=g&201326741?g&201326741|1:g?g|2:0}g!==0&&(r=!0,Qm(i,g))}else g=qt,g=Ke(i,i===fn?g:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),(g&3)===0||Je(i,g)||(r=!0,Qm(i,g));i=i.next}while(r);$d=!1}}function M1(){Gm()}function Gm(){Hi=Vd=!1;var e=0;$r!==0&&z1()&&(e=$r);for(var t=ae(),r=null,i=zi;i!==null;){var f=i.next,g=Pm(i,t);g===0?(i.next=null,r===null?zi=f:r.next=f,f===null&&(Zs=r)):(r=i,(e!==0||(g&3)!==0)&&(Hi=!0)),i=f}An!==0&&An!==5||Ja(e),$r!==0&&($r=0)}function Pm(e,t){for(var r=e.suspendedLanes,i=e.pingedLanes,f=e.expirationTimes,g=e.pendingLanes&-62914561;0<g;){var S=31-Ze(g),E=1<<S,Y=f[S];Y===-1?((E&r)===0||(E&i)!==0)&&(f[S]=mt(E,t)):Y<=t&&(e.expiredLanes|=E),g&=~E}if(t=fn,r=qt,r=Ke(e,e===t?r:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),i=e.callbackNode,r===0||e===t&&(sn===2||sn===9)||e.cancelPendingCommit!==null)return i!==null&&i!==null&&$(i),e.callbackNode=null,e.callbackPriority=0;if((r&3)===0||Je(e,r)){if(t=r&-r,t===e.callbackPriority)return t;switch(i!==null&&$(i),ct(r)){case 2:case 8:r=ce;break;case 32:r=He;break;case 268435456:r=qe;break;default:r=He}return i=Ym.bind(null,e),r=z(r,i),e.callbackPriority=t,e.callbackNode=r,t}return i!==null&&i!==null&&$(i),e.callbackPriority=2,e.callbackNode=null,2}function Ym(e,t){if(An!==0&&An!==5)return e.callbackNode=null,e.callbackPriority=0,null;var r=e.callbackNode;if(Bi()&&e.callbackNode!==r)return null;var i=qt;return i=Ke(e,e===fn?i:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),i===0?null:(Em(e,i,t),Pm(e,ae()),e.callbackNode!=null&&e.callbackNode===r?Ym.bind(null,e):null)}function Qm(e,t){if(Bi())return null;Em(e,t,!0)}function O1(){V1(function(){(Zt&6)!==0?z(U,M1):Gm()})}function Kd(){if($r===0){var e=Bs;e===0&&(e=_t,_t<<=1,(_t&261888)===0&&(_t=256)),$r=e}return $r}function Xm(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:Ft(""+e)}function Zm(e,t){var r=t.ownerDocument.createElement("input");return r.name=t.name,r.value=t.value,e.id&&r.setAttribute("form",e.id),t.parentNode.insertBefore(r,t),e=new FormData(e),r.parentNode.removeChild(r),e}function T1(e,t,r,i,f){if(t==="submit"&&r&&r.stateNode===f){var g=Xm((f[Ct]||null).action),S=i.submitter;S&&(t=(t=S[Ct]||null)?Xm(t.formAction):S.getAttribute("formAction"),t!==null&&(g=t,S=null));var E=new Xl("action","action",null,i,f);e.push({event:E,listeners:[{instance:null,listener:function(){if(i.defaultPrevented){if($r!==0){var Y=S?Zm(f,S):new FormData(f);id(r,{pending:!0,data:Y,method:f.method,action:g},null,Y)}}else typeof g=="function"&&(E.preventDefault(),Y=S?Zm(f,S):new FormData(f),id(r,{pending:!0,data:Y,method:f.method,action:g},g,Y))},currentTarget:f}]})}}for(var Ud=0;Ud<kc.length;Ud++){var Wd=kc[Ud],E1=Wd.toLowerCase(),I1=Wd[0].toUpperCase()+Wd.slice(1);Io(E1,"on"+I1)}Io(Th,"onAnimationEnd"),Io(Eh,"onAnimationIteration"),Io(Ih,"onAnimationStart"),Io("dblclick","onDoubleClick"),Io("focusin","onFocus"),Io("focusout","onBlur"),Io(Gv,"onTransitionRun"),Io(Pv,"onTransitionStart"),Io(Yv,"onTransitionCancel"),Io(Lh,"onTransitionEnd"),xt("onMouseEnter",["mouseout","mouseover"]),xt("onMouseLeave",["mouseout","mouseover"]),xt("onPointerEnter",["pointerout","pointerover"]),xt("onPointerLeave",["pointerout","pointerover"]),gt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),gt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),gt("onBeforeInput",["compositionend","keypress","textInput","paste"]),gt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),gt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),gt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var el="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),L1=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(el));function Jm(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var i=e[r],f=i.event;i=i.listeners;e:{var g=void 0;if(t)for(var S=i.length-1;0<=S;S--){var E=i[S],Y=E.instance,we=E.currentTarget;if(E=E.listener,Y!==g&&f.isPropagationStopped())break e;g=E,f.currentTarget=we;try{g(f)}catch(ze){ei(ze)}f.currentTarget=null,g=Y}else for(S=0;S<i.length;S++){if(E=i[S],Y=E.instance,we=E.currentTarget,E=E.listener,Y!==g&&f.isPropagationStopped())break e;g=E,f.currentTarget=we;try{g(f)}catch(ze){ei(ze)}f.currentTarget=null,g=Y}}}}function Wt(e,t){var r=t[ut];r===void 0&&(r=t[ut]=new Set);var i=e+"__bubble";r.has(i)||(e0(t,e,2,!1),r.add(i))}function Fd(e,t,r){var i=0;t&&(i|=4),e0(r,e,i,t)}var Vi="_reactListening"+Math.random().toString(36).slice(2);function qd(e){if(!e[Vi]){e[Vi]=!0,Qe.forEach(function(r){r!=="selectionchange"&&(L1.has(r)||Fd(r,!1,e),Fd(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Vi]||(t[Vi]=!0,Fd("selectionchange",!1,t))}}function e0(e,t,r,i){switch(T0(t)){case 2:var f=aw;break;case 8:f=lw;break;default:f=lf}r=f.bind(null,t,r,e),f=void 0,!fc||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(f=!0),i?f!==void 0?e.addEventListener(t,r,{capture:!0,passive:f}):e.addEventListener(t,r,!0):f!==void 0?e.addEventListener(t,r,{passive:f}):e.addEventListener(t,r,!1)}function Gd(e,t,r,i,f){var g=i;if((t&1)===0&&(t&2)===0&&i!==null)e:for(;;){if(i===null)return;var S=i.tag;if(S===3||S===4){var E=i.stateNode.containerInfo;if(E===f)break;if(S===4)for(S=i.return;S!==null;){var Y=S.tag;if((Y===3||Y===4)&&S.stateNode.containerInfo===f)return;S=S.return}for(;E!==null;){if(S=Ae(E),S===null)return;if(Y=S.tag,Y===5||Y===6||Y===26||Y===27){i=g=S;continue e}E=E.parentNode}}i=i.return}sh(function(){var we=g,ze=Xr(r),Ue=[];e:{var Ce=_h.get(e);if(Ce!==void 0){var Le=Xl,it=e;switch(e){case"keypress":if(Yl(r)===0)break e;case"keydown":case"keyup":Le=kv;break;case"focusin":it="focus",Le=mc;break;case"focusout":it="blur",Le=mc;break;case"beforeblur":case"afterblur":Le=mc;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Le=ih;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Le=pv;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Le=Ov;break;case Th:case Eh:case Ih:Le=mv;break;case Lh:Le=Ev;break;case"scroll":case"scrollend":Le=dv;break;case"wheel":Le=Lv;break;case"copy":case"cut":case"paste":Le=bv;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Le=ch;break;case"toggle":case"beforetoggle":Le=Av}var Tt=(t&4)!==0,dn=!Tt&&(e==="scroll"||e==="scrollend"),he=Tt?Ce!==null?Ce+"Capture":null:Ce;Tt=[];for(var oe=we,ve;oe!==null;){var $e=oe;if(ve=$e.stateNode,$e=$e.tag,$e!==5&&$e!==26&&$e!==27||ve===null||he===null||($e=Sa(oe,he),$e!=null&&Tt.push(tl(oe,$e,ve))),dn)break;oe=oe.return}0<Tt.length&&(Ce=new Le(Ce,it,null,r,ze),Ue.push({event:Ce,listeners:Tt}))}}if((t&7)===0){e:{if(Ce=e==="mouseover"||e==="pointerover",Le=e==="mouseout"||e==="pointerout",Ce&&r!==wa&&(it=r.relatedTarget||r.fromElement)&&(Ae(it)||it[Nt]))break e;if((Le||Ce)&&(Ce=ze.window===ze?ze:(Ce=ze.ownerDocument)?Ce.defaultView||Ce.parentWindow:window,Le?(it=r.relatedTarget||r.toElement,Le=we,it=it?Ae(it):null,it!==null&&(dn=c(it),Tt=it.tag,it!==dn||Tt!==5&&Tt!==27&&Tt!==6)&&(it=null)):(Le=null,it=we),Le!==it)){if(Tt=ih,$e="onMouseLeave",he="onMouseEnter",oe="mouse",(e==="pointerout"||e==="pointerover")&&(Tt=ch,$e="onPointerLeave",he="onPointerEnter",oe="pointer"),dn=Le==null?Ce:st(Le),ve=it==null?Ce:st(it),Ce=new Tt($e,oe+"leave",Le,r,ze),Ce.target=dn,Ce.relatedTarget=ve,$e=null,Ae(ze)===we&&(Tt=new Tt(he,oe+"enter",it,r,ze),Tt.target=ve,Tt.relatedTarget=dn,$e=Tt),dn=$e,Le&&it)t:{for(Tt=_1,he=Le,oe=it,ve=0,$e=he;$e;$e=Tt($e))ve++;$e=0;for(var kt=oe;kt;kt=Tt(kt))$e++;for(;0<ve-$e;)he=Tt(he),ve--;for(;0<$e-ve;)oe=Tt(oe),$e--;for(;ve--;){if(he===oe||oe!==null&&he===oe.alternate){Tt=he;break t}he=Tt(he),oe=Tt(oe)}Tt=null}else Tt=null;Le!==null&&t0(Ue,Ce,Le,Tt,!1),it!==null&&dn!==null&&t0(Ue,dn,it,Tt,!0)}}e:{if(Ce=we?st(we):window,Le=Ce.nodeName&&Ce.nodeName.toLowerCase(),Le==="select"||Le==="input"&&Ce.type==="file")var Yt=bh;else if(mh(Ce))if(xh)Yt=Wv;else{Yt=Kv;var ft=$v}else Le=Ce.nodeName,!Le||Le.toLowerCase()!=="input"||Ce.type!=="checkbox"&&Ce.type!=="radio"?we&&yt(we.elementType)&&(Yt=bh):Yt=Uv;if(Yt&&(Yt=Yt(e,we))){yh(Ue,Yt,r,ze);break e}ft&&ft(e,Ce,we),e==="focusout"&&we&&Ce.type==="number"&&we.memoizedProps.value!=null&&ks(Ce,"number",Ce.value)}switch(ft=we?st(we):window,e){case"focusin":(mh(ft)||ft.contentEditable==="true")&&(Ts=ft,Sc=we,Ea=null);break;case"focusout":Ea=Sc=Ts=null;break;case"mousedown":Nc=!0;break;case"contextmenu":case"mouseup":case"dragend":Nc=!1,Mh(Ue,r,ze);break;case"selectionchange":if(qv)break;case"keydown":case"keyup":Mh(Ue,r,ze)}var $t;if(bc)e:{switch(e){case"compositionstart":var Gt="onCompositionStart";break e;case"compositionend":Gt="onCompositionEnd";break e;case"compositionupdate":Gt="onCompositionUpdate";break e}Gt=void 0}else Os?hh(e,r)&&(Gt="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(Gt="onCompositionStart");Gt&&(dh&&r.locale!=="ko"&&(Os||Gt!=="onCompositionStart"?Gt==="onCompositionEnd"&&Os&&($t=ah()):(kr=ze,pc="value"in kr?kr.value:kr.textContent,Os=!0)),ft=$i(we,Gt),0<ft.length&&(Gt=new uh(Gt,e,null,r,ze),Ue.push({event:Gt,listeners:ft}),$t?Gt.data=$t:($t=gh(r),$t!==null&&(Gt.data=$t)))),($t=Dv?Bv(e,r):zv(e,r))&&(Gt=$i(we,"onBeforeInput"),0<Gt.length&&(ft=new uh("onBeforeInput","beforeinput",null,r,ze),Ue.push({event:ft,listeners:Gt}),ft.data=$t)),T1(Ue,e,we,r,ze)}Jm(Ue,t)})}function tl(e,t,r){return{instance:e,listener:t,currentTarget:r}}function $i(e,t){for(var r=t+"Capture",i=[];e!==null;){var f=e,g=f.stateNode;if(f=f.tag,f!==5&&f!==26&&f!==27||g===null||(f=Sa(e,r),f!=null&&i.unshift(tl(e,f,g)),f=Sa(e,t),f!=null&&i.push(tl(e,f,g))),e.tag===3)return i;e=e.return}return[]}function _1(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function t0(e,t,r,i,f){for(var g=t._reactName,S=[];r!==null&&r!==i;){var E=r,Y=E.alternate,we=E.stateNode;if(E=E.tag,Y!==null&&Y===i)break;E!==5&&E!==26&&E!==27||we===null||(Y=we,f?(we=Sa(r,g),we!=null&&S.unshift(tl(r,we,Y))):f||(we=Sa(r,g),we!=null&&S.push(tl(r,we,Y)))),r=r.return}S.length!==0&&e.push({event:t,listeners:S})}var A1=/\r\n?/g,R1=/\u0000|\uFFFD/g;function n0(e){return(typeof e=="string"?e:""+e).replace(A1,`
`).replace(R1,"")}function o0(e,t){return t=n0(t),n0(e)===t}function cn(e,t,r,i,f,g){switch(r){case"children":typeof i=="string"?t==="body"||t==="textarea"&&i===""||Cr(e,i):(typeof i=="number"||typeof i=="bigint")&&t!=="body"&&Cr(e,""+i);break;case"className":ln(e,"class",i);break;case"tabIndex":ln(e,"tabindex",i);break;case"dir":case"role":case"viewBox":case"width":case"height":ln(e,r,i);break;case"style":at(e,i,g);break;case"data":if(t!=="object"){ln(e,"data",i);break}case"src":case"href":if(i===""&&(t!=="a"||r!=="href")){e.removeAttribute(r);break}if(i==null||typeof i=="function"||typeof i=="symbol"||typeof i=="boolean"){e.removeAttribute(r);break}i=Ft(""+i),e.setAttribute(r,i);break;case"action":case"formAction":if(typeof i=="function"){e.setAttribute(r,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof g=="function"&&(r==="formAction"?(t!=="input"&&cn(e,t,"name",f.name,f,null),cn(e,t,"formEncType",f.formEncType,f,null),cn(e,t,"formMethod",f.formMethod,f,null),cn(e,t,"formTarget",f.formTarget,f,null)):(cn(e,t,"encType",f.encType,f,null),cn(e,t,"method",f.method,f,null),cn(e,t,"target",f.target,f,null)));if(i==null||typeof i=="symbol"||typeof i=="boolean"){e.removeAttribute(r);break}i=Ft(""+i),e.setAttribute(r,i);break;case"onClick":i!=null&&(e.onclick=xo);break;case"onScroll":i!=null&&Wt("scroll",e);break;case"onScrollEnd":i!=null&&Wt("scrollend",e);break;case"dangerouslySetInnerHTML":if(i!=null){if(typeof i!="object"||!("__html"in i))throw Error(a(61));if(r=i.__html,r!=null){if(f.children!=null)throw Error(a(60));e.innerHTML=r}}break;case"multiple":e.multiple=i&&typeof i!="function"&&typeof i!="symbol";break;case"muted":e.muted=i&&typeof i!="function"&&typeof i!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(i==null||typeof i=="function"||typeof i=="boolean"||typeof i=="symbol"){e.removeAttribute("xlink:href");break}r=Ft(""+i),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",r);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":i!=null&&typeof i!="function"&&typeof i!="symbol"?e.setAttribute(r,""+i):e.removeAttribute(r);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":i&&typeof i!="function"&&typeof i!="symbol"?e.setAttribute(r,""):e.removeAttribute(r);break;case"capture":case"download":i===!0?e.setAttribute(r,""):i!==!1&&i!=null&&typeof i!="function"&&typeof i!="symbol"?e.setAttribute(r,i):e.removeAttribute(r);break;case"cols":case"rows":case"size":case"span":i!=null&&typeof i!="function"&&typeof i!="symbol"&&!isNaN(i)&&1<=i?e.setAttribute(r,i):e.removeAttribute(r);break;case"rowSpan":case"start":i==null||typeof i=="function"||typeof i=="symbol"||isNaN(i)?e.removeAttribute(r):e.setAttribute(r,i);break;case"popover":Wt("beforetoggle",e),Wt("toggle",e),Bt(e,"popover",i);break;case"xlinkActuate":bn(e,"http://www.w3.org/1999/xlink","xlink:actuate",i);break;case"xlinkArcrole":bn(e,"http://www.w3.org/1999/xlink","xlink:arcrole",i);break;case"xlinkRole":bn(e,"http://www.w3.org/1999/xlink","xlink:role",i);break;case"xlinkShow":bn(e,"http://www.w3.org/1999/xlink","xlink:show",i);break;case"xlinkTitle":bn(e,"http://www.w3.org/1999/xlink","xlink:title",i);break;case"xlinkType":bn(e,"http://www.w3.org/1999/xlink","xlink:type",i);break;case"xmlBase":bn(e,"http://www.w3.org/XML/1998/namespace","xml:base",i);break;case"xmlLang":bn(e,"http://www.w3.org/XML/1998/namespace","xml:lang",i);break;case"xmlSpace":bn(e,"http://www.w3.org/XML/1998/namespace","xml:space",i);break;case"is":Bt(e,"is",i);break;case"innerText":case"textContent":break;default:(!(2<r.length)||r[0]!=="o"&&r[0]!=="O"||r[1]!=="n"&&r[1]!=="N")&&(r=gn.get(r)||r,Bt(e,r,i))}}function Pd(e,t,r,i,f,g){switch(r){case"style":at(e,i,g);break;case"dangerouslySetInnerHTML":if(i!=null){if(typeof i!="object"||!("__html"in i))throw Error(a(61));if(r=i.__html,r!=null){if(f.children!=null)throw Error(a(60));e.innerHTML=r}}break;case"children":typeof i=="string"?Cr(e,i):(typeof i=="number"||typeof i=="bigint")&&Cr(e,""+i);break;case"onScroll":i!=null&&Wt("scroll",e);break;case"onScrollEnd":i!=null&&Wt("scrollend",e);break;case"onClick":i!=null&&(e.onclick=xo);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Mt.hasOwnProperty(r))e:{if(r[0]==="o"&&r[1]==="n"&&(f=r.endsWith("Capture"),t=r.slice(2,f?r.length-7:void 0),g=e[Ct]||null,g=g!=null?g[r]:null,typeof g=="function"&&e.removeEventListener(t,g,f),typeof i=="function")){typeof g!="function"&&g!==null&&(r in e?e[r]=null:e.hasAttribute(r)&&e.removeAttribute(r)),e.addEventListener(t,i,f);break e}r in e?e[r]=i:i===!0?e.setAttribute(r,""):Bt(e,r,i)}}}function Hn(e,t,r){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Wt("error",e),Wt("load",e);var i=!1,f=!1,g;for(g in r)if(r.hasOwnProperty(g)){var S=r[g];if(S!=null)switch(g){case"src":i=!0;break;case"srcSet":f=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,t));default:cn(e,t,g,S,r,null)}}f&&cn(e,t,"srcSet",r.srcSet,r,null),i&&cn(e,t,"src",r.src,r,null);return;case"input":Wt("invalid",e);var E=g=S=f=null,Y=null,we=null;for(i in r)if(r.hasOwnProperty(i)){var ze=r[i];if(ze!=null)switch(i){case"name":f=ze;break;case"type":S=ze;break;case"checked":Y=ze;break;case"defaultChecked":we=ze;break;case"value":g=ze;break;case"defaultValue":E=ze;break;case"children":case"dangerouslySetInnerHTML":if(ze!=null)throw Error(a(137,t));break;default:cn(e,t,i,ze,r,null)}}Fl(e,g,E,Y,we,S,f,!1);return;case"select":Wt("invalid",e),i=S=g=null;for(f in r)if(r.hasOwnProperty(f)&&(E=r[f],E!=null))switch(f){case"value":g=E;break;case"defaultValue":S=E;break;case"multiple":i=E;default:cn(e,t,f,E,r,null)}t=g,r=S,e.multiple=!!i,t!=null?so(e,!!i,t,!1):r!=null&&so(e,!!i,r,!0);return;case"textarea":Wt("invalid",e),g=f=i=null;for(S in r)if(r.hasOwnProperty(S)&&(E=r[S],E!=null))switch(S){case"value":i=E;break;case"defaultValue":f=E;break;case"children":g=E;break;case"dangerouslySetInnerHTML":if(E!=null)throw Error(a(91));break;default:cn(e,t,S,E,r,null)}Gl(e,i,f,g);return;case"option":for(Y in r)r.hasOwnProperty(Y)&&(i=r[Y],i!=null)&&(Y==="selected"?e.selected=i&&typeof i!="function"&&typeof i!="symbol":cn(e,t,Y,i,r,null));return;case"dialog":Wt("beforetoggle",e),Wt("toggle",e),Wt("cancel",e),Wt("close",e);break;case"iframe":case"object":Wt("load",e);break;case"video":case"audio":for(i=0;i<el.length;i++)Wt(el[i],e);break;case"image":Wt("error",e),Wt("load",e);break;case"details":Wt("toggle",e);break;case"embed":case"source":case"link":Wt("error",e),Wt("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(we in r)if(r.hasOwnProperty(we)&&(i=r[we],i!=null))switch(we){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,t));default:cn(e,t,we,i,r,null)}return;default:if(yt(t)){for(ze in r)r.hasOwnProperty(ze)&&(i=r[ze],i!==void 0&&Pd(e,t,ze,i,r,void 0));return}}for(E in r)r.hasOwnProperty(E)&&(i=r[E],i!=null&&cn(e,t,E,i,r,null))}function D1(e,t,r,i){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var f=null,g=null,S=null,E=null,Y=null,we=null,ze=null;for(Le in r){var Ue=r[Le];if(r.hasOwnProperty(Le)&&Ue!=null)switch(Le){case"checked":break;case"value":break;case"defaultValue":Y=Ue;default:i.hasOwnProperty(Le)||cn(e,t,Le,null,i,Ue)}}for(var Ce in i){var Le=i[Ce];if(Ue=r[Ce],i.hasOwnProperty(Ce)&&(Le!=null||Ue!=null))switch(Ce){case"type":g=Le;break;case"name":f=Le;break;case"checked":we=Le;break;case"defaultChecked":ze=Le;break;case"value":S=Le;break;case"defaultValue":E=Le;break;case"children":case"dangerouslySetInnerHTML":if(Le!=null)throw Error(a(137,t));break;default:Le!==Ue&&cn(e,t,Ce,Le,i,Ue)}}va(e,S,E,Y,we,ze,g,f);return;case"select":Le=S=E=Ce=null;for(g in r)if(Y=r[g],r.hasOwnProperty(g)&&Y!=null)switch(g){case"value":break;case"multiple":Le=Y;default:i.hasOwnProperty(g)||cn(e,t,g,null,i,Y)}for(f in i)if(g=i[f],Y=r[f],i.hasOwnProperty(f)&&(g!=null||Y!=null))switch(f){case"value":Ce=g;break;case"defaultValue":E=g;break;case"multiple":S=g;default:g!==Y&&cn(e,t,f,g,i,Y)}t=E,r=S,i=Le,Ce!=null?so(e,!!r,Ce,!1):!!i!=!!r&&(t!=null?so(e,!!r,t,!0):so(e,!!r,r?[]:"",!1));return;case"textarea":Le=Ce=null;for(E in r)if(f=r[E],r.hasOwnProperty(E)&&f!=null&&!i.hasOwnProperty(E))switch(E){case"value":break;case"children":break;default:cn(e,t,E,null,i,f)}for(S in i)if(f=i[S],g=r[S],i.hasOwnProperty(S)&&(f!=null||g!=null))switch(S){case"value":Ce=f;break;case"defaultValue":Le=f;break;case"children":break;case"dangerouslySetInnerHTML":if(f!=null)throw Error(a(91));break;default:f!==g&&cn(e,t,S,f,i,g)}ql(e,Ce,Le);return;case"option":for(var it in r)Ce=r[it],r.hasOwnProperty(it)&&Ce!=null&&!i.hasOwnProperty(it)&&(it==="selected"?e.selected=!1:cn(e,t,it,null,i,Ce));for(Y in i)Ce=i[Y],Le=r[Y],i.hasOwnProperty(Y)&&Ce!==Le&&(Ce!=null||Le!=null)&&(Y==="selected"?e.selected=Ce&&typeof Ce!="function"&&typeof Ce!="symbol":cn(e,t,Y,Ce,i,Le));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Tt in r)Ce=r[Tt],r.hasOwnProperty(Tt)&&Ce!=null&&!i.hasOwnProperty(Tt)&&cn(e,t,Tt,null,i,Ce);for(we in i)if(Ce=i[we],Le=r[we],i.hasOwnProperty(we)&&Ce!==Le&&(Ce!=null||Le!=null))switch(we){case"children":case"dangerouslySetInnerHTML":if(Ce!=null)throw Error(a(137,t));break;default:cn(e,t,we,Ce,i,Le)}return;default:if(yt(t)){for(var dn in r)Ce=r[dn],r.hasOwnProperty(dn)&&Ce!==void 0&&!i.hasOwnProperty(dn)&&Pd(e,t,dn,void 0,i,Ce);for(ze in i)Ce=i[ze],Le=r[ze],!i.hasOwnProperty(ze)||Ce===Le||Ce===void 0&&Le===void 0||Pd(e,t,ze,Ce,i,Le);return}}for(var he in r)Ce=r[he],r.hasOwnProperty(he)&&Ce!=null&&!i.hasOwnProperty(he)&&cn(e,t,he,null,i,Ce);for(Ue in i)Ce=i[Ue],Le=r[Ue],!i.hasOwnProperty(Ue)||Ce===Le||Ce==null&&Le==null||cn(e,t,Ue,Ce,i,Le)}function r0(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function B1(){if(typeof performance.getEntriesByType=="function"){for(var e=0,t=0,r=performance.getEntriesByType("resource"),i=0;i<r.length;i++){var f=r[i],g=f.transferSize,S=f.initiatorType,E=f.duration;if(g&&E&&r0(S)){for(S=0,E=f.responseEnd,i+=1;i<r.length;i++){var Y=r[i],we=Y.startTime;if(we>E)break;var ze=Y.transferSize,Ue=Y.initiatorType;ze&&r0(Ue)&&(Y=Y.responseEnd,S+=ze*(Y<E?1:(E-we)/(Y-we)))}if(--i,t+=8*(g+S)/(f.duration/1e3),e++,10<e)break}}if(0<e)return t/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var Yd=null,Qd=null;function Ki(e){return e.nodeType===9?e:e.ownerDocument}function s0(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function a0(e,t){if(e===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&t==="foreignObject"?0:e}function Xd(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Zd=null;function z1(){var e=window.event;return e&&e.type==="popstate"?e===Zd?!1:(Zd=e,!0):(Zd=null,!1)}var l0=typeof setTimeout=="function"?setTimeout:void 0,H1=typeof clearTimeout=="function"?clearTimeout:void 0,i0=typeof Promise=="function"?Promise:void 0,V1=typeof queueMicrotask=="function"?queueMicrotask:typeof i0<"u"?function(e){return i0.resolve(null).then(e).catch($1)}:l0;function $1(e){setTimeout(function(){throw e})}function Kr(e){return e==="head"}function u0(e,t){var r=t,i=0;do{var f=r.nextSibling;if(e.removeChild(r),f&&f.nodeType===8)if(r=f.data,r==="/$"||r==="/&"){if(i===0){e.removeChild(f),na(t);return}i--}else if(r==="$"||r==="$?"||r==="$~"||r==="$!"||r==="&")i++;else if(r==="html")nl(e.ownerDocument.documentElement);else if(r==="head"){r=e.ownerDocument.head,nl(r);for(var g=r.firstChild;g;){var S=g.nextSibling,E=g.nodeName;g[nn]||E==="SCRIPT"||E==="STYLE"||E==="LINK"&&g.rel.toLowerCase()==="stylesheet"||r.removeChild(g),g=S}}else r==="body"&&nl(e.ownerDocument.body);r=f}while(r);na(t)}function c0(e,t){var r=e;e=0;do{var i=r.nextSibling;if(r.nodeType===1?t?(r._stashedDisplay=r.style.display,r.style.display="none"):(r.style.display=r._stashedDisplay||"",r.getAttribute("style")===""&&r.removeAttribute("style")):r.nodeType===3&&(t?(r._stashedText=r.nodeValue,r.nodeValue=""):r.nodeValue=r._stashedText||""),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(e===0)break;e--}else r!=="$"&&r!=="$?"&&r!=="$~"&&r!=="$!"||e++;r=i}while(r)}function Jd(e){var t=e.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var r=t;switch(t=t.nextSibling,r.nodeName){case"HTML":case"HEAD":case"BODY":Jd(r),Q(r);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(r.rel.toLowerCase()==="stylesheet")continue}e.removeChild(r)}}function K1(e,t,r,i){for(;e.nodeType===1;){var f=r;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!i&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(i){if(!e[nn])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(g=e.getAttribute("rel"),g==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(g!==f.rel||e.getAttribute("href")!==(f.href==null||f.href===""?null:f.href)||e.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin)||e.getAttribute("title")!==(f.title==null?null:f.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(g=e.getAttribute("src"),(g!==(f.src==null?null:f.src)||e.getAttribute("type")!==(f.type==null?null:f.type)||e.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin))&&g&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(t==="input"&&e.type==="hidden"){var g=f.name==null?null:""+f.name;if(f.type==="hidden"&&e.getAttribute("name")===g)return e}else return e;if(e=jo(e.nextSibling),e===null)break}return null}function U1(e,t,r){if(t==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!r||(e=jo(e.nextSibling),e===null))return null;return e}function d0(e,t){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!t||(e=jo(e.nextSibling),e===null))return null;return e}function ef(e){return e.data==="$?"||e.data==="$~"}function tf(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function W1(e,t){var r=e.ownerDocument;if(e.data==="$~")e._reactRetry=t;else if(e.data!=="$?"||r.readyState!=="loading")t();else{var i=function(){t(),r.removeEventListener("DOMContentLoaded",i)};r.addEventListener("DOMContentLoaded",i),e._reactRetry=i}}function jo(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?"||t==="$~"||t==="&"||t==="F!"||t==="F")break;if(t==="/$"||t==="/&")return null}}return e}var nf=null;function f0(e){e=e.nextSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"||r==="/&"){if(t===0)return jo(e.nextSibling);t--}else r!=="$"&&r!=="$!"&&r!=="$?"&&r!=="$~"&&r!=="&"||t++}e=e.nextSibling}return null}function p0(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"){if(t===0)return e;t--}else r!=="/$"&&r!=="/&"||t++}e=e.previousSibling}return null}function h0(e,t,r){switch(t=Ki(r),e){case"html":if(e=t.documentElement,!e)throw Error(a(452));return e;case"head":if(e=t.head,!e)throw Error(a(453));return e;case"body":if(e=t.body,!e)throw Error(a(454));return e;default:throw Error(a(451))}}function nl(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Q(e)}var Mo=new Map,g0=new Set;function Ui(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var pr=q.d;q.d={f:F1,r:q1,D:G1,C:P1,L:Y1,m:Q1,X:Z1,S:X1,M:J1};function F1(){var e=pr.f(),t=Ai();return e||t}function q1(e){var t=le(e);t!==null&&t.tag===5&&t.type==="form"?Lg(t):pr.r(e)}var Js=typeof document>"u"?null:document;function m0(e,t,r){var i=Js;if(i&&typeof t=="string"&&t){var f=Un(t);f='link[rel="'+e+'"][href="'+f+'"]',typeof r=="string"&&(f+='[crossorigin="'+r+'"]'),g0.has(f)||(g0.add(f),e={rel:e,crossOrigin:r,href:t},i.querySelector(f)===null&&(t=i.createElement("link"),Hn(t,"link",e),tt(t),i.head.appendChild(t)))}}function G1(e){pr.D(e),m0("dns-prefetch",e,null)}function P1(e,t){pr.C(e,t),m0("preconnect",e,t)}function Y1(e,t,r){pr.L(e,t,r);var i=Js;if(i&&e&&t){var f='link[rel="preload"][as="'+Un(t)+'"]';t==="image"&&r&&r.imageSrcSet?(f+='[imagesrcset="'+Un(r.imageSrcSet)+'"]',typeof r.imageSizes=="string"&&(f+='[imagesizes="'+Un(r.imageSizes)+'"]')):f+='[href="'+Un(e)+'"]';var g=f;switch(t){case"style":g=ea(e);break;case"script":g=ta(e)}Mo.has(g)||(e=x({rel:"preload",href:t==="image"&&r&&r.imageSrcSet?void 0:e,as:t},r),Mo.set(g,e),i.querySelector(f)!==null||t==="style"&&i.querySelector(ol(g))||t==="script"&&i.querySelector(rl(g))||(t=i.createElement("link"),Hn(t,"link",e),tt(t),i.head.appendChild(t)))}}function Q1(e,t){pr.m(e,t);var r=Js;if(r&&e){var i=t&&typeof t.as=="string"?t.as:"script",f='link[rel="modulepreload"][as="'+Un(i)+'"][href="'+Un(e)+'"]',g=f;switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":g=ta(e)}if(!Mo.has(g)&&(e=x({rel:"modulepreload",href:e},t),Mo.set(g,e),r.querySelector(f)===null)){switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(r.querySelector(rl(g)))return}i=r.createElement("link"),Hn(i,"link",e),tt(i),r.head.appendChild(i)}}}function X1(e,t,r){pr.S(e,t,r);var i=Js;if(i&&e){var f=nt(i).hoistableStyles,g=ea(e);t=t||"default";var S=f.get(g);if(!S){var E={loading:0,preload:null};if(S=i.querySelector(ol(g)))E.loading=5;else{e=x({rel:"stylesheet",href:e,"data-precedence":t},r),(r=Mo.get(g))&&of(e,r);var Y=S=i.createElement("link");tt(Y),Hn(Y,"link",e),Y._p=new Promise(function(we,ze){Y.onload=we,Y.onerror=ze}),Y.addEventListener("load",function(){E.loading|=1}),Y.addEventListener("error",function(){E.loading|=2}),E.loading|=4,Wi(S,t,i)}S={type:"stylesheet",instance:S,count:1,state:E},f.set(g,S)}}}function Z1(e,t){pr.X(e,t);var r=Js;if(r&&e){var i=nt(r).hoistableScripts,f=ta(e),g=i.get(f);g||(g=r.querySelector(rl(f)),g||(e=x({src:e,async:!0},t),(t=Mo.get(f))&&rf(e,t),g=r.createElement("script"),tt(g),Hn(g,"link",e),r.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},i.set(f,g))}}function J1(e,t){pr.M(e,t);var r=Js;if(r&&e){var i=nt(r).hoistableScripts,f=ta(e),g=i.get(f);g||(g=r.querySelector(rl(f)),g||(e=x({src:e,async:!0,type:"module"},t),(t=Mo.get(f))&&rf(e,t),g=r.createElement("script"),tt(g),Hn(g,"link",e),r.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},i.set(f,g))}}function y0(e,t,r,i){var f=(f=Re.current)?Ui(f):null;if(!f)throw Error(a(446));switch(e){case"meta":case"title":return null;case"style":return typeof r.precedence=="string"&&typeof r.href=="string"?(t=ea(r.href),r=nt(f).hoistableStyles,i=r.get(t),i||(i={type:"style",instance:null,count:0,state:null},r.set(t,i)),i):{type:"void",instance:null,count:0,state:null};case"link":if(r.rel==="stylesheet"&&typeof r.href=="string"&&typeof r.precedence=="string"){e=ea(r.href);var g=nt(f).hoistableStyles,S=g.get(e);if(S||(f=f.ownerDocument||f,S={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},g.set(e,S),(g=f.querySelector(ol(e)))&&!g._p&&(S.instance=g,S.state.loading=5),Mo.has(e)||(r={rel:"preload",as:"style",href:r.href,crossOrigin:r.crossOrigin,integrity:r.integrity,media:r.media,hrefLang:r.hrefLang,referrerPolicy:r.referrerPolicy},Mo.set(e,r),g||ew(f,e,r,S.state))),t&&i===null)throw Error(a(528,""));return S}if(t&&i!==null)throw Error(a(529,""));return null;case"script":return t=r.async,r=r.src,typeof r=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=ta(r),r=nt(f).hoistableScripts,i=r.get(t),i||(i={type:"script",instance:null,count:0,state:null},r.set(t,i)),i):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,e))}}function ea(e){return'href="'+Un(e)+'"'}function ol(e){return'link[rel="stylesheet"]['+e+"]"}function b0(e){return x({},e,{"data-precedence":e.precedence,precedence:null})}function ew(e,t,r,i){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?i.loading=1:(t=e.createElement("link"),i.preload=t,t.addEventListener("load",function(){return i.loading|=1}),t.addEventListener("error",function(){return i.loading|=2}),Hn(t,"link",r),tt(t),e.head.appendChild(t))}function ta(e){return'[src="'+Un(e)+'"]'}function rl(e){return"script[async]"+e}function x0(e,t,r){if(t.count++,t.instance===null)switch(t.type){case"style":var i=e.querySelector('style[data-href~="'+Un(r.href)+'"]');if(i)return t.instance=i,tt(i),i;var f=x({},r,{"data-href":r.href,"data-precedence":r.precedence,href:null,precedence:null});return i=(e.ownerDocument||e).createElement("style"),tt(i),Hn(i,"style",f),Wi(i,r.precedence,e),t.instance=i;case"stylesheet":f=ea(r.href);var g=e.querySelector(ol(f));if(g)return t.state.loading|=4,t.instance=g,tt(g),g;i=b0(r),(f=Mo.get(f))&&of(i,f),g=(e.ownerDocument||e).createElement("link"),tt(g);var S=g;return S._p=new Promise(function(E,Y){S.onload=E,S.onerror=Y}),Hn(g,"link",i),t.state.loading|=4,Wi(g,r.precedence,e),t.instance=g;case"script":return g=ta(r.src),(f=e.querySelector(rl(g)))?(t.instance=f,tt(f),f):(i=r,(f=Mo.get(g))&&(i=x({},r),rf(i,f)),e=e.ownerDocument||e,f=e.createElement("script"),tt(f),Hn(f,"link",i),e.head.appendChild(f),t.instance=f);case"void":return null;default:throw Error(a(443,t.type))}else t.type==="stylesheet"&&(t.state.loading&4)===0&&(i=t.instance,t.state.loading|=4,Wi(i,r.precedence,e));return t.instance}function Wi(e,t,r){for(var i=r.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),f=i.length?i[i.length-1]:null,g=f,S=0;S<i.length;S++){var E=i[S];if(E.dataset.precedence===t)g=E;else if(g!==f)break}g?g.parentNode.insertBefore(e,g.nextSibling):(t=r.nodeType===9?r.head:r,t.insertBefore(e,t.firstChild))}function of(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.title==null&&(e.title=t.title)}function rf(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.integrity==null&&(e.integrity=t.integrity)}var Fi=null;function v0(e,t,r){if(Fi===null){var i=new Map,f=Fi=new Map;f.set(r,i)}else f=Fi,i=f.get(r),i||(i=new Map,f.set(r,i));if(i.has(e))return i;for(i.set(e,null),r=r.getElementsByTagName(e),f=0;f<r.length;f++){var g=r[f];if(!(g[nn]||g[ht]||e==="link"&&g.getAttribute("rel")==="stylesheet")&&g.namespaceURI!=="http://www.w3.org/2000/svg"){var S=g.getAttribute(t)||"";S=e+S;var E=i.get(S);E?E.push(g):i.set(S,[g])}}return i}function w0(e,t,r){e=e.ownerDocument||e,e.head.insertBefore(r,t==="title"?e.querySelector("head > title"):null)}function tw(e,t,r){if(r===1||t.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;return t.rel==="stylesheet"?(e=t.disabled,typeof t.precedence=="string"&&e==null):!0;case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function S0(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function nw(e,t,r,i){if(r.type==="stylesheet"&&(typeof i.media!="string"||matchMedia(i.media).matches!==!1)&&(r.state.loading&4)===0){if(r.instance===null){var f=ea(i.href),g=t.querySelector(ol(f));if(g){t=g._p,t!==null&&typeof t=="object"&&typeof t.then=="function"&&(e.count++,e=qi.bind(e),t.then(e,e)),r.state.loading|=4,r.instance=g,tt(g);return}g=t.ownerDocument||t,i=b0(i),(f=Mo.get(f))&&of(i,f),g=g.createElement("link"),tt(g);var S=g;S._p=new Promise(function(E,Y){S.onload=E,S.onerror=Y}),Hn(g,"link",i),r.instance=g}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(r,t),(t=r.state.preload)&&(r.state.loading&3)===0&&(e.count++,r=qi.bind(e),t.addEventListener("load",r),t.addEventListener("error",r))}}var sf=0;function ow(e,t){return e.stylesheets&&e.count===0&&Pi(e,e.stylesheets),0<e.count||0<e.imgCount?function(r){var i=setTimeout(function(){if(e.stylesheets&&Pi(e,e.stylesheets),e.unsuspend){var g=e.unsuspend;e.unsuspend=null,g()}},6e4+t);0<e.imgBytes&&sf===0&&(sf=62500*B1());var f=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&Pi(e,e.stylesheets),e.unsuspend)){var g=e.unsuspend;e.unsuspend=null,g()}},(e.imgBytes>sf?50:800)+t);return e.unsuspend=r,function(){e.unsuspend=null,clearTimeout(i),clearTimeout(f)}}:null}function qi(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Pi(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var Gi=null;function Pi(e,t){e.stylesheets=null,e.unsuspend!==null&&(e.count++,Gi=new Map,t.forEach(rw,e),Gi=null,qi.call(e))}function rw(e,t){if(!(t.state.loading&4)){var r=Gi.get(e);if(r)var i=r.get(null);else{r=new Map,Gi.set(e,r);for(var f=e.querySelectorAll("link[data-precedence],style[data-precedence]"),g=0;g<f.length;g++){var S=f[g];(S.nodeName==="LINK"||S.getAttribute("media")!=="not all")&&(r.set(S.dataset.precedence,S),i=S)}i&&r.set(null,i)}f=t.instance,S=f.getAttribute("data-precedence"),g=r.get(S)||i,g===i&&r.set(null,f),r.set(S,f),this.count++,i=qi.bind(this),f.addEventListener("load",i),f.addEventListener("error",i),g?g.parentNode.insertBefore(f,g.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(f,e.firstChild)),t.state.loading|=4}}var sl={$$typeof:R,Provider:null,Consumer:null,_currentValue:de,_currentValue2:de,_threadCount:0};function sw(e,t,r,i,f,g,S,E,Y){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=be(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=be(0),this.hiddenUpdates=be(null),this.identifierPrefix=i,this.onUncaughtError=f,this.onCaughtError=g,this.onRecoverableError=S,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Y,this.incompleteTransitions=new Map}function N0(e,t,r,i,f,g,S,E,Y,we,ze,Ue){return e=new sw(e,t,r,S,Y,we,ze,Ue,E),t=1,g===!0&&(t|=24),g=lo(3,null,null,t),e.current=g,g.stateNode=e,t=zc(),t.refCount++,e.pooledCache=t,t.refCount++,g.memoizedState={element:i,isDehydrated:r,cache:t},Kc(g),e}function C0(e){return e?(e=Ls,e):Ls}function k0(e,t,r,i,f,g){f=C0(f),i.context===null?i.context=f:i.pendingContext=f,i=Ir(t),i.payload={element:r},g=g===void 0?null:g,g!==null&&(i.callback=g),r=Lr(e,i,t),r!==null&&(to(r,e,t),Ba(r,e,t))}function j0(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function af(e,t){j0(e,t),(e=e.alternate)&&j0(e,t)}function M0(e){if(e.tag===13||e.tag===31){var t=ts(e,67108864);t!==null&&to(t,e,67108864),af(e,67108864)}}function O0(e){if(e.tag===13||e.tag===31){var t=po();t=Be(t);var r=ts(e,t);r!==null&&to(r,e,t),af(e,t)}}var Yi=!0;function aw(e,t,r,i){var f=_.T;_.T=null;var g=q.p;try{q.p=2,lf(e,t,r,i)}finally{q.p=g,_.T=f}}function lw(e,t,r,i){var f=_.T;_.T=null;var g=q.p;try{q.p=8,lf(e,t,r,i)}finally{q.p=g,_.T=f}}function lf(e,t,r,i){if(Yi){var f=uf(i);if(f===null)Gd(e,t,i,Qi,r),E0(e,i);else if(uw(f,e,t,r,i))i.stopPropagation();else if(E0(e,i),t&4&&-1<iw.indexOf(e)){for(;f!==null;){var g=le(f);if(g!==null)switch(g.tag){case 3:if(g=g.stateNode,g.current.memoizedState.isDehydrated){var S=Fe(g.pendingLanes);if(S!==0){var E=g;for(E.pendingLanes|=2,E.entangledLanes|=2;S;){var Y=1<<31-Ze(S);E.entanglements[1]|=Y,S&=~Y}Uo(g),(Zt&6)===0&&(Li=ae()+500,Ja(0))}}break;case 31:case 13:E=ts(g,2),E!==null&&to(E,g,2),Ai(),af(g,2)}if(g=uf(i),g===null&&Gd(e,t,i,Qi,r),g===f)break;f=g}f!==null&&i.stopPropagation()}else Gd(e,t,i,null,r)}}function uf(e){return e=Xr(e),cf(e)}var Qi=null;function cf(e){if(Qi=null,e=Ae(e),e!==null){var t=c(e);if(t===null)e=null;else{var r=t.tag;if(r===13){if(e=d(t),e!==null)return e;e=null}else if(r===31){if(e=h(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return Qi=e,null}function T0(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ke()){case U:return 2;case ce:return 8;case He:case Ve:return 32;case qe:return 268435456;default:return 32}default:return 32}}var df=!1,Ur=null,Wr=null,Fr=null,al=new Map,ll=new Map,qr=[],iw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function E0(e,t){switch(e){case"focusin":case"focusout":Ur=null;break;case"dragenter":case"dragleave":Wr=null;break;case"mouseover":case"mouseout":Fr=null;break;case"pointerover":case"pointerout":al.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":ll.delete(t.pointerId)}}function il(e,t,r,i,f,g){return e===null||e.nativeEvent!==g?(e={blockedOn:t,domEventName:r,eventSystemFlags:i,nativeEvent:g,targetContainers:[f]},t!==null&&(t=le(t),t!==null&&M0(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,f!==null&&t.indexOf(f)===-1&&t.push(f),e)}function uw(e,t,r,i,f){switch(t){case"focusin":return Ur=il(Ur,e,t,r,i,f),!0;case"dragenter":return Wr=il(Wr,e,t,r,i,f),!0;case"mouseover":return Fr=il(Fr,e,t,r,i,f),!0;case"pointerover":var g=f.pointerId;return al.set(g,il(al.get(g)||null,e,t,r,i,f)),!0;case"gotpointercapture":return g=f.pointerId,ll.set(g,il(ll.get(g)||null,e,t,r,i,f)),!0}return!1}function I0(e){var t=Ae(e.target);if(t!==null){var r=c(t);if(r!==null){if(t=r.tag,t===13){if(t=d(r),t!==null){e.blockedOn=t,bt(e.priority,function(){O0(r)});return}}else if(t===31){if(t=h(r),t!==null){e.blockedOn=t,bt(e.priority,function(){O0(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Xi(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=uf(e.nativeEvent);if(r===null){r=e.nativeEvent;var i=new r.constructor(r.type,r);wa=i,r.target.dispatchEvent(i),wa=null}else return t=le(r),t!==null&&M0(t),e.blockedOn=r,!1;t.shift()}return!0}function L0(e,t,r){Xi(e)&&r.delete(t)}function cw(){df=!1,Ur!==null&&Xi(Ur)&&(Ur=null),Wr!==null&&Xi(Wr)&&(Wr=null),Fr!==null&&Xi(Fr)&&(Fr=null),al.forEach(L0),ll.forEach(L0)}function Zi(e,t){e.blockedOn===t&&(e.blockedOn=null,df||(df=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,cw)))}var Ji=null;function _0(e){Ji!==e&&(Ji=e,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Ji===e&&(Ji=null);for(var t=0;t<e.length;t+=3){var r=e[t],i=e[t+1],f=e[t+2];if(typeof i!="function"){if(cf(i||r)===null)continue;break}var g=le(r);g!==null&&(e.splice(t,3),t-=3,id(g,{pending:!0,data:f,method:r.method,action:i},i,f))}}))}function na(e){function t(Y){return Zi(Y,e)}Ur!==null&&Zi(Ur,e),Wr!==null&&Zi(Wr,e),Fr!==null&&Zi(Fr,e),al.forEach(t),ll.forEach(t);for(var r=0;r<qr.length;r++){var i=qr[r];i.blockedOn===e&&(i.blockedOn=null)}for(;0<qr.length&&(r=qr[0],r.blockedOn===null);)I0(r),r.blockedOn===null&&qr.shift();if(r=(e.ownerDocument||e).$$reactFormReplay,r!=null)for(i=0;i<r.length;i+=3){var f=r[i],g=r[i+1],S=f[Ct]||null;if(typeof g=="function")S||_0(r);else if(S){var E=null;if(g&&g.hasAttribute("formAction")){if(f=g,S=g[Ct]||null)E=S.formAction;else if(cf(f)!==null)continue}else E=S.action;typeof E=="function"?r[i+1]=E:(r.splice(i,3),i-=3),_0(r)}}}function A0(){function e(g){g.canIntercept&&g.info==="react-transition"&&g.intercept({handler:function(){return new Promise(function(S){return f=S})},focusReset:"manual",scroll:"manual"})}function t(){f!==null&&(f(),f=null),i||setTimeout(r,20)}function r(){if(!i&&!navigation.transition){var g=navigation.currentEntry;g&&g.url!=null&&navigation.navigate(g.url,{state:g.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var i=!1,f=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(r,100),function(){i=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),f!==null&&(f(),f=null)}}}function ff(e){this._internalRoot=e}eu.prototype.render=ff.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(a(409));var r=t.current,i=po();k0(r,i,e,t,null,null)},eu.prototype.unmount=ff.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;k0(e.current,2,null,e,null,null),Ai(),t[Nt]=null}};function eu(e){this._internalRoot=e}eu.prototype.unstable_scheduleHydration=function(e){if(e){var t=St();e={blockedOn:null,target:e,priority:t};for(var r=0;r<qr.length&&t!==0&&t<qr[r].priority;r++);qr.splice(r,0,e),r===0&&I0(e)}};var R0=o.version;if(R0!=="19.2.3")throw Error(a(527,R0,"19.2.3"));q.findDOMNode=function(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(a(188)):(e=Object.keys(e).join(","),Error(a(268,e)));return e=m(t),e=e!==null?y(e):null,e=e===null?null:e.stateNode,e};var dw={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:_,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var tu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!tu.isDisabled&&tu.supportsFiber)try{Xe=tu.inject(dw),Ie=tu}catch{}}return cl.createRoot=function(e,t){if(!l(e))throw Error(a(299));var r=!1,i="",f=Kg,g=Ug,S=Wg;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onUncaughtError!==void 0&&(f=t.onUncaughtError),t.onCaughtError!==void 0&&(g=t.onCaughtError),t.onRecoverableError!==void 0&&(S=t.onRecoverableError)),t=N0(e,1,!1,null,null,r,i,null,f,g,S,A0),e[Nt]=t.current,qd(e),new ff(t)},cl.hydrateRoot=function(e,t,r){if(!l(e))throw Error(a(299));var i=!1,f="",g=Kg,S=Ug,E=Wg,Y=null;return r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(f=r.identifierPrefix),r.onUncaughtError!==void 0&&(g=r.onUncaughtError),r.onCaughtError!==void 0&&(S=r.onCaughtError),r.onRecoverableError!==void 0&&(E=r.onRecoverableError),r.formState!==void 0&&(Y=r.formState)),t=N0(e,1,!0,t,r??null,i,f,Y,g,S,E,A0),t.context=C0(null),r=t.current,i=po(),i=Be(i),f=Ir(i),f.callback=null,Lr(r,f,i),r=i,t.current.lanes=r,ye(t,r),Uo(t),e[Nt]=t.current,qd(e),new eu(t)},cl.version="19.2.3",cl}var q0;function Sw(){if(q0)return gf.exports;q0=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(o){console.error(o)}}return n(),gf.exports=ww(),gf.exports}var Nw=Sw();const G0=n=>{let o;const s=new Set,a=(m,y)=>{const x=typeof m=="function"?m(o):m;if(!Object.is(x,o)){const v=o;o=y??(typeof x!="object"||x===null)?x:Object.assign({},o,x),s.forEach(C=>C(o,v))}},l=()=>o,h={setState:a,getState:l,getInitialState:()=>p,subscribe:m=>(s.add(m),()=>s.delete(m))},p=o=n(a,l,h);return h},Cw=(n=>n?G0(n):G0),kw=n=>n;function jw(n,o=kw){const s=ia.useSyncExternalStore(n.subscribe,ia.useCallback(()=>o(n.getState()),[n,o]),ia.useCallback(()=>o(n.getInitialState()),[n,o]));return ia.useDebugValue(s),s}const P0=n=>{const o=Cw(n),s=a=>jw(o,a);return Object.assign(s,o),s},bo=(n=>n?P0(n):P0);function wr(n,o){let s;try{s=n()}catch{return}return{getItem:l=>{var c;const d=p=>p===null?null:JSON.parse(p,void 0),h=(c=s.getItem(l))!=null?c:null;return h instanceof Promise?h.then(d):d(h)},setItem:(l,c)=>s.setItem(l,JSON.stringify(c,void 0)),removeItem:l=>s.removeItem(l)}}const qf=n=>o=>{try{const s=n(o);return s instanceof Promise?s:{then(a){return qf(a)(s)},catch(a){return this}}}catch(s){return{then(a){return this},catch(a){return qf(a)(s)}}}},Mw=(n,o)=>(s,a,l)=>{let c={storage:wr(()=>localStorage),partialize:w=>w,version:0,merge:(w,j)=>({...j,...w}),...o},d=!1;const h=new Set,p=new Set;let m=c.storage;if(!m)return n((...w)=>{console.warn(`[zustand persist middleware] Unable to update item '${c.name}', the given storage is currently unavailable.`),s(...w)},a,l);const y=()=>{const w=c.partialize({...a()});return m.setItem(c.name,{state:w,version:c.version})},x=l.setState;l.setState=(w,j)=>(x(w,j),y());const v=n((...w)=>(s(...w),y()),a,l);l.getInitialState=()=>v;let C;const N=()=>{var w,j;if(!m)return;d=!1,h.forEach(O=>{var R;return O((R=a())!=null?R:v)});const k=((j=c.onRehydrateStorage)==null?void 0:j.call(c,(w=a())!=null?w:v))||void 0;return qf(m.getItem.bind(m))(c.name).then(O=>{if(O)if(typeof O.version=="number"&&O.version!==c.version){if(c.migrate){const R=c.migrate(O.state,O.version);return R instanceof Promise?R.then(D=>[!0,D]):[!0,R]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,O.state];return[!1,void 0]}).then(O=>{var R;const[D,I]=O;if(C=c.merge(I,(R=a())!=null?R:v),s(C,!0),D)return y()}).then(()=>{k?.(C,void 0),C=a(),d=!0,p.forEach(O=>O(C))}).catch(O=>{k?.(void 0,O)})};return l.persist={setOptions:w=>{c={...c,...w},w.storage&&(m=w.storage)},clearStorage:()=>{m?.removeItem(c.name)},getOptions:()=>c,rehydrate:()=>N(),hasHydrated:()=>d,onHydrate:w=>(h.add(w),()=>{h.delete(w)}),onFinishHydration:w=>(p.add(w),()=>{p.delete(w)})},c.skipHydration||N(),C||v},Sr=Mw,To=bo()(n=>({viewerOpen:!1,viewerImages:[],viewerIndex:0,viewerScale:1,viewerTranslate:{x:0,y:0},setViewerState:o=>{n(s=>{const a={viewerOpen:o.viewerOpen??s.viewerOpen,viewerImages:o.viewerImages??s.viewerImages,viewerIndex:o.viewerIndex??s.viewerIndex,viewerScale:o.viewerScale??s.viewerScale,viewerTranslate:o.viewerTranslate??s.viewerTranslate};return a.viewerOpen===s.viewerOpen&&a.viewerIndex===s.viewerIndex&&a.viewerScale===s.viewerScale&&a.viewerTranslate.x===s.viewerTranslate.x&&a.viewerTranslate.y===s.viewerTranslate.y&&a.viewerImages===s.viewerImages?s:{...s,...a}})}})),pn=bo()(Sr(n=>({error:null,nodeErrors:{},errorCycleIndex:0,errorsDismissed:!1,setError:o=>{n({error:o,errorsDismissed:!1})},setNodeErrors:o=>{n({nodeErrors:o,errorCycleIndex:0,errorsDismissed:!1})},clearNodeErrors:()=>{n({error:null,nodeErrors:{},errorCycleIndex:0,errorsDismissed:!1})},clearNodeError:o=>{n(s=>{const a={...s.nodeErrors};return delete a[String(o)],{nodeErrors:a}})},setErrorCycleIndex:o=>{n({errorCycleIndex:o})},setErrorsDismissed:o=>{n({errorsDismissed:o})}}),{name:"workflow-errors-storage",storage:wr(()=>localStorage),partialize:n=>({error:n.error,nodeErrors:n.nodeErrors,errorCycleIndex:n.errorCycleIndex,errorsDismissed:n.errorsDismissed}),onRehydrateStorage:()=>n=>{if(!n)return;const o=Object.values(n.nodeErrors||{}).reduce((s,a)=>s+a.length,0);o>0&&!n.error&&n.setError(`Workflow load error: ${o} input${o===1?"":"s"} reference missing options.`),o>0&&n.setErrorCycleIndex(0)}})),Ow=new Set(["Lora Loader (LoraManager)"]),Tw=new Set(["Lora Stacker (LoraManager)","Lora Randomizer (LoraManager)","Lora Cycler (LoraManager)"]),Ew=new Set(["Lora Stacker (LoraManager)","Lora Randomizer (LoraManager)","Lora Cycler (LoraManager)","WanVideo Lora Select (LoraManager)"]),Iw=new Set(["Lora Cycler (LoraManager)"]),Ib=Number.EPSILON,Lb=n=>!!n&&typeof n=="object"&&!Array.isArray(n),Eu=/<lora:([^:>]+):([-\d.]+)(?::([-\d.]+))?>/g;function yr(n){return Iu(n)||Sp(n)}function Iu(n){if(Ow.has(n))return!0;const o=n.toLowerCase();return o.includes("(loramanager)")&&o.includes("lora loader")}function wu(n){if(Tw.has(n))return!0;const o=n.toLowerCase();return o.includes("(loramanager)")&&(o.includes("lora stacker")||o.includes("lora randomizer")||o.includes("lora cycler"))}function Sp(n){if(Ew.has(n))return!0;const o=n.toLowerCase();return o.includes("(loramanager)")&&(o.includes("lora stacker")||o.includes("lora randomizer")||o.includes("lora cycler")||o.includes("wanvideo lora select"))}function Lw(n){if(Iw.has(n))return!0;const o=n.toLowerCase();return o.includes("(loramanager)")&&o.includes("lora cycler")}function Lu(n){return Array.isArray(n)?n.length===0?!0:n.every(o=>Lb(o)&&typeof o.name=="string"&&"strength"in o):!1}function _u(n){return Lu(n)?n:Lb(n)&&Lu(n.__value__)?n.__value__:null}function bs(n,o){if(!Array.isArray(n.widgets_values))return null;const s=n.widgets_values;for(let l=0;l<s.length;l+=1){const c=s[l];if(Lu(c)&&c.length>0)return l}if(o!=null){const l=o+1;if(l>=0&&l<s.length){const c=s[l];if(Array.isArray(c))return l}else if(l===s.length)return l}const a=s.findIndex(l=>Array.isArray(l)&&l.length===0);return a>=0?a:null}function Y0(n,o){return typeof n=="number"&&Number.isFinite(n)?n:typeof n=="string"&&n.trim()!==""&&!Number.isNaN(Number(n))?Number(n):o}function Au(n){const o=Y0(n.strength,1),s=Y0(n.clipStrength??o,o),a=n.active!==void 0?!!n.active:!0,l=n.expanded!==void 0?!!n.expanded:Math.abs(s-o)>Ib;return{...n,strength:o,clipStrength:s,active:a,expanded:l}}function _b(n){const o=Array.isArray(n)&&n.length>0?String(n[0]):"";return Au({name:o,strength:1,clipStrength:1,active:!!o,expanded:!1})}function Gf(n,o){const s={};let a;for(Eu.lastIndex=0;(a=Eu.exec(n))!==null;){const d=a[1],h=Number(a[2]),p=a[3]?Number(a[3]):h;s[d]={strength:h,clipStrength:p}}const l=[],c=new Set;for(const d of o){if(!d||!s[d.name])continue;const h=s[d.name];l.push({...d,strength:d.strength!==void 0?d.strength:h.strength,clipStrength:d.clipStrength!==void 0?d.clipStrength:h.clipStrength,active:d.active!==void 0?d.active:!0,expanded:d.expanded!==void 0?d.expanded:!1}),c.add(d.name)}for(const d of Object.keys(s)){if(c.has(d))continue;const h=s[d];l.push({name:d,strength:h.strength,clipStrength:h.clipStrength,active:!0})}return l}function nu(n){const o=Number(n);return Number.isFinite(o)?o.toFixed(2):1 .toFixed(2)}function Q0(n,o){const s=n?.clipStrength,a=n?.strength;if(s==null)return!!o;const l=Number(s),c=Number(a);return!Number.isFinite(l)||!Number.isFinite(c)?!!o:Math.abs(l-c)>Ib?!0:!!(n?.expanded||o)}function _w(n){if(!n)return"";let o=n.replace(/\s+/g," ").replace(/,\s*,+/g,",").replace(/\s*,\s*/g,",").trim();return o===","?"":(o=o.replace(/(^,)|(,$)/g,""),o=o.replace(/,\s*/g,", "),o.trim())}function Ab(n,o){const s=typeof n=="string"?n:"",a=Array.isArray(o)?o:[],l=new Map;a.forEach(y=>{!y||!y.name||l.set(y.name,y)}),Eu.lastIndex=0;const c=new Set,d=s.replace(Eu,(y,x,v,C)=>{const N=l.get(x);if(!N)return"";c.add(x);const w=nu(N.strength??v),j=nu(N.clipStrength??N.strength??C);return Q0(N,C)?`<lora:${x}:${w}:${j}>`:`<lora:${x}:${w}>`}),h=_w(d);if(l.size===c.size)return h;const p=[];return l.forEach((y,x)=>{if(c.has(x))return;const v=nu(y.strength),C=nu(y.clipStrength??y.strength),w=Q0(y,null)?`<lora:${x}:${v}:${C}>`:`<lora:${x}:${v}>`;p.push(w)}),p.length===0?h:`${h}${h?" ":""}${p.join(" ")}`.trim()}const Aw=new Set(["TriggerWord Toggle (LoraManager)"]),xs=n=>!!n&&typeof n=="object"&&!Array.isArray(n);function vs(n){if(Aw.has(n))return!0;const o=n.toLowerCase();return o.includes("triggerword")&&o.includes("(loramanager)")}function Rw(n){return!(!xs(n)||typeof n.text!="string"||"active"in n&&typeof n.active!="boolean")}function Dw(n){return xs(n)&&typeof n.text=="string"}function Ru(n,o=!0){return Array.isArray(n)?n.length===0?!0:n.every(s=>o?Rw(s):Dw(s)):!1}function Ll(n){return Ru(n,!0)?n:xs(n)&&Ru(n.__value__,!0)?n.__value__:null}function _l(n){return Ru(n,!1)?n:xs(n)&&Ru(n.__value__,!1)?n.__value__:null}function Xu(n){if(!Array.isArray(n.widgets_values))return null;const o=n.widgets_values;let s=null;const a=[];for(let d=0;d<o.length;d+=1){const h=o[d],p=Ll(h);if(p&&p.length>0)return d;const m=_l(h);if(m&&m.length>0){const x=m.length;(!s||x>s.score)&&(s={index:d,score:x})}const y=Array.isArray(h)?h:xs(h)&&Array.isArray(h.__value__)?h.__value__:null;y&&y.length===0&&a.push(d)}if(s)return s.index;if(a.length===0)return null;const l=d=>typeof d=="string"?d:xs(d)&&typeof d.__value__=="string"?d.__value__:null,c=a.find(d=>{const h=o[d-1],p=o[d+1];return l(h)!==null||l(p)!==null});return c!==void 0?c:a[0]}function Np(n,o){if(!Array.isArray(n.widgets_values))return null;const s=n.widgets_values,a=o!=null?Math.min(o+1,s.length):0;for(let l=a;l<s.length;l+=1)if(typeof s[l]=="string")return l;for(let l=0;l<a;l+=1)if(typeof s[l]=="string")return l;return null}function Cp(n){return typeof n=="string"?n:xs(n)&&typeof n.__value__=="string"?n.__value__:null}function Rb(n){if(n==null)return null;const o=Number(n);return Number.isFinite(o)?o:null}function Su(n,o){const s=typeof n.text=="string"?n.text:"",a=typeof n.active=="boolean"?n.active:o?.defaultActive??!0,c=!!o?.allowStrengthAdjustment?Rb(n.strength):null,d=typeof n.highlighted=="boolean"?n.highlighted:void 0;return{...n,text:s,active:a,strength:c,highlighted:d}}function Pf(n,o){const s=Array.isArray(o.existingList)?o.existingList:[],a={};s.forEach(h=>{!h||typeof h.text!="string"||!h.text||(a[h.text]||(a[h.text]=[]),a[h.text].push({active:typeof h.active=="boolean"?h.active:o.defaultActive,strength:o.allowStrengthAdjustment?Rb(h.strength):null}))});const l=h=>{const p=a[h];return p&&p.length>0?p.shift()??null:null},c=typeof n=="string"?n.trim():"";if(!c)return[];let d=[];return o.groupMode?/,{2,}/.test(c)?d=c.split(/,{2,}/):d=[c]:d=c.split(","),d.map(h=>h.trim()).filter(h=>h.length>0).map(h=>{const p=l(h);return{text:h,active:p?p.active:o.defaultActive,strength:o.allowStrengthAdjustment?p?.strength??null:null}})}function Db(n){return!!n&&typeof n=="object"&&!Array.isArray(n)}function Bw(n){if(!(!String(n.type||"").startsWith("Primitive")&&n.type!=="PrimitiveNode")){if(Array.isArray(n.widgets_values))return n.widgets_values[0];if(Db(n.widgets_values)){const s=n.widgets_values.value;return s!==void 0?s:n.widgets_values[0]}}}function pa(n,o,s){const a=n.widgets_values;if(Array.isArray(a))return s===void 0||s<0||s>=a.length?void 0:a[s];if(Db(a)){if(a[o]!==void 0)return a[o];if(n.type==="VHS_VideoCombine"&&o==="save_image"&&a.save_output!==void 0)return a.save_output}}function kp(n,o){const s=n.widget_idx_map?.[String(o)];return s||(n.extra?.widget_idx_map?.[String(o)]??null)}function Zu(n){if(Array.isArray(n)){const s=n.map(a=>String(a)).join(",").toUpperCase();return s.includes("AUTOCOMPLETE_TEXT_PROMPT")||s.includes("AUTOCOMPLETE_TEXT_LORAS"),!0}const o=String(n).toUpperCase();return o==="INT"||o==="FLOAT"||o==="BOOLEAN"||o==="STRING"||o.includes("AUTOCOMPLETE_TEXT_LORAS")||o.includes("AUTOCOMPLETE_TEXT_PROMPT")}function jp(n,o,s){if(Array.isArray(o)){if(s?.comboIndexToValue&&typeof n=="number"&&Number.isFinite(n)){const a=Math.trunc(n);return o[a]??n}return n}if(o==="INT"&&typeof n=="string"&&n.trim()!==""&&!Number.isNaN(Number(n)))return Math.trunc(Number(n));if(o==="FLOAT"&&typeof n=="string"&&n.trim()!==""&&!Number.isNaN(Number(n)))return Number(n);if(o==="BOOLEAN"&&typeof n=="string"){if(n.toLowerCase()==="true")return!0;if(n.toLowerCase()==="false")return!1}return n}function zw(n,o,s){if(o.length===0)return n;const a=Al(n,o);return a!==void 0?a:s!==void 0&&o.some(l=>String(l)===String(s))?s:o[0]}const X0=".safetensors";function Z0(n){return n.toLowerCase().endsWith(X0)?n.slice(0,n.length-X0.length):n}function J0(n){return n.split(/[\\/]/).pop()??n}function Al(n,o){if(!Array.isArray(o)||o.length===0)return;const s=jp(n,o,{comboIndexToValue:!0}),a=String(s),l=J0(a),c=o.find(y=>String(y)===a);if(c!==void 0)return c;const d=o.find(y=>String(y)===l);if(d!==void 0)return d;const p=Z0(l).toLowerCase();return o.find(y=>{const x=String(y),v=J0(x);return Z0(v).toLowerCase()===p})}function Mp(n,o){const s=n.links.find(d=>d[0]===o);if(!s)return null;const a=s[1],l=s[2],c=n.nodes.find(d=>d.id===a);if(!c)return null;if(c.mode===4||c.type==="Reroute"){const d=c.outputs[l];if(!d)return null;const h=c.inputs.find(p=>{if(p.link===null)return!1;const m=String(p.type).toUpperCase(),y=String(d.type).toUpperCase();return m===y||m==="*"||y==="*"});return h?.link!=null?Mp(n,h.link):null}return{nodeId:a,slotIndex:l}}function Hw(n,o,s,a,l,c,d){const h={};for(const N of s.inputs)if(N.link!=null){const w=Mp(n,N.link);if(w)if(l.has(w.nodeId))h[N.name]=[String(w.nodeId),w.slotIndex];else{const j=n.nodes.find(k=>k.id===w.nodeId);if(j){const k=Bw(j);k!==void 0?h[N.name]=k:console.warn(`[workflowInputs] Missing source node for input '${N.name}' on node ${s.id} (${s.type}).`,{sourceNodeId:w.nodeId,sourceNodeType:j.type,sourceAllowed:!1})}}}const p=o[a];if(!p?.input)return h;const m=p.input_order?.required||Object.keys(p.input.required||{}),y=p.input_order?.optional||Object.keys(p.input.optional||{}),x=[...m,...y];let v=0;const C=Array.isArray(s.widgets_values)?s.widgets_values:null;for(const N of x)try{const w=p.input.required?.[N]||p.input.optional?.[N];if(!w)continue;const[j]=w,k=s.inputs.find(J=>J.name===N),O=k?.link!=null,R=!!k?.widget&&!O,D=!!k,I=w[1]?.default,H=Object.prototype.hasOwnProperty.call(w[1]??{},"default");if(Zu(j)||R||!D){let J=c?.[N];if(J===void 0&&(J=v),N==="seed"&&d?.[s.id]!==void 0&&!(N in h))h[N]=d[s.id];else if(J!==void 0&&!O&&!(N in h)){const X=pa(s,N,J);X!==void 0&&(Array.isArray(j)?h[N]=zw(X,j,I):h[N]=jp(X,j))}else!O&&H&&!(N in h)&&(h[N]=I);J!==void 0&&(v=Math.max(v,J+1)),String(j)==="INT"&&(N==="seed"||N==="noise_seed")&&(J!==void 0?v=Math.max(v,J+2):v=Math.max(v,v+1))}}catch(w){console.error(`Error processing input '${N}' for node ${s.id} (${s.type}):`,w)}if(c)for(const[N,w]of Object.entries(c)){if(!(N in h)&&C&&w<C.length){const j=C[w];j!=null&&(h[N]=j)}if(!(N in h)&&!C){const j=pa(s,N,w);j!=null&&(h[N]=j)}}return(a==="Power Lora Loader (rgthree)"||s.type==="Power Lora Loader (rgthree)")&&C&&C.forEach((N,w)=>{if(typeof N=="object"&&N!==null&&"lora"in N&&!(Object.values(c||{}).some(k=>k===w)||c===null&&w<v)){const k=`lora_${w}`;k in h||(h[k]=N)}}),d?.[s.id]!==void 0&&!("seed"in h)&&!("noise_seed"in h)&&(h.seed=d[s.id]),Vw(s,h,C,c),$w(s,h,C,c),h}function Vw(n,o,s,a){if("loras"in o)return;const l=a?.loras,c=l!==void 0?l:bs(n);if(c===null)return;const d=s?.[c],h=_u(d);h&&(o.loras=h)}function $w(n,o,s,a){if(!vs(n.type))return;const l=a?.toggle_trigger_words,c=l!==void 0?l:Xu(n);if(c===null)return;if(!("toggle_trigger_words"in o)){const x=s?.[c],v=Ll(x)??_l(x);v&&(o.toggle_trigger_words=v)}const d=a?.originalMessage??a?.orinalMessage,h=d!==void 0?d:Np(n,c);if(h===null)return;const p=s?.[h],m=Cp(p);if(m===null)return;const y=a&&"originalMessage"in a?"originalMessage":(a&&"orinalMessage"in a,"orinalMessage");y in o||(o[y]=m)}const rn="";function Kw(){const n="comfyui-mobile-client-id";let o=localStorage.getItem(n);return o||(o="mobile-"+Math.random().toString(36).substring(2,15),localStorage.setItem(n,o)),o}const Bb=Kw();async function Op(){const n=await fetch(`${rn}/api/object_info`);if(!n.ok)throw new Error("Failed to fetch node types");return n.json()}async function Uw(){const n=await fetch(`${rn}/api/queue`);if(!n.ok)throw new Error("Failed to fetch queue");return n.json()}async function Ww(n){const o=`${rn}/api/history?max_items=${n}`,s=await fetch(o);if(!s.ok)throw new Error("Failed to fetch history");return s.json()}async function Fw(n){if(n.length===0)return;if(!(await fetch(`${rn}/api/lm/register-nodes`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({nodes:n})})).ok)throw new Error("Failed to register Lora Manager nodes")}async function qw(n,o){if(!o||o.length===0)return;if(!(await fetch(`${rn}/api/lm/loras/get_trigger_words`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({lora_names:n??[],node_ids:o})})).ok)throw new Error("Failed to fetch trigger words")}async function Gw(){const n=await fetch(`${rn}/api/v2/userdata?path=workflows`);if(!n.ok){if(n.status===404)return[];throw new Error("Failed to list user workflows")}return(await n.json()).filter(s=>s.type==="file"&&s.name.endsWith(".json"))}function zb(n){return encodeURIComponent(n)}async function Tp(n){const o=await fetch(`${rn}/api/userdata/${zb("workflows/"+n)}`);if(!o.ok)throw new Error("Failed to load workflow");return o.json()}async function Hb(n,o){if(!(await fetch(`${rn}/api/userdata/${zb("workflows/"+n)}?overwrite=true`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)})).ok)throw new Error("Failed to save workflow")}async function Pw(){const n=await fetch(`${rn}/api/workflow_templates`);if(!n.ok)throw new Error("Failed to fetch templates");return n.json()}async function Ep(n,o){const s=await fetch(`${rn}/api/workflow_templates/${encodeURIComponent(n)}/${encodeURIComponent(o)}`);if(!s.ok)throw new Error("Failed to load template");return s.json()}async function Yw(){await fetch(`${rn}/api/interrupt`,{method:"POST"})}async function Qw(){await fetch(`${rn}/api/queue`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({clear:!0})})}async function Xw(n){await fetch(`${rn}/api/queue`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({delete:[n]})})}async function Vb(n,o){const s=new FormData;s.append("image",n),o?.type&&s.append("type",o.type),o?.subfolder&&s.append("subfolder",o.subfolder),o?.overwrite!==void 0&&s.append("overwrite",o.overwrite?"true":"false");const a=await fetch(`${rn}/upload/image`,{method:"POST",body:s});if(!a.ok)throw new Error("Failed to upload image");return a.json()}async function Zw(n){await fetch(`${rn}/api/history`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({delete:[n]})})}async function ey(n){n.length!==0&&await fetch(`${rn}/api/history`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({delete:n})})}async function Jw(){await fetch(`${rn}/api/history`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({clear:!0})})}function mo(n,o,s){return`${rn}/view?filename=${encodeURIComponent(n)}&subfolder=${encodeURIComponent(o)}&type=${encodeURIComponent(s)}`}function e2(n,o,s,a,l){const d=`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}/ws?clientId=${n}`,h=new WebSocket(d);return h.onopen=()=>{s?.()},h.onmessage=p=>{try{const m=JSON.parse(p.data);o(m)}catch(m){console.error("[WS] Failed to parse message:",m)}},h.onclose=()=>{a?.()},h.onerror=p=>{console.error("[WS] Error:",p),l?.(p)},h}async function Yf(n="",o=!1,s="output",a){const l=new URLSearchParams;n&&l.set("path",n),o&&l.set("recursive","true"),s&&l.set("source",s),a&&l.set("showHidden","true");const c=await fetch(`${rn}/mobile/api/files?${l}`);if(!c.ok)throw new Error("Failed to fetch files");return c.json()}async function t2(n){const o=await Yf("",!1,"output",n),s=await Yf("",!1,"input",n),a=o.files.filter(c=>c.type==="dir").map(c=>c.name);return{input:s.files.filter(c=>c.type==="dir").map(c=>c.name),output:a}}async function Qf(n,o=1e3,s=0,a="modified",l=!1,c=null,d){return(await Yf(c||"",l,n,d)).files.map(p=>{if(p.type==="dir")return{id:`${n}/${p.path}`,name:p.name,type:"folder",date:p.date,size:p.size};const m=p.folder||(p.path.includes("/")?p.path.substring(0,p.path.lastIndexOf("/")):"");return{id:`${n}/${p.path}`,name:p.name,type:p.type,previewUrl:`${rn}/mobile/api/thumbnail?filename=${encodeURIComponent(p.name)}&subfolder=${encodeURIComponent(m)}&source=${n}`,fullUrl:`${rn}/view?filename=${encodeURIComponent(p.name)}&type=${n}&subfolder=${encodeURIComponent(m)}`,date:p.date,size:p.size}})}async function Xf(n,o="output"){const s=await fetch(`${rn}/mobile/api/files`,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:n,source:o})});if(!s.ok){const a=await s.json();throw new Error(a.error||"Failed to delete file")}}async function n2(n,o="output"){const s=new URLSearchParams({path:n,source:o}),a=await fetch(`${rn}/mobile/api/file-metadata?${s.toString()}`);if(!a.ok){const c=await a.json().catch(()=>({}));throw new Error(c.error||"Failed to load file metadata")}const l=await a.json();if(!l.workflow)throw new Error("No workflow metadata found");return l.workflow}async function o2(n,o="output"){const s=new URLSearchParams({path:n,source:o}),a=await fetch(`${rn}/mobile/api/image-metadata?${s.toString()}`);if(!a.ok){const l=await a.json().catch(()=>({}));throw new Error(l.error||"Failed to load image metadata")}return a.json()}async function r2(n,o,s="output"){const a=await fetch(`${rn}/mobile/api/files/move`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sources:n,destination:o??"",source:s})});if(!a.ok){const l=await a.json().catch(()=>({}));throw new Error(l.error||"Failed to move files")}}async function ty(n,o="output"){const s=await fetch(`${rn}/mobile/api/files/mkdir`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:n,source:o})});if(!s.ok){const a=await s.json().catch(()=>({}));throw new Error(a.error||"Failed to create folder")}}async function s2(n,o,s="output"){const a=await fetch(`${rn}/mobile/api/files/rename`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:n,newName:o,source:s})});if(!a.ok){const l=await a.json().catch(()=>({}));throw new Error(l.error||"Failed to rename file")}}const Ht=bo()(Sr((n,o)=>({running:[],pending:[],isLoading:!1,lastExecutedId:null,queueItemExpanded:{},queueItemUserToggled:{},queueItemHideImages:{},showQueueMetadata:!1,previewVisibility:{},previewVisibilityDefault:!1,fetchQueue:async()=>{const{running:s}=o();n({isLoading:!0});try{const a=await Uw(),l=a.queue_running.map(d=>({number:d[0],prompt_id:d[1],prompt:d[2],extra:d[3],outputs_to_execute:d[4]})),c=a.queue_pending.map(d=>({number:d[0],prompt_id:d[1],prompt:d[2],extra:d[3],outputs_to_execute:d[4]}));s.length>0&&l.length===0&&(n({lastExecutedId:s[0].prompt_id}),setTimeout(()=>n({lastExecutedId:null}),100)),n({running:l,pending:c})}catch(a){console.error("Failed to fetch queue:",a)}finally{n({isLoading:!1})}},clearQueue:async()=>{try{await Qw(),n({pending:[]})}catch(s){console.error("Failed to clear queue:",s)}},deleteItem:async s=>{try{await Xw(s),n(a=>({pending:a.pending.filter(l=>l.prompt_id!==s)}))}catch(a){console.error("Failed to delete queue item:",a)}},interrupt:async()=>{try{await Yw()}catch(s){console.error("Failed to interrupt execution:",s)}},updateFromStatus:s=>{const{pending:a}=o();s!==a.length&&o().fetchQueue()},setQueueItemExpanded:(s,a)=>{n(l=>({queueItemExpanded:{...l.queueItemExpanded,[s]:a}}))},setQueueItemUserToggled:(s,a)=>{n(l=>({queueItemUserToggled:{...l.queueItemUserToggled,[s]:a}}))},setQueueItemHideImages:(s,a)=>{n(l=>({queueItemHideImages:{...l.queueItemHideImages,[s]:a}}))},toggleQueueItemHideImages:s=>{n(a=>({queueItemHideImages:{...a.queueItemHideImages,[s]:!a.queueItemHideImages[s]}}))},setShowQueueMetadata:s=>{n({showQueueMetadata:s})},toggleShowQueueMetadata:()=>{n(s=>({showQueueMetadata:!s.showQueueMetadata}))},setPreviewVisibility:(s,a)=>{n(l=>({previewVisibility:{...l.previewVisibility,[s]:a}}))},togglePreviewVisibility:s=>{n(a=>({previewVisibility:{...a.previewVisibility,[s]:!a.previewVisibility[s]}}))},setPreviewVisibilityDefault:s=>{n({previewVisibilityDefault:s})}}),{name:"queue-storage",storage:wr(()=>localStorage),partialize:n=>({queueItemExpanded:n.queueItemExpanded,queueItemUserToggled:n.queueItemUserToggled,queueItemHideImages:n.queueItemHideImages,showQueueMetadata:n.showQueueMetadata,previewVisibility:n.previewVisibility,previewVisibilityDefault:n.previewVisibilityDefault})})),oo=bo()(Sr(n=>({currentPanel:"workflow",setCurrentPanel:o=>{n({currentPanel:o})}}),{name:"navigation-storage",storage:wr(()=>localStorage),partialize:n=>({currentPanel:n.currentPanel})})),go=bo()(Sr((n,o)=>({pinnedWidgets:{},pinnedWidget:null,pinOverlayOpen:!1,setPinnedWidget:(s,a)=>{const{pinnedWidgets:l}=o();if(a&&s)n({pinnedWidget:s,pinnedWidgets:{...l,[a]:s}});else if(a&&!s){const c={...l};delete c[a],n({pinnedWidget:null,pinnedWidgets:c})}else n({pinnedWidget:s})},setPinOverlayOpen:s=>{n({pinOverlayOpen:s})},togglePinOverlay:()=>{n(s=>({pinOverlayOpen:!s.pinOverlayOpen}))},clearPinnedWidgetForKey:s=>{if(!s){n({pinnedWidget:null,pinOverlayOpen:!1});return}n(a=>{const l={...a.pinnedWidgets};return delete l[s],{pinnedWidgets:l,pinnedWidget:null,pinOverlayOpen:!1}})},restorePinnedWidgetForWorkflow:(s,a)=>{if(!s){n({pinnedWidget:null,pinOverlayOpen:!1});return}const l=o().pinnedWidgets[s];if(!l){n({pinnedWidget:null,pinOverlayOpen:!1});return}const c=a.nodes.some(d=>d.id===l.nodeId);n({pinnedWidget:c?l:null,pinOverlayOpen:!1})},clearCurrentPin:()=>{n({pinnedWidget:null,pinOverlayOpen:!1})}}),{name:"pinned-widget-storage",storage:wr(()=>localStorage),partialize:n=>({pinnedWidgets:n.pinnedWidgets,pinnedWidget:n.pinnedWidget,pinOverlayOpen:n.pinOverlayOpen})})),Ip=-1,Ju=-2,ec=-3,ou=0x4000000000000,Du=new Set([Ip,Ju,ec]);function Lp(n){return Du.has(n)}function $b(n){return n===Ip?"randomize":n===Ju?"increment":n===ec?"decrement":null}function a2(n){return n==="randomize"?Ip:n==="increment"?Ju:n==="decrement"?ec:null}function $n(n,o,s,a){if(!o)return null;const c=kp(n,s.id)?.[a];if(c!==void 0)return c;const d=o[s.type];if(!d?.input)return null;const h=d.input_order?.required||Object.keys(d.input.required||{}),p=d.input_order?.optional||Object.keys(d.input.optional||{}),m=[...h,...p];let y=0;for(const x of m){const v=d.input.required?.[x]||d.input.optional?.[x];if(!v)continue;const[C]=v,N=s.inputs.find(D=>D.name===x),w=N?.link!=null,j=!!N?.widget&&!w,k=!!N;if(Zu(C)||j||!k){if(x===a)return y;y+=1,String(C)==="INT"&&(x==="seed"||x==="noise_seed")&&(y+=1)}}return null}function da(n,o,s){const a=$n(n,o,s,"seed")??$n(n,o,s,"noise_seed");if(a!==null)return a;if(!o)return s.outputs?.some(x=>String(x.name||"").toLowerCase().includes("seed")&&String(x.type||"").toUpperCase().includes("INT"))&&Array.isArray(s.widgets_values)&&s.widgets_values.length>0?0:null;const l=o[s.type];if(!l?.input)return s.outputs?.some(x=>String(x.name||"").toLowerCase().includes("seed")&&String(x.type||"").toUpperCase().includes("INT"))&&Array.isArray(s.widgets_values)&&s.widgets_values.length>0?0:null;const c=kp(n,s.id),d=l.input_order?.required||Object.keys(l.input.required||{}),h=l.input_order?.optional||Object.keys(l.input.optional||{}),p=[...d,...h];let m=0;for(const y of p){const x=l.input.required?.[y]||l.input.optional?.[y];if(!x)continue;const[v]=x,C=s.inputs.find(O=>O.name===y),N=C?.link!=null,w=!!C?.widget&&!N,j=!!C;if(Zu(v)||w||!j){const R=c?.[y]??m;if(String(v)==="INT"&&y.toLowerCase().includes("seed"))return R;m+=1,String(v)==="INT"&&(y==="seed"||y==="noise_seed")&&(m+=1)}}return null}function l2(n,o){const s=n[o.type];if(!s?.input)return 1;const l=(s.input.required?.seed||s.input.optional?.seed)?.[1],c=typeof l?.step=="number"?l.step:1;return c>0?c:1}function i2(n){const o=Number(n.properties?.randomMin??0),s=Number(n.properties?.randomMax??ou),a=Number.isFinite(o)?Math.max(-ou,o):0,l=Number.isFinite(s)?Math.min(ou,s):ou;return a<=l?{min:a,max:l}:{min:l,max:a}}function vl(n,o){const s=l2(n,o),{min:a,max:l}=i2(o),c=s>0?s/10:1,d=l-a;let h=a+Math.random()*d;return c>0&&(h=Math.round((h-a)/c)*c+a),h>l&&(h=l),h<a&&(h=a),Du.has(h)&&(h=0),h}function u2(n,o,s,a){if(Du.has(n)){if(typeof o=="number"&&!Du.has(o)){if(n===Ju)return o+1;if(n===ec)return o-1}return vl(s,a)}return Number.isFinite(n)?n:0}const Gn=bo()(Sr((n,o)=>({seedModes:{},seedLastValues:{},setSeedMode:(s,a,l)=>{const{seedModes:c,seedLastValues:d}=o();if(l?.workflow&&l.nodeTypes){const{workflow:h,nodeTypes:p,updateNodeWidgets:m}=l,y=h.nodes.find(x=>x.id===s);if(y){const x=da(h,p,y);if(x!==null&&Array.isArray(y.widgets_values)){const v=x+1,C=typeof y.widgets_values[v]=="string",N={};if(C)N[v]=a;else{const w=a2(a);if(w!==null&&a!=="fixed")N[x]=w;else if(a==="fixed"){const j=Number(y.widgets_values[x]);if(Lp(j)){const k=d[s],O=typeof k=="number"?k:vl(p,y);N[x]=O}}}Object.keys(N).length>0&&m(s,N)}}}n({seedModes:{...c,[s]:a}})},setSeedModes:s=>{n({seedModes:s})},setSeedLastValues:s=>{n({seedLastValues:s})},clearSeedState:()=>{n({seedModes:{},seedLastValues:{}})}}),{name:"seed-storage",storage:wr(()=>localStorage),partialize:n=>({seedModes:n.seedModes,seedLastValues:n.seedLastValues})}));function Kb(n,o){return n&&n[o]||null}function Ub(n){if(!n)return[];const o=Kb(n,"LoraLoader");if(o?.input?.required?.lora_name){const[s]=o.input.required.lora_name;if(Array.isArray(s))return s}return[]}function ny(n,o){if(!Array.isArray(n.widgets_values))return[];const s=bs(n);if(s===null)return[];const a=n.widgets_values[s];if(!Lu(a))return[];const l=Ub(o),c=[],d=a;return d.length>0&&c.push({name:"Loras",type:"LM_LORA_HEADER",options:void 0,value:d.every(h=>h?.active!==!1),widgetIndex:s,isCombo:!1,connected:!1,inputIndex:-1}),d.forEach((h,p)=>{c.push({name:h?.name||"Lora",type:"LM_LORA",options:{entryIndex:p,choices:l.length>0?l:void 0},value:h,widgetIndex:s,isCombo:!1,connected:!1,inputIndex:-1})}),c.push({name:"Add Lora",type:"LM_LORA_ADD",options:{choices:l.length>0?l:void 0},value:null,widgetIndex:s,isCombo:!1,connected:!1,inputIndex:-1}),c}function oy(n,o,s){if(!Array.isArray(n.widgets_values))return[];const a=s??Xu(n);if(a===null)return[];if(a<0||a>=n.widgets_values.length)return[];const l=n.widgets_values[a],c=Ll(l)??_l(l);return!Array.isArray(c)||c.length===0?[]:c.map((d,h)=>({name:d?.text||"Trigger Word",type:"TW_WORD",options:{entryIndex:h,allowStrengthAdjustment:o},value:d,widgetIndex:a,isCombo:!1,connected:!1,inputIndex:-1}))}function Wb(n,o){try{if(o.type==="PrimitiveNode"){const p=o.outputs?.[0]?.type;if(!p)return[];const m=String(p).toUpperCase(),y=Array.isArray(o.widgets_values)?o.widgets_values[0]:void 0;return[{name:o.outputs?.[0]?.name||"value",type:m,options:void 0,value:y,widgetIndex:0,isCombo:!1,connected:!1,inputIndex:-1}]}if(o.type==="Power Lora Loader (rgthree)"){const p=[],m=o.properties?.["Show Strengths"]==="Separate Model & Clip",y=Ub(n);if(Array.isArray(o.widgets_values)){const x=o.widgets_values,v=[];x.forEach((C,N)=>{typeof C=="object"&&C!==null&&"lora"in C&&"strength"in C&&v.push(N)}),v.length>0&&(p.push({name:"Loras",type:"POWER_LORA_HEADER",options:{loraIndices:v},value:null,widgetIndex:-1,isCombo:!1,connected:!1,inputIndex:-1}),v.forEach(C=>{const N=x[C];p.push({name:"Lora",type:"POWER_LORA",options:{choices:y.length>0?y:void 0,showSeparate:m},value:N,widgetIndex:C,isCombo:!1,connected:!1,inputIndex:-1})})),p.push({name:"Add Lora",type:"POWER_LORA_ADD",options:void 0,value:null,widgetIndex:o.widgets_values.length,isCombo:!1,connected:!1,inputIndex:-1})}return p}const s=Kb(n,o.type);if(!s?.input){const p=yr(o.type)?ny(o,n):[];if(p.length>0)return p;const m=vs(o.type)?oy(o,!1):[];return m.length>0?m:o.outputs?.some(x=>String(x.name||"").toLowerCase().includes("seed")&&String(x.type||"").toUpperCase().includes("INT"))&&Array.isArray(o.widgets_values)&&o.widgets_values.length>0?[{name:"seed",type:"INT",options:void 0,value:o.widgets_values[0],widgetIndex:0,isCombo:!1,connected:!1,inputIndex:-1}]:[]}const a=s.input_order?.required||Object.keys(s.input.required||{}),l=s.input_order?.optional||Object.keys(s.input.optional||{}),c=[];let d=0;const h=(p,m)=>{if(!m)return;const[y,x]=m,C=(Array.isArray(y)?y.map(te=>String(te)).join(","):String(y)).toUpperCase(),N=String(y),w=C.includes("AUTOCOMPLETE_TEXT_LORAS"),j=C.includes("AUTOCOMPLETE_TEXT_PROMPT"),k=yr(o.type)&&p==="text",O=w||j||k,R=o.inputs.findIndex(te=>te.name===p),D=R>=0?o.inputs[R]:void 0,I=D?.link!=null,H=!!D?.widget&&!I,A=!!D,V=Object.prototype.hasOwnProperty.call(x??{},"default"),J=Zu(y)||H||!A||V,X=Array.isArray(y)&&!O,re=X?{...x??{},options:y}:{...x??{}};if(O&&(re.multiline=!0),J){const te=pa(o,p,d);c.push({name:p,type:X?"COMBO":O?"STRING":N,options:re,value:te,widgetIndex:d,isCombo:X,connected:!!I,inputIndex:R})}J&&(d+=1,String(y)==="INT"&&(p==="seed"||p==="noise_seed")&&(d+=1))};for(const p of a){const m=s.input.required?.[p];m&&h(p,m)}for(const p of l){const m=s.input.optional?.[p];m&&h(p,m)}if(yr(o.type)&&c.push(...ny(o,n)),vs(o.type)){const p=c.find(y=>y.name==="allow_strength_adjustment")?.value,m=c.find(y=>y.name==="toggle_trigger_words")?.widgetIndex;c.push(...oy(o,!!p,m??null))}return c}catch(s){return console.error(`Error collecting widget definitions for node ${o.id} (${o.type}):`,s),[]}}function _p(n,o){return Wb(n,o).filter(s=>!s.isCombo).map(s=>({name:s.name,type:s.type,options:s.options,value:s.value,widgetIndex:s.widgetIndex,connected:s.connected,inputIndex:s.inputIndex}))}function Ap(n,o){return Wb(n,o).filter(s=>s.isCombo).map(s=>({name:s.name,type:s.type,value:s.value,options:s.options,widgetIndex:s.widgetIndex,connected:s.connected,inputIndex:s.inputIndex}))}function c2(n){let o=5381;for(let s=0;s<n.length;s+=1)o=(o<<5)+o+n.charCodeAt(s),o&=4294967295;return(o>>>0).toString(16).padStart(8,"0")}function d2(n,o){if(!n)return!1;const s=_p(n,o).filter(l=>!l.connected),a=Ap(n,o).filter(l=>!l.connected);return s.length===0&&a.length===0}function f2(n){const o=n.nodes??[],s=n.definitions?.subgraphs?.flatMap(a=>a.nodes??[])??[];return[...o,...s]}function xf(n,o){const l=f2(n).filter(c=>!d2(o,c)).map(c=>c.type).sort().join("|");return`wf_${c2(l)}`}const ry="__mobile_origin",ru="__mobile_subgraph_group_map";function vf(n,o,s){const a={...n.properties??{}};return s&&a[ry]===void 0&&(a[ry]=s),{...n,id:o,inputs:(n.inputs??[]).map(l=>({...l,link:null})),outputs:(n.outputs??[]).map(l=>({...l,links:[]})),widgets_values:n.widgets_values??[],flags:n.flags??{},properties:a,mode:n.mode??0,order:n.order??0}}function p2(n,o){if(!o||o.length===0)return null;const s=[...o].sort((m,y)=>m.id-y.id),[a,l]=n.pos,[c,d]=n.size,h=a+c/2,p=l+d/2;for(const m of s){const[y,x,v,C]=m.bounding;if(h>=y&&h<=y+v&&p>=x&&p<=x+C)return m.id}return null}function sy(n,o){const s=new Map,a=new Map;return o.forEach((l,c)=>{l?.name&&a.set(l.name,c)}),n.forEach((l,c)=>{const d=l?.name;if(d&&a.has(d)){s.set(c,a.get(d));return}c<o.length&&s.set(c,c)}),s}function h2(n,o){const s=new Map;for(const a of n)a.inputs=(a.inputs??[]).map(l=>({...l,link:null})),a.outputs=(a.outputs??[]).map(l=>({...l,links:[]})),s.set(a.id,a);for(const a of o){const[l,c,d,h,p]=a,m=s.get(c),y=s.get(h),x=m?.outputs?.[d],v=y?.inputs?.[p];x&&(x.links||(x.links=[]),x.links.push(l)),v&&(v.link=l)}return n}function g2(n,o){const s=n.nodes.filter(N=>o.has(N.type));if(s.length===0)return{workflow:n,changed:!1};const a=new Set(s.map(N=>N.id));let l=Math.max(0,...n.nodes.map(N=>N.id))+1;const c=[],d=n.groups??[],h=n.extra??{},p=typeof h[ru]=="object"&&h[ru]!==null?h[ru]:{},m={};for(const[N,w]of Object.entries(p))(typeof w=="number"||w===null)&&(m[N]=w);const y=new Map;for(const N of n.nodes){if(!a.has(N.id)){c.push(vf(N,N.id,{scope:"root",nodeId:N.id}));continue}const w=o.get(N.type);if(!w){c.push(vf(N,N.id,{scope:"root",nodeId:N.id}));continue}const j=p2(N,d);m[w.id]=j??null;const k=sy(N.inputs??[],w.inputs??[]),O=sy(N.outputs??[],w.outputs??[]),R=new Map,D=new Map,I=new Map,H=[];for(const A of w.nodes??[]){const V=l++;R.set(A.id,V),c.push(vf(A,V,{scope:"subgraph",subgraphId:w.id,nodeId:A.id}))}for(const A of w.links??[]){const V=A.origin_id,J=A.target_id;if(V===-10){const te=R.get(J);if(te!==void 0){const me=D.get(A.origin_slot)??[];me.push({origin_id:-10,origin_slot:A.origin_slot,target_id:te,target_slot:A.target_slot,type:A.type}),D.set(A.origin_slot,me)}continue}if(J===-20){const te=R.get(V);if(te!==void 0){const me=I.get(A.target_slot)??[];me.push({origin_id:te,origin_slot:A.origin_slot,target_id:-20,target_slot:A.target_slot,type:A.type}),I.set(A.target_slot,me)}continue}const X=R.get(V),re=R.get(J);X!==void 0&&re!==void 0&&H.push({origin_id:X,origin_slot:A.origin_slot,target_id:re,target_slot:A.target_slot,type:A.type})}y.set(N.id,{inputSlotMap:k,outputSlotMap:O,inputTargets:D,outputSources:I,internalLinks:H})}const x=[],v=n.links??[];for(const N of v){const[,w,j,k,O,R]=N,D=a.has(w),I=a.has(k);if(!D&&!I){x.push({origin_id:w,origin_slot:j,target_id:k,target_slot:O,type:R});continue}if(D&&I){const H=y.get(w),A=y.get(k),V=H?.outputSlotMap.get(j),J=A?.inputSlotMap.get(O);if(V===void 0||J===void 0)continue;const X=H?.outputSources.get(V)??[],re=A?.inputTargets.get(J)??[];for(const te of X)for(const me of re)x.push({origin_id:te.origin_id,origin_slot:te.origin_slot,target_id:me.target_id,target_slot:me.target_slot,type:te.type});continue}if(D){const H=y.get(w),A=H?.outputSlotMap.get(j);if(A===void 0)continue;const V=H?.outputSources.get(A)??[];for(const J of V)x.push({origin_id:J.origin_id,origin_slot:J.origin_slot,target_id:k,target_slot:O,type:J.type});continue}if(I){const H=y.get(k),A=H?.inputSlotMap.get(O);if(A===void 0)continue;const V=H?.inputTargets.get(A)??[];for(const J of V)x.push({origin_id:w,origin_slot:j,target_id:J.target_id,target_slot:J.target_slot,type:J.type})}}for(const N of y.values())x.push(...N.internalLinks);const C=x.map((N,w)=>[w+1,N.origin_id,N.origin_slot,N.target_id,N.target_slot,N.type]);return h2(c,C),{workflow:{...n,extra:{...h,[ru]:m},nodes:c,links:C,last_node_id:Math.max(0,...c.map(N=>N.id)),last_link_id:C.length},changed:!0}}function m2(n){const o=n.definitions?.subgraphs??[];if(o.length===0)return n;const s=new Map;for(const l of o)l?.id&&s.set(l.id,l);let a=n;for(let l=0;l<o.length+4;l+=1){const{workflow:c,changed:d}=g2(a,s);if(!d)break;a=c}return a}function y2(n){const o=new Map,s=new Map,a=new Map;for(const l of n.nodes)o.set(l.id,l),s.set(l.id,[]),a.set(l.id,[]);for(const l of n.links){const[,c,,d]=l,h=s.get(d);h&&!h.includes(c)&&h.push(c);const p=a.get(c);p&&!p.includes(d)&&p.push(d)}return{nodes:o,dependencies:s,dependents:a}}function b2(n){return["SaveImage","PreviewImage","SaveAnimatedWEBP","SaveAnimatedPNG","SaveVideo","SaveAudio"].some(s=>n.type.includes(s))||n.outputs.length===0||n.outputs.every(s=>!s.links||s.links.length===0)}function x2(n){if(n.nodes.length===0)return[];const o=y2(n),s=new Set,a=[];function l(d){if(s.has(d))return;s.add(d);const h=o.nodes.get(d);if(!h)return;const p=o.dependencies.get(d)||[];for(const m of p)l(m);a.push(h)}const c=n.nodes.filter(b2);if(c.length===0)for(const d of n.nodes)(o.dependents.get(d.id)||[]).length===0&&c.push(d);for(const d of c)l(d.id);for(const d of n.nodes)s.has(d.id)||l(d.id);return a}function ha(n,o,s){const a=n.nodes.find(m=>m.id===o);if(!a||!a.inputs[s])return null;const l=a.inputs[s].link;if(l===null)return null;const c=n.links.find(m=>m[0]===l);if(!c)return null;const[,d,h]=c,p=n.nodes.find(m=>m.id===d);return p?{node:p,outputIndex:h}:null}function wl(n,o,s){const a=n.nodes.find(d=>d.id===o);if(!a||!a.outputs[s])return[];const l=a.outputs[s].links||[],c=[];for(const d of l){const h=n.links.find(x=>x[0]===d);if(!h)continue;const[,,,p,m]=h,y=n.nodes.find(x=>x.id===p);y&&c.push({node:y,inputIndex:m})}return c}function Sl(n){if(n==null)return[];if(Array.isArray(n))return n.flatMap(s=>Sl(s)).filter(Boolean);const o=String(n);return o?o.split(",").map(s=>s.trim().toUpperCase()).filter(Boolean):[]}function ay(n){return!(n==="*"||n==="OPT_CONNECTION")}function ly(n,o){const s=Sl(n),a=Sl(o);return s.length===0||a.length===0?!1:s.includes("*")||a.includes("*")?!0:s.some(l=>a.includes(l))}function tc(n,o){const s=Sl(n).filter(ay),a=Sl(o).filter(ay);return s.length===0||a.length===0?!1:s.some(l=>a.includes(l))}function v2(n,o,s,a){const l=n.nodes.find(h=>h.id===s);if(!l)return[];const c=l.inputs[a];if(!c)return[];const d=[];for(const h of n.nodes)if(h.id!==s&&h.mode!==4)for(let p=0;p<h.outputs.length;p++){const m=h.outputs[p];if(tc(m.type,c.type)){d.push({node:h,outputIndex:p});break}}return d}function w2(n,o){const s=[];for(const[a,l]of Object.entries(n)){const c=l.output??[];for(let d=0;d<c.length;d++)if(tc(c[d],o)){s.push({typeName:a,def:l,outputIndex:d});break}}return s}function S2(n){const o=n.input?.required??{},s=n.input?.optional??{},a=n.input_order?.required??Object.keys(o),l=n.input_order?.optional??Object.keys(s),c=[],d=(h,p)=>{if(!Array.isArray(p)||p.length===0)return;const[m]=p;if(Array.isArray(m))return;const y=String(m).toUpperCase();["INT","FLOAT","BOOLEAN","STRING"].includes(y)||c.push({inputIndex:c.length,inputName:h,inputType:String(m)})};for(const h of a)d(h,o[h]);for(const h of l)d(h,s[h]);return c}function N2(n,o){const s=[];for(const[a,l]of Object.entries(n)){const c=S2(l);for(const d of c)if(tc(o,d.inputType)){s.push({typeName:a,def:l,inputIndex:d.inputIndex,inputName:d.inputName,inputType:d.inputType});break}}return s}function C2(n,o,s){const a=n.nodes.find(d=>d.id===o);if(!a)return[];const l=a.outputs?.[s];if(!l)return[];const c=[];for(const d of n.nodes)if(d.id!==o&&d.mode!==4)for(let h=0;h<(d.inputs?.length??0);h+=1){const p=d.inputs[h];tc(l.type,p.type)&&c.push({node:d,inputIndex:h})}return c}function Nl(n,o){const s=new Map;if(!o||o.length===0)return s;const a=[...o].sort((l,c)=>{const d=l.bounding[2]*l.bounding[3],h=c.bounding[2]*c.bounding[3];return d!==h?d-h:l.id-c.id});for(const l of n){const[c,d]=l.pos,[h,p]=l.size,m=c+h/2,y=d+p/2;for(const x of a){const[v,C,N,w]=x.bounding;if(m>=v&&m<=v+N&&y>=C&&y<=C+w){s.set(l.id,x.id);break}}}return s}function Nu(){return{root:[],groups:{},groupParents:{},subgraphs:{},hiddenBlocks:{}}}function Rp(n){const o=n.split("/").filter(Boolean);if(o.length===0||o[0]!=="root")return null;const s=o.slice(1);if(s.length===0)return null;const a=h=>{const p=h.indexOf(":");if(p<=0)return null;const m=h.slice(0,p),y=h.slice(p+1);return m!=="node"&&m!=="group"&&m!=="subgraph"||y.length===0?null:{type:m,rawId:y}};let l=null;for(let h=0;h<s.length-1;h+=1){const p=a(s[h]);if(!p||p.type==="node")return null;p.type==="subgraph"&&(l=p.rawId)}const c=a(s[s.length-1]);if(!c)return null;if(c.type==="subgraph")return{type:"subgraph",subgraphId:c.rawId};const d=Number(c.rawId);return Number.isFinite(d)?c.type==="group"?{type:"group",groupId:d,subgraphId:l}:{type:"node",nodeId:d,subgraphId:l}:null}function hn(n){if(n.type==="group"&&n.groupKey)return n.groupKey;const o=n.subgraphId==null?"root":`root/subgraph:${n.subgraphId}`;return n.type==="group"?`${o}/group:${n.groupId}`:n.type==="node"?`${o}/node:${n.nodeId}`:`root/subgraph:${n.subgraphId}`}function k2(n,o){return n.type!==o.type?!1:n.type==="node"&&o.type==="node"?n.id===o.id:n.type==="group"&&o.type==="group"?n.stableKey===o.stableKey:n.type==="subgraph"&&o.type==="subgraph"?n.id===o.id:n.type==="hiddenBlock"&&o.type==="hiddenBlock"?n.blockId===o.blockId:!1}function j2(n){const s=n.properties?.__mobile_origin;if(!s||typeof s!="object")return null;const a=s.scope;if(a==="root")return{scope:"root"};if(a==="subgraph"){const l=s.subgraphId;if(typeof l=="string")return{scope:"subgraph",subgraphId:l}}return null}function M2(n,o,s){const a=o.groups??[],l=o.definitions?.subgraphs??[],c=new Map;for(const H of n){const A=j2(H);A?.scope==="subgraph"&&A.subgraphId&&c.set(H.id,A.subgraphId)}const d=n.filter(H=>!c.has(H.id)),h=Nl(d,a),p=new Map;for(const H of l){const A=n.filter(J=>c.get(J.id)===H.id),V=H.groups??[];V.length>0&&p.set(H.id,Nl(A,V))}const m=o.extra?.__mobile_subgraph_group_map,y=new Map;if(m&&typeof m=="object")for(const[H,A]of Object.entries(m))(typeof A=="number"||A===null)&&y.set(H,A);const x=Nu();for(const H of l)x.subgraphs[H.id]=[];const v=H=>{const A=new Map;for(const V of H){const[J,X,re,te]=V.bounding,me=J+re/2,Te=X+te/2,F=re*te;let _=null,q=Number.POSITIVE_INFINITY;for(const de of H){if(de.id===V.id)continue;const[Me,Ne,M,L]=de.bounding,K=M*L;if(K<=F)continue;const je=J>=Me&&X>=Ne&&J+re<=Me+M&&X+te<=Ne+L,We=me>=Me&&me<=Me+M&&Te>=Ne&&Te<=Ne+L;!je&&!We||K<q&&(q=K,_=de.id)}A.set(V.id,_)}return A};function C(H,A,V){const J=[];let X=[],re=0;const te=()=>{if(X.length===0)return;const me=`hidden-${A}-${re}`;re++,x.hiddenBlocks[me]=[...X],J.push({type:"hiddenBlock",blockId:me}),X=[]};for(const me of H)me.type==="node"&&s[hn({type:"node",nodeId:me.id,subgraphId:V})]?X.push(me.id):(te(),J.push(me));return te(),J}for(const H of l){const A=n.filter(q=>c.get(q.id)===H.id),V=p.get(H.id),J=H.groups??[],X=v(J),re=new Map,te=new Map((H.groups??[]).map(q=>[q.id,q])),me=new Set,Te=[],F=q=>re.get(q)??`legacy-group-${H.id}-${q}`,_=q=>{const de=[],Me=new Set;let Ne=q;for(;Ne!=null&&!Me.has(Ne);)de.push(Ne),Me.add(Ne),Ne=X.get(Ne)??null;de.reverse();for(const M of de){if(me.has(M))continue;const L=X.get(M)??null,K=te.get(M)?.stableKey??`legacy-group-${H.id}-${M}`;re.set(M,K);const je={type:"group",id:M,subgraphId:H.id,stableKey:K};if(L==null)Te.push(je),x.groupParents[K]={scope:"subgraph",subgraphId:H.id};else{const We=F(L);x.groups[We]??=[],x.groups[We].push(je),x.groupParents[K]={scope:"group",groupKey:We}}me.add(M)}};for(const q of A){const de=V?.get(q.id);if(de===void 0){Te.push({type:"node",id:q.id});continue}_(de),x.groups[F(de)]??=[],x.groups[F(de)].push({type:"node",id:q.id})}for(const q of J)_(q.id);for(const q of J){const de=F(q.id);x.groups[de]=C(x.groups[de]??[],`group-${de}`,H.id)}x.subgraphs[H.id]=C(Te,`subgraph-${H.id}`,H.id)}const N=v(a),w=new Set,j=new Set,k=[],O=new Map,R=new Map(a.map(H=>[H.id,H])),D=H=>O.get(H)??`legacy-group-root-${H}`,I=H=>{const A=[],V=new Set;let J=H;for(;J!=null&&!V.has(J);)A.push(J),V.add(J),J=N.get(J)??null;A.reverse();for(const X of A){if(w.has(X))continue;const re=N.get(X)??null,te=R.get(X)?.stableKey??`legacy-group-root-${X}`;O.set(X,te);const me={type:"group",id:X,subgraphId:null,stableKey:te};if(re==null)k.push(me),x.groupParents[te]={scope:"root"};else{const Te=D(re);x.groups[Te]??=[],x.groups[Te].push(me),x.groupParents[te]={scope:"group",groupKey:Te}}w.add(X)}};for(const H of d){const A=h.get(H.id);if(A===void 0){k.push({type:"node",id:H.id});continue}I(A),x.groups[D(A)]??=[],x.groups[D(A)].push({type:"node",id:H.id})}for(const H of l){if(j.has(H.id))continue;const A=y.get(H.id);A!=null?(I(A),x.groups[D(A)]??=[],x.groups[D(A)].push({type:"subgraph",id:H.id})):k.push({type:"subgraph",id:H.id}),j.add(H.id)}for(const H of a)I(H.id);for(const H of a){const A=D(H.id);x.groups[A]=C(x.groups[A]??[],`group-${A}`,null)}return x.root=C(k,"root",null),x}function iy(n,o){const s=d=>{const h=[];for(const p of d)if(!(p.type==="node"&&p.id===o)){if(p.type==="hiddenBlock"){const m=n.hiddenBlocks[p.blockId];if(m&&m.filter(x=>x!==o).length===0)continue}h.push(p)}return h},a={};for(const[d,h]of Object.entries(n.hiddenBlocks)){const p=h.filter(m=>m!==o);p.length>0&&(a[d]=p)}const l={};for(const[d,h]of Object.entries(n.groups))l[d]=s(h);const c={};for(const[d,h]of Object.entries(n.subgraphs))c[d]=s(h);return{root:s(n.root),groups:l,groupParents:n.groupParents??{},subgraphs:c,hiddenBlocks:a}}function O2(n,o,s){const a={type:"node",id:o},l=(c,d)=>{const h=(p,m)=>{for(const y of p){if(y.type==="group"&&y.id===c&&m===d)return y.stableKey;if(y.type==="group"){const x=h(n.groups[y.stableKey]??[],m);if(x)return x;continue}if(y.type==="subgraph"){const x=h(n.subgraphs[y.id]??[],y.id);if(x)return x}}return null};return h(n.root,null)};if(s?.subgraphId){const c=n.subgraphs[s.subgraphId]??[];if(s.groupId!=null){const d=l(s.groupId,s.subgraphId);if(!d)return{...n,subgraphs:{...n.subgraphs,[s.subgraphId]:[...c,a]}};const h=n.groups[d]??[];return{...n,groups:{...n.groups,[d]:[...h,a]}}}return{...n,subgraphs:{...n.subgraphs,[s.subgraphId]:[...c,a]}}}if(s?.groupId!=null){const c=l(s.groupId,s.subgraphId??null);if(!c)return{...n,root:[...n.root,a]};const d=n.groups[c]??[];return{...n,groups:{...n.groups,[c]:[...d,a]}}}return{...n,root:[...n.root,a]}}function T2(n,o){const s=n.groups[o]??[],a=m=>{const y=[];for(const x of m)x.type==="group"&&x.stableKey===o?y.push(...s):y.push(x);return y},l={...n.groups},c={...n.groupParents??{}},d=c[o];delete l[o],delete c[o];let h=n.root;n.root.some(m=>m.type==="group"&&m.stableKey===o)&&(h=a(n.root));for(const[m,y]of Object.entries(l))y.some(x=>x.type==="group"&&x.stableKey===o)&&(l[m]=a(y));const p={...n.subgraphs};for(const[m,y]of Object.entries(p))y.some(x=>x.type==="group"&&x.stableKey===o)&&(p[m]=a(y));for(const m of s)m.type==="group"&&(d?c[m.stableKey]=d:delete c[m.stableKey]);return{root:h,groups:l,groupParents:c,subgraphs:p,hiddenBlocks:n.hiddenBlocks}}function E2(n,o,s,a,l,c){const d=n.groupParents??{},h=(N,w)=>w.scope==="root"?N.root:w.scope==="group"?N.groups[w.groupKey]??[]:N.subgraphs[w.subgraphId]??[],p=(N,w,j)=>w.scope==="root"?{...N,root:j}:w.scope==="group"?{...N,groups:{...N.groups,[w.groupKey]:j}}:{...N,subgraphs:{...N.subgraphs,[w.subgraphId]:j}},m=N=>N.scope==="root"?{scope:"root"}:N.scope==="group"?{scope:"group",groupKey:N.groupKey}:{scope:"subgraph",subgraphId:N.subgraphId};if(s.scope===l.scope&&(s.scope==="root"||s.scope==="group"&&l.scope==="group"&&s.groupKey===l.groupKey||s.scope==="subgraph"&&l.scope==="subgraph"&&s.subgraphId===l.subgraphId)){const N=[...h(n,s)],[w]=N.splice(a,1);if(!w)return n;const j=c>a?c-1:c;return N.splice(j,0,w),p(n,s,N)}const x=[...h(n,s)];x.splice(a,1);let v=p(n,s,x);const C=[...h(v,l)];return C.splice(c,0,o),v=p(v,l,C),o.type==="group"&&(v={...v,groupParents:{...v.groupParents??d,[o.stableKey]:m(l)}}),v}function Fb(n){const o=[],s=a=>{for(const l of a)if(l.type==="node")o.push(l.id);else if(l.type==="group"){const c=n.groups[l.stableKey];c&&s(c)}else if(l.type==="subgraph"){const c=n.subgraphs[l.id];c&&s(c)}else if(l.type==="hiddenBlock"){const c=n.hiddenBlocks[l.blockId];c&&o.push(...c)}};return s(n.root),o}function I2(n,o){return o.scope==="root"?n.root:o.scope==="group"?n.groups[o.groupKey]??[]:n.subgraphs[o.subgraphId]??[]}function qb(n,o){const s=(l,c)=>{const d=l.findIndex(h=>k2(h,o));return d>=0?{containerId:c,index:d}:null},a=s(n.root,{scope:"root"});if(a)return a;for(const[l,c]of Object.entries(n.groups)){const d=s(c,{scope:"group",groupKey:l});if(d)return d}for(const[l,c]of Object.entries(n.subgraphs)){const d=s(c,{scope:"subgraph",subgraphId:l});if(d)return d}return null}function L2(n,o,s=250){const a=n.nodes.find(l=>l.id===o);return a?[a.pos[0]+s,a.pos[1]]:null}function uy(n){return n.nodes.length===0?[0,0]:[0,Math.max(...n.nodes.map(s=>s.pos[1]+(s.size?.[1]??100)))+80]}function _2(n,o,s,a=24){const[l,c,d,h]=o.bounding,[p,m]=s,y=l+a,x=c+48,v=Math.max(y,l+d-p-a),C=Math.max(x,c+h-m-a);return[Math.min(Math.max(n[0],y),v),Math.min(Math.max(n[1],x),C)]}function Gb(n,o){const s=(a,l,c,d)=>{for(const h of a){if(o({ref:h,groupKeys:l,subgraphIds:c,currentSubgraphId:d}))return{groupKeys:l,subgraphIds:c,currentSubgraphId:d};if(h.type==="group"){const p=s(n.groups[h.stableKey]??[],[...l,h.stableKey],c,d);if(p)return p;continue}if(h.type==="subgraph"){const p=s(n.subgraphs[h.id]??[],l,[...c,h.id],h.id);if(p)return p}}return null};return s(n.root,[],[],null)}const Zf="__mobile_origin",Pr="__mobile_subgraph_group_map";let A2=0;function hs(n,o){return M2(x2(n),n,o)}function R2(){return typeof crypto<"u"&&typeof crypto.randomUUID=="function"?`sk_${crypto.randomUUID()}`:`sk_${Math.random().toString(36).slice(2)}_${Date.now().toString(36)}`}function D2(n){const o=[],s=new Set,a=new Set,l=(c,d)=>{for(const h of c){if(h.type==="node"){o.push(hn({type:"node",nodeId:h.id,subgraphId:d}));continue}if(h.type==="group"){if(o.push(h.stableKey),s.has(h.stableKey))continue;s.add(h.stableKey),l(n.groups[h.stableKey]??[],d);continue}if(h.type==="subgraph"){const p=hn({type:"subgraph",subgraphId:h.id});if(o.push(p),a.has(h.id))continue;a.add(h.id),l(n.subgraphs[h.id]??[],h.id)}}};return l(n.root,null),o}function cy(n){const o=Rp(n);return o?o.type==="node"?`node:${o.nodeId}`:o.type==="group"?`group:${o.subgraphId??"root"}:${o.groupId}`:`subgraph:${o.subgraphId}`:`unknown:${n}`}function Ao(n,o,s){const a=D2(n),l=new Map;for(const[p,m]of Object.entries(s)){const y=cy(m),x=l.get(y)??[];x.push(p),l.set(y,x)}const c=new Set,d={},h={};for(const p of a){let m=o[p];if(m&&c.has(m)&&(m=void 0),!m){const y=cy(p),x=l.get(y)??[];for(;x.length>0;){const v=x.shift();if(!(!v||c.has(v))){m=v;break}}l.set(y,x)}m||(m=R2()),c.add(m),d[p]=m,h[m]=p}return{layoutToStable:d,stableToLayout:h}}function B2(n,o){const s=new Set(o.nodes.map(l=>l.id)),a=new Set(Fb(n));if(s.size!==a.size)return!1;for(const l of s)if(!a.has(l))return!1;return!0}function Cl(n,o=null){return hn({type:"node",nodeId:n,subgraphId:o})}function z2(n){const o=ho(n);return Cl(n.id,o?.scope==="subgraph"?o.subgraphId:null)}const dy=new WeakMap;function H2(n){const o=dy.get(n);if(o)return o;const s=new Map;for(const a of n.nodes){const l=z2(a),c=s.get(a.id);c?c.includes(l)||c.push(l):s.set(a.id,[l])}return dy.set(n,s),s}function yl(n,o,s=null){if(s!=null)return[Cl(o,s)];const a=H2(n).get(o)??[];return a.length>0?[...a]:[Cl(o,null)]}function wf(n,o){if(!o)return{};const s={};for(const[a,l]of Object.entries(o)){if(!l)continue;if(a.includes(":node:")||a.includes("/node:")){const d=Rp(a);if(d?.type==="node"){s[Cl(d.nodeId,d.subgraphId)]=!0;continue}const h=a.match(/^(root|subgraph:(.*)):node:(\d+)$/);if(!h)continue;const p=Number(h[3]);if(!Number.isFinite(p))continue;s[Cl(p,h[1]==="root"?null:h[2]??null)]=!0;continue}const c=Number(a);if(Number.isFinite(c))for(const d of yl(n,c))s[d]=!0}return s}function fy(n){const o=l=>l.map(c=>c.type!=="group"?c:{...c}),s={};for(const[l,c]of Object.entries(n.groups)){const d=l,h=o(c);s[d]?s[d]=[...s[d],...h]:s[d]=h}const a={};for(const[l,c]of Object.entries(n.subgraphs))a[l]=o(c);return{...n,root:o(n.root),groups:s,subgraphs:a}}function su(n,o,s=null){const a=new Set,l=(c,d)=>{for(const h of c)h.type==="group"?(h.id===o&&d===s&&a.add(h.stableKey),l(n.groups[h.stableKey]??[],d)):h.type==="subgraph"&&l(n.subgraphs[h.id]??[],h.id)};return l(n.root,null),[...a]}function Dp(n,o){return o[n]??null}function V2(n,o){const s=new Set,a=[];for(const l of n){const c=Dp(l,o);!c||s.has(c)||(s.add(c),a.push(c))}return a}function $2(n,o,s=null){const a=[],l=new Set;for(const[c,d]of Object.entries(n)){if(l.has(d))continue;const h=Rp(c);h?.type==="node"&&h.nodeId===o&&(s!==null&&h.subgraphId!==s||(l.add(d),a.push(d)))}return a}function gs(n,o,s,a=null){const l=$2(o,s,a);return l.length>0?l:V2(yl(n,s,a),o)}function Vn(n,o,s){const a=n.nodes.find(l=>l.stableKey===o);if(a){const l=ho(a);return{nodeId:a.id,subgraphId:l?.scope==="subgraph"?l.subgraphId:null}}return null}function au(n,o,s){const a=(n.groups??[]).find(l=>l.stableKey===o);if(a)return{type:"group",groupId:a.id,subgraphId:null,stableKey:o};for(const l of n.definitions?.subgraphs??[]){if(l.stableKey===o)return{type:"subgraph",subgraphId:l.id,stableKey:o};const c=(l.groups??[]).find(d=>d.stableKey===o);if(c)return{type:"group",groupId:c.id,subgraphId:l.id,stableKey:o}}return null}function lu(n,o){return(n.definitions?.subgraphs??[]).find(a=>a.id===o)?.stableKey??null}function Pb(n,o){const s=n.groupParents?.[o];return s?s.scope==="subgraph"?s.subgraphId:s.scope==="root"?null:Pb(n,s.groupKey):null}function Sf(n,o){if(!n)return{};const s={};for(const[a,l]of Object.entries(n)){if(!l)continue;const c=Dp(a,o);c&&(s[c]=!0)}return s}function K2(n,o){if(!n)return{};const s={};for(const[a,l]of Object.entries(n)){if(l!==!0)continue;const c=Dp(a,o);c&&(s[c]=!0)}return s}function iu(n,o,s){if(!n)return{};const a={};for(const[l,c]of Object.entries(n)){if(!c)continue;if(s[l]){a[l]=!0;continue}const d=o[l];d&&(a[d]=!0)}return a}function Nf(n,o,s){if(!n)return{};const a={};for(const[l,c]of Object.entries(n)){if(c!==!0)continue;if(s[l]){a[l]=!0;continue}const d=o[l];d&&(a[d]=!0)}return a}function uu(n,o){if(!n)return{};const s={};for(const[a,l]of Object.entries(n)){if(!l)continue;const c=o[a];c&&(s[c]=!0)}return s}function Jf(n){return n.map(o=>({...o,widgets_values:o.widgets_values??[],inputs:o.inputs??[],outputs:o.outputs??[],flags:o.flags??{},properties:o.properties??{},mode:o.mode??0,order:o.order??0}))}function py(n){const o=JSON.parse(JSON.stringify(n));return o.nodes=Jf(o.nodes??[]),o.links=o.links??[],o.groups=o.groups??[],o.config=o.config??{},o.definitions?.subgraphs&&(o.definitions.subgraphs=o.definitions.subgraphs.map(s=>({...s,nodes:Jf(s.nodes??[]),links:s.links??[]}))),o.last_node_id=o.last_node_id??Math.max(0,...o.nodes.map(s=>s.id)),o.last_link_id=o.last_link_id??0,o.version=o.version??.4,o}function hy(n){if(!("stableKey"in n))return n;const{stableKey:o,...s}=n;return s}function gy(n){if(!("stableKey"in n))return n;const{stableKey:o,...s}=n;return s}function Bu(n){const o=n.nodes.map(hy),s=(n.groups??[]).map(gy),a=o.some((h,p)=>h!==n.nodes[p])||s.some((h,p)=>h!==(n.groups??[])[p]),l=n.definitions?.subgraphs;if(!l)return a?{...n,nodes:o,groups:s}:n;let c=!1;const d=l.map(h=>{const p=h.nodes.map(hy),m=(h.groups??[]).map(gy);let y=p.some((C,N)=>C!==h.nodes[N])||m.some((C,N)=>C!==(h.groups??[])[N]);if(h.stableKey!=null&&(y=!0),!y)return h;c=!0;const{stableKey:x,...v}=h;return{...v,nodes:p,groups:m}});return!a&&!c?n:{...n,nodes:o,groups:s,definitions:{...n.definitions??{},subgraphs:d}}}function ho(n){if(!n)return null;const s=n.properties?.[Zf];if(!s||typeof s!="object")return null;const a=s.scope;if(a==="root"){const l=s.nodeId;return typeof l=="number"?{scope:"root",nodeId:l}:null}if(a==="subgraph"){const l=s.nodeId,c=s.subgraphId;if(typeof l=="number"&&typeof c=="string")return{scope:"subgraph",subgraphId:c,nodeId:l}}return null}function U2(n){const o=ho(n);return hn({type:"node",nodeId:n.id,subgraphId:o?.scope==="subgraph"?o.subgraphId:null})}function my(n,o,s=null){return n.map(a=>{const l=s===null?U2(a):hn({type:"node",nodeId:a.id,subgraphId:s}),c=o[l];return!c||a.stableKey===c?a:{...a,stableKey:c}})}function yy(n,o,s){return n.map(a=>{const l=hn({type:"group",groupId:a.id,subgraphId:s}),c=o[l];return!c||a.stableKey===c?a:{...a,stableKey:c}})}function Oo(n,o){const s=my(n.nodes,o),a=yy(n.groups??[],o,null),l=s.some((m,y)=>m!==n.nodes[y]),c=a.some((m,y)=>m!==(n.groups??[])[y]),d=n.definitions?.subgraphs;if(!d)return l||c?{...n,nodes:s,groups:a}:n;let h=!1;const p=d.map(m=>{const y=my(m.nodes??[],o,m.id),x=yy(m.groups??[],o,m.id),v=hn({type:"subgraph",subgraphId:m.id}),C=o[v];return y.some((w,j)=>w!==(m.nodes??[])[j])||x.some((w,j)=>w!==(m.groups??[])[j])||C!=null&&m.stableKey!==C?(h=!0,{...m,stableKey:C??m.stableKey,nodes:y,groups:x}):m});return!l&&!c&&!h?n:{...n,nodes:s,groups:a,definitions:{...n.definitions??{},subgraphs:p}}}function zu(n,o){const s=new Set,a=Array.from(n);for(;a.length>0;){const l=a.pop();if(!l||s.has(l))continue;s.add(l);const c=o.get(l);if(c)for(const d of c)s.has(d)||a.push(d)}return s}function W2(n){const o=new Set(n.map(a=>a.id)),s=new Map;for(const a of n)for(const l of a.nodes??[]){if(!o.has(l.type))continue;const c=s.get(l.type)??[];c.push({parentId:a.id,nodeId:l.id}),s.set(l.type,c)}return s}function dl(n,o,s){return!s||s.length===0?null:Nl(o,s).get(n)??null}function F2(n,o){const s=Gb(n,({ref:a,currentSubgraphId:l})=>a.type==="node"&&o.type==="node"?a.id===o.id:a.type==="group"&&o.type==="group"?o.id===a.id&&(o.subgraphId??null)===l:a.type==="subgraph"&&o.type==="subgraph"?o.id===a.id:!1);return s?{groupKeys:s.groupKeys,subgraphIds:s.subgraphIds}:null}function ep(n,o,s=null){const a=n.nodes??[],l=n.groups??[],c=n.definitions?.subgraphs??[],d=new Map(c.map(v=>[v.id,v])),h=new Set(c.map(v=>v.id)),p=new Map,m=[];for(const v of a){const C=ho(v);if(C?.scope==="subgraph"){const N=p.get(C.subgraphId);N?N.push(v):p.set(C.subgraphId,[v])}else m.push(v)}const y=new Map;for(const v of c){const C=new Set;for(const N of v.nodes??[])h.has(N.type)&&C.add(N.type);C.size>0&&y.set(v.id,C)}const x=new Set;if(s){const v=d.get(s);if(!v)return x;const C=v.groups??[];if(!C.find(I=>I.id===o))return x;const w=v.nodes??[],j=Nl(w,C),k=new Set,O=new Set;for(const I of w)j.get(I.id)===o&&(h.has(I.type)?k.add(I.type):O.add(I.id));const R=p.get(s)??[];for(const I of R){const H=ho(I);H?.scope==="subgraph"&&O.has(H.nodeId)&&x.add(I.id)}const D=zu(k,y);for(const I of D){const H=p.get(I)??[];for(const A of H)x.add(A.id)}}else{if(!l.find(k=>k.id===o))return x;const C=Nl(m,l);for(const k of m)C.get(k.id)===o&&x.add(k.id);const N=n.extra?.[Pr],w=new Set;if(N&&typeof N=="object")for(const[k,O]of Object.entries(N))O===o&&w.add(k);const j=zu(w,y);for(const k of j){const O=p.get(k)??[];for(const R of O)x.add(R.id)}}return x}function Yb(n){const o=n.definitions?.subgraphs??[],s=new Set(o.map(l=>l.id)),a=new Map;for(const l of o){const c=new Set;for(const d of l.nodes??[])s.has(d.type)&&c.add(d.type);c.size>0&&a.set(l.id,c)}return a}function by(n,o){const s=Yb(n),a=zu([o],s),l=new Set;for(const c of n.nodes??[]){const d=ho(c);d?.scope==="subgraph"&&a.has(d.subgraphId)&&l.add(c.id)}return l}function q2(n,o){return n.scope==="subgraph"?n.subgraphId:n.scope==="root"?null:Pb(o,n.groupKey)}function G2(n,o){const s=new Map;let a=Math.max(0,...o.map(c=>c.id))+1;const l=n.map(c=>{const d=a++;return s.set(c.id,d),{...c,id:d}});return{idMap:s,promotedGroups:l}}function xy(n,o){if(o.size===0)return n;const s=new Set;for(const c of n.links??[])(o.has(c[1])||o.has(c[3]))&&s.add(c[0]);const a=(n.links??[]).filter(c=>!s.has(c[0])),l=(n.nodes??[]).filter(c=>!o.has(c.id)).map(c=>{const d=(c.inputs??[]).map(p=>p.link!=null&&s.has(p.link)?{...p,link:null}:p),h=(c.outputs??[]).map(p=>{const m=(p.links??[]).filter(y=>!s.has(y));return{...p,links:m.length>0?m:null}});return{...c,inputs:d,outputs:h}});return{...n,nodes:l,links:a}}function P2(n,o,s,a){if(!Array.isArray(n.widgets_values)){const c={...n.widgets_values||{}};return a?(c[a]=s,n.type==="VHS_VideoCombine"&&a==="save_image"&&"save_output"in c&&(c.save_output=s)):o>=0&&(c[String(o)]=s),{...n,widgets_values:c}}let l=[...n.widgets_values];return o>=l.length?l.push(s):l[o]=s,n.type==="Power Lora Loader (rgthree)"&&(l=l.filter(c=>c!==null)),{...n,widgets_values:l}}function Y2(n,o){if(!Array.isArray(n.widgets_values))return n;const s=[...n.widgets_values];for(const[a,l]of Object.entries(o)){const c=parseInt(a,10);s[c]=l}return{...n,widgets_values:s}}function fl(n,o){const s=ho(o)??{scope:"root",nodeId:o.id};if(s.scope==="root"){const c=n.nodes.map(d=>d.id===s.nodeId?{...d,widgets_values:o.widgets_values??[]}:d);return{...n,nodes:c}}const a=n.definitions?.subgraphs;if(!a)return n;const l=a.map(c=>{if(c.id!==s.subgraphId)return c;const d=c.nodes.map(h=>h.id===s.nodeId?{...h,widgets_values:o.widgets_values??[]}:h);return{...c,nodes:d}});return{...n,definitions:{...n.definitions,subgraphs:l}}}function Cf(n,o,s){const a=["fixed","randomize","increment","decrement"];if(Array.isArray(s.widgets_values)){const c=s.widgets_values.find(d=>typeof d=="string"&&a.includes(d.toLowerCase()));if(typeof c=="string"){const d=c.toLowerCase();if(a.includes(d))return d}}const l=da(n,o,s);if(l!==null&&Array.isArray(s.widgets_values)){const c=Number(s.widgets_values[l]),d=$b(c);if(d)return d;const p=(s.outputs??[]).some(v=>String(v.name||"").toLowerCase().includes("seed")&&String(v.type||"").toUpperCase().includes("INT")),m=s.widgets_values.slice(l+1),y=m.length>0&&m.every(v=>v===""||v===null||v===void 0),x=s.properties&&("randomMin"in s.properties||"randomMax"in s.properties);if(p&&y&&x)return"randomize"}return"fixed"}function Q2(n,o){const s={};for(const a of n.nodes){const l=o[a.type];if(!l?.input)continue;const c=l.input_order?.required||Object.keys(l.input.required||{}),d=l.input_order?.optional||Object.keys(l.input.optional||{}),h=[...c,...d];for(const p of h){const m=l.input.required?.[p]||l.input.optional?.[p];if(!m)continue;const[y]=m;if(!Array.isArray(y)||y.length===0||a.inputs.find(R=>R.name===p)?.link!=null)continue;const v=$n(n,o,a,p);if(v===null)continue;const C=pa(a,p,v);if(C==null)continue;const N=Al(C,y),w=jp(C,y,{comboIndexToValue:!0}),j=String(w),k=j.split(/[\\/]/).pop()??j;if(!(N!==void 0||y.some(R=>{const D=String(R);return D===j||D===k}))){const R=String(a.id);s[R]||(s[R]=[]),s[R].push({type:"workflow_load",message:`Missing value: ${j}`,details:"Not found on server.",inputName:p})}}}return s}function vy(n,o){let s=!1;const a=n.nodes.map(l=>{if(!Array.isArray(l.widgets_values))return l;const c=o[l.type];if(!c?.input)return l;const d=c.input_order?.required||Object.keys(c.input.required||{}),h=c.input_order?.optional||Object.keys(c.input.optional||{}),p=[...d,...h];let m=null;for(const y of p){const x=c.input.required?.[y]||c.input.optional?.[y];if(!x)continue;const[v]=x;if(!Array.isArray(v)||v.length===0||l.inputs.find(k=>k.name===y)?.link!=null)continue;const N=$n(n,o,l,y);if(N===null||N<0||N>=l.widgets_values.length)continue;const w=pa(l,y,N);if(w==null)continue;const j=Al(w,v);j===void 0||j===w||(m||(m=[...l.widgets_values]),m[N]=j,s=!0)}return m?{...l,widgets_values:m}:l});return s?{workflow:{...n,nodes:a},changed:!0}:{workflow:n,changed:!1}}const fe=bo()(Sr((n,o)=>{const s=se=>{const{hiddenItems:Z,workflow:T,stableKeyByPointer:ie}=o();if(!T){pn.getState().setNodeErrors(se);return}const ge=Object.keys(se).filter(B=>{const ne=Number(B);return Number.isFinite(ne)?gs(T,ie,ne).some(W=>!!Z[W]):!1});if(ge.length>0){const B={...Z};for(const ne of ge){const W=Number(ne);if(Number.isFinite(W))for(const P of gs(T,ie,W))delete B[P]}n({hiddenItems:B})}pn.getState().setNodeErrors(se)},a=(se,Z)=>{const{workflow:T,hiddenItems:ie,connectionHighlightModes:G,mobileLayout:ge,stableKeyByPointer:B,pointerByStableKey:ne}=o();if(!T)return;const W=Vn(T,se);if(!W)return;const{nodeId:P,subgraphId:z}=W;if(!T.nodes.some(_e=>{if(_e.id!==P)return!1;const Ze=ho(_e);return z==null?Ze?.scope!=="subgraph":Ze?.scope==="subgraph"&&Ze.subgraphId===z}))return;const $=new Set,ee=T.links.filter(_e=>{const Ze=_e[3]===P;return Ze&&$.add(_e[0]),Ze}),pe=T.links.filter(_e=>{const Ze=_e[1]===P;return Ze&&$.add(_e[0]),Ze});let ae=T.last_link_id;const ke=new Map,U=new Map,ce=[];if(Z)for(const _e of pe){const[,,,Ze,wt,pt]=_e,Lt=ee.find(mt=>ly(mt[5],pt));if(!Lt)continue;const[,_t,Vt]=Lt;ae+=1;const Pe=[ae,_t,Vt,Ze,wt,pt];ce.push(Pe);const Fe=`${Ze}:${wt}`;ke.set(Fe,Pe[0]);const Ke=`${_t}:${Vt}`,Je=U.get(Ke)??[];Je.push(Pe[0]),U.set(Ke,Je)}const He=[...T.links.filter(_e=>!$.has(_e[0])),...ce],Ve=T.nodes.filter(_e=>_e.id!==P).map(_e=>{const Ze=_e.inputs.map((pt,Lt)=>{const _t=`${_e.id}:${Lt}`,Vt=ke.get(_t);return Vt!=null?{...pt,link:Vt}:pt.link!=null&&$.has(pt.link)?{...pt,link:null}:pt}),wt=_e.outputs.map((pt,Lt)=>{const Vt=(pt.links??[]).filter(Je=>!$.has(Je)),Pe=`${_e.id}:${Lt}`,Fe=U.get(Pe)??[],Ke=[...Vt,...Fe];return{...pt,links:Ke.length>0?Ke:null}});return{..._e,inputs:Ze,outputs:wt}}),qe={...ie};for(const _e of gs(T,B,P,z))delete qe[_e];for(const _e of yl(T,P,z))delete qe[_e];const ot={...G};delete ot[P];const Ge=iy(ge,P),Xe=Ao(Ge,B,ne),Ie=Oo({...T,nodes:Ve,links:He,last_link_id:ae},Xe.layoutToStable);n({workflow:Ie,hiddenItems:qe,connectionHighlightModes:ot,mobileLayout:Ge,stableKeyByPointer:Xe.layoutToStable,pointerByStableKey:Xe.stableToLayout})},l=(se,Z,T,ie,G)=>{const{workflow:ge,pointerByStableKey:B}=o();if(!ge)return;const ne=Vn(ge,se),W=Vn(ge,T);if(!ne||!W)return;const P=ne.nodeId,z=W.nodeId,$=ge.nodes.find(Ve=>Ve.id===P),ee=ge.nodes.find(Ve=>Ve.id===z);if(!$||!ee)return;let pe=[...ge.links],ae=ge.last_link_id;const ke=ee.inputs[ie]?.link;ke!=null&&(pe=pe.filter(Ve=>Ve[0]!==ke)),ae++;const U=ae,ce=[U,P,Z,z,ie,G];pe.push(ce);const He=ge.nodes.map(Ve=>{if(Ve.id===z){const qe=[...Ve.inputs];return qe[ie]={...qe[ie],link:U},{...Ve,inputs:qe}}if(Ve.id===P){const qe=[...Ve.outputs],Xe=[...(qe[Z]?.links??[]).filter(Ie=>Ie!==ke),U];return qe[Z]={...qe[Z],links:Xe},{...Ve,outputs:qe}}if(ke!=null&&Ve.id!==P&&Ve.outputs.some(ot=>ot.links?.includes(ke))){const ot=Ve.outputs.map(Ge=>{if(Ge.links?.includes(ke)){const Xe=Ge.links.filter(Ie=>Ie!==ke);return{...Ge,links:Xe.length>0?Xe:null}}return Ge});return{...Ve,outputs:ot}}return Ve});n({workflow:{...ge,nodes:He,links:pe,last_link_id:ae}})},c=(se,Z)=>{const{workflow:T,pointerByStableKey:ie}=o();if(!T)return;const G=Vn(T,se);if(!G)return;const ge=G.nodeId,B=T.nodes.find(z=>z.id===ge);if(!B)return;const ne=B.inputs[Z]?.link;if(ne==null)return;const W=T.links.filter(z=>z[0]!==ne),P=T.nodes.map(z=>{if(z.id===ge){const ee=[...z.inputs];return ee[Z]={...ee[Z],link:null},{...z,inputs:ee}}if(z.outputs.some(ee=>ee.links?.includes(ne))){const ee=z.outputs.map(pe=>{if(pe.links?.includes(ne)){const ae=pe.links.filter(ke=>ke!==ne);return{...pe,links:ae.length>0?ae:null}}return pe});return{...z,outputs:ee}}return z});n({workflow:{...T,nodes:P,links:W}})},d=(se,Z)=>{const{workflow:T,nodeTypes:ie,mobileLayout:G}=o();if(!T||!ie)return null;const ge=ie[se];if(!ge)return null;const B=T.last_node_id+1,ne=[],W=ge.input?.required??{},P=ge.input?.optional??{},z=ge.input_order?.required??Object.keys(W),$=ge.input_order?.optional??Object.keys(P);for(const Ge of z){const Xe=W[Ge];if(!Xe)continue;const[Ie]=Xe;if(Array.isArray(Ie))continue;const _e=String(Ie).toUpperCase();["INT","FLOAT","BOOLEAN","STRING"].includes(_e)||ne.push({name:Ge,type:String(Ie),link:null})}for(const Ge of $){const Xe=P[Ge];if(!Xe)continue;const[Ie]=Xe;if(Array.isArray(Ie))continue;const _e=String(Ie).toUpperCase();["INT","FLOAT","BOOLEAN","STRING"].includes(_e)||ne.push({name:Ge,type:String(Ie),link:null})}const ee=(ge.output??[]).map((Ge,Xe)=>({name:ge.output_name?.[Xe]??Ge,type:Ge,links:null,slot_index:Xe})),pe=[];for(const Ge of z){const Xe=W[Ge];if(!Xe)continue;const[Ie,_e]=Xe;if(Array.isArray(Ie)){pe.push(Ie[0]??"");continue}const Ze=String(Ie).toUpperCase();Ze==="INT"||Ze==="FLOAT"?pe.push(_e?.default??0):Ze==="STRING"?pe.push(_e?.default??""):Ze==="BOOLEAN"&&pe.push(_e?.default??!1)}for(const Ge of $){const Xe=P[Ge];if(!Xe)continue;const[Ie,_e]=Xe;if(Array.isArray(Ie)){pe.push(Ie[0]??"");continue}const Ze=String(Ie).toUpperCase();Ze==="INT"||Ze==="FLOAT"?pe.push(_e?.default??0):Ze==="STRING"?pe.push(_e?.default??""):Ze==="BOOLEAN"&&pe.push(_e?.default??!1)}let ae=[0,0];if(Z?.nearNodeStableKey){const Ge=Vn(T,Z.nearNodeStableKey,o().pointerByStableKey);Ge&&(ae=L2(T,Ge.nodeId)??ae)}else if(Z?.inSubgraphId){const Ge=T.nodes.filter(Xe=>{const Ie=ho(Xe);return Ie?.scope==="subgraph"&&Ie.subgraphId===Z.inSubgraphId});if(Ge.length>0){const Xe=Math.max(...Ge.map(_e=>_e.pos[1]+(_e.size?.[1]??100)));ae=[Math.min(...Ge.map(_e=>_e.pos[0])),Xe+80]}else ae=uy(T)}else ae=uy(T);if(Z?.inGroupId!=null){const Xe=[...T.groups??[],...(T.definitions?.subgraphs??[]).flatMap(Ie=>Ie.groups??[])].find(Ie=>Ie.id===Z.inGroupId);Xe&&(ae=_2(ae,Xe,[200,100]))}const ke={};Z?.inSubgraphId&&(ke[Zf]={scope:"subgraph",subgraphId:Z.inSubgraphId,nodeId:B});const U={id:B,type:se,pos:ae,size:[200,100],flags:{},order:0,mode:0,inputs:ne,outputs:ee,properties:ke,widgets_values:pe},ce=O2(G,B,{groupId:Z?.inGroupId??void 0,subgraphId:Z?.inSubgraphId??void 0}),{stableKeyByPointer:He,pointerByStableKey:Ve}=o(),qe=Ao(ce,He,Ve),ot=Oo({...T,nodes:[...T.nodes,U],last_node_id:B},qe.layoutToStable);return n({workflow:ot,mobileLayout:ce,stableKeyByPointer:qe.layoutToStable,pointerByStableKey:qe.stableToLayout}),B},h=(se,Z,T)=>{const{workflow:ie,nodeTypes:G,pointerByStableKey:ge}=o();if(!ie||!G)return null;const B=Vn(ie,Z);if(!B)return null;const ne=B.nodeId,W=ie.nodes.find(U=>U.id===ne);if(!W)return null;const P=W.inputs[T];if(!P)return null;const z=G[se];if(!z)return null;const $=P.type.toUpperCase(),ee=(z.output??[]).findIndex(U=>ly(String(U),$));if(ee<0)return null;const pe=o().addNode(se,{nearNodeStableKey:Z});if(pe===null)return null;const ae=hn({type:"node",nodeId:pe,subgraphId:B.subgraphId}),ke=o().stableKeyByPointer[ae];return ke?(o().connectNodes(ke,ee,Z,T,P.type),pe):null},p=(se,Z)=>{n(T=>({...(()=>{const ie=T.workflow?Vn(T.workflow,se,T.pointerByStableKey):null;if(!ie)return{};const G=String(ie.nodeId);return{nodeOutputs:{...T.nodeOutputs,[G]:Z}}})()}))},m=(se,Z)=>{n(T=>({...(()=>{const ie=T.workflow?Vn(T.workflow,se,T.pointerByStableKey):null;if(!ie)return{};const G=String(ie.nodeId);return{nodeTextOutputs:{...T.nodeTextOutputs,[G]:Z}}})()}))},y=se=>{n(Z=>{const T=Z.workflow?Vn(Z.workflow,se,Z.pointerByStableKey):null;if(!T)return{};const ie=T.nodeId,G=Z.connectionHighlightModes[ie]??"off",ge=G==="off"?"inputs":G==="inputs"?"outputs":G==="outputs"?"both":"off";return{connectionHighlightModes:{...Z.connectionHighlightModes,[ie]:ge}}})},x=(se,Z)=>{n(T=>({...(()=>{const ie=T.workflow?Vn(T.workflow,se,T.pointerByStableKey):null;return ie?{connectionHighlightModes:{...T.connectionHighlightModes,[ie.nodeId]:Z}}:{}})()}))},v=(se,Z)=>{se&&n(T=>{const ie={...T.hiddenItems};return Z?ie[se]=!0:delete ie[se],{hiddenItems:ie}})},C=se=>{const{workflow:Z,pointerByStableKey:T}=o();if(!Z)return;const ie=Vn(Z,se);if(!ie)return;const G=Z.definitions?.subgraphs??[],ge=ie.subgraphId??null,B=Z.nodes.find(ke=>{if(ke.id!==ie.nodeId)return!1;const U=ho(ke);return ge===null?U?.scope!=="subgraph":U?.scope==="subgraph"&&U.subgraphId===ge});if(!B)return;const ne=new Map(G.map(ke=>[ke.id,ke])),W=W2(G),P=ho(B),z=Z.nodes.filter(ke=>ho(ke)?.scope!=="subgraph"),$=P?.scope==="subgraph"?P.nodeId:B.id,pe=(()=>{const ke=new Set,U=[$];if(P?.scope==="subgraph"){const ce=ne.get(P.subgraphId),He=new Map;for(ce?.links?.forEach(Ve=>{const qe=He.get(Ve.target_id)??[];qe.push(Ve.origin_id),He.set(Ve.target_id,qe)});U.length>0;){const Ve=U.pop();if(Ve===void 0)continue;(He.get(Ve)??[]).forEach(ot=>{ke.has(ot)||(ke.add(ot),U.push(ot))})}return ke}for(;U.length>0;){const ce=U.pop();if(ce===void 0)continue;const He=Z.nodes.find(Ve=>Ve.id===ce);He&&He.inputs?.forEach((Ve,qe)=>{if(Ve.link===null)return;const ot=ha(Z,ce,qe);if(!ot)return;const Ge=ot.node.id;ke.has(Ge)||(ke.add(Ge),U.push(Ge))})}return ke})(),ae=P?.scope==="subgraph"?P.subgraphId:null;n(ke=>{const U={...ke.hiddenItems};for(const qe of gs(Z,ke.stableKeyByPointer,ie.nodeId,ge))delete U[qe];pe.forEach(qe=>{for(const ot of gs(Z,ke.stableKeyByPointer,qe,ae))delete U[ot]});const ce={...ke.collapsedItems},He=(qe,ot=null)=>{if(qe!=null)for(const Ge of su(ke.mobileLayout,qe,ot))delete U[Ge],delete ce[Ge]},Ve=qe=>{if(!qe)return;const ot=lu(Z,qe);ot&&(delete ce[ot],delete U[ot])};if(!P||P.scope==="root"){const qe=dl(B.id,z,Z.groups??[]);He(qe,null),pe.forEach(ot=>{const Ge=dl(ot,z,Z.groups??[]);He(Ge,null)})}else{Ve(P.subgraphId);const qe=ne.get(P.subgraphId);if(qe){const _e=dl(P.nodeId,qe.nodes??[],qe.groups??[]);He(_e,P.subgraphId)}const ot=Z.extra?.[Pr],Ge=ot&&typeof ot=="object"?ot[P.subgraphId]:void 0;typeof Ge=="number"&&He(Ge,null),qe&&pe.forEach(_e=>{const Ze=dl(_e,qe.nodes??[],qe.groups??[]);He(Ze,P.subgraphId)});const Xe=[P.subgraphId],Ie=new Set;for(;Xe.length>0;){const _e=Xe.pop();if(!_e||Ie.has(_e))continue;Ie.add(_e);const Ze=W.get(_e)??[];for(const wt of Ze){Ve(wt.parentId);const pt=ne.get(wt.parentId);if(pt){const Lt=dl(wt.nodeId,pt.nodes??[],pt.groups??[]);He(Lt,wt.parentId)}Ie.has(wt.parentId)||Xe.push(wt.parentId)}}}return{hiddenItems:U,collapsedItems:ce}})},N=(se,Z,T,ie)=>{const{workflow:G,embedWorkflow:ge,pointerByStableKey:B}=o();if(!G)return;const ne=Vn(G,se);if(!ne)return;const W=ne.nodeId,P=G.nodes.map(ee=>ee.id===W?P2(ee,Z,T,ie):ee),z=P.find(ee=>ee.id===W),$=ge&&z?fl(ge,z):ge;n({workflow:{...G,nodes:P},embedWorkflow:$}),pn.getState().clearNodeError(W)},w=(se,Z)=>{const{workflow:T,embedWorkflow:ie,pointerByStableKey:G}=o();if(!T)return;const ge=Vn(T,se);if(!ge)return;const B=ge.nodeId,ne=T.nodes.map(z=>z.id===B?Y2(z,Z):z),W=ne.find(z=>z.id===B),P=ie&&W?fl(ie,W):ie;n({workflow:{...T,nodes:ne},embedWorkflow:P}),pn.getState().clearNodeError(B)},j=(se,Z)=>{const{workflow:T,pointerByStableKey:ie}=o();if(!T)return;const G=Vn(T,se);if(!G)return;const ge=G.nodeId,B=Z?.trim()??"",ne=T.nodes.map(W=>{if(W.id!==ge)return W;const P={...W.properties??{}},z={...W,properties:P};return B?(z.title=B,P.title=B):(delete z.title,delete P.title),z});n({workflow:{...T,nodes:ne}})},k=se=>{const{workflow:Z,pointerByStableKey:T}=o();if(!Z)return;const ie=Vn(Z,se);if(!ie)return;const G=ie.nodeId,ge=Z.nodes.map(B=>{if(B.id===G){const W=(B.mode||0)===4?0:4;return{...B,mode:W}}return B});n({workflow:{...Z,nodes:ge}})},O=(se,Z)=>{const{hiddenItems:T,workflow:ie,pointerByStableKey:G}=o();if(!ie)return;const ge=Vn(ie,se);if(!ge)return;const B=ge.nodeId;if(T[se]&&o().setItemHidden(se,!1),document.body.dataset.textareaFocus==="true")return;o().setItemCollapsed(se,!1);const W=(P,z)=>{const $=document.getElementById(`node-anchor-${B}`)??document.getElementById(`node-${B}`),ee=document.getElementById(`node-card-${B}`)??document.getElementById(`node-${B}`);if(!$||!ee){P>0?requestAnimationFrame(()=>W(P-1,z)):z>0&&setTimeout(()=>W(10,z-1),200);return}const pe=$.closest('[data-node-list="true"]');if(pe){const Ve=$.getBoundingClientRect(),qe=pe.getBoundingClientRect(),ot=Ve.top-qe.top,Ge=Math.max(0,pe.scrollTop+ot);pe.scrollTo({top:Ge,behavior:"smooth"})}else $.scrollIntoView({behavior:"smooth",block:"start"});const ae=pe||window;let ke=null;const U=()=>{document.querySelectorAll(".highlight-pulse").forEach(Ve=>Ve.classList.remove("highlight-pulse")),ee.classList.add("highlight-pulse"),setTimeout(()=>ee.classList.remove("highlight-pulse"),1200),"vibrate"in navigator&&navigator.vibrate(10),Z&&window.dispatchEvent(new CustomEvent("node-show-label",{detail:{nodeId:B,label:Z}}))},ce=()=>{ke&&clearTimeout(ke),ke=setTimeout(()=>{He(),U()},120)},He=()=>{ke&&(clearTimeout(ke),ke=null),ae.removeEventListener("scroll",ce)};ae.addEventListener("scroll",ce,{passive:!0}),ke=setTimeout(()=>{He(),U()},200)};W(10,2)},R=(se,Z,T,ie)=>{n(G=>{const ge=Date.now(),B=se&&Z&&G.workflow?(()=>{const pe=Vn(G.workflow,Z,G.pointerByStableKey);return pe?String(pe.nodeId):null})():null,ne=se?T??G.executingPromptId:null,W=se?B??G.executingNodeId:null,P={isExecuting:se,executingNodeId:W,executingPromptId:ne,progress:ie},z=(pe,ae)=>{if(!pe||ae<=0||G.workflow?.nodes.find(qe=>String(qe.id)===pe)?.mode===4)return G.nodeDurationStats;const U=String(pe),ce=G.nodeDurationStats[U],He=(ce?.count??0)+1,Ve=ce?(ce.avgMs*ce.count+ae)/He:ae;return{...G.nodeDurationStats,[U]:{avgMs:Ve,count:He}}};if(!se){if(G.currentNodeStartTime&&G.executingNodeId){const pe=ge-G.currentNodeStartTime;P.nodeDurationStats=z(G.executingNodeId,pe)}if(G.executionStartTime&&G.workflow){const pe=ge-G.executionStartTime,ae=Hu(G.workflow),ke=G.workflowDurationStats[ae],U=(ke?.count??0)+1,ce=ke?(ke.avgMs*ke.count+pe)/U:pe;P.workflowDurationStats={...G.workflowDurationStats,[ae]:{avgMs:ce,count:U}}}return P.executionStartTime=null,P.currentNodeStartTime=null,P}const $=ne&&ne!==G.executingPromptId,ee=W&&W!==G.executingNodeId;if($&&(P.executionStartTime=ge,P.currentNodeStartTime=ge),ee&&G.currentNodeStartTime&&G.executingNodeId){const pe=ge-G.currentNodeStartTime;P.nodeDurationStats=z(G.executingNodeId,pe),P.currentNodeStartTime=ge}else G.currentNodeStartTime||(P.currentNodeStartTime=ge);return P})},D=se=>{n(Z=>{const T=fy(se),ie=Ao(T,Z.stableKeyByPointer,Z.pointerByStableKey);return{workflow:Z.workflow?Oo(Z.workflow,ie.layoutToStable):Z.workflow,mobileLayout:T,stableKeyByPointer:ie.layoutToStable,pointerByStableKey:ie.stableToLayout}})},I=(se,Z,T)=>{const{currentFilename:ie,savedWorkflowStates:G,nodeTypes:ge}=o(),B=T?.fresh??!1,ne=T?.source??{type:"other"};pn.getState().clearNodeErrors();const W=m2(se),P=py(se),z=Jf(W.nodes),$={...W,nodes:z,links:W.links??[],groups:W.groups??[],config:W.config??{},last_node_id:W.last_node_id??Math.max(0,...z.map(He=>He.id)),last_link_id:W.last_link_id??0,version:W.version??.4},ee=xf($,ge),pe=go.getState(),ae=Z?pe.pinnedWidgets[Z]:void 0;if(ae&&!pe.pinnedWidgets[ee]&&pe.setPinnedWidget(ae,ee),pe.restorePinnedWidgetForWorkflow(ee,$),ie&&o().saveCurrentWorkflowState(),B&&G[ee]){const He={...G};delete He[ee],n({savedWorkflowStates:He})}const ke={};if(ge)for(const He of $.nodes)da($,ge,He)!==null&&(ke[He.id]=Cf($,ge,He));let U=B?null:G[ee];!U&&!B&&Z&&G[Z]&&(U=G[Z],n({savedWorkflowStates:{...G,[ee]:G[Z]}}));let ce=$;if(U){const He=$.nodes.map(Ke=>{const Je=U.nodes[Ke.id];return Je?{...Ke,mode:Je.mode??Ke.mode,flags:Je.flags??Ke.flags,widgets_values:Je.widgets_values??Ke.widgets_values}:Ke}),Ve={...$,nodes:He};ce=(ge?vy(Ve,ge):{workflow:Ve}).workflow;const ot=wf(ce,o().hiddenItems),Ge={...U.collapsedItems??{}},Xe={...U.hiddenItems??{}},Ie=hs(ce,ot),_e=Ao(Ie,o().stableKeyByPointer,o().pointerByStableKey),Ze=Sf(ot,_e.layoutToStable),wt=K2(Ge,_e.layoutToStable),pt=Sf(Xe,_e.layoutToStable),Lt=Nf({...Ge,...wt},_e.layoutToStable,_e.stableToLayout),_t=iu({...Xe,...pt},_e.layoutToStable,_e.stableToLayout),Vt={},Pe=Oo(ce,_e.layoutToStable);ce=Pe;let Fe=P;if(Fe)for(const Ke of Pe.nodes)Fe=fl(Fe,Ke);n({workflowSource:ne,workflow:Pe,embedWorkflow:Fe,originalWorkflow:JSON.parse(JSON.stringify(Pe)),currentFilename:Z||null,currentWorkflowKey:ee,collapsedItems:{...Vt,...Lt},hiddenItems:{..._t,...Ze},mobileLayout:Ie,stableKeyByPointer:_e.layoutToStable,pointerByStableKey:_e.stableToLayout,runCount:1,followQueue:!1,workflowLoadedAt:Date.now()}),Gn.getState().setSeedModes({...ke,...U.seedModes}),Gn.getState().setSeedLastValues({}),oo.getState().setCurrentPanel("workflow"),To.getState().setViewerState({viewerOpen:!1,viewerImages:[],viewerIndex:0,viewerScale:1,viewerTranslate:{x:0,y:0}})}else{const He=o(),Ve=He.currentWorkflowKey===ee,qe=wf($,o().hiddenItems),ot=hs($,qe),Ge=Ao(ot,o().stableKeyByPointer,o().pointerByStableKey),Xe=Sf(qe,Ge.layoutToStable),Ie={},_e=Ve?Nf(He.collapsedItems,Ge.layoutToStable,Ge.stableToLayout):{};pn.getState().setError(null),ce=(ge?vy($,ge):{workflow:$}).workflow;const wt=Oo(ce,Ge.layoutToStable);let pt=P;if(pt)for(const Lt of wt.nodes)pt=fl(pt,Lt);n({workflowSource:ne,workflow:wt,embedWorkflow:pt,originalWorkflow:JSON.parse(JSON.stringify(wt)),currentFilename:Z||null,currentWorkflowKey:ee,collapsedItems:{...Ie,..._e},mobileLayout:ot,stableKeyByPointer:Ge.layoutToStable,pointerByStableKey:Ge.stableToLayout,hiddenItems:Xe,runCount:1,followQueue:!1,workflowLoadedAt:Date.now()}),Gn.getState().setSeedModes(ke),Gn.getState().setSeedLastValues({}),oo.getState().setCurrentPanel("workflow"),To.getState().setViewerState({viewerOpen:!1,viewerImages:[],viewerIndex:0,viewerScale:1,viewerTranslate:{x:0,y:0}})}if(ge){const He=Q2(ce,ge),Ve=Object.values(He).reduce((qe,ot)=>qe+ot.length,0);Ve>0?(s(He),pn.getState().setError(`Workflow load error: ${Ve} input${Ve===1?"":"s"} reference missing options.`)):pn.getState().clearNodeErrors()}},H=()=>{const{currentWorkflowKey:se,savedWorkflowStates:Z}=o();if(se){const T={...Z};delete T[se],n({savedWorkflowStates:T})}pn.getState().clearNodeErrors(),n({workflowSource:null,workflow:null,embedWorkflow:null,originalWorkflow:null,currentFilename:null,currentWorkflowKey:null,collapsedItems:{},hiddenItems:{},mobileLayout:Nu(),stableKeyByPointer:{},pointerByStableKey:{},runCount:1,nodeOutputs:{},nodeTextOutputs:{},promptOutputs:{},followQueue:!1,workflowLoadedAt:Date.now(),connectionHighlightModes:{}}),Gn.getState().clearSeedState(),go.getState().clearCurrentPin(),oo.getState().setCurrentPanel("workflow"),To.getState().setViewerState({viewerOpen:!1,viewerImages:[],viewerIndex:0,viewerScale:1,viewerTranslate:{x:0,y:0}})},A=(se,Z)=>{pn.getState().setError(null);const T=xf(se,o().nodeTypes),ie=hs(se,uu(o().hiddenItems,o().pointerByStableKey)),G=Ao(ie,o().stableKeyByPointer,o().pointerByStableKey),ge=Oo(se,G.layoutToStable);n({workflow:ge,embedWorkflow:py(ge),originalWorkflow:JSON.parse(JSON.stringify(ge)),currentFilename:Z,currentWorkflowKey:T,mobileLayout:ie,stableKeyByPointer:G.layoutToStable,pointerByStableKey:G.stableToLayout})},V=se=>{n({nodeTypes:se});const{workflow:Z,currentWorkflowKey:T,currentFilename:ie,savedWorkflowStates:G}=o();if(!Z)return;const ge=xf(Z,se);if(T===ge)return;const B={...G};T&&B[T]&&!B[ge]?(B[ge]=B[T],delete B[T]):!T&&ie&&B[ie]&&!B[ge]&&(B[ge]=B[ie]);const ne=go.getState(),W=ie?ne.pinnedWidgets[ie]:void 0,P=T?ne.pinnedWidgets[T]:void 0;W&&!ne.pinnedWidgets[ge]?ne.setPinnedWidget(W,ge):P&&!ne.pinnedWidgets[ge]&&ne.setPinnedWidget(P,ge),n({currentWorkflowKey:ge,savedWorkflowStates:B}),ne.restorePinnedWidgetForWorkflow(ge,Z)},J=()=>{const{workflow:se,currentWorkflowKey:Z,savedWorkflowStates:T,collapsedItems:ie,hiddenItems:G}=o(),ge=Gn.getState().seedModes;if(!se||!Z)return;const B=T[Z]?.bookmarkedItems??[],ne={};for(const W of se.nodes)ne[W.id]={mode:W.mode,flags:W.flags?{collapsed:!!W.flags.collapsed}:void 0,widgets_values:W.widgets_values};n({savedWorkflowStates:{...T,[Z]:{nodes:ne,seedModes:{...ge},collapsedItems:{...ie},hiddenItems:{...G},bookmarkedItems:[...B]}}})},X=()=>{n({nodeOutputs:{},nodeTextOutputs:{}})},re=(se,Z)=>{!se||Z.length===0||n(T=>({promptOutputs:{...T.promptOutputs,[se]:[...T.promptOutputs[se]??[],...Z]}}))},te=se=>{if(!se){n({promptOutputs:{}});return}n(Z=>{if(!Z.promptOutputs[se])return Z;const T={...Z.promptOutputs};return delete T[se],{promptOutputs:T}})},me=se=>{n({runCount:Math.max(1,Math.floor(se))})},Te=se=>{n({followQueue:se})},F=()=>{n(se=>({connectionButtonsVisible:!se.connectionButtonsVisible}))},_=()=>{n({hiddenItems:{}})},q=(se,Z)=>{n(T=>{const ie={...T.collapsedItems};return Z?ie[se]=!0:delete ie[se],{collapsedItems:ie}})},de=(se,Z)=>{const{workflow:T,pointerByStableKey:ie}=o();if(!T)return;const G=au(T,se);if(!G)return;if(G.type==="group"){const W=ep(T,G.groupId,G.subgraphId);if(W.size===0)return;const P=Z?4:0,z=(T.nodes??[]).map($=>W.has($.id)?{...$,mode:P}:$);n({workflow:{...T,nodes:z}});return}if(G.type!=="subgraph")return;const ge=by(T,G.subgraphId);if(ge.size===0)return;const B=Z?4:0,ne=(T.nodes??[]).map(W=>ge.has(W.id)?{...W,mode:B}:W);n({workflow:{...T,nodes:ne}})},Me=(se,Z)=>{const{workflow:T,stableKeyByPointer:ie,pointerByStableKey:G}=o();if(!T)return;const ge=au(T,se);if(!ge)return;if(ge.type==="group"){const{hiddenItems:Fe,connectionHighlightModes:Ke,mobileLayout:Je,collapsedItems:mt}=o(),Et=ge.groupId,be=ge.subgraphId??null,ye=su(Je,Et,be),De=new Set(ye);De.add(ge.stableKey);const Ye=De.size>0?[...De]:[ge.stableKey],rt=Z?.deleteNodes??!1?ep(T,Et,be):new Set;let Be=T;if(be){const ut=(T.definitions?.subgraphs??[]).map(At=>At.id!==be?At:{...At,groups:(At.groups??[]).filter(tn=>tn.id!==Et)});Be={...T,definitions:{...T.definitions??{},subgraphs:ut}}}else{let Nt=T.extra;const ut=T.extra?.[Pr];if(ut&&typeof ut=="object"){let At=!1;const tn={};for(const[kn,nn]of Object.entries(ut))nn===Et?(tn[kn]=null,At=!0):tn[kn]=nn;At&&(Nt={...T.extra??{},[Pr]:tn})}Be={...T,groups:(T.groups??[]).filter(At=>At.id!==Et),extra:Nt}}rt.size>0&&(Be=xy(Be,rt));const ct={...Fe},St={...Ke};for(const Nt of rt){for(const ut of gs(T,ie,Nt))delete ct[ut];for(const ut of yl(T,Nt))delete ct[ut];delete St[Nt]}let bt=Je;for(const Nt of rt)bt=iy(bt,Nt);for(const Nt of Ye)bt=T2(bt,Nt);const lt={...mt};for(const Nt of Ye)delete lt[Nt],delete ct[Nt];const ht=Ao(bt,ie,G),Ct=Oo(Be,ht.layoutToStable);n({workflow:Ct,hiddenItems:ct,connectionHighlightModes:St,mobileLayout:bt,stableKeyByPointer:ht.layoutToStable,pointerByStableKey:ht.stableToLayout,collapsedItems:lt});return}if(ge.type!=="subgraph")return;const{hiddenItems:B,connectionHighlightModes:ne,mobileLayout:W,collapsedItems:P}=o(),z=Z?.deleteNodes??!1,$=ge.subgraphId,ee=T.definitions?.subgraphs??[],pe=ee.find(Fe=>Fe.id===$);if(!pe)return;const ke=qb(W,{type:"subgraph",id:$}),U=ke?q2(ke.containerId,W):null;if(z){const Fe=Yb(T),Ke=zu([$],Fe),Je=by(T,$),mt={...B},Et={...ne};for(const lt of Je){for(const ht of gs(T,ie,lt))delete mt[ht];for(const ht of yl(T,lt))delete mt[ht];delete Et[lt]}const be=ee.filter(lt=>!Ke.has(lt.id));let ye=T.extra;const De=T.extra?.[Pr];if(De&&typeof De=="object"){const lt={};for(const[ht,Ct]of Object.entries(De))Ke.has(ht)||(lt[ht]=Ct);ye={...T.extra??{},[Pr]:lt}}let Ye=xy(T,Je);Ye={...Ye,definitions:{...Ye.definitions??{},subgraphs:be},extra:ye};const et=hs(Ye,uu(mt,G)),rt=Ao(et,ie,G),Be=Oo(Ye,rt.layoutToStable),ct={...P},St={...mt},bt=new Set(ee.filter(lt=>Ke.has(lt.id)).map(lt=>lt.stableKey).filter(lt=>typeof lt=="string"));for(const lt of bt)delete ct[lt],delete St[lt];n({workflow:Be,hiddenItems:St,connectionHighlightModes:Et,mobileLayout:et,stableKeyByPointer:rt.layoutToStable,pointerByStableKey:rt.stableToLayout,collapsedItems:ct});return}const ce=U==null?T.groups??[]:ee.find(Fe=>Fe.id===U)?.groups??[],{idMap:He,promotedGroups:Ve}=G2(pe.groups??[],ce),qe=(T.nodes??[]).map(Fe=>{const Ke=ho(Fe);if(Ke?.scope!=="subgraph"||Ke.subgraphId!==$)return Fe;const Je={...Fe.properties??{}};return Je[Zf]=U==null?{scope:"root",nodeId:Ke.nodeId}:{scope:"subgraph",subgraphId:U,nodeId:Ke.nodeId},{...Fe,properties:Je}}),ot=ee.filter(Fe=>Fe.id!==$).map(Fe=>U!=null&&Fe.id===U?{...Fe,groups:[...Fe.groups??[],...Ve]}:Fe);let Ge=T.groups??[];U==null&&Ve.length>0&&(Ge=[...Ge,...Ve]);let Xe=T.extra;const Ie=T.extra?.[Pr];if(Ie&&typeof Ie=="object"){const Fe={};for(const[Ke,Je]of Object.entries(Ie))Ke!==$&&(Fe[Ke]=Je);Xe={...T.extra??{},[Pr]:Fe}}const _e={...T,nodes:qe,groups:Ge,definitions:{...T.definitions??{},subgraphs:ot},extra:Xe},Ze=hs(_e,uu(B,G)),wt=Ao(Ze,ie,G),pt={...P},Lt={...B},_t=pe.stableKey??lu(T,$);_t&&(delete pt[_t],delete Lt[_t]);const Vt=Fe=>{const Ke={};for(const[Je,mt]of Object.entries(Fe)){if(!mt)continue;const Et=au(T,Je);if(Et?.type==="group"&&Et.subgraphId===$){const be=He.get(Et.groupId);if(be==null)continue;const ye=su(Ze,be,U);for(const De of ye)Ke[De]=!0;continue}Ke[Je]=!0}return Ke},Pe=Oo(_e,wt.layoutToStable);n(()=>({workflow:Pe,mobileLayout:Ze,stableKeyByPointer:wt.layoutToStable,pointerByStableKey:wt.stableToLayout,collapsedItems:Vt(pt),hiddenItems:Lt}))},Ne=(se,Z)=>{const{workflow:T,pointerByStableKey:ie}=o();if(!T)return;const G=au(T,se);if(!G)return;const ge=Z.trim();if(G.type==="group"){const{groupId:B,subgraphId:ne}=G;if(ne){const z=(T.definitions?.subgraphs??[]).map($=>{if($.id!==ne)return $;const pe=($.groups??[]).map(ae=>ae.id===B?{...ae,title:ge}:ae);return{...$,groups:pe}});pn.getState().setError(null),n({workflow:{...T,definitions:{...T.definitions??{},subgraphs:z}}});return}const W=(T.groups??[]).map(P=>P.id===B?{...P,title:ge}:P);n({workflow:{...T,groups:W}});return}if(G.type==="subgraph"){const B=G.subgraphId,W=(T.definitions?.subgraphs??[]).map(P=>P.id===B?{...P,name:ge}:P);n({workflow:{...T,definitions:{...T.definitions??{},subgraphs:W}}})}},M=se=>{n({searchQuery:se})},L=se=>{n({searchOpen:se})},K=se=>{n({addNodeModalRequest:{id:++A2,groupId:se?.groupId??null,subgraphId:se?.subgraphId??null}})},je=()=>{n({addNodeModalRequest:null})},We=se=>{n(Z=>{const T=F2(Z.mobileLayout,se);if(!T)return{};const ie={...Z.collapsedItems};for(const G of T.groupKeys)delete ie[G];for(const G of T.subgraphIds){const ge=Z.workflow?lu(Z.workflow,G):null;ge&&delete ie[ge]}if(se.type==="group")for(const G of su(Z.mobileLayout,se.id,se.subgraphId??null))ie[G]=!0;else if(se.type==="subgraph"){const G=Z.workflow?lu(Z.workflow,se.id):null;G&&(ie[G]=!0)}return{collapsedItems:ie}})},Re=(se,Z)=>{!se||Z<=0||n(T=>{const ie=T.workflowDurationStats[se],G=(ie?.count??0)+1,ge=ie?(ie.avgMs*ie.count+Z)/G:Z;return{workflowDurationStats:{...T.workflowDurationStats,[se]:{avgMs:ge,count:G}}}})},Se=()=>{const{currentWorkflowKey:se,savedWorkflowStates:Z,originalWorkflow:T,nodeTypes:ie}=o(),G={...Z};if(se?(delete G[se],go.getState().clearPinnedWidgetForKey(se)):go.getState().clearCurrentPin(),!T){Gn.getState().setSeedModes({}),Gn.getState().setSeedLastValues({}),n({savedWorkflowStates:G});return}const ge={};if(ie)for(const ne of T.nodes)da(T,ie,ne)!==null&&(ge[ne.id]=Cf(T,ie,ne));const B=JSON.parse(JSON.stringify(T));Gn.getState().setSeedModes(ge),Gn.getState().setSeedLastValues({}),pn.getState().setError(null),n({savedWorkflowStates:G,...(()=>{const ne=hs(B,uu(o().hiddenItems,o().pointerByStableKey)),W=Ao(ne,{},{});return{workflow:Oo(B,W.layoutToStable),mobileLayout:ne,stableKeyByPointer:W.layoutToStable,pointerByStableKey:W.stableToLayout}})(),runCount:1,workflowLoadedAt:Date.now()})},Ee=()=>{const{workflow:se}=o();if(!se)return;let Z=!1;const T=se.nodes.map(ie=>{if(ie.type==="PrimitiveNode"){if(!Array.isArray(ie.widgets_values))return ie;const G=ie.outputs?.[0]?.type,ge=String(G).toUpperCase();if(ge!=="INT"&&ge!=="FLOAT")return ie;const B=ie.widgets_values?.[1];if(!B||B==="fixed")return ie;const ne=ie.widgets_values?.[0];if(typeof ne!="number")return ie;let W=ne;if(B==="increment"?W=ge==="INT"?ne+1:ne+.01:B==="decrement"?W=ge==="INT"?ne-1:ne-.01:B==="randomize"&&(W=ge==="INT"?Math.floor(Math.random()*0xffffffffffff):Math.random()),W!==ne){Z=!0;const P=[...ie.widgets_values];return P[0]=W,{...ie,widgets_values:P}}}return ie});Z&&n({workflow:{...se,nodes:T}})},xe=async se=>{const Z=Gn.getState(),T=Z.seedModes,ie=Z.seedLastValues,{workflow:G,nodeTypes:ge,embedWorkflow:B}=o();if(!G||!ge){pn.getState().setError("Node types are still loading. Try again in a moment.");return}pn.getState().setError(null),n({isLoading:!0});try{let ne=G,W=B,P={...ie};for(let z=0;z<se;z++){const $={},ee=ne.nodes.map(ce=>{const He=da(ne,ge,ce);if(He===null||!Array.isArray(ce.widgets_values))return ce;const Ve=T[ce.id]??Cf(ne,ge,ce),qe=He+1;if(typeof ce.widgets_values[qe]=="string"){if(!Ve||Ve==="fixed")return ce;const Ze=Number(ce.widgets_values[He])||0;let wt;switch(Ve){case"randomize":wt=vl(ge,ce);break;case"increment":wt=Ze+1;break;case"decrement":wt=Ze-1;break;default:return ce}const pt=[...ce.widgets_values];return pt[He]=wt,{...ce,widgets_values:pt}}const Xe=Number(ce.widgets_values[He]),Ie=P[ce.id]??null;let _e=null;return Lp(Xe)?_e=u2(Xe,Ie,ge,ce):Ve&&Ve!=="fixed"&&(Ve==="randomize"?_e=vl(ge,ce):Ve==="increment"?_e=(typeof Ie=="number"?Ie:Xe)+1:Ve==="decrement"&&(_e=(typeof Ie=="number"?Ie:Xe)-1)),_e===null||($[ce.id]=_e,P={...P,[ce.id]:_e}),ce});if(ne={...ne,nodes:ee},W){let ce=W;for(const He of ee)ce=fl(ce,He);W=ce}Z.setSeedLastValues(P),n({workflow:ne,embedWorkflow:W});const pe={},ae=new Set,ke=new Map;for(const ce of ne.nodes){if(ce.mode===4)continue;let He=null;if(ge[ce.type])He=ce.type;else{const Ve=Object.entries(ge).find(([,qe])=>qe.display_name===ce.type||qe.name===ce.type);Ve&&(He=Ve[0])}He&&(ae.add(ce.id),ke.set(ce.id,He))}for(const ce of ne.nodes){if(ce.mode===4)continue;const He=ke.get(ce.id);if(!He)continue;const Ve=Hw(ne,ge,ce,He,ae,kp(ne,ce.id),$);pe[String(ce.id)]={class_type:He,inputs:Ve}}const U=await fetch(`${rn}/api/prompt`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:pe,client_id:Bb,extra_data:{extra_pnginfo:{workflow:Bu(W??ne)}}})});if(!U.ok){const ce=await U.json(),He={};if(ce.node_errors)for(const[Ve,qe]of Object.entries(ce.node_errors)){const ot=qe.errors;ot&&ot.length>0&&(He[Ve]=ot.map(Ge=>({type:Ge.type,message:Ge.message,details:Ge.details,inputName:Ge.extra_info?.input_name})))}throw Object.keys(He).length>0&&s(He),new Error(ce.error?.message||"Failed to queue prompt")}pn.getState().clearNodeErrors()}}catch(ne){pn.getState().setError(ne instanceof Error?ne.message:"Failed to queue workflow")}finally{Ht.getState().fetchQueue(),n({isLoading:!1})}};return{workflowSource:null,workflow:null,embedWorkflow:null,originalWorkflow:null,currentFilename:null,currentWorkflowKey:null,nodeTypes:null,isLoading:!1,savedWorkflowStates:{},isExecuting:!1,executingNodeId:null,executingPromptId:null,progress:0,executionStartTime:null,currentNodeStartTime:null,nodeDurationStats:{},workflowDurationStats:{},nodeOutputs:{},nodeTextOutputs:{},promptOutputs:{},runCount:1,followQueue:!1,workflowLoadedAt:0,connectionHighlightModes:{},connectionButtonsVisible:!0,searchQuery:"",searchOpen:!1,addNodeModalRequest:null,collapsedItems:{},hiddenItems:{},stableKeyByPointer:{},pointerByStableKey:{},mobileLayout:Nu(),setMobileLayout:D,addNode:d,addNodeAndConnect:h,deleteNode:a,deleteContainer:Me,connectNodes:l,disconnectInput:c,setNodeOutput:p,setNodeTextOutput:m,clearNodeOutputs:X,requestAddNodeModal:K,clearAddNodeModalRequest:je,toggleBypass:k,bypassAllInContainer:de,updateNodeWidget:N,updateNodeWidgets:w,updateNodeTitle:j,updateContainerTitle:Ne,setExecutionState:R,addPromptOutputs:re,clearPromptOutputs:te,queueWorkflow:xe,applyControlAfterGenerate:Ee,setRunCount:me,setFollowQueue:Te,cycleConnectionHighlight:y,setConnectionHighlightMode:x,toggleConnectionButtonsVisible:F,setSearchQuery:M,setSearchOpen:L,prepareRepositionScrollTarget:We,scrollToNode:O,setItemHidden:v,revealNodeWithParents:C,showAllHiddenNodes:_,setItemCollapsed:q,setNodeTypes:V,loadWorkflow:I,unloadWorkflow:H,setSavedWorkflow:A,clearWorkflowCache:Se,updateWorkflowDuration:Re,saveCurrentWorkflowState:J}},{name:"workflow-storage",storage:wr(()=>localStorage),partialize:n=>({workflow:n.workflow,embedWorkflow:n.embedWorkflow,originalWorkflow:n.originalWorkflow,currentFilename:n.currentFilename,currentWorkflowKey:n.currentWorkflowKey,savedWorkflowStates:n.savedWorkflowStates,runCount:n.runCount,hiddenItems:n.hiddenItems,collapsedItems:n.collapsedItems,stableKeyByPointer:n.stableKeyByPointer,pointerByStableKey:n.pointerByStableKey,connectionButtonsVisible:n.connectionButtonsVisible,mobileLayout:n.mobileLayout,isExecuting:n.isExecuting,executingNodeId:n.executingNodeId,executingPromptId:n.executingPromptId,progress:n.progress,executionStartTime:n.executionStartTime,currentNodeStartTime:n.currentNodeStartTime,nodeDurationStats:n.nodeDurationStats,workflowDurationStats:n.workflowDurationStats}),onRehydrateStorage:()=>n=>{if(n)if(n.workflow){const o=n.mobileLayout?fy(n.mobileLayout):null,s=wf(n.workflow,n.hiddenItems??{});n.mobileLayout=o&&B2(o,n.workflow)?o:hs(n.workflow,s);const a=Ao(n.mobileLayout,n.stableKeyByPointer??{},n.pointerByStableKey??{});n.workflow=Oo(n.workflow,a.layoutToStable),n.originalWorkflow&&(n.originalWorkflow=Oo(n.originalWorkflow,a.layoutToStable)),n.stableKeyByPointer=a.layoutToStable,n.pointerByStableKey=a.stableToLayout,n.hiddenItems=iu(n.hiddenItems,a.layoutToStable,a.stableToLayout),n.collapsedItems=Nf(n.collapsedItems,a.layoutToStable,a.stableToLayout),n.hiddenItems=iu(n.hiddenItems,a.layoutToStable,a.stableToLayout),n.hiddenItems=iu(n.hiddenItems,a.layoutToStable,a.stableToLayout)}else n.mobileLayout=Nu(),n.stableKeyByPointer={},n.pointerByStableKey={}}}));function Hu(n){const o=[...n.nodes].sort((s,a)=>s.id-a.id).map(s=>({id:s.id,type:s.type,mode:s.mode,inputs:s.inputs?.map(a=>a.link??null)??[],outputs:s.outputs?.map(a=>a.links??[])??[]}));return JSON.stringify({nodes:o,links:n.links??[]})}const tp=bo(n=>({appMenuOpen:!1,setAppMenuOpen:o=>n({appMenuOpen:o})})),Yn=bo((n,o)=>({history:[],isLoading:!1,addHistoryEntry:s=>{n(l=>l.history.some(c=>c.prompt_id===s.prompt_id)?l:{history:[s,...l.history]});const a=Ht.getState();if(a.queueItemExpanded[s.prompt_id]===void 0&&a.setQueueItemExpanded(s.prompt_id,!0),s.workflow&&s.durationSeconds){const l=Hu(s.workflow);fe.getState().updateWorkflowDuration(l,s.durationSeconds*1e3)}},fetchHistory:async()=>{n({isLoading:!0});try{const s=await Ww(50),a=Object.entries(s).map(([c,d])=>{const h=[];for(const j of Object.values(d.outputs))j.images&&h.push(...j.images),j.gifs&&h.push(...j.gifs),j.videos&&h.push(...j.videos);let p=Date.now(),m=null,y=null,x=!1;if(d.status?.messages)for(const[j,k]of d.status.messages)j==="execution_start"&&k.timestamp&&(p=k.timestamp,m=k.timestamp),(j==="execution_end"||j==="execution_success")&&k.timestamp&&(y=k.timestamp),j==="execution_error"&&(x=!0);m===null&&p&&(m=p);const v=m!==null&&y!==null&&y>=m?(y-m)/1e3:void 0,C=d.status?.status_str?.toLowerCase()||"",N=!x&&d.status?.completed!==!1&&!C.includes("error"),w=d.prompt?.[3]?.extra_pnginfo?.workflow;return{prompt_id:c,timestamp:p,durationSeconds:v,success:N,outputs:{images:h},prompt:d.prompt[2],workflow:w}});a.sort((c,d)=>d.timestamp-c.timestamp),n({history:a});const l=Ht.getState();for(const c of a)if(l.queueItemExpanded[c.prompt_id]===void 0&&l.setQueueItemExpanded(c.prompt_id,!0),c.workflow&&c.durationSeconds){const d=Hu(c.workflow);fe.getState().updateWorkflowDuration(d,c.durationSeconds*1e3)}}catch(s){console.error("Failed to fetch history:",s)}finally{n({isLoading:!1})}},deleteItem:async s=>{try{await Zw(s),n(a=>({history:a.history.filter(l=>l.prompt_id!==s)}))}catch(a){console.error("Failed to delete history item:",a)}},clearHistory:async()=>{try{await Jw()}catch(s){console.error("Failed to clear history:",s);try{const a=o().history.map(l=>l.prompt_id);await ey(a)}catch(a){console.error("Failed to delete history items:",a)}}finally{n({history:[]})}},clearEmptyItems:async()=>{const s=o().history.filter(a=>a.outputs.images.length===0).map(a=>a.prompt_id);if(s.length!==0)try{await ey(s),n(a=>({history:a.history.filter(l=>!s.includes(l.prompt_id))}))}catch(a){console.error("Failed to delete empty history items:",a)}}})),Xt=bo()(Sr((n,o)=>({source:"output",currentFolder:null,folders:[],files:[],isLoading:!1,error:null,viewMode:"grid",showHidden:!1,filter:{search:"",favoritesOnly:!1,type:"all"},sort:{mode:"modified"},favorites:[],selectionMode:!1,selectedIds:[],selectionActionOpen:!1,filterModalOpen:!1,newFolderModalOpen:!1,outputsViewerOpen:!1,setSource:s=>{n({source:s,currentFolder:null,files:[],folders:[],selectionMode:!1,selectedIds:[]}),o().fetchFolders(),o().fetchFiles()},setCurrentFolder:s=>{const{currentFolder:a}=o(),l=a?`${a}/${s}`:s;n({currentFolder:l,files:[],selectionMode:!1,selectedIds:[]}),o().fetchFiles()},navigateToPath:s=>{n({currentFolder:s,files:[],selectionMode:!1,selectedIds:[]}),o().fetchFiles()},navigateUp:()=>{const{currentFolder:s}=o();if(!s)return;const a=s.split("/");a.pop();const l=a.length>0?a.join("/"):null;n({currentFolder:l,files:[],selectionMode:!1,selectedIds:[]}),o().fetchFiles()},fetchFolders:async()=>{try{const{showHidden:s}=o(),a=await t2(s),{source:l}=o();n({folders:l==="output"?a.output:a.input})}catch(s){console.error("Failed to fetch folders:",s)}},fetchFiles:async()=>{const{source:s,currentFolder:a,sort:l,showHidden:c}=o();n({isLoading:!0,error:null});try{const d=await Qf(s,1e3,0,l.mode,!1,a,c);n({files:d,isLoading:!1})}catch(d){n({error:d.message,isLoading:!1})}},setFilter:s=>{n(a=>({filter:{...a.filter,...s}}))},setSort:s=>{n({sort:s}),o().fetchFiles()},setViewMode:s=>{n({viewMode:s})},toggleShowHidden:()=>{n(s=>({showHidden:!s.showHidden})),o().fetchFolders(),o().fetchFiles()},toggleFavorite:s=>{n(a=>({favorites:a.favorites.includes(s)?a.favorites.filter(c=>c!==s):[...a.favorites,s]}))},toggleSelectionMode:()=>{n(s=>({selectionMode:!s.selectionMode,selectedIds:[],selectionActionOpen:!1}))},toggleSelection:s=>{n(a=>({selectedIds:a.selectedIds.includes(s)?a.selectedIds.filter(c=>c!==s):[...a.selectedIds,s]}))},selectAll:()=>{const s=o().getDisplayedFiles();n({selectedIds:s.map(a=>a.id)})},selectIds:(s,a="add")=>{n(l=>{if(a==="replace")return{selectedIds:[...s]};const c=new Set(l.selectedIds);return s.forEach(d=>c.add(d)),{selectedIds:Array.from(c)}})},clearSelection:()=>{n({selectedIds:[],selectionActionOpen:!1})},setSelectionActionOpen:s=>{n({selectionActionOpen:s})},setFilterModalOpen:s=>{n({filterModalOpen:s})},setNewFolderModalOpen:s=>{n({newFolderModalOpen:s})},setOutputsViewerOpen:s=>{n({outputsViewerOpen:s})},addFavorites:s=>{n(a=>{const l=new Set(a.favorites);return s.forEach(c=>l.add(c)),{favorites:Array.from(l)}})},removeFavorites:s=>{n(a=>({favorites:a.favorites.filter(l=>!s.includes(l))}))},refresh:()=>{o().fetchFolders(),o().fetchFiles()},getDisplayedFiles:()=>{const{files:s,filter:a,favorites:l,showHidden:c,sort:d}=o();let h=[...s];if(c||(h=h.filter(m=>!m.name.startsWith("."))),a.search){const m=a.search.toLowerCase();h=h.filter(y=>y.name.toLowerCase().includes(m))}a.favoritesOnly&&(h=h.filter(m=>l.includes(m.id))),a.type!=="all"&&(h=h.filter(m=>m.type==="folder"||m.type===a.type));const p=d.mode.endsWith("-reverse")?-1:1;return d.mode.startsWith("name")?h.sort((m,y)=>m.name.localeCompare(y.name)*p):d.mode.startsWith("size")?h.sort((m,y)=>((m.size??0)-(y.size??0))*p):h.sort((m,y)=>((m.date??0)-(y.date??0))*p),h}}),{name:"outputs-storage",version:1,migrate:(n,o)=>{if(o===0){if(n.sort&&!n.sort.mode){const{field:s,order:a}=n.sort;s==="name"?n.sort={mode:a==="asc"?"name":"name-reverse"}:n.sort={mode:a==="desc"?"modified":"modified-reverse"}}n.filter&&!n.filter.type&&(n.filter.type="all")}return n},partialize:n=>({source:n.source,viewMode:n.viewMode,showHidden:n.showHidden,sort:n.sort,filter:n.filter,favorites:n.favorites})}));var _n=Eb();function X2({open:n,onClose:o,side:s,title:a,children:l}){const c=b.useRef(null);return b.useEffect(()=>{if(!n)return;const d=h=>{h.key==="Escape"&&o()};return document.addEventListener("keydown",d),()=>document.removeEventListener("keydown",d)},[n,o]),b.useEffect(()=>(n?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[n]),n?_n.createPortal(u.jsxs("div",{className:"fixed inset-0 z-[2300]",children:[u.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm",onClick:o}),u.jsxs("div",{ref:c,className:`
          absolute top-0 bottom-0 w-[85%] max-w-sm bg-white shadow-xl
          flex flex-col overflow-hidden
          ${s==="left"?"left-0 animate-slide-in-left":"right-0 animate-slide-in-right"}
        `,style:{animation:`${s==="left"?"slideInLeft":"slideInRight"} 0.2s ease-out`},children:[a&&u.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[u.jsx("h2",{className:"text-xl font-bold text-gray-900",children:a}),u.jsx("button",{onClick:o,className:`w-10 h-10 flex items-center justify-center rounded-full
                         text-gray-500 hover:bg-gray-100 text-2xl`,children:""})]}),u.jsx("div",{className:"flex-1 overflow-auto p-4 overscroll-contain scroll-container",children:l})]}),u.jsx("style",{children:`
        @keyframes slideInLeft {
          from { transform: translateX(-100%); }
          to { transform: translateX(0); }
        }
        @keyframes slideInRight {
          from { transform: translateX(100%); }
          to { transform: translateX(0); }
        }
      `})]}),document.body):null}function Z2(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",...n,children:u.jsx("path",{d:"M12 11V16M12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12C21 16.9706 16.9706 21 12 21ZM12.0498 8V8.1L11.9502 8.1002V8H12.0498Z"})})}function Qb({className:n}){return u.jsx(Z2,{className:n})}function J2(n){return u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",...n,children:[u.jsx("path",{d:"M19 4H5L10.5 10.5V17L13.5 19V10.5L19 4Z"}),u.jsx("path",{d:"M2.5 9L4.5 7L6.5 9"}),u.jsx("path",{d:"M4.5 7V17"}),u.jsx("path",{d:"M2.5 15L4.5 17L6.5 15"})]})}function eS(n){return u.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...n,children:[u.jsx("path",{d:"M6 4h9l3 3v13a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2Z",stroke:"currentColor",strokeWidth:"1.5",fill:"none"}),u.jsx("path",{d:"M9 10h6M9 14h6",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]})}function tS(n){return u.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...n,children:[u.jsx("path",{d:"M6 4h9l3 3v13a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2Z",stroke:"currentColor",strokeWidth:"1.5",fill:"none"}),u.jsx("path",{d:"M9 10h6M9 14h6M9 18h4",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]})}function nS(n){return u.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...n,children:u.jsx("path",{d:"M4 20h16M6 16l4-4m0 0l4-4m-4 4l4 4",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none"})})}function oS(n){return u.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...n,children:[u.jsx("path",{d:"M3 7h18v10a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V7Z",stroke:"currentColor",strokeWidth:"1.5",fill:"none"}),u.jsx("path",{d:"M3 7l9 6 9-6",stroke:"currentColor",strokeWidth:"1.5",fill:"none"})]})}function rS(n){return u.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...n,style:{transform:"rotate(90deg)",...n.style??{}},children:[u.jsx("circle",{cx:"12",cy:"5",r:"2",fill:"currentColor"}),u.jsx("circle",{cx:"12",cy:"12",r:"2",fill:"currentColor"}),u.jsx("circle",{cx:"12",cy:"19",r:"2",fill:"currentColor"})]})}function ws(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",...n,children:u.jsx("path",{d:"M10 17l5-5-5-5v10z"})})}function no(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",...n,children:u.jsx("path",{d:"M7 10l5 5 5-5H7z"})})}function Vu(n){return u.jsx("svg",{viewBox:"0 0 20 20","aria-hidden":"true",...n,children:u.jsx("g",{transform:"translate(-164 -6319)",fill:"currentColor",children:u.jsx("path",{d:"M170.673,6324.726 L170.669,6324.729 C170.266,6325.104 170.244,6325.735 170.62,6326.137 L171.577,6327.158 C171.876,6327.478 171.649,6328 171.212,6328 L165,6328 C164.447,6328 164,6328.448 164,6329 C164,6329.552 164.447,6330 165,6330 L171.197,6330 C171.637,6330 171.862,6330.527 171.558,6330.845 L170.63,6331.819 C170.248,6332.218 170.266,6332.852 170.669,6333.229 C171.068,6333.603 171.695,6333.584 172.071,6333.186 L174.76,6330.338 C175.49,6329.564 175.487,6328.354 174.753,6327.585 L172.067,6324.769 C171.692,6324.376 171.071,6324.357 170.673,6324.726 M182.222,6319 L175.777,6319 C174.8,6319 174,6319.68 174,6321.111 L174,6322.007 C174,6322.555 174.444,6323 174.993,6323 L175.006,6323 C175.555,6323 176,6322.555 176,6322.007 L176,6321.993 C176,6321.445 176.444,6321 176.993,6321 L181.006,6321 C181.555,6321 182,6321.445 182,6321.993 L182,6336.007 C182,6336.555 181.555,6337 181.006,6337 L176.993,6337 C176.444,6337 176,6336.555 176,6336.007 L176,6335.993 C176,6335.445 175.555,6335 175.006,6335 L174.993,6335 C174.444,6335 174,6335.445 174,6335.993 L174,6337.111 C174,6338.293 174.847,6339 175.777,6339 L182.222,6339 C183.204,6339 184,6338.204 184,6337.222 L184,6337.111 L184,6320.778 C184,6319.796 183.204,6319 182.222,6319"})})})}function Bp(n){return u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",...n,children:[u.jsx("path",{d:"M18.4101 3.6512L20.5315 5.77252C21.4101 6.6512 21.4101 8.07582 20.5315 8.9545L9.54019 19.9458C9.17774 20.3082 8.70239 20.536 8.19281 20.5915L4.57509 20.9856C3.78097 21.072 3.11061 20.4017 3.1971 19.6076L3.59111 15.9898C3.64661 15.4803 3.87444 15.0049 4.23689 14.6425L15.2282 3.6512C16.1068 2.77252 17.5315 2.77252 18.4101 3.6512Z",stroke:"currentColor",strokeWidth:"1.5"}),u.jsx("path",{d:"M15.2282 3.6512C16.1068 2.77252 17.5315 2.77252 18.4101 3.6512L20.5315 5.77252C21.4101 6.6512 21.4101 8.07582 20.5315 8.9545L18.7283 10.7576L13.425 5.45432L15.2282 3.6512Z",stroke:"currentColor",strokeWidth:"1.5"})]})}function Rl(n){return u.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...n,children:u.jsx("path",{d:"M6 6l12 12M18 6l-12 12",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round"})})}function zo(n){return u.jsx("svg",{viewBox:"0 0 16 16","aria-hidden":"true",...n,children:u.jsx("path",{d:"M6.4 11.2L3.2 8l1.1-1.1 2.1 2.1 5-5L12.5 5l-6.1 6.2Z",fill:"currentColor"})})}function sS(n){return u.jsx("svg",{viewBox:"0 0 16 16","aria-hidden":"true",...n,children:u.jsx("path",{d:"M4.2 4.2l7.6 7.6m0-7.6l-7.6 7.6",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"})})}function aS(n){return u.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...n,children:[u.jsx("path",{d:"M7 18a4 4 0 0 1 0-8 6 6 0 0 1 11.3-2.2A4.5 4.5 0 0 1 18 18H7Z",fill:"none",stroke:"currentColor",strokeWidth:"1.5"}),u.jsx("path",{d:"M12 10v7m0 0l-3-3m3 3l3-3",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]})}function gr(n){return u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2","aria-hidden":"true",...n,children:[u.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),u.jsx("circle",{cx:"12",cy:"12",r:"3"})]})}function Po(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2","aria-hidden":"true",...n,children:u.jsx("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24M1 1l22 22"})})}function Ho(n){return u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2","aria-hidden":"true",...n,children:[u.jsx("path",{d:"M3 6h18M8 6V4h8v2M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),u.jsx("path",{d:"M10 11v6M14 11v6"})]})}function lS(n){return u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2","aria-hidden":"true",...n,children:[u.jsx("circle",{cx:"12",cy:"12",r:"10"}),u.jsx("path",{d:"M15 9l-6 6M9 9l6 6"})]})}function zp(n){return u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2","aria-hidden":"true",...n,children:[u.jsx("path",{d:"M23 4v6h-6M1 20v-6h6"}),u.jsx("path",{d:"M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"})]})}function iS(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2","aria-hidden":"true",...n,children:u.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4M16 17l5-5-5-5M21 12H9"})})}function Cs(n){return u.jsx("svg",{viewBox:"0 0 16 16",fill:"none","aria-hidden":"true",...n,children:u.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeWidth:"1.3",d:"M9.18613 3.09999H6.81377M9.18613 12.9H7.55288c-3.08678 0-5.35171-2.99581-4.60305-6.08843l.3054-1.26158M14.7486 2.1721l-.5931 2.45c-.132.54533-.6065.92789-1.1508.92789h-2.2993c-.77173 0-1.33797-.74895-1.1508-1.5221l.5931-2.45c.132-.54533.6065-.9279 1.1508-.9279h2.2993c.7717 0 1.3379.74896 1.1508 1.52211Zm-8.3033 0-.59309 2.45c-.13201.54533-.60646.92789-1.15076.92789H2.4021c-.7717 0-1.33793-.74895-1.15077-1.5221l.59309-2.45c.13201-.54533.60647-.9279 1.15077-.9279h2.29935c.77169 0 1.33792.74896 1.15076 1.52211Zm8.3033 9.8-.5931 2.45c-.132.5453-.6065.9279-1.1508.9279h-2.2993c-.77173 0-1.33797-.749-1.1508-1.5221l.5931-2.45c.132-.5453.6065-.9279 1.1508-.9279h2.2993c.7717 0 1.3379.7489 1.1508 1.5221Z"})})}function Xb(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",...n,children:u.jsx("path",{d:"M13 20.74C12.9039 20.7541 12.8062 20.7541 12.71 20.74C12.5724 20.6823 12.4551 20.5849 12.3732 20.4602C12.2912 20.3355 12.2484 20.1892 12.25 20.04V16.7H3.00001C2.81189 16.6956 2.63208 16.6216 2.49538 16.4923C2.35868 16.363 2.27481 16.1876 2.26001 16V8.00002C2.25463 7.89856 2.26965 7.79706 2.30417 7.7015C2.3387 7.60595 2.39204 7.51829 2.46103 7.44371C2.53002 7.36913 2.61326 7.30913 2.70584 7.26727C2.79841 7.22542 2.89844 7.20255 3.00001 7.20002H12.25V4.01002C12.2498 3.86106 12.2946 3.71551 12.3784 3.59241C12.4623 3.4693 12.5813 3.37436 12.72 3.32002C12.8551 3.26039 13.0053 3.24376 13.1502 3.27238C13.2951 3.301 13.4277 3.37349 13.53 3.48002L21.53 11.48C21.6705 11.6206 21.7493 11.8113 21.7493 12.01C21.7493 12.2088 21.6705 12.3994 21.53 12.54L13.53 20.54C13.4601 20.6079 13.377 20.6608 13.2858 20.6952C13.1946 20.7296 13.0973 20.7448 13 20.74ZM3.76001 15.2H13C13.1981 15.2026 13.3874 15.2825 13.5275 15.4226C13.6676 15.5626 13.7474 15.7519 13.75 15.95V18.18L19.93 12L13.75 5.83002V8.00002C13.7477 8.19843 13.6689 8.3883 13.53 8.53002C13.3817 8.65257 13.1919 8.71343 13 8.70002H3.76001V15.2Z",fill:"currentColor"})})}function uS(n){return u.jsxs("svg",{viewBox:"0 0 16 16",fill:"none","aria-hidden":"true",...n,children:[u.jsx("path",{d:"M10.667 2.667c1.45.008 2.235.072 2.748.585C14 3.837 14 4.78 14 6.666v4c0 1.885 0 2.828-.585 3.414-.586.585-1.529.585-3.415.585H6c-1.886 0-2.829 0-3.414-.585C2 13.494 2 12.55 2 10.666v-4c0-1.886 0-2.829.586-3.414.512-.513 1.297-.577 2.747-.585",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round"}),u.jsx("path",{d:"M5.333 2.333c0-.552.448-1 1-1h3.334c.552 0 1 .448 1 1v.667c0 .553-.448 1-1 1H6.333c-.552 0-1-.447-1-1v-.667Z",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round"})]})}function cS(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2","aria-hidden":"true",...n,children:u.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M7 10l5 5 5-5M12 15V3"})})}function dS(n){return u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",...n,children:[u.jsx("rect",{x:"9",y:"9",width:"10",height:"12",rx:"2"}),u.jsx("path",{d:"M5 15V5a2 2 0 0 1 2-2h8"})]})}function fS(n){return u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",...n,children:[u.jsx("circle",{cx:"12",cy:"12",r:"9"}),u.jsx("path",{d:"M7 12h10"})]})}function $u(n){return u.jsx("svg",{viewBox:"0 0 20 20",fill:"none","aria-hidden":"true",...n,children:u.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M6 8l4 4 4-4"})})}function Yr(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"currentColor",strokeWidth:"2","aria-hidden":"true",...n,children:u.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})})}function Zb({showSlash:n=!1,...o}){return u.jsxs("svg",{viewBox:"0 0 32 32","aria-hidden":"true",overflow:"visible",...o,children:[u.jsx("path",{d:"M28 28H4a2.002 2.002 0 0 1-2-2V21h2v5h24v-5h2v5a2.002 2.002 0 0 1-2 2Z",fill:"currentColor"}),u.jsx("rect",{x:"7",y:"21",width:"18",height:"2",fill:"currentColor"}),u.jsx("rect",{x:"7",y:"16",width:"18",height:"2",fill:"currentColor"}),u.jsx("rect",{x:"7",y:"11",width:"18",height:"2",fill:"currentColor"}),u.jsx("rect",{x:"7",y:"6",width:"18",height:"2",fill:"currentColor"}),u.jsx("path",{d:"M16 -3l5 4H11l5-4Z",fill:"currentColor"}),n&&u.jsx("line",{x1:"2",y1:"30",x2:"28",y2:"4",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round"})]})}const Dt={transparent:"transparent",transparentBlack:"rgba(0, 0, 0, 0)",surface:{white:"#ffffff",darkPanel:"#151a23",gray100:"#f3f4f6",gray200:"#e5e7eb"},text:{primary:"#111827",secondary:"#6b7280",onDark:"#e5e7eb"},border:{gray200:"#e5e7eb",focusBlue:"#3b82f6"},status:{success:"#22c55e",successStrong:"rgba(34,197,94,0.9)",warning:"#facc15",danger:"#f97316"},brand:{blue500:"#3b82f6",subgraphBackground08:"rgba(59, 130, 246, 0.08)",subgraphBackground10:"rgba(59, 130, 246, 0.10)",subgraphBackground14:"rgba(59, 130, 246, 0.14)",subgraphBorder20:"rgba(59, 130, 246, 0.20)",subgraphBorder25:"rgba(59, 130, 246, 0.25)"},workflow:{defaultGroupDot:"#9ca3af",fastGroupBypassColors:{nocolor:"#353535",red:"#553333",brown:"#593930",green:"#335533",blue:"#333355",pale_blue:"#3f5159",cyan:"#335555",purple:"#553355",yellow:"#665533",black:"#000000"}}};function pS({progress:n,radius:o=11,...s}){const a=Math.min(100,Math.max(0,n)),l=2*Math.PI*o,c=l*(1-a/100);return u.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...s,children:u.jsx("circle",{cx:"12",cy:"12",r:o,fill:"none",stroke:Dt.status.successStrong,strokeWidth:"2",strokeLinecap:"round",strokeDasharray:l,strokeDashoffset:c})})}function Hp(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","aria-hidden":"true",...n,children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}function Eo(n){return u.jsx("svg",{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",...n,children:u.jsx("path",{fillRule:"evenodd",d:"M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z",clipRule:"evenodd"})})}function hS(n){return u.jsx("svg",{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",...n,children:u.jsx("path",{fillRule:"evenodd",d:"M4 10a1 1 0 011-1h10a1 1 0 110 2H5a1 1 0 01-1-1z",clipRule:"evenodd"})})}function Jb(n){return u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",...n,children:[u.jsx("circle",{cx:"11",cy:"11",r:"7"}),u.jsx("path",{d:"M20 20l-3.5-3.5"})]})}function gS(n){return u.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...n,children:[u.jsx("rect",{x:"4",y:"4",width:"16",height:"16",rx:"3",stroke:"currentColor",strokeWidth:"1.5",fill:"none"}),u.jsx("circle",{cx:"9",cy:"9",r:"1.5",fill:"currentColor"}),u.jsx("circle",{cx:"15",cy:"15",r:"1.5",fill:"currentColor"}),u.jsx("circle",{cx:"15",cy:"9",r:"1.5",fill:"currentColor"}),u.jsx("circle",{cx:"9",cy:"15",r:"1.5",fill:"currentColor"}),u.jsx("circle",{cx:"12",cy:"12",r:"1.5",fill:"currentColor"})]})}function ex(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","aria-hidden":"true",...n,children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}function tx(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",...n,children:u.jsx("path",{d:"M12 2L1 21h22L12 2zm0 3.5L19.5 19h-15L12 5.5zM11 10v4h2v-4h-2zm0 6v2h2v-2h-2z"})})}function nc(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2","aria-hidden":"true",...n,children:u.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})})}function wy(n){return u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",...n,children:[u.jsx("rect",{x:"3",y:"7",width:"12",height:"10",rx:"2"}),u.jsx("path",{d:"M15 10l5-3v10l-5-3z"})]})}function kl(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",...n,children:u.jsx("path",{d:"M19.1835 7.80516L16.2188 4.83755C14.1921 2.8089 13.1788 1.79457 12.0904 2.03468C11.0021 2.2748 10.5086 3.62155 9.5217 6.31506L8.85373 8.1381C8.59063 8.85617 8.45908 9.2152 8.22239 9.49292C8.11619 9.61754 7.99536 9.72887 7.86251 9.82451C7.56644 10.0377 7.19811 10.1392 6.46145 10.3423C4.80107 10.8 3.97088 11.0289 3.65804 11.5721C3.5228 11.8069 3.45242 12.0735 3.45413 12.3446C3.45809 12.9715 4.06698 13.581 5.28476 14.8L6.69935 16.2163L2.22345 20.6964C1.92552 20.9946 1.92552 21.4782 2.22345 21.7764C2.52138 22.0746 3.00443 22.0746 3.30236 21.7764L7.77841 17.2961L9.24441 18.7635C10.4699 19.9902 11.0827 20.6036 11.7134 20.6045C11.9792 20.6049 12.2404 20.5358 12.4713 20.4041C13.0192 20.0914 13.2493 19.2551 13.7095 17.5825C13.9119 16.8472 14.013 16.4795 14.2254 16.1835C14.3184 16.054 14.4262 15.9358 14.5468 15.8314C14.8221 15.593 15.1788 15.459 15.8922 15.191L17.7362 14.4981C20.4 13.4973 21.7319 12.9969 21.9667 11.9115C22.2014 10.826 21.1954 9.81905 19.1835 7.80516Z"})})}function np(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",...n,children:u.jsx("path",{d:"M15.9894 4.9502L16.52 4.42014L15.9894 4.9502ZM19.0716 8.03562L18.541 8.56568L19.0716 8.03562ZM8.73837 19.429L8.20777 19.9591L8.73837 19.429ZM4.62169 15.3081L5.15229 14.7781L4.62169 15.3081ZM17.5669 14.9943L17.3032 14.2922L17.5669 14.9943ZM15.6498 15.7146L15.9136 16.4167H15.9136L15.6498 15.7146ZM8.3322 8.38177L7.62798 8.12375L8.3322 8.38177ZM9.02665 6.48636L9.73087 6.74438V6.74438L9.02665 6.48636ZM5.84504 10.6735L6.04438 11.3965L5.84504 10.6735ZM7.30167 10.1351L6.86346 9.52646L6.86346 9.52646L7.30167 10.1351ZM7.67582 9.79038L8.24665 10.2768H8.24665L7.67582 9.79038ZM14.251 16.3805L14.742 16.9475L14.742 16.9475L14.251 16.3805ZM13.3806 18.2012L12.6574 18.0022V18.0022L13.3806 18.2012ZM13.9169 16.7466L13.3075 16.3094L13.3075 16.3094L13.9169 16.7466ZM2.71846 12.7552L1.96848 12.76L1.96848 12.76L2.71846 12.7552ZM2.93045 11.9521L2.28053 11.5778H2.28053L2.93045 11.9521ZM11.3052 21.3431L11.3064 20.5931H11.3064L11.3052 21.3431ZM12.0933 21.1347L11.7215 20.4833L11.7215 20.4833L12.0933 21.1347ZM11.6973 2.03606L11.8588 2.76845L11.6973 2.03606ZM1.4694 21.4699C1.17666 21.763 1.1769 22.2379 1.46994 22.5306C1.76298 22.8233 2.23786 22.8231 2.5306 22.5301L1.4694 21.4699ZM7.18383 17.8721C7.47657 17.5791 7.47633 17.1042 7.18329 16.8114C6.89024 16.5187 6.41537 16.5189 6.12263 16.812L7.18383 17.8721ZM15.4588 5.48026L18.541 8.56568L19.6022 7.50556L16.52 4.42014L15.4588 5.48026ZM9.26897 18.8989L5.15229 14.7781L4.09109 15.8382L8.20777 19.9591L9.26897 18.8989ZM17.3032 14.2922L15.386 15.0125L15.9136 16.4167L17.8307 15.6964L17.3032 14.2922ZM9.03642 8.63979L9.73087 6.74438L8.32243 6.22834L7.62798 8.12375L9.03642 8.63979ZM6.04438 11.3965C6.75583 11.2003 7.29719 11.0625 7.73987 10.7438L6.86346 9.52646C6.69053 9.65097 6.46601 9.72428 5.6457 9.95044L6.04438 11.3965ZM7.62798 8.12375C7.33502 8.92332 7.24338 9.14153 7.10499 9.30391L8.24665 10.2768C8.60041 9.86175 8.7823 9.33337 9.03642 8.63979L7.62798 8.12375ZM7.73987 10.7438C7.92696 10.6091 8.09712 10.4523 8.24665 10.2768L7.10499 9.30391C7.0337 9.38757 6.9526 9.46229 6.86346 9.52646L7.73987 10.7438ZM15.386 15.0125C14.697 15.2714 14.1716 15.4571 13.76 15.8135L14.742 16.9475C14.9028 16.8082 15.1192 16.7152 15.9136 16.4167L15.386 15.0125ZM14.1037 18.4001C14.329 17.5813 14.4021 17.3569 14.5263 17.1838L13.3075 16.3094C12.9902 16.7517 12.8529 17.2919 12.6574 18.0022L14.1037 18.4001ZM13.76 15.8135C13.5903 15.9605 13.4384 16.1269 13.3075 16.3094L14.5263 17.1838C14.5887 17.0968 14.6611 17.0175 14.742 16.9475L13.76 15.8135ZM5.15229 14.7781C4.50615 14.1313 4.06799 13.691 3.78366 13.3338C3.49835 12.9753 3.46889 12.8201 3.46845 12.7505L1.96848 12.76C1.97215 13.3422 2.26127 13.8297 2.61002 14.2679C2.95976 14.7073 3.47115 15.2176 4.09109 15.8382L5.15229 14.7781ZM5.6457 9.95044C4.80048 10.1835 4.10396 10.3743 3.58296 10.5835C3.06341 10.792 2.57116 11.0732 2.28053 11.5778L3.58038 12.3264C3.615 12.2663 3.71693 12.146 4.1418 11.9755C4.56523 11.8055 5.16337 11.6394 6.04438 11.3965L5.6457 9.95044ZM3.46845 12.7505C3.46751 12.6016 3.50616 12.4553 3.58038 12.3264L2.28053 11.5778C2.07354 11.9372 1.96586 12.3452 1.96848 12.76L3.46845 12.7505ZM8.20777 19.9591C8.83164 20.5836 9.34464 21.0987 9.78647 21.4506C10.227 21.8015 10.7179 22.0922 11.3041 22.0931L11.3064 20.5931C11.2369 20.593 11.0814 20.5644 10.721 20.2773C10.3618 19.9912 9.91923 19.5499 9.26897 18.8989L8.20777 19.9591ZM12.6574 18.0022C12.4133 18.8897 12.2462 19.4924 12.0751 19.9188C11.9033 20.3467 11.7821 20.4487 11.7215 20.4833L12.465 21.7861C12.974 21.4956 13.2573 21.0004 13.4671 20.4775C13.6776 19.9532 13.8694 19.2516 14.1037 18.4001L12.6574 18.0022ZM11.3041 22.0931C11.7112 22.0937 12.1114 21.9879 12.465 21.7861L11.7215 20.4833C11.595 20.5555 11.4519 20.5933 11.3064 20.5931L11.3041 22.0931ZM18.541 8.56568C19.6045 9.63022 20.3403 10.3695 20.7917 10.9788C21.2353 11.5774 21.2863 11.8959 21.2321 12.1464L22.6982 12.4634C22.8881 11.5854 22.5382 10.8162 21.9969 10.0857C21.4635 9.36592 20.6305 8.53486 19.6022 7.50556L18.541 8.56568ZM17.8307 15.6964C19.1921 15.1849 20.294 14.773 21.0771 14.3384C21.8718 13.8973 22.5083 13.3416 22.6982 12.4634L21.2321 12.1464C21.178 12.3968 21.0001 12.6655 20.3491 13.0268C19.6865 13.3946 18.7112 13.7632 17.3032 14.2922L17.8307 15.6964ZM16.52 4.42014C15.4841 3.3832 14.6481 2.54353 13.9246 2.00638C13.1908 1.46165 12.4175 1.10912 11.5357 1.30367L11.8588 2.76845C12.1086 2.71335 12.4277 2.7633 13.0304 3.21075C13.6433 3.66579 14.3876 4.40801 15.4588 5.48026L16.52 4.42014ZM9.73087 6.74438C10.2525 5.32075 10.6161 4.33403 10.9812 3.66315C11.3402 3.00338 11.609 2.82357 11.8588 2.76845L11.5357 1.30367C10.654 1.49819 10.1005 2.14332 9.66362 2.94618C9.23278 3.73793 8.82688 4.85154 8.32243 6.22834L9.73087 6.74438ZM2.5306 22.5301L7.18383 17.8721L6.12263 16.812L1.4694 21.4699L2.5306 22.5301Z"})})}function Vp(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2","aria-hidden":"true",...n,children:u.jsx("path",{d:"M9 6l6 6-6 6"})})}function mS(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",...n,children:u.jsx("path",{d:"M15 19l-7-7 7-7"})})}function op({isBypassed:n,...o}){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2","aria-hidden":"true",...o,children:n?u.jsxs(u.Fragment,{children:[u.jsx("path",{d:"M5 12h14"}),u.jsx("path",{d:"M12 5l7 7-7 7"})]}):u.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})}function nx({nodeId:n,connectionHighlightMode:o,leftLineCount:s,rightLineCount:a,inactiveColor:l=Dt.text.secondary,inputHighlightColor:c=Dt.status.danger,outputHighlightColor:d=Dt.status.danger,offLineColor:h=l,...p}){const m=o==="inputs"||o==="both",y=o==="outputs"||o==="both",x=m?c:h,v=y?d:h;return u.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...p,children:[u.jsxs("defs",{children:[u.jsx("clipPath",{id:`node-rect-left-${n}`,children:u.jsx("rect",{x:"0",y:"0",width:"12",height:"24"})}),u.jsx("clipPath",{id:`node-rect-right-${n}`,children:u.jsx("rect",{x:"12",y:"0",width:"12",height:"24"})})]}),u.jsxs(u.Fragment,{children:[u.jsx("rect",{x:"7",y:"7",width:"10",height:"10",rx:"2",stroke:x,strokeWidth:"1.6",fill:"none",strokeLinejoin:"round",clipPath:`url(#node-rect-left-${n})`}),u.jsx("rect",{x:"7",y:"7",width:"10",height:"10",rx:"2",stroke:v,strokeWidth:"1.6",fill:"none",strokeLinejoin:"round",clipPath:`url(#node-rect-right-${n})`})]}),u.jsxs("g",{style:{color:x},children:[s===1&&u.jsx("line",{x1:"7",y1:"12",x2:"-4.25",y2:"12",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"}),s===2&&u.jsxs(u.Fragment,{children:[u.jsx("line",{x1:"7",y1:"12",x2:"-4.25",y2:"8.625",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"}),u.jsx("line",{x1:"7",y1:"12",x2:"-4.25",y2:"15.375",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"})]}),s>=3&&u.jsxs(u.Fragment,{children:[u.jsx("line",{x1:"7",y1:"12",x2:"-4.25",y2:"12",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"}),u.jsx("line",{x1:"7",y1:"12",x2:"-2.743",y2:"6.375",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"}),u.jsx("line",{x1:"7",y1:"12",x2:"-2.743",y2:"17.625",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"})]})]}),u.jsxs("g",{style:{color:v},children:[a===1&&u.jsx("line",{x1:"17",y1:"12",x2:"28.25",y2:"12",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"}),a===2&&u.jsxs(u.Fragment,{children:[u.jsx("line",{x1:"17",y1:"12",x2:"28.25",y2:"8.625",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"}),u.jsx("line",{x1:"17",y1:"12",x2:"28.25",y2:"15.375",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"})]}),a>=3&&u.jsxs(u.Fragment,{children:[u.jsx("line",{x1:"17",y1:"12",x2:"28.25",y2:"12",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"}),u.jsx("line",{x1:"17",y1:"12",x2:"26.743",y2:"6.375",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"}),u.jsx("line",{x1:"17",y1:"12",x2:"26.743",y2:"17.625",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"})]})]})]})}function yS(n){return u.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...n,children:[u.jsxs("defs",{children:[u.jsx("clipPath",{id:"legend-trace-left",children:u.jsx("rect",{x:"0",y:"0",width:"12",height:"24"})}),u.jsx("clipPath",{id:"legend-trace-right",children:u.jsx("rect",{x:"12",y:"0",width:"12",height:"24"})})]}),u.jsx("rect",{x:"7",y:"7",width:"10",height:"10",rx:"2",stroke:"currentColor",strokeWidth:"1.6",fill:"none",clipPath:"url(#legend-trace-left)",className:"text-gray-400"}),u.jsx("rect",{x:"7",y:"7",width:"10",height:"10",rx:"2",stroke:"currentColor",strokeWidth:"1.6",fill:"none",clipPath:"url(#legend-trace-right)",className:"text-orange-500"}),u.jsx("line",{x1:"7",y1:"12",x2:"-4.25",y2:"12",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round",className:"text-gray-400"}),u.jsx("line",{x1:"17",y1:"12",x2:"28.25",y2:"12",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round",className:"text-orange-500"})]})}function ox(n){return u.jsx("svg",{viewBox:"0 0 16 16",fill:"none","aria-hidden":"true",...n,children:u.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeWidth:"1.3",d:"m14.6685 5.7416.6425-2.57c.2028-.811-.4106-1.5967-1.2466-1.5967H2.5782a1.285 1.285 0 0 0-1.2467.9733l-.6425 2.57c-.2027.8111.4107 1.5968 1.2467 1.5968h11.4861a1.285 1.285 0 0 0 1.2467-.9734Zm0 7.7102.6425-2.5701c.2028-.811-.4106-1.5967-1.2466-1.5967h-5.061a1.285 1.285 0 0 0-1.2467.9734l-.6425 2.5701c-.2028.811.4106 1.5966 1.2466 1.5966h5.061a1.285 1.285 0 0 0 1.2467-.9733Zm-10.2802 0 .6425-2.5701c.2027-.811-.4107-1.5967-1.2467-1.5967H2.5782a1.285 1.285 0 0 0-1.2467.9734L.689 12.8285c-.2027.811.4107 1.5966 1.2467 1.5966h1.206a1.285 1.285 0 0 0 1.2466-.9733Z"})})}function bS(n){return u.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...n,children:u.jsx("path",{d:"M12 3v10m0 0l-4-4m4 4l4-4M5 19h14",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none"})})}function xS(n){return u.jsxs("svg",{viewBox:"0 0 16 16",fill:"none","aria-hidden":"true",...n,children:[u.jsx("path",{d:"M10.667 2.667c1.45.008 2.235.072 2.748.585C14 3.837 14 4.78 14 6.666v4c0 1.885 0 2.828-.585 3.414-.586.585-1.529.585-3.415.585H6c-1.886 0-2.829 0-3.414-.585C2 13.494 2 12.55 2 10.666v-4c0-1.886 0-2.829.586-3.414.512-.513 1.297-.577 2.747-.585",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round"}),u.jsx("path",{d:"M5.333 2.333c0-.552.448-1 1-1h3.334c.552 0 1 .448 1 1v.667c0 .553-.448 1-1 1H6.333c-.552 0-1-.447-1-1v-.667Z",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round"}),u.jsx("path",{d:"M8 6.667v4.666m0 0L5.667 9m2.333 2.333L10.333 9",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round"})]})}function mr(n){return u.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...n,children:[u.jsx("path",{d:"M3 7a2 2 0 0 1 2-2h4l2 2h8a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V7Z",stroke:"currentColor",strokeWidth:"1.5",fill:"none"}),u.jsx("path",{d:"M3 9h18",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]})}function rx(n){return u.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...n,children:[u.jsx("path",{d:"M5 4h12l3 3v13H4V5a1 1 0 0 1 1-1Z",stroke:"currentColor",strokeWidth:"1.5",fill:"none"}),u.jsx("rect",{x:"7",y:"4",width:"8",height:"4",fill:"currentColor"}),u.jsx("rect",{x:"7",y:"13",width:"10",height:"6",rx:"1",stroke:"currentColor",strokeWidth:"1.5",fill:"none"})]})}function sx(n){return u.jsxs("svg",{viewBox:"0 0 16 16",fill:"none","aria-hidden":"true",...n,children:[u.jsx("path",{d:"M12.667 14H3.333C2.597 14 2 13.403 2 12.667V3.333C2 2.597 2.597 2 3.333 2h7.334L14 5.333v7.334c0 .736-.597 1.333-1.333 1.333Z",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round"}),u.jsx("path",{d:"M11.333 14v-4H4.667v4M4.667 2v3.333h5.333",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round"})]})}function vS(n){return u.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...n,children:[u.jsx("circle",{cx:"12",cy:"12",r:"4",fill:"currentColor"}),u.jsx("path",{d:"M12 2v3M12 19v3M4.22 4.22l2.12 2.12M17.66 17.66l2.12 2.12M2 12h3M19 12h3M4.22 19.78l2.12-2.12M17.66 6.34l2.12-2.12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",fill:"none"})]})}function wS(n){return u.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...n,children:u.jsx("path",{d:"M21 14.5A9 9 0 0 1 9.5 3a7 7 0 1 0 11.5 11.5Z",fill:"currentColor"})})}function SS(n){return u.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",fill:"currentColor",...n,children:u.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z"})})}function rp(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","aria-hidden":"true",...n,children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})}function NS(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","aria-hidden":"true",...n,children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}function CS(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","aria-hidden":"true",...n,children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})}function kS(n){return u.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...n,children:u.jsx("path",{d:"M8 4h8M8 20h8M9 6h6l-1 4 1 4H9l1-4-1-4Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none"})})}function ax(n){return u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",...n,children:[u.jsx("path",{d:"M12 3v18"}),u.jsx("path",{d:"m8 7 4-4 4 4"}),u.jsx("path",{d:"m8 17 4 4 4-4"})]})}function jS({progress:n,radius:o=10,trackColor:s=Dt.border.gray200,progressColor:a=Dt.brand.blue500,...l}){const c=Math.min(100,Math.max(0,n)),d=2*Math.PI*o,h=d*(1-c/100);return u.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...l,children:[u.jsx("circle",{cx:"12",cy:"12",r:o,fill:"none",stroke:s,strokeWidth:"2"}),u.jsx("circle",{cx:"12",cy:"12",r:o,fill:"none",stroke:a,strokeWidth:"2",strokeLinecap:"round",strokeDasharray:d,strokeDashoffset:h})]})}function Dl({title:n,onBack:o,rightElement:s}){return u.jsxs("div",{className:"flex items-center mb-3",children:[u.jsxs("button",{onClick:o,className:"flex items-center gap-2 text-sm font-semibold text-gray-500 uppercase tracking-wide",children:[u.jsx(mS,{className:"w-5 h-5 text-gray-400"}),u.jsx("span",{children:n})]}),s&&u.jsx("div",{className:"ml-auto",children:s})]})}function MS({icon:n,title:o,description:s}){return u.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 bg-white border border-gray-100 rounded-lg shadow-sm",children:[n,u.jsxs("div",{children:[u.jsx("p",{className:"text-sm font-medium text-gray-900",children:o}),u.jsx("p",{className:"text-xs text-gray-500",children:s})]})]})}function OS(){return[{icon:u.jsx("div",{className:"w-8 h-8 flex items-center justify-center bg-blue-500 text-white rounded-lg font-bold text-xs shadow-sm",children:"Run"}),title:"Run",description:"Execute current workflow"},{icon:u.jsx("div",{className:"w-10 h-10 flex items-center justify-center bg-white border border-gray-200 rounded-lg text-gray-700 shadow-sm overflow-hidden",children:u.jsx(Zb,{className:"w-5 h-5"})}),title:"Queue / Follow",description:"View queue & follow execution"},{icon:u.jsx("div",{className:"w-10 h-10 flex items-center justify-center bg-yellow-500 text-white rounded-lg shadow-sm",children:u.jsx(kl,{className:"w-5 h-5"})}),title:"Pinned Widget",description:"Quick access to pinned parameter"},{icon:u.jsx("div",{className:"w-8 h-8 flex items-center justify-center bg-gray-100 rounded-full border border-gray-200 text-gray-700 font-bold",children:""}),title:"Input",description:"Node input connection point"},{icon:u.jsx("div",{className:"w-8 h-8 flex items-center justify-center bg-gray-100 rounded-full border border-gray-200 text-gray-700 font-bold",children:""}),title:"Output",description:"Node output connection point"},{icon:u.jsx("div",{className:"w-8 h-8 flex items-center justify-center text-gray-700",children:u.jsx(yS,{className:"w-6 h-6 overflow-visible"})}),title:"Trace Connections",description:"Highlight connected nodes"},{icon:u.jsx("div",{className:"w-8 h-8 flex items-center justify-center text-gray-500",children:u.jsx(no,{className:"w-6 h-6"})}),title:"Fold / Unfold",description:"Collapse or expand node card"},{icon:u.jsx("div",{className:"w-8 h-8 flex items-center justify-center text-gray-700",children:u.jsx(ex,{className:"w-5 h-5"})}),title:"Bypass",description:"Skip node execution"},{icon:u.jsx("div",{className:"w-8 h-8 flex items-center justify-center text-gray-700",children:u.jsx(Po,{className:"w-5 h-5"})}),title:"Hide",description:"Hide node from view"},{icon:u.jsx("div",{className:"w-8 h-8 flex items-center justify-center text-gray-700",children:u.jsx(gr,{className:"w-5 h-5"})}),title:"Show",description:"Make node visible again"},{icon:u.jsx("div",{className:"w-8 h-8 flex items-center justify-center text-gray-700",children:u.jsx(np,{className:"w-5 h-5"})}),title:"Pin widget",description:"Pin widget to bottom bar"}]}function TS({onBack:n}){const o=OS();return u.jsxs("div",{className:"flex flex-col h-full",children:[u.jsx(Dl,{title:"Icon Legend",onBack:n}),u.jsx("div",{className:"space-y-3 overflow-y-auto flex-1 pb-4",children:o.map(s=>u.jsx(MS,{icon:s.icon,title:s.title,description:s.description},s.title))})]})}function Bl({error:n,onDismiss:o}){return n?u.jsxs("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:[n,u.jsx("button",{onClick:o,className:"ml-2 text-red-500 font-medium",children:"Dismiss"})]}):null}function ES({error:n,workflow:o,currentFilename:s,isDirty:a,loading:l,theme:c,menuSectionsOpen:d,fileInputRef:h,loadSectionRef:p,saveSectionRef:m,appearanceSectionRef:y,infoSectionRef:x,onDismissError:v,onFileChange:C,onLoadFromFile:N,onToggleSection:w,onOpenUserWorkflows:j,onOpenTemplates:k,onOpenPasteJson:O,onSave:R,onOpenSaveAs:D,onToggleTheme:I,onOpenLegend:H}){return u.jsxs(u.Fragment,{children:[u.jsx("input",{ref:h,type:"file",accept:".json",onChange:C,className:"hidden"}),u.jsx(Bl,{error:n,onDismiss:v}),u.jsxs("section",{ref:p,className:"mb-6",children:[u.jsxs("button",{type:"button",onClick:()=>w("load"),className:"w-full flex items-center justify-between text-sm font-semibold text-gray-500 uppercase tracking-wide mb-3","aria-expanded":d.load,children:[u.jsx("span",{children:"Load Workflow"}),u.jsx(no,{className:`w-5 h-5 text-gray-400 transition-transform ${d.load?"rotate-0":"-rotate-90"}`})]}),d.load&&u.jsxs("div",{className:"space-y-2",children:[u.jsxs("button",{onClick:j,className:`w-full flex items-center gap-3 p-4 bg-white border border-gray-200
                         rounded-xl text-left hover:bg-gray-50 min-h-[56px]`,children:[u.jsx(Cs,{className:"w-6 h-6 text-gray-600"}),u.jsx("span",{className:"font-medium text-gray-900",children:"My Workflows"}),u.jsx("span",{className:"ml-auto text-gray-400",children:""})]}),u.jsxs("button",{onClick:k,className:`w-full flex items-center gap-3 p-4 bg-white border border-gray-200
                         rounded-xl text-left hover:bg-gray-50 min-h-[56px]`,children:[u.jsx(ox,{className:"w-6 h-6 text-gray-600"}),u.jsx("span",{className:"font-medium text-gray-900",children:"Templates"}),u.jsx("span",{className:"ml-auto text-gray-400",children:""})]}),u.jsxs("button",{onClick:O,className:`w-full flex items-center gap-3 p-4 bg-white border border-gray-200
                         rounded-xl text-left hover:bg-gray-50 min-h-[56px]`,children:[u.jsx(xS,{className:"w-6 h-6 text-gray-600"}),u.jsx("span",{className:"font-medium text-gray-900",children:"Paste JSON"}),u.jsx("span",{className:"ml-auto text-gray-400",children:""})]}),u.jsxs("button",{onClick:N,className:`w-full flex items-center gap-3 p-4 bg-white border border-gray-200
                         rounded-xl text-left hover:bg-gray-50 min-h-[56px]`,children:[u.jsx(mr,{className:"w-6 h-6 text-gray-600"}),u.jsx("span",{className:"font-medium text-gray-900",children:"From Device"})]})]})]}),u.jsxs("section",{ref:m,className:"mb-6",children:[u.jsxs("button",{type:"button",onClick:()=>w("save"),className:"w-full flex items-center justify-between text-sm font-semibold text-gray-500 uppercase tracking-wide mb-3","aria-expanded":d.save,children:[u.jsx("span",{children:"Save Workflow"}),u.jsx(no,{className:`w-5 h-5 text-gray-400 transition-transform ${d.save?"rotate-0":"-rotate-90"}`})]}),d.save&&u.jsxs("div",{className:"space-y-2",children:[s&&u.jsxs("button",{onClick:R,disabled:!o||!a||l,className:`w-full flex items-center gap-3 p-4 bg-white border border-gray-200
                           rounded-xl text-left hover:bg-gray-50 min-h-[56px]
                           disabled:opacity-50 disabled:cursor-not-allowed`,children:[u.jsx(rx,{className:"w-6 h-6 text-gray-600 shrink-0"}),u.jsxs("span",{className:"font-medium text-gray-900 truncate",children:["Save ",s.replace(".json","")]})]}),u.jsxs("button",{onClick:D,disabled:!o,className:`w-full flex items-center gap-3 p-4 bg-white border border-gray-200
                         rounded-xl text-left hover:bg-gray-50 min-h-[56px]`,children:[u.jsx(sx,{className:"w-6 h-6 text-gray-600"}),u.jsx("span",{className:"font-medium text-gray-900",children:"Save As..."}),u.jsx("span",{className:"ml-auto text-gray-400",children:""})]})]})]}),u.jsx("div",{className:"border-t border-gray-200 mb-6"}),u.jsxs("section",{ref:y,className:"mb-6",children:[u.jsxs("button",{type:"button",onClick:()=>w("appearance"),className:"w-full flex items-center justify-between text-sm font-semibold text-gray-500 uppercase tracking-wide mb-3","aria-expanded":d.appearance,children:[u.jsx("span",{children:"Appearance"}),u.jsx(no,{className:`w-5 h-5 text-gray-400 transition-transform ${d.appearance?"rotate-0":"-rotate-90"}`})]}),d.appearance&&u.jsx("div",{className:"space-y-2",children:u.jsxs("button",{onClick:I,className:`w-full flex items-center gap-3 p-4 bg-white border border-gray-200
                         rounded-xl text-left hover:bg-gray-50 min-h-[56px]`,children:[c==="dark"?u.jsx(wS,{className:"w-6 h-6 text-gray-600"}):u.jsx(vS,{className:"w-6 h-6 text-gray-600"}),u.jsx("span",{className:"font-medium text-gray-900",children:c==="dark"?"Dark mode":"Light mode"})]})})]}),u.jsxs("section",{ref:x,className:"mt-auto pt-6 border-t border-gray-200",children:[u.jsxs("button",{type:"button",onClick:()=>w("info"),className:"w-full flex items-center justify-between text-sm font-semibold text-gray-500 uppercase tracking-wide mb-3","aria-expanded":d.info,children:[u.jsx("span",{children:"About"}),u.jsx(no,{className:`w-5 h-5 text-gray-400 transition-transform ${d.info?"rotate-0":"-rotate-90"}`})]}),d.info&&u.jsxs("div",{className:"space-y-2 pb-4",children:[u.jsxs("a",{href:"https://github.com/cosmicbuffalo/comfyui-mobile-frontend",target:"_blank",rel:"noopener noreferrer",className:`w-full flex items-center gap-3 p-4 bg-white border border-gray-200
                         rounded-xl text-left hover:bg-gray-50 min-h-[56px]`,children:[u.jsx(SS,{className:"w-6 h-6 text-gray-600"}),u.jsx("span",{className:"font-medium text-gray-900",children:"Open in GitHub"}),u.jsx(rp,{className:"w-4 h-4 ml-auto text-gray-400"})]}),u.jsxs("button",{onClick:H,className:`w-full flex items-center gap-3 p-4 bg-white border border-gray-200
                         rounded-xl text-left hover:bg-gray-50 min-h-[56px]`,children:[u.jsx(NS,{className:"w-6 h-6 text-gray-600"}),u.jsx("span",{className:"font-medium text-gray-900",children:"Icon Legend"}),u.jsx("span",{className:"ml-auto text-gray-400",children:""})]}),u.jsxs("a",{href:"https://github.com/cosmicbuffalo/comfyui-mobile-frontend/blob/main/USER_GUIDE.md",target:"_blank",rel:"noopener noreferrer",className:`w-full flex items-center gap-3 p-4 bg-white border border-gray-200
                         rounded-xl text-left hover:bg-gray-50 min-h-[56px]`,children:[u.jsx(CS,{className:"w-6 h-6 text-gray-600"}),u.jsx("span",{className:"font-medium text-gray-900",children:"User Manual"}),u.jsx(rp,{className:"w-4 h-4 ml-auto text-gray-400"})]})]})]})]})}async function IS(n){if(navigator.clipboard?.writeText)try{await navigator.clipboard.writeText(n);return}catch{}const o=document.createElement("textarea");o.value=n,o.readOnly=!0,o.style.position="fixed",o.style.top="0",o.style.left="0",o.style.opacity="0",document.body.appendChild(o),o.focus(),o.select(),o.setSelectionRange(0,o.value.length),document.execCommand("copy"),document.body.removeChild(o)}function Sy(n,o,s){const a=n.current;if(a){if(a.focus(),o)a.setSelectionRange(o.start,o.end);else if(s!==void 0){const l=s.length;a.setSelectionRange(l,l)}}}function LS(n){const o=n.current;if(!o)return;const a=o.closest('[data-textarea-root="true"]')?.querySelector('[data-textarea-header="true"]');a?a.scrollIntoView({block:"nearest",behavior:"auto"}):o.scrollIntoView({block:"nearest",behavior:"auto"})}function bl({value:n,onChange:o,textareaRef:s,className:a=""}){const[l,c]=b.useState(!1),d=b.useRef(null),h=b.useRef(null),p=()=>{c(!0),d.current&&clearTimeout(d.current),d.current=setTimeout(()=>c(!1),900)},m=v=>{v.preventDefault()},y=async()=>{const v=s.current;v&&(h.current={start:v.selectionStart??0,end:v.selectionEnd??0});const C=s.current?.value??n;await IS(C),requestAnimationFrame(()=>Sy(s,h.current||void 0)),p()},x=()=>{o(""),requestAnimationFrame(()=>{Sy(s,void 0,""),LS(s)})};return u.jsxs("div",{className:`flex items-center text-[11px] text-gray-500 ${a}`,children:[u.jsxs("button",{type:"button",className:"inline-flex items-center gap-1 px-1 py-0.5 text-gray-600",onMouseDown:m,onClick:y,"aria-label":"Copy to clipboard",children:[l?u.jsx(zo,{className:"w-3.5 h-3.5 text-green-500"}):u.jsx(dS,{className:"w-3.5 h-3.5"}),u.jsx("span",{children:"Copy"})]}),u.jsx("span",{className:"text-gray-500/50",children:"|"}),u.jsxs("button",{type:"button",className:"inline-flex items-center gap-1 px-1 py-0.5 text-red-600",onMouseDown:m,onClick:x,"aria-label":"Clear text",children:[u.jsx(fS,{className:"w-3.5 h-3.5"}),u.jsx("span",{children:"Clear"})]})]})}function _S({error:n,pastedJson:o,pasteTextareaRef:s,onBack:a,onDismissError:l,onChangeJson:c,onLoad:d}){return u.jsxs("div",{className:"flex flex-col h-full",children:[u.jsx(Dl,{title:"Paste JSON",onBack:a}),u.jsx(Bl,{error:n,onDismiss:l}),u.jsxs("div",{className:"flex-1 flex flex-col space-y-4",children:[u.jsx("p",{className:"text-sm text-gray-600",children:"Paste your workflow JSON below."}),u.jsxs("div",{className:"group","data-textarea-root":"true",children:[u.jsxs("div",{className:"flex items-center justify-between mb-1","data-textarea-header":"true",children:[u.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Workflow JSON"}),u.jsx(bl,{value:o,onChange:c,textareaRef:s,className:"opacity-70 transition-opacity group-focus-within:opacity-100"})]}),u.jsx("textarea",{ref:s,value:o,onChange:h=>c(h.target.value),placeholder:'{"last_node_id": ...}',className:"w-full flex-1 p-3 border border-gray-300 rounded-lg font-mono text-xs resize-none outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),u.jsxs("div",{className:"flex gap-3 pt-2",children:[u.jsx("button",{onClick:a,className:"flex-1 py-3 bg-gray-100 text-gray-700 rounded-lg font-medium hover:bg-gray-200 min-h-[48px]",children:"Cancel"}),u.jsx("button",{onClick:d,disabled:!o.trim(),className:`flex-1 py-3 bg-blue-500 text-white rounded-lg font-medium hover:bg-blue-600
                       disabled:opacity-50 disabled:cursor-not-allowed min-h-[48px]`,children:"Load"})]})]})]})}function AS({error:n,loading:o,workflow:s,saveFilenameInput:a,onBack:l,onDismissError:c,onSaveFilenameChange:d,onSaveAs:h,onDownload:p}){return u.jsxs("div",{className:"flex flex-col h-full",children:[u.jsx(Dl,{title:"Save Workflow",onBack:l}),u.jsx(Bl,{error:n,onDismiss:c}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"p-4 bg-white border border-gray-200 rounded-xl",children:[u.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Save to ComfyUI server:"}),u.jsx("input",{type:"text",value:a,onChange:m=>d(m.target.value),placeholder:"Enter filename (e.g., my_workflow.json)",className:"w-full p-3 border border-gray-300 rounded-lg mb-3"}),u.jsx("button",{onClick:h,disabled:!s||!a.trim()||o,className:`w-full py-3 bg-blue-500 text-white rounded-lg font-medium
                       disabled:opacity-50 disabled:cursor-not-allowed min-h-[48px]`,children:o?"Saving...":"Save As"})]}),u.jsxs("button",{onClick:p,disabled:!s,className:`w-full flex items-center gap-3 px-4 py-3 bg-white border border-gray-200
                     rounded-xl text-left hover:bg-gray-50 min-h-[56px]
                     disabled:opacity-50 disabled:cursor-not-allowed`,children:[u.jsx(bS,{className:"w-6 h-6 text-gray-600"}),u.jsx("span",{className:"font-medium text-gray-900",children:"Download to Device"})]})]})]})}function zl({value:n,onChange:o,onClear:s,placeholder:a="Search...",autoFocus:l=!1,className:c="",inputClassName:d="",disabled:h=!1,readOnly:p=!1,inputRef:m,showClearButton:y=!0}){const x=y&&n.trim().length>0&&!h&&!p;return u.jsxs("div",{className:`relative ${c}`.trim(),children:[u.jsx(Jb,{className:"w-4 h-4 text-gray-400 absolute left-3 top-1/2 -translate-y-1/2 pointer-events-none"}),u.jsx("input",{ref:m,value:n,onChange:v=>o(v.target.value),placeholder:a,className:`w-full rounded-lg border border-gray-200 pl-9 pr-9 py-2 text-sm text-gray-900 placeholder:text-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent ${d}`.trim(),autoFocus:l,disabled:h,readOnly:p}),x&&u.jsx("button",{type:"button",onClick:()=>{if(s){s();return}o("")},className:"absolute right-2 top-1/2 -translate-y-1/2 p-1 text-gray-400 hover:text-gray-600","aria-label":"Clear search",children:u.jsx(Rl,{className:"w-4 h-4"})})]})}const RS={sm:"w-4 h-4 border-2",md:"w-6 h-6 border-2",lg:"w-10 h-10 border-4"},DS={blue:"border-blue-500 border-t-transparent",gray:"border-gray-200 border-t-gray-500"};function $p({size:n="md",color:o="blue",className:s=""}){return u.jsx("div",{className:`animate-spin rounded-full ${RS[n]} ${DS[o]} ${s}`})}function BS({error:n,loading:o,templates:s,onBack:a,onDismissError:l,onLoadTemplate:c}){const[d,h]=b.useState(""),p=Object.entries(s),m=d.toLowerCase(),y=p.map(([v,C])=>[v,C.filter(N=>N.toLowerCase().includes(m))]).filter(([,v])=>v.length>0),x=p.length>0;return u.jsxs("div",{className:"flex flex-col h-full",children:[u.jsx(Dl,{title:"Templates",onBack:a}),u.jsx(Bl,{error:n,onDismiss:l}),!o&&x&&u.jsx("div",{className:"py-2",children:u.jsx(zl,{value:d,onChange:h,placeholder:"Search",inputClassName:"bg-white"})}),o?u.jsx("div",{className:"flex items-center justify-center py-8",children:u.jsx($p,{})}):x?y.length===0?u.jsx("p",{className:"text-gray-500 text-center py-8",children:"No matching templates"}):u.jsx("div",{className:"space-y-4 overflow-y-auto flex-1",children:y.map(([v,C])=>u.jsxs("div",{children:[u.jsx("h4",{className:"text-sm font-semibold text-gray-600 mb-2",children:v}),u.jsx("div",{className:"space-y-2",children:C.map(N=>u.jsxs("button",{onClick:()=>c(v,N),className:`w-full flex items-center gap-3 px-4 py-3 bg-white border border-gray-200
                               rounded-xl text-left hover:bg-gray-50 min-h-[56px]`,children:[u.jsx(ox,{className:"w-5 h-5 text-gray-600"}),u.jsx("span",{className:"font-medium text-gray-900 truncate",children:N.replace(/\.json$/,"")})]},N))})]},v))}):u.jsx("p",{className:"text-gray-500 text-center py-8",children:"No templates available"})]})}function zS(n){const o=new Date,s=new Date(n*1e3),a=o.getTime()-s.getTime(),l=Math.floor(a/(1e3*60*60*24)),c=String(s.getMonth()+1),d=String(s.getDate()),h=String(s.getFullYear()).slice(-2),p=`${c}/${d}/${h}`;return l===0?`${p} (Today)`:l===1?`${p} (Yesterday)`:`${p} (${l} days ago)`}function HS({error:n,loading:o,userWorkflows:s,onBack:a,onDismissError:l,onLoadWorkflow:c}){const[d,h]=b.useState(""),[p,m]=b.useState("name"),y=s.filter(v=>v.name.toLowerCase().includes(d.toLowerCase())).sort((v,C)=>p==="name"?v.name.localeCompare(C.name):(C.modified??0)-(v.modified??0)),x=u.jsxs("button",{onClick:()=>m(p==="name"?"date":"name"),className:"flex items-center gap-0.5 text-xs font-semibold text-blue-500",children:[u.jsx("span",{children:p==="name"?"NAME":"DATE"}),u.jsx("span",{children:""})]});return u.jsxs("div",{className:"flex flex-col h-full",children:[u.jsx(Dl,{title:"My Workflows",onBack:a,rightElement:x}),u.jsx(Bl,{error:n,onDismiss:l}),!o&&s.length>0&&u.jsx("div",{className:"py-2",children:u.jsx(zl,{value:d,onChange:h,placeholder:"Search",inputClassName:"bg-white"})}),o?u.jsx("div",{className:"flex items-center justify-center py-8",children:u.jsx($p,{})}):s.length===0?u.jsx("p",{className:"text-gray-500 text-center py-8",children:"No saved workflows yet"}):y.length===0?u.jsx("p",{className:"text-gray-500 text-center py-8",children:"No matching workflows"}):u.jsx("div",{className:"space-y-2 overflow-y-auto flex-1",children:y.map(v=>u.jsxs("button",{onClick:()=>c(v.name),className:`w-full flex items-center gap-3 px-4 py-3 bg-white border border-gray-200
                         rounded-xl text-left hover:bg-gray-50 min-h-[56px]`,children:[u.jsx(Cs,{className:"w-5 h-5 text-gray-600"}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("p",{className:"font-medium text-gray-900 truncate",children:v.name.replace(/\.json$/,"")}),v.modified&&u.jsx("p",{className:"text-xs text-gray-500",children:zS(v.modified)})]})]},v.path))})]})}const ga=bo()(Sr(n=>({theme:"dark",setTheme:o=>{n({theme:o})},toggleTheme:()=>{n(o=>({theme:o.theme==="dark"?"light":"dark"}))}}),{name:"theme-storage",storage:wr(()=>localStorage)}));function VS({open:n,onClose:o}){const s=fe(Ee=>Ee.loadWorkflow),a=fe(Ee=>Ee.workflow),l=fe(Ee=>Ee.currentFilename),c=fe(Ee=>Ee.originalWorkflow),d=fe(Ee=>Ee.setSavedWorkflow),h=ga(Ee=>Ee.theme),p=ga(Ee=>Ee.toggleTheme),m=b.useRef(null),y=!!(a&&c&&JSON.stringify(a)!==JSON.stringify(c)),x=b.useRef(null),[v,C]=b.useState(null),[N,w]=b.useState("menu"),[j,k]=b.useState([]),[O,R]=b.useState({}),[D,I]=b.useState(!1),[H,A]=b.useState(l||""),[V,J]=b.useState(""),[X,re]=b.useState({load:!0,save:!0,appearance:!0,info:!0}),te=b.useRef(null),me=b.useRef(null),Te=b.useRef(null),F=b.useRef(null),_=b.useRef(X);b.useEffect(()=>{const Ee=_.current,xe=X;!Ee.load&&xe.load?setTimeout(()=>te.current?.scrollIntoView({behavior:"smooth",block:"nearest"}),100):!Ee.save&&xe.save?setTimeout(()=>me.current?.scrollIntoView({behavior:"smooth",block:"nearest"}),100):!Ee.appearance&&xe.appearance?setTimeout(()=>Te.current?.scrollIntoView({behavior:"smooth",block:"nearest"}),100):!Ee.info&&xe.info&&setTimeout(()=>F.current?.scrollIntoView({behavior:"smooth",block:"nearest"}),100),_.current=xe},[X]),b.useEffect(()=>{n||(w("menu"),C(null),A(l||""),J(""),re({load:!0,save:!0,appearance:!0,info:!0}))},[n,l]),b.useEffect(()=>{N==="userWorkflows"&&(I(!0),Gw().then(k).catch(Ee=>C(Ee.message)).finally(()=>I(!1)))},[N]),b.useEffect(()=>{N==="templates"&&(I(!0),Pw().then(R).catch(Ee=>C(Ee.message)).finally(()=>I(!1)))},[N]);const q=Ee=>{"vibrate"in navigator&&navigator.vibrate(Ee)},de=()=>{x.current?.click()},Me=async Ee=>{const xe=Ee.target.files?.[0];if(xe){try{const se=await xe.text(),Z=JSON.parse(se);if(!Z.nodes||!Array.isArray(Z.nodes))throw new Error("Invalid workflow: missing nodes array");s(Z,xe.name),C(null),o(),q(10)}catch(se){C(se instanceof Error?se.message:"Failed to load workflow")}x.current&&(x.current.value="")}},Ne=async Ee=>{try{I(!0);const xe=await Tp(Ee);s(xe,Ee,{fresh:!0,source:{type:"user",filename:Ee}}),C(null),o(),q(10)}catch(xe){C(xe instanceof Error?xe.message:"Failed to load workflow")}finally{I(!1)}},M=async(Ee,xe)=>{try{I(!0);const se=await Ep(Ee,xe);s(se,`${Ee}/${xe}`,{fresh:!0,source:{type:"template",moduleName:Ee,templateName:xe}}),C(null),o(),q(10)}catch(se){C(se instanceof Error?se.message:"Failed to load template")}finally{I(!1)}},L=async Ee=>{if(!a)return;const xe=Ee.endsWith(".json")?Ee:`${Ee}.json`;try{I(!0),await Hb(xe,Bu(a)),d(a,xe),C(null),o(),q(10)}catch(se){C(se instanceof Error?se.message:"Failed to save workflow")}finally{I(!1)}},K=()=>{l?L(l):w("save")},je=()=>{A(l||""),w("save")},We=()=>{H.trim()?L(H):C("Please enter a filename.")},Re=()=>{if(!a)return;const Ee=JSON.stringify(Bu(a),null,2),xe=new Blob([Ee],{type:"application/json"}),se=URL.createObjectURL(xe),Z=document.createElement("a");Z.href=se,Z.download=`${l||`workflow-${Date.now()}`}.json`,Z.click(),URL.revokeObjectURL(se),q(10),o()},Se=()=>{try{const Ee=JSON.parse(V);if(!Ee.nodes||!Array.isArray(Ee.nodes))throw new Error("Invalid workflow: missing nodes array");const xe=new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"});s(Ee,`Pasted workflow (${xe})`),C(null),o(),q(10),J("")}catch(Ee){C(Ee instanceof Error?Ee.message:"Failed to parse JSON")}};return u.jsxs(X2,{open:n,onClose:o,side:"left",title:"ComfyUI Mobile",children:[N==="menu"&&u.jsx(ES,{error:v,workflow:a,currentFilename:l,isDirty:y,loading:D,theme:h,menuSectionsOpen:X,fileInputRef:x,loadSectionRef:te,saveSectionRef:me,appearanceSectionRef:Te,infoSectionRef:F,onDismissError:()=>C(null),onFileChange:Me,onLoadFromFile:de,onToggleSection:Ee=>re(xe=>({...xe,[Ee]:!xe[Ee]})),onOpenUserWorkflows:()=>w("userWorkflows"),onOpenTemplates:()=>w("templates"),onOpenPasteJson:()=>w("pasteJson"),onSave:K,onOpenSaveAs:je,onToggleTheme:p,onOpenLegend:()=>w("aboutLegend")}),N==="userWorkflows"&&u.jsx(HS,{error:v,loading:D,userWorkflows:j,onBack:()=>w("menu"),onDismissError:()=>C(null),onLoadWorkflow:Ne}),N==="templates"&&u.jsx(BS,{error:v,loading:D,templates:O,onBack:()=>w("menu"),onDismissError:()=>C(null),onLoadTemplate:M}),N==="save"&&u.jsx(AS,{error:v,loading:D,workflow:a,saveFilenameInput:H,onBack:()=>w("menu"),onDismissError:()=>C(null),onSaveFilenameChange:A,onSaveAs:We,onDownload:Re}),N==="pasteJson"&&u.jsx(_S,{error:v,pastedJson:V,pasteTextareaRef:m,onBack:()=>w("menu"),onDismissError:()=>C(null),onChangeJson:J,onLoad:Se}),N==="aboutLegend"&&u.jsx(TS,{onBack:()=>w("menu")})]})}function ya({open:n,onDismiss:o,triggerRef:s,contentRef:a,ignoreScrollWithinContent:l=!1}){b.useEffect(()=>{if(!n)return;const c=h=>{const p=h.target;s.current&&p&&s.current.contains(p)||a.current&&p&&a.current.contains(p)||o()},d=h=>{if(l){const p=h.target;if(a.current&&p&&a.current.contains(p))return}o()};return document.addEventListener("mousedown",c),document.addEventListener("scroll",d,!0),()=>{document.removeEventListener("mousedown",c),document.removeEventListener("scroll",d,!0)}},[n,o,s,a,l])}function Yo({onClose:n,title:o,description:s,actions:a,actionsLayout:l="inline",zIndex:c=2200}){const d=h=>h==="danger"?"px-3 py-2 rounded-lg text-sm font-medium text-white bg-red-600 hover:bg-red-700":h==="primary"?"px-3 py-2 rounded-lg text-sm font-medium text-white bg-blue-600 hover:bg-blue-700":"px-3 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-100";return u.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4",style:{zIndex:c},onClick:n,role:"dialog","aria-modal":"true",children:u.jsxs("div",{className:"w-full max-w-sm bg-white border border-gray-200 rounded-xl shadow-lg p-4",onClick:h=>h.stopPropagation(),children:[u.jsx("div",{className:"text-gray-900 text-base font-semibold",children:o}),s&&u.jsx("div",{className:"text-gray-600 text-sm mt-1",children:s}),u.jsx("div",{className:l==="stack"?"mt-4 flex flex-col gap-2":"mt-4 flex justify-end gap-2",children:a.map(h=>u.jsx("button",{className:`${d(h.variant)} ${h.className??""}`.trim(),onClick:h.onClick,children:h.label},h.label))})]})})}function Qr({onClick:n,ariaLabel:o,buttonRef:s,icon:a,buttonSize:l=10,iconSize:c=5}){return u.jsx("button",{type:"button",onClick:n,"aria-label":o,className:`w-${l} h-${l} flex items-center justify-center rounded-lg bg-transparent hover:bg-transparent text-inherit`,ref:s,children:a??u.jsx(rS,{className:`w-${c} h-${c}`})})}const $S={default:{row:"text-gray-900 hover:bg-gray-50",icon:"text-gray-500"},muted:{row:"text-gray-600 hover:bg-gray-50",icon:"text-gray-500"},danger:{row:"text-red-600 hover:bg-red-50",icon:"text-red-500"},primary:{row:"text-blue-600 hover:bg-blue-50",icon:"text-blue-500"}};function xr({items:n,className:o,itemClassName:s}){return u.jsx("div",{className:`bg-white border border-gray-200 rounded-lg shadow-lg overflow-hidden ${o??""}`.trim(),children:n.map(a=>{if(a.type==="divider")return u.jsx("div",{className:`border-t border-gray-200 my-1 ${a.className??""}`.trim()},a.key);if(a.type==="custom")return a.hidden?null:u.jsx("div",{children:typeof a.render=="function"?a.render():a.render},a.key);if(a.hidden)return null;const l=$S[a.color??"default"];return u.jsxs("button",{type:"button",className:["w-full flex items-center gap-2 text-left px-3 py-2 text-sm",a.rightSlot?"justify-between":"",l.row,a.disabled?"opacity-50 cursor-not-allowed":"",s??"",a.className??""].join(" ").trim(),onClick:a.onClick,disabled:a.disabled,children:[u.jsxs("span",{className:"flex items-center gap-2 min-w-0",children:[a.icon?u.jsx("span",{className:l.icon,children:a.icon}):null,u.jsx("span",{className:"truncate",children:a.label})]}),a.rightSlot?u.jsx("span",{className:"shrink-0",children:a.rightSlot}):null]},a.key)})})}function KS({open:n,buttonRef:o,menuRef:s,onToggle:a,onClose:l,onGoToWorkflow:c,onOpenClearHistoryConfirm:d}){const h=Ht(L=>L.setQueueItemExpanded),p=Ht(L=>L.queueItemExpanded),m=Ht(L=>L.showQueueMetadata),y=Ht(L=>L.toggleShowQueueMetadata),x=Ht(L=>L.previewVisibility),v=Ht(L=>L.setPreviewVisibility),C=Ht(L=>L.previewVisibilityDefault),N=Ht(L=>L.setPreviewVisibilityDefault),w=Ht(L=>L.pending),j=Ht(L=>L.running),k=Ht(L=>L.clearQueue),O=Yn(L=>L.history),R=Yn(L=>L.clearEmptyItems),D=w.length>0,I=O.length>0,H=O.some(L=>L.outputs.images.length===0),A=w.length+j.length+O.length>0,V=b.useMemo(()=>{const L=new Set;return w.forEach(K=>L.add(K.prompt_id)),j.forEach(K=>L.add(K.prompt_id)),O.forEach(K=>{K.prompt_id&&L.add(String(K.prompt_id))}),Array.from(L)},[w,j,O]),J=b.useMemo(()=>V.some(L=>p[L]===!1),[V,p]),X=b.useMemo(()=>V.some(L=>p[L]!==!1),[V,p]),re=b.useMemo(()=>{const L=new Set;return O.forEach(K=>{(K.outputs?.images??[]).some(Re=>Re.type!=="output")&&K.prompt_id&&L.add(String(K.prompt_id))}),Array.from(L)},[O]),te=A||re.length>0||C,me=re.length>0?re.every(L=>x[L]??C):C,Te=()=>{c(),l()},F=async()=>{await k(),l()},_=()=>{V.forEach(L=>h(L,!1)),l()},q=()=>{V.forEach(L=>h(L,!0)),l()},de=()=>{y(),l()},Me=()=>{const L=!me;N(L),re.forEach(K=>v(K,L)),l()},Ne=async()=>{await R(),l()},M=()=>{l(),d()};return u.jsxs("div",{id:"queue-menu-container",className:"relative",children:[u.jsx(Qr,{buttonRef:o,onClick:a,ariaLabel:"Queue options"}),n?u.jsx("div",{id:"queue-options-dropdown",ref:s,className:"absolute right-0 top-11 z-50 w-48",children:u.jsx(xr,{items:[{key:"go-to-workflow",label:"Go to workflow",icon:u.jsx(Vu,{className:"w-3 h-3 rotate-180"}),onClick:Te},{key:"cancel-pending",label:"Cancel all pending",icon:u.jsx(lS,{className:"w-4 h-4"}),onClick:F,hidden:!D},{key:"fold-all",label:"Fold all",icon:u.jsx(ws,{className:"w-7 h-7 -ml-1"}),onClick:_,hidden:!X},{key:"unfold-all",label:"Unfold all",icon:u.jsx(no,{className:"w-7 h-7 -ml-1"}),onClick:q,hidden:!J},{key:"toggle-metadata",label:m?"Hide metadata":"Show metadata",icon:u.jsx(Qb,{className:"w-4 h-4"}),onClick:de,hidden:!I},{key:"toggle-previews",label:me?"Hide previews":"Show previews",icon:me?u.jsx(Po,{className:"w-4 h-4"}):u.jsx(gr,{className:"w-4 h-4"}),onClick:Me,hidden:!te},{key:"clear-empty",label:"Clear empty items",icon:u.jsx(Ho,{className:"w-4 h-4"}),onClick:Ne,color:"muted",hidden:!H},{key:"clear-history",label:"Clear history",icon:u.jsx(Ho,{className:"w-4 h-4"}),onClick:M,color:"danger",hidden:!I}]})}):null]})}function US(){const[n,o]=b.useState(!1),[s,a]=b.useState(!1),l=oo(p=>p.setCurrentPanel),c=Yn(p=>p.clearHistory),d=b.useRef(null),h=b.useRef(null);return ya({open:n,onDismiss:()=>o(!1),triggerRef:d,contentRef:h}),u.jsxs(u.Fragment,{children:[u.jsx(KS,{open:n,buttonRef:d,menuRef:h,onToggle:()=>o(p=>!p),onClose:()=>o(!1),onGoToWorkflow:()=>l("workflow"),onOpenClearHistoryConfirm:()=>a(!0)}),s&&_n.createPortal(u.jsx(Yo,{onClose:()=>a(!1),title:"Clear history?",description:"This will permanently remove all completed generations from history. Generated files will still be present in your server's output folder.",actions:[{label:"Cancel",onClick:()=>a(!1),variant:"secondary"},{label:"Clear history",onClick:()=>{(async()=>(await c(),a(!1)))()},variant:"danger"}]}),document.body)]})}function WS({open:n,buttonRef:o,menuRef:s,onToggle:a,onClose:l,onGoToWorkflow:c}){const d=Xt(D=>D.source),h=Xt(D=>D.viewMode),p=Xt(D=>D.showHidden),m=Xt(D=>D.setSource),y=Xt(D=>D.setViewMode),x=Xt(D=>D.toggleShowHidden),v=Xt(D=>D.toggleSelectionMode),C=Xt(D=>D.setNewFolderModalOpen),N=()=>{C(!0),l()},w=()=>{m(d==="output"?"input":"output"),l()},j=()=>{c(),l()},k=()=>{v(),l()},O=()=>{x(),l()},R=()=>{y(h==="grid"?"list":"grid"),l()};return u.jsxs("div",{id:"outputs-topbar-actions",className:"relative flex items-center gap-1",children:[u.jsx(Qr,{buttonRef:o,onClick:a,ariaLabel:"Outputs options"}),n?u.jsx("div",{id:"outputs-options-dropdown",ref:s,className:"absolute right-0 top-11 z-50 w-48",children:u.jsx(xr,{items:[{key:"toggle-source",label:d==="output"?"Switch to inputs":"Switch to outputs",icon:u.jsx(zp,{className:"w-4 h-4"}),onClick:w},{key:"go-to-workflow",label:"Go to workflow",icon:u.jsx(Vu,{className:"w-3 h-3"}),onClick:j},{key:"select",label:"Select",icon:u.jsx(zo,{className:"w-4 h-4"}),onClick:k},{key:"new-folder",label:"New folder",icon:u.jsx(mr,{className:"w-4 h-4"}),onClick:N},{key:"toggle-hidden",label:p?"Hide hidden files":"Show hidden files",icon:p?u.jsx(Po,{className:"w-4 h-4"}):u.jsx(gr,{className:"w-4 h-4"}),onClick:O},{key:"toggle-view",label:h==="grid"?"List view":"Grid view",icon:h==="grid"?u.jsx(tS,{className:"w-4 h-4"}):u.jsx(gS,{className:"w-4 h-4"}),onClick:R}]})}):null]})}function FS(){const[n,o]=b.useState(!1),s=oo(c=>c.setCurrentPanel),a=b.useRef(null),l=b.useRef(null);return ya({open:n,onDismiss:()=>o(!1),triggerRef:a,contentRef:l}),u.jsx(WS,{open:n,buttonRef:a,menuRef:l,onToggle:()=>o(c=>!c),onClose:()=>o(!1),onGoToWorkflow:()=>s("workflow")})}const qS=5;function GS(n){const o={};for(const s of n)o[s.id]={mode:s.mode,flags:s.flags?{collapsed:!!s.flags.collapsed}:void 0,widgets_values:s.widgets_values};return o}function PS(n,o,s,a){return{nodes:GS(n.nodes),seedModes:{...o},collapsedItems:{...s},hiddenItems:{...a}}}function Ny(n,o){if(n===o)return!0;if(n.length!==o.length)return!1;for(let s=0;s<n.length;s+=1)if(n[s]!==o[s])return!1;return!0}function Cy(n){const{workflow:o}=fe.getState();if(!o)return[];const s=new Set;for(const c of o.nodes??[])c.stableKey&&s.add(c.stableKey);for(const c of o.groups??[])c.stableKey&&s.add(c.stableKey);for(const c of o.definitions?.subgraphs??[]){c.stableKey&&s.add(c.stableKey);for(const d of c.groups??[])d.stableKey&&s.add(d.stableKey)}const a=[],l=new Set;for(const c of n)!c||l.has(c)||s.has(c)&&(l.add(c),a.push(c));return a}const Pn=bo()(Sr((n,o)=>({bookmarkedItems:[],bookmarkBarSide:"right",bookmarkBarTop:null,bookmarkRepositioningActive:!1,toggleBookmark:s=>{if(!s)return;const{bookmarkedItems:a}=o(),{currentWorkflowKey:l,savedWorkflowStates:c,workflow:d,collapsedItems:h,hiddenItems:p}=fe.getState(),m=Gn.getState().seedModes,x=a.includes(s)?a.filter(v=>v!==s):a.length>=qS?a:[...a,s];if(x!==a){if(l){let C=c[l];!C&&d&&(C=PS(d,m,h,p)),C&&fe.setState({savedWorkflowStates:{...c,[l]:{...C,bookmarkedItems:[...x]}}})}n({bookmarkedItems:x})}},clearBookmarks:()=>{const{currentWorkflowKey:s,savedWorkflowStates:a}=fe.getState();if(s&&a[s]){const l=a[s];fe.setState({savedWorkflowStates:{...a,[s]:{...l,bookmarkedItems:[]}}})}n({bookmarkedItems:[]})},setBookmarkBarPosition:s=>{n(a=>({bookmarkBarSide:s.side??a.bookmarkBarSide,bookmarkBarTop:s.top??a.bookmarkBarTop}))},setBookmarkRepositioningActive:s=>{n({bookmarkRepositioningActive:s})}}),{name:"bookmark-bar-storage",storage:wr(()=>localStorage),partialize:n=>({bookmarkBarSide:n.bookmarkBarSide,bookmarkBarTop:n.bookmarkBarTop})}));function YS(){const{workflow:n,currentWorkflowKey:o,savedWorkflowStates:s}=fe.getState(),{bookmarkedItems:a}=Pn.getState();if(!n){a.length>0&&Pn.setState({bookmarkedItems:[]});return}if(!o){const d=Cy(a);Ny(a,d)||Pn.setState({bookmarkedItems:d});return}const l=s[o],c=Cy(l?.bookmarkedItems??[]);Ny(a,c)||Pn.setState({bookmarkedItems:c})}fe.subscribe(()=>{YS()});function QS({open:n,buttonRef:o,menuRef:s,onToggle:a,onClose:l,onGoToQueue:c,onGoToOutputs:d,onAddNode:h,onOpenWorkflowActions:p}){const m=fe(U=>U.workflow),y=fe(U=>U.nodeTypes),x=fe(U=>U.setItemCollapsed),v=fe(U=>U.setItemHidden),C=fe(U=>U.showAllHiddenNodes),N=fe(U=>U.hiddenItems),w=Pn(U=>U.bookmarkedItems),j=Pn(U=>U.clearBookmarks),k=fe(U=>U.collapsedItems),O=fe(U=>U.workflowSource),R=fe(U=>U.loadWorkflow),D=fe(U=>U.searchOpen),I=fe(U=>U.setSearchOpen),H=fe(U=>U.setSearchQuery),A=fe(U=>U.connectionButtonsVisible),V=fe(U=>U.toggleConnectionButtonsVisible),J=Yn(U=>U.history),X=b.useCallback((U,ce)=>!!U[ce],[]),re=!!m,te=b.useMemo(()=>m?.nodes.map(U=>U.stableKey??null).filter(U=>U!=null)??[],[m]),me=b.useMemo(()=>[...m?.groups??[],...(m?.definitions?.subgraphs??[]).flatMap(ce=>ce.groups??[])].map(ce=>ce.stableKey??null).filter(ce=>ce!=null),[m]),Te=b.useMemo(()=>(m?.definitions?.subgraphs?.map(U=>U.stableKey??null)??[]).filter(U=>U!=null),[m]),F=b.useMemo(()=>m?.nodes.filter(U=>U.mode===4)??[],[m]),_=b.useMemo(()=>!m||!y?[]:m.nodes.filter(U=>{if(U.type==="Fast Groups Bypasser (rgthree)")return!1;const ce=_p(y,U).filter(Ve=>!Ve.connected),He=Ap(y,U).filter(Ve=>!Ve.connected);return ce.length===0&&He.length===0}),[m,y]),q=F.length,de=_.length,Me=b.useMemo(()=>Object.values(N).filter(Boolean).length,[N]),Ne=b.useMemo(()=>F.filter(U=>(()=>{const ce=U.stableKey;return ce?N[ce]:!1})()).length,[F,N]),M=b.useMemo(()=>_.filter(U=>(()=>{const ce=U.stableKey;return ce?N[ce]:!1})()).length,[_,N]),L=b.useMemo(()=>m?m.nodes.filter(U=>(()=>{const ce=U.stableKey;return ce?!N[ce]:!0})()):[],[m,N]),K=b.useMemo(()=>L.some(U=>{const ce=U.stableKey??null;return ce?k[ce]===!0:!1}),[k,L]),je=b.useMemo(()=>L.some(U=>{const ce=U.stableKey??null;return ce?k[ce]!==!0:!0}),[k,L]),We=b.useMemo(()=>me.some(U=>k[U]===!0),[me,k]),Re=b.useMemo(()=>me.some(U=>(k[U]??!1)===!1),[me,k]),Se=b.useMemo(()=>Te.some(U=>k[U]??!1),[Te,k]),Ee=b.useMemo(()=>Te.some(U=>(k[U]??!1)===!1),[Te,k]),xe=K||We||Se,se=je||Re||Ee,Z=b.useMemo(()=>Me>0||me.some(ce=>X(N,ce))?!0:Te.some(ce=>N[ce]===!0),[Me,N,me,Te,X]),[T,ie]=b.useState(!1),G=()=>{l()},ge=()=>{c(),G()},B=()=>{d(),G()},ne=()=>{H(""),I(!0),G()},W=()=>{h(),G()},P=()=>{te.forEach(U=>x(U,!0)),me.forEach(U=>x(U,!0)),Te.forEach(U=>x(U,!0)),G()},z=()=>{te.forEach(U=>x(U,!1)),me.forEach(U=>x(U,!1)),Te.forEach(U=>x(U,!1)),G()},$=()=>{C(),me.forEach(U=>v(U,!1)),Te.forEach(U=>v(U,!1))},ee=()=>{j(),G()},pe=async()=>{if(!(!O||O.type!=="user")){try{const U=await Tp(O.filename);R(U,O.filename,{fresh:!0,source:O})}catch(U){console.error("Failed to reload workflow:",U)}G()}},ae=async()=>{if(!(!O||O.type!=="template")){try{const U=await Ep(O.moduleName,O.templateName);R(U,`${O.moduleName}/${O.templateName}`,{fresh:!0,source:O})}catch(U){console.error("Failed to reload template:",U)}G()}},ke=()=>{if(!O||O.type!=="history")return;const U=J.find(ce=>ce.prompt_id===O.promptId);U?.workflow&&R(U.workflow,`history-${O.promptId}.json`,{source:O}),G()};return u.jsxs("div",{id:"workflow-menu-container",className:"relative",children:[u.jsx(Qr,{buttonRef:o,onClick:a,ariaLabel:"Workflow options"}),n?u.jsx("div",{id:"workflow-options-dropdown",ref:s,className:"absolute right-0 top-11 z-50 w-52",children:u.jsx(xr,{items:[{key:"go-to-queue",label:"Go to queue",icon:u.jsx(Vu,{className:"w-3 h-3"}),onClick:ge},{key:"go-to-outputs",label:"Go to outputs",icon:u.jsx(Vu,{className:"w-3 h-3 rotate-180"}),onClick:B},{key:"search",label:"Search",icon:u.jsx(Jb,{className:"w-4 h-4"}),onClick:ne,hidden:D},{key:"add-node",label:"Add node",icon:u.jsx(Eo,{className:"w-4 h-4"}),onClick:W,hidden:!re},{key:"hide-show",label:"Hide / Show",icon:u.jsx(gr,{className:"w-4 h-4"}),onClick:()=>{ie(!0),G()}},{key:"fold-all",label:"Fold all",icon:u.jsx(ws,{className:"w-6 h-6 -ml-1"}),onClick:P,hidden:!se},{key:"unfold-all",label:"Unfold all",icon:u.jsx(no,{className:"w-6 h-6 -ml-1"}),onClick:z,hidden:!xe},{key:"clear-bookmarks",label:"Clear bookmarks",icon:u.jsx(Ho,{className:"w-4 h-4"}),onClick:ee,hidden:w.length===0},{key:"reload-workflow",label:"Reload workflow",icon:u.jsx(zp,{className:"w-4 h-4"}),onClick:O?.type==="user"?pe:O?.type==="template"?ae:O?.type==="history"&&J.find(U=>U.prompt_id===O.promptId)?.workflow?ke:void 0,hidden:!O||O.type==="history"&&!J.find(U=>U.prompt_id===O.promptId)?.workflow},{key:"workflow-actions",label:"Workflow actions",icon:u.jsx(Cs,{className:"w-4 h-4"}),onClick:()=>{p(),G()}}]})}):null,T&&u.jsx("div",{className:"fixed inset-0 z-[2150] bg-black/50 flex items-center justify-center p-4",onClick:()=>ie(!1),role:"dialog","aria-modal":"true",children:u.jsxs("div",{className:"w-full max-w-sm bg-white border border-gray-200 rounded-xl shadow-lg overflow-hidden",onClick:U=>U.stopPropagation(),children:[u.jsx("div",{className:"px-4 py-3 text-sm font-semibold text-gray-700 border-b border-gray-100",children:"Hide / Show"}),u.jsx("div",{className:"max-h-[50vh] overflow-y-auto",children:u.jsx(xr,{itemClassName:"px-4 py-3",items:[{key:"static-nodes",label:M<de?`Hide static nodes (${de})`:`Show static nodes (${de})`,icon:M<de?u.jsx(Po,{className:"w-4 h-4"}):u.jsx(gr,{className:"w-4 h-4"}),onClick:()=>{M<de?_.forEach(U=>{const ce=U.stableKey??null;ce&&v(ce,!0)}):_.forEach(U=>{const ce=U.stableKey??null;ce&&v(ce,!1)})},hidden:de===0},{key:"bypassed-nodes",label:Ne>0?`Show bypassed nodes (${q})`:`Hide bypassed nodes (${q})`,icon:Ne>0?u.jsx(gr,{className:"w-4 h-4"}):u.jsx(Po,{className:"w-4 h-4"}),onClick:()=>{Ne>0?F.forEach(U=>{const ce=U.stableKey??null;ce&&v(ce,!1)}):F.forEach(U=>{const ce=U.stableKey??null;ce&&v(ce,!0)})},hidden:q===0},{key:"toggle-connection-buttons",label:A?"Hide connection buttons":"Show connection buttons",icon:A?u.jsx(Po,{className:"w-4 h-4"}):u.jsx(gr,{className:"w-4 h-4"}),onClick:V},{key:"show-all-hidden",label:"Show all hidden nodes",icon:u.jsx(gr,{className:"w-4 h-4"}),onClick:$,hidden:!Z}]})}),u.jsx("div",{className:"px-4 py-3 border-t border-gray-100 flex justify-end",children:u.jsx("button",{className:"px-3 py-2 text-sm font-medium text-gray-600 hover:bg-gray-100 rounded-lg",onClick:()=>ie(!1),children:"Cancel"})})]})})]})}function oa({icon:n,label:o,onClick:s,disabled:a,description:l,tone:c="default"}){const d=c==="danger";return u.jsxs("button",{className:`w-full flex items-start gap-3 text-left px-4 py-3 disabled:opacity-50 ${d?"text-red-600 hover:bg-red-50":"hover:bg-gray-50"}`,onClick:s,disabled:a,children:[u.jsx("span",{className:"shrink-0 self-start mt-[3px]",children:n}),u.jsxs("span",{className:"flex flex-col min-w-0",children:[u.jsx("span",{className:`text-sm ${d?"text-red-600":"text-gray-900"}`,children:o}),l?u.jsx("span",{className:"text-xs text-gray-500",children:l}):null]})]})}function XS(){const[n,o]=b.useState(null),[s,a]=b.useState(null),[l,c]=b.useState(!1),[d,h]=b.useState(!1),[p,m]=b.useState(""),[y,x]=b.useState(null),[v,C]=b.useState(!1),N=fe(M=>M.workflow),w=fe(M=>M.originalWorkflow),j=fe(M=>M.currentFilename),k=fe(M=>M.workflowSource),O=fe(M=>M.loadWorkflow),R=fe(M=>M.setSavedWorkflow),D=fe(M=>M.clearWorkflowCache),I=fe(M=>M.unloadWorkflow),H=fe(M=>M.requestAddNodeModal),A=oo(M=>M.setCurrentPanel),V=fe(M=>M.workflowLoadedAt),J=Yn(M=>M.history),X=b.useRef(null),re=b.useRef(null),te=n!==null&&n===V,me=b.useMemo(()=>!!(N&&w&&JSON.stringify(N)!==JSON.stringify(w)),[N,w]);ya({open:te,onDismiss:()=>o(null),triggerRef:X,contentRef:re});const Te=async()=>{if(localStorage.clear(),sessionStorage.clear(),"caches"in window){const M=await caches.keys();await Promise.all(M.map(L=>caches.delete(L)))}document.cookie.split(";").forEach(M=>{const[L]=M.split("=");document.cookie=`${L.trim()}=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/`}),window.location.reload()},F=async M=>{if(!N)return;const L=M.endsWith(".json")?M:`${M}.json`;try{C(!0),await Hb(L,Bu(N)),R(N,L),x(null),h(!1),c(!1)}catch(K){x(K instanceof Error?K.message:"Failed to save workflow")}finally{C(!1)}},_=async()=>{if(!k){w&&O(w,j??void 0,{fresh:!0,source:{type:"other"}});return}if(k.type==="user"){const M=await Tp(k.filename);O(M,k.filename,{fresh:!0,source:k});return}if(k.type==="template"){const M=await Ep(k.moduleName,k.templateName);O(M,`${k.moduleName}/${k.templateName}`,{fresh:!0,source:k});return}if(k.type==="history"){const M=J.find(L=>L.prompt_id===k.promptId);M?.workflow&&O(M.workflow,`history-${k.promptId}.json`,{fresh:!0,source:k});return}w&&O(w,j??void 0,{fresh:!0,source:k})},q=M=>{if(me){a(M);return}M==="unload"?I():M==="clearWorkflowCache"?D():M==="clearAllCache"?Te():_(),c(!1)},de=async M=>{a(null);try{C(!0),M==="unload"?I():M==="clearWorkflowCache"?D():M==="clearAllCache"?await Te():await _(),c(!1)}catch(L){x(L instanceof Error?L.message:"Failed to complete action")}finally{C(!1)}},Me=()=>{o(null),x(null),c(!0)},Ne=()=>{H({groupId:null,subgraphId:null})};return u.jsxs(u.Fragment,{children:[u.jsx(QS,{open:te,buttonRef:X,menuRef:re,onToggle:()=>o(te?null:V),onClose:()=>o(null),onGoToQueue:()=>A("queue"),onGoToOutputs:()=>A("outputs"),onAddNode:Ne,onOpenWorkflowActions:Me}),l&&u.jsx("div",{className:"fixed inset-0 z-[1450] bg-black/50 flex items-center justify-center p-4",onClick:()=>c(!1),role:"dialog","aria-modal":"true",children:u.jsxs("div",{className:"w-full max-w-sm bg-white border border-gray-200 rounded-xl shadow-lg overflow-hidden",onClick:M=>M.stopPropagation(),children:[u.jsx("div",{className:"px-4 py-3 text-sm font-semibold text-gray-700 border-b border-gray-100",children:"Workflow actions"}),y&&u.jsx("div",{className:"px-4 py-2 text-sm text-red-700 bg-red-50 border-b border-red-100",children:y}),u.jsxs("div",{className:"max-h-[60vh] overflow-y-auto",children:[u.jsx(oa,{icon:u.jsx(rx,{className:"w-4 h-4 text-gray-500"}),label:"Save",onClick:()=>{if(N){if(!j){m(j??""),h(!0);return}F(j)}},disabled:!N||!me||v}),u.jsx(oa,{icon:u.jsx(sx,{className:"w-4 h-4 text-gray-500"}),label:"Save as",onClick:()=>{m(j??""),h(!0)},disabled:!N||v}),me&&u.jsx(oa,{icon:u.jsx(zp,{className:"w-4 h-4 text-red-500"}),label:"Discard changes",tone:"danger",onClick:()=>q("discardChanges"),disabled:v}),u.jsx("div",{className:"border-t border-gray-200"}),u.jsx(oa,{icon:u.jsx(Ho,{className:"w-5 h-5 text-gray-500"}),label:"Clear workflow cache",description:"(hidden nodes, folds, etc.)",onClick:()=>q("clearWorkflowCache"),disabled:!N||v}),u.jsx(oa,{icon:u.jsx(iS,{className:"w-5 h-5 text-red-500"}),label:"Unload workflow",description:"Close the current workflow panel state",tone:"danger",onClick:()=>q("unload"),disabled:!N||v}),u.jsx(oa,{icon:u.jsx(Ho,{className:"w-5 h-5 text-red-500"}),label:"Clear device cache",description:"Reset local storage and reload app",tone:"danger",onClick:()=>q("clearAllCache"),disabled:v})]}),u.jsx("div",{className:"border-t border-gray-100 p-3",children:u.jsx("button",{className:"w-full px-4 py-2.5 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200",onClick:()=>c(!1),children:"Close"})})]})}),d&&u.jsx("div",{className:"fixed inset-0 z-[1460] bg-black/50 flex items-center justify-center p-4",onClick:()=>h(!1),role:"dialog","aria-modal":"true",children:u.jsxs("div",{className:"w-full max-w-sm bg-white border border-gray-200 rounded-xl shadow-lg p-4",onClick:M=>M.stopPropagation(),children:[u.jsx("div",{className:"text-base font-semibold text-gray-900 mb-3",children:"Save as"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"text",value:p,onChange:M=>m(M.target.value),className:"w-full border border-gray-300 rounded-lg px-3 pr-9 py-2 text-sm text-gray-900 focus:outline-none focus:border-2 focus:border-blue-500",placeholder:"workflow.json",autoFocus:!0}),p.length>0&&u.jsx("button",{type:"button",className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700",onClick:()=>m(""),"aria-label":"Clear filename",children:u.jsx(Rl,{className:"w-4 h-4"})})]}),u.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[u.jsx("button",{className:"px-3 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-100",onClick:()=>h(!1),children:"Cancel"}),u.jsx("button",{className:"px-3 py-2 rounded-lg text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 disabled:opacity-50",onClick:()=>{const M=p.trim();if(!M){x("Please enter a filename.");return}F(M)},disabled:!N||v,children:"Save"})]})]})}),s&&_n.createPortal(u.jsx(Yo,{onClose:()=>a(null),title:"Unsaved changes",description:"You have unsaved changes in the current workflow. Continue without saving?",actions:[{label:"Cancel",onClick:()=>a(null),className:"px-3 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-100"},{label:s==="discardChanges"?"Discard changes":"Continue",onClick:()=>{de(s)},className:"px-3 py-2 rounded-lg text-sm font-medium text-white bg-red-600 hover:bg-red-700"}]}),document.body)]})}function ZS({onClick:n}){return u.jsx("button",{type:"button",onClick:n,"aria-label":"Menu",className:"w-10 h-10 flex items-center justify-center rounded-lg text-gray-700 hover:bg-gray-100",children:u.jsx(Hp,{className:"w-6 h-6"})})}function JS({title:n,mode:o,isDirty:s,hasWorkflow:a,nodeCountLabel:l,historyLength:c,pendingLength:d,onTap:h}){return u.jsxs("div",{id:"top-bar-title-container",className:"flex-1 text-center min-w-0 px-2 cursor-pointer",onClick:h,children:[u.jsxs("h1",{id:"top-bar-title",className:"font-semibold text-gray-900 text-lg truncate flex items-center justify-center",children:[u.jsx("span",{className:"truncate",children:n}),o==="workflow"&&s&&u.jsx("span",{id:"dirty-indicator",className:"text-blue-500 ml-1 font-bold",children:"*"})]}),o==="workflow"&&a&&u.jsx("p",{className:"node-count-display text-xs text-gray-500",children:l}),o==="queue"&&u.jsxs("p",{className:"run-count-display text-xs text-gray-500",children:[c," ",c===1?"run":"runs",d>0&&` (${d} pending)`]})]})}function eN(n){return n==="queue"?['[data-queue-list="true"]','[data-node-list="true"]']:['[data-node-list="true"]','[data-queue-list="true"]']}function tN({mode:n="workflow"}){const o=b.useRef(null),s=b.useRef(0),a=tp(k=>k.appMenuOpen),l=tp(k=>k.setAppMenuOpen),c=b.useCallback(()=>{const k=Date.now(),O=k-s.current;if(s.current=k,O<300){if(n==="workflow"){window.dispatchEvent(new Event("workflow-scroll-to-top")),"vibrate"in navigator&&navigator.vibrate(10);return}if(n==="outputs"){const D=document.querySelector("#outputs-content-container");D&&(D.scrollTo({top:0,behavior:"auto"}),"vibrate"in navigator&&navigator.vibrate(10));return}const R=eN(n);for(const D of R){const I=document.querySelector(D);if(I&&I.scrollHeight>0&&!I.closest(".pointer-events-none")){I.scrollTo({top:0,behavior:"smooth"}),"vibrate"in navigator&&navigator.vibrate(10);break}}}},[n]),d=fe(k=>k.workflow),h=fe(k=>k.originalWorkflow),p=fe(k=>k.currentFilename),m=fe(k=>k.hiddenItems),y=Ht(k=>k.pending),x=Yn(k=>k.history),v=Xt(k=>k.source),C=d&&h&&JSON.stringify(d)!==JSON.stringify(h),N=b.useMemo(()=>{if(!d)return"";const k=d.nodes.length,O=Object.keys(m).length,R=Object.values(m).some(Boolean);if(O===0&&!R)return`${k} nodes ${C?"[Unsaved]":""}`.trim();const D=R?d.nodes.reduce((H,A)=>{const J=A.properties?.__mobile_origin;if(!J||typeof J!="object"||J.scope!=="subgraph")return H;const re=J.subgraphId,te=re?d.definitions?.subgraphs?.find(me=>me.id===re)?.stableKey:null;return te&&m[te]?H+1:H},0):0,I=O+D;return`${k} nodes (${I} hidden) ${C?"[Unsaved]":""}`.trim()},[d,m,C]);b.useEffect(()=>{const k=o.current;if(!k)return;const O=()=>{const D=k.getBoundingClientRect();document.documentElement.style.setProperty("--top-bar-offset",`${D.height}px`)};O();const R=new ResizeObserver(O);return R.observe(k),()=>R.disconnect()},[]);const w=b.useMemo(()=>{switch(n){case"queue":return"Queue";case"outputs":return v==="output"?"Outputs":"Inputs";default:return p?p.replace(".json",""):d?"Untitled":"ComfyUI Mobile"}},[n,v,p,d]),j=b.useMemo(()=>{switch(n){case"queue":return u.jsx(US,{});case"outputs":return u.jsx(FS,{});default:return u.jsx(XS,{})}},[n]);return u.jsxs("div",{id:"top-bar-root",ref:o,className:"fixed top-0 left-0 right-0 bg-white border-b border-gray-200 z-[2000] safe-area-top","data-top-bar":"true",children:[u.jsxs("div",{id:"top-bar-content",className:"flex items-center justify-between px-4 py-3",children:[u.jsx(ZS,{onClick:()=>l(!0)}),u.jsx(JS,{title:w,mode:n,isDirty:!!C,hasWorkflow:!!d,nodeCountLabel:N,historyLength:x.length,pendingLength:y.length,onTap:c}),u.jsx("div",{id:"top-bar-right-slot",className:"w-10 h-10 flex items-center justify-center",children:j})]}),u.jsx(VS,{open:a,onClose:()=>l(!1)})]})}function nN(){const n=fe(C=>C.setMobileLayout),o=fe(C=>C.mobileLayout),s=fe(C=>C.prepareRepositionScrollTarget),[a,l]=b.useState(!1),[c,d]=b.useState(null),[h,p]=b.useState(null),m=b.useCallback((C,N)=>{const w=(j,k)=>{for(const O of j){if(O.type==="group"){if(O.id===C&&k===N)return O.stableKey;const R=w(o.groups[O.stableKey]??[],k);if(R)return R;continue}if(O.type==="subgraph"){const R=w(o.subgraphs[O.id]??[],O.id);if(R)return R}}return null};return w(o.root,null)},[o]),y=b.useCallback(C=>{let N;if(C.type==="node")N=`[data-reposition-item="node-${C.id}"]`;else if(C.type==="group"){const j=m(C.id,C.subgraphId??null);if(!j)return;N=`[data-reposition-item="group-${j}"]`}else N=`[data-reposition-item="subgraph-${C.id}"]`;const w=document.querySelector(N);p(w?{viewportTop:w.getBoundingClientRect().top}:null),d(C),l(!0)},[m]),x=b.useCallback((C,N,w)=>{n(C),l(!1),d(null),p(null),s(N),requestAnimationFrame(()=>{requestAnimationFrame(()=>{let j;if(N.type==="node")j=`[data-reposition-item="node-${N.id}"]`;else if(N.type==="group"){const k=m(N.id,N.subgraphId??null);if(!k)return;j=`[data-reposition-item="group-${k}"]`}else j=`[data-reposition-item="subgraph-${N.id}"]`;if(j){const k=document.querySelector(j);if(!k)return;if(w){const O=document.querySelector('[data-node-list="true"]');if(O){const D=k.getBoundingClientRect().top-w.viewportTop;Math.abs(D)>.5&&(O.scrollTop+=D);return}}k.scrollIntoView({behavior:"auto",block:"center"})}})})},[s,m,n]),v=b.useCallback(()=>{l(!1),d(null),p(null)},[]);return{overlayOpen:a,initialTarget:c,initialViewportAnchor:h,openOverlay:y,commitAndClose:x,cancelOverlay:v}}function jl(n){const o=n.replace("#","").trim();return/^[0-9a-f]{3}$/i.test(o)?`#${o.replace(/(.)/g,"$1$1").toLowerCase()}`:/^[0-9a-f]{6}$/i.test(o)?`#${o.toLowerCase()}`:null}function lx(n){if(typeof document>"u"||!document.body)return null;const o=document.createElement("span");o.style.color=n,document.body.appendChild(o);const s=getComputedStyle(o).color;document.body.removeChild(o);const a=s.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)/i);if(!a)return null;const[,l,c,d]=a.map(Number);return[l,c,d].some(h=>Number.isNaN(h))?null:`#${[l,c,d].map(h=>h.toString(16).padStart(2,"0")).join("")}`}function ky(n,o){const s=new Set,a=n.trim().toLowerCase();if(a&&(s.add(a),o)){const d=o[a.replace(/\s+/g,"")]??o[a];d&&s.add(d)}const l=jl(n);if(l)return s.add(l),[...s];const c=lx(n);return c&&s.add(c),[...s]}function jy(n){const o=jl(n);if(!o)return null;const s=parseInt(o.slice(1,3),16)/255,a=parseInt(o.slice(3,5),16)/255,l=parseInt(o.slice(5,7),16)/255,c=Math.max(s,a,l),d=Math.min(s,a,l),h=c-d;let p=0;h!==0&&(c===s?p=(a-l)/h%6:c===a?p=(l-s)/h+2:p=(s-a)/h+4,p=Math.round(p*60),p<0&&(p+=360));const m=(c+d)/2,y=h===0?0:h/(1-Math.abs(2*m-1));return{h:p,s:y,l:m}}function oN(n,o,s,a={},l={}){const c=(w,j)=>{if(j in w)return!!w[j];const k=l[j];return k?!!w[k]:!!w[j]},d=(w,j,k)=>{if(j in w)return w[j]??k;const O=l[j];return O?w[O]??k:w[j]??k},h=new Map(o.nodes.map(w=>[w.id,w])),p=o.groups??[],m=o.definitions?.subgraphs??[],y=new Map(m.map(w=>[w.id,w])),x=new Map(p.map(w=>[w.id,w])),v=new Map;for(const w of m){const j=new Map;for(const k of w.groups??[])j.set(k.id,k);v.set(w.id,j)}const C=(w,j,k=new Set,O=new Set)=>{let R=0;for(const D of w)if(D.type==="node"){const I=hn({type:"node",nodeId:D.id,subgraphId:j});c(a,I)||(R+=1)}else if(D.type==="hiddenBlock"){const I=n.hiddenBlocks[D.blockId]??[];R+=I.filter(H=>{const A=hn({type:"node",nodeId:H,subgraphId:j});return!c(a,A)}).length}else if(D.type==="group"){if(k.has(D.stableKey))continue;k.add(D.stableKey),R+=C(n.groups[D.stableKey]??[],j,k,O),k.delete(D.stableKey)}else if(D.type==="subgraph"){if(O.has(D.id))continue;O.add(D.id),R+=C(n.subgraphs[D.id]??[],D.id,k,O),O.delete(D.id)}return R},N=(w,j,k,O=new Set,R=new Set)=>{const D=[];for(const I of w){if(I.type==="hiddenBlock"){const X=n.hiddenBlocks[I.blockId]??[];if(X.length===0)continue;D.push({type:"hiddenBlock",blockId:I.blockId,nodeIds:X,count:X.length});continue}if(I.type==="node"){const X=hn({type:"node",nodeId:I.id,subgraphId:k});if(c(a,X))continue;const re=h.get(I.id);if(!re)continue;D.push({type:"node",node:re,groupId:j,subgraphId:k});continue}if(I.type==="group"){if(c(a,I.stableKey)||O.has(I.stableKey))continue;let X;if(k&&(X=v.get(k)?.get(I.id)),X??=x.get(I.id),!X)for(const Te of v.values()){const F=Te.get(I.id);if(F){X=F;break}}if(!X)continue;const re=n.groups[I.stableKey]??[],te=d(s,I.stableKey,!1);O.add(I.stableKey);const me=te?[]:N(re,I.id,k,O,R);O.delete(I.stableKey),D.push({type:"group",group:X,stableKey:I.stableKey,nodeCount:C(re,k),isCollapsed:te,subgraphId:k,children:me});continue}if(c(a,hn({type:"subgraph",subgraphId:I.id}))||R.has(I.id))continue;const H=y.get(I.id);if(!H)continue;const A=n.subgraphs[I.id]??[],V=d(s,hn({type:"subgraph",subgraphId:I.id}),!1);R.add(I.id);const J=V?[]:N(A,null,I.id,O,R);R.delete(I.id),D.push({type:"subgraph",subgraph:H,nodeCount:C(A,I.id),isCollapsed:V,groupId:j,children:J})}return D};return N(n.root,null,null)}function Do(n,o){const s=jl(n);if(!s)return Dt.transparentBlack;const a=s.slice(1),l=parseInt(a.slice(0,2),16),c=parseInt(a.slice(2,4),16),d=parseInt(a.slice(4,6),16);return`rgba(${l}, ${c}, ${d}, ${o})`}function My({containerKey:n,indexLabel:o,targetKey:s,height:a}){return u.jsx("div",{"data-reposition-placeholder":"true",className:"mb-3",style:{height:`${a}px`}},`placeholder-${n}-${o}-${s}`)}function Oy({containerType:n,containerDataKey:o,dataKey:s,title:a,nodeCount:l,isTarget:c,isCollapsed:d,canToggleCollapse:h,isDragging:p,isDropTarget:m,isHighlighted:y,backgroundColor:x,borderColor:v,headerBackgroundColor:C,onToggleCollapse:N,childrenContent:w}){const j=`${l} node${l!==1?"s":""}${n==="subgraph"?" (subgraph)":""}`;return u.jsxs("div",{"data-container-type":n,className:`rounded-xl mb-3 shadow-md ${p?"overflow-visible":"overflow-hidden"} transition-shadow ${c?"border-blue-500 border-2 ring-2 ring-blue-400":"border"} ${y&&!c?"ring-2 ring-blue-500 transition-all":""} ${m?"ring-2 ring-blue-300 ring-dashed":""}`,style:{backgroundColor:x,borderColor:v,...c?{touchAction:"none"}:{},...c?{animation:p?"none":"node-card-wiggle 180ms ease-in-out infinite alternate"}:{}},"data-reposition-item":s,children:[u.jsxs("div",{"data-reposition-header":o,className:`flex items-center justify-between cursor-pointer gap-1 px-3 py-2 ${d?"rounded-xl":"rounded-t-xl mb-2"}`,style:{backgroundColor:C,borderColor:v},onClick:k=>{h&&(k.stopPropagation(),N())},children:[u.jsx("span",{"data-reposition-handle":s,className:"touch-none w-8 h-8 -ml-2 flex items-center justify-center shrink-0",children:u.jsx(Hp,{className:`w-5 h-5 ${c?"text-blue-500":"text-gray-500"}`})}),u.jsx("span",{className:"font-semibold text-gray-900 flex-1 min-w-0 truncate",children:a}),u.jsx("span",{className:"ml-auto text-sm shrink-0 text-gray-500",children:j}),d?u.jsx(ws,{className:`w-6 h-6 shrink-0 ${h?"text-gray-500":"text-gray-500 opacity-50"}`}):u.jsx(no,{className:"w-6 h-6 shrink-0 text-gray-500"})]}),w,!d&&u.jsx("div",{"data-reposition-footer":o,className:`px-3 py-1.5 rounded-b-xl select-none ${h?"cursor-pointer":""}`,style:{backgroundColor:C,borderColor:v},onClick:k=>{h&&(k.stopPropagation(),N())},children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{className:"text-xs flex-1 min-w-0 truncate text-gray-500",children:a}),u.jsxs("div",{className:"ml-auto flex items-center gap-1",children:[u.jsx("span",{className:"text-xs shrink-0 text-gray-500",children:j}),u.jsx(no,{className:`w-6 h-6 shrink-0 rotate-180 ${h?"text-gray-500":"text-gray-500 opacity-50"}`})]})]})})]})}function rN({blockId:n,nodeCount:o}){return u.jsxs("div",{className:"bg-gray-200 rounded-lg px-3 py-2 mb-3 text-sm text-gray-500 text-center","data-reposition-item":`hidden-${n}`,children:[o," hidden node",o!==1?"s":""]},`hidden-${n}`)}function sN({dataKey:n,nodeId:o,displayName:s,isTarget:a,isBypassed:l,isDragging:c,borderClass:d,borderStyle:h,isHighlighted:p}){return u.jsxs("div",{className:`flex min-h-10 items-center gap-1 rounded-xl border-2 px-3 py-1 mb-3 shadow-md select-none ${d} ${l?"bg-purple-200":"bg-white"} ${p&&!a?"ring-2 ring-blue-500 transition-all":""}`,style:a?{...h??{},touchAction:"none",animation:c?"none":"node-card-wiggle 180ms ease-in-out infinite alternate"}:h,"data-reposition-item":n,children:[u.jsx("span",{"data-reposition-handle":n,className:"touch-none flex h-8 w-8 items-center justify-center -ml-2 shrink-0",children:u.jsx(Hp,{className:`w-5 h-5 ${a?"text-blue-500":"text-gray-300"}`})}),u.jsx("span",{className:"font-semibold min-w-0 flex-1 truncate text-gray-900",children:s}),u.jsxs("span",{className:"text-xs text-gray-400 shrink-0",children:["#",o]})]},n)}const aN={secondary:"bg-white border border-gray-300 text-gray-700",primary:"bg-blue-600 text-white",danger:"bg-red-600 text-white"};function ix({actions:n,zIndex:o}){return u.jsx("div",{className:"fixed bottom-6 left-0 right-0 flex justify-center gap-4 px-4",style:{zIndex:o,paddingBottom:"env(safe-area-inset-bottom)"},children:n.map(s=>{const a=s.variant??"secondary";return u.jsx("button",{type:"button",className:`px-5 py-2.5 rounded-full text-sm font-medium shadow-lg disabled:opacity-50 disabled:cursor-not-allowed ${aN[a]}`,onClick:s.onClick,disabled:s.disabled,children:s.label},s.key)})})}function lN({nodeId:n,canShowConnectionsToggle:o,connectionHighlightEnabled:s,onToggleConnections:a,connectionMode:l,leftLineCount:c,rightLineCount:d,inputHighlightColor:h,outputHighlightColor:p}){return u.jsx("div",{className:"bg-white border-b border-gray-200",style:{height:"var(--top-bar-offset, 69px)"},children:u.jsxs("div",{className:"h-full px-4 flex items-center justify-between",children:[u.jsx("div",{className:"w-10 h-10"}),u.jsx("h2",{className:"text-lg font-semibold text-gray-900 text-center",children:"Reposition Nodes"}),u.jsx("div",{className:"w-10 h-10 flex items-center justify-center",children:o&&u.jsx("button",{type:"button",className:"w-8 h-8 flex items-center justify-center","aria-label":"Highlight node connections","aria-pressed":s,onClick:a,children:u.jsx(nx,{className:"w-6 h-6 overflow-visible",nodeId:n,connectionHighlightMode:l,leftLineCount:c,rightLineCount:d,inactiveColor:Dt.text.secondary,offLineColor:Dt.text.secondary,inputHighlightColor:h,outputHighlightColor:p})})})]})})}function iN({scrollContainerRef:n,isDragging:o,isPointerArmedForDrag:s,onPointerDown:a,onPointerMove:l,onPointerUp:c,onPointerCancel:d,children:h}){return u.jsx("div",{ref:n,className:"flex-1 overflow-auto px-4 pt-4 pb-40",style:{touchAction:o||s?"none":"pan-y"},onPointerDown:a,onPointerMove:l,onPointerUp:c,onPointerCancel:d,children:h})}function Cu(n,o,s){let a=null;const l=(c,d)=>{for(const h of c){if(h.type==="group"){if(h.id===o&&a==null&&(a=h.stableKey),h.id===o&&d===s)return h.stableKey;const p=l(n.groups[h.stableKey]??[],d);if(p)return p;continue}if(h.type==="subgraph"){const p=l(n.subgraphs[h.id]??[],h.id);if(p)return p}}return null};return l(n.root,null)??a}function ux(n,o){const s=n.groupParents?.[o];if(!s){const a=(l,c)=>{for(const d of l){if(d.type==="group"){if(d.stableKey===o)return c;const h=a(n.groups[d.stableKey]??[],c);if(h!==null)return h;continue}if(d.type==="subgraph"){const h=a(n.subgraphs[d.id]??[],d.id);if(h!==null)return h}}return null};return a(n.root,null)}return s.scope==="subgraph"?s.subgraphId:s.scope==="root"?null:ux(n,s.groupKey)}function kf(n,o){if(n.type==="node")return`node-${n.id}`;if(n.type==="group"){const s=o?Cu(o,n.id,n.subgraphId??null):null;return s?`group-${s}`:`group-${hn({type:"group",groupId:n.id,subgraphId:n.subgraphId??null})}`}return`subgraph-${n.id}`}function uN(n){return n.type==="node"?`node-${n.id}`:n.type==="group"?`group-${n.stableKey}`:n.type==="subgraph"?`subgraph-${n.id}`:`hidden-${n.blockId}`}function ra(n,o){return n.scope!==o.scope?!1:n.scope==="root"?!0:n.scope==="group"&&o.scope==="group"?n.groupKey===o.groupKey:n.scope==="subgraph"&&o.scope==="subgraph"?n.subgraphId===o.subgraphId:!1}function cu(n){return n.scope==="root"?"root":n.scope==="group"?`group-${n.groupKey}`:`subgraph-${n.subgraphId}`}function cN(n){return{groupKeys:Object.keys(n.groups),subgraphIds:Object.keys(n.subgraphs)}}function Ty(n,o,s){const a=[];return o.forEach((l,c)=>{if(l===s)return;const d=n.querySelector(`[data-reposition-item="${l}"]`);if(!d)return;const h=d.getBoundingClientRect();a.push({idx:c,top:h.top,bottom:h.bottom,height:h.height})}),a}function dN(n,o,s){const a=Math.max(n.top,o.top),l=Math.min(n.bottom,o.bottom);return Math.max(0,l-a)>=n.height*s}function Ey(n,o,s,a,l,c){if(!(n.bottom>=o.top&&n.top<=o.bottom))return!1;if(!s||!a)return dN(n,o,c);if(l){const m=n.bottom>s.top+s.height*c,y=n.bottom>a.top+a.height*c;return m&&!y}const h=n.top<a.bottom-a.height*c,p=n.top<s.bottom-s.height*c;return h&&!p}function Iy(n,o,s,a,l){if(n.length===0)return 0;if(o){let d=0;for(const h of n){const p=h.top+h.height*l;if(a>p){d=h.idx+1;continue}break}return d}let c=n.length;for(let d=n.length-1;d>=0;d-=1){const h=n[d],p=h.bottom-h.height*l;if(s<p){c=h.idx;continue}break}return c}const Ly=5,du=.625,fN=1/6,_y=120,pN=640,hN=350,gN=300,jf=Dt.status.success,Mf=Dt.status.warning,mN=Dt.status.danger,fu=Dt.brand.blue500;function yN({mobileLayout:n,initialTarget:o,initialViewportAnchor:s=null,onDone:a,onCancel:l}){const c=fe(be=>be.workflow),d=fe(be=>be.nodeTypes),h=fe(be=>be.executingNodeId),p=fe(be=>be.collapsedItems),m=fe(be=>be.stableKeyByPointer),y=pn(be=>be.nodeErrors),x=b.useCallback(be=>m[be]??be,[m]),[v,C]=b.useState(()=>JSON.parse(JSON.stringify(n))),[N,w]=b.useState(!1),[j,k]=b.useState(o),[O,R]=b.useState(null),[D,I]=b.useState(null),[H,A]=b.useState(!1),V=b.useRef(null),J=b.useRef(0),X=b.useRef(0),re=b.useRef(0),te=b.useRef(!0),me=b.useRef(-1),Te=b.useRef(null),F=b.useRef(0),_=b.useRef(0),q=b.useRef(0),de=b.useRef(null),Me=b.useRef(null),Ne=b.useRef(null),M=b.useRef(null),L=b.useRef(null),K=b.useRef(null),je=b.useRef(0),We=b.useRef(0),Re=b.useRef(!1),Se=b.useRef(!1),Ee=b.useRef(!1),xe=b.useRef(null),[se,Z]=b.useState(null),[T,ie]=b.useState(()=>{const be={...p??{}};if(o.type==="group"){const ye=Cu(n,o.id,o.subgraphId??null);ye&&(be[ye]=!0)}return o.type==="subgraph"&&(be[x(hn({type:"subgraph",subgraphId:o.id}))]=!0),be}),[G,ge]=b.useState(null),[B,ne]=b.useState(null),W=b.useRef(v);b.useEffect(()=>{W.current=v},[v]);const P=b.useMemo(()=>kf(j,v),[j,v]),z=G===P,$=b.useMemo(()=>{const be=j.type==="node"?{type:"node",id:j.id}:j.type==="group"?(()=>{const Ye=Cu(v,j.id,j.subgraphId??null);return Ye?{type:"group",id:j.id,subgraphId:j.subgraphId??null,stableKey:Ye}:null})():{type:"subgraph",id:j.id};if(!be)return{groupIds:new Set,subgraphIds:new Set};const ye=(Ye,et)=>Ye.type!==et.type?!1:Ye.type==="node"&&et.type==="node"?Ye.id===et.id:Ye.type==="group"&&et.type==="group"?Ye.stableKey===et.stableKey:Ye.type==="subgraph"&&et.type==="subgraph"?Ye.id===et.id:Ye.type==="hiddenBlock"&&et.type==="hiddenBlock"?Ye.blockId===et.blockId:!1,De=(Ye,et,rt)=>{for(const Be of Ye){if(ye(Be,be))return{groupIds:new Set(et),subgraphIds:new Set(rt)};if(Be.type==="group"){const ct=De(v.groups[Be.stableKey]??[],[...et,Be.stableKey],rt);if(ct)return ct}else if(Be.type==="subgraph"){const ct=De(v.subgraphs[Be.id]??[],et,[...rt,Be.id]);if(ct)return ct}}return null};return De(v.root,[],[])??{groupIds:new Set,subgraphIds:new Set}},[v,j]),ee=b.useMemo(()=>{if(!c||j.type!=="node")return{hasConnections:!1,hasUpstream:!1,hasDownstream:!1,leftLineCount:0,rightLineCount:0,upstreamNodeIds:new Set,downstreamNodeIds:new Set};const be=c.nodes.find(rt=>rt.id===j.id);if(!be)return{hasConnections:!1,hasUpstream:!1,hasDownstream:!1,leftLineCount:0,rightLineCount:0,upstreamNodeIds:new Set,downstreamNodeIds:new Set};const ye=new Set;be.inputs.forEach((rt,Be)=>{if(rt.link==null)return;const ct=ha(c,be.id,Be);ct&&ye.add(ct.node.id)});const De=new Set;be.outputs.forEach((rt,Be)=>{if(!rt.links||rt.links.length===0)return;const ct=wl(c,be.id,Be);for(const St of ct)De.add(St.node.id)}),ye.delete(be.id),De.delete(be.id);const Ye=be.inputs.filter(rt=>rt.link!=null).length,et=be.outputs.reduce((rt,Be)=>rt+(Be.links?.length??0),0);return{hasConnections:Ye>0||et>0,hasUpstream:ye.size>0,hasDownstream:De.size>0,leftLineCount:Math.min(3,Ye),rightLineCount:Math.min(3,et),upstreamNodeIds:ye,downstreamNodeIds:De}},[c,j]),pe=b.useMemo(()=>new Map((c?.nodes??[]).map(be=>[be.id,be])),[c]),ae=b.useMemo(()=>{const be=new Map;for(const De of c?.groups??[])be.set(De.id,De);const ye=new Map;for(const De of c?.definitions?.subgraphs??[]){const Ye=new Map;for(const et of De.groups??[])Ye.set(et.id,et);ye.set(De.id,Ye)}return{rootMap:be,bySubgraph:ye}},[c]),ke=b.useMemo(()=>{const be=new Map;for(const ye of c?.groups??[]){const De=ye.stableKey??`legacy-group-root-${ye.id}`;be.set(De,ye)}for(const ye of c?.definitions?.subgraphs??[])for(const De of ye.groups??[]){const Ye=De.stableKey??`legacy-group-${ye.id}-${De.id}`;be.set(Ye,De)}return be},[c]),U=b.useMemo(()=>new Map((c?.definitions?.subgraphs??[]).map(be=>[be.id,be])),[c]),ce=b.useMemo(()=>{const be=new Map,ye=new Set,De=new Set,Ye=(et,rt)=>{for(const Be of et){if(Be.type==="group"){if(be.set(Be.stableKey,{id:Be.id,subgraphId:rt}),ye.has(Be.stableKey))continue;ye.add(Be.stableKey),Ye(v.groups[Be.stableKey]??[],rt);continue}if(Be.type==="subgraph"){if(De.has(Be.id))continue;De.add(Be.id),Ye(v.subgraphs[Be.id]??[],Be.id)}}};return Ye(v.root,null),be},[v]);b.useEffect(()=>{const be=kf(j,W.current);let ye=null;return Re.current?Re.current=!1:requestAnimationFrame(()=>{const De=M.current,Ye=De?.querySelector(`[data-reposition-item="${be}"]`);if(!Ye)return;const et=!Se.current;if(et&&!Ee.current&&s&&De){const ct=Ye.getBoundingClientRect().top-s.viewportTop;Math.abs(ct)>.5&&(De.scrollTop+=ct),Ee.current=!0,Se.current=!0;return}const rt=et?"auto":"smooth";Ye.scrollIntoView({behavior:rt,block:"center"}),Se.current=!0}),ye=requestAnimationFrame(()=>{Z(be)}),xe.current!=null&&window.clearTimeout(xe.current),xe.current=window.setTimeout(()=>{Z(null),xe.current=null},1500),()=>{ye!=null&&window.cancelAnimationFrame(ye),xe.current!=null&&window.clearTimeout(xe.current)}},[j,s]);const He=b.useCallback(be=>{if(be.startsWith("node-")){const ye=parseInt(be.slice(5),10);return Number.isFinite(ye)?{target:{type:"node",id:ye},itemRef:{type:"node",id:ye}}:null}if(be.startsWith("group-")){const ye=be.slice(6),De=ce.get(ye);if(!De)return null;const{id:Ye,subgraphId:et}=De;return{target:{type:"group",id:Ye,subgraphId:et},itemRef:{type:"group",id:Ye,subgraphId:et,stableKey:ye}}}if(be.startsWith("subgraph-")){const ye=be.slice(9);return{target:{type:"subgraph",id:ye},itemRef:{type:"subgraph",id:ye}}}return null},[ce]),Ve=b.useCallback(be=>{const De=be.target.closest("[data-reposition-item]")?.dataset.repositionItem??null,rt=be.target.closest("[data-reposition-handle]")?.dataset.repositionHandle??null??(De===P?P:null);if(!rt)return;const Be=He(rt);if(!Be)return;const ct=qb(v,Be.itemRef);if(!ct)return;if(be.preventDefault(),rt!==P){const Ct=Be.target;if(Ct.type==="group"){const Nt=Cu(v,Ct.id,Ct.subgraphId??null);if(!Nt)return;ie(ut=>({...ut,[Nt]:!0}))}else if(Ct.type==="subgraph"){const Nt=Ct.id;ie(ut=>({...ut,[x(hn({type:"subgraph",subgraphId:Nt}))]:!0}))}Re.current=!0,k(Be.target)}const St=Be.itemRef.type==="node"||Be.itemRef.type==="group",bt=St?cN(v):{groupKeys:[],subgraphIds:[]},lt=new Set,ht=new Set;if(Be.itemRef.type==="group"){const Ct=Nt=>{for(const ut of Nt){if(ut.type==="group"){lt.has(ut.stableKey)||(lt.add(ut.stableKey),Ct(v.groups[ut.stableKey]??[]));continue}ut.type==="subgraph"&&(ht.has(ut.id)||(ht.add(ut.id),Ct(v.subgraphs[ut.id]??[])))}};lt.add(Be.itemRef.stableKey),Ct(v.groups[Be.itemRef.stableKey]??[])}V.current={pointerId:be.pointerId,startX:be.clientX,startY:be.clientY,origIndex:ct.index,containerId:ct.containerId,targetKey:rt,targetRef:Be.itemRef,target:Be.target,allGroupKeys:bt.groupKeys,allSubgraphIds:bt.subgraphIds,crossContainerEnabled:St,disallowedGroupKeys:lt,disallowedSubgraphIds:ht},J.current=0,me.current=ct.index,Te.current=ct.containerId,re.current=be.clientY,te.current=!0,A(!0),M.current&&(M.current.style.touchAction="none")},[v,P,He,x]),qe=b.useCallback((be,ye,De,Ye)=>{if(!ye.crossContainerEnabled)return ye.containerId;let et={scope:"root"},rt=1/0;for(const Be of ye.allGroupKeys){if(ye.targetRef.type==="group"&&ye.targetRef.stableKey===Be||ye.disallowedGroupKeys.has(Be)||(T[Be]??!1))continue;const ct=`group-${Be}`,St=be.querySelector(`[data-reposition-item="${ct}"]`);if(!St)continue;const bt=St.getBoundingClientRect(),lt=St.querySelector(`[data-reposition-header="${ct}"]`),ht=St.querySelector(`[data-reposition-footer="${ct}"]`),Ct=lt?.getBoundingClientRect()??null,Nt=ht?.getBoundingClientRect()??null;if(!Ey(De,bt,Ct,Nt,Ye,du))continue;const ut=bt.width*bt.height;ut<rt&&(rt=ut,et={scope:"group",groupKey:Be})}for(const Be of ye.allSubgraphIds){if(ye.targetRef.type==="subgraph"&&ye.targetRef.id===Be||ye.disallowedSubgraphIds.has(Be)||(T[x(hn({type:"subgraph",subgraphId:Be}))]??!1))continue;const ct=be.querySelector(`[data-reposition-item="subgraph-${Be}"]`);if(!ct)continue;const St=ct.getBoundingClientRect(),bt=ct.querySelector(`[data-reposition-header="subgraph-${Be}"]`),lt=ct.querySelector(`[data-reposition-footer="subgraph-${Be}"]`),ht=bt?.getBoundingClientRect()??null,Ct=lt?.getBoundingClientRect()??null;if(!Ey(De,St,ht,Ct,Ye,du))continue;const Nt=St.width*St.height;Nt<rt&&(rt=Nt,et={scope:"subgraph",subgraphId:Be})}return et},[T,x]),ot=b.useCallback((be,ye,De,Ye,et)=>{const Be=I2(v,De).map(uN);if(ra(De,ye.containerId)){const bt=Be.filter(Ct=>Ct!==ye.targetKey),lt=Ty(be,bt),ht=Iy(lt,et,Ye.top,Ye.bottom,du);return ht<=ye.origIndex?ht:ht+1}const St=Ty(be,Be);return Iy(St,et,Ye.top,Ye.bottom,du)},[v]),Ge=b.useCallback((be,ye,De,Ye)=>{ne(et=>{const rt={targetKey:be.targetKey,sourceContainer:be.containerId,sourceIndex:be.origIndex,hoverContainer:ye,insertIndex:De,placeholderHeight:Ye};return et&&et.targetKey===rt.targetKey&&ra(et.sourceContainer,rt.sourceContainer)&&et.sourceIndex===rt.sourceIndex&&ra(et.hoverContainer,rt.hoverContainer)&&et.insertIndex===rt.insertIndex&&et.placeholderHeight===rt.placeholderHeight?et:rt})},[]),Xe=b.useCallback(()=>{L.current!=null&&(window.cancelAnimationFrame(L.current),L.current=null),K.current=null,je.current=0,We.current=0},[]),Ie=b.useCallback(be=>{if(!M.current)return;const De=performance.now();if(K.current!==be&&(K.current=be,je.current=De,We.current=De),L.current!=null)return;const Ye=et=>{const rt=M.current,Be=K.current;if(!rt||Be==null||!V.current||!N){L.current=null;return}const ct=We.current||et,St=Math.max(0,et-ct);We.current=et;const bt=Math.max(0,et-je.current-hN),lt=Math.min(1,bt/gN),Ct=(_y+(pN-_y)*lt)*St/1e3,Nt=rt.scrollTop,ut=Math.max(0,rt.scrollHeight-rt.clientHeight),At=Math.max(0,Math.min(ut,Nt+Be*Ct));if(rt.scrollTop=At,At===Nt){L.current=null;return}L.current=window.requestAnimationFrame(Ye)};L.current=window.requestAnimationFrame(Ye)},[N]),_e=b.useCallback(be=>{const ye=V.current;if(!ye||be.pointerId!==ye.pointerId)return;const De=be.clientY-ye.startY,Ye=be.clientX-ye.startX;if(!N){if(Math.abs(Ye)>Math.abs(De)&&Math.abs(Ye)>Ly){V.current=null,Xe(),A(!1),M.current&&(M.current.style.touchAction="");return}if(Math.abs(De)<Ly)return;w(!0);const nn=M.current;if(nn){const Q=nn.querySelector(`[data-reposition-item="${ye.targetKey}"]`);if(Q){const Ae=Q.getBoundingClientRect();F.current=Ae.top,_.current=Ae.left,q.current=Q.offsetHeight||Ae.height,Q.style.position="fixed",Q.style.top=`${Ae.top}px`,Q.style.left=`${Ae.left}px`,Q.style.width=`${Ae.width}px`,Q.style.zIndex="70",Q.style.pointerEvents="none",ne({targetKey:ye.targetKey,sourceContainer:ye.containerId,sourceIndex:ye.origIndex,hoverContainer:ye.containerId,insertIndex:ye.origIndex,placeholderHeight:q.current})}}try{M.current?.setPointerCapture(be.pointerId)}catch{}re.current=be.clientY,te.current=De>=0;return}J.current=De,X.current=Ye;const et=M.current;if(!et)return;const rt=et.getBoundingClientRect(),Be=rt.height*fN,ct=rt.top+Be,St=rt.bottom-Be;be.clientY<=ct?Ie(-1):be.clientY>=St?Ie(1):Xe();const bt=et.querySelector(`[data-reposition-item="${ye.targetKey}"]`);bt&&(bt.style.top=`${F.current+De}px`,bt.style.left=`${_.current}px`);const lt=bt?.getBoundingClientRect();if(!lt)return;const ht=q.current||bt?.offsetHeight||lt.height,Ct=be.clientY-re.current;Ct!==0&&(te.current=Ct>0);const Nt=te.current;re.current=be.clientY;const ut=qe(et,ye,lt,Nt);Te.current=ut;const At=ra(ut,ye.containerId),tn=ut.scope==="group"?`group-${ut.groupKey}`:ut.scope==="subgraph"?`subgraph-${ut.subgraphId}`:null,kn=ut.scope==="group"?T[ut.groupKey]??!1:ut.scope==="subgraph"?T[x(hn({type:"subgraph",subgraphId:ut.subgraphId}))]??!1:!1;tn&&kn&&!At?Me.current!==tn&&(de.current!=null&&window.clearTimeout(de.current),Me.current=tn,de.current=window.setTimeout(()=>{const nn=Te.current;nn&&(nn.scope==="group"?ie(Q=>({...Q,[nn.groupKey]:!1})):nn.scope==="subgraph"&&ie(Q=>({...Q,[x(hn({type:"subgraph",subgraphId:nn.subgraphId}))]:!1})),de.current=null)},350)):de.current!=null&&(window.clearTimeout(de.current),de.current=null,Me.current=null),R(!At&&ut.scope==="group"?ut.groupKey:null),I(!At&&ut.scope==="subgraph"?ut.subgraphId:null),me.current=ot(et,ye,ut,lt,Nt),Ge(ye,ut,me.current,ht)},[N,qe,ot,Ge,T,x,Ie,Xe]),Ze=b.useCallback(()=>{const be=M.current;if(!be)return;be.querySelectorAll("[data-reposition-item]").forEach(De=>{De.style.transform="",De.style.zIndex="",De.style.position="",De.style.top="",De.style.left="",De.style.width="",De.style.pointerEvents="",De.style.transition="",De.style.marginTop=""})},[]),wt=b.useCallback(be=>{const ye=V.current;if(ye&&be.pointerId===ye.pointerId){if(N){Xe();try{M.current?.releasePointerCapture(be.pointerId)}catch{}Ze(),de.current!=null&&(window.clearTimeout(de.current),de.current=null),Me.current=null;const De=Te.current??ye.containerId,Ye=me.current;if(!ra(De,ye.containerId)||Ye!==ye.origIndex){const rt=E2(v,ye.targetRef,ye.containerId,ye.origIndex,De,Ye);if(C(rt),ye.target.type==="group"&&ye.targetRef.type==="group"){const Be=ux(rt,ye.targetRef.stableKey),ct={type:"group",id:ye.target.id,subgraphId:Be};Re.current=!0,k(ct),Ne.current=ct}else Ne.current=ye.target}w(!1),R(null),I(null),ne(null)}V.current=null,Xe(),J.current=0,X.current=0,me.current=-1,Te.current=null,F.current=0,_.current=0,q.current=0,re.current=0,te.current=!0,A(!1),M.current&&(M.current.style.touchAction="")}},[N,v,Ze,Xe]),pt=b.useCallback(be=>{if(V.current){if(N){Xe();try{M.current?.releasePointerCapture(be.pointerId)}catch{}Ze(),de.current!=null&&(window.clearTimeout(de.current),de.current=null),Me.current=null,w(!1),R(null),I(null),ne(null)}V.current=null,Xe(),J.current=0,X.current=0,me.current=-1,Te.current=null,F.current=0,_.current=0,q.current=0,re.current=0,te.current=!0,A(!1),M.current&&(M.current.style.touchAction="")}},[N,Ze,Xe]);b.useEffect(()=>()=>{Xe(),de.current!=null&&window.clearTimeout(de.current)},[Xe]);const Lt=()=>{const be=Ne.current??j,ye=M.current?.querySelector(`[data-reposition-item="${kf(be,v)}"]`),De=ye?{viewportTop:ye.getBoundingClientRect().top}:null;a(v,be,De)},_t=be=>{ie(ye=>{const De=ye[be]??!1;return{...ye,[be]:!De}})},Vt=be=>{const ye=x(hn({type:"subgraph",subgraphId:be}));ie(De=>{const Ye=De[ye]??!1;return{...De,[ye]:!Ye}})},Pe=be=>{const ye=pe.get(be);return ye?(typeof ye.title=="string"&&ye.title.trim()?ye.title.trim():null)||d?.[ye.type]?.display_name||ye.type:`Node #${be}`},Fe=be=>{if(P===`node-${be}`)return"";const ye=pe.get(be);return ye?y[String(be)]?.length>0?"border-red-700 shadow-red-200":h===String(be)?"border-green-500 shadow-green-200":ye.mode===4?"border-purple-300":"border-transparent":"border-transparent"},Ke=be=>pe.get(be)?.mode===4;function Je(be){let ye=0;for(const De of be)De.type==="node"?ye+=1:De.type==="hiddenBlock"?ye+=v.hiddenBlocks[De.blockId]?.length??0:De.type==="group"?ye+=Je(v.groups[De.stableKey]??[]):De.type==="subgraph"&&(ye+=Je(v.subgraphs[De.id]??[]));return ye}const mt=(be,ye)=>{const De=[],Ye=B!=null&&ra(ye,B.hoverContainer);let et=-1;Ye&&B&&(et=B.insertIndex,et<0&&(et=0),et>be.length&&(et=be.length));const rt=Be=>{!Ye||!B||et===Be&&De.push(u.jsx(My,{containerKey:cu(ye),indexLabel:String(Be),targetKey:B.targetKey,height:B.placeholderHeight},`placeholder-${cu(ye)}-${Be}-${B.targetKey}`))};return be.forEach((Be,ct)=>{if(rt(ct),Be.type==="hiddenBlock"){const St=v.hiddenBlocks[Be.blockId]??[];De.push(u.jsx(rN,{blockId:Be.blockId,nodeCount:St.length},`hidden-${Be.blockId}`));return}if(Be.type==="node"){const St=`node-${Be.id}`,bt=St===P,lt=Ke(Be.id),ht=z&&ee.hasConnections,Ct=ht&&ee.upstreamNodeIds.has(Be.id),Nt=ht&&ee.downstreamNodeIds.has(Be.id),ut=bt?"border-blue-500 ring-2 ring-blue-400":Ct||Nt?"":Fe(Be.id),At={},tn="7px";ht&&(bt?(At.borderTopColor=fu,At.borderBottomColor=fu,At.borderLeftColor=ee.hasUpstream?jf:fu,At.borderRightColor=ee.hasDownstream?Mf:fu,ee.hasUpstream&&(At.borderLeftWidth=tn),ee.hasDownstream&&(At.borderRightWidth=tn)):(Ct||Nt)&&(At.borderColor=mN,Ct&&(At.borderRightColor=jf,At.borderRightWidth=tn),Nt&&(At.borderLeftColor=Mf,At.borderLeftWidth=tn))),De.push(u.jsx(sN,{dataKey:St,nodeId:Be.id,displayName:Pe(Be.id),isTarget:bt,isBypassed:lt,isDragging:N,borderClass:ut,borderStyle:Object.keys(At).length>0?At:void 0,isHighlighted:se===St},St));return}if(Be.type==="group"){const St=ce.get(Be.stableKey),bt=ke.get(Be.stableKey)??(St?.subgraphId==null?ae.rootMap.get(Be.id):ae.bySubgraph.get(St.subgraphId)?.get(Be.id));if(!bt)return null;const lt=`group-${Be.stableKey}`,ht=lt===P,Ct=T[Be.stableKey]??!1,Nt=$.groupIds.has(Be.stableKey),ut=!ht&&!Nt,At=Do(bt.color,.15),tn=ht?void 0:Do(bt.color,.4),kn=bt.title?.trim()||`Group ${Be.id}`,nn=v.groups[Be.stableKey]??[],Q=Je(nn),Ae=O===Be.stableKey;De.push(u.jsx(Oy,{containerType:"group",containerDataKey:lt,dataKey:lt,title:kn,nodeCount:Q,isTarget:ht,isCollapsed:Ct,canToggleCollapse:ut,isDragging:N,isDropTarget:Ae,isHighlighted:se===lt,backgroundColor:At,borderColor:tn,headerBackgroundColor:Do(bt.color,.22),onToggleCollapse:()=>_t(Be.stableKey),childrenContent:!Ct&&nn.length>0?u.jsx("div",{className:"px-1",children:mt(nn,{scope:"group",groupKey:Be.stableKey})}):null},lt));return}if(Be.type==="subgraph"){const St=U.get(Be.id);if(!St)return null;const bt=`subgraph-${Be.id}`,lt=bt===P,ht=T[x(hn({type:"subgraph",subgraphId:Be.id}))]??!1,Ct=$.subgraphIds.has(Be.id),Nt=!lt&&!Ct,ut=St.name||St.id,At=v.subgraphs[Be.id]??[],tn=Je(At),kn=D===Be.id;De.push(u.jsx(Oy,{containerType:"subgraph",containerDataKey:`subgraph-${Be.id}`,dataKey:bt,title:ut,nodeCount:tn,isTarget:lt,isCollapsed:ht,canToggleCollapse:Nt,isDragging:N,isDropTarget:kn,isHighlighted:se===bt,backgroundColor:Dt.brand.subgraphBackground08,borderColor:lt?void 0:Dt.brand.subgraphBorder25,headerBackgroundColor:Dt.brand.subgraphBackground14,onToggleCollapse:()=>Vt(Be.id),childrenContent:!ht&&At.length>0?u.jsx("div",{className:"px-1",children:mt(At,{scope:"subgraph",subgraphId:Be.id})}):null},bt));return}}),Ye&&B&&et===be.length&&De.push(u.jsx(My,{containerKey:cu(ye),indexLabel:"end",targetKey:B.targetKey,height:B.placeholderHeight},`placeholder-${cu(ye)}-end-${B.targetKey}`)),De},Et=b.useRef(null);return b.useEffect(()=>{const be=Et.current;if(!be)return;const ye=De=>De.stopPropagation();return be.addEventListener("touchstart",ye,!0),be.addEventListener("touchmove",ye,!0),be.addEventListener("touchend",ye,!0),be.addEventListener("touchcancel",ye,!0),()=>{be.removeEventListener("touchstart",ye,!0),be.removeEventListener("touchmove",ye,!0),be.removeEventListener("touchend",ye,!0),be.removeEventListener("touchcancel",ye,!0)}},[]),_n.createPortal(u.jsxs("div",{ref:Et,className:"fixed inset-0 z-[2300] bg-gray-100 flex flex-col",children:[u.jsx(lN,{nodeId:j.type==="node"?j.id:0,canShowConnectionsToggle:j.type==="node"&&ee.hasConnections,connectionHighlightEnabled:z,onToggleConnections:()=>ge(be=>be===P?null:P),connectionMode:z?ee.hasUpstream&&ee.hasDownstream?"both":ee.hasUpstream?"inputs":"outputs":"off",leftLineCount:ee.leftLineCount,rightLineCount:ee.rightLineCount,inputHighlightColor:jf,outputHighlightColor:Mf}),u.jsxs(iN,{scrollContainerRef:M,isDragging:N,isPointerArmedForDrag:H,onPointerDown:Ve,onPointerMove:_e,onPointerUp:wt,onPointerCancel:pt,children:[mt(v.root,{scope:"root"}),u.jsx("div",{"data-reposition-footer":"root",className:"h-10"})]}),u.jsx(ix,{zIndex:2301,actions:[{key:"cancel",label:"Cancel",onClick:l,variant:"secondary"},{key:"done",label:"Done",onClick:Lt,variant:"primary"}]})]}),document.body)}function sp(n,o,s){const a=s?.parentHidden??!1,l=s?.parentSubgraphId??null,c=s?.visitedGroups??new Set,d=s?.visitedSubgraphs??new Set,h=s?.hiddenNodeKeys??new Set,p=s?.hiddenGroupKeys??new Set,m=s?.hiddenSubgraphIds??new Set,{layout:y,hiddenItems:x,stableKeyByPointer:v}=o,C=(w,j)=>{if(j in w)return!!w[j];const k=v[j];return k?!!w[k]:!!w[j]};let N=0;for(const w of n){if(w.type==="node"){const R=hn({type:"node",nodeId:w.id,subgraphId:l});(a||C(x,R))&&(N+=1),C(x,R)&&h.add(R);continue}if(w.type==="hiddenBlock"){const R=y.hiddenBlocks[w.blockId]??[];for(const D of R){const I=hn({type:"node",nodeId:D,subgraphId:l});(a||C(x,I))&&(N+=1),C(x,I)&&h.add(I)}continue}if(w.type==="group"){if(c.has(w.stableKey))continue;const R=a||C(x,w.stableKey);C(x,w.stableKey)&&p.add(w.stableKey),c.add(w.stableKey);const D=sp(y.groups[w.stableKey]??[],o,{parentHidden:R,parentSubgraphId:l,visitedGroups:c,visitedSubgraphs:d,hiddenNodeKeys:h,hiddenGroupKeys:p,hiddenSubgraphIds:m});N+=D.hiddenNodeCount,c.delete(w.stableKey);continue}if(d.has(w.id))continue;const j=hn({type:"subgraph",subgraphId:w.id}),k=a||C(x,j);C(x,j)&&m.add(w.id),d.add(w.id);const O=sp(y.subgraphs[w.id]??[],o,{parentHidden:k,parentSubgraphId:w.id,visitedGroups:c,visitedSubgraphs:d,hiddenNodeKeys:h,hiddenGroupKeys:p,hiddenSubgraphIds:m});N+=O.hiddenNodeCount,d.delete(w.id)}return{hiddenNodeKeys:h,hiddenGroupKeys:p,hiddenSubgraphIds:m,hiddenNodeCount:N}}function Hl({workflow:n,runKey:o,isRunning:s,workflowDurationStats:a}){const[l,c]=b.useState(null),d=b.useRef(null),h=b.useRef(null),p=b.useRef(null),m=b.useRef(null),y=b.useRef(null),x=b.useRef(0),v=b.useRef(null);return b.useEffect(()=>{let C=null,N=null;const w=()=>{if(!n){v.current!==null&&(v.current=null,c(null)),p.current=null,m.current=null,y.current=null,d.current=null,x.current=0,h.current=null;return}const j=250,k=Date.now();let O=null;if(!o)h.current?(p.current=k+j,h.current=null,x.current=100,O=100):p.current&&k<p.current?O=100:(p.current=null,m.current=null,y.current=null,d.current=null,x.current=0,O=null);else if(p.current&&k<p.current)m.current=o,O=100;else if(m.current&&k>=(p.current??0)&&(h.current=m.current,m.current=null,d.current=k-j,x.current=0,p.current=null),h.current&&o!==h.current)y.current!==o&&(y.current=o,p.current=k+j,x.current=100),O=100;else{h.current!==o&&(d.current=k,h.current=o,x.current=0,p.current=null);const R=Math.max(0,k-(d.current??k)),D=Hu(n),I=a[D]?.avgMs??null;let H;if(I){const V=R/I*100;H=Math.min(99,Math.max(0,V))}else{const V=R/1e3;V<=50?H=V:H=50+(V-50)*.5,H=Math.min(90,H)}const A=Math.max(x.current,H);x.current=A,O=Math.round(A)}v.current!==O&&(v.current=O,c(O))};return n?(C=setTimeout(w,0),(s||p.current||o)&&(N=setInterval(w,200))):C=setTimeout(w,0),()=>{C&&clearTimeout(C),N&&clearInterval(N)}},[n,o,s,a]),l}function bN(){const n=fe(d=>d.workflowLoadedAt),[o,s]=b.useState(null),a=o===n,l=b.useCallback(d=>{s(d?n:null)},[n]),c=b.useCallback(()=>{s(null)},[]);return{errorPopoverOpen:a,setErrorPopoverOpen:l,resetErrorPopover:c}}const xN=new Set(["mp4","webm","mkv","mov","avi","m4v"]);function Vl(n){const o=n.split(".").pop()?.toLowerCase()??"";return xN.has(o)?"video":"image"}function aa(n){return Vl(n)==="video"}function Kp({open:n,buttonRef:o,menuRef:s,repositionToken:a,menuWidth:l=176,horizontalAnchorOffset:c=160,viewportPadding:d=8,bottomBarReserve:h=104}){const[p,m]=b.useState(null),y=b.useCallback(()=>{m(null)},[]);return b.useLayoutEffect(()=>{if(!n)return;const x=()=>{const N=o.current,w=s.current;if(!N||!w)return;const j=N.getBoundingClientRect(),k=w.getBoundingClientRect().height,O=j.bottom,R=j.top-k,D=window.innerHeight-h,I=O+k<=D,H=R>=d,V=Math.max(d,Math.min(I?O:H?R:O,D-k)),J=Math.max(d,Math.min(j.right-c,window.innerWidth-l-d));m({top:V,left:J})};x();const v=requestAnimationFrame(x),C=requestAnimationFrame(x);return window.addEventListener("resize",x),()=>{cancelAnimationFrame(v),cancelAnimationFrame(C),window.removeEventListener("resize",x)}},[n,o,s,l,c,d,h,a]),{menuPosition:p,menuStyle:{top:p?.top??-9999,left:p?.left??-9999,visibility:p?"visible":"hidden"},resetMenuPosition:y}}const vN="/loras";function Ay(n){return typeof window>"u"?n:new URL(n,window.location.origin).toString()}function wN(){const n=typeof window<"u"?window.localStorage.getItem("comfyui-mobile-lora-manager-ui-url")?.trim()??"":"";return Ay(n||vN)}function SN(){return typeof window>"u"?!1:window.open(wN(),"_blank","noopener,noreferrer")!==null}function NN({nodeId:n,nodeStableKey:o,isLoraManagerNode:s,isBypassed:a,onEditLabel:l,pinnableWidgets:c,singlePinnableWidget:d,isSingleWidgetPinned:h,hasPinnedWidget:p,toggleWidgetPin:m,setPinnedWidget:y,isNodeBookmarked:x,canAddNodeBookmark:v,onToggleNodeBookmark:C,toggleBypass:N,setItemHidden:w,onDeleteNode:j,onMoveNode:k,connectionHighlightMode:O,setConnectionHighlightMode:R,leftLineCount:D,rightLineCount:I}){const[H,A]=b.useState(!1),[V,J]=b.useState(!1),X=b.useRef(null),re=b.useRef(null),te=()=>{A(!1),J(!1),Te()},{menuStyle:me,resetMenuPosition:Te}=Kp({open:H,buttonRef:re,menuRef:X,repositionToken:V});ya({open:H,onDismiss:te,triggerRef:re,contentRef:X,ignoreScrollWithinContent:!0});const F=D>0||I>0,_=Re=>{if(Re.stopPropagation(),!o)return;const Se=D>0,Ee=I>0;if(!Se&&!Ee)return;const xe=Se&&Ee?["off","inputs","outputs","both"]:Se?["off","inputs"]:["off","outputs"],se=xe.indexOf(O),Z=xe[(se+1)%xe.length];R(o,Z)},q=Re=>{Re.stopPropagation(),Te(),A(Se=>!Se)},de=Re=>{Re.stopPropagation(),l(),te()},Me=Re=>{Re.stopPropagation(),o&&(N(o),te())},Ne=Re=>{Re.stopPropagation(),o&&(w(o,!0),te())},M=Re=>{Re.stopPropagation(),SN(),te()},L=Re=>{Re.stopPropagation(),d&&(m(d.widgetIndex,d.name,d.type,d.options),te())},K=Re=>{Re.stopPropagation(),y(null),te()},je=Re=>{Re.stopPropagation(),J(!V)},We=Re=>Se=>{Se.stopPropagation(),y({nodeId:n,widgetIndex:Re.widgetIndex,widgetName:Re.name,widgetType:Re.type,options:Re.options}),te()};return u.jsxs("div",{className:"flex items-center gap-1 relative",onClick:Re=>Re.stopPropagation(),children:[F&&u.jsx("button",{type:"button",className:"w-8 h-8 flex items-center justify-center","aria-pressed":O!=="off","aria-label":"Highlight connected nodes",onClick:_,children:u.jsx(nx,{className:"w-6 h-6 overflow-visible",nodeId:n,connectionHighlightMode:O,leftLineCount:D,rightLineCount:I})}),u.jsx(Qr,{onClick:q,buttonRef:re,ariaLabel:"Node options",buttonSize:8,iconSize:5,icon:x?u.jsx(Yr,{className:"w-5 h-5 text-yellow-500"}):void 0}),H&&_n.createPortal(u.jsx("div",{ref:X,className:"fixed z-[1000] w-44",style:me,children:u.jsx(xr,{items:[{key:"edit-label",label:"Edit Label",icon:u.jsx(Bp,{className:"w-4 h-4"}),onClick:de},{key:"toggle-bookmark",label:x?"Remove bookmark":"Bookmark node",icon:x?u.jsx(nc,{className:"w-4 h-4"}):u.jsx(Yr,{className:"w-4 h-4 text-yellow-500"}),onClick:Re=>{Re.stopPropagation(),C(),te()},hidden:!(x||v)},{type:"divider",key:"divider-node-actions"},{key:"toggle-bypass",label:a?"Engage node":"Bypass node",icon:u.jsx(op,{className:"w-4 h-4",isBypassed:a}),onClick:Me},{key:"hide-node",label:"Hide node",icon:u.jsx(Po,{className:"w-4 h-4"}),onClick:Ne},{key:"move-node",label:"Move",icon:u.jsx(ax,{className:"w-4 h-4"}),onClick:Re=>{Re.stopPropagation(),k(),te()}},{key:"open-lora-manager",label:"Open LoRA Manager",icon:u.jsx(rp,{className:"w-4 h-4"}),onClick:M,hidden:!s},{type:"divider",key:"divider-pin",className:c.length>0?"":"hidden"},{key:"pin-single-widget",label:h?"Remove pin":"Pin widget",icon:h?u.jsx(kl,{className:"w-4 h-4 text-fuchsia-500"}):u.jsx(np,{className:"w-4 h-4"}),onClick:L,hidden:!(c.length>0&&d)},{key:"remove-pin",label:"Remove pin",icon:u.jsx(kl,{className:"w-4 h-4 text-fuchsia-500"}),onClick:K,hidden:!(c.length>0&&!d&&p)},{key:"pin-widget-submenu",label:"Pin widget",icon:u.jsx(np,{className:"w-4 h-4"}),rightSlot:u.jsx(Vp,{className:`w-4 h-4 text-gray-400 transition-transform ${V?"rotate-90":""}`}),onClick:je,hidden:!(c.length>0&&!d)},{type:"custom",key:"pin-widget-items",hidden:!(c.length>0&&!d&&V),render:u.jsx("div",{className:"border-t border-gray-100 bg-gray-50 max-h-48 overflow-auto",children:c.map(Re=>u.jsx("button",{className:"w-full text-left px-4 py-2 text-sm hover:bg-gray-100 text-gray-700",onClick:We(Re),children:Re.name},Re.widgetIndex))})},{type:"divider",key:"divider-delete"},{key:"delete-node",label:"Delete node",icon:u.jsx(Ho,{className:"w-4 h-4"}),color:"danger",onClick:Re=>{Re.stopPropagation(),j(),te()}}]})}),document.body)]})}function CN({nodeId:n,open:o,errors:s,anchorRef:a,onClose:l}){const c=y=>{y.stopPropagation(),l()},[d,h]=b.useState(null),p=b.useRef(null),m=oo(y=>y.currentPanel);return b.useEffect(()=>{o&&m!=="workflow"&&l()},[o,m,l]),b.useEffect(()=>{if(!o)return;const y=()=>{const C=a.current;if(!C)return;const N=C.getBoundingClientRect();h({top:N.bottom+8,left:Math.max(16,Math.min(N.left+N.width/2-140,window.innerWidth-296))})};y();const x=C=>{C.target&&(a.current?.contains(C.target)||p.current?.contains(C.target)||l())},v=()=>{l()};return document.addEventListener("pointerdown",x),document.addEventListener("scroll",v,!0),window.addEventListener("resize",y),()=>{document.removeEventListener("pointerdown",x),document.removeEventListener("scroll",v,!0),window.removeEventListener("resize",y)}},[o,n,l,a]),!o||s.length===0||!d?null:_n.createPortal(u.jsxs("div",{ref:p,id:`error-popover-${n}`,className:"error-popover-root fixed z-[2000] bg-red-50 border border-red-700 rounded-lg shadow-lg w-72 max-h-64 overflow-hidden",style:{top:d.top,left:d.left},children:[u.jsxs("div",{id:`error-popover-header-${n}`,className:"popover-header flex items-center justify-between px-3 py-2 border-b border-red-200 bg-red-700",children:[u.jsxs("span",{id:`error-popover-title-${n}`,className:"popover-title text-sm font-semibold text-white",children:[s.length," ",s.length===1?"Error":"Errors"]}),u.jsx("button",{type:"button",onClick:c,className:"w-6 h-6 flex items-center justify-center text-red-200 hover:text-white rounded","aria-label":"Close",children:u.jsx(ex,{className:"w-4 h-4"})})]}),u.jsx("div",{id:`error-popover-body-${n}`,className:"popover-body p-3 space-y-2 bg-red-100",children:s.map((y,x)=>{const v=y.details?.toLowerCase().replace(/[_\s]/g,"")||"",C=y.inputName?.toLowerCase().replace(/[_\s]/g,"")||"",N=!y.details||y.details===y.message||y.inputName&&v===C;return u.jsxs("div",{className:"error-item flex items-start gap-2 text-sm",children:[u.jsx("span",{className:"error-dot mt-1.5 h-1.5 w-1.5 rounded-full bg-red-700 shrink-0","aria-hidden":"true"}),u.jsxs("div",{className:"error-content-wrapper min-w-0",children:[y.inputName&&u.jsx("div",{className:"error-input-name font-medium text-red-800 mb-0.5",children:y.inputName}),u.jsx("div",{className:"error-message-text text-red-800",children:y.message}),!N&&u.jsx("div",{className:"error-details-text text-xs text-red-700 mt-0.5 break-words",children:y.details})]})]},x)})})]}),document.body)}function kN({noteText:n,noteLinkified:o,noteWidgetIndex:s,isEditingNote:a,setIsEditingNote:l,onUpdateNote:c,noteTextareaRef:d,onNoteTap:h}){const p=y=>{s!==null&&c(y)},m=y=>{s!==null&&c(y.target.value)};return u.jsxs("div",{className:"mb-3 group","data-textarea-root":"true",children:[u.jsxs("div",{className:"flex items-center justify-between mb-1.5","data-textarea-header":"true",children:[u.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Note"}),a&&u.jsx(bl,{value:n,onChange:p,textareaRef:d,className:"opacity-70 transition-opacity group-focus-within:opacity-100"})]}),a?u.jsx("textarea",{ref:d,value:n,onChange:m,onBlur:()=>l(!1),className:"w-full p-3 border rounded-lg text-base resize-none note-display",rows:Math.min(8,Math.max(3,n.split(`
`).length))}):u.jsx("div",{className:"w-full p-3 border rounded-lg text-base whitespace-pre-wrap break-words note-display",onDoubleClick:()=>l(!0),onTouchEnd:h,children:o})]})}function jN({show:n,previewImage:o,previewText:s=null,displayName:a,onImageClick:l,isExecuting:c,overallProgress:d,displayNodeProgress:h}){return!n||!o&&!s?null:u.jsxs("div",{className:"mb-3",children:[u.jsx("div",{className:"text-xs text-gray-500 mb-1.5 uppercase tracking-wide",children:"Output Preview"}),o&&u.jsxs("div",{className:"relative",children:[u.jsx("img",{src:mo(o.filename,o.subfolder,o.type),alt:`${a} output`,className:"w-full h-auto rounded-lg border border-gray-100",loading:"lazy",onClick:l},"preview"),c&&d!==null&&u.jsx("div",{className:"absolute inset-0 bg-black/40 rounded-lg flex items-end p-3",children:u.jsxs("div",{className:"w-full",children:[u.jsxs("div",{className:"flex items-center justify-between text-xs text-white/90 mb-1",children:[u.jsx("span",{children:"Progress"}),u.jsxs("span",{children:[h,"%"]})]}),u.jsx("div",{className:"h-2 rounded-full bg-white/30 overflow-hidden",children:u.jsx("div",{className:"h-full bg-green-500 transition-none",style:{width:`${Math.min(100,Math.max(0,h))}%`}})}),u.jsxs("div",{className:"flex items-center justify-between text-xs text-white/90 mt-2 mb-1",children:[u.jsx("span",{children:"Overall"}),u.jsxs("span",{children:[d,"%"]})]}),u.jsx("div",{className:"h-2 rounded-full bg-white/30 overflow-hidden",children:u.jsx("div",{className:"h-full bg-blue-500 transition-none",style:{width:`${Math.min(100,Math.max(0,d))}%`}})})]})})]}),s&&u.jsx("div",{className:`${o?"mt-3":""}`,children:u.jsx("pre",{className:"w-full p-3 comfy-input text-base text-gray-600 opacity-60 whitespace-pre-wrap break-words font-sans",style:{overflowAnchor:"none"},children:s})})]})}function MN({nodeId:n,displayName:o,isEditingLabel:s,labelValue:a,labelInputRef:l,onLabelChange:c,onLabelBlur:d,isCollapsed:h,isBypassed:p,isExecuting:m,overallProgress:y,hasErrors:x,errorIconRef:v,errorPopoverOpen:C,setErrorPopoverOpen:N,toggleNodeFold:w,rightSlot:j}){const k=()=>{s||w()},O=D=>{D.stopPropagation(),w()},R=D=>{D.stopPropagation(),N(!C)};return u.jsxs("div",{id:`node-header-${n}`,className:`node-header flex items-center justify-between cursor-pointer gap-3 ${h?"":"mb-3 pb-2 border-b"} ${p?`bg-purple-200 border-purple-300 px-3 -mx-3 -mt-1 pt-1 rounded-t-xl ${h?"pb-1 -mb-1 rounded-b-xl":""}`:h?"":"border-gray-100"}`,onClick:k,children:[u.jsxs("div",{id:`node-title-container-${n}`,className:"flex items-center gap-1 min-w-0",children:[u.jsx("button",{onClick:O,className:"w-8 h-8 -ml-2 flex items-center justify-center text-gray-400 hover:text-gray-600 shrink-0",children:h?u.jsx(ws,{className:"w-6 h-6"}):u.jsx(no,{className:"w-6 h-6"})}),s?u.jsx("input",{ref:l,value:a,onChange:D=>c(D.target.value),onBlur:d,onKeyDown:D=>{(D.key==="Enter"||D.key==="Escape")&&D.currentTarget.blur()},onClick:D=>D.stopPropagation(),className:"font-semibold text-gray-900 flex-1 min-w-0 text-sm bg-white border border-gray-200 rounded px-2 py-1"}):u.jsx("h3",{id:`node-display-name-${n}`,className:`font-semibold text-gray-900 select-none flex-1 min-w-0 ${h?"whitespace-nowrap overflow-hidden text-ellipsis":"whitespace-normal break-words"}`,children:o}),u.jsxs("span",{id:`node-id-badge-${n}`,className:"text-xs text-gray-400 min-w-[2ch] text-right",children:["#",n]}),x&&u.jsx("button",{ref:v,type:"button",onClick:R,className:"w-5 h-5 flex items-center justify-center text-red-500 hover:text-red-600 shrink-0","aria-label":"View errors",children:u.jsx(tx,{className:"w-4 h-4"})}),m&&h&&y!==null?u.jsxs("div",{id:`node-progress-indicator-${n}`,className:"relative w-6 h-6 flex items-center justify-center",children:[u.jsx(jS,{className:"absolute",width:"24",height:"24",style:{transform:"rotate(-90deg)"},progress:y,radius:10}),u.jsx("span",{id:`node-progress-text-${n}`,className:"text-[8px] font-bold text-blue-600",children:y})]}):null,m&&!h?u.jsx("span",{id:`node-executing-pulse-${n}`,className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}):null]}),u.jsx("div",{id:`node-header-right-slot-${n}`,className:"header-right-slot",children:j})]})}function ON({nodeId:n,displayName:o,hasConnections:s,onCancel:a,onDelete:l}){const c=[s?{label:"Delete & Reconnect",onClick:()=>l(!0),className:"w-full px-4 py-2.5 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700 active:bg-red-800"}:null,{label:s?"Delete & Disconnect":"Delete",onClick:()=>l(!1),className:s?"w-full px-4 py-2.5 text-sm font-medium text-red-700 bg-red-50 rounded-lg hover:bg-red-100 active:bg-red-200":"w-full px-4 py-2.5 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700 active:bg-red-800"},{label:"Cancel",onClick:a,className:"w-full px-4 py-2.5 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 active:bg-gray-300"}].filter(d=>d!==null);return _n.createPortal(u.jsx(Yo,{onClose:a,title:"Delete node",description:u.jsxs(u.Fragment,{children:["Delete ",u.jsx("span",{className:"font-medium text-gray-700",children:o})," (#",n,")?"]}),actionsLayout:"stack",actions:c}),document.body)}function TN({label:n}){return u.jsx("div",{className:"absolute -top-6 left-1/2 -translate-x-1/2 z-[100] animate-in fade-in slide-in-from-bottom-2 duration-200",children:u.jsx("div",{className:"bg-red-600 text-white text-[10px] font-black px-2 py-0.5 rounded-full shadow-lg whitespace-nowrap uppercase tracking-tighter ring-2 ring-white",children:n})})}function Go(n){return n.toLowerCase().replace(/[_-]+/g," ").replace(/\s+/g," ").trim()}function ap(n,o){if(!n.trim())return!0;const s=Go(o);return Go(n).split(" ").filter(Boolean).every(a=>s.includes(a))}function Ku(n,o){if(!n)return!0;let s=0;for(const a of o)if(a===n[s]&&(s+=1),s>=n.length)return!0;return!1}function Ro(n,o){if(!n)return 0;const s=Go(n),a=Go(o);return a?a===s?120:a.startsWith(s)?90:a.includes(s)?70:Ku(s,a)?40:0:0}function ms(n){return n.replace(/^custom_nodes\./,"").replace(/[._-]+/g," ").replace(/\s+/g," ").trim()}function cx(n){const o=String(n).split(",")[0].trim().toUpperCase();return["IMAGE","LATENT","MODEL","CLIP","VAE","CONDITIONING","INT","FLOAT","STRING","BOOLEAN","MASK"].includes(o)?`type-${o}`:"type-default"}function Of(n){if(n==null)return null;const o=String(n).trim();if(!o)return null;const s=o.toLowerCase();return s==="null"||s==="undefined"?null:o}function ys(n,o){return Of(n?.display_name)??Of(n?.name)??Of(o)??o}function lp(n,o,s,a){const l=o.trim(),c=n.map(d=>{const{displayName:h,typeName:p,category:m="",pack:y=""}=s(d),x=`${h} ${p} ${m} ${y}`;if(!(!l||ap(l,x)||Ku(Go(l),Go(x))))return null;const C=l?Ro(l,h)*10+Ro(l,p)*4:0;return{item:d,score:C}}).filter(d=>d!==null);return c.sort((d,h)=>h.score!==d.score?h.score-d.score:a(d.item)-a(h.item)),c.map(d=>d.item)}function EN({nodeId:n,displayName:o,pack:s,outputName:a,outputType:l,inputName:c,isConnected:d,onSelect:h}){return u.jsx("button",{type:"button",className:`w-full text-left rounded-xl border px-4 py-3 shadow-sm transition ${d?"border-blue-300 bg-white":"border-gray-200 bg-white hover:border-gray-300 active:scale-[0.998]"}`,onClick:h,children:u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsxs("div",{className:"text-sm font-semibold text-gray-900 flex items-center gap-2 min-w-0",children:[u.jsxs("span",{className:"truncate",children:[o," ",u.jsxs("span",{className:"text-gray-400",children:["#",n]})]}),d&&u.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-blue-100 text-blue-700 text-[10px] font-medium shrink-0",children:[u.jsx(zo,{className:"w-3 h-3"}),"Currently connected"]})]}),u.jsx("div",{className:"text-xs text-gray-500 truncate mt-0.5",children:s||"Core"}),u.jsxs("div",{className:"text-xs text-gray-700 mt-1 inline-flex items-center gap-1.5",children:[u.jsx("span",{className:`inline-flex h-5 w-5 items-center justify-center rounded-full text-[11px] font-bold ${cx(l)}`,children:""}),u.jsxs("span",{className:"truncate",children:[a," -> ",c]})]})]})})}function Ml({onClick:n,ariaLabel:o="Close",variant:s="default",buttonSize:a=10,iconSize:l=6,isIdle:c,zIndex:d}){const h=typeof c=="boolean"||typeof d=="number",p=h?"viewer":s;return u.jsx("button",{onClick:n,className:`transition-colors flex items-center justify-center rounded-full ${p==="viewer"?`absolute top-3 right-3 w-${a} h-${a} text-white ${c?"bg-transparent":"bg-black/60"}`:p==="plain"?`w-${a} h-${a} text-gray-500 bg-transparent hover:bg-transparent`:`w-${a} h-${a} bg-gray-100 dark:bg-gray-800 text-gray-500 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700`}`.trim(),style:h&&typeof d=="number"?{zIndex:d}:void 0,"aria-label":o,children:u.jsx(Rl,{className:`w-${l} h-${l}`})})}function dx({isOpen:n,onClose:o,title:s,searchQuery:a,onSearchQueryChange:l,searchPlaceholder:c,onBack:d,backLabel:h="Back",children:p,footer:m,zIndex:y=2200}){return n?_n.createPortal(u.jsx("div",{className:"fixed inset-0 bg-gray-400/40 backdrop-blur-sm",style:{zIndex:y},onClick:o,children:u.jsxs("div",{className:"w-full h-full flex flex-col",onClick:x=>x.stopPropagation(),children:[u.jsxs("div",{className:"bg-white border-b border-gray-200 px-4 py-3 flex items-center justify-between safe-area-inset-top",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[d&&u.jsx("button",{type:"button",className:"text-sm text-blue-600 font-medium",onClick:d,children:h}),u.jsx("h2",{className:"text-base font-semibold text-gray-900",children:s})]}),u.jsx(Ml,{onClick:o,variant:"plain",buttonSize:8,iconSize:5})]}),u.jsx("div",{className:"bg-white px-4 py-2 border-b border-gray-100",children:u.jsx(zl,{value:a,onChange:l,placeholder:c,autoFocus:!0})}),p,m??u.jsx("div",{className:"flex-shrink-0 h-12 bg-white border-t border-gray-200 flex items-center justify-center",children:u.jsx("button",{type:"button",className:"text-sm text-gray-500 font-medium",onClick:o,children:"Cancel"})})]})}),document.body):null}function ip({title:n,subtitle:o,onSelect:s,outputType:a,outputName:l,inputName:c,titleClassName:d="text-sm font-semibold text-gray-900 truncate"}){return u.jsx("button",{type:"button",className:"w-full text-left rounded-xl border border-gray-200 bg-white px-4 py-3 shadow-sm hover:border-gray-300 active:scale-[0.998] transition",onClick:s,children:u.jsxs("div",{className:"min-w-0",children:[u.jsx("div",{className:d,children:n}),u.jsx("div",{className:"text-xs text-gray-500 truncate mt-0.5",children:o||"Core"}),a&&l&&c&&u.jsxs("div",{className:"text-xs text-gray-700 mt-1 inline-flex items-center gap-1.5",children:[u.jsx("span",{className:`inline-flex h-5 w-5 items-center justify-center rounded-full text-[11px] font-bold ${cx(a)}`,children:""}),u.jsxs("span",{className:"truncate",children:[String(l)," -> ",c]})]})]})})}function gl({query:n,message:o}){return n.trim()?u.jsx("div",{className:"px-4 py-8 text-center text-sm text-gray-500",children:o}):null}function Wo(n,o){return`${n}:${o}`}function IN(n,o){if(n.size!==o.size)return!1;for(const s of n)if(!o.has(s))return!1;return!0}function Ry(n){const{isOpen:o,onClose:s,nodeId:a,mode:l}=n,c=fe(z=>z.workflow),d=fe(z=>z.nodeTypes),h=fe(z=>z.connectNodes),p=fe(z=>z.disconnectInput),m=fe(z=>z.addNode),y=fe(z=>z.addNodeAndConnect),x=fe(z=>z.scrollToNode),[v,C]=b.useState(""),[N,w]=b.useState("pick"),[j,k]=b.useState(()=>{if(l!=="output"||!c)return new Set;const z=new Set;for(const $ of c.links){const[,ee,pe,ae,ke]=$;ee===a&&pe===n.outputIndex&&z.add(Wo(ae,ke))}return z}),[O,R]=b.useState(!1),[D,I]=b.useState(null),[H,A]=b.useState(new Set),V=b.useMemo(()=>c?c.nodes.find($=>$.id===a)?.stableKey??null:null,[a,c]),J=z=>{const $=fe.getState().workflow;return $?$.nodes.find(pe=>pe.id===z)?.stableKey??null:null},X=b.useMemo(()=>l!=="input"||!c||!d?[]:v2(c,d,a,n.inputIndex),[l,c,d,a,n]),re=b.useMemo(()=>{if(l!=="input")return[];const z=v.trim(),$=X.map(ee=>{const{node:pe}=ee,ae=d?.[pe.type],ke=pe.title,U=typeof ke=="string"&&ke.trim()?ke.trim():ae?.display_name||pe.type,ce=`${U} ${ae?.display_name??""} ${pe.type} ${String(pe.id)}`;if(!(!z||ap(z,ce)||Ku(Go(z),Go(ce))))return null;const Ve=Ro(z,U)*4+Ro(z,ae?.display_name??"")*3+Ro(z,pe.type)*2+Ro(z,String(pe.id));return{...ee,score:Ve}}).filter(Boolean);return $.sort((ee,pe)=>pe.score-ee.score||ee.node.id-pe.node.id),$},[l,X,v,d]),te=b.useMemo(()=>l!=="input"||!d?[]:w2(d,n.inputType).map((z,$)=>({...z,index:$})),[l,d,n]),me=b.useMemo(()=>l!=="output"||!d?[]:N2(d,n.outputType).map((z,$)=>({...z,index:$})),[l,d,n]),Te=b.useMemo(()=>l!=="input"?[]:lp(te,v,z=>{const $=ys(z.def,z.typeName),ee=ys({display_name:z.def.name,name:z.typeName},z.typeName),pe=ms(z.def.python_module||z.def.category?.split("/")[0]||"Core");return{displayName:$,typeName:ee,category:String(z.def.category??""),pack:pe}},z=>z.index),[l,te,v]),F=b.useMemo(()=>l!=="output"?[]:lp(me,v,z=>{const $=ys(z.def,z.typeName),ee=ys({display_name:z.def.name,name:z.typeName},z.typeName),pe=ms(z.def.python_module||z.def.category?.split("/")[0]||"Core");return{displayName:$,typeName:ee,category:String(z.def.category??""),pack:pe}},z=>z.index),[l,me,v]),_=b.useMemo(()=>{if(l!=="output"||!c||!d)return[];const z=C2(c,a,n.outputIndex),$=new Set;for(const ke of c.links){const[,U,ce,He,Ve]=ke;U===a&&ce===n.outputIndex&&$.add(Wo(He,Ve))}const ee=v.trim(),ae=z.map(({node:ke,inputIndex:U})=>{const ce=d[ke.type],He=ke.title,Ve=typeof He=="string"&&He.trim()?He.trim():ce?.display_name||ke.type,qe=ms(String(ce?.python_module??ce?.category?.split("/")[0]??"Core")),ot=ke.inputs?.[U];if(!ot)return null;const Ge=ot.localized_name||ot.name||`Input ${U+1}`,Xe=String(ot.type),Ie=Wo(ke.id,U),_e=$.has(Ie);let Ze=!1,wt=null;const pt=ot.link;if(pt!=null&&!_e){const Pe=c.links.find(Fe=>Fe[0]===pt);if(Pe){Ze=!0;const[,Fe]=Pe,Ke=c.nodes.find(Je=>Je.id===Fe);Ke&&(wt=`${d[Ke.type]?.display_name||Ke.type} #${Ke.id}`)}}const Lt=`${Ve} ${ce?.display_name??""} ${ke.type} ${String(ke.id)} ${Ge}`;if(!(!ee||ap(ee,Lt)||Ku(Go(ee),Go(Lt))))return null;const Vt=Ro(ee,Ve)*4+Ro(ee,Ge)*3+Ro(ee,ce?.display_name??"")*2+Ro(ee,ke.type)*2+Ro(ee,String(ke.id));return{nodeId:ke.id,inputIndex:U,displayName:Ve,pack:qe,inputName:Ge,inputType:Xe,currentlyConnectedFromThisOutput:_e,hasExistingLink:Ze,existingSourceLabel:wt,score:Vt}}).filter(ke=>ke!==null);return ae.sort((ke,U)=>U.score-ke.score||ke.nodeId-U.nodeId),ae},[l,c,d,a,n,v]),q=b.useMemo(()=>l!=="output"?new Set:new Set(_.filter(z=>z.currentlyConnectedFromThisOutput).map(z=>Wo(z.nodeId,z.inputIndex))),[l,_]),de=b.useMemo(()=>{const z=new Map;for(const $ of _)z.set(Wo($.nodeId,$.inputIndex),$);return z},[_]),Me=b.useMemo(()=>{if(l!=="output")return[];const z=new Map;for(const $ of _){const ee=z.get($.nodeId);if(ee){ee.inputs.push($),$.score>ee.score&&(ee.score=$.score);continue}z.set($.nodeId,{nodeId:$.nodeId,displayName:$.displayName,pack:$.pack,score:$.score,inputs:[$]})}return Array.from(z.values()).sort(($,ee)=>ee.score-$.score||$.nodeId-ee.nodeId)},[l,_]),Ne=b.useMemo(()=>l!=="output"?!1:!IN(j,q),[l,j,q]),M=b.useMemo(()=>{if(l!=="output")return[];const z=[];for(const $ of j){if(q.has($))continue;const ee=de.get($);ee?.hasExistingLink&&z.push(ee)}return z},[l,j,q,de]),L=(z,$)=>{if(l!=="input")return;const ee=J(z);!ee||!V||(h(ee,$,V,n.inputIndex,n.inputType),s(),x(ee))},K=()=>{l==="input"&&V&&(p(V,n.inputIndex),s())},je=z=>{if(l!=="input"||!V)return;const $=y(z,V,n.inputIndex);if(s(),$!==null){const ee=J($);ee&&x(ee)}},We=(z,$,ee)=>{if(l!=="output"||!V)return;const pe=m(z,{nearNodeStableKey:V});if(pe===null)return;const ae=J(pe);if(!ae)return;const U=fe.getState().workflow?.nodes.find(qe=>qe.id===pe);if(!U||!V)return;const ce=U.inputs.findIndex(qe=>qe.type.toUpperCase()===ee.toUpperCase()),He=ce>=0?ce:$,Ve=U.inputs[He]?.type;Ve!=null&&(h(V,n.outputIndex,ae,He,Ve),s(),x(ae))},Re=(z,$)=>{const ee=Wo(z,$);k(pe=>{const ae=new Set(pe);return ae.has(ee)?ae.delete(ee):ae.add(ee),ae})},Se=z=>{const $=new Set;for(const ee of z.inputs){const pe=Wo(ee.nodeId,ee.inputIndex);j.has(pe)&&$.add(pe)}I(z.nodeId),A($)},Ee=()=>{I(null),A(new Set)},xe=z=>{A($=>{const ee=new Set($);return ee.has(z)?ee.delete(z):ee.add(z),ee})},se=()=>{if(D==null)return;const z=Me.find(ee=>ee.nodeId===D);if(!z){Ee();return}const $=z.inputs.map(ee=>Wo(ee.nodeId,ee.inputIndex));k(ee=>{const pe=new Set(ee);for(const ae of $)pe.delete(ae);for(const ae of H)pe.add(ae);return pe}),Ee()},Z=z=>{if(z.inputs.length>1){Se(z);return}const $=z.inputs[0];$&&Re($.nodeId,$.inputIndex)},T=()=>{if(l==="output"){for(const z of q){if(j.has(z))continue;const $=de.get(z);if(!$)continue;const ee=J($.nodeId);ee&&p(ee,$.inputIndex)}for(const z of j){if(q.has(z))continue;const $=de.get(z);if(!$)continue;const ee=J($.nodeId);!ee||!V||h(V,n.outputIndex,ee,$.inputIndex,$.inputType)}s()}},ie=()=>{if(l==="output"){if(M.length>0){R(!0);return}T()}},G=l==="input"?N==="pick"?`Connect ${n.inputName}`:"Add new node":N==="pick"?`Connect ${n.outputName}`:"Add new node",ge=l==="input"?N==="pick"?"Search existing nodes...":"Search node types...":N==="pick"?"Search target nodes...":"Search node types...",B=()=>{if(l!=="input")return null;const z=n;return u.jsxs("div",{className:"px-3 pt-3 pb-20 flex flex-col gap-2",children:[re.map(({node:$,outputIndex:ee})=>{const pe=d?.[$.type],ae=$.title,ke=typeof ae=="string"&&ae.trim()?ae.trim():pe?.display_name||$.type,U=ms(String(pe?.python_module??pe?.category?.split("/")[0]??"Core")),ce=$.outputs?.[ee],He=ce?.localized_name||ce?.name||`Output ${ee+1}`,Ve=String(ce?.type??z.inputType),qe=$.id===z.currentlyConnectedNodeId;return u.jsx(EN,{nodeId:$.id,displayName:ke,pack:U,outputName:He,outputType:Ve,inputName:z.inputName,isConnected:qe,onSelect:()=>L($.id,ee)},$.id)}),re.length===0&&u.jsx(gl,{query:v,message:"No matching nodes found"}),u.jsxs("button",{type:"button",className:"w-full text-left rounded-xl border-2 border-gray-700 bg-white px-4 py-3 flex items-center gap-3 hover:bg-gray-100 active:scale-[0.998] transition shadow-sm",onClick:()=>{w("addNew"),C("")},children:[u.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-800 flex items-center justify-center flex-shrink-0",children:u.jsx(Eo,{className:"w-4 h-4 text-white"})}),u.jsx("span",{className:"text-sm font-semibold text-gray-900",children:"Add new node..."})]}),z.currentlyConnectedNodeId!==null&&u.jsx("button",{type:"button",className:"w-full text-left rounded-xl border border-red-200 bg-red-50 px-4 py-3 text-sm font-semibold text-red-600 hover:bg-red-100 active:scale-[0.998] transition",onClick:K,children:"Disconnect"})]})},ne=()=>{if(l!=="input")return null;const z=n;return u.jsxs("div",{className:"px-3 pt-3 pb-20 flex flex-col gap-2",children:[Te.length===0&&u.jsx(gl,{query:v,message:"No matching node types found"}),Te.map(({typeName:$,def:ee,outputIndex:pe})=>{const ae=ms(String(ee.python_module??ee.category?.split("/")[0]??"Core")),ke=String(ee.output?.[pe]??z.inputType),U=ee.output_name?.[pe]??ee.output?.[pe]??"Output";return u.jsx(ip,{title:ys(ee,$),subtitle:ae||"Core",outputType:ke,outputName:String(U),inputName:z.inputName,titleClassName:"text-sm font-medium text-gray-900 truncate",onSelect:()=>je($)},$)})]})},W=()=>{if(l!=="output")return null;const z=n;return u.jsxs("div",{className:"px-3 pt-3 pb-20 flex flex-col gap-2",children:[Me.map($=>{const pe=$.inputs.filter(ce=>j.has(Wo(ce.nodeId,ce.inputIndex))).length>0,ae=$.inputs.some(ce=>ce.hasExistingLink),ke=$.inputs.some(ce=>ce.currentlyConnectedFromThisOutput),U=$.inputs.length>1?`${$.inputs.length} compatible inputs`:`${z.outputName} -> ${$.inputs[0]?.inputName??"Input"}`;return u.jsx("button",{type:"button",className:`w-full text-left rounded-xl border px-4 py-3 shadow-sm transition ${pe?"border-blue-300 bg-blue-50":"border-gray-200 bg-white hover:border-gray-300 active:scale-[0.998]"}`,onClick:()=>Z($),children:u.jsxs("div",{className:"flex items-start justify-between gap-3",children:[u.jsxs("div",{className:"min-w-0 flex-1",children:[u.jsxs("div",{className:"text-sm font-semibold text-gray-900 flex items-center gap-2 min-w-0",children:[u.jsxs("span",{className:"truncate",children:[$.displayName," ",u.jsxs("span",{className:"text-gray-400",children:["#",$.nodeId]})]}),ke&&u.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-blue-100 text-blue-700 text-[10px] font-medium shrink-0",children:[u.jsx(zo,{className:"w-3 h-3"}),"Connected"]}),ae&&u.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full bg-amber-100 text-amber-700 text-[10px] font-medium shrink-0",children:"Already linked"})]}),u.jsx("div",{className:"text-xs text-gray-500 truncate mt-0.5",children:$.pack||"Core"}),u.jsx("div",{className:"text-xs text-gray-700 mt-1 truncate",children:U})]}),u.jsx("div",{className:`w-5 h-5 rounded border flex items-center justify-center ${pe?"bg-blue-600 border-blue-600":"bg-white border-gray-300"}`,children:pe&&u.jsx(zo,{className:"w-3 h-3 text-white"})})]})},`output-node-${$.nodeId}`)}),Me.length===0&&u.jsx(gl,{query:v,message:"No matching target nodes found"}),u.jsxs("button",{type:"button",className:"w-full text-left rounded-xl border-2 border-gray-700 bg-white px-4 py-3 flex items-center gap-3 hover:bg-gray-100 active:scale-[0.998] transition shadow-sm",onClick:()=>{w("addNew"),C("")},children:[u.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-800 flex items-center justify-center flex-shrink-0",children:u.jsx(Eo,{className:"w-4 h-4 text-white"})}),u.jsx("span",{className:"text-sm font-semibold text-gray-900",children:"Add new node..."})]})]})},P=()=>{if(l!=="output")return null;const z=n;return u.jsxs("div",{className:"px-3 pt-3 pb-20 flex flex-col gap-2",children:[F.length===0&&u.jsx(gl,{query:v,message:"No matching node types found"}),F.map(({typeName:$,def:ee,inputIndex:pe,inputType:ae,inputName:ke})=>{const U=ms(String(ee.python_module??ee.category?.split("/")[0]??"Core"));return u.jsx(ip,{title:ys(ee,$),subtitle:U||"Core",outputType:z.outputType,outputName:z.outputName,inputName:String(ke),titleClassName:"text-sm font-medium text-gray-900 truncate",onSelect:()=>We($,pe,ae)},$)})]})};return u.jsxs(dx,{isOpen:o,onClose:s,title:G,searchQuery:v,onSearchQueryChange:C,searchPlaceholder:ge,onBack:N==="addNew"?()=>{w("pick"),C("")}:void 0,footer:u.jsx(ix,{zIndex:2201,actions:[{key:"cancel",label:"Cancel",onClick:s,variant:"secondary"},...l==="output"&&N==="pick"?[{key:"apply",label:"Apply",onClick:ie,variant:"primary",disabled:!Ne}]:[]]}),children:[u.jsx("div",{className:"flex-1 overflow-auto bg-white",children:l==="input"?N==="pick"?B():ne():N==="pick"?W():P()}),l==="output"&&D!=null&&u.jsx("div",{className:"fixed inset-0 z-[2250] bg-black/40 flex items-center justify-center p-4",onClick:Ee,role:"dialog","aria-modal":"true",children:u.jsxs("div",{className:"w-full max-w-sm bg-white border border-gray-200 rounded-xl shadow-lg overflow-hidden",onClick:z=>z.stopPropagation(),children:[u.jsx("div",{className:"px-4 py-3 text-sm font-semibold text-gray-700 border-b border-gray-100",children:"Select compatible inputs"}),u.jsx("div",{className:"max-h-[45vh] overflow-y-auto",children:Me.find(z=>z.nodeId===D)?.inputs.map(z=>{const $=Wo(z.nodeId,z.inputIndex),ee=H.has($);return u.jsxs("button",{type:"button",className:`w-full flex items-center justify-between gap-3 text-left px-4 py-3 text-sm ${ee?"bg-blue-50":"hover:bg-gray-50"}`,onClick:()=>xe($),children:[u.jsxs("span",{className:"min-w-0",children:[u.jsx("span",{className:"block text-gray-900 truncate",children:z.inputName}),u.jsx("span",{className:"block text-xs text-gray-500 truncate",children:z.inputType})]}),u.jsx("span",{className:`w-5 h-5 rounded border flex items-center justify-center shrink-0 ${ee?"bg-blue-600 border-blue-600":"bg-white border-gray-300"}`,children:ee?u.jsx(zo,{className:"w-3 h-3 text-white"}):null})]},`input-picker-${$}`)})}),u.jsxs("div",{className:"px-3 py-3 border-t border-gray-100 flex justify-end gap-2",children:[u.jsx("button",{type:"button",className:"px-3 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-100",onClick:Ee,children:"Cancel"}),u.jsx("button",{type:"button",className:"px-3 py-2 rounded-lg text-sm font-medium text-white bg-blue-600 hover:bg-blue-700",onClick:se,children:"Apply"})]})]})}),l==="output"&&O&&u.jsx(Yo,{onClose:()=>R(!1),title:"Overwrite existing connections?",description:"Some selected inputs are already connected. Continuing will disconnect their current source and reconnect to this output.",actions:[{label:"Cancel",onClick:()=>R(!1),className:"px-3 py-1.5 rounded-lg text-sm text-gray-700 border border-gray-300 hover:bg-gray-50"},{label:"Overwrite",onClick:()=>{R(!1),T()},className:"px-3 py-1.5 rounded-lg text-sm text-white bg-red-600 hover:bg-red-700"}]})]})}function LN(n,o,s,a){const l=n.nodes.find(y=>y.id===o);if(!l||l.type!=="Reroute")return a;let c=null;const d=[],h=new Set,p=l.inputs[0]?.link;if(p!=null){const y=n.links.find(x=>x[0]===p);if(y){const x=y[1],v=y[2],N=n.nodes.find(w=>w.id===x)?.outputs[v];c=N?.localized_name||N?.name||null}}for(const y of l.outputs){const x=y.links??[];for(const v of x){const C=n.links.find(R=>R[0]===v);if(!C)continue;const N=C[3],w=C[4],k=n.nodes.find(R=>R.id===N)?.inputs[w],O=k?.localized_name||k?.name||null;O&&!h.has(O)&&(h.add(O),d.push(O))}}const m=d.map((y,x)=>x<d.length-1?`${y}/`:y).join(`
`);return d.length>1?m:s==="input"?c||m||a:m||c||a}function _N({direction:n,hasConnection:o,isEmptyRequiredInput:s=!1,hideLabel:a,resolvedLabel:l,shouldWrapResolvedLabel:c,sizeClass:d,arrowClass:h,typeClass:p,buttonRef:m,connectionCount:y,onClick:x,onPointerDown:v,onPointerMove:C,onPointerUp:N}){const w=n==="input",j=w?!o&&!s:!1,k=!w&&!o,O=d.includes("w-7")?"w-3 h-3":"w-3.5 h-3.5";return u.jsxs(u.Fragment,{children:[w?null:!a&&u.jsx("span",{className:`text-sm text-gray-700 flex-1 min-w-0 ${c?"whitespace-pre-line break-words leading-tight text-right":"truncate"}`,children:l}),!w&&y>1&&u.jsx("span",{className:"bg-gray-200 text-gray-700 rounded-full px-2 py-0.5 text-xs font-medium flex-shrink-0",children:y}),u.jsx("button",{onClick:x,onPointerDown:v,onPointerMove:C,onPointerUp:N,onPointerCancel:N,disabled:j,ref:m,className:`
          flex items-center justify-center rounded-full font-medium box-border
          border-2
          ${d} flex-shrink-0
          transition-opacity
          ${p}
          ${w&&s?"opacity-100 cursor-pointer border-red-500":"border-transparent"}
          ${!w&&k?"border-dashed border-gray-400/70":""}
          ${j?"opacity-40 cursor-not-allowed":""}
          ${!j&&k?"opacity-50 cursor-pointer active:scale-95":""}
          ${!j&&!k?"opacity-100 cursor-pointer active:scale-95":""}
        `,children:w?u.jsxs(u.Fragment,{children:[o&&u.jsx("span",{className:h,children:""}),!o&&u.jsx(Eo,{className:O})]}):o?u.jsx("span",{className:h,children:""}):u.jsx(Eo,{className:O})}),!w&&a?null:w&&!a&&u.jsx("span",{className:`text-sm flex-1 min-w-0 ${c?"whitespace-pre-line break-words leading-tight":"truncate"} ${s?"text-red-600 font-medium":"text-gray-700"}`,children:l})]})}function AN(n){const o=String(n).split(",")[0].trim();return["IMAGE","LATENT","MODEL","CLIP","VAE","CONDITIONING","INT","FLOAT","STRING","BOOLEAN","MASK"].includes(o)?`type-${o}`:"type-default"}function Dy(n){return String(n).split(",").map(o=>o.trim().toUpperCase()).filter(Boolean)}const By=b.memo(function({slot:o,nodeId:s,direction:a,slotIndex:l,compact:c=!1,hideLabel:d=!1,isRequired:h=!1}){const p=fe(xe=>xe.workflow),m=fe(xe=>xe.scrollToNode),y=fe(xe=>xe.revealNodeWithParents),x=fe(xe=>xe.nodeTypes),v=fe(xe=>xe.hiddenItems),[C,N]=b.useState(!1),[w,j]=b.useState(!1),k=b.useRef(null),O=b.useRef(null),[R,D]=b.useState(null),I=b.useRef(null),H=b.useRef(null),A=b.useRef(null),V=b.useRef(!1),J=b.useMemo(()=>{const xe=o.localized_name||o.name;return p?LN(p,s,a,xe):xe},[p,a,o.localized_name,o.name,s]),X=b.useMemo(()=>{if(!p)return[];const xe=[];if(a==="input"){if(o.link!=null){const Z=ha(p,s,l);Z&&xe.push(Z.node)}}else{const se=wl(p,s,l);for(const Z of se)xe.push(Z.node)}return xe},[p,s,a,o,l]),{effectiveNodes:re,directNodes:te,bypassedTargets:me}=b.useMemo(()=>{if(!p)return{effectiveNodes:[],directNodes:[],bypassedTargets:[]};if(Object.keys(v).length===0)return{effectiveNodes:X,directNodes:X,bypassedTargets:[]};const xe=new Map(p.nodes.map(P=>[P.id,P])),se=P=>!!(P.stableKey&&v[P.stableKey]),Z=new Set,T=P=>{if(Z.has(P))return[];Z.add(P);const z=xe.get(P);if(!z)return[];const $=[];return z.outputs?.forEach((ee,pe)=>{wl(p,P,pe).forEach(ke=>{const U=ke.node;se(U)?$.push(...T(U.id)):$.push(U)})}),$},ie=P=>{if(Z.has(P))return[];Z.add(P);const z=xe.get(P);if(!z)return[];const $=[];return z.inputs?.forEach((ee,pe)=>{if(ee.link===null)return;const ae=ha(p,P,pe);ae&&(se(ae.node)?$.push(...ie(ae.node.id)):$.push(ae.node))}),$},G=[],ge=[];X.forEach(P=>{se(P)?a==="input"?ge.push(...ie(P.id)):ge.push(...T(P.id)):G.push(P)});const B=new Set(G.map(P=>P.id));let W=(P=>{const z=[],$=new Set;return P.forEach(ee=>{B.has(ee.id)||$.has(ee.id)||($.add(ee.id),z.push(ee))}),z})(ge);if(a==="input"&&W.length>1){const P=new Set(Dy(o.type)),z=W.filter($=>$.outputs?.some(ee=>Dy(ee.type).some(pe=>P.has(pe))));z.length>0&&(W=z)}return{effectiveNodes:[...G,...W],directNodes:G,bypassedTargets:W}},[X,p,a,o.type,v]),Te=re.length,F=Te===1?re[0].id:null,_=Te>0,q=a==="input"&&!_&&h,de=b.useCallback(()=>{H.current!=null&&(window.clearTimeout(H.current),H.current=null)},[]),Me=b.useCallback(xe=>xe.stableKey??null,[]),Ne=()=>{if(V.current){V.current=!1;return}if(a==="output"&&!_){j(!0);return}if(q){j(!0);return}if(_){if(Te===1&&F!==null){const xe=re[0],se=xe?Me(xe):null;se&&(y(se),m(se));return}N(xe=>!xe)}},M=b.useCallback(xe=>{(a!=="input"||_)&&(A.current={x:xe.clientX,y:xe.clientY},V.current=!1,H.current=window.setTimeout(()=>{H.current=null,V.current=!0,j(!0)},500))},[a,_]),L=b.useCallback(xe=>{if(!A.current)return;const se=xe.clientX-A.current.x,Z=xe.clientY-A.current.y;Math.hypot(se,Z)>8&&de()},[de]),K=b.useCallback(()=>{de(),A.current=null},[de]),je=xe=>se=>{se.stopPropagation();const Z=re.find(ie=>ie.id===xe),T=Z?Me(Z):null;T&&(y(T),m(T)),N(!1)};b.useLayoutEffect(()=>{if(!C)return;const xe=()=>{const se=O.current;if(!se)return;const Z=se.getBoundingClientRect(),T=8;D({top:Z.bottom+6,...a==="input"?{left:Math.min(Z.left,window.innerWidth-T)}:{right:Math.max(T,window.innerWidth-Z.right)}})};return I.current=xe,xe(),()=>{}},[C,Te,a]),b.useEffect(()=>{if(!C)return;const xe=()=>I.current?.(),se=T=>{!k.current||!T.target||O.current?.contains(T.target)||k.current.contains(T.target)||N(!1)},Z=T=>{const ie=T.target;k.current&&ie&&k.current.contains(ie)||N(!1)};return document.addEventListener("mousedown",se),document.addEventListener("scroll",Z,!0),window.addEventListener("resize",xe),()=>{document.removeEventListener("mousedown",se),document.removeEventListener("scroll",Z,!0),window.removeEventListener("resize",xe)}},[C]),b.useEffect(()=>()=>de(),[de]);const We=c?"w-7 h-7":"w-10 h-10",Re=c?"text-sm":"text-base";if(!p)return null;const Se=a==="input"&&_&&F!==null?F:null,Ee=J.includes("/")||J.includes(`
`);return u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(_N,{direction:a,hasConnection:_,isEmptyRequiredInput:q,hideLabel:d,resolvedLabel:J,shouldWrapResolvedLabel:Ee,sizeClass:We,arrowClass:Re,typeClass:AN(o.type),buttonRef:O,connectionCount:Te,onClick:Ne,onPointerDown:M,onPointerMove:L,onPointerUp:K}),C&&R&&_n.createPortal(u.jsx("div",{ref:k,className:"fixed z-[1000]",style:{top:R.top,right:R.right,left:R.left,maxWidth:"calc(100vw - 16px)"},children:u.jsx(xr,{items:[...te.map(xe=>{const Z=x?.[xe.type]?.display_name||xe.type;return{key:`direct-${xe.id}`,label:`${Z} #${xe.id}`,onClick:je(xe.id)}}),{type:"custom",key:"bypassed-label",hidden:!(te.length>0&&me.length>0),render:u.jsx("div",{className:"px-3 py-1",children:u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("div",{className:"h-px flex-1 bg-gray-200"}),u.jsx("span",{className:"text-[10px] text-gray-400",children:"(via bypassed)"}),u.jsx("div",{className:"h-px flex-1 bg-gray-200"})]})})},...me.map(xe=>{const Z=x?.[xe.type]?.display_name||xe.type;return{key:`bypassed-${xe.id}`,label:`${Z} #${xe.id}`,onClick:je(xe.id)}})]})}),document.body),w&&(a==="input"?u.jsx(Ry,{mode:"input",isOpen:w,onClose:()=>j(!1),nodeId:s,inputIndex:l,inputType:o.type,inputName:J,currentlyConnectedNodeId:Se}):u.jsx(Ry,{mode:"output",isOpen:w,onClose:()=>j(!1),nodeId:s,outputIndex:l,outputType:o.type,outputName:J}))]})});function RN({nodeId:n,nodeType:o,inputs:s,outputs:a,allInputs:l,allOutputs:c}){const d=fe(m=>m.connectionButtonsVisible),h=fe(m=>m.nodeTypes),p=b.useMemo(()=>{if(!o||!h)return new Set;const m=h[o];return m?.input?.required?new Set(Object.keys(m.input.required)):new Set},[o,h]);return!d||s.length===0&&a.length===0?null:u.jsxs("div",{className:"node-connections mb-3 grid grid-cols-2 gap-3",children:[u.jsx("div",{children:s.length>0&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"text-xs text-gray-500 mb-1.5 uppercase tracking-wide",children:"Inputs"}),u.jsx("div",{className:"flex flex-col gap-1.5",children:s.map((m,y)=>{const x=l.indexOf(m),v=x>=0?x:y;return u.jsx(By,{slot:m,nodeId:n,direction:"input",slotIndex:v,isRequired:p.has(m.name)},`input-${v}`)})})]})}),u.jsx("div",{className:"flex flex-col items-end",children:a.length>0&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"text-xs text-gray-500 mb-1.5 uppercase tracking-wide text-right w-full",children:"Outputs"}),u.jsx("div",{className:"flex flex-col gap-1.5 w-full items-end",children:a.map((m,y)=>{const x=c.indexOf(m),v=x>=0?x:y;return u.jsx(By,{slot:m,nodeId:n,direction:"output",slotIndex:v},`output-${v}`)})})]})})]})}function DN({nodeId:n,nodeType:o,inputs:s,outputs:a,allInputs:l,allOutputs:c}){return u.jsx(RN,{nodeId:n,nodeType:o,inputs:s,outputs:a,allInputs:l,allOutputs:c})}function BN({title:n,onClose:o,headerActions:s,isDark:a}){return u.jsx("div",{className:"bg-white p-4 border-b border-gray-200 dark:border-gray-800 shadow-sm relative z-50 min-h-0 overflow-y-auto shrink-0",style:{maxHeight:"var(--top-bar-offset)",...a?{backgroundColor:Dt.surface.darkPanel}:{}},children:u.jsxs("div",{className:"flex justify-between items-start mb-2",children:[u.jsx("span",{className:"font-semibold text-gray-700 dark:text-gray-200 truncate pr-4 pt-1 flex-1",children:n}),u.jsxs("div",{className:"flex items-center gap-2",children:[s,u.jsx(Ml,{onClick:o})]})]})})}function Up({isOpen:n,title:o,onClose:s,children:a,headerActions:l}){const d=ga(h=>h.theme)==="dark";return b.useEffect(()=>{if(n){const h=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=h}}},[n]),n?_n.createPortal(u.jsx("div",{className:"fixed inset-0 z-[2100] bg-gray-400/40 dark:bg-black/50 backdrop-blur-sm safe-area-top",onClick:s,children:u.jsxs("div",{className:"w-full h-full flex flex-col",style:{paddingTop:"env(--top-bar-offset, 0px)",paddingBottom:"var(--bottom-bar-offset, 0px)"},onClick:h=>h.stopPropagation(),children:[u.jsx(BN,{title:o,onClose:s,headerActions:l,isDark:d}),u.jsx("div",{className:"mt-2 px-4 pb-4",children:a}),u.jsx("div",{className:"flex-1",onClick:s})]})}),document.body):null}function ua({isPinned:n,onToggle:o}){if(!n||!o)return null;const s=a=>{a.preventDefault(),a.stopPropagation(),o()};return u.jsx("button",{type:"button",onClick:s,className:"flex items-center justify-center transition-colors text-fuchsia-500 hover:text-fuchsia-600","aria-label":"Remove pin",children:u.jsx(kl,{className:"w-5 h-5"})})}function fx(){return typeof window>"u"?!1:window.matchMedia("(pointer: coarse)").matches}function Tf({containerClass:n,name:o,value:s,options:a,onChange:l,disabled:c=!1,hideLabel:d=!1,hasPin:h,isPinned:p=!1,onTogglePin:m,hasError:y=!1,forceModalOpen:x=!1,onModalClose:v}){const C=te=>{if(!Array.isArray(a))return a?.[te]},N=C("multiline"),w=C("placeholder"),j=String(s??""),k=te=>{l(te.target.value)},[O,R]=b.useState(!1),D=x||O,H=ga(te=>te.theme)==="dark",A=fx(),V=x||A,J=b.useRef(null),X=b.useRef(null);b.useLayoutEffect(()=>{if(!N)return;const te=J.current;te&&(te.style.height="0px",te.style.height=`${te.scrollHeight}px`)},[s,D,N]);const re=()=>{R(!1),v?.()};return V?u.jsxs("div",{className:n,children:[N?u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"flex items-center justify-between mb-1 min-h-[18px]",children:[d?u.jsx("span",{className:"block text-sm font-medium text-gray-700"}):u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:o}),u.jsx(bl,{value:j,onChange:l,textareaRef:J,className:"opacity-100"})]}),u.jsxs("div",{className:`relative w-full p-3 comfy-input min-h-[100px] text-base group cursor-text ${c?"opacity-60 cursor-not-allowed":""} ${h?"pr-10":""} ${y?"border-red-700 ring-1 ring-red-700":""}`,onClick:()=>!c&&R(!0),children:[u.jsx("div",{className:"whitespace-pre-wrap break-words text-gray-900",style:H?{color:Dt.text.onDark}:void 0,children:j||u.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:w})}),h&&u.jsx("div",{className:"absolute right-2 top-2 pointer-events-none",children:u.jsx("div",{className:"pointer-events-auto",children:u.jsx(ua,{isPinned:p,onToggle:m})})})]})]}):u.jsxs(u.Fragment,{children:[!d&&u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:o}),u.jsxs("div",{className:`relative w-full p-3 comfy-input text-base min-h-[46px] flex items-center cursor-text ${c?"opacity-60 cursor-not-allowed":""} ${h?"pr-16":"pr-6"} ${y?"border-red-700 ring-1 ring-red-700":""}`,onClick:()=>!c&&R(!0),children:[u.jsx("div",{className:"truncate min-w-0 flex-1 text-gray-900",style:H?{color:Dt.text.onDark}:void 0,children:j||u.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:w})}),h&&u.jsx("div",{className:"absolute right-0 top-0 bottom-0 flex items-center pointer-events-none",children:u.jsx("div",{className:"pointer-events-auto px-3",children:u.jsx(ua,{isPinned:p,onToggle:m})})})]})]}),u.jsx(Up,{title:o,isOpen:D,onClose:re,headerActions:N?u.jsx(bl,{value:j,onChange:l,textareaRef:J,className:"mr-2"}):null,children:N?u.jsx("textarea",{ref:J,value:j,onChange:te=>l(te.target.value),placeholder:w,className:"w-full p-3 border border-gray-300 rounded-lg min-h-[150px] text-base resize-none outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500",autoFocus:!x,disabled:c}):u.jsx("input",{ref:X,type:"text",value:j,onChange:te=>l(te.target.value),placeholder:w,className:"w-full p-3 border border-gray-300 rounded-lg text-base outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500",autoFocus:!x,disabled:c})})]}):N?u.jsxs("div",{className:`${n} group`,"data-textarea-root":"true",children:[u.jsxs("div",{className:"flex items-center justify-between mb-1 min-h-[18px]","data-textarea-header":"true",children:[d?u.jsx("span",{className:"block text-sm font-medium text-gray-700"}):u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:o}),u.jsx(bl,{value:j,onChange:l,textareaRef:J,className:"opacity-70 transition-opacity group-focus-within:opacity-100"})]}),u.jsxs("div",{className:"relative",children:[u.jsx("textarea",{ref:J,value:j,onChange:k,placeholder:w,className:`w-full p-3 comfy-input min-h-[100px] text-base resize-none overflow-hidden ${c?"opacity-60 cursor-not-allowed":""} ${h?"pr-10":""} ${y?"border-red-700 ring-1 ring-red-700":""}`,style:{overflowAnchor:"none"},disabled:c}),h&&u.jsx("div",{className:"absolute right-2 top-2",children:u.jsx(ua,{isPinned:p,onToggle:m})})]})]}):u.jsxs("div",{className:n,children:[!d&&u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:o}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"text",value:String(s??""),onChange:te=>l(te.target.value),placeholder:w,className:`w-full p-3 comfy-input text-base ${c?"opacity-60 cursor-not-allowed":""} ${h?"pr-16":""} ${y?"border-red-700 ring-1 ring-red-700":""}`,disabled:c}),h&&u.jsx("div",{className:"absolute right-0 top-0 bottom-0 flex items-center pointer-events-none",children:u.jsx("div",{className:"pointer-events-auto px-3",children:u.jsx(ua,{isPinned:p,onToggle:m})})})]})]})}function la({containerClass:n,name:o,value:s,options:a,onChange:l,disabled:c,type:d,min:h,max:p,step:m,isInt:y,hasError:x=!1}){const[v,C]=b.useState(String(s||0)),N=y??(d?d.toUpperCase()==="INT":Number.isInteger(s)),w=m??a?.step??(N?1:.1),j=h??(a?.min!==void 0?a.min:-1/0),k=p??(a?.max!==void 0?a.max:1/0);b.useEffect(()=>{C(String(s))},[s]);const O=A=>{C(A.target.value)},R=()=>{let A=N?parseInt(v,10):parseFloat(v);isNaN(A)&&(A=s),A=Math.max(j,Math.min(k,A)),l(A),C(String(A))},D=A=>{const V=(N?parseInt(v,10):parseFloat(v))||0,J=Math.max(j,Math.min(k,V+A));l(J)},I=[`number-input-field-${o}`,"w-full p-3 comfy-input text-base text-gray-900",c?"opacity-60 cursor-not-allowed":"",x?"border-red-700 ring-1 ring-red-700":""].filter(Boolean).join(" "),H=["w-10 h-10 flex items-center justify-center rounded-full bg-gray-100 text-gray-700 flex-shrink-0",c?"opacity-60 cursor-not-allowed":"active:scale-95 transition-all"].filter(Boolean).join(" ");return u.jsxs("div",{className:`${n??""} number-control-${o}`,children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:o}),u.jsxs("div",{className:`number-stepper-container-${o} flex items-center gap-2`,children:[u.jsx("input",{className:I,type:"number",value:v,onChange:O,onBlur:R,disabled:c,"aria-label":d?`${o} ${d}`:o}),u.jsx("button",{type:"button",onClick:()=>D(-w),className:H,"aria-label":"Decrease value",disabled:c,children:u.jsx(hS,{className:"w-4 h-4"})}),u.jsx("button",{type:"button",onClick:()=>D(w),className:H,"aria-label":"Increase value",disabled:c,children:u.jsx(Eo,{className:"w-4 h-4"})})]})]})}function Ss(n){"@babel/helpers - typeof";return Ss=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(o){return typeof o}:function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},Ss(n)}function zN(n,o){if(Ss(n)!="object"||!n)return n;var s=n[Symbol.toPrimitive];if(s!==void 0){var a=s.call(n,o);if(Ss(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(o==="string"?String:Number)(n)}function px(n){var o=zN(n,"string");return Ss(o)=="symbol"?o:o+""}function ml(n,o,s){return(o=px(o))in n?Object.defineProperty(n,o,{value:s,enumerable:!0,configurable:!0,writable:!0}):n[o]=s,n}function zy(n,o){var s=Object.keys(n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(n);o&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(n,l).enumerable})),s.push.apply(s,a)}return s}function Ot(n){for(var o=1;o<arguments.length;o++){var s=arguments[o]!=null?arguments[o]:{};o%2?zy(Object(s),!0).forEach(function(a){ml(n,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(s)):zy(Object(s)).forEach(function(a){Object.defineProperty(n,a,Object.getOwnPropertyDescriptor(s,a))})}return n}function HN(n){if(Array.isArray(n))return n}function VN(n,o){var s=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(s!=null){var a,l,c,d,h=[],p=!0,m=!1;try{if(c=(s=s.call(n)).next,o===0){if(Object(s)!==s)return;p=!1}else for(;!(p=(a=c.call(s)).done)&&(h.push(a.value),h.length!==o);p=!0);}catch(y){m=!0,l=y}finally{try{if(!p&&s.return!=null&&(d=s.return(),Object(d)!==d))return}finally{if(m)throw l}}return h}}function up(n,o){(o==null||o>n.length)&&(o=n.length);for(var s=0,a=Array(o);s<o;s++)a[s]=n[s];return a}function hx(n,o){if(n){if(typeof n=="string")return up(n,o);var s={}.toString.call(n).slice(8,-1);return s==="Object"&&n.constructor&&(s=n.constructor.name),s==="Map"||s==="Set"?Array.from(n):s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?up(n,o):void 0}}function $N(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function br(n,o){return HN(n)||VN(n,o)||hx(n,o)||$N()}function KN(n,o){if(n==null)return{};var s={};for(var a in n)if({}.hasOwnProperty.call(n,a)){if(o.indexOf(a)!==-1)continue;s[a]=n[a]}return s}function Nr(n,o){if(n==null)return{};var s,a,l=KN(n,o);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(n);for(a=0;a<c.length;a++)s=c[a],o.indexOf(s)===-1&&{}.propertyIsEnumerable.call(n,s)&&(l[s]=n[s])}return l}var UN=["defaultInputValue","defaultMenuIsOpen","defaultValue","inputValue","menuIsOpen","onChange","onInputChange","onMenuClose","onMenuOpen","value"];function WN(n){var o=n.defaultInputValue,s=o===void 0?"":o,a=n.defaultMenuIsOpen,l=a===void 0?!1:a,c=n.defaultValue,d=c===void 0?null:c,h=n.inputValue,p=n.menuIsOpen,m=n.onChange,y=n.onInputChange,x=n.onMenuClose,v=n.onMenuOpen,C=n.value,N=Nr(n,UN),w=b.useState(h!==void 0?h:s),j=br(w,2),k=j[0],O=j[1],R=b.useState(p!==void 0?p:l),D=br(R,2),I=D[0],H=D[1],A=b.useState(C!==void 0?C:d),V=br(A,2),J=V[0],X=V[1],re=b.useCallback(function(de,Me){typeof m=="function"&&m(de,Me),X(de)},[m]),te=b.useCallback(function(de,Me){var Ne;typeof y=="function"&&(Ne=y(de,Me)),O(Ne!==void 0?Ne:de)},[y]),me=b.useCallback(function(){typeof v=="function"&&v(),H(!0)},[v]),Te=b.useCallback(function(){typeof x=="function"&&x(),H(!1)},[x]),F=h!==void 0?h:k,_=p!==void 0?p:I,q=C!==void 0?C:J;return Ot(Ot({},N),{},{inputValue:F,menuIsOpen:_,onChange:re,onInputChange:te,onMenuClose:Te,onMenuOpen:me,value:q})}function It(){return It=Object.assign?Object.assign.bind():function(n){for(var o=1;o<arguments.length;o++){var s=arguments[o];for(var a in s)({}).hasOwnProperty.call(s,a)&&(n[a]=s[a])}return n},It.apply(null,arguments)}function FN(n,o){if(!(n instanceof o))throw new TypeError("Cannot call a class as a function")}function Hy(n,o){for(var s=0;s<o.length;s++){var a=o[s];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(n,px(a.key),a)}}function qN(n,o,s){return o&&Hy(n.prototype,o),s&&Hy(n,s),Object.defineProperty(n,"prototype",{writable:!1}),n}function cp(n,o){return cp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,a){return s.__proto__=a,s},cp(n,o)}function GN(n,o){if(typeof o!="function"&&o!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(o&&o.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),o&&cp(n,o)}function Uu(n){return Uu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(o){return o.__proto__||Object.getPrototypeOf(o)},Uu(n)}function gx(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(gx=function(){return!!n})()}function PN(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function YN(n,o){if(o&&(Ss(o)=="object"||typeof o=="function"))return o;if(o!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return PN(n)}function QN(n){var o=gx();return function(){var s,a=Uu(n);if(o){var l=Uu(this).constructor;s=Reflect.construct(a,arguments,l)}else s=a.apply(this,arguments);return YN(this,s)}}function XN(n){if(Array.isArray(n))return up(n)}function ZN(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function JN(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Wp(n){return XN(n)||ZN(n)||hx(n)||JN()}function eC(n){if(n.sheet)return n.sheet;for(var o=0;o<document.styleSheets.length;o++)if(document.styleSheets[o].ownerNode===n)return document.styleSheets[o]}function tC(n){var o=document.createElement("style");return o.setAttribute("data-emotion",n.key),n.nonce!==void 0&&o.setAttribute("nonce",n.nonce),o.appendChild(document.createTextNode("")),o.setAttribute("data-s",""),o}var nC=(function(){function n(s){var a=this;this._insertTag=function(l){var c;a.tags.length===0?a.insertionPoint?c=a.insertionPoint.nextSibling:a.prepend?c=a.container.firstChild:c=a.before:c=a.tags[a.tags.length-1].nextSibling,a.container.insertBefore(l,c),a.tags.push(l)},this.isSpeedy=s.speedy===void 0?!0:s.speedy,this.tags=[],this.ctr=0,this.nonce=s.nonce,this.key=s.key,this.container=s.container,this.prepend=s.prepend,this.insertionPoint=s.insertionPoint,this.before=null}var o=n.prototype;return o.hydrate=function(a){a.forEach(this._insertTag)},o.insert=function(a){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(tC(this));var l=this.tags[this.tags.length-1];if(this.isSpeedy){var c=eC(l);try{c.insertRule(a,c.cssRules.length)}catch{}}else l.appendChild(document.createTextNode(a));this.ctr++},o.flush=function(){this.tags.forEach(function(a){var l;return(l=a.parentNode)==null?void 0:l.removeChild(a)}),this.tags=[],this.ctr=0},n})(),Fn="-ms-",Wu="-moz-",Jt="-webkit-",mx="comm",Fp="rule",qp="decl",oC="@import",yx="@keyframes",rC="@layer",sC=Math.abs,oc=String.fromCharCode,aC=Object.assign;function lC(n,o){return Kn(n,0)^45?(((o<<2^Kn(n,0))<<2^Kn(n,1))<<2^Kn(n,2))<<2^Kn(n,3):0}function bx(n){return n.trim()}function iC(n,o){return(n=o.exec(n))?n[0]:n}function en(n,o,s){return n.replace(o,s)}function dp(n,o){return n.indexOf(o)}function Kn(n,o){return n.charCodeAt(o)|0}function Ol(n,o,s){return n.slice(o,s)}function Fo(n){return n.length}function Gp(n){return n.length}function pu(n,o){return o.push(n),n}function uC(n,o){return n.map(o).join("")}var rc=1,ma=1,xx=0,ro=0,Ln=0,ba="";function sc(n,o,s,a,l,c,d){return{value:n,root:o,parent:s,type:a,props:l,children:c,line:rc,column:ma,length:d,return:""}}function pl(n,o){return aC(sc("",null,null,"",null,null,0),n,{length:-n.length},o)}function cC(){return Ln}function dC(){return Ln=ro>0?Kn(ba,--ro):0,ma--,Ln===10&&(ma=1,rc--),Ln}function yo(){return Ln=ro<xx?Kn(ba,ro++):0,ma++,Ln===10&&(ma=1,rc++),Ln}function Qo(){return Kn(ba,ro)}function ku(){return ro}function $l(n,o){return Ol(ba,n,o)}function Tl(n){switch(n){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function vx(n){return rc=ma=1,xx=Fo(ba=n),ro=0,[]}function wx(n){return ba="",n}function ju(n){return bx($l(ro-1,fp(n===91?n+2:n===40?n+1:n)))}function fC(n){for(;(Ln=Qo())&&Ln<33;)yo();return Tl(n)>2||Tl(Ln)>3?"":" "}function pC(n,o){for(;--o&&yo()&&!(Ln<48||Ln>102||Ln>57&&Ln<65||Ln>70&&Ln<97););return $l(n,ku()+(o<6&&Qo()==32&&yo()==32))}function fp(n){for(;yo();)switch(Ln){case n:return ro;case 34:case 39:n!==34&&n!==39&&fp(Ln);break;case 40:n===41&&fp(n);break;case 92:yo();break}return ro}function hC(n,o){for(;yo()&&n+Ln!==57;)if(n+Ln===84&&Qo()===47)break;return"/*"+$l(o,ro-1)+"*"+oc(n===47?n:yo())}function gC(n){for(;!Tl(Qo());)yo();return $l(n,ro)}function mC(n){return wx(Mu("",null,null,null,[""],n=vx(n),0,[0],n))}function Mu(n,o,s,a,l,c,d,h,p){for(var m=0,y=0,x=d,v=0,C=0,N=0,w=1,j=1,k=1,O=0,R="",D=l,I=c,H=a,A=R;j;)switch(N=O,O=yo()){case 40:if(N!=108&&Kn(A,x-1)==58){dp(A+=en(ju(O),"&","&\f"),"&\f")!=-1&&(k=-1);break}case 34:case 39:case 91:A+=ju(O);break;case 9:case 10:case 13:case 32:A+=fC(N);break;case 92:A+=pC(ku()-1,7);continue;case 47:switch(Qo()){case 42:case 47:pu(yC(hC(yo(),ku()),o,s),p);break;default:A+="/"}break;case 123*w:h[m++]=Fo(A)*k;case 125*w:case 59:case 0:switch(O){case 0:case 125:j=0;case 59+y:k==-1&&(A=en(A,/\f/g,"")),C>0&&Fo(A)-x&&pu(C>32?$y(A+";",a,s,x-1):$y(en(A," ","")+";",a,s,x-2),p);break;case 59:A+=";";default:if(pu(H=Vy(A,o,s,m,y,l,h,R,D=[],I=[],x),c),O===123)if(y===0)Mu(A,o,H,H,D,c,x,h,I);else switch(v===99&&Kn(A,3)===110?100:v){case 100:case 108:case 109:case 115:Mu(n,H,H,a&&pu(Vy(n,H,H,0,0,l,h,R,l,D=[],x),I),l,I,x,h,a?D:I);break;default:Mu(A,H,H,H,[""],I,0,h,I)}}m=y=C=0,w=k=1,R=A="",x=d;break;case 58:x=1+Fo(A),C=N;default:if(w<1){if(O==123)--w;else if(O==125&&w++==0&&dC()==125)continue}switch(A+=oc(O),O*w){case 38:k=y>0?1:(A+="\f",-1);break;case 44:h[m++]=(Fo(A)-1)*k,k=1;break;case 64:Qo()===45&&(A+=ju(yo())),v=Qo(),y=x=Fo(R=A+=gC(ku())),O++;break;case 45:N===45&&Fo(A)==2&&(w=0)}}return c}function Vy(n,o,s,a,l,c,d,h,p,m,y){for(var x=l-1,v=l===0?c:[""],C=Gp(v),N=0,w=0,j=0;N<a;++N)for(var k=0,O=Ol(n,x+1,x=sC(w=d[N])),R=n;k<C;++k)(R=bx(w>0?v[k]+" "+O:en(O,/&\f/g,v[k])))&&(p[j++]=R);return sc(n,o,s,l===0?Fp:h,p,m,y)}function yC(n,o,s){return sc(n,o,s,mx,oc(cC()),Ol(n,2,-2),0)}function $y(n,o,s,a){return sc(n,o,s,qp,Ol(n,0,a),Ol(n,a+1,-1),a)}function fa(n,o){for(var s="",a=Gp(n),l=0;l<a;l++)s+=o(n[l],l,n,o)||"";return s}function bC(n,o,s,a){switch(n.type){case rC:if(n.children.length)break;case oC:case qp:return n.return=n.return||n.value;case mx:return"";case yx:return n.return=n.value+"{"+fa(n.children,a)+"}";case Fp:n.value=n.props.join(",")}return Fo(s=fa(n.children,a))?n.return=n.value+"{"+s+"}":""}function xC(n){var o=Gp(n);return function(s,a,l,c){for(var d="",h=0;h<o;h++)d+=n[h](s,a,l,c)||"";return d}}function vC(n){return function(o){o.root||(o=o.return)&&n(o)}}function wC(n){var o=Object.create(null);return function(s){return o[s]===void 0&&(o[s]=n(s)),o[s]}}var SC=function(o,s,a){for(var l=0,c=0;l=c,c=Qo(),l===38&&c===12&&(s[a]=1),!Tl(c);)yo();return $l(o,ro)},NC=function(o,s){var a=-1,l=44;do switch(Tl(l)){case 0:l===38&&Qo()===12&&(s[a]=1),o[a]+=SC(ro-1,s,a);break;case 2:o[a]+=ju(l);break;case 4:if(l===44){o[++a]=Qo()===58?"&\f":"",s[a]=o[a].length;break}default:o[a]+=oc(l)}while(l=yo());return o},CC=function(o,s){return wx(NC(vx(o),s))},Ky=new WeakMap,kC=function(o){if(!(o.type!=="rule"||!o.parent||o.length<1)){for(var s=o.value,a=o.parent,l=o.column===a.column&&o.line===a.line;a.type!=="rule";)if(a=a.parent,!a)return;if(!(o.props.length===1&&s.charCodeAt(0)!==58&&!Ky.get(a))&&!l){Ky.set(o,!0);for(var c=[],d=CC(s,c),h=a.props,p=0,m=0;p<d.length;p++)for(var y=0;y<h.length;y++,m++)o.props[m]=c[p]?d[p].replace(/&\f/g,h[y]):h[y]+" "+d[p]}}},jC=function(o){if(o.type==="decl"){var s=o.value;s.charCodeAt(0)===108&&s.charCodeAt(2)===98&&(o.return="",o.value="")}};function Sx(n,o){switch(lC(n,o)){case 5103:return Jt+"print-"+n+n;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Jt+n+n;case 5349:case 4246:case 4810:case 6968:case 2756:return Jt+n+Wu+n+Fn+n+n;case 6828:case 4268:return Jt+n+Fn+n+n;case 6165:return Jt+n+Fn+"flex-"+n+n;case 5187:return Jt+n+en(n,/(\w+).+(:[^]+)/,Jt+"box-$1$2"+Fn+"flex-$1$2")+n;case 5443:return Jt+n+Fn+"flex-item-"+en(n,/flex-|-self/,"")+n;case 4675:return Jt+n+Fn+"flex-line-pack"+en(n,/align-content|flex-|-self/,"")+n;case 5548:return Jt+n+Fn+en(n,"shrink","negative")+n;case 5292:return Jt+n+Fn+en(n,"basis","preferred-size")+n;case 6060:return Jt+"box-"+en(n,"-grow","")+Jt+n+Fn+en(n,"grow","positive")+n;case 4554:return Jt+en(n,/([^-])(transform)/g,"$1"+Jt+"$2")+n;case 6187:return en(en(en(n,/(zoom-|grab)/,Jt+"$1"),/(image-set)/,Jt+"$1"),n,"")+n;case 5495:case 3959:return en(n,/(image-set\([^]*)/,Jt+"$1$`$1");case 4968:return en(en(n,/(.+:)(flex-)?(.*)/,Jt+"box-pack:$3"+Fn+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Jt+n+n;case 4095:case 3583:case 4068:case 2532:return en(n,/(.+)-inline(.+)/,Jt+"$1$2")+n;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Fo(n)-1-o>6)switch(Kn(n,o+1)){case 109:if(Kn(n,o+4)!==45)break;case 102:return en(n,/(.+:)(.+)-([^]+)/,"$1"+Jt+"$2-$3$1"+Wu+(Kn(n,o+3)==108?"$3":"$2-$3"))+n;case 115:return~dp(n,"stretch")?Sx(en(n,"stretch","fill-available"),o)+n:n}break;case 4949:if(Kn(n,o+1)!==115)break;case 6444:switch(Kn(n,Fo(n)-3-(~dp(n,"!important")&&10))){case 107:return en(n,":",":"+Jt)+n;case 101:return en(n,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Jt+(Kn(n,14)===45?"inline-":"")+"box$3$1"+Jt+"$2$3$1"+Fn+"$2box$3")+n}break;case 5936:switch(Kn(n,o+11)){case 114:return Jt+n+Fn+en(n,/[svh]\w+-[tblr]{2}/,"tb")+n;case 108:return Jt+n+Fn+en(n,/[svh]\w+-[tblr]{2}/,"tb-rl")+n;case 45:return Jt+n+Fn+en(n,/[svh]\w+-[tblr]{2}/,"lr")+n}return Jt+n+Fn+n+n}return n}var MC=function(o,s,a,l){if(o.length>-1&&!o.return)switch(o.type){case qp:o.return=Sx(o.value,o.length);break;case yx:return fa([pl(o,{value:en(o.value,"@","@"+Jt)})],l);case Fp:if(o.length)return uC(o.props,function(c){switch(iC(c,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return fa([pl(o,{props:[en(c,/:(read-\w+)/,":"+Wu+"$1")]})],l);case"::placeholder":return fa([pl(o,{props:[en(c,/:(plac\w+)/,":"+Jt+"input-$1")]}),pl(o,{props:[en(c,/:(plac\w+)/,":"+Wu+"$1")]}),pl(o,{props:[en(c,/:(plac\w+)/,Fn+"input-$1")]})],l)}return""})}},OC=[MC],TC=function(o){var s=o.key;if(s==="css"){var a=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(a,function(w){var j=w.getAttribute("data-emotion");j.indexOf(" ")!==-1&&(document.head.appendChild(w),w.setAttribute("data-s",""))})}var l=o.stylisPlugins||OC,c={},d,h=[];d=o.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+s+' "]'),function(w){for(var j=w.getAttribute("data-emotion").split(" "),k=1;k<j.length;k++)c[j[k]]=!0;h.push(w)});var p,m=[kC,jC];{var y,x=[bC,vC(function(w){y.insert(w)})],v=xC(m.concat(l,x)),C=function(j){return fa(mC(j),v)};p=function(j,k,O,R){y=O,C(j?j+"{"+k.styles+"}":k.styles),R&&(N.inserted[k.name]=!0)}}var N={key:s,sheet:new nC({key:s,container:d,nonce:o.nonce,speedy:o.speedy,prepend:o.prepend,insertionPoint:o.insertionPoint}),nonce:o.nonce,inserted:c,registered:{},insert:p};return N.sheet.hydrate(h),N},Ef={exports:{}},on={};var Uy;function EC(){if(Uy)return on;Uy=1;var n=typeof Symbol=="function"&&Symbol.for,o=n?Symbol.for("react.element"):60103,s=n?Symbol.for("react.portal"):60106,a=n?Symbol.for("react.fragment"):60107,l=n?Symbol.for("react.strict_mode"):60108,c=n?Symbol.for("react.profiler"):60114,d=n?Symbol.for("react.provider"):60109,h=n?Symbol.for("react.context"):60110,p=n?Symbol.for("react.async_mode"):60111,m=n?Symbol.for("react.concurrent_mode"):60111,y=n?Symbol.for("react.forward_ref"):60112,x=n?Symbol.for("react.suspense"):60113,v=n?Symbol.for("react.suspense_list"):60120,C=n?Symbol.for("react.memo"):60115,N=n?Symbol.for("react.lazy"):60116,w=n?Symbol.for("react.block"):60121,j=n?Symbol.for("react.fundamental"):60117,k=n?Symbol.for("react.responder"):60118,O=n?Symbol.for("react.scope"):60119;function R(I){if(typeof I=="object"&&I!==null){var H=I.$$typeof;switch(H){case o:switch(I=I.type,I){case p:case m:case a:case c:case l:case x:return I;default:switch(I=I&&I.$$typeof,I){case h:case y:case N:case C:case d:return I;default:return H}}case s:return H}}}function D(I){return R(I)===m}return on.AsyncMode=p,on.ConcurrentMode=m,on.ContextConsumer=h,on.ContextProvider=d,on.Element=o,on.ForwardRef=y,on.Fragment=a,on.Lazy=N,on.Memo=C,on.Portal=s,on.Profiler=c,on.StrictMode=l,on.Suspense=x,on.isAsyncMode=function(I){return D(I)||R(I)===p},on.isConcurrentMode=D,on.isContextConsumer=function(I){return R(I)===h},on.isContextProvider=function(I){return R(I)===d},on.isElement=function(I){return typeof I=="object"&&I!==null&&I.$$typeof===o},on.isForwardRef=function(I){return R(I)===y},on.isFragment=function(I){return R(I)===a},on.isLazy=function(I){return R(I)===N},on.isMemo=function(I){return R(I)===C},on.isPortal=function(I){return R(I)===s},on.isProfiler=function(I){return R(I)===c},on.isStrictMode=function(I){return R(I)===l},on.isSuspense=function(I){return R(I)===x},on.isValidElementType=function(I){return typeof I=="string"||typeof I=="function"||I===a||I===m||I===c||I===l||I===x||I===v||typeof I=="object"&&I!==null&&(I.$$typeof===N||I.$$typeof===C||I.$$typeof===d||I.$$typeof===h||I.$$typeof===y||I.$$typeof===j||I.$$typeof===k||I.$$typeof===O||I.$$typeof===w)},on.typeOf=R,on}var Wy;function IC(){return Wy||(Wy=1,Ef.exports=EC()),Ef.exports}var If,Fy;function LC(){if(Fy)return If;Fy=1;var n=IC(),o={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},s={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},a={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},l={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},c={};c[n.ForwardRef]=a,c[n.Memo]=l;function d(N){return n.isMemo(N)?l:c[N.$$typeof]||o}var h=Object.defineProperty,p=Object.getOwnPropertyNames,m=Object.getOwnPropertySymbols,y=Object.getOwnPropertyDescriptor,x=Object.getPrototypeOf,v=Object.prototype;function C(N,w,j){if(typeof w!="string"){if(v){var k=x(w);k&&k!==v&&C(N,k,j)}var O=p(w);m&&(O=O.concat(m(w)));for(var R=d(N),D=d(w),I=0;I<O.length;++I){var H=O[I];if(!s[H]&&!(j&&j[H])&&!(D&&D[H])&&!(R&&R[H])){var A=y(w,H);try{h(N,H,A)}catch{}}}}return N}return If=C,If}LC();var _C=!0;function AC(n,o,s){var a="";return s.split(" ").forEach(function(l){n[l]!==void 0?o.push(n[l]+";"):l&&(a+=l+" ")}),a}var Nx=function(o,s,a){var l=o.key+"-"+s.name;(a===!1||_C===!1)&&o.registered[l]===void 0&&(o.registered[l]=s.styles)},RC=function(o,s,a){Nx(o,s,a);var l=o.key+"-"+s.name;if(o.inserted[s.name]===void 0){var c=s;do o.insert(s===c?"."+l:"",c,o.sheet,!0),c=c.next;while(c!==void 0)}};function DC(n){for(var o=0,s,a=0,l=n.length;l>=4;++a,l-=4)s=n.charCodeAt(a)&255|(n.charCodeAt(++a)&255)<<8|(n.charCodeAt(++a)&255)<<16|(n.charCodeAt(++a)&255)<<24,s=(s&65535)*1540483477+((s>>>16)*59797<<16),s^=s>>>24,o=(s&65535)*1540483477+((s>>>16)*59797<<16)^(o&65535)*1540483477+((o>>>16)*59797<<16);switch(l){case 3:o^=(n.charCodeAt(a+2)&255)<<16;case 2:o^=(n.charCodeAt(a+1)&255)<<8;case 1:o^=n.charCodeAt(a)&255,o=(o&65535)*1540483477+((o>>>16)*59797<<16)}return o^=o>>>13,o=(o&65535)*1540483477+((o>>>16)*59797<<16),((o^o>>>15)>>>0).toString(36)}var BC={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},zC=/[A-Z]|^ms/g,HC=/_EMO_([^_]+?)_([^]*?)_EMO_/g,Cx=function(o){return o.charCodeAt(1)===45},qy=function(o){return o!=null&&typeof o!="boolean"},Lf=wC(function(n){return Cx(n)?n:n.replace(zC,"-$&").toLowerCase()}),Gy=function(o,s){switch(o){case"animation":case"animationName":if(typeof s=="string")return s.replace(HC,function(a,l,c){return qo={name:l,styles:c,next:qo},l})}return BC[o]!==1&&!Cx(o)&&typeof s=="number"&&s!==0?s+"px":s};function El(n,o,s){if(s==null)return"";var a=s;if(a.__emotion_styles!==void 0)return a;switch(typeof s){case"boolean":return"";case"object":{var l=s;if(l.anim===1)return qo={name:l.name,styles:l.styles,next:qo},l.name;var c=s;if(c.styles!==void 0){var d=c.next;if(d!==void 0)for(;d!==void 0;)qo={name:d.name,styles:d.styles,next:qo},d=d.next;var h=c.styles+";";return h}return VC(n,o,s)}case"function":{if(n!==void 0){var p=qo,m=s(n);return qo=p,El(n,o,m)}break}}var y=s;return y}function VC(n,o,s){var a="";if(Array.isArray(s))for(var l=0;l<s.length;l++)a+=El(n,o,s[l])+";";else for(var c in s){var d=s[c];if(typeof d!="object"){var h=d;qy(h)&&(a+=Lf(c)+":"+Gy(c,h)+";")}else if(Array.isArray(d)&&typeof d[0]=="string"&&o==null)for(var p=0;p<d.length;p++)qy(d[p])&&(a+=Lf(c)+":"+Gy(c,d[p])+";");else{var m=El(n,o,d);switch(c){case"animation":case"animationName":{a+=Lf(c)+":"+m+";";break}default:a+=c+"{"+m+"}"}}}return a}var Py=/label:\s*([^\s;{]+)\s*(;|$)/g,qo;function kx(n,o,s){if(n.length===1&&typeof n[0]=="object"&&n[0]!==null&&n[0].styles!==void 0)return n[0];var a=!0,l="";qo=void 0;var c=n[0];if(c==null||c.raw===void 0)a=!1,l+=El(s,o,c);else{var d=c;l+=d[0]}for(var h=1;h<n.length;h++)if(l+=El(s,o,n[h]),a){var p=c;l+=p[h]}Py.lastIndex=0;for(var m="",y;(y=Py.exec(l))!==null;)m+="-"+y[1];var x=DC(l)+m;return{name:x,styles:l,next:qo}}var $C=function(o){return o()},KC=V0.useInsertionEffect?V0.useInsertionEffect:!1,UC=KC||$C,jx=b.createContext(typeof HTMLElement<"u"?TC({key:"css"}):null);jx.Provider;var WC=function(o){return b.forwardRef(function(s,a){var l=b.useContext(jx);return o(s,l,a)})},FC=b.createContext({}),Pp={}.hasOwnProperty,pp="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",qC=function(o,s){var a={};for(var l in s)Pp.call(s,l)&&(a[l]=s[l]);return a[pp]=o,a},GC=function(o){var s=o.cache,a=o.serialized,l=o.isStringTag;return Nx(s,a,l),UC(function(){return RC(s,a,l)}),null},PC=WC(function(n,o,s){var a=n.css;typeof a=="string"&&o.registered[a]!==void 0&&(a=o.registered[a]);var l=n[pp],c=[a],d="";typeof n.className=="string"?d=AC(o.registered,c,n.className):n.className!=null&&(d=n.className+" ");var h=kx(c,void 0,b.useContext(FC));d+=o.key+"-"+h.name;var p={};for(var m in n)Pp.call(n,m)&&m!=="css"&&m!==pp&&(p[m]=n[m]);return p.className=d,s&&(p.ref=s),b.createElement(b.Fragment,null,b.createElement(GC,{cache:o,serialized:h,isStringTag:typeof l=="string"}),b.createElement(l,p))}),YC=PC,jt=function(o,s){var a=arguments;if(s==null||!Pp.call(s,"css"))return b.createElement.apply(void 0,a);var l=a.length,c=new Array(l);c[0]=YC,c[1]=qC(o,s);for(var d=2;d<l;d++)c[d]=a[d];return b.createElement.apply(null,c)};(function(n){var o;o||(o=n.JSX||(n.JSX={}))})(jt||(jt={}));function Yp(){for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return kx(o)}function QC(){var n=Yp.apply(void 0,arguments),o="animation-"+n.name;return{name:o,styles:"@keyframes "+o+"{"+n.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}function XC(n,o){return o||(o=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(o)}}))}const ZC=Math.min,JC=Math.max,Fu=Math.round,hu=Math.floor,qu=n=>({x:n,y:n});function ek(n){const{x:o,y:s,width:a,height:l}=n;return{width:a,height:l,top:s,left:o,right:o+a,bottom:s+l,x:o,y:s}}function ac(){return typeof window<"u"}function Mx(n){return Tx(n)?(n.nodeName||"").toLowerCase():"#document"}function vr(n){var o;return(n==null||(o=n.ownerDocument)==null?void 0:o.defaultView)||window}function Ox(n){var o;return(o=(Tx(n)?n.ownerDocument:n.document)||window.document)==null?void 0:o.documentElement}function Tx(n){return ac()?n instanceof Node||n instanceof vr(n).Node:!1}function tk(n){return ac()?n instanceof Element||n instanceof vr(n).Element:!1}function Qp(n){return ac()?n instanceof HTMLElement||n instanceof vr(n).HTMLElement:!1}function Yy(n){return!ac()||typeof ShadowRoot>"u"?!1:n instanceof ShadowRoot||n instanceof vr(n).ShadowRoot}const nk=new Set(["inline","contents"]);function Ex(n){const{overflow:o,overflowX:s,overflowY:a,display:l}=Xp(n);return/auto|scroll|overlay|hidden|clip/.test(o+a+s)&&!nk.has(l)}function ok(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const rk=new Set(["html","body","#document"]);function sk(n){return rk.has(Mx(n))}function Xp(n){return vr(n).getComputedStyle(n)}function ak(n){if(Mx(n)==="html")return n;const o=n.assignedSlot||n.parentNode||Yy(n)&&n.host||Ox(n);return Yy(o)?o.host:o}function Ix(n){const o=ak(n);return sk(o)?n.ownerDocument?n.ownerDocument.body:n.body:Qp(o)&&Ex(o)?o:Ix(o)}function Gu(n,o,s){var a;o===void 0&&(o=[]),s===void 0&&(s=!0);const l=Ix(n),c=l===((a=n.ownerDocument)==null?void 0:a.body),d=vr(l);if(c){const h=hp(d);return o.concat(d,d.visualViewport||[],Ex(l)?l:[],h&&s?Gu(h):[])}return o.concat(l,Gu(l,[],s))}function hp(n){return n.parent&&Object.getPrototypeOf(n.parent)?n.frameElement:null}function lk(n){const o=Xp(n);let s=parseFloat(o.width)||0,a=parseFloat(o.height)||0;const l=Qp(n),c=l?n.offsetWidth:s,d=l?n.offsetHeight:a,h=Fu(s)!==c||Fu(a)!==d;return h&&(s=c,a=d),{width:s,height:a,$:h}}function Zp(n){return tk(n)?n:n.contextElement}function Qy(n){const o=Zp(n);if(!Qp(o))return qu(1);const s=o.getBoundingClientRect(),{width:a,height:l,$:c}=lk(o);let d=(c?Fu(s.width):s.width)/a,h=(c?Fu(s.height):s.height)/l;return(!d||!Number.isFinite(d))&&(d=1),(!h||!Number.isFinite(h))&&(h=1),{x:d,y:h}}const ik=qu(0);function uk(n){const o=vr(n);return!ok()||!o.visualViewport?ik:{x:o.visualViewport.offsetLeft,y:o.visualViewport.offsetTop}}function ck(n,o,s){return!1}function Xy(n,o,s,a){o===void 0&&(o=!1);const l=n.getBoundingClientRect(),c=Zp(n);let d=qu(1);o&&(d=Qy(n));const h=ck()?uk(c):qu(0);let p=(l.left+h.x)/d.x,m=(l.top+h.y)/d.y,y=l.width/d.x,x=l.height/d.y;if(c){const v=vr(c),C=a;let N=v,w=hp(N);for(;w&&a&&C!==N;){const j=Qy(w),k=w.getBoundingClientRect(),O=Xp(w),R=k.left+(w.clientLeft+parseFloat(O.paddingLeft))*j.x,D=k.top+(w.clientTop+parseFloat(O.paddingTop))*j.y;p*=j.x,m*=j.y,y*=j.x,x*=j.y,p+=R,m+=D,N=vr(w),w=hp(N)}}return ek({width:y,height:x,x:p,y:m})}function Lx(n,o){return n.x===o.x&&n.y===o.y&&n.width===o.width&&n.height===o.height}function dk(n,o){let s=null,a;const l=Ox(n);function c(){var h;clearTimeout(a),(h=s)==null||h.disconnect(),s=null}function d(h,p){h===void 0&&(h=!1),p===void 0&&(p=1),c();const m=n.getBoundingClientRect(),{left:y,top:x,width:v,height:C}=m;if(h||o(),!v||!C)return;const N=hu(x),w=hu(l.clientWidth-(y+v)),j=hu(l.clientHeight-(x+C)),k=hu(y),R={rootMargin:-N+"px "+-w+"px "+-j+"px "+-k+"px",threshold:JC(0,ZC(1,p))||1};let D=!0;function I(H){const A=H[0].intersectionRatio;if(A!==p){if(!D)return d();A?d(!1,A):a=setTimeout(()=>{d(!1,1e-7)},1e3)}A===1&&!Lx(m,n.getBoundingClientRect())&&d(),D=!1}try{s=new IntersectionObserver(I,{...R,root:l.ownerDocument})}catch{s=new IntersectionObserver(I,R)}s.observe(n)}return d(!0),c}function fk(n,o,s,a){a===void 0&&(a={});const{ancestorScroll:l=!0,ancestorResize:c=!0,elementResize:d=typeof ResizeObserver=="function",layoutShift:h=typeof IntersectionObserver=="function",animationFrame:p=!1}=a,m=Zp(n),y=l||c?[...m?Gu(m):[],...Gu(o)]:[];y.forEach(k=>{l&&k.addEventListener("scroll",s,{passive:!0}),c&&k.addEventListener("resize",s)});const x=m&&h?dk(m,s):null;let v=-1,C=null;d&&(C=new ResizeObserver(k=>{let[O]=k;O&&O.target===m&&C&&(C.unobserve(o),cancelAnimationFrame(v),v=requestAnimationFrame(()=>{var R;(R=C)==null||R.observe(o)})),s()}),m&&!p&&C.observe(m),C.observe(o));let N,w=p?Xy(n):null;p&&j();function j(){const k=Xy(n);w&&!Lx(w,k)&&s(),w=k,N=requestAnimationFrame(j)}return s(),()=>{var k;y.forEach(O=>{l&&O.removeEventListener("scroll",s),c&&O.removeEventListener("resize",s)}),x?.(),(k=C)==null||k.disconnect(),C=null,p&&cancelAnimationFrame(N)}}var gp=b.useLayoutEffect,pk=["className","clearValue","cx","getStyles","getClassNames","getValue","hasValue","isMulti","isRtl","options","selectOption","selectProps","setValue","theme"],Pu=function(){};function hk(n,o){return o?o[0]==="-"?n+o:n+"__"+o:n}function gk(n,o){for(var s=arguments.length,a=new Array(s>2?s-2:0),l=2;l<s;l++)a[l-2]=arguments[l];var c=[].concat(a);if(o&&n)for(var d in o)o.hasOwnProperty(d)&&o[d]&&c.push("".concat(hk(n,d)));return c.filter(function(h){return h}).map(function(h){return String(h).trim()}).join(" ")}var Zy=function(o){return Ck(o)?o.filter(Boolean):Ss(o)==="object"&&o!==null?[o]:[]},_x=function(o){o.className,o.clearValue,o.cx,o.getStyles,o.getClassNames,o.getValue,o.hasValue,o.isMulti,o.isRtl,o.options,o.selectOption,o.selectProps,o.setValue,o.theme;var s=Nr(o,pk);return Ot({},s)},Sn=function(o,s,a){var l=o.cx,c=o.getStyles,d=o.getClassNames,h=o.className;return{css:c(s,o),className:l(a??{},d(s,o),h)}};function lc(n){return[document.documentElement,document.body,window].indexOf(n)>-1}function mk(n){return lc(n)?window.innerHeight:n.clientHeight}function Ax(n){return lc(n)?window.pageYOffset:n.scrollTop}function Yu(n,o){if(lc(n)){window.scrollTo(0,o);return}n.scrollTop=o}function yk(n){var o=getComputedStyle(n),s=o.position==="absolute",a=/(auto|scroll)/;if(o.position==="fixed")return document.documentElement;for(var l=n;l=l.parentElement;)if(o=getComputedStyle(l),!(s&&o.position==="static")&&a.test(o.overflow+o.overflowY+o.overflowX))return l;return document.documentElement}function bk(n,o,s,a){return s*((n=n/a-1)*n*n+1)+o}function gu(n,o){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:200,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Pu,l=Ax(n),c=o-l,d=10,h=0;function p(){h+=d;var m=bk(h,l,c,s);Yu(n,m),h<s?window.requestAnimationFrame(p):a(n)}p()}function Jy(n,o){var s=n.getBoundingClientRect(),a=o.getBoundingClientRect(),l=o.offsetHeight/3;a.bottom+l>s.bottom?Yu(n,Math.min(o.offsetTop+o.clientHeight-n.offsetHeight+l,n.scrollHeight)):a.top-l<s.top&&Yu(n,Math.max(o.offsetTop-l,0))}function xk(n){var o=n.getBoundingClientRect();return{bottom:o.bottom,height:o.height,left:o.left,right:o.right,top:o.top,width:o.width}}function eb(){try{return document.createEvent("TouchEvent"),!0}catch{return!1}}function vk(){try{return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}catch{return!1}}var Rx=!1,wk={get passive(){return Rx=!0}},mu=typeof window<"u"?window:{};mu.addEventListener&&mu.removeEventListener&&(mu.addEventListener("p",Pu,wk),mu.removeEventListener("p",Pu,!1));var Sk=Rx;function Nk(n){return n!=null}function Ck(n){return Array.isArray(n)}function yu(n,o,s){return n?o:s}var kk=function(o){for(var s=arguments.length,a=new Array(s>1?s-1:0),l=1;l<s;l++)a[l-1]=arguments[l];var c=Object.entries(o).filter(function(d){var h=br(d,1),p=h[0];return!a.includes(p)});return c.reduce(function(d,h){var p=br(h,2),m=p[0],y=p[1];return d[m]=y,d},{})},jk=["children","innerProps"],Mk=["children","innerProps"];function Ok(n){var o=n.maxHeight,s=n.menuEl,a=n.minHeight,l=n.placement,c=n.shouldScroll,d=n.isFixedPosition,h=n.controlHeight,p=yk(s),m={placement:"bottom",maxHeight:o};if(!s||!s.offsetParent)return m;var y=p.getBoundingClientRect(),x=y.height,v=s.getBoundingClientRect(),C=v.bottom,N=v.height,w=v.top,j=s.offsetParent.getBoundingClientRect(),k=j.top,O=d?window.innerHeight:mk(p),R=Ax(p),D=parseInt(getComputedStyle(s).marginBottom,10),I=parseInt(getComputedStyle(s).marginTop,10),H=k-I,A=O-w,V=H+R,J=x-R-w,X=C-O+R+D,re=R+w-I,te=160;switch(l){case"auto":case"bottom":if(A>=N)return{placement:"bottom",maxHeight:o};if(J>=N&&!d)return c&&gu(p,X,te),{placement:"bottom",maxHeight:o};if(!d&&J>=a||d&&A>=a){c&&gu(p,X,te);var me=d?A-D:J-D;return{placement:"bottom",maxHeight:me}}if(l==="auto"||d){var Te=o,F=d?H:V;return F>=a&&(Te=Math.min(F-D-h,o)),{placement:"top",maxHeight:Te}}if(l==="bottom")return c&&Yu(p,X),{placement:"bottom",maxHeight:o};break;case"top":if(H>=N)return{placement:"top",maxHeight:o};if(V>=N&&!d)return c&&gu(p,re,te),{placement:"top",maxHeight:o};if(!d&&V>=a||d&&H>=a){var _=o;return(!d&&V>=a||d&&H>=a)&&(_=d?H-I:V-I),c&&gu(p,re,te),{placement:"top",maxHeight:_}}return{placement:"bottom",maxHeight:o};default:throw new Error('Invalid placement provided "'.concat(l,'".'))}return m}function Tk(n){var o={bottom:"top",top:"bottom"};return n?o[n]:"bottom"}var Dx=function(o){return o==="auto"?"bottom":o},Ek=function(o,s){var a,l=o.placement,c=o.theme,d=c.borderRadius,h=c.spacing,p=c.colors;return Ot((a={label:"menu"},ml(a,Tk(l),"100%"),ml(a,"position","absolute"),ml(a,"width","100%"),ml(a,"zIndex",1),a),s?{}:{backgroundColor:p.neutral0,borderRadius:d,boxShadow:"0 0 0 1px hsla(0, 0%, 0%, 0.1), 0 4px 11px hsla(0, 0%, 0%, 0.1)",marginBottom:h.menuGutter,marginTop:h.menuGutter})},Bx=b.createContext(null),Ik=function(o){var s=o.children,a=o.minMenuHeight,l=o.maxMenuHeight,c=o.menuPlacement,d=o.menuPosition,h=o.menuShouldScrollIntoView,p=o.theme,m=b.useContext(Bx)||{},y=m.setPortalPlacement,x=b.useRef(null),v=b.useState(l),C=br(v,2),N=C[0],w=C[1],j=b.useState(null),k=br(j,2),O=k[0],R=k[1],D=p.spacing.controlHeight;return gp(function(){var I=x.current;if(I){var H=d==="fixed",A=h&&!H,V=Ok({maxHeight:l,menuEl:I,minHeight:a,placement:c,shouldScroll:A,isFixedPosition:H,controlHeight:D});w(V.maxHeight),R(V.placement),y?.(V.placement)}},[l,c,d,h,a,y,D]),s({ref:x,placerProps:Ot(Ot({},o),{},{placement:O||Dx(c),maxHeight:N})})},Lk=function(o){var s=o.children,a=o.innerRef,l=o.innerProps;return jt("div",It({},Sn(o,"menu",{menu:!0}),{ref:a},l),s)},_k=Lk,Ak=function(o,s){var a=o.maxHeight,l=o.theme.spacing.baseUnit;return Ot({maxHeight:a,overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},s?{}:{paddingBottom:l,paddingTop:l})},Rk=function(o){var s=o.children,a=o.innerProps,l=o.innerRef,c=o.isMulti;return jt("div",It({},Sn(o,"menuList",{"menu-list":!0,"menu-list--is-multi":c}),{ref:l},a),s)},zx=function(o,s){var a=o.theme,l=a.spacing.baseUnit,c=a.colors;return Ot({textAlign:"center"},s?{}:{color:c.neutral40,padding:"".concat(l*2,"px ").concat(l*3,"px")})},Dk=zx,Bk=zx,zk=function(o){var s=o.children,a=s===void 0?"No options":s,l=o.innerProps,c=Nr(o,jk);return jt("div",It({},Sn(Ot(Ot({},c),{},{children:a,innerProps:l}),"noOptionsMessage",{"menu-notice":!0,"menu-notice--no-options":!0}),l),a)},Hk=function(o){var s=o.children,a=s===void 0?"Loading...":s,l=o.innerProps,c=Nr(o,Mk);return jt("div",It({},Sn(Ot(Ot({},c),{},{children:a,innerProps:l}),"loadingMessage",{"menu-notice":!0,"menu-notice--loading":!0}),l),a)},Vk=function(o){var s=o.rect,a=o.offset,l=o.position;return{left:s.left,position:l,top:a,width:s.width,zIndex:1}},$k=function(o){var s=o.appendTo,a=o.children,l=o.controlElement,c=o.innerProps,d=o.menuPlacement,h=o.menuPosition,p=b.useRef(null),m=b.useRef(null),y=b.useState(Dx(d)),x=br(y,2),v=x[0],C=x[1],N=b.useMemo(function(){return{setPortalPlacement:C}},[]),w=b.useState(null),j=br(w,2),k=j[0],O=j[1],R=b.useCallback(function(){if(l){var A=xk(l),V=h==="fixed"?0:window.pageYOffset,J=A[v]+V;(J!==k?.offset||A.left!==k?.rect.left||A.width!==k?.rect.width)&&O({offset:J,rect:A})}},[l,h,v,k?.offset,k?.rect.left,k?.rect.width]);gp(function(){R()},[R]);var D=b.useCallback(function(){typeof m.current=="function"&&(m.current(),m.current=null),l&&p.current&&(m.current=fk(l,p.current,R,{elementResize:"ResizeObserver"in window}))},[l,R]);gp(function(){D()},[D]);var I=b.useCallback(function(A){p.current=A,D()},[D]);if(!s&&h!=="fixed"||!k)return null;var H=jt("div",It({ref:I},Sn(Ot(Ot({},o),{},{offset:k.offset,position:h,rect:k.rect}),"menuPortal",{"menu-portal":!0}),c),a);return jt(Bx.Provider,{value:N},s?_n.createPortal(H,s):H)},Kk=function(o){var s=o.isDisabled,a=o.isRtl;return{label:"container",direction:a?"rtl":void 0,pointerEvents:s?"none":void 0,position:"relative"}},Uk=function(o){var s=o.children,a=o.innerProps,l=o.isDisabled,c=o.isRtl;return jt("div",It({},Sn(o,"container",{"--is-disabled":l,"--is-rtl":c}),a),s)},Wk=function(o,s){var a=o.theme.spacing,l=o.isMulti,c=o.hasValue,d=o.selectProps.controlShouldRenderValue;return Ot({alignItems:"center",display:l&&c&&d?"flex":"grid",flex:1,flexWrap:"wrap",WebkitOverflowScrolling:"touch",position:"relative",overflow:"hidden"},s?{}:{padding:"".concat(a.baseUnit/2,"px ").concat(a.baseUnit*2,"px")})},Fk=function(o){var s=o.children,a=o.innerProps,l=o.isMulti,c=o.hasValue;return jt("div",It({},Sn(o,"valueContainer",{"value-container":!0,"value-container--is-multi":l,"value-container--has-value":c}),a),s)},qk=function(){return{alignItems:"center",alignSelf:"stretch",display:"flex",flexShrink:0}},Gk=function(o){var s=o.children,a=o.innerProps;return jt("div",It({},Sn(o,"indicatorsContainer",{indicators:!0}),a),s)},tb,Pk=["size"],Yk=["innerProps","isRtl","size"],Qk={name:"8mmkcg",styles:"display:inline-block;fill:currentColor;line-height:1;stroke:currentColor;stroke-width:0"},Hx=function(o){var s=o.size,a=Nr(o,Pk);return jt("svg",It({height:s,width:s,viewBox:"0 0 20 20","aria-hidden":"true",focusable:"false",css:Qk},a))},Jp=function(o){return jt(Hx,It({size:20},o),jt("path",{d:"M14.348 14.849c-0.469 0.469-1.229 0.469-1.697 0l-2.651-3.030-2.651 3.029c-0.469 0.469-1.229 0.469-1.697 0-0.469-0.469-0.469-1.229 0-1.697l2.758-3.15-2.759-3.152c-0.469-0.469-0.469-1.228 0-1.697s1.228-0.469 1.697 0l2.652 3.031 2.651-3.031c0.469-0.469 1.228-0.469 1.697 0s0.469 1.229 0 1.697l-2.758 3.152 2.758 3.15c0.469 0.469 0.469 1.229 0 1.698z"}))},Vx=function(o){return jt(Hx,It({size:20},o),jt("path",{d:"M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"}))},$x=function(o,s){var a=o.isFocused,l=o.theme,c=l.spacing.baseUnit,d=l.colors;return Ot({label:"indicatorContainer",display:"flex",transition:"color 150ms"},s?{}:{color:a?d.neutral60:d.neutral20,padding:c*2,":hover":{color:a?d.neutral80:d.neutral40}})},Xk=$x,Zk=function(o){var s=o.children,a=o.innerProps;return jt("div",It({},Sn(o,"dropdownIndicator",{indicator:!0,"dropdown-indicator":!0}),a),s||jt(Vx,null))},Jk=$x,e3=function(o){var s=o.children,a=o.innerProps;return jt("div",It({},Sn(o,"clearIndicator",{indicator:!0,"clear-indicator":!0}),a),s||jt(Jp,null))},t3=function(o,s){var a=o.isDisabled,l=o.theme,c=l.spacing.baseUnit,d=l.colors;return Ot({label:"indicatorSeparator",alignSelf:"stretch",width:1},s?{}:{backgroundColor:a?d.neutral10:d.neutral20,marginBottom:c*2,marginTop:c*2})},n3=function(o){var s=o.innerProps;return jt("span",It({},s,Sn(o,"indicatorSeparator",{"indicator-separator":!0})))},o3=QC(tb||(tb=XC([`
  0%, 80%, 100% { opacity: 0; }
  40% { opacity: 1; }
`]))),r3=function(o,s){var a=o.isFocused,l=o.size,c=o.theme,d=c.colors,h=c.spacing.baseUnit;return Ot({label:"loadingIndicator",display:"flex",transition:"color 150ms",alignSelf:"center",fontSize:l,lineHeight:1,marginRight:l,textAlign:"center",verticalAlign:"middle"},s?{}:{color:a?d.neutral60:d.neutral20,padding:h*2})},_f=function(o){var s=o.delay,a=o.offset;return jt("span",{css:Yp({animation:"".concat(o3," 1s ease-in-out ").concat(s,"ms infinite;"),backgroundColor:"currentColor",borderRadius:"1em",display:"inline-block",marginLeft:a?"1em":void 0,height:"1em",verticalAlign:"top",width:"1em"},"","")})},s3=function(o){var s=o.innerProps,a=o.isRtl,l=o.size,c=l===void 0?4:l,d=Nr(o,Yk);return jt("div",It({},Sn(Ot(Ot({},d),{},{innerProps:s,isRtl:a,size:c}),"loadingIndicator",{indicator:!0,"loading-indicator":!0}),s),jt(_f,{delay:0,offset:a}),jt(_f,{delay:160,offset:!0}),jt(_f,{delay:320,offset:!a}))},a3=function(o,s){var a=o.isDisabled,l=o.isFocused,c=o.theme,d=c.colors,h=c.borderRadius,p=c.spacing;return Ot({label:"control",alignItems:"center",cursor:"default",display:"flex",flexWrap:"wrap",justifyContent:"space-between",minHeight:p.controlHeight,outline:"0 !important",position:"relative",transition:"all 100ms"},s?{}:{backgroundColor:a?d.neutral5:d.neutral0,borderColor:a?d.neutral10:l?d.primary:d.neutral20,borderRadius:h,borderStyle:"solid",borderWidth:1,boxShadow:l?"0 0 0 1px ".concat(d.primary):void 0,"&:hover":{borderColor:l?d.primary:d.neutral30}})},l3=function(o){var s=o.children,a=o.isDisabled,l=o.isFocused,c=o.innerRef,d=o.innerProps,h=o.menuIsOpen;return jt("div",It({ref:c},Sn(o,"control",{control:!0,"control--is-disabled":a,"control--is-focused":l,"control--menu-is-open":h}),d,{"aria-disabled":a||void 0}),s)},i3=l3,u3=["data"],c3=function(o,s){var a=o.theme.spacing;return s?{}:{paddingBottom:a.baseUnit*2,paddingTop:a.baseUnit*2}},d3=function(o){var s=o.children,a=o.cx,l=o.getStyles,c=o.getClassNames,d=o.Heading,h=o.headingProps,p=o.innerProps,m=o.label,y=o.theme,x=o.selectProps;return jt("div",It({},Sn(o,"group",{group:!0}),p),jt(d,It({},h,{selectProps:x,theme:y,getStyles:l,getClassNames:c,cx:a}),m),jt("div",null,s))},f3=function(o,s){var a=o.theme,l=a.colors,c=a.spacing;return Ot({label:"group",cursor:"default",display:"block"},s?{}:{color:l.neutral40,fontSize:"75%",fontWeight:500,marginBottom:"0.25em",paddingLeft:c.baseUnit*3,paddingRight:c.baseUnit*3,textTransform:"uppercase"})},p3=function(o){var s=_x(o);s.data;var a=Nr(s,u3);return jt("div",It({},Sn(o,"groupHeading",{"group-heading":!0}),a))},h3=d3,g3=["innerRef","isDisabled","isHidden","inputClassName"],m3=function(o,s){var a=o.isDisabled,l=o.value,c=o.theme,d=c.spacing,h=c.colors;return Ot(Ot({visibility:a?"hidden":"visible",transform:l?"translateZ(0)":""},y3),s?{}:{margin:d.baseUnit/2,paddingBottom:d.baseUnit/2,paddingTop:d.baseUnit/2,color:h.neutral80})},Kx={gridArea:"1 / 2",font:"inherit",minWidth:"2px",border:0,margin:0,outline:0,padding:0},y3={flex:"1 1 auto",display:"inline-grid",gridArea:"1 / 1 / 2 / 3",gridTemplateColumns:"0 min-content","&:after":Ot({content:'attr(data-value) " "',visibility:"hidden",whiteSpace:"pre"},Kx)},b3=function(o){return Ot({label:"input",color:"inherit",background:0,opacity:o?0:1,width:"100%"},Kx)},x3=function(o){var s=o.cx,a=o.value,l=_x(o),c=l.innerRef,d=l.isDisabled,h=l.isHidden,p=l.inputClassName,m=Nr(l,g3);return jt("div",It({},Sn(o,"input",{"input-container":!0}),{"data-value":a||""}),jt("input",It({className:s({input:!0},p),ref:c,style:b3(h),disabled:d},m)))},v3=x3,w3=function(o,s){var a=o.theme,l=a.spacing,c=a.borderRadius,d=a.colors;return Ot({label:"multiValue",display:"flex",minWidth:0},s?{}:{backgroundColor:d.neutral10,borderRadius:c/2,margin:l.baseUnit/2})},S3=function(o,s){var a=o.theme,l=a.borderRadius,c=a.colors,d=o.cropWithEllipsis;return Ot({overflow:"hidden",textOverflow:d||d===void 0?"ellipsis":void 0,whiteSpace:"nowrap"},s?{}:{borderRadius:l/2,color:c.neutral80,fontSize:"85%",padding:3,paddingLeft:6})},N3=function(o,s){var a=o.theme,l=a.spacing,c=a.borderRadius,d=a.colors,h=o.isFocused;return Ot({alignItems:"center",display:"flex"},s?{}:{borderRadius:c/2,backgroundColor:h?d.dangerLight:void 0,paddingLeft:l.baseUnit,paddingRight:l.baseUnit,":hover":{backgroundColor:d.dangerLight,color:d.danger}})},Ux=function(o){var s=o.children,a=o.innerProps;return jt("div",a,s)},C3=Ux,k3=Ux;function j3(n){var o=n.children,s=n.innerProps;return jt("div",It({role:"button"},s),o||jt(Jp,{size:14}))}var M3=function(o){var s=o.children,a=o.components,l=o.data,c=o.innerProps,d=o.isDisabled,h=o.removeProps,p=o.selectProps,m=a.Container,y=a.Label,x=a.Remove;return jt(m,{data:l,innerProps:Ot(Ot({},Sn(o,"multiValue",{"multi-value":!0,"multi-value--is-disabled":d})),c),selectProps:p},jt(y,{data:l,innerProps:Ot({},Sn(o,"multiValueLabel",{"multi-value__label":!0})),selectProps:p},s),jt(x,{data:l,innerProps:Ot(Ot({},Sn(o,"multiValueRemove",{"multi-value__remove":!0})),{},{"aria-label":"Remove ".concat(s||"option")},h),selectProps:p}))},O3=M3,T3=function(o,s){var a=o.isDisabled,l=o.isFocused,c=o.isSelected,d=o.theme,h=d.spacing,p=d.colors;return Ot({label:"option",cursor:"default",display:"block",fontSize:"inherit",width:"100%",userSelect:"none",WebkitTapHighlightColor:"rgba(0, 0, 0, 0)"},s?{}:{backgroundColor:c?p.primary:l?p.primary25:"transparent",color:a?p.neutral20:c?p.neutral0:"inherit",padding:"".concat(h.baseUnit*2,"px ").concat(h.baseUnit*3,"px"),":active":{backgroundColor:a?void 0:c?p.primary:p.primary50}})},E3=function(o){var s=o.children,a=o.isDisabled,l=o.isFocused,c=o.isSelected,d=o.innerRef,h=o.innerProps;return jt("div",It({},Sn(o,"option",{option:!0,"option--is-disabled":a,"option--is-focused":l,"option--is-selected":c}),{ref:d,"aria-disabled":a},h),s)},I3=E3,L3=function(o,s){var a=o.theme,l=a.spacing,c=a.colors;return Ot({label:"placeholder",gridArea:"1 / 1 / 2 / 3"},s?{}:{color:c.neutral50,marginLeft:l.baseUnit/2,marginRight:l.baseUnit/2})},_3=function(o){var s=o.children,a=o.innerProps;return jt("div",It({},Sn(o,"placeholder",{placeholder:!0}),a),s)},A3=_3,R3=function(o,s){var a=o.isDisabled,l=o.theme,c=l.spacing,d=l.colors;return Ot({label:"singleValue",gridArea:"1 / 1 / 2 / 3",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},s?{}:{color:a?d.neutral40:d.neutral80,marginLeft:c.baseUnit/2,marginRight:c.baseUnit/2})},D3=function(o){var s=o.children,a=o.isDisabled,l=o.innerProps;return jt("div",It({},Sn(o,"singleValue",{"single-value":!0,"single-value--is-disabled":a}),l),s)},B3=D3,Wx={ClearIndicator:e3,Control:i3,DropdownIndicator:Zk,DownChevron:Vx,CrossIcon:Jp,Group:h3,GroupHeading:p3,IndicatorsContainer:Gk,IndicatorSeparator:n3,Input:v3,LoadingIndicator:s3,Menu:_k,MenuList:Rk,MenuPortal:$k,LoadingMessage:Hk,NoOptionsMessage:zk,MultiValue:O3,MultiValueContainer:C3,MultiValueLabel:k3,MultiValueRemove:j3,Option:I3,Placeholder:A3,SelectContainer:Uk,SingleValue:B3,ValueContainer:Fk},z3=function(o){return Ot(Ot({},Wx),o.components)},nb=Number.isNaN||function(o){return typeof o=="number"&&o!==o};function H3(n,o){return!!(n===o||nb(n)&&nb(o))}function V3(n,o){if(n.length!==o.length)return!1;for(var s=0;s<n.length;s++)if(!H3(n[s],o[s]))return!1;return!0}function $3(n,o){o===void 0&&(o=V3);var s=null;function a(){for(var l=[],c=0;c<arguments.length;c++)l[c]=arguments[c];if(s&&s.lastThis===this&&o(l,s.lastArgs))return s.lastResult;var d=n.apply(this,l);return s={lastResult:d,lastArgs:l,lastThis:this},d}return a.clear=function(){s=null},a}var K3={name:"7pg0cj-a11yText",styles:"label:a11yText;z-index:9999;border:0;clip:rect(1px, 1px, 1px, 1px);height:1px;width:1px;position:absolute;overflow:hidden;padding:0;white-space:nowrap"},U3=function(o){return jt("span",It({css:K3},o))},ob=U3,W3={guidance:function(o){var s=o.isSearchable,a=o.isMulti,l=o.tabSelectsValue,c=o.context,d=o.isInitialFocus;switch(c){case"menu":return"Use Up and Down to choose options, press Enter to select the currently focused option, press Escape to exit the menu".concat(l?", press Tab to select the option and exit the menu":"",".");case"input":return d?"".concat(o["aria-label"]||"Select"," is focused ").concat(s?",type to refine list":"",", press Down to open the menu, ").concat(a?" press left to focus selected values":""):"";case"value":return"Use left and right to toggle between focused values, press Backspace to remove the currently focused value";default:return""}},onChange:function(o){var s=o.action,a=o.label,l=a===void 0?"":a,c=o.labels,d=o.isDisabled;switch(s){case"deselect-option":case"pop-value":case"remove-value":return"option ".concat(l,", deselected.");case"clear":return"All selected options have been cleared.";case"initial-input-focus":return"option".concat(c.length>1?"s":""," ").concat(c.join(","),", selected.");case"select-option":return d?"option ".concat(l," is disabled. Select another option."):"option ".concat(l,", selected.");default:return""}},onFocus:function(o){var s=o.context,a=o.focused,l=o.options,c=o.label,d=c===void 0?"":c,h=o.selectValue,p=o.isDisabled,m=o.isSelected,y=o.isAppleDevice,x=function(w,j){return w&&w.length?"".concat(w.indexOf(j)+1," of ").concat(w.length):""};if(s==="value"&&h)return"value ".concat(d," focused, ").concat(x(h,a),".");if(s==="menu"&&y){var v=p?" disabled":"",C="".concat(m?" selected":"").concat(v);return"".concat(d).concat(C,", ").concat(x(l,a),".")}return""},onFilter:function(o){var s=o.inputValue,a=o.resultsMessage;return"".concat(a).concat(s?" for search term "+s:"",".")}},F3=function(o){var s=o.ariaSelection,a=o.focusedOption,l=o.focusedValue,c=o.focusableOptions,d=o.isFocused,h=o.selectValue,p=o.selectProps,m=o.id,y=o.isAppleDevice,x=p.ariaLiveMessages,v=p.getOptionLabel,C=p.inputValue,N=p.isMulti,w=p.isOptionDisabled,j=p.isSearchable,k=p.menuIsOpen,O=p.options,R=p.screenReaderStatus,D=p.tabSelectsValue,I=p.isLoading,H=p["aria-label"],A=p["aria-live"],V=b.useMemo(function(){return Ot(Ot({},W3),x||{})},[x]),J=b.useMemo(function(){var F="";if(s&&V.onChange){var _=s.option,q=s.options,de=s.removedValue,Me=s.removedValues,Ne=s.value,M=function(Ee){return Array.isArray(Ee)?null:Ee},L=de||_||M(Ne),K=L?v(L):"",je=q||Me||void 0,We=je?je.map(v):[],Re=Ot({isDisabled:L&&w(L,h),label:K,labels:We},s);F=V.onChange(Re)}return F},[s,V,w,h,v]),X=b.useMemo(function(){var F="",_=a||l,q=!!(a&&h&&h.includes(a));if(_&&V.onFocus){var de={focused:_,label:v(_),isDisabled:w(_,h),isSelected:q,options:c,context:_===a?"menu":"value",selectValue:h,isAppleDevice:y};F=V.onFocus(de)}return F},[a,l,v,w,V,c,h,y]),re=b.useMemo(function(){var F="";if(k&&O.length&&!I&&V.onFilter){var _=R({count:c.length});F=V.onFilter({inputValue:C,resultsMessage:_})}return F},[c,C,k,V,O,R,I]),te=s?.action==="initial-input-focus",me=b.useMemo(function(){var F="";if(V.guidance){var _=l?"value":k?"menu":"input";F=V.guidance({"aria-label":H,context:_,isDisabled:a&&w(a,h),isMulti:N,isSearchable:j,tabSelectsValue:D,isInitialFocus:te})}return F},[H,a,l,N,w,j,k,V,h,D,te]),Te=jt(b.Fragment,null,jt("span",{id:"aria-selection"},J),jt("span",{id:"aria-focused"},X),jt("span",{id:"aria-results"},re),jt("span",{id:"aria-guidance"},me));return jt(b.Fragment,null,jt(ob,{id:m},te&&Te),jt(ob,{"aria-live":A,"aria-atomic":"false","aria-relevant":"additions text",role:"log"},d&&!te&&Te))},q3=F3,mp=[{base:"A",letters:"A"},{base:"AA",letters:""},{base:"AE",letters:""},{base:"AO",letters:""},{base:"AU",letters:""},{base:"AV",letters:""},{base:"AY",letters:""},{base:"B",letters:"B"},{base:"C",letters:"C"},{base:"D",letters:"D"},{base:"DZ",letters:""},{base:"Dz",letters:""},{base:"E",letters:"E"},{base:"F",letters:"F"},{base:"G",letters:"G"},{base:"H",letters:"H"},{base:"I",letters:"I"},{base:"J",letters:"J"},{base:"K",letters:"K"},{base:"L",letters:"L"},{base:"LJ",letters:""},{base:"Lj",letters:""},{base:"M",letters:"M"},{base:"N",letters:"N"},{base:"NJ",letters:""},{base:"Nj",letters:""},{base:"O",letters:"O"},{base:"OI",letters:""},{base:"OO",letters:""},{base:"OU",letters:""},{base:"P",letters:"P"},{base:"Q",letters:"Q"},{base:"R",letters:"R"},{base:"S",letters:"S"},{base:"T",letters:"T"},{base:"TZ",letters:""},{base:"U",letters:"U"},{base:"V",letters:"V"},{base:"VY",letters:""},{base:"W",letters:"W"},{base:"X",letters:"X"},{base:"Y",letters:"Y"},{base:"Z",letters:"Z"},{base:"a",letters:"a"},{base:"aa",letters:""},{base:"ae",letters:""},{base:"ao",letters:""},{base:"au",letters:""},{base:"av",letters:""},{base:"ay",letters:""},{base:"b",letters:"b"},{base:"c",letters:"c"},{base:"d",letters:"d"},{base:"dz",letters:""},{base:"e",letters:"e"},{base:"f",letters:"f"},{base:"g",letters:"g"},{base:"h",letters:"h"},{base:"hv",letters:""},{base:"i",letters:"i"},{base:"j",letters:"j"},{base:"k",letters:"k"},{base:"l",letters:"l"},{base:"lj",letters:""},{base:"m",letters:"m"},{base:"n",letters:"n"},{base:"nj",letters:""},{base:"o",letters:"o"},{base:"oi",letters:""},{base:"ou",letters:""},{base:"oo",letters:""},{base:"p",letters:"p"},{base:"q",letters:"q"},{base:"r",letters:"r"},{base:"s",letters:"s"},{base:"t",letters:"t"},{base:"tz",letters:""},{base:"u",letters:"u"},{base:"v",letters:"v"},{base:"vy",letters:""},{base:"w",letters:"w"},{base:"x",letters:"x"},{base:"y",letters:"y"},{base:"z",letters:"z"}],G3=new RegExp("["+mp.map(function(n){return n.letters}).join("")+"]","g"),Fx={};for(var Af=0;Af<mp.length;Af++)for(var Rf=mp[Af],Df=0;Df<Rf.letters.length;Df++)Fx[Rf.letters[Df]]=Rf.base;var qx=function(o){return o.replace(G3,function(s){return Fx[s]})},P3=$3(qx),rb=function(o){return o.replace(/^\s+|\s+$/g,"")},Y3=function(o){return"".concat(o.label," ").concat(o.value)},yp=function(o){return function(s,a){if(s.data.__isNew__)return!0;var l=Ot({ignoreCase:!0,ignoreAccents:!0,stringify:Y3,trim:!0,matchFrom:"any"},o),c=l.ignoreCase,d=l.ignoreAccents,h=l.stringify,p=l.trim,m=l.matchFrom,y=p?rb(a):a,x=p?rb(h(s)):h(s);return c&&(y=y.toLowerCase(),x=x.toLowerCase()),d&&(y=P3(y),x=qx(x)),m==="start"?x.substr(0,y.length)===y:x.indexOf(y)>-1}},Q3=["innerRef"];function X3(n){var o=n.innerRef,s=Nr(n,Q3),a=kk(s,"onExited","in","enter","exit","appear");return jt("input",It({ref:o},a,{css:Yp({label:"dummyInput",background:0,border:0,caretColor:"transparent",fontSize:"inherit",gridArea:"1 / 1 / 2 / 3",outline:0,padding:0,width:1,color:"transparent",left:-100,opacity:0,position:"relative",transform:"scale(.01)"},"","")}))}var Z3=function(o){o.cancelable&&o.preventDefault(),o.stopPropagation()};function J3(n){var o=n.isEnabled,s=n.onBottomArrive,a=n.onBottomLeave,l=n.onTopArrive,c=n.onTopLeave,d=b.useRef(!1),h=b.useRef(!1),p=b.useRef(0),m=b.useRef(null),y=b.useCallback(function(j,k){if(m.current!==null){var O=m.current,R=O.scrollTop,D=O.scrollHeight,I=O.clientHeight,H=m.current,A=k>0,V=D-I-R,J=!1;V>k&&d.current&&(a&&a(j),d.current=!1),A&&h.current&&(c&&c(j),h.current=!1),A&&k>V?(s&&!d.current&&s(j),H.scrollTop=D,J=!0,d.current=!0):!A&&-k>R&&(l&&!h.current&&l(j),H.scrollTop=0,J=!0,h.current=!0),J&&Z3(j)}},[s,a,l,c]),x=b.useCallback(function(j){y(j,j.deltaY)},[y]),v=b.useCallback(function(j){p.current=j.changedTouches[0].clientY},[]),C=b.useCallback(function(j){var k=p.current-j.changedTouches[0].clientY;y(j,k)},[y]),N=b.useCallback(function(j){if(j){var k=Sk?{passive:!1}:!1;j.addEventListener("wheel",x,k),j.addEventListener("touchstart",v,k),j.addEventListener("touchmove",C,k)}},[C,v,x]),w=b.useCallback(function(j){j&&(j.removeEventListener("wheel",x,!1),j.removeEventListener("touchstart",v,!1),j.removeEventListener("touchmove",C,!1))},[C,v,x]);return b.useEffect(function(){if(o){var j=m.current;return N(j),function(){w(j)}}},[o,N,w]),function(j){m.current=j}}var sb=["boxSizing","height","overflow","paddingRight","position"],ab={boxSizing:"border-box",overflow:"hidden",position:"relative",height:"100%"};function lb(n){n.cancelable&&n.preventDefault()}function ib(n){n.stopPropagation()}function ub(){var n=this.scrollTop,o=this.scrollHeight,s=n+this.offsetHeight;n===0?this.scrollTop=1:s===o&&(this.scrollTop=n-1)}function cb(){return"ontouchstart"in window||navigator.maxTouchPoints}var db=!!(typeof window<"u"&&window.document&&window.document.createElement),hl=0,sa={capture:!1,passive:!1};function e4(n){var o=n.isEnabled,s=n.accountForScrollbars,a=s===void 0?!0:s,l=b.useRef({}),c=b.useRef(null),d=b.useCallback(function(p){if(db){var m=document.body,y=m&&m.style;if(a&&sb.forEach(function(N){var w=y&&y[N];l.current[N]=w}),a&&hl<1){var x=parseInt(l.current.paddingRight,10)||0,v=document.body?document.body.clientWidth:0,C=window.innerWidth-v+x||0;Object.keys(ab).forEach(function(N){var w=ab[N];y&&(y[N]=w)}),y&&(y.paddingRight="".concat(C,"px"))}m&&cb()&&(m.addEventListener("touchmove",lb,sa),p&&(p.addEventListener("touchstart",ub,sa),p.addEventListener("touchmove",ib,sa))),hl+=1}},[a]),h=b.useCallback(function(p){if(db){var m=document.body,y=m&&m.style;hl=Math.max(hl-1,0),a&&hl<1&&sb.forEach(function(x){var v=l.current[x];y&&(y[x]=v)}),m&&cb()&&(m.removeEventListener("touchmove",lb,sa),p&&(p.removeEventListener("touchstart",ub,sa),p.removeEventListener("touchmove",ib,sa)))}},[a]);return b.useEffect(function(){if(o){var p=c.current;return d(p),function(){h(p)}}},[o,d,h]),function(p){c.current=p}}var t4=function(o){var s=o.target;return s.ownerDocument.activeElement&&s.ownerDocument.activeElement.blur()},n4={name:"1kfdb0e",styles:"position:fixed;left:0;bottom:0;right:0;top:0"};function o4(n){var o=n.children,s=n.lockEnabled,a=n.captureEnabled,l=a===void 0?!0:a,c=n.onBottomArrive,d=n.onBottomLeave,h=n.onTopArrive,p=n.onTopLeave,m=J3({isEnabled:l,onBottomArrive:c,onBottomLeave:d,onTopArrive:h,onTopLeave:p}),y=e4({isEnabled:s}),x=function(C){m(C),y(C)};return jt(b.Fragment,null,s&&jt("div",{onClick:t4,css:n4}),o(x))}var r4={name:"1a0ro4n-requiredInput",styles:"label:requiredInput;opacity:0;pointer-events:none;position:absolute;bottom:0;left:0;right:0;width:100%"},s4=function(o){var s=o.name,a=o.onFocus;return jt("input",{required:!0,name:s,tabIndex:-1,"aria-hidden":"true",onFocus:a,css:r4,value:"",onChange:function(){}})},a4=s4;function eh(n){var o;return typeof window<"u"&&window.navigator!=null?n.test(((o=window.navigator.userAgentData)===null||o===void 0?void 0:o.platform)||window.navigator.platform):!1}function l4(){return eh(/^iPhone/i)}function Gx(){return eh(/^Mac/i)}function i4(){return eh(/^iPad/i)||Gx()&&navigator.maxTouchPoints>1}function u4(){return l4()||i4()}function c4(){return Gx()||u4()}var d4=function(o){return o.label},f4=function(o){return o.label},p4=function(o){return o.value},h4=function(o){return!!o.isDisabled},g4={clearIndicator:Jk,container:Kk,control:a3,dropdownIndicator:Xk,group:c3,groupHeading:f3,indicatorsContainer:qk,indicatorSeparator:t3,input:m3,loadingIndicator:r3,loadingMessage:Bk,menu:Ek,menuList:Ak,menuPortal:Vk,multiValue:w3,multiValueLabel:S3,multiValueRemove:N3,noOptionsMessage:Dk,option:T3,placeholder:L3,singleValue:R3,valueContainer:Wk},m4={primary:"#2684FF",primary75:"#4C9AFF",primary50:"#B2D4FF",primary25:"#DEEBFF",danger:"#DE350B",dangerLight:"#FFBDAD",neutral0:"hsl(0, 0%, 100%)",neutral5:"hsl(0, 0%, 95%)",neutral10:"hsl(0, 0%, 90%)",neutral20:"hsl(0, 0%, 80%)",neutral30:"hsl(0, 0%, 70%)",neutral40:"hsl(0, 0%, 60%)",neutral50:"hsl(0, 0%, 50%)",neutral60:"hsl(0, 0%, 40%)",neutral70:"hsl(0, 0%, 30%)",neutral80:"hsl(0, 0%, 20%)",neutral90:"hsl(0, 0%, 10%)"},y4=4,Px=4,b4=38,x4=Px*2,v4={baseUnit:Px,controlHeight:b4,menuGutter:x4},Bf={borderRadius:y4,colors:m4,spacing:v4},w4={"aria-live":"polite",backspaceRemovesValue:!0,blurInputOnSelect:eb(),captureMenuScroll:!eb(),classNames:{},closeMenuOnSelect:!0,closeMenuOnScroll:!1,components:{},controlShouldRenderValue:!0,escapeClearsValue:!1,filterOption:yp(),formatGroupLabel:d4,getOptionLabel:f4,getOptionValue:p4,isDisabled:!1,isLoading:!1,isMulti:!1,isRtl:!1,isSearchable:!0,isOptionDisabled:h4,loadingMessage:function(){return"Loading..."},maxMenuHeight:300,minMenuHeight:140,menuIsOpen:!1,menuPlacement:"bottom",menuPosition:"absolute",menuShouldBlockScroll:!1,menuShouldScrollIntoView:!vk(),noOptionsMessage:function(){return"No options"},openMenuOnFocus:!1,openMenuOnClick:!0,options:[],pageSize:5,placeholder:"Select...",screenReaderStatus:function(o){var s=o.count;return"".concat(s," result").concat(s!==1?"s":""," available")},styles:{},tabIndex:0,tabSelectsValue:!0,unstyled:!1};function fb(n,o,s,a){var l=Xx(n,o,s),c=Zx(n,o,s),d=Qx(n,o),h=Qu(n,o);return{type:"option",data:o,isDisabled:l,isSelected:c,label:d,value:h,index:a}}function Ou(n,o){return n.options.map(function(s,a){if("options"in s){var l=s.options.map(function(d,h){return fb(n,d,o,h)}).filter(function(d){return hb(n,d)});return l.length>0?{type:"group",data:s,options:l,index:a}:void 0}var c=fb(n,s,o,a);return hb(n,c)?c:void 0}).filter(Nk)}function Yx(n){return n.reduce(function(o,s){return s.type==="group"?o.push.apply(o,Wp(s.options.map(function(a){return a.data}))):o.push(s.data),o},[])}function pb(n,o){return n.reduce(function(s,a){return a.type==="group"?s.push.apply(s,Wp(a.options.map(function(l){return{data:l.data,id:"".concat(o,"-").concat(a.index,"-").concat(l.index)}}))):s.push({data:a.data,id:"".concat(o,"-").concat(a.index)}),s},[])}function S4(n,o){return Yx(Ou(n,o))}function hb(n,o){var s=n.inputValue,a=s===void 0?"":s,l=o.data,c=o.isSelected,d=o.label,h=o.value;return(!ev(n)||!c)&&Jx(n,{label:d,value:h,data:l},a)}function N4(n,o){var s=n.focusedValue,a=n.selectValue,l=a.indexOf(s);if(l>-1){var c=o.indexOf(s);if(c>-1)return s;if(l<o.length)return o[l]}return null}function C4(n,o){var s=n.focusedOption;return s&&o.indexOf(s)>-1?s:o[0]}var zf=function(o,s){var a,l=(a=o.find(function(c){return c.data===s}))===null||a===void 0?void 0:a.id;return l||null},Qx=function(o,s){return o.getOptionLabel(s)},Qu=function(o,s){return o.getOptionValue(s)};function Xx(n,o,s){return typeof n.isOptionDisabled=="function"?n.isOptionDisabled(o,s):!1}function Zx(n,o,s){if(s.indexOf(o)>-1)return!0;if(typeof n.isOptionSelected=="function")return n.isOptionSelected(o,s);var a=Qu(n,o);return s.some(function(l){return Qu(n,l)===a})}function Jx(n,o,s){return n.filterOption?n.filterOption(o,s):!0}var ev=function(o){var s=o.hideSelectedOptions,a=o.isMulti;return s===void 0?a:s},k4=1,tv=(function(n){GN(s,n);var o=QN(s);function s(a){var l;if(FN(this,s),l=o.call(this,a),l.state={ariaSelection:null,focusedOption:null,focusedOptionId:null,focusableOptionsWithIds:[],focusedValue:null,inputIsHidden:!1,isFocused:!1,selectValue:[],clearFocusValueOnUpdate:!1,prevWasFocused:!1,inputIsHiddenAfterUpdate:void 0,prevProps:void 0,instancePrefix:"",isAppleDevice:!1},l.blockOptionHover=!1,l.isComposing=!1,l.commonProps=void 0,l.initialTouchX=0,l.initialTouchY=0,l.openAfterFocus=!1,l.scrollToFocusedOptionOnUpdate=!1,l.userIsDragging=void 0,l.controlRef=null,l.getControlRef=function(p){l.controlRef=p},l.focusedOptionRef=null,l.getFocusedOptionRef=function(p){l.focusedOptionRef=p},l.menuListRef=null,l.getMenuListRef=function(p){l.menuListRef=p},l.inputRef=null,l.getInputRef=function(p){l.inputRef=p},l.focus=l.focusInput,l.blur=l.blurInput,l.onChange=function(p,m){var y=l.props,x=y.onChange,v=y.name;m.name=v,l.ariaOnChange(p,m),x(p,m)},l.setValue=function(p,m,y){var x=l.props,v=x.closeMenuOnSelect,C=x.isMulti,N=x.inputValue;l.onInputChange("",{action:"set-value",prevInputValue:N}),v&&(l.setState({inputIsHiddenAfterUpdate:!C}),l.onMenuClose()),l.setState({clearFocusValueOnUpdate:!0}),l.onChange(p,{action:m,option:y})},l.selectOption=function(p){var m=l.props,y=m.blurInputOnSelect,x=m.isMulti,v=m.name,C=l.state.selectValue,N=x&&l.isOptionSelected(p,C),w=l.isOptionDisabled(p,C);if(N){var j=l.getOptionValue(p);l.setValue(C.filter(function(k){return l.getOptionValue(k)!==j}),"deselect-option",p)}else if(!w)x?l.setValue([].concat(Wp(C),[p]),"select-option",p):l.setValue(p,"select-option");else{l.ariaOnChange(p,{action:"select-option",option:p,name:v});return}y&&l.blurInput()},l.removeValue=function(p){var m=l.props.isMulti,y=l.state.selectValue,x=l.getOptionValue(p),v=y.filter(function(N){return l.getOptionValue(N)!==x}),C=yu(m,v,v[0]||null);l.onChange(C,{action:"remove-value",removedValue:p}),l.focusInput()},l.clearValue=function(){var p=l.state.selectValue;l.onChange(yu(l.props.isMulti,[],null),{action:"clear",removedValues:p})},l.popValue=function(){var p=l.props.isMulti,m=l.state.selectValue,y=m[m.length-1],x=m.slice(0,m.length-1),v=yu(p,x,x[0]||null);y&&l.onChange(v,{action:"pop-value",removedValue:y})},l.getFocusedOptionId=function(p){return zf(l.state.focusableOptionsWithIds,p)},l.getFocusableOptionsWithIds=function(){return pb(Ou(l.props,l.state.selectValue),l.getElementId("option"))},l.getValue=function(){return l.state.selectValue},l.cx=function(){for(var p=arguments.length,m=new Array(p),y=0;y<p;y++)m[y]=arguments[y];return gk.apply(void 0,[l.props.classNamePrefix].concat(m))},l.getOptionLabel=function(p){return Qx(l.props,p)},l.getOptionValue=function(p){return Qu(l.props,p)},l.getStyles=function(p,m){var y=l.props.unstyled,x=g4[p](m,y);x.boxSizing="border-box";var v=l.props.styles[p];return v?v(x,m):x},l.getClassNames=function(p,m){var y,x;return(y=(x=l.props.classNames)[p])===null||y===void 0?void 0:y.call(x,m)},l.getElementId=function(p){return"".concat(l.state.instancePrefix,"-").concat(p)},l.getComponents=function(){return z3(l.props)},l.buildCategorizedOptions=function(){return Ou(l.props,l.state.selectValue)},l.getCategorizedOptions=function(){return l.props.menuIsOpen?l.buildCategorizedOptions():[]},l.buildFocusableOptions=function(){return Yx(l.buildCategorizedOptions())},l.getFocusableOptions=function(){return l.props.menuIsOpen?l.buildFocusableOptions():[]},l.ariaOnChange=function(p,m){l.setState({ariaSelection:Ot({value:p},m)})},l.onMenuMouseDown=function(p){p.button===0&&(p.stopPropagation(),p.preventDefault(),l.focusInput())},l.onMenuMouseMove=function(p){l.blockOptionHover=!1},l.onControlMouseDown=function(p){if(!p.defaultPrevented){var m=l.props.openMenuOnClick;l.state.isFocused?l.props.menuIsOpen?p.target.tagName!=="INPUT"&&p.target.tagName!=="TEXTAREA"&&l.onMenuClose():m&&l.openMenu("first"):(m&&(l.openAfterFocus=!0),l.focusInput()),p.target.tagName!=="INPUT"&&p.target.tagName!=="TEXTAREA"&&p.preventDefault()}},l.onDropdownIndicatorMouseDown=function(p){if(!(p&&p.type==="mousedown"&&p.button!==0)&&!l.props.isDisabled){var m=l.props,y=m.isMulti,x=m.menuIsOpen;l.focusInput(),x?(l.setState({inputIsHiddenAfterUpdate:!y}),l.onMenuClose()):l.openMenu("first"),p.preventDefault()}},l.onClearIndicatorMouseDown=function(p){p&&p.type==="mousedown"&&p.button!==0||(l.clearValue(),p.preventDefault(),l.openAfterFocus=!1,p.type==="touchend"?l.focusInput():setTimeout(function(){return l.focusInput()}))},l.onScroll=function(p){typeof l.props.closeMenuOnScroll=="boolean"?p.target instanceof HTMLElement&&lc(p.target)&&l.props.onMenuClose():typeof l.props.closeMenuOnScroll=="function"&&l.props.closeMenuOnScroll(p)&&l.props.onMenuClose()},l.onCompositionStart=function(){l.isComposing=!0},l.onCompositionEnd=function(){l.isComposing=!1},l.onTouchStart=function(p){var m=p.touches,y=m&&m.item(0);y&&(l.initialTouchX=y.clientX,l.initialTouchY=y.clientY,l.userIsDragging=!1)},l.onTouchMove=function(p){var m=p.touches,y=m&&m.item(0);if(y){var x=Math.abs(y.clientX-l.initialTouchX),v=Math.abs(y.clientY-l.initialTouchY),C=5;l.userIsDragging=x>C||v>C}},l.onTouchEnd=function(p){l.userIsDragging||(l.controlRef&&!l.controlRef.contains(p.target)&&l.menuListRef&&!l.menuListRef.contains(p.target)&&l.blurInput(),l.initialTouchX=0,l.initialTouchY=0)},l.onControlTouchEnd=function(p){l.userIsDragging||l.onControlMouseDown(p)},l.onClearIndicatorTouchEnd=function(p){l.userIsDragging||l.onClearIndicatorMouseDown(p)},l.onDropdownIndicatorTouchEnd=function(p){l.userIsDragging||l.onDropdownIndicatorMouseDown(p)},l.handleInputChange=function(p){var m=l.props.inputValue,y=p.currentTarget.value;l.setState({inputIsHiddenAfterUpdate:!1}),l.onInputChange(y,{action:"input-change",prevInputValue:m}),l.props.menuIsOpen||l.onMenuOpen()},l.onInputFocus=function(p){l.props.onFocus&&l.props.onFocus(p),l.setState({inputIsHiddenAfterUpdate:!1,isFocused:!0}),(l.openAfterFocus||l.props.openMenuOnFocus)&&l.openMenu("first"),l.openAfterFocus=!1},l.onInputBlur=function(p){var m=l.props.inputValue;if(l.menuListRef&&l.menuListRef.contains(document.activeElement)){l.inputRef.focus();return}l.props.onBlur&&l.props.onBlur(p),l.onInputChange("",{action:"input-blur",prevInputValue:m}),l.onMenuClose(),l.setState({focusedValue:null,isFocused:!1})},l.onOptionHover=function(p){if(!(l.blockOptionHover||l.state.focusedOption===p)){var m=l.getFocusableOptions(),y=m.indexOf(p);l.setState({focusedOption:p,focusedOptionId:y>-1?l.getFocusedOptionId(p):null})}},l.shouldHideSelectedOptions=function(){return ev(l.props)},l.onValueInputFocus=function(p){p.preventDefault(),p.stopPropagation(),l.focus()},l.onKeyDown=function(p){var m=l.props,y=m.isMulti,x=m.backspaceRemovesValue,v=m.escapeClearsValue,C=m.inputValue,N=m.isClearable,w=m.isDisabled,j=m.menuIsOpen,k=m.onKeyDown,O=m.tabSelectsValue,R=m.openMenuOnFocus,D=l.state,I=D.focusedOption,H=D.focusedValue,A=D.selectValue;if(!w&&!(typeof k=="function"&&(k(p),p.defaultPrevented))){switch(l.blockOptionHover=!0,p.key){case"ArrowLeft":if(!y||C)return;l.focusValue("previous");break;case"ArrowRight":if(!y||C)return;l.focusValue("next");break;case"Delete":case"Backspace":if(C)return;if(H)l.removeValue(H);else{if(!x)return;y?l.popValue():N&&l.clearValue()}break;case"Tab":if(l.isComposing||p.shiftKey||!j||!O||!I||R&&l.isOptionSelected(I,A))return;l.selectOption(I);break;case"Enter":if(p.keyCode===229)break;if(j){if(!I||l.isComposing)return;l.selectOption(I);break}return;case"Escape":j?(l.setState({inputIsHiddenAfterUpdate:!1}),l.onInputChange("",{action:"menu-close",prevInputValue:C}),l.onMenuClose()):N&&v&&l.clearValue();break;case" ":if(C)return;if(!j){l.openMenu("first");break}if(!I)return;l.selectOption(I);break;case"ArrowUp":j?l.focusOption("up"):l.openMenu("last");break;case"ArrowDown":j?l.focusOption("down"):l.openMenu("first");break;case"PageUp":if(!j)return;l.focusOption("pageup");break;case"PageDown":if(!j)return;l.focusOption("pagedown");break;case"Home":if(!j)return;l.focusOption("first");break;case"End":if(!j)return;l.focusOption("last");break;default:return}p.preventDefault()}},l.state.instancePrefix="react-select-"+(l.props.instanceId||++k4),l.state.selectValue=Zy(a.value),a.menuIsOpen&&l.state.selectValue.length){var c=l.getFocusableOptionsWithIds(),d=l.buildFocusableOptions(),h=d.indexOf(l.state.selectValue[0]);l.state.focusableOptionsWithIds=c,l.state.focusedOption=d[h],l.state.focusedOptionId=zf(c,d[h])}return l}return qN(s,[{key:"componentDidMount",value:function(){this.startListeningComposition(),this.startListeningToTouch(),this.props.closeMenuOnScroll&&document&&document.addEventListener&&document.addEventListener("scroll",this.onScroll,!0),this.props.autoFocus&&this.focusInput(),this.props.menuIsOpen&&this.state.focusedOption&&this.menuListRef&&this.focusedOptionRef&&Jy(this.menuListRef,this.focusedOptionRef),c4()&&this.setState({isAppleDevice:!0})}},{key:"componentDidUpdate",value:function(l){var c=this.props,d=c.isDisabled,h=c.menuIsOpen,p=this.state.isFocused;(p&&!d&&l.isDisabled||p&&h&&!l.menuIsOpen)&&this.focusInput(),p&&d&&!l.isDisabled?this.setState({isFocused:!1},this.onMenuClose):!p&&!d&&l.isDisabled&&this.inputRef===document.activeElement&&this.setState({isFocused:!0}),this.menuListRef&&this.focusedOptionRef&&this.scrollToFocusedOptionOnUpdate&&(Jy(this.menuListRef,this.focusedOptionRef),this.scrollToFocusedOptionOnUpdate=!1)}},{key:"componentWillUnmount",value:function(){this.stopListeningComposition(),this.stopListeningToTouch(),document.removeEventListener("scroll",this.onScroll,!0)}},{key:"onMenuOpen",value:function(){this.props.onMenuOpen()}},{key:"onMenuClose",value:function(){this.onInputChange("",{action:"menu-close",prevInputValue:this.props.inputValue}),this.props.onMenuClose()}},{key:"onInputChange",value:function(l,c){this.props.onInputChange(l,c)}},{key:"focusInput",value:function(){this.inputRef&&this.inputRef.focus()}},{key:"blurInput",value:function(){this.inputRef&&this.inputRef.blur()}},{key:"openMenu",value:function(l){var c=this,d=this.state,h=d.selectValue,p=d.isFocused,m=this.buildFocusableOptions(),y=l==="first"?0:m.length-1;if(!this.props.isMulti){var x=m.indexOf(h[0]);x>-1&&(y=x)}this.scrollToFocusedOptionOnUpdate=!(p&&this.menuListRef),this.setState({inputIsHiddenAfterUpdate:!1,focusedValue:null,focusedOption:m[y],focusedOptionId:this.getFocusedOptionId(m[y])},function(){return c.onMenuOpen()})}},{key:"focusValue",value:function(l){var c=this.state,d=c.selectValue,h=c.focusedValue;if(this.props.isMulti){this.setState({focusedOption:null});var p=d.indexOf(h);h||(p=-1);var m=d.length-1,y=-1;if(d.length){switch(l){case"previous":p===0?y=0:p===-1?y=m:y=p-1;break;case"next":p>-1&&p<m&&(y=p+1);break}this.setState({inputIsHidden:y!==-1,focusedValue:d[y]})}}}},{key:"focusOption",value:function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"first",c=this.props.pageSize,d=this.state.focusedOption,h=this.getFocusableOptions();if(h.length){var p=0,m=h.indexOf(d);d||(m=-1),l==="up"?p=m>0?m-1:h.length-1:l==="down"?p=(m+1)%h.length:l==="pageup"?(p=m-c,p<0&&(p=0)):l==="pagedown"?(p=m+c,p>h.length-1&&(p=h.length-1)):l==="last"&&(p=h.length-1),this.scrollToFocusedOptionOnUpdate=!0,this.setState({focusedOption:h[p],focusedValue:null,focusedOptionId:this.getFocusedOptionId(h[p])})}}},{key:"getTheme",value:(function(){return this.props.theme?typeof this.props.theme=="function"?this.props.theme(Bf):Ot(Ot({},Bf),this.props.theme):Bf})},{key:"getCommonProps",value:function(){var l=this.clearValue,c=this.cx,d=this.getStyles,h=this.getClassNames,p=this.getValue,m=this.selectOption,y=this.setValue,x=this.props,v=x.isMulti,C=x.isRtl,N=x.options,w=this.hasValue();return{clearValue:l,cx:c,getStyles:d,getClassNames:h,getValue:p,hasValue:w,isMulti:v,isRtl:C,options:N,selectOption:m,selectProps:x,setValue:y,theme:this.getTheme()}}},{key:"hasValue",value:function(){var l=this.state.selectValue;return l.length>0}},{key:"hasOptions",value:function(){return!!this.getFocusableOptions().length}},{key:"isClearable",value:function(){var l=this.props,c=l.isClearable,d=l.isMulti;return c===void 0?d:c}},{key:"isOptionDisabled",value:function(l,c){return Xx(this.props,l,c)}},{key:"isOptionSelected",value:function(l,c){return Zx(this.props,l,c)}},{key:"filterOption",value:function(l,c){return Jx(this.props,l,c)}},{key:"formatOptionLabel",value:function(l,c){if(typeof this.props.formatOptionLabel=="function"){var d=this.props.inputValue,h=this.state.selectValue;return this.props.formatOptionLabel(l,{context:c,inputValue:d,selectValue:h})}else return this.getOptionLabel(l)}},{key:"formatGroupLabel",value:function(l){return this.props.formatGroupLabel(l)}},{key:"startListeningComposition",value:(function(){document&&document.addEventListener&&(document.addEventListener("compositionstart",this.onCompositionStart,!1),document.addEventListener("compositionend",this.onCompositionEnd,!1))})},{key:"stopListeningComposition",value:function(){document&&document.removeEventListener&&(document.removeEventListener("compositionstart",this.onCompositionStart),document.removeEventListener("compositionend",this.onCompositionEnd))}},{key:"startListeningToTouch",value:(function(){document&&document.addEventListener&&(document.addEventListener("touchstart",this.onTouchStart,!1),document.addEventListener("touchmove",this.onTouchMove,!1),document.addEventListener("touchend",this.onTouchEnd,!1))})},{key:"stopListeningToTouch",value:function(){document&&document.removeEventListener&&(document.removeEventListener("touchstart",this.onTouchStart),document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onTouchEnd))}},{key:"renderInput",value:(function(){var l=this.props,c=l.isDisabled,d=l.isSearchable,h=l.inputId,p=l.inputValue,m=l.tabIndex,y=l.form,x=l.menuIsOpen,v=l.required,C=this.getComponents(),N=C.Input,w=this.state,j=w.inputIsHidden,k=w.ariaSelection,O=this.commonProps,R=h||this.getElementId("input"),D=Ot(Ot(Ot({"aria-autocomplete":"list","aria-expanded":x,"aria-haspopup":!0,"aria-errormessage":this.props["aria-errormessage"],"aria-invalid":this.props["aria-invalid"],"aria-label":this.props["aria-label"],"aria-labelledby":this.props["aria-labelledby"],"aria-required":v,role:"combobox","aria-activedescendant":this.state.isAppleDevice?void 0:this.state.focusedOptionId||""},x&&{"aria-controls":this.getElementId("listbox")}),!d&&{"aria-readonly":!0}),this.hasValue()?k?.action==="initial-input-focus"&&{"aria-describedby":this.getElementId("live-region")}:{"aria-describedby":this.getElementId("placeholder")});return d?b.createElement(N,It({},O,{autoCapitalize:"none",autoComplete:"off",autoCorrect:"off",id:R,innerRef:this.getInputRef,isDisabled:c,isHidden:j,onBlur:this.onInputBlur,onChange:this.handleInputChange,onFocus:this.onInputFocus,spellCheck:"false",tabIndex:m,form:y,type:"text",value:p},D)):b.createElement(X3,It({id:R,innerRef:this.getInputRef,onBlur:this.onInputBlur,onChange:Pu,onFocus:this.onInputFocus,disabled:c,tabIndex:m,inputMode:"none",form:y,value:""},D))})},{key:"renderPlaceholderOrValue",value:function(){var l=this,c=this.getComponents(),d=c.MultiValue,h=c.MultiValueContainer,p=c.MultiValueLabel,m=c.MultiValueRemove,y=c.SingleValue,x=c.Placeholder,v=this.commonProps,C=this.props,N=C.controlShouldRenderValue,w=C.isDisabled,j=C.isMulti,k=C.inputValue,O=C.placeholder,R=this.state,D=R.selectValue,I=R.focusedValue,H=R.isFocused;if(!this.hasValue()||!N)return k?null:b.createElement(x,It({},v,{key:"placeholder",isDisabled:w,isFocused:H,innerProps:{id:this.getElementId("placeholder")}}),O);if(j)return D.map(function(V,J){var X=V===I,re="".concat(l.getOptionLabel(V),"-").concat(l.getOptionValue(V));return b.createElement(d,It({},v,{components:{Container:h,Label:p,Remove:m},isFocused:X,isDisabled:w,key:re,index:J,removeProps:{onClick:function(){return l.removeValue(V)},onTouchEnd:function(){return l.removeValue(V)},onMouseDown:function(me){me.preventDefault()}},data:V}),l.formatOptionLabel(V,"value"))});if(k)return null;var A=D[0];return b.createElement(y,It({},v,{data:A,isDisabled:w}),this.formatOptionLabel(A,"value"))}},{key:"renderClearIndicator",value:function(){var l=this.getComponents(),c=l.ClearIndicator,d=this.commonProps,h=this.props,p=h.isDisabled,m=h.isLoading,y=this.state.isFocused;if(!this.isClearable()||!c||p||!this.hasValue()||m)return null;var x={onMouseDown:this.onClearIndicatorMouseDown,onTouchEnd:this.onClearIndicatorTouchEnd,"aria-hidden":"true"};return b.createElement(c,It({},d,{innerProps:x,isFocused:y}))}},{key:"renderLoadingIndicator",value:function(){var l=this.getComponents(),c=l.LoadingIndicator,d=this.commonProps,h=this.props,p=h.isDisabled,m=h.isLoading,y=this.state.isFocused;if(!c||!m)return null;var x={"aria-hidden":"true"};return b.createElement(c,It({},d,{innerProps:x,isDisabled:p,isFocused:y}))}},{key:"renderIndicatorSeparator",value:function(){var l=this.getComponents(),c=l.DropdownIndicator,d=l.IndicatorSeparator;if(!c||!d)return null;var h=this.commonProps,p=this.props.isDisabled,m=this.state.isFocused;return b.createElement(d,It({},h,{isDisabled:p,isFocused:m}))}},{key:"renderDropdownIndicator",value:function(){var l=this.getComponents(),c=l.DropdownIndicator;if(!c)return null;var d=this.commonProps,h=this.props.isDisabled,p=this.state.isFocused,m={onMouseDown:this.onDropdownIndicatorMouseDown,onTouchEnd:this.onDropdownIndicatorTouchEnd,"aria-hidden":"true"};return b.createElement(c,It({},d,{innerProps:m,isDisabled:h,isFocused:p}))}},{key:"renderMenu",value:function(){var l=this,c=this.getComponents(),d=c.Group,h=c.GroupHeading,p=c.Menu,m=c.MenuList,y=c.MenuPortal,x=c.LoadingMessage,v=c.NoOptionsMessage,C=c.Option,N=this.commonProps,w=this.state.focusedOption,j=this.props,k=j.captureMenuScroll,O=j.inputValue,R=j.isLoading,D=j.loadingMessage,I=j.minMenuHeight,H=j.maxMenuHeight,A=j.menuIsOpen,V=j.menuPlacement,J=j.menuPosition,X=j.menuPortalTarget,re=j.menuShouldBlockScroll,te=j.menuShouldScrollIntoView,me=j.noOptionsMessage,Te=j.onMenuScrollToTop,F=j.onMenuScrollToBottom;if(!A)return null;var _=function(K,je){var We=K.type,Re=K.data,Se=K.isDisabled,Ee=K.isSelected,xe=K.label,se=K.value,Z=w===Re,T=Se?void 0:function(){return l.onOptionHover(Re)},ie=Se?void 0:function(){return l.selectOption(Re)},G="".concat(l.getElementId("option"),"-").concat(je),ge={id:G,onClick:ie,onMouseMove:T,onMouseOver:T,tabIndex:-1,role:"option","aria-selected":l.state.isAppleDevice?void 0:Ee};return b.createElement(C,It({},N,{innerProps:ge,data:Re,isDisabled:Se,isSelected:Ee,key:G,label:xe,type:We,value:se,isFocused:Z,innerRef:Z?l.getFocusedOptionRef:void 0}),l.formatOptionLabel(K.data,"menu"))},q;if(this.hasOptions())q=this.getCategorizedOptions().map(function(L){if(L.type==="group"){var K=L.data,je=L.options,We=L.index,Re="".concat(l.getElementId("group"),"-").concat(We),Se="".concat(Re,"-heading");return b.createElement(d,It({},N,{key:Re,data:K,options:je,Heading:h,headingProps:{id:Se,data:L.data},label:l.formatGroupLabel(L.data)}),L.options.map(function(Ee){return _(Ee,"".concat(We,"-").concat(Ee.index))}))}else if(L.type==="option")return _(L,"".concat(L.index))});else if(R){var de=D({inputValue:O});if(de===null)return null;q=b.createElement(x,N,de)}else{var Me=me({inputValue:O});if(Me===null)return null;q=b.createElement(v,N,Me)}var Ne={minMenuHeight:I,maxMenuHeight:H,menuPlacement:V,menuPosition:J,menuShouldScrollIntoView:te},M=b.createElement(Ik,It({},N,Ne),function(L){var K=L.ref,je=L.placerProps,We=je.placement,Re=je.maxHeight;return b.createElement(p,It({},N,Ne,{innerRef:K,innerProps:{onMouseDown:l.onMenuMouseDown,onMouseMove:l.onMenuMouseMove},isLoading:R,placement:We}),b.createElement(o4,{captureEnabled:k,onTopArrive:Te,onBottomArrive:F,lockEnabled:re},function(Se){return b.createElement(m,It({},N,{innerRef:function(xe){l.getMenuListRef(xe),Se(xe)},innerProps:{role:"listbox","aria-multiselectable":N.isMulti,id:l.getElementId("listbox")},isLoading:R,maxHeight:Re,focusedOption:w}),q)}))});return X||J==="fixed"?b.createElement(y,It({},N,{appendTo:X,controlElement:this.controlRef,menuPlacement:V,menuPosition:J}),M):M}},{key:"renderFormField",value:function(){var l=this,c=this.props,d=c.delimiter,h=c.isDisabled,p=c.isMulti,m=c.name,y=c.required,x=this.state.selectValue;if(y&&!this.hasValue()&&!h)return b.createElement(a4,{name:m,onFocus:this.onValueInputFocus});if(!(!m||h))if(p)if(d){var v=x.map(function(w){return l.getOptionValue(w)}).join(d);return b.createElement("input",{name:m,type:"hidden",value:v})}else{var C=x.length>0?x.map(function(w,j){return b.createElement("input",{key:"i-".concat(j),name:m,type:"hidden",value:l.getOptionValue(w)})}):b.createElement("input",{name:m,type:"hidden",value:""});return b.createElement("div",null,C)}else{var N=x[0]?this.getOptionValue(x[0]):"";return b.createElement("input",{name:m,type:"hidden",value:N})}}},{key:"renderLiveRegion",value:function(){var l=this.commonProps,c=this.state,d=c.ariaSelection,h=c.focusedOption,p=c.focusedValue,m=c.isFocused,y=c.selectValue,x=this.getFocusableOptions();return b.createElement(q3,It({},l,{id:this.getElementId("live-region"),ariaSelection:d,focusedOption:h,focusedValue:p,isFocused:m,selectValue:y,focusableOptions:x,isAppleDevice:this.state.isAppleDevice}))}},{key:"render",value:function(){var l=this.getComponents(),c=l.Control,d=l.IndicatorsContainer,h=l.SelectContainer,p=l.ValueContainer,m=this.props,y=m.className,x=m.id,v=m.isDisabled,C=m.menuIsOpen,N=this.state.isFocused,w=this.commonProps=this.getCommonProps();return b.createElement(h,It({},w,{className:y,innerProps:{id:x,onKeyDown:this.onKeyDown},isDisabled:v,isFocused:N}),this.renderLiveRegion(),b.createElement(c,It({},w,{innerRef:this.getControlRef,innerProps:{onMouseDown:this.onControlMouseDown,onTouchEnd:this.onControlTouchEnd},isDisabled:v,isFocused:N,menuIsOpen:C}),b.createElement(p,It({},w,{isDisabled:v}),this.renderPlaceholderOrValue(),this.renderInput()),b.createElement(d,It({},w,{isDisabled:v}),this.renderClearIndicator(),this.renderLoadingIndicator(),this.renderIndicatorSeparator(),this.renderDropdownIndicator())),this.renderMenu(),this.renderFormField())}}],[{key:"getDerivedStateFromProps",value:function(l,c){var d=c.prevProps,h=c.clearFocusValueOnUpdate,p=c.inputIsHiddenAfterUpdate,m=c.ariaSelection,y=c.isFocused,x=c.prevWasFocused,v=c.instancePrefix,C=l.options,N=l.value,w=l.menuIsOpen,j=l.inputValue,k=l.isMulti,O=Zy(N),R={};if(d&&(N!==d.value||C!==d.options||w!==d.menuIsOpen||j!==d.inputValue)){var D=w?S4(l,O):[],I=w?pb(Ou(l,O),"".concat(v,"-option")):[],H=h?N4(c,O):null,A=C4(c,D),V=zf(I,A);R={selectValue:O,focusedOption:A,focusedOptionId:V,focusableOptionsWithIds:I,focusedValue:H,clearFocusValueOnUpdate:!1}}var J=p!=null&&l!==d?{inputIsHidden:p,inputIsHiddenAfterUpdate:void 0}:{},X=m,re=y&&x;return y&&!re&&(X={value:yu(k,O,O[0]||null),options:O,action:"initial-input-focus"},re=!x),m?.action==="initial-input-focus"&&(X=null),Ot(Ot(Ot({},R),J),{},{prevProps:l,ariaSelection:X,prevWasFocused:re})}}]),s})(b.Component);tv.defaultProps=w4;var j4=b.forwardRef(function(n,o){var s=WN(n);return b.createElement(tv,It({ref:o},s))}),gb=j4;function bu({containerClass:n,name:o,value:s,options:a,onChange:l,disabled:c=!1,hideLabel:d=!1,hasPin:h,isPinned:p=!1,onTogglePin:m,hasError:y=!1,forceModalOpen:x=!1,onModalClose:v}){const C=fe(ae=>ae.setNodeTypes),w=ga(ae=>ae.theme)==="dark",[j,k]=b.useState(!1),O=b.useRef(null),R=b.useRef(null),[D,I]=b.useState([]),[H,A]=b.useState(!1),V=x||j,J=fx(),X=ae=>{if(!Array.isArray(a))return a?.[ae]},re=Array.isArray(a)?a:X("options")??[],te=!!X("image_upload"),me=X("image_folder")??"input",Te=!!X("stripSafetensorsSuffix"),F="__null__",_=re.some(ae=>ae===null),q=re.filter(ae=>ae!==null).map(ae=>String(ae)),de=Array.from(new Set([...q,...D])),Me=s===null?F:String(s??""),Ne=Me.split(/[\\/]/).pop()??Me,M=Al(Me,de),L=M===void 0?null:String(M),K=L!==null||de.includes(Me)||de.includes(Ne),je=s!=null&&Me!==""&&!K,We=K?L??(de.includes(Me)?Me:Ne):Me,Re=ae=>Te?ae.replace(/\.safetensors$/i,""):ae,Se=[];(s===null||_)&&Se.push({value:F,label:"None"}),je&&Se.push({value:Me,label:Re(Me),isMissing:!0}),Se.push(...de.map(ae=>({value:ae,label:Re(ae)})));const Ee=Se.find(ae=>ae.value===We)??null,xe=re.filter(ae=>ae!==null).length,se=x?!0:J&&!(xe>0&&xe<5),Z=te&&me==="input",T=ae=>{const ke=ae.replace(/\\/g,"/"),U=ke.lastIndexOf("/"),ce=U>=0?ke.slice(U+1):ke,He=U>=0?ke.slice(0,U):"";return mo(ce,He,"input")},ie=b.useMemo(()=>Z?{DropdownIndicator:null,IndicatorSeparator:null,Option:ke=>{const{data:U}=ke,He=U.value!==F&&!U.isMissing&&!!U.value?T(U.value):null;return u.jsx(Wx.Option,{...ke,children:u.jsxs("div",{className:"flex items-center gap-2",children:[He&&u.jsx("img",{src:He,alt:"",className:"w-[72px] h-[72px] rounded-sm object-cover bg-gray-100 shrink-0",loading:"lazy",decoding:"async"}),u.jsx("span",{className:"truncate",children:U.label})]})})}}:{DropdownIndicator:null,IndicatorSeparator:null},[Z]),G=["rs-container",h?"rs-has-pin":"rs-no-pin",y?"rs-error":"",je?"rs-missing":"",c?"rs-disabled":""].filter(Boolean).join(" "),ge=typeof document>"u"?null:document.body,B=()=>{k(!1),v?.()},ne=ae=>{ae&&l(ae.value===F?null:ae.value)},W=ae=>{ne(ae),B()},P=()=>{c||H||R.current?.click()},z=async ae=>{const ke=ae.target.files?.[0];if(ke){A(!0);try{const U=await Vb(ke,{type:me}),ce=U.subfolder?`${U.subfolder}/${U.name}`:U.name;I(He=>He.includes(ce)?He:[...He,ce]);try{const He=await Op();C(He)}catch{}l(ce)}catch(U){console.error("Failed to upload image:",U)}finally{A(!1),ae.target.value=""}}},$=te?u.jsx("button",{type:"button",className:`w-full py-2 px-3 rounded-lg border text-sm font-medium transition-colors ${c||H?"opacity-60 cursor-not-allowed border-gray-200 text-gray-400 bg-white":"border-gray-200 text-gray-700 bg-white hover:border-gray-300 hover:text-gray-900"}`,onClick:P,disabled:c||H,children:u.jsxs("span",{className:"inline-flex items-center justify-center gap-2",children:[u.jsx(Eo,{className:"w-4 h-4"}),H?"Uploading...":"Load from camera roll"]})}):null,ee=Dt.text.primary,pe=Dt.text.secondary;return se?u.jsxs("div",{className:`${n} combo-control-root combo-control-modal`,children:[!d&&u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:o}),u.jsxs("div",{className:`combo-control-trigger relative w-full p-3 comfy-input text-base flex items-center justify-between min-h-[46px] ${c?"opacity-60 cursor-not-allowed":""} ${y?"border-red-700 ring-1 ring-red-700":""}`,onClick:()=>!c&&k(!0),children:[u.jsx("span",{className:`combo-control-trigger-label truncate min-w-0 flex-1 ${Ee?"text-gray-900":"text-gray-400 dark:text-gray-500"} ${h?"pr-16":"pr-6"}`,style:Ee&&w?{color:Dt.text.onDark}:void 0,children:Ee?Ee.label:"Select..."}),u.jsxs("div",{className:"combo-control-trigger-icons flex items-center absolute right-0 top-0 bottom-0 pointer-events-none",children:[u.jsx("div",{className:"combo-control-chevron px-2 text-gray-400",children:u.jsx($u,{className:"w-5 h-5"})}),h&&u.jsx("div",{className:"combo-control-pin pointer-events-auto px-2",children:u.jsx(ua,{isPinned:p,onToggle:m})})]})]}),je&&u.jsx("div",{className:"mt-1 text-xs text-red-700",children:"Missing on ComfyUI server"}),te&&u.jsxs("div",{className:"combo-control-upload mt-2",children:[$,u.jsx("input",{ref:R,type:"file",accept:"image/*",className:"hidden",onChange:z})]}),u.jsx(Up,{title:o,isOpen:V,onClose:B,children:u.jsx(gb,{className:G,classNamePrefix:"rs",options:Se,value:Ee,onChange:W,isSearchable:!0,autoFocus:!x,menuIsOpen:x?void 0:!0,controlShouldRenderValue:!0,placeholder:"Search...",filterOption:yp({ignoreAccents:!0,ignoreCase:!0,trim:!0,matchFrom:"any"}),styles:{menu:ae=>({...ae,position:"static",boxShadow:"none",border:"none",marginTop:"0.5rem",borderRadius:0,backgroundColor:w?Dt.transparent:Dt.surface.white}),menuList:ae=>({...ae,maxHeight:"calc(100vh - 160px)",height:"auto",paddingBottom:"2rem",overflowY:"auto",overflowX:"auto",overscrollBehaviorY:"contain",overscrollBehaviorX:"contain",touchAction:"pan-y"}),option:(ae,ke)=>w?ae:{...ae,color:ee,backgroundColor:ke.isSelected?Dt.surface.gray200:ke.isFocused?Dt.surface.gray100:Dt.transparent},singleValue:ae=>({...ae,color:w?ae.color:ee}),input:ae=>({...ae,color:w?ae.color:ee}),placeholder:ae=>({...ae,color:w?ae.color:pe}),control:ae=>({...ae,borderColor:Dt.border.focusBlue,boxShadow:`0 0 0 1px ${Dt.border.focusBlue}`,backgroundColor:w?ae.backgroundColor:Dt.surface.white,color:w?ae.color:ee})},components:ie,noOptionsMessage:()=>"No matches"})})]}):u.jsxs("div",{className:`${n} combo-control-root combo-control-inline`,children:[!d&&u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:o}),u.jsxs("div",{className:"combo-control-input-wrapper relative rs-scroll-target",ref:O,children:[u.jsx(gb,{className:G,classNamePrefix:"rs",options:Se,value:Ee,onChange:ne,isSearchable:!0,isDisabled:c,filterOption:yp({ignoreAccents:!0,ignoreCase:!0,trim:!0,matchFrom:"any"}),menuPortalTarget:ge,menuPosition:"fixed",menuPlacement:"bottom",menuShouldScrollIntoView:!1,styles:{menuPortal:ae=>({...ae,zIndex:200}),menuList:ae=>({...ae,overflowY:"auto",overflowX:"auto",overscrollBehaviorY:"contain",overscrollBehaviorX:"contain",touchAction:"pan-y"}),option:(ae,ke)=>w?ae:{...ae,color:ee,backgroundColor:ke.isSelected?Dt.surface.gray200:ke.isFocused?Dt.surface.gray100:Dt.transparent},singleValue:ae=>({...ae,color:w?ae.color:ee}),input:ae=>({...ae,color:w?ae.color:ee}),placeholder:ae=>({...ae,color:w?ae.color:pe})},components:ie,noOptionsMessage:()=>"No matches"}),u.jsxs("div",{className:"combo-control-icons absolute right-0 top-0 bottom-0 flex items-center pointer-events-none",children:[u.jsx("div",{className:"combo-control-chevron px-2 text-gray-400",children:u.jsx($u,{className:"w-5 h-5"})}),h&&u.jsx("div",{className:"combo-control-pin pointer-events-auto px-2",children:u.jsx(ua,{isPinned:p,onToggle:m})}),!h&&u.jsx("div",{className:"w-3"})]})]}),je&&u.jsx("div",{className:"mt-1 text-xs text-red-700",children:"Missing on ComfyUI server"}),te&&u.jsxs("div",{className:"mt-2",children:[$,u.jsx("input",{ref:R,type:"file",accept:"image/*",className:"hidden",onChange:z})]})]})}function Bo({name:n,type:o,value:s,options:a,onChange:l,disabled:c=!1,hasError:d=!1,hideLabel:h=!1,compact:p=!1,forceModalOpen:m=!1,onModalClose:y,seedMode:x,onSeedModeChange:v,hasPin:C,isPinned:N=!1,onTogglePin:w,containerClass:j}){const[k,O]=b.useState(!1),R=()=>{c||O(!0)},D=()=>{O(!1),y?.()},I=o==="COMBO"||Array.isArray(a?.options),H=["INT","FLOAT"].includes(o.toUpperCase()),A=o.toUpperCase()==="STRING",V=n.replace(/_/g," "),J=C??(!!w||N),X=j??"space-y-2 w-full",re=j??(p?"mb-0":"mb-3"),te={name:n,value:s,options:a,onChange:l,disabled:c,hideLabel:h,hasError:d,forceModalOpen:m,onModalClose:y,containerClass:X,hasPin:J,isPinned:N,onTogglePin:w},me=()=>I?u.jsx(bu,{...te}):H?u.jsx(la,{...te,type:o,seedMode:x,onSeedModeChange:v}):A?u.jsx(Tf,{...te}):u.jsxs("div",{className:"unsupported-widget-type text-xs text-gray-400 italic",children:["Unsupported: ",o]}),Te=m||k;if(o==="LM_LORA_HEADER"){const F=!!s;return u.jsx("div",{className:`${re} lm-lora-header flex items-center justify-between p-3 bg-blue-50/50 dark:bg-blue-900/20 rounded-lg`,children:u.jsxs("div",{className:"lm-lora-header-content flex items-center gap-3",children:[u.jsx("button",{type:"button",role:"switch","aria-checked":F,onClick:()=>l(!F),className:`relative inline-flex h-6 w-11 items-center rounded-full transition ${F?"bg-blue-600":"bg-gray-300"} ${c?"opacity-60 cursor-not-allowed":"cursor-pointer"}`,disabled:c,children:u.jsx("span",{className:`inline-block h-5 w-5 transform rounded-full bg-white transition ${F?"translate-x-5":"translate-x-1"}`})}),u.jsx("span",{className:"lm-lora-header-label text-sm font-semibold text-blue-900 dark:text-blue-100 uppercase tracking-wider",children:"Toggle All Loras"})]})})}if(o==="LM_LORA"){const F=Au(s||{name:"",strength:1,clipStrength:1,active:!0,expanded:!1}),_=a||{},q=Array.isArray(_.choices)?_.choices.map(M=>String(M)):[],de=!!F.expanded||Math.abs(Number(F.clipStrength??F.strength)-Number(F.strength))>Number.EPSILON,Me=M=>{const L={...F,...M};L.expanded?L.clipStrength===void 0&&(L.clipStrength=L.strength):L.clipStrength=L.strength,l(L)},Ne=()=>{const M=!F.expanded;Me({expanded:M,clipStrength:M?F.clipStrength??F.strength:F.strength})};return u.jsxs("div",{className:`${re} lm-lora-row flex flex-col gap-3 p-3 border border-gray-200 dark:border-gray-800 rounded-lg bg-gray-50/50 dark:bg-gray-900/50 ${F.active?"":"opacity-60"}`,children:[u.jsxs("div",{className:"lm-lora-row-actions flex items-center gap-2",children:[u.jsx("button",{type:"button",onClick:()=>Me({active:!F.active}),className:`lm-lora-enabled-button flex-1 py-2 rounded-lg text-sm font-semibold transition-colors ${F.active?"bg-blue-600 text-white":"bg-gray-700 text-white"} ${c?"opacity-60 cursor-not-allowed":""}`,disabled:c,children:F.active?"Enabled":"Disabled"}),u.jsx("button",{type:"button",onClick:()=>l(null),className:`lm-lora-remove-button flex-1 py-2 rounded-lg text-sm font-semibold bg-red-600 text-white hover:bg-red-700 transition-colors ${c?"opacity-60 cursor-not-allowed":""}`,disabled:c,children:"Remove"})]}),u.jsx("div",{className:"lm-lora-row-header flex items-center gap-3",children:u.jsx("div",{className:"lm-lora-select flex-grow min-w-0",children:q.length>0?u.jsx(bu,{containerClass:"space-y-0 w-full",name:"",hideLabel:!0,value:F.name,options:{options:q,stripSafetensorsSuffix:!0},onChange:M=>Me({name:String(M)}),disabled:c,hasPin:!1}):u.jsx(Tf,{containerClass:"space-y-0 w-full",name:"",hideLabel:!0,value:F.name,options:{placeholder:"LoRA name"},onChange:M=>Me({name:String(M)}),disabled:c,hasPin:!1})})}),u.jsxs("div",{className:"lm-lora-strengths flex flex-col gap-2",children:[u.jsx(la,{containerClass:"space-y-0",name:de?"Model strength":"Strength",value:Number(F.strength),options:{min:-10,max:10,step:.01},onChange:M=>Me({strength:M}),disabled:c,type:"FLOAT"}),de&&u.jsx(la,{containerClass:"space-y-0",name:"Clip strength",value:Number(F.clipStrength??F.strength),options:{min:-10,max:10,step:.01},onChange:M=>Me({clipStrength:M}),disabled:c,type:"FLOAT"}),u.jsx("button",{type:"button",onClick:Ne,className:`lm-lora-clip-toggle py-2 px-3 border border-gray-200 rounded-lg text-sm font-medium text-gray-600 hover:text-blue-600 hover:border-blue-500 transition ${c?"opacity-60 cursor-not-allowed":""}`,disabled:c,children:de?"Hide clip strength":"Separate clip strength"})]})]})}if(o==="LM_LORA_ADD"){const F=a||{},_=()=>{l(_b(F.choices))};return u.jsx("div",{className:`${re} lm-lora-add`,children:u.jsxs("button",{onClick:_,className:"w-full py-2 px-4 border-2 border-dashed border-gray-300 dark:border-gray-700 rounded-lg text-sm font-medium text-gray-500 hover:text-blue-500 hover:border-blue-500 transition-all flex items-center justify-center gap-2",disabled:c,children:[u.jsx(Eo,{className:"w-5 h-5"}),"Add Lora"]})})}if(o==="TW_WORD"){const _=!!(a||{}).allowStrengthAdjustment,q=Su(s||{text:"",active:!0,strength:null},{allowStrengthAdjustment:_}),de=Me=>{const Ne={...q,...Me};_||(Ne.strength=null),l(Ne)};return u.jsxs("div",{className:`${re} tw-word-row flex flex-col gap-2 p-3 border border-gray-200 dark:border-gray-800 rounded-lg bg-gray-50/60 dark:bg-gray-900/50 ${q.active?"":"opacity-60"}`,children:[u.jsxs("div",{className:"tw-word-header flex items-center justify-between gap-3",children:[u.jsx("div",{className:"min-w-0",children:u.jsx("div",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 break-words",children:q.text||"Trigger Word"})}),u.jsx("button",{type:"button",onClick:()=>de({active:!q.active}),className:`tw-word-toggle px-3 py-1.5 rounded-lg text-xs font-semibold transition-colors ${q.active?"bg-blue-600 text-white":"bg-gray-700 text-white"} ${c?"opacity-60 cursor-not-allowed":""}`,disabled:c,children:q.active?"Enabled":"Disabled"})]}),_&&u.jsx(la,{containerClass:"space-y-0",name:"Strength",value:Number(q.strength??1),options:{min:0,max:10,step:.01},onChange:Me=>de({strength:Me}),disabled:c,type:"FLOAT"})]})}if(o==="POWER_LORA_HEADER")return u.jsx("div",{className:`${re} power-lora-header flex items-center justify-between p-3 bg-blue-50/50 dark:bg-blue-900/20 rounded-lg`,children:u.jsxs("div",{className:"power-lora-header-content flex items-center gap-3",children:[u.jsx("input",{type:"checkbox",onChange:F=>l(F.target.checked),className:"w-5 h-5 rounded cursor-pointer",disabled:c}),u.jsx("span",{className:"power-lora-header-label text-sm font-semibold text-blue-900 dark:text-blue-100 uppercase tracking-wider",children:"Toggle All Loras"})]})});if(o==="POWER_LORA"){const F=s||{on:!0,lora:"",strength:1},_=a||{},q=_.choices,de=_.showSeparate,Me=(Ne,M)=>{l({...F,[Ne]:M})};return u.jsxs("div",{className:`${re} power-lora-row flex flex-col gap-2 p-3 border border-gray-200 dark:border-gray-800 rounded-lg bg-gray-50/50 dark:bg-gray-900/50 ${F.on?"":"opacity-60"}`,children:[u.jsxs("div",{className:"power-lora-row-actions flex items-center gap-2",children:[u.jsx("button",{type:"button",onClick:()=>Me("on",!F.on),className:`power-lora-enabled-button flex-1 py-2 rounded-lg text-sm font-semibold transition-colors ${F.on?"bg-blue-600 text-white":"bg-gray-700 text-white"} ${c?"opacity-60 cursor-not-allowed":""}`,disabled:c,children:F.on?"Enabled":"Disabled"}),u.jsx("button",{type:"button",onClick:()=>l(null),className:`power-lora-remove-button flex-1 py-2 rounded-lg text-sm font-semibold bg-red-600 text-white hover:bg-red-700 transition-colors ${c?"opacity-60 cursor-not-allowed":""}`,disabled:c,children:"Remove"})]}),u.jsx("div",{className:"power-lora-row-header flex items-center gap-3",children:u.jsx("div",{className:"power-lora-select flex-grow min-w-0",children:u.jsx(Bo,{name:"",hideLabel:!0,compact:!0,type:"COMBO",value:F.lora,options:q,onChange:Ne=>Me("lora",Ne),disabled:c})})}),u.jsxs("div",{className:"power-lora-strengths flex flex-col",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 ml-1",children:de?"Model strength":"Strength"}),u.jsx("div",{className:"power-lora-strength-row flex items-center gap-3",children:u.jsx("div",{className:"power-lora-strength-input flex-grow",children:u.jsx(Bo,{name:"",hideLabel:!0,compact:!0,type:"FLOAT",value:F.strength,options:{min:-10,max:10,step:.01},onChange:Ne=>Me("strength",Ne),disabled:c})})}),de&&u.jsx("label",{className:"block text-sm font-medium text-gray-700 ml-1",children:"Clip strength"}),de&&u.jsx("div",{className:"power-lora-strength-row flex items-center gap-3",children:u.jsx("div",{className:"power-lora-strength-input flex-grow",children:u.jsx(Bo,{name:"",hideLabel:!0,compact:!0,type:"FLOAT",value:F.strengthTwo??F.strength,options:{min:-10,max:10,step:.01},onChange:Ne=>Me("strengthTwo",Ne),disabled:c})})})]})]})}if(o==="POWER_LORA_ADD"){const F=()=>{l({on:!0,lora:"None",strength:1,model_strength:1,clip_strength:1})};return u.jsx("div",{className:`${re} power-lora-add`,children:u.jsxs("button",{onClick:F,className:"w-full py-2 px-4 border-2 border-dashed border-gray-300 dark:border-gray-700 rounded-lg text-sm font-medium text-gray-500 hover:text-blue-500 hover:border-blue-500 transition-all flex items-center justify-center gap-2",disabled:c,children:[u.jsx(Eo,{className:"w-5 h-5"}),"Add Lora"]})})}return A?u.jsx(Tf,{...te}):I?u.jsx(bu,{...te}):H?u.jsx(la,{...te,type:o,seedMode:x,onSeedModeChange:v}):o.toUpperCase()==="BOOLEAN"?u.jsx(bu,{...te,value:String(!!s),options:["true","false"],onChange:F=>l(String(F).toLowerCase()==="true")}):u.jsxs("div",{id:`widget-control-${n}`,className:`widget-control-root ${p?"compact-control":""}`,children:[!h&&u.jsxs("div",{id:`widget-label-container-${n}`,className:"flex items-center justify-between mb-1.5 px-1",children:[u.jsx("label",{id:`widget-label-${n}`,className:"text-[10px] font-bold text-gray-500 uppercase tracking-wider truncate mr-2",children:V}),d&&u.jsx("div",{id:`widget-error-icon-${n}`,className:"text-red-500",title:"Error in this input",children:u.jsx(tx,{className:"w-3.5 h-3.5"})})]}),u.jsx("div",{id:`widget-trigger-${n}`,className:`
          control-trigger
          relative flex items-center justify-between
          bg-gray-50 border border-gray-200 rounded-xl px-3 py-2.5
          active:bg-gray-100 active:border-gray-300 transition-all
          ${c?"opacity-50 grayscale pointer-events-none":"cursor-pointer"}
          ${d?"border-red-300 bg-red-50/30":""}
        `,onClick:R,children:u.jsx("div",{id:`widget-value-display-${n}`,className:"value-display flex-1 truncate text-sm font-medium text-gray-900",children:I?s||"Select...":s!=null?String(s):"Empty"})}),u.jsx(Up,{isOpen:Te,title:V,onClose:D,children:u.jsx("div",{id:`modal-control-wrapper-${n}`,className:"p-2",children:me()})})]})}const M4="__mobile_origin";function xl(n){if(!n)return null;const s=n.properties?.[M4];if(!s||typeof s!="object")return null;const a=s.scope;if(a==="root"){const l=s.nodeId;return typeof l=="number"?{scope:"root",nodeId:l}:null}if(a==="subgraph"){const l=s.nodeId,c=s.subgraphId;if(typeof l=="number"&&typeof c=="string")return{scope:"subgraph",subgraphId:c,nodeId:l}}return null}function mb(n,o,s){const a=s??"root",l=xl(n);return l?.scope==="subgraph"?a!=="root"&&l.subgraphId===a&&l.nodeId===o:l?.scope==="root"?a==="root"&&l.nodeId===o:a==="root"&&n.id===o}function O4(n){const o=xl(n);return hn({type:"node",nodeId:n.id,subgraphId:o?.scope==="subgraph"?o.subgraphId:null})}function T4(n,o){if(!n)return null;if(n[o])return o;const s=Object.entries(n).find(([,a])=>a.display_name===o||a.name===o);return s?s[0]:null}function yb(n){return yr(n)||Iu(n)||Sp(n)||wu(n)||vs(n)}function E4(n,o){return n?.nodes.some(s=>yb(s.type))?!0:o?Object.entries(o).some(([s,a])=>[s,a.name,a.display_name].filter(c=>typeof c=="string"&&c.length>0).some(c=>yb(c))):!1}const hr=bo((n,o)=>{const s=()=>{const{workflow:v,nodeTypes:C}=fe.getState(),N=E4(v,C);return o().isLoraManagerAvailable!==N&&n({isLoraManagerAvailable:N}),N},a=v=>{if(typeof v.stableKey=="string"&&v.stableKey)return v.stableKey;const C=O4(v);return fe.getState().stableKeyByPointer[C]??null},l=v=>{if(typeof v=="number")return v;if(typeof v=="string"){const C=Number(v);return Number.isFinite(C)?C:null}return null},c=(v,C,N)=>{const w=C.node_id??C.id,j=typeof C.graph_id=="string"?C.graph_id:null,k=l(w);return k===null?[]:k===-1&&N?.allowBroadcastToLoraNodes?v.nodes.filter(R=>yr(R.type)):v.nodes.filter(R=>mb(R,k,j))},d=(v,C=null)=>{if(!s())return;const{workflow:N,nodeTypes:w}=fe.getState();if(!N)return;const j=N.nodes.find(F=>mb(F,v,C));if(!j)return;const k=Iu(j.type),O=wu(j.type),R=Sp(j.type);if(!k&&!O&&!R)return;const D=new Map(N.nodes.map(F=>[F.id,F])),I=new Map(N.links.map(F=>[F[0],F])),H=F=>!!F&&typeof F=="object"&&!Array.isArray(F),A=F=>F.mode===void 0||F.mode===0||F.mode===3,V=F=>{const _=xl(F);return{node_id:_?.nodeId??F.id,graph_id:_?.scope==="subgraph"?_.subgraphId:"root"}},J=F=>{const _=[];for(const q of F.outputs??[]){const de=q.links??[];for(const Me of de){const Ne=I.get(Me);if(!Ne)continue;const M=D.get(Ne[3]);M&&vs(M.type)&&_.push(M)}}return _},X=(F,_)=>{const q=J(F);if(q.length===0)return;const de=[],Me=new Set;for(const Ne of q){const M=V(Ne),L=`${M.graph_id}:${M.node_id}`;Me.has(L)||(Me.add(L),de.push(M))}de.length!==0&&qw(Array.from(_),de).catch(Ne=>{console.warn("[LoraManager] Failed to request trigger words:",Ne)})},re=F=>{const _=new Set;if(Lw(F.type)){if(!Array.isArray(F.widgets_values))return _;const M=F.widgets_values;let L=null;if(w){const K=$n(N,w,F,"cycler_config");K!==null&&(L=M[K])}if(L||(L=M.find(K=>H(K)&&(typeof K.current_lora_filename=="string"||typeof K.current_lora_name=="string"))),H(L)){const K=typeof L.current_lora_filename=="string"?L.current_lora_filename:typeof L.current_lora_name=="string"?L.current_lora_name:"";K&&_.add(K)}return _}if(!Array.isArray(F.widgets_values))return _;const q=w?$n(N,w,F,"text"):null,de=bs(F,q);if(de===null)return _;const Me=F.widgets_values[de],Ne=_u(Me)??(Array.isArray(Me)?Me:null);return Ne&&Ne.forEach(M=>{!M||typeof M.name!="string"||M.active!==!1&&_.add(M.name)}),_},te=F=>{const _=[];for(const q of F.inputs??[]){if(q.name!=="lora_stack"||q.link==null)continue;const de=Mp(N,q.link);if(!de)continue;const Me=D.get(de.nodeId);Me&&wu(Me.type)&&_.push(Me)}return _},me=(F,_=new Set)=>{if(_.has(F.id))return new Set;_.add(F.id);const q=new Set;A(F)&&re(F).forEach(Ne=>q.add(Ne));const de=te(F);for(const Me of de)me(Me,_).forEach(M=>q.add(M));return q},Te=(F,_=new Set)=>{if(!_.has(F.id)){_.add(F.id);for(const q of F.outputs??[]){const de=q.links??[];for(const Me of de){const Ne=I.get(Me);if(!Ne)continue;const M=D.get(Ne[3]);if(M){if(Iu(M.type)){const L=me(M);X(M,L);continue}if(wu(M.type)){Te(M,_);continue}(M.type==="Reroute"||M.mode===4)&&Te(M,_)}}}}};if(k){const F=me(j);X(j,F);return}if(O){const F=A(j)?re(j):new Set;X(j,F),Te(j);return}if(R){const F=A(j)?re(j):new Set;X(j,F)}},h=v=>{const C=xl(v),N=C?.nodeId??v.id,w=C?.scope==="subgraph"?C.subgraphId:"root";d(N,w)};return{isLoraManagerAvailable:!1,refreshLoraManagerAvailability:s,applyLoraCodeUpdate:v=>{if(!s())return;const{workflow:C,nodeTypes:N,updateNodeWidgets:w}=fe.getState();if(!C)return;const j=typeof v.lora_code=="string"?v.lora_code:"",k=v.mode==="replace"?"replace":"append";if(!j)return;c(C,v,{allowBroadcastToLoraNodes:!0}).forEach(R=>{const D=N?$n(C,N,R,"text"):null,I=bs(R,D);if(D===null&&I===null)return;const H=Array.isArray(R.widgets_values)?R.widgets_values:[],A=D!==null?String(H[D]??""):"",V=k==="replace"?j:A.trim()?`${A.trim()} ${j}`:j,J=I!==null&&Array.isArray(H[I])?H[I]:[],X=Gf(V,J),re={};if(D!==null&&(re[D]=V),I!==null&&(re[I]=X),Object.keys(re).length>0){const te=a(R);if(!te)return;w(te,re),h(R)}})},applyTriggerWordUpdate:v=>{if(!s())return;const{workflow:C,nodeTypes:N,updateNodeWidgets:w}=fe.getState();if(!C||!N||typeof v.message!="string")return;const j=v.message;c(C,v).forEach(O=>{if(!vs(O.type)||!Array.isArray(O.widgets_values))return;const R=$n(C,N,O,"group_mode"),D=$n(C,N,O,"default_active"),I=$n(C,N,O,"allow_strength_adjustment"),H=R!==null?!!O.widgets_values[R]:!0,A=D!==null?!!O.widgets_values[D]:!0,V=I!==null?!!O.widgets_values[I]:!1,J=$n(C,N,O,"toggle_trigger_words"),X=J!==null?J:Xu(O);if(X===null)return;const re=Ll(O.widgets_values[X])??_l(O.widgets_values[X])??[],te=Pf(j,{groupMode:H,defaultActive:A,allowStrengthAdjustment:V,existingList:re}),me={[X]:te},Te=C.widget_idx_map?.[String(O.id)],F=Te?.originalMessage??Te?.orinalMessage,_=F!==void 0?F:Np(O,X);_!==null&&Cp(O.widgets_values[_])!==j&&(me[_]=j);const q=a(O);q&&w(q,me)})},applyWidgetUpdate:v=>{if(!s())return;const{workflow:C,nodeTypes:N,updateNodeWidget:w,updateNodeWidgets:j}=fe.getState();if(!C)return;const k=typeof v.widget_name=="string"?v.widget_name:"",O=v.value;if(!k)return;c(C,v).forEach(D=>{const I=a(D);if(!I)return;const H=X=>{let re=null;if(N&&(re=$n(C,N,D,X)),re===null){const me=C.widget_idx_map?.[String(D.id)]?.[X];re=me!==void 0?me:null}return re===null&&X==="loras"&&(re=bs(D)),re};let A=O;if(N){const X=N[D.type],te=(X?.input?.required?.[k]||X?.input?.optional?.[k])?.[0];if(Array.isArray(te)){const me=Al(O,te);me!==void 0&&(A=me)}}if(!Array.isArray(D.widgets_values)){w(I,0,A,k);return}const V=H(k),J=yr(D.type);if(J&&k==="text"&&typeof A=="string"){const X=bs(D,V);if(X!==null){const re=Array.isArray(D.widgets_values[X])?D.widgets_values[X]:[],te=Gf(A,re),me={};V!==null&&(me[V]=A),me[X]=te,j(I,me),h(D);return}}if(J&&k==="loras"){const X=V,re=_u(A)??(Array.isArray(A)?A:null),te=H("text"),me={};if(X!==null&&(me[X]=A),te!==null&&re){const Te=typeof D.widgets_values[te]=="string"?D.widgets_values[te]:"";me[te]=Ab(Te,re)}if(Object.keys(me).length>0){j(I,me),h(D);return}}V!==null&&(w(I,V,A,k),J&&(k==="cycler_config"||k==="randomizer_config")&&h(D))})},syncTriggerWordsForNode:d,registerLoraManagerNodes:async()=>{if(!s())return;const{workflow:v,nodeTypes:C}=fe.getState();if(!v)return;const N=new Set(["ckpt_name","unet_name"]),w=[];if(v.nodes.forEach(j=>{const k=xl(j),O=k?.nodeId??j.id,R=k?.scope==="subgraph"?k.subgraphId:"root",D=yr(j.type),I=T4(C,j.type),H=I?C?.[I]:null,A=new Set,V=H?.input?.required??{},J=H?.input?.optional??{};Object.keys(V).forEach(Te=>A.add(Te)),Object.keys(J).forEach(Te=>A.add(Te)),D&&A.add("loras");const X=Array.from(A).some(Te=>N.has(Te));if(!D&&!X)return;const re=j.title,te=j.properties?.title,me=typeof re=="string"&&re.trim()?re.trim():typeof te=="string"&&te.trim()?te.trim():j.type;w.push({node_id:O,graph_id:R,graph_name:null,bgcolor:j.bgcolor??j.color??null,title:me,type:j.type,comfy_class:j.type,capabilities:{supports_lora:D,widget_names:Array.from(A)}})}),w.length!==0)try{await Fw(w)}catch(j){console.warn("[LoraManager] Failed to register nodes:",j)}}}});function I4({node:n,isBypassed:o,isKSampler:s,workflowExists:a,nodeTypesExists:l,visibleInputWidgets:c,visibleWidgets:d,errorInputNames:h,onUpdateNodeWidget:p,onUpdateNodeWidgets:m,getWidgetIndexForInput:y,findSeedWidgetIndex:x,setSeedMode:v,isWidgetPinned:C,toggleWidgetPin:N}){const w=Array.isArray(n.widgets_values)?n.widgets_values:[],j=fe(B=>B.nodeTypes),k=fe(B=>B.workflow),O=hr(B=>B.syncTriggerWordsForNode),R=fe(B=>B.bypassAllInContainer),D=Gn(B=>B.seedModes[n.id]),I=Gn(B=>B.seedLastValues[n.id]??null),H=n.type==="Fast Groups Bypasser (rgthree)",A=yr(n.type),V=vs(n.type),J=!s&&a&&l?x():null,X=J!==null?J+1:null,re=X!==null?w[X]:void 0,te=typeof re=="string",me=!s&&J!==null&&!te,Te=me?c.filter(B=>B.name!=="seed"&&B.name!=="noise_seed"):c,F=me?d.filter(B=>B.name!=="seed"&&B.name!=="noise_seed"):d,_=d.length>0||c.length>0,q=b.useMemo(()=>{if(!H||!k)return[];const B=n.properties??{},ne=typeof B.matchColors=="string"?B.matchColors:"",W=typeof B.matchTitle=="string"?B.matchTitle:"",P=B.showAllGraphs!==!1,z=typeof B.sort=="string"?B.sort:"position",$=typeof B.customSortAlphabet=="string"?B.customSortAlphabet:"",ee=Dt.workflow.fastGroupBypassColors,pe=ne.split(",").map(Ie=>Ie.trim()).filter(Boolean).flatMap(Ie=>ky(Ie,ee)),ae=new Set(pe),ke=pe.map(Ie=>jl(Ie)??lx(Ie)).filter(Ie=>!!Ie).map(Ie=>jy(Ie)).filter(Ie=>!!Ie);let U=null;if(W.trim())try{U=new RegExp(W,"i")}catch(Ie){return console.error(Ie),[]}let ce=null;if(z==="custom alphabet"){const Ie=$.replace(/\n/g,"").trim().toLowerCase();Ie&&(ce=Ie.includes(",")?Ie.split(",").map(_e=>_e.trim()).filter(Boolean):Ie.split("")),ce?.length||(ce=null)}const He=new Map(k.nodes.map(Ie=>[Ie.id,Ie])),Ve=[],qe=Ie=>{if(ae.size>0){const _e=Ie.color?ky(Ie.color,ee):[],Ze=Ie.color?jl(Ie.color):null,wt=Ze?jy(Ze):null,pt=_e.some(_t=>ae.has(_t))||(Ze?ae.has(Ze):!1),Lt=!!(wt&&ke.some(_t=>{const Vt=Math.abs(_t.h-wt.h);return Math.min(Vt,360-Vt)<=25}));if(!pt&&!Lt)return!1}return!(U&&!U.test(Ie.title||""))},ot=(Ie,_e)=>{if(!qe(Ie))return;const Ze=Ie.stableKey??null;if(!Ze)return;const wt=ep(k,Ie.id,_e);let pt=!1;for(const Lt of wt){const _t=He.get(Lt);if(!(!_t||_t.mode===4)){pt=!0;break}}Ve.push({key:`${_e??"root"}-${Ie.id}`,label:Ie.title?.trim()||`Group ${Ie.id}`,stableKey:Ze,color:Ie.color,isEngaged:pt,isDisabled:wt.size===0,group:Ie})},Ge=n.properties?.__mobile_origin,Xe=Ge?.scope==="subgraph"?Ge.subgraphId:null;if(P){for(const Ie of k.groups??[])ot(Ie,null);for(const Ie of k.definitions?.subgraphs??[])for(const _e of Ie.groups??[])ot(_e,Ie.id)}else if(Xe){const Ie=k.definitions?.subgraphs?.find(_e=>_e.id===Xe);for(const _e of Ie?.groups??[])ot(_e,Xe)}else for(const Ie of k.groups??[])ot(Ie,null);return z==="alphanumeric"?Ve.sort((Ie,_e)=>Ie.label.localeCompare(_e.label)):ce?.length?Ve.sort((Ie,_e)=>{const Ze=Ie.label.toLowerCase(),wt=_e.label.toLowerCase();let pt=-1,Lt=-1;for(const[_t,Vt]of ce.entries())if(pt<0&&Ze.startsWith(Vt)&&(pt=_t),Lt<0&&wt.startsWith(Vt)&&(Lt=_t),pt>-1&&Lt>-1)break;if(pt>-1&&Lt>-1){const _t=pt-Lt;return _t===0?Ze.localeCompare(wt):_t}return pt>-1?-1:Lt>-1?1:Ze.localeCompare(wt)}):Ve.sort((Ie,_e)=>{const Ze=Ie.group.bounding,wt=_e.group.bounding;return Ze[1]!==wt[1]?Ze[1]-wt[1]:Ze[0]-wt[0]}),Ve},[H,n.properties,k]),de=B=>()=>{B.isDisabled||R(B.stableKey,B.isEngaged)},Me=B=>{typeof B=="string"&&["fixed","randomize","increment","decrement"].includes(B)&&v(n.id,B)},Ne=B=>ne=>{p(B,ne),Me(ne)},M=B=>ne=>{p(B,ne,"seed"),v(n.id,"fixed")},L=B=>()=>{if(!j)return;const ne=vl(j,n);p(B,ne,"seed"),v(n.id,"fixed")},K=B=>()=>{typeof I=="number"&&(p(B,I,"seed"),v(n.id,"fixed"))},je=(B,ne)=>{const W={[B]:ne};if(k&&j){const P=y("text");if(P!==null&&Array.isArray(n.widgets_values)){const z=n.widgets_values[P],$=Ab(typeof z=="string"?z:"",ne);W[P]=$}}m(W),Z()},We=B=>{if(!Array.isArray(n.widgets_values))return[];const ne=n.widgets_values[B];return _u(ne)??[]},Re=(B,ne,W)=>{const P={[B]:ne,...W??{}};m(P)},Se=B=>{if(!Array.isArray(n.widgets_values))return[];const ne=n.widgets_values[B];return Ll(ne)??_l(ne)??[]},Ee=B=>{if(!Array.isArray(n.widgets_values))return"";const ne=k?.widget_idx_map?.[String(n.id)],W=ne?.originalMessage??ne?.orinalMessage,P=W!==void 0?W:Np(n,B);if(P===null)return"";const z=n.widgets_values[P];return Cp(z)??""},xe=()=>{const B=y("group_mode"),ne=y("default_active"),W=y("allow_strength_adjustment"),P=B!==null?!!w[B]:!0,z=ne!==null?!!w[ne]:!0,$=W!==null?!!w[W]:!1;return{groupMode:P,defaultActive:z,allowStrengthAdjustment:$}},se=()=>{const B=y("toggle_trigger_words");return B!==null?B:Xu(n)},Z=()=>{const B=n.properties?.__mobile_origin,ne=B?.scope==="subgraph"?B.subgraphId??null:"root",W=typeof B?.nodeId=="number"?B.nodeId:n.id;O(W,ne)},T=B=>ne=>{p(B.widgetIndex,ne,B.name)},ie=(B,ne)=>!(B.startsWith("LM_LORA")||B.startsWith("TW_")||A&&ne==="text"),G=B=>ne=>{if(B.type==="TW_WORD"){const W=B.widgetIndex,P=B.options?.entryIndex;if(P==null)return;const z=Se(W);if(!z[P])return;if(typeof ne=="object"&&ne){const $=xe(),ee=[...z];ee[P]=Su({...ee[P],...ne},{defaultActive:$.defaultActive,allowStrengthAdjustment:$.allowStrengthAdjustment}),Re(W,ee)}return}if(V&&B.name==="default_active"&&typeof ne=="boolean"){const W=se();if(W!==null){const z=Se(W).map($=>({...$,active:ne}));Re(W,z,{[B.widgetIndex]:ne});return}}if(V&&B.name==="group_mode"&&typeof ne=="boolean"){const W=se();if(W!==null){const P=Se(W),z=xe(),$=Ee(W),ee=$?Pf($,{groupMode:ne,defaultActive:z.defaultActive,allowStrengthAdjustment:z.allowStrengthAdjustment,existingList:P}):P.map(pe=>Su(pe,{defaultActive:z.defaultActive,allowStrengthAdjustment:z.allowStrengthAdjustment}));Re(W,ee,{[B.widgetIndex]:ne});return}}if(V&&B.name==="allow_strength_adjustment"&&typeof ne=="boolean"){const W=se();if(W!==null){const P=Se(W),z=xe(),$=Ee(W),ee=$?Pf($,{groupMode:z.groupMode,defaultActive:z.defaultActive,allowStrengthAdjustment:ne,existingList:P}):P.map(pe=>Su(pe,{defaultActive:z.defaultActive,allowStrengthAdjustment:ne}));Re(W,ee,{[B.widgetIndex]:ne});return}}if(B.type==="LM_LORA_HEADER"&&typeof ne=="boolean"){const W=B.widgetIndex,P=We(W);if(P.length===0)return;const z=P.map($=>({...$,active:ne}));je(W,z);return}if(B.type==="LM_LORA"){const W=B.widgetIndex,P=B.options?.entryIndex;if(P==null)return;const z=We(W);if(!z[P])return;if(ne===null){const $=z.filter((ee,pe)=>pe!==P);je(W,$);return}if(typeof ne=="object"&&ne){const $=[...z];$[P]=Au({...$[P],...ne}),je(W,$)}return}if(B.type==="LM_LORA_ADD"){const W=B.widgetIndex,P=We(W),z=typeof ne=="object"&&ne?Au(ne):_b(B.options?.choices);je(W,[...P,z]);return}if(A&&B.name==="text"&&typeof ne=="string"){const W=bs(n,B.widgetIndex);if(W!==null){const P=We(W),z=Gf(ne,P);m({[B.widgetIndex]:ne,[W]:z}),Z();return}}if(B.type==="POWER_LORA_HEADER"&&typeof ne=="boolean"){const{loraIndices:W}=B.options||{};if(W){const P={},z=n.widgets_values;Array.isArray(z)&&(W.forEach($=>{const ee=z[$];P[$]={...ee,on:ne}}),m(P))}}else p(B.widgetIndex,ne,B.name)},ge=(B,ne)=>{const W=B.options;let P=null;if(W&&typeof W=="object"&&!Array.isArray(W)){const $=W.entryIndex;typeof $=="number"&&Number.isFinite($)&&(P=$)}const z=P!==null?P:B.name||B.type;return`${ne}-${B.widgetIndex}-${B.type}-${z}`};return!_&&q.length===0?null:u.jsxs("div",{className:"node-parameters mb-2",children:[q.length>0&&u.jsxs("div",{className:"mb-4",children:[u.jsx("div",{className:"text-xs text-gray-400 dark:text-gray-300 mb-1.5 uppercase tracking-wide",children:"Groups"}),u.jsx("div",{className:"space-y-2",children:q.map(B=>u.jsxs("div",{className:`flex items-center justify-between gap-3 rounded-lg border px-3 py-2 bg-gray-50/40 dark:bg-gray-900/60 ${B.isDisabled?"border-gray-200 dark:border-white/10 opacity-60":"border-gray-200 dark:border-white/15"}`,children:[u.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[u.jsx("span",{className:"h-2.5 w-2.5 rounded-full",style:{backgroundColor:B.color||Dt.workflow.defaultGroupDot}}),u.jsx("span",{className:"text-sm font-medium text-gray-800 dark:text-gray-100 truncate",children:B.label})]}),u.jsx("button",{type:"button",role:"switch","aria-checked":B.isEngaged,onClick:de(B),className:`relative inline-flex h-6 w-11 items-center rounded-full transition ${B.isEngaged?"bg-emerald-500":"bg-gray-300"} ${B.isDisabled?"cursor-not-allowed":"cursor-pointer"}`,children:u.jsx("span",{className:`inline-block h-5 w-5 transform rounded-full bg-white transition ${B.isEngaged?"translate-x-5":"translate-x-1"}`})})]},B.key))})]}),_&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"text-xs text-gray-500 mb-1.5 uppercase tracking-wide",children:"Parameters"}),s&&a&&l&&(()=>{const B=y("seed");if(B===null)return null;const ne=w[B],W=B+1,P=w[W],z=["fixed","increment","decrement","randomize"],ee=!!n.inputs.find(pe=>pe.name==="noise_seed")?.link;return u.jsxs("div",{className:"mb-3",children:[u.jsx(Bo,{name:"seed",type:"INT",value:ne,onChange:pe=>p(B,pe,"seed"),disabled:o,hasError:h.has("seed")}),W<w.length&&!ee&&u.jsx(Bo,{name:"Control mode",type:"COMBO",value:P,options:z,onChange:Ne(W)})]})})(),!s&&a&&l&&(()=>{const B=J;if(B===null)return null;const ne=["fixed","randomize","increment","decrement"],W=typeof re=="string"&&!ne.includes(re)?[...ne,re]:ne;if(n.inputs.find(qe=>qe.name==="seed"||qe.name==="noise_seed")?.link!=null)return null;if(te){const qe=B+1;return u.jsx("div",{className:"mb-3",children:u.jsx(Bo,{name:"Seed control",type:"COMBO",value:re,options:W,onChange:Ne(qe)})})}const $=c.find(qe=>qe.name==="seed"||qe.name==="noise_seed")?.options??{},ee=typeof $.min=="number"?$.min:void 0,pe=typeof $.max=="number"?$.max:void 0,ae=typeof $.step=="number"?$.step:void 0,ke=Number(w[B]??0),U=$b(ke),ce=D??U??"fixed",He=Lp(ke)?typeof I=="number"?I:0:ke,Ve=h.has("seed")||h.has("noise_seed");return u.jsxs("div",{className:"mb-3",children:[u.jsx(la,{name:"seed",value:He,onChange:M(B),disabled:o,min:ee,max:pe,step:ae,hasError:Ve}),u.jsx(Bo,{name:"Seed control",type:"COMBO",value:ce,options:ne,onChange:Me}),u.jsxs("div",{className:"grid gap-2 mt-2",children:[u.jsx("button",{type:"button",className:"w-full py-2 px-3 border border-gray-200 rounded-lg text-sm font-medium text-gray-600 hover:text-blue-600 hover:border-blue-500 transition",onClick:()=>v(n.id,"randomize"),disabled:o,children:"Randomize each time"}),u.jsx("button",{type:"button",className:"w-full py-2 px-3 border border-gray-200 rounded-lg text-sm font-medium text-gray-600 hover:text-blue-600 hover:border-blue-500 transition",onClick:L(B),disabled:o,children:"New fixed random"}),u.jsx("button",{type:"button",className:"w-full py-2 px-3 border border-gray-200 rounded-lg text-sm font-medium text-gray-600 hover:text-blue-600 hover:border-blue-500 transition",onClick:K(B),disabled:o||typeof I!="number",children:"Use last queued seed"})]})]})})(),Te.map(B=>u.jsx("div",{className:o?"opacity-80":"",children:u.jsx(Bo,{name:B.name,type:B.type,value:B.value,options:B.options,onChange:T(B),disabled:o,isPinned:ie(B.type,B.name)?C(B.widgetIndex):!1,onTogglePin:ie(B.type,B.name)?()=>N(B.widgetIndex,B.name,B.type,B.options):void 0,hasError:h.has(B.name)})},ge(B,"input-widget"))),F.map(B=>u.jsx("div",{className:o?"opacity-80":"",children:u.jsx(Bo,{name:B.name,type:B.type,value:B.value,options:B.options,onChange:G(B),disabled:o,isPinned:ie(B.type,B.name)?C(B.widgetIndex):!1,onTogglePin:ie(B.type,B.name)?()=>N(B.widgetIndex,B.name,B.type,B.options):void 0,hasError:h.has(B.name)})},ge(B,"widget"))),n.type==="PrimitiveNode"&&(()=>{const B=n.outputs?.[0]?.type,ne=String(B).toUpperCase();if(ne!=="INT"&&ne!=="FLOAT"||w.length<2)return null;const W=w[1],P=["fixed","increment","decrement","randomize"];return u.jsx("div",{className:"mb-3",children:u.jsx(Bo,{name:"Control mode",type:"COMBO",value:W,options:P,onChange:z=>p(1,z),disabled:o})})})()]})]})}function L4(n,o,s){if(!o)return null;const a=$n(n,o,s,"image")??$n(n,o,s,"filename")??$n(n,o,s,"file");if(a==null||!Array.isArray(s.widgets_values))return null;const l=s.widgets_values[a];return _4(l)}function _4(n){if(typeof n=="string"&&n.trim()){const{filename:h,subfolder:p}=bb(n.trim());return{filename:h,subfolder:p,type:"input"}}if(!n||typeof n!="object")return null;const o=n,s=typeof o.filename=="string"?o.filename:typeof o.name=="string"?o.name:null;if(!s||!s.trim())return null;const a=typeof o.subfolder=="string"?o.subfolder:"",l=typeof o.type=="string"?o.type:"input",{filename:c,subfolder:d}=bb(s.trim());return{filename:c,subfolder:a||d,type:l}}function bb(n){const o=n.replace(/^\/+/,""),s=o.split("/").filter(Boolean);return s.length<=1?{filename:o,subfolder:""}:{filename:s.pop()??o,subfolder:s.join("/")}}const A4=[],R4=b.memo(function({node:o,isExecuting:s,isConnectionHighlighted:a=!1,errorBadgeLabel:l,onImageClick:c,inGroup:d=!1,onMoveNode:h}){const p=fe(ue=>ue.nodeTypes),m=fe(ue=>ue.workflow),y=fe(ue=>ue.updateNodeWidget),x=fe(ue=>ue.updateNodeWidgets),v=fe(ue=>ue.updateNodeTitle),C=fe(ue=>ue.toggleBypass),N=fe(ue=>ue.setItemCollapsed),w=fe(ue=>ue.setItemHidden),j=fe(ue=>ue.collapsedItems),k=o.stableKey??null,O=fe(ue=>ue.setConnectionHighlightMode),R=fe(ue=>ue.connectionHighlightModes[o.id]??"off"),D=Gn(ue=>ue.setSeedMode),I=fe(ue=>ue.currentWorkflowKey),H=go(ue=>ue.pinnedWidget?.nodeId===o.id?ue.pinnedWidget:null),A=go(ue=>ue.setPinnedWidget),V=Pn(ue=>ue.bookmarkedItems),J=Pn(ue=>ue.toggleBookmark),X=fe(ue=>ue.nodeOutputs[String(o.id)]),re=fe(ue=>ue.nodeTextOutputs[String(o.id)]??null),te=pn(ue=>ue.nodeErrors[String(o.id)]),me=fe(ue=>ue.progress),Te=fe(ue=>ue.executingPromptId),F=fe(ue=>ue.workflowDurationStats),_=fe(ue=>ue.isExecuting),q=Ht(ue=>ue.running),de=Te||(q[0]?.prompt_id??null),Me=Hl({workflow:m,runKey:de,isRunning:_||q.length>0,workflowDurationStats:F}),Ne=Me===100?100:me,M=b.useCallback((ue,vt)=>{k&&D(ue,vt,{workflow:m,nodeTypes:p,updateNodeWidgets:(dt,Kt)=>x(k,Kt)})},[k,p,D,x,m]),L=b.useCallback(ue=>{A(ue,I)},[I,A]),K=X??A4,[je,We]=b.useState(null),{errorPopoverOpen:Re,setErrorPopoverOpen:Se,resetErrorPopover:Ee}=bN(),xe=b.useRef(null),[se,Z]=b.useState(!1),[T,ie]=b.useState(!1),[G,ge]=b.useState(""),B=b.useRef(null),ne=b.useRef(0),W=b.useRef(null),[P,z]=b.useState(null),[$,ee]=b.useState(!1),pe=fe(ue=>ue.deleteNode);b.useEffect(()=>{const ue=vt=>{const dt=vt.detail;if(dt.nodeId===o.id){z(dt.label);const Kt=setTimeout(()=>z(null),1e3);return()=>clearTimeout(Kt)}};return window.addEventListener("node-show-label",ue),()=>window.removeEventListener("node-show-label",ue)},[o.id]);const ae=te&&te.length>0,ke=b.useMemo(()=>te?new Set(te.map(ue=>ue.inputName).filter(ue=>!!ue)):new Set,[te]),U=K.length>0?K[K.length-1]:null,ce=U?`${U.filename}|${U.subfolder}|${U.type}`:null,He=je?`${je.filename}|${je.subfolder}|${je.type}`:null;b.useEffect(()=>{if(!U||ce===He)return;const ue=mo(U.filename,U.subfolder,U.type),vt=new Image;vt.onload=()=>We(U),vt.src=ue},[ce,He,U]);const Ve=p?.[o.type],qe=b.useMemo(()=>{const ue=o.title;return typeof ue=="string"&&ue.trim()?ue.trim():null},[o]),ot=qe||Ve?.display_name||o.type,Ge=o.type==="KSampler",Xe=yr(o.type),Ie=o.mode===4,_e=k?!!j[k]:!1,Ze=/LoadImage/i.test(o.type),pt=b.useMemo(()=>!Ze||!m||!p?null:L4(m,p,o),[Ze,o,p,m])??je,Lt=b.useMemo(()=>{const ue=_p(p,o);return Ge?ue.filter(vt=>vt.name!=="seed"):ue},[p,o,Ge]),_t=b.useMemo(()=>Ap(p,o),[p,o]),Vt=b.useMemo(()=>_t.filter(ue=>!ue.connected),[_t]),Pe=b.useMemo(()=>Lt.filter(ue=>!ue.connected),[Lt]),Fe=b.useMemo(()=>{const ue=o.properties,vt=["text","note","description","label","title"];if(ue)for(const Kt of vt){const Bt=ue[Kt];if(typeof Bt=="string"&&Bt.trim())return Bt}if(/note|comment|sticky|label/i.test(o.type)&&Array.isArray(o.widgets_values)){const Kt=o.widgets_values.find(Bt=>typeof Bt=="string"&&Bt.trim());if(typeof Kt=="string"&&Kt.trim())return Kt}return null},[o.properties,o.widgets_values,o.type]),Ke=b.useMemo(()=>{if(!/note|comment|sticky|label/i.test(o.type)||!Array.isArray(o.widgets_values))return null;const vt=o.widgets_values.findIndex(dt=>typeof dt=="string"&&dt.trim());return vt>=0?vt:null},[o.type,o.widgets_values]),Je=ue=>!m||!p?null:$n(m,p,o,ue),mt=()=>!m||!p?null:da(m,p,o),Et=ue=>{Ke!==null&&k&&y(k,Ke,ue)},be=b.useMemo(()=>{if(!Fe)return null;const ue=[],vt=/(https?:\/\/[^\s]+)/g;let dt=0,Kt,Bt=0;for(;(Kt=vt.exec(Fe))!==null;){const[ln]=Kt,bn=Kt.index;bn>dt&&ue.push(Fe.slice(dt,bn)),ue.push(u.jsx("a",{href:ln,target:"_blank",rel:"noreferrer",className:"text-blue-600 underline break-all",children:ln},`note-link-${Bt++}`)),dt=bn+ln.length}return dt<Fe.length&&ue.push(Fe.slice(dt)),ue},[Fe]),ye=()=>{const ue=Date.now();ue-ne.current<300&&Z(!0),ne.current=ue},De=b.useMemo(()=>{const ue=[],vt=(dt,Kt)=>!(dt.startsWith("LM_LORA")||dt.startsWith("TW_")||Xe&&Kt==="text");return Vt.forEach(dt=>{vt(dt.type,dt.name)&&ue.push({widgetIndex:dt.widgetIndex,name:dt.name,type:dt.type,options:dt.options})}),Pe.forEach(dt=>{vt(dt.type,dt.name)&&ue.push({widgetIndex:dt.widgetIndex,name:dt.name,type:dt.type,options:dt.options})}),ue},[Vt,Pe,Xe]),Ye=b.useCallback(ue=>{if(ue.link!=null)return!1;if(ue.widget)return!0;const vt=Ve?.input?.required?.[ue.name]||Ve?.input?.optional?.[ue.name];if(!vt)return!1;const[dt,Kt]=vt;if(Array.isArray(dt))return!0;const Bt=String(dt).toUpperCase(),ln=Object.prototype.hasOwnProperty.call(Kt??{},"default");return["INT","FLOAT","BOOLEAN","STRING"].includes(Bt)||Bt.includes("AUTOCOMPLETE_TEXT_LORAS")||Bt.includes("AUTOCOMPLETE_TEXT_PROMPT")||ln},[Ve]),et=b.useMemo(()=>o.inputs.filter(ue=>!(Ye(ue)||String(ue.type).toUpperCase()==="OPT_CONNECTION"&&ue.link==null)),[o.inputs,Ye]),rt=b.useMemo(()=>o.outputs.filter(ue=>!((ue.name||"").toLowerCase().replace(/[_\s]/g,"")==="showhelp"||String(ue.type).toUpperCase()==="OPT_CONNECTION"&&!ue.links?.length)),[o.outputs]),Be=o.outputs.some(ue=>String(ue.type).toUpperCase()==="IMAGE"),ct=!!(Ve?.output_node||/PreviewImage|SaveImage|SaveAnimatedPNG|SaveAnimatedWEBP|SaveVideo/i.test(o.type)),St=ue=>H?.widgetIndex===ue,bt=(ue,vt,dt,Kt)=>{St(ue)?L(null):L({nodeId:o.id,widgetIndex:ue,widgetName:vt,widgetType:dt,options:Kt})},lt=De.length===1?De[0]:null,ht=lt?St(lt.widgetIndex):!1,Ct=!!H,Nt=k?V.includes(k):!1,At=V.length<5||Nt,tn=(Be||ct)&&!!pt,kn=typeof re=="string"&&re.length>0,nn=o.inputs?.filter(ue=>ue.link!=null).length??0,Q=o.outputs?.reduce((ue,vt)=>ue+(vt.links?.length??0),0)??0,Ae=nn>0||Q>0,le=Math.min(3,nn),st=Math.min(3,Q),nt=pt?(()=>{const{filename:ue,subfolder:vt,type:dt}=pt,Kt=mo(ue,vt,dt),Bt=vt?`${vt}/${ue}`:ue,ln=Vl(ue);return[{src:Kt,alt:ot,filename:ue,mediaType:ln,file:{id:`${dt}/${Bt}`,name:ue,type:ln==="video"?"video":"image",fullUrl:Kt}}]})():[];b.useEffect(()=>{if(!T)return;const ue=B.current;ue&&(ue.focus(),ue.select())},[T]);const tt=()=>{ge(ot),ie(!0)},Qe=()=>{const ue=G.trim();k&&(v(k,ue.length>0?ue:null),ie(!1))},Mt=b.useCallback((ue,vt,dt)=>{k&&y(k,ue,vt,dt)},[k,y]),gt=b.useCallback(ue=>{k&&x(k,ue)},[k,x]),xt=!!(P&&!/^error\b/i.test(P));return u.jsxs("div",{id:`node-card-wrapper-${o.id}`,className:"relative node-card-outer",children:[u.jsx("div",{id:`node-anchor-${o.id}`,className:"absolute -top-3 left-0 right-0 h-0 node-scroll-anchor"}),xt&&u.jsx(TN,{label:P??""}),l&&u.jsx("div",{className:"absolute top-2 right-2 z-[110] animate-in fade-in duration-150",children:u.jsx("div",{className:"bg-red-600 text-white text-[10px] font-black px-2 py-0.5 rounded-full shadow-lg whitespace-nowrap uppercase tracking-tighter ring-2 ring-white",children:l})}),u.jsxs("div",{id:`node-card-${o.id}`,className:`
        node-card-inner
        ${d?"rounded-lg shadow-sm py-1":"rounded-xl shadow-md px-2 py-1 mb-3"}
        border-2
        ${ae?"border-red-700 shadow-red-200":a?"border-orange-500 shadow-orange-200":s?"border-green-500 shadow-green-200":Ie?"border-purple-300":"border-transparent"}
        ${Ie?_e?"bg-purple-200":"bg-purple-100/50":"bg-white"}
      `,style:{overflow:"visible"},children:[u.jsx(MN,{nodeId:o.id,displayName:ot,isEditingLabel:T,labelValue:G,labelInputRef:B,onLabelChange:ge,onLabelBlur:Qe,isCollapsed:_e,isBypassed:Ie,isExecuting:s,overallProgress:Me,hasErrors:ae,errorIconRef:W,errorPopoverOpen:Re,setErrorPopoverOpen:Se,toggleNodeFold:()=>{k&&N(k,!_e)},rightSlot:u.jsx(NN,{nodeId:o.id,nodeStableKey:k,isLoraManagerNode:Xe,isBypassed:Ie,onEditLabel:tt,pinnableWidgets:De,singlePinnableWidget:lt,isSingleWidgetPinned:ht,hasPinnedWidget:Ct,toggleWidgetPin:bt,setPinnedWidget:L,isNodeBookmarked:Nt,canAddNodeBookmark:At,onToggleNodeBookmark:()=>k?J(k):void 0,toggleBypass:C,setItemHidden:w,onDeleteNode:()=>ee(!0),onMoveNode:h??(()=>{}),connectionHighlightMode:R,setConnectionHighlightMode:O,leftLineCount:le,rightLineCount:st})}),u.jsx("div",{className:`grid transition-[grid-template-rows] duration-200 ease-out ${_e?"grid-rows-[0fr]":"grid-rows-[1fr]"}`,children:u.jsxs("div",{className:`collapse-container overflow-hidden transition-opacity px-1 duration-200 ease-out ${_e?"opacity-0":"opacity-100"}`,children:[qe&&u.jsx("div",{className:"node-card-subtitle text-[10px] text-center font-semibold uppercase tracking-wider text-gray-400 mb-2 px-1",children:Ve?.display_name||o.type}),u.jsxs("div",{id:`node-content-${o.id}`,className:`node-expanded-content ${Ie?"opacity-60 grayscale":""}`,children:[u.jsx(DN,{nodeId:o.id,nodeType:o.type,inputs:et,outputs:rt,allInputs:o.inputs,allOutputs:o.outputs}),u.jsx(I4,{node:o,isBypassed:Ie,isKSampler:Ge,workflowExists:!!m,nodeTypesExists:!!p,visibleInputWidgets:Vt,visibleWidgets:Pe,errorInputNames:ke,onUpdateNodeWidget:Mt,onUpdateNodeWidgets:gt,getWidgetIndexForInput:Je,findSeedWidgetIndex:mt,setSeedMode:M,isWidgetPinned:St,toggleWidgetPin:bt}),Fe&&u.jsx(kN,{noteText:Fe,noteLinkified:be,noteWidgetIndex:Ke,isEditingNote:se,setIsEditingNote:Z,onUpdateNote:Et,noteTextareaRef:xe,onNoteTap:ye}),u.jsx(jN,{show:tn||kn,previewImage:pt,previewText:kn?re:null,displayName:ot,onImageClick:()=>c?.(nt,0),isExecuting:!!s,overallProgress:Me,displayNodeProgress:Ne})]})]})})]}),u.jsx(CN,{nodeId:o.id,open:Re&&ae,errors:te??[],anchorRef:W,onClose:Ee}),$&&u.jsx(ON,{nodeId:o.id,displayName:ot,hasConnections:Ae,onCancel:()=>ee(!1),onDelete:ue=>{k&&pe(k,ue),ee(!1)}})]})});function D4({onClick:n}){return u.jsxs("button",{type:"button",onClick:n,className:"w-full mb-3 py-4 rounded-xl border-2 border-dashed border-gray-300 flex items-center justify-center gap-2 text-sm font-medium text-gray-400 hover:border-gray-400 hover:text-gray-500 active:bg-gray-50 transition-colors",children:[u.jsx(Eo,{className:"w-4 h-4"}),"Add node"]})}function xb({id:n,headerId:o,title:s,nodeCount:a,backgroundColor:l,borderColor:c,textClassName:d,className:h=""}){const p=()=>{document.getElementById(o)?.scrollIntoView({behavior:"smooth",block:"start"})};return u.jsx("div",{id:n,className:`px-3 py-1.5 -mx-1 rounded-b-xl cursor-pointer ${h}`,onClick:p,style:{backgroundColor:l,borderColor:c},children:u.jsxs("div",{className:"flex items-center justify-between gap-3",children:[u.jsx("span",{className:`text-xs select-none ${d}`,children:s}),typeof a=="number"&&u.jsxs("span",{className:`text-xs select-none ${d}`,children:[a," node",a!==1?"s":""]})]})})}function vb({containerType:n,containerId:o,title:s,nodeCount:a,isCollapsed:l,hiddenNodeCount:c,isBookmarked:d,canShowBookmarkAction:h,foldAllLabel:p,backgroundColor:m,borderColor:y,onToggleCollapse:x,onToggleFoldAll:v,onToggleBookmark:C,onBypassAll:N,onHide:w,onAddNode:j,onDelete:k,onShowHiddenNodes:O,onMove:R,onCommitTitle:D}){const[I,H]=b.useState(!1),[A,V]=b.useState(!1),[J,X]=b.useState(""),re=b.useRef(null),te=b.useRef(null),me=b.useRef(null),{menuStyle:Te,resetMenuPosition:F}=Kp({open:I,buttonRef:me,menuRef:te}),_=s.trim()||`${n} ${o}`,q=c>0,de=d||h,Me=n==="subgraph"?"text-blue-600":"text-gray-500",Ne=()=>{H(!1),F()};ya({open:I,onDismiss:()=>{H(!1),F()},triggerRef:me,contentRef:te,ignoreScrollWithinContent:!0}),b.useEffect(()=>{if(!A)return;const L=re.current;L&&(L.focus(),L.select())},[A]);const M=()=>{A||x()};return u.jsxs("div",{id:`${n}-header-${o}`,className:`flex items-center justify-between cursor-pointer gap-3 px-3 py-2 ${l?"rounded-xl":"rounded-t-xl mb-2"}`,style:{backgroundColor:m,borderColor:y},onClick:M,children:[u.jsxs("div",{className:"flex items-center gap-1 min-w-0 flex-1",children:[u.jsx("button",{onClick:L=>{L.stopPropagation(),x()},className:"w-8 h-8 -ml-2 flex items-center justify-center text-gray-500 hover:text-gray-700 shrink-0",children:l?u.jsx(ws,{className:"w-6 h-6"}):u.jsx(no,{className:"w-6 h-6"})}),A?u.jsx("input",{ref:re,value:J,onChange:L=>X(L.target.value),onBlur:()=>{D(J),V(!1)},onKeyDown:L=>{(L.key==="Enter"||L.key==="Escape")&&L.currentTarget.blur()},onClick:L=>L.stopPropagation(),className:"font-semibold text-gray-900 flex-1 min-w-0 text-sm bg-white border border-gray-200 rounded px-2 py-1"}):u.jsx("h3",{className:"font-semibold text-gray-900 select-none flex-1 min-w-0 whitespace-nowrap overflow-hidden text-ellipsis",children:_}),u.jsxs("span",{className:`text-sm shrink-0 ${Me}`,children:[a," node",a!==1?"s":""]})]}),u.jsx(Qr,{onClick:L=>{L.stopPropagation(),F(),H(K=>!K)},ariaLabel:`${n} options`,buttonRef:me,buttonSize:8,iconSize:5,icon:d?u.jsx(Yr,{className:"w-5 h-5 text-blue-500"}):n==="subgraph"?u.jsx(Cs,{className:"w-5 h-5 -scale-x-100 text-blue-500"}):void 0}),I&&_n.createPortal(u.jsx("div",{ref:te,className:"fixed z-[1000] w-44",style:Te,children:u.jsx(xr,{items:[{key:"edit-label",label:"Edit label",icon:u.jsx(Bp,{className:"w-4 h-4"}),onClick:L=>{L.stopPropagation(),X(_),V(!0),Ne()}},{key:"add-node",label:"Add node",icon:u.jsx(Eo,{className:"w-4 h-4"}),onClick:L=>{L.stopPropagation(),j(),Ne()}},{key:"fold-all",label:p,icon:p==="Fold all"?u.jsx(ws,{className:"w-4 h-4"}):u.jsx(no,{className:"w-4 h-4"}),onClick:L=>{L.stopPropagation(),v(),Ne()}},{key:"bypass-all",label:"Bypass all nodes",icon:u.jsx(op,{isBypassed:!0,className:"w-4 h-4"}),onClick:L=>{L.stopPropagation(),N(!0),Ne()}},{key:"unbypass-all",label:"Un-bypass all nodes",icon:u.jsx(op,{isBypassed:!1,className:"w-4 h-4"}),onClick:L=>{L.stopPropagation(),N(!1),Ne()}},{key:"toggle-bookmark",label:d?"Remove bookmark":"Bookmark container",icon:d?u.jsx(Yr,{className:"w-4 h-4 text-blue-500"}):u.jsx(nc,{className:"w-4 h-4"}),onClick:L=>{L.stopPropagation(),C(),Ne()},hidden:!de},{key:"show-hidden-nodes",label:"Show hidden nodes",icon:u.jsx(Po,{className:"w-4 h-4"}),onClick:L=>{L.stopPropagation(),O(),Ne()},hidden:!q},{key:"hide-container",label:`Hide ${n}`,icon:u.jsx(Po,{className:"w-4 h-4"}),onClick:L=>{L.stopPropagation(),w(),Ne()}},{key:"move-container",label:`Move ${n}`,icon:u.jsx(ax,{className:"w-4 h-4"}),onClick:L=>{L.stopPropagation(),R(),Ne()}},{key:"delete-container",label:`Delete ${n}`,icon:u.jsx(Ho,{className:"w-4 h-4"}),color:"danger",onClick:L=>{L.stopPropagation(),k(),Ne()}}]})}),document.body)]})}function wb({containerType:n,containerId:o,hiddenNodeCount:s=0,borderColor:a,dashedBorderColor:l,onClick:c}){const d=n==="group"?"group":"subgraph";return u.jsx("div",{id:`${n}-placeholder-${o}`,className:"flex items-center justify-center px-4 pb-4 pt-2",style:{borderColor:a},children:u.jsxs("button",{type:"button",onClick:c,className:"w-full rounded-lg border-2 border-dashed flex flex-col items-center justify-center py-4 hover:bg-white/40 transition-colors",style:{borderColor:l},children:[u.jsx("span",{className:"text-sm text-gray-400 select-none",children:s>0?`${s} hidden node${s!==1?"s":""} in ${d}`:`No nodes in ${d}`}),u.jsxs("span",{className:"text-xs text-gray-500 select-none mt-1 inline-flex items-center gap-1",children:[u.jsx(Eo,{className:"w-3 h-3"}),"Click to add a node"]})]})})}function B4({isOpen:n,onClose:o,addInGroupId:s=null,addInSubgraphId:a=null,onNodeAdded:l}){const c=fe(C=>C.nodeTypes),d=fe(C=>C.addNode),h=fe(C=>C.scrollToNode),[p,m]=b.useState(""),y=b.useMemo(()=>c?Object.entries(c).map(([C,N],w)=>({index:w,name:C,displayName:ys(N,C),pack:ms(String(N.python_module??N.category?.split("/")[0]??"Core")),category:String(N.category??"Other"),description:String(N.description??"")})):[],[c]),x=b.useMemo(()=>lp(y,p,C=>({displayName:C.displayName,typeName:C.name,category:C.category,pack:C.pack}),C=>C.index),[y,p]),v=C=>{const N=s==null&&a==null?void 0:{...s==null?{}:{inGroupId:s},...a==null?{}:{inSubgraphId:a}},w=d(C,N);if(o(),w!==null){l?.(w);const j=fe.getState().workflow?.nodes.find(k=>k.id===w)?.stableKey??null;j&&h(j)}};return u.jsx(dx,{isOpen:n,onClose:o,title:"Add node",searchQuery:p,onSearchQueryChange:m,searchPlaceholder:"Search node types...",children:u.jsxs("div",{className:"flex-1 overflow-auto bg-white",children:[x.length===0&&u.jsx(gl,{query:p,message:"No matching node types found"}),u.jsx("div",{className:"px-3 pt-3 pb-20 flex flex-col gap-2",children:x.map(C=>u.jsx(ip,{title:C.displayName,subtitle:C.pack||"Core",onSelect:()=>v(C.name)},C.name))})]})})}function z4({containerTypeLabel:n,containerIdLabel:o,displayName:s,nodeCount:a,onCancel:l,onDeleteContainerOnly:c,onDeleteContainerAndNodes:d}){const h=n;return _n.createPortal(u.jsx(Yo,{onClose:l,title:`Delete ${h}`,description:u.jsxs(u.Fragment,{children:[u.jsx("span",{className:"font-medium text-gray-700",children:s})," (",o,") has ",a," node",a===1?"":"s","."]}),actionsLayout:"stack",actions:[{label:`Delete ${h} only`,onClick:c,className:"w-full px-4 py-2.5 text-sm font-medium text-red-700 bg-red-50 rounded-lg hover:bg-red-100 active:bg-red-200"},{label:`Delete ${h} and nodes`,onClick:d,className:"w-full px-4 py-2.5 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700 active:bg-red-800"},{label:"Cancel",onClick:l,className:"w-full px-4 py-2.5 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 active:bg-gray-300"}]}),document.body)}function xu(n){return String(n).split(",").map(o=>o.trim().toUpperCase()).filter(Boolean)}function Sb(n){return n.toLowerCase().replace(/[_-]+/g," ").replace(/\s+/g," ").trim()}function H4(n,o){let s=0;for(const a of o)if(a===n[s]&&(s+=1,s>=n.length))return!0;return n.length===0}function Hf(n,o){if(!n.trim())return!0;const s=Sb(o);return Sb(n).split(" ").filter(Boolean).every(a=>s.includes(a)||H4(a,s))}function V4({visible:n,onImageClick:o}){const s=fe(Q=>Q.workflow),a=fe(Q=>Q.executingNodeId),l=fe(Q=>Q.connectionHighlightModes),c=Pn(Q=>Q.bookmarkBarSide),d=Pn(Q=>Q.bookmarkBarTop),h=Pn(Q=>Q.setBookmarkBarPosition),p=Pn(Q=>Q.setBookmarkRepositioningActive),m=fe(Q=>Q.setItemCollapsed),y=fe(Q=>Q.scrollToNode),x=fe(Q=>Q.revealNodeWithParents),v=fe(Q=>Q.nodeTypes),C=pn(Q=>Q.nodeErrors),N=fe(Q=>Q.searchOpen),w=fe(Q=>Q.searchQuery),j=fe(Q=>Q.setSearchQuery),k=fe(Q=>Q.setSearchOpen),O=fe(Q=>Q.addNodeModalRequest),R=fe(Q=>Q.clearAddNodeModalRequest),D=fe(Q=>Q.collapsedItems),I=fe(Q=>Q.hiddenItems),H=fe(Q=>Q.setItemHidden),A=fe(Q=>Q.bypassAllInContainer),V=fe(Q=>Q.deleteContainer),J=fe(Q=>Q.updateContainerTitle),X=fe(Q=>Q.mobileLayout),re=fe(Q=>Q.stableKeyByPointer),te=Pn(Q=>Q.bookmarkedItems),me=Pn(Q=>Q.toggleBookmark),Te=b.useRef(null),F=b.useRef(null),_=b.useRef(null),q=b.useRef(null),[de,Me]=b.useState(0),[Ne,M]=b.useState(!1),[L,K]=b.useState(!1),[je,We]=b.useState(null),[Re,Se]=b.useState(!1),[Ee,xe]=b.useState(null),[se,Z]=b.useState(null),[T,ie]=b.useState(null),G=nN(),[ge,B]=b.useState({}),ne=b.useRef(new Map),W=b.useRef(null),P=b.useRef(null),z=b.useRef(null),$=b.useRef(null),ee=b.useMemo(()=>new Map((s?.nodes??[]).map(Q=>[Q.id,Q.stableKey??null])),[s]),pe=b.useMemo(()=>new Map((s?.definitions?.subgraphs??[]).map(Q=>[Q.id,Q.stableKey??null])),[s]),ae=()=>{j(""),k(!1)},ke=b.useMemo(()=>{const Q=new Map,Ae=new Set,le=new Set,st=(nt,tt)=>{nt.forEach(Qe=>{if(Qe.type==="node"){const Mt=ee.get(Qe.id)??null;Mt&&Q.set(Mt,{stableKey:Mt,type:"node",nodeId:Qe.id,subgraphId:tt,text:String(Qe.id)});return}if(Qe.type==="group"){const Mt=Qe.stableKey;if(Mt&&Q.set(Mt,{stableKey:Mt,type:"group",groupId:Qe.id,subgraphId:tt,groupKey:Qe.stableKey,text:`G${Qe.id}`}),Ae.has(Qe.stableKey))return;Ae.add(Qe.stableKey),st(X.groups[Qe.stableKey]??[],tt);return}if(Qe.type==="subgraph"){const Mt=pe.get(Qe.id)??null;if(Mt&&Q.set(Mt,{stableKey:Mt,type:"subgraph",subgraphId:Qe.id,text:"SG"}),le.has(Qe.id))return;le.add(Qe.id),st(X.subgraphs[Qe.id]??[],Qe.id)}})};return st(X.root,null),Q},[X,ee,pe]),U=b.useMemo(()=>te.map(Q=>ke.get(Q)).filter(Q=>Q!=null),[ke,te]),ce=b.useCallback(Q=>{const Ae=Gb(X,({ref:le})=>le.type==="node"?(ee.get(le.id)??null)===Q:le.type==="group"?le.stableKey===Q:le.type==="subgraph"?(pe.get(le.id)??null)===Q:!1);return Ae?{groupKeys:Ae.groupKeys,subgraphIds:Ae.subgraphIds}:null},[X,ee,pe]),He=b.useCallback((Q,Ae,le)=>{x(Q),y(Q,le),window.dispatchEvent(new CustomEvent("workflow-scroll-to-node",{detail:{nodeId:Ae,label:le}}))},[x,y]),Ve=b.useCallback((Q,Ae,le,st)=>{const nt=ce(Q);if(nt){for(const gt of nt.subgraphIds){const xt=pe.get(gt)??null;xt&&(H(xt,!1),m(xt,!1))}for(const gt of nt.groupKeys){const xt=re[gt];xt&&(H(xt,!1),m(xt,!1))}}if(st){const gt=pe.get(st)??null;gt&&(H(gt,!1),m(gt,!1))}H(Q,!1),m(Q,!1);const Qe=`[data-group-id="${le}"][data-subgraph-id="${st??"root"}"]`,Mt=`[data-reposition-item="group-${Ae}"]`;requestAnimationFrame(()=>{requestAnimationFrame(()=>{const gt=document.querySelector(Qe),xt=document.querySelector(Mt);(gt??xt)?.scrollIntoView({behavior:"smooth",block:"start"})})})},[ce,m,H,re,pe]),qe=b.useCallback((Q,Ae)=>{const le=ce(Q);if(le){for(const tt of le.subgraphIds){const Qe=pe.get(tt)??null;Qe&&(H(Qe,!1),m(Qe,!1))}for(const tt of le.groupKeys){const Qe=re[tt];Qe&&(H(Qe,!1),m(Qe,!1))}}H(Q,!1),m(Q,!1);const st=`[data-subgraph-header-id="${Ae}"]`,nt=`[data-reposition-item="subgraph-${Ae}"]`;requestAnimationFrame(()=>{requestAnimationFrame(()=>{const tt=document.querySelector(st),Qe=document.querySelector(nt);(tt??Qe)?.scrollIntoView({behavior:"smooth",block:"start"})})})},[ce,m,H,re,pe]),ot=b.useCallback((Q,Ae)=>()=>{if(Ne){M(!1),K(!1),We(null);return}Me(Ae),Q.type==="node"?He(Q.stableKey,Q.nodeId):Q.type==="group"?Ve(Q.stableKey,Q.groupKey,Q.groupId,Q.subgraphId):qe(Q.stableKey,Q.subgraphId)},[Ne,Ve,He,qe]),Ge=b.useCallback(()=>{if(Ne){M(!1),K(!1),We(null);return}const Q=(de+1)%U.length;Me(Q);const Ae=U[Q];Ae&&(Ae.type==="node"?He(Ae.stableKey,Ae.nodeId):Ae.type==="group"?Ve(Ae.stableKey,Ae.groupKey,Ae.groupId,Ae.subgraphId):qe(Ae.stableKey,Ae.subgraphId))},[U,de,Ne,Ve,He,qe]),Xe=b.useCallback(()=>{W.current!=null&&(window.clearTimeout(W.current),W.current=null)},[]),Ie=b.useCallback(()=>{const Q=getComputedStyle(document.documentElement).getPropertyValue("--bottom-bar-offset"),Ae=Number.parseFloat(Q);return Number.isFinite(Ae)?Ae:0},[]),_e=b.useCallback(()=>{const Q=Te.current,Ae=F.current;if(!Q||!Ae)return null;const le=Q.getBoundingClientRect().height,st=Ae.getBoundingClientRect().height,nt=16,tt=Ie()+8,Qe=Math.max(nt,le-st-tt);return{minTop:nt,maxTop:Qe}},[Ie]),Ze=b.useCallback(Q=>{const Ae=_e();return Ae?Math.min(Math.max(Q,Ae.minTop),Ae.maxTop):Q},[_e]),wt=b.useCallback((Q,Ae)=>{const le=Te.current,st=z.current;if(!le||!st)return;const nt=le.getBoundingClientRect(),tt=Q-nt.left-st.x,Qe=Ze(Ae-nt.top-st.y);We({x:tt,y:Qe})},[Ze]),pt=b.useCallback((Q,Ae)=>{const le=Te.current,st=F.current;if(!le||!st)return;const nt=st.getBoundingClientRect(),tt=le.getBoundingClientRect();z.current={x:Q-nt.left,y:Ae-nt.top};const Qe=nt.left-tt.left,Mt=Ze(nt.top-tt.top);We({x:Qe,y:Mt}),K(!0)},[Ze]),Lt=b.useCallback(Q=>{Q.pointerType==="mouse"&&Q.button!==0||Q.target.closest("button")&&!Ne||(Q.preventDefault(),P.current={startX:Q.clientX,startY:Q.clientY,startTime:Date.now(),pointerId:Q.pointerId},Ne?pt(Q.clientX,Q.clientY):W.current=window.setTimeout(()=>{M(!0),pt(Q.clientX,Q.clientY)},500),Q.currentTarget.setPointerCapture(Q.pointerId))},[Ne,pt]),_t=b.useCallback(Q=>{if(L){wt(Q.clientX,Q.clientY);return}const Ae=P.current;if(!Ae)return;const le=Q.clientX-Ae.startX,st=Q.clientY-Ae.startY;Math.hypot(le,st)>8&&Xe()},[Xe,L,wt]),Vt=b.useCallback(()=>{const Q=Te.current,Ae=F.current;if(!Q||!Ae||!je)return;const le=Q.getBoundingClientRect(),st=Ae.getBoundingClientRect().width,tt=je.x+st/2<le.width/2?"left":"right",Qe=Ze(je.y);h({side:tt,top:Qe}),We(null)},[je,Ze,h]),Pe=b.useCallback(Q=>{Xe();const Ae=P.current;if(P.current=null,L){Vt(),K(!1);return}if(Ne||!Ae)return;const le=Q.clientX-Ae.startX,st=Q.clientY-Ae.startY,nt=Date.now()-Ae.startTime;Math.abs(le)>40&&Math.abs(le)>Math.abs(st)&&nt<500&&h({side:c==="left"?"right":"left"})},[c,Xe,Vt,L,Ne,h]),Fe=b.useCallback(()=>{Xe(),P.current=null,K(!1),We(null)},[Xe]),Ke=b.useMemo(()=>{if(!s)return[];const Q=Fb(X),Ae=new Map(s.nodes.map(nt=>[nt.id,nt])),le=[];for(const nt of Q){const tt=Ae.get(nt);tt&&le.push(tt)}const st=new Set(Q);for(const nt of s.nodes)st.has(nt.id)||le.push(nt);return Object.keys(I).length===0?le:le.filter(nt=>{const tt=nt.stableKey??null;return tt?!I[tt]:!0})},[s,I,X]),Je=w.trim(),mt=N&&Je.length>0,Et=b.useMemo(()=>{if(!mt||!s)return new Set;const Q=[...s.groups??[],...(s.definitions?.subgraphs??[]).flatMap(le=>le.groups??[])],Ae=new Set;for(const le of Q)Hf(Je,le.title)&&Ae.add(le.id);return Ae},[s,mt,Je]),be=b.useMemo(()=>{if(!mt||!s)return new Set;const Q=s.definitions?.subgraphs??[],Ae=new Set;for(const le of Q){const st=le.name||le.id;Hf(Je,`${st} ${le.id}`)&&Ae.add(le.id)}return Ae},[s,mt,Je]),ye=b.useMemo(()=>mt?Ke.filter(Q=>{const Ae=v?.[Q.type],le=Q.title,st=[typeof le=="string"?le:"",Ae?.display_name??"",Q.type,String(Q.id)];return Hf(Je,st.join(" "))}):Ke,[Ke,mt,Je,v]),De=b.useMemo(()=>new Set(ye.map(Q=>Q.id)),[ye]),Ye=b.useMemo(()=>s?oN(X,s,D,I,re):[],[X,s,D,I,re]),et=b.useMemo(()=>{if(!s)return[];if(mt){const Q=le=>{let st=0;for(const nt of le)nt.type==="hiddenBlock"?st+=nt.count:nt.type==="node"?st+=1:st+=Q(nt.children);return st},Ae=(le,st=!1)=>{const nt=[];for(const tt of le){if(tt.type==="hiddenBlock")continue;if(tt.type==="node"){(st||De.has(tt.node.id))&&nt.push(tt);continue}if(st){const gt=Ae(tt.children,!0);nt.push({...tt,isCollapsed:!1,nodeCount:Q(gt),children:gt});continue}if(tt.type==="group"){const gt=Et.has(tt.group.id),xt=Ae(tt.children,gt);(gt||xt.length>0)&&nt.push({...tt,isCollapsed:!1,nodeCount:Q(xt),children:xt});continue}const Qe=be.has(tt.subgraph.id),Mt=Ae(tt.children,!1);(Qe||Mt.length>0)&&nt.push({...tt,isCollapsed:!1,nodeCount:Q(Mt),children:Mt})}return nt};return Ae(Ye)}return Ye},[Ye,De,Et,be,mt,s]),rt=b.useMemo(()=>{const Q=new Map;let Ae=0;for(const le of Ke){const st=C[String(le.id)];st&&st.length>0&&(Ae+=1,Q.set(le.id,Ae))}return Q},[Ke,C]),Be=b.useMemo(()=>{if(!s)return new Set;const Q=Object.entries(l).filter(([,Qe])=>Qe!=="off").map(([Qe,Mt])=>({id:Number(Qe),mode:Mt}));if(Q.length===0)return new Set;const Ae=new Map(s.nodes.map(Qe=>[Qe.id,Qe])),le=new Set,st=Qe=>!!(Qe.stableKey&&I[Qe.stableKey]),nt=(Qe,Mt,gt)=>{if(Mt.has(Qe))return[];Mt.add(Qe);const xt=Ae.get(Qe);if(!xt)return[];const ue=[];return xt.outputs?.forEach((vt,dt)=>{const Kt=xu(vt.type);if(gt.size>0&&!Kt.some(ln=>gt.has(ln)))return;wl(s,Qe,dt).forEach(ln=>{const bn=ln.node;st(bn)?ue.push(...nt(bn.id,Mt,gt)):ue.push(bn)})}),ue},tt=(Qe,Mt,gt)=>{if(Mt.has(Qe))return[];Mt.add(Qe);const xt=Ae.get(Qe);if(!xt)return[];const ue=[];return xt.inputs?.forEach((vt,dt)=>{if(vt.link===null)return;const Kt=xu(vt.type);if(gt.size>0&&!Kt.some(ln=>gt.has(ln)))return;const Bt=ha(s,Qe,dt);Bt&&(st(Bt.node)?ue.push(...tt(Bt.node.id,Mt,gt)):ue.push(Bt.node))}),ue};return Q.forEach(({id:Qe,mode:Mt})=>{const gt=Ae.get(Qe);gt&&((Mt==="inputs"||Mt==="both")&&gt.inputs?.forEach((xt,ue)=>{if(xt.link===null)return;const vt=ha(s,gt.id,ue);if(!vt)return;if(!st(vt.node)){le.add(vt.node.id);return}const dt=new Set(xu(xt.type));tt(vt.node.id,new Set,dt).forEach(Bt=>le.add(Bt.id))}),(Mt==="outputs"||Mt==="both")&&gt.outputs?.forEach((xt,ue)=>{const vt=new Set(xu(xt.type));wl(s,gt.id,ue).forEach(Kt=>{const Bt=Kt.node;if(!st(Bt)){le.add(Bt.id);return}nt(Bt.id,new Set,vt).forEach(bn=>le.add(bn.id))})}))}),le},[s,l,I]);b.useEffect(()=>{const Q=Ae=>{const le=Ae.detail,st=typeof le=="number"?le:le.nodeId,nt=typeof le=="object"?le.label:void 0;if(typeof st!="number"||!ye.some(ue=>ue.id===st))return;const Qe=rt.get(st),Mt=nt??(Qe?`Error #${Qe}`:"Error");B(ue=>({...ue,[st]:Mt}));const gt=ne.current.get(st);gt&&window.clearTimeout(gt);const xt=window.setTimeout(()=>{B(ue=>{const vt={...ue};return delete vt[st],vt}),ne.current.delete(st)},2e3);ne.current.set(st,xt)};return window.addEventListener("workflow-label-error-node",Q),()=>window.removeEventListener("workflow-label-error-node",Q)},[ye,rt]),b.useEffect(()=>{const Q=ne.current;return()=>{Q.forEach(Ae=>window.clearTimeout(Ae)),Q.clear()}},[]),b.useEffect(()=>{const Q=Ae=>{const le=Ae.detail,st=typeof le=="number"?le:le.nodeId,nt=typeof le=="object"?le.label:void 0;if(typeof st!="number")return;const Qe=s?.nodes.find(gt=>gt.id===st)?.stableKey??null;if(!Qe)return;m(Qe,!1);const Mt=(typeof Qe=="string"?document.querySelector(`[data-stable-key="${Qe}"]`):null)??document.querySelector(`[data-reposition-item="node-${st}"]`);Mt&&Mt.scrollIntoView({behavior:"smooth",block:"start"}),requestAnimationFrame(()=>y(Qe,nt))};return window.addEventListener("workflow-scroll-to-node",Q),()=>window.removeEventListener("workflow-scroll-to-node",Q)},[m,y,s]),b.useEffect(()=>{N&&(_.current&&_.current.scrollTo({top:0,behavior:"auto"}),requestAnimationFrame(()=>{q.current?.focus();const Q=Te.current,Ae=F.current,le=q.current?.closest(".node-search-bar");if(!Q||!Ae||!le)return;const st=Q.getBoundingClientRect(),nt=le.getBoundingClientRect(),tt=Ae.getBoundingClientRect(),Qe=nt.bottom-st.top,Mt=tt.top-st.top,gt=8;Mt<Qe+gt&&h({top:Qe+gt})}))},[N,h]),b.useEffect(()=>(p(Ne),()=>p(!1)),[Ne,p]),b.useEffect(()=>{if(!U.length)return;const Q=window.requestAnimationFrame(()=>{const Ae=_e();if(!Ae)return;const{minTop:le,maxTop:st}=Ae;if(d==null)h({top:st});else{const nt=Math.min(Math.max(d,le),st);nt!==d&&h({top:nt})}});return()=>window.cancelAnimationFrame(Q)},[U.length,d,_e,h]),b.useEffect(()=>{if(!Ne)return;const Q=Ae=>{const le=F.current;!le||!Ae.target||le.contains(Ae.target)||(M(!1),K(!1),We(null),Xe())};return document.addEventListener("pointerdown",Q),()=>{document.removeEventListener("pointerdown",Q)}},[Xe,Ne]),b.useEffect(()=>{if(!O||$.current===O.id)return;$.current=O.id;const Q=window.requestAnimationFrame(()=>{xe(O.groupId),Z(O.subgraphId),Se(!0),R()});return()=>window.cancelAnimationFrame(Q)},[O,R]);const ct=Q=>{for(const Ae of Q)if(Ae.type!=="hiddenBlock"){if(Ae.type==="node"){const le=Ae.node.stableKey??null;if(!le||!D[le])return!0;continue}if(!Ae.isCollapsed||ct(Ae.children))return!0}return!1},St=b.useCallback((Q,Ae)=>{const le=st=>{for(const nt of st){if(nt.type==="hiddenBlock")continue;if(nt.type==="node"){const Qe=nt.node.stableKey??null;Qe&&m(Qe,Ae);continue}if(nt.type==="group"){const Qe=nt.stableKey;if(!Qe){le(nt.children);continue}m(Qe,Ae),le(nt.children);continue}const tt=pe.get(nt.subgraph.id)??null;tt&&m(tt,Ae),le(nt.children)}};le(Q)},[m,pe]),bt=b.useCallback(Q=>sp(Q,{layout:X,hiddenItems:I,stableKeyByPointer:re}),[I,X,re]),lt=b.useCallback(Q=>bt(X.groups[Q]??[]),[bt,X]),ht=b.useCallback(Q=>bt(X.subgraphs[Q]??[]),[bt,X]),Ct=b.useCallback(Q=>{for(const Ae of Q.hiddenGroupKeys){const le=re[Ae];le&&H(le,!1)}for(const Ae of Q.hiddenSubgraphIds){const le=pe.get(Ae)??null;le&&H(le,!1)}for(const Ae of Q.hiddenNodeKeys){const le=re[Ae];le&&H(le,!1)}},[H,re,pe]),Nt=(Q,Ae)=>Q.map((le,st)=>{const nt=`${Ae}-${st}`;if(le.type==="hiddenBlock")return null;if(le.type==="group"){const tt=le.group,Qe=Do(tt.color,.15),Mt=Do(tt.color,.4),gt=ct(le.children),xt=le.children.some(jn=>jn.type!=="hiddenBlock"),ue=le.stableKey;if(!ue)return null;const vt=lt(ue),dt=ue?te.includes(ue):!1,Kt=te.length<5||dt,Bt=vt.hiddenNodeCount,ln=gt?"Fold all":"Unfold all",bn=()=>{!gt&&ue&&m(ue,!1),St(le.children,gt)};return u.jsxs("div",{className:"group-wrapper shadow-md rounded-xl border mb-3",style:{backgroundColor:Qe,borderColor:Mt},"data-reposition-item":`group-${ue}`,"data-stable-key":ue,children:[u.jsx(vb,{containerType:"group",containerId:tt.id,title:tt.title?.trim()||`Group ${tt.id}`,nodeCount:le.nodeCount,isCollapsed:le.isCollapsed,backgroundColor:Do(tt.color,.22),borderColor:Do(tt.color,.4),hiddenNodeCount:Bt,isBookmarked:dt,canShowBookmarkAction:Kt,foldAllLabel:ln,onToggleCollapse:()=>ue&&m(ue,!le.isCollapsed),onToggleBookmark:()=>ue?me(ue):void 0,onShowHiddenNodes:()=>{Bt>0&&Ct(vt)},onToggleFoldAll:bn,onBypassAll:jn=>ue&&A(ue,jn),onHide:()=>ue&&H(ue,!0),onAddNode:()=>{xe(le.group.id),Z(le.subgraphId??null),Se(!0)},onDelete:()=>{if(ue){if(le.nodeCount===0){V(ue,{deleteNodes:!1});return}ie({stableKey:ue,containerTypeLabel:"group",containerIdLabel:`#${le.group.id}`,displayName:le.group.title?.trim()||`Group ${le.group.id}`,nodeCount:le.nodeCount})}},onMove:()=>G.openOverlay({type:"group",id:le.group.id,subgraphId:le.subgraphId??null}),onCommitTitle:jn=>ue&&J(ue,jn)}),u.jsx("div",{className:`grid transition-[grid-template-rows] duration-200 ease-out ${le.isCollapsed?"grid-rows-[0fr]":"grid-rows-[1fr]"}`,children:u.jsxs("div",{className:`overflow-hidden px-1 transition-opacity duration-200 ease-out ${le.isCollapsed?"opacity-0":"opacity-100"}`,children:[Bt>0&&le.nodeCount>0&&u.jsxs("div",{className:"px-3 pb-2 -mt-1 text-xs text-gray-400 text-center",children:[Bt," hidden node",Bt===1?"":"s"]}),xt?Nt(le.children,nt):!mt||Et.has(le.group.id)?u.jsx(wb,{containerType:"group",containerId:le.group.id,hiddenNodeCount:Bt,borderColor:Do(le.group.color,.3),dashedBorderColor:Do(le.group.color,.4),onClick:()=>{xe(le.group.id),Z(le.subgraphId??null),Se(!0)}}):null,u.jsx(xb,{id:`group-footer-${le.group.id}`,headerId:`group-header-${le.group.id}`,title:le.group.title,nodeCount:le.nodeCount,backgroundColor:Do(le.group.color,.15),borderColor:Do(le.group.color,.3),textClassName:"text-gray-500 dark:text-gray-400",className:"group-footer"})]})})]},`group-${le.group.id}-${nt}`)}if(le.type==="subgraph"){const tt=Dt.brand.subgraphBackground08,Qe=Dt.brand.subgraphBorder25,Mt=ht(le.subgraph.id),gt=Mt.hiddenNodeCount,xt=pe.get(le.subgraph.id)??null,ue=xt?te.includes(xt):!1,vt=te.length<5||ue,dt=ct(le.children),Kt=dt?"Fold all":"Unfold all",Bt=()=>{!dt&&xt&&m(xt,!1),St(le.children,dt)};return u.jsxs("div",{className:"subgraph-wrapper shadow-md rounded-xl border mb-3",style:{backgroundColor:`var(--subgraph-bg, ${tt})`,borderColor:`var(--subgraph-border, ${Qe})`,"--subgraph-bg":tt,"--subgraph-border":Qe},"data-reposition-item":`subgraph-${le.subgraph.id}`,"data-stable-key":xt??void 0,children:[u.jsx(vb,{containerType:"subgraph",containerId:le.subgraph.id,title:(le.subgraph.name||le.subgraph.id).trim(),nodeCount:le.nodeCount,isCollapsed:le.isCollapsed,backgroundColor:Dt.brand.subgraphBackground14,borderColor:Dt.brand.subgraphBorder25,hiddenNodeCount:gt,isBookmarked:ue,canShowBookmarkAction:vt,foldAllLabel:Kt,onToggleCollapse:()=>xt&&m(xt,!le.isCollapsed),onToggleBookmark:()=>xt?me(xt):void 0,onBypassAll:ln=>xt&&A(xt,ln),onToggleFoldAll:Bt,onShowHiddenNodes:()=>{gt>0&&Ct(Mt)},onHide:()=>xt&&H(xt,!0),onDelete:()=>{if(xt){if(le.nodeCount===0){V(xt,{deleteNodes:!1});return}ie({stableKey:xt,containerTypeLabel:"subgraph",containerIdLabel:le.subgraph.id,displayName:le.subgraph.name?.trim()||le.subgraph.id,nodeCount:le.nodeCount})}},onAddNode:()=>{xe(null),Z(le.subgraph.id),Se(!0)},onMove:()=>G.openOverlay({type:"subgraph",id:le.subgraph.id}),onCommitTitle:ln=>xt&&J(xt,ln)}),u.jsx("div",{className:`grid transition-[grid-template-rows] duration-200 ease-out ${le.isCollapsed?"grid-rows-[0fr]":"grid-rows-[1fr]"}`,children:u.jsxs("div",{className:`overflow-hidden px-1 transition-opacity duration-200 ease-out ${le.isCollapsed?"opacity-0":"opacity-100"}`,children:[gt>0&&le.nodeCount>0&&u.jsxs("div",{className:"px-3 pb-2 -mt-1 text-xs text-gray-400 text-center",children:[gt," hidden node",gt===1?"":"s"]}),le.children.length>0?Nt(le.children,nt):!mt||be.has(le.subgraph.id)?u.jsx(wb,{containerType:"subgraph",containerId:le.subgraph.id,hiddenNodeCount:gt,borderColor:Dt.brand.subgraphBorder20,dashedBorderColor:Dt.brand.subgraphBorder25,onClick:()=>{xe(null),Z(le.subgraph.id),Se(!0)}}):null,u.jsx(xb,{id:`subgraph-footer-${le.subgraph.id}`,headerId:`subgraph-header-${le.subgraph.id}`,title:le.subgraph.name||le.subgraph.id,nodeCount:le.nodeCount,backgroundColor:Dt.brand.subgraphBackground10,borderColor:Dt.brand.subgraphBorder20,textClassName:"text-blue-600 dark:text-blue-500",className:"subgraph-footer"})]})})]},`subgraph-${le.subgraph.id}-${nt}`)}return u.jsx("div",{"data-reposition-item":`node-${le.node.id}`,"data-stable-key":le.node.stableKey??void 0,children:u.jsx(R4,{node:le.node,isExecuting:a===String(le.node.id),isConnectionHighlighted:Be.has(le.node.id),errorBadgeLabel:ge[le.node.id]??null,onImageClick:o,onMoveNode:()=>G.openOverlay({type:"node",id:le.node.id})})},`node-${le.node.id}-${nt}`)});let ut;s?Ke.length===0?ut=u.jsx("div",{id:"node-list-empty",className:"flex items-center justify-center h-full text-gray-500",children:u.jsxs("div",{id:"empty-workflow-content",className:"text-center p-8",children:[u.jsx("div",{id:"empty-workflow-icon-container",className:"flex items-center justify-center mb-4",children:u.jsx(nS,{className:"w-10 h-10 text-gray-300"})}),u.jsx("p",{id:"empty-workflow-title",className:"text-lg font-medium",children:"Empty workflow"}),u.jsx("p",{id:"empty-workflow-description",className:"text-sm mt-2",children:"This workflow has no nodes"}),u.jsx("div",{className:"mt-6 w-64 max-w-full mx-auto",children:u.jsx(D4,{onClick:()=>{xe(null),Z(null),Se(!0)}})})]})}):ut=u.jsxs("div",{id:"node-list-shell",className:"h-full flex flex-col",children:[N&&u.jsx("div",{className:"node-search-bar bg-gray-100 px-4 py-2",children:u.jsx(zl,{inputRef:q,value:w,onChange:j,onClear:ae,placeholder:"Search nodes...",inputClassName:"comfy-input border-gray-300"})}),u.jsx("div",{id:"node-list-container",ref:_,className:"flex-1 overflow-auto px-4 pt-4 overscroll-contain scroll-container",style:{paddingBottom:"10rem"},"data-node-list":"true",children:et.length===0?u.jsx("div",{className:"flex items-center justify-center h-full text-gray-500",children:u.jsxs("div",{className:"text-center p-8",children:[u.jsx("p",{className:"text-sm font-medium",children:"No matching nodes"}),u.jsx("p",{className:"text-xs mt-2",children:"Try a different search."})]})}):u.jsx("div",{id:"node-list-inner",children:Nt(et,"root")})})]}):ut=u.jsx("div",{id:"node-list-no-workflow",className:"flex items-center justify-center h-full text-gray-500",children:u.jsxs("div",{id:"no-workflow-content",className:"text-center p-8",children:[u.jsx("div",{id:"no-workflow-icon-container",className:"flex items-center justify-center mb-4",children:u.jsx(eS,{className:"w-10 h-10 text-gray-300"})}),u.jsx("p",{id:"no-workflow-title",className:"text-lg font-medium",children:"No workflow loaded"}),u.jsx("p",{id:"no-workflow-description",className:"text-sm mt-2",children:"Open the menu to load a workflow"})]})});const At=je?.y??d??0,tn=je?`${je.x}px`:c==="left"?"0.75rem":void 0,kn=je?void 0:c==="right"?"0.75rem":void 0,nn={top:`${At}px`,left:tn,right:kn,opacity:d==null&&je==null?0:1,touchAction:Ne?"none":"pan-y",pointerEvents:d==null&&je==null?"none":"auto"};return u.jsxs("div",{id:"node-list-wrapper",ref:Te,className:"absolute inset-x-0 top-[69px] bottom-0 bg-gray-100",style:{display:n?"block":"none"},children:[ut,u.jsx(B4,{isOpen:Re,addInGroupId:Ee,addInSubgraphId:se,onClose:()=>{Se(!1),xe(null),Z(null)}}),T&&u.jsx(z4,{containerTypeLabel:T.containerTypeLabel,containerIdLabel:T.containerIdLabel,displayName:T.displayName,nodeCount:T.nodeCount,onCancel:()=>ie(null),onDeleteContainerOnly:()=>{V(T.stableKey,{deleteNodes:!1}),ie(null)},onDeleteContainerAndNodes:()=>{V(T.stableKey,{deleteNodes:!0}),ie(null)}}),G.overlayOpen&&G.initialTarget&&u.jsx(yN,{mobileLayout:X,initialTarget:G.initialTarget,initialViewportAnchor:G.initialViewportAnchor,onDone:G.commitAndClose,onCancel:G.cancelOverlay}),U.length>0&&u.jsx("div",{ref:F,className:`absolute z-[200] flex flex-col items-center gap-2 pointer-events-auto ${Ne?"rounded-2xl ring-2 ring-blue-400/70 bg-white/30 shadow-lg":""}`,style:nn,onPointerDown:Lt,onPointerMove:_t,onPointerUp:Pe,onPointerCancel:Fe,children:u.jsxs("div",{className:`flex flex-col items-center gap-2 ${Ne?"p-2 cursor-grab":""}`,children:[U.map((Q,Ae)=>u.jsx("button",{type:"button",className:"w-10 h-10 rounded-full border border-transparent bg-gray-900/10 text-[11px] font-bold text-gray-800 shadow-sm backdrop-blur-sm dark:bg-white/10 dark:text-gray-100 select-none",onClick:ot(Q,Ae),children:Q.text},Q.stableKey)),U.length>1&&u.jsx("button",{type:"button",className:"w-10 h-10 rounded-full border border-transparent bg-gray-900/10 text-gray-600 shadow-sm backdrop-blur-sm flex items-center justify-center dark:bg-white/10 dark:text-gray-200 select-none","aria-label":"Cycle bookmarks",onClick:Ge,children:u.jsx(no,{className:"w-4 h-4"})})]})})]})}function $4(){const n=oo(K=>K.currentPanel),o=To(K=>K.viewerOpen),s=fe(K=>K.workflow),a=fe(K=>K.isExecuting),l=fe(K=>K.progress),c=fe(K=>K.executingNodeId),d=fe(K=>K.executingPromptId),h=fe(K=>K.workflowDurationStats),p=pn(K=>K.error),m=pn(K=>K.nodeErrors),y=pn(K=>K.errorsDismissed),x=pn(K=>K.setErrorsDismissed),v=fe(K=>K.scrollToNode),C=pn(K=>K.errorCycleIndex),N=pn(K=>K.setErrorCycleIndex),w=fe(K=>K.revealNodeWithParents),j=fe(K=>K.nodeTypes),k=Ht(K=>K.running),[O,R]=b.useState(null),H=!(n==="queue")&&!(n==="outputs")&&!o,A=Object.values(m).reduce((K,je)=>K+je.length,0),V=A>0,J=!!p?.startsWith("Workflow load error")||V,X=J?"Workflow load error":"Prompt error",re=J&&p?p.replace(/^Workflow load error:\s*/i,""):p??(V?`${A} inputs reference missing options.`:null),te=(!!p||V)&&!y,me=b.useMemo(()=>{if(!s||!c)return null;const K=s.nodes.find(We=>String(We.id)===c);return K?j?.[K.type]?.display_name||K.type:`Node ${c}`},[s,c,j]),Te=d||(k[0]?.prompt_id??null),F=Hl({workflow:s,runKey:Te,isRunning:a||k.length>0,workflowDurationStats:h}),_=F===100?100:l,q=()=>{if(!s||!V)return;const K=s.nodes.filter(xe=>m[String(xe.id)]?.length);if(K.length===0)return;const je=C%K.length,We=K[je];if(!We)return;const Re=We.id,Se=We.stableKey;if(!Se)return;const Ee=`Error #${je+1}`;w(Se),N((je+1)%K.length),window.dispatchEvent(new CustomEvent("workflow-label-error-node",{detail:{nodeId:Re,label:Ee}})),window.dispatchEvent(new CustomEvent("workflow-scroll-to-node",{detail:{nodeId:Re,label:Ee}})),v(Se,Ee)},de=K=>{(K.key==="Enter"||K.key===" ")&&(K.preventDefault(),q())},Me=K=>{K.stopPropagation()},Ne=K=>{K.stopPropagation(),x(!0)},M=()=>{Te&&R(Te)},L=O!==null&&O===Te;return H?u.jsxs("div",{id:"bottom-status-overlay",className:"fixed inset-x-0 bottom-20 z-[2000] flex flex-col items-center gap-3 pointer-events-none",children:[te&&u.jsxs("div",{id:"error-notification-wrapper",className:"relative pointer-events-auto",children:[u.jsx("div",{id:"error-notification-toast",className:"bg-red-100 text-red-900 rounded-xl shadow-lg px-4 py-3 w-[70vw] max-w-sm",role:"button",tabIndex:0,onClick:q,onKeyDown:de,children:u.jsx("div",{className:"error-toast-content flex items-start justify-between gap-3",children:u.jsxs("div",{className:"error-text-container pr-16",children:[u.jsx("div",{className:"error-title text-sm font-semibold text-red-800",children:X}),u.jsx("div",{className:"error-message mt-1 text-xs text-red-800 break-words",children:re})]})})}),u.jsx("button",{id:"error-dismiss-button",type:"button","aria-label":"Dismiss error",className:"absolute top-3 right-3 shrink-0 px-3 py-1 text-xs font-semibold bg-red-700 text-white rounded-full z-10",onPointerDown:Me,onClick:Ne,children:"Dismiss"})]}),F!==null&&!L&&u.jsxs("div",{id:"execution-progress-card",className:"relative bg-white border border-gray-200 rounded-xl shadow-lg px-4 py-2 w-[70vw] max-w-sm pointer-events-auto",children:[u.jsx("button",{type:"button","aria-label":"Dismiss progress",className:"absolute top-2 right-2 w-7 h-7 rounded-full flex items-center justify-center text-gray-400 hover:text-gray-600",onClick:M,children:u.jsx(Rl,{className:"w-4 h-4"})}),u.jsx("div",{className:"executing-node-name text-sm font-semibold text-gray-900",children:me||"Running"}),u.jsxs("div",{className:"node-progress-info mt-2 flex items-center justify-between text-xs text-gray-500",children:[u.jsx("span",{children:"Progress"}),u.jsxs("span",{children:[_,"%"]})]}),u.jsx("div",{className:"node-progress-track mt-1 h-2 rounded-full bg-gray-200 overflow-hidden",children:u.jsx("div",{className:"node-progress-bar h-full bg-green-500 transition-none",style:{width:`${Math.min(100,Math.max(0,_))}%`}})}),F!==null&&u.jsxs("div",{className:"overall-progress-container",children:[u.jsxs("div",{className:"overall-progress-info mt-3 flex items-center justify-between text-xs text-gray-500",children:[u.jsx("span",{children:"Overall"}),u.jsxs("span",{children:[F,"%"]})]}),u.jsx("div",{className:"overall-progress-track mt-1 h-2 rounded-full bg-gray-200 overflow-hidden",children:u.jsx("div",{className:"overall-progress-bar h-full bg-blue-500 transition-none",style:{width:`${Math.min(100,Math.max(0,F))}%`}})})]})]})]}):null}function K4({viewerOpen:n,followQueue:o,queueSize:s,overallProgress:a,onToggleFollowQueue:l,onOpenFollowQueue:c}){const d=b.useCallback(()=>{n?l?.():c?.()},[n,l,c]),h=b.useMemo(()=>n?o?"Disable follow queue":"Enable follow queue":"Open image viewer",[n,o]),p=b.useMemo(()=>n&&o?"bg-green-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200",[n,o]);return u.jsxs("button",{onClick:d,className:`relative w-12 h-12 rounded-xl flex items-center justify-center text-2xl transition-colors ${p}`,"aria-label":h,children:[u.jsx("span",{className:"absolute inset-0 flex items-center justify-center",children:u.jsx(Zb,{className:"w-6 h-6",showSlash:n&&!o})}),s>0&&u.jsxs("div",{className:`queue-badge absolute top-0 right-0 translate-x-[18px] -translate-y-[18px] w-6 h-6 rounded-full bg-blue-500 text-white
                     flex items-center justify-center font-bold text-xs border-2 border-white relative z-20`,children:[a!==null&&u.jsx(pS,{className:"absolute z-10 pointer-events-none",width:"24",height:"24",style:{top:"50%",left:"50%",transform:"translate(-50%, -50%) rotate(-90deg)"},progress:a}),s]})]})}function U4(){const n=fe(p=>p.workflow),o=go(p=>p.pinnedWidget),s=go(p=>p.pinOverlayOpen),a=go(p=>p.togglePinOverlay),l=fe(p=>p.updateNodeWidget),c=b.useMemo(()=>{if(!o||!n)return;const p=n.nodes.find(m=>m.id===o.nodeId);if(p)return pa(p,o.widgetName,o.widgetIndex)},[o,n]);if(!s||!o)return null;const h=n?.nodes.find(p=>p.id===o.nodeId)?.stableKey??null;return u.jsx("div",{id:"pin-overlay-hidden-anchor",className:"hidden",children:u.jsx(Bo,{name:o.widgetName,type:o.widgetType,value:c,options:o.options,onChange:p=>h?l(h,o.widgetIndex,p,o.widgetName):void 0,hideLabel:!0,compact:!0,forceModalOpen:!0,onModalClose:a})})}function W4(){const n=Xt(o=>o.setFilterModalOpen);return u.jsx("button",{onClick:()=>n(!0),className:"relative w-12 h-12 rounded-xl flex items-center justify-center text-2xl transition-colors bg-gray-100 text-gray-700 hover:bg-gray-200","aria-label":"Filter and sort",children:u.jsx(J2,{className:"w-6 h-6"})})}function F4(){const n=Xt(a=>a.selectedIds.length),o=Xt(a=>a.setSelectionActionOpen),s=n===0;return u.jsx("button",{onClick:()=>o(!0),disabled:s,className:`relative w-12 h-12 rounded-xl flex items-center justify-center text-2xl transition-colors ${s?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,"aria-label":"Selection actions",children:u.jsx("div",{className:`w-6 h-6 rounded-full border-2 flex items-center justify-center shadow-sm ${s?"border-gray-300 bg-transparent":"bg-blue-600 border-blue-600 text-white"}`,children:!s&&u.jsx(zo,{className:"w-4 h-4"})})})}function q4(){return Xt(o=>o.selectionMode)?u.jsx(F4,{}):u.jsx(W4,{})}function G4(){const n=go(a=>a.pinnedWidget),o=go(a=>a.pinOverlayOpen),s=go(a=>a.togglePinOverlay);return n?u.jsx("button",{onClick:s,className:`relative w-12 h-12 rounded-xl flex items-center justify-center text-2xl transition-colors ${o?"bg-fuchsia-500 text-white":"bg-gray-100 text-fuchsia-500 hover:bg-gray-200"}`,"aria-label":o?"Close pin editor":"Open pin editor",children:u.jsx(kl,{className:"w-6 h-6"})}):null}function P4(){const n=fe(c=>c.workflow),o=fe(c=>c.runCount),s=fe(c=>c.queueWorkflow),a=n!==null,l=()=>{a&&(s(o),"vibrate"in navigator&&navigator.vibrate(20))};return u.jsx("button",{onClick:l,disabled:!a,className:"flex-1 py-3 px-6 rounded-xl font-semibold text-lg min-h-[48px] transition-all "+(a?"bg-blue-500 text-white active:bg-blue-600":"bg-gray-300 text-gray-500 cursor-not-allowed"),children:"Run"})}function Y4(){const n=fe(l=>l.runCount),o=fe(l=>l.setRunCount),s=()=>{o(n-1)},a=()=>{o(n+1)};return u.jsxs("div",{id:"run-count-selector",className:"flex items-center gap-1 bg-gray-100 rounded-lg p-1",children:[u.jsx("button",{onClick:s,disabled:n<=1,className:`w-10 h-10 rounded-lg bg-white shadow-sm flex items-center justify-center
                   text-lg font-medium text-gray-700 disabled:opacity-40 disabled:shadow-none`,children:""}),u.jsx("span",{className:"w-8 text-center font-semibold text-gray-900",children:n}),u.jsx("button",{onClick:a,className:`w-10 h-10 rounded-lg bg-white shadow-sm flex items-center justify-center
                   text-lg font-medium text-gray-700`,children:"+"})]})}function Q4(n){const{currentPanel:o,viewerOpen:s=!1,followQueue:a=!1,onToggleFollowQueue:l,onOpenFollowQueue:c}=n,d=o==="outputs",h=fe(k=>k.workflow),p=fe(k=>k.isExecuting),m=fe(k=>k.executingPromptId),y=fe(k=>k.workflowDurationStats),x=Ht(k=>k.pending),v=Ht(k=>k.running),C=b.useRef(null),N=x.length+v.length,w=m||(v[0]?.prompt_id??null),j=Hl({workflow:h,runKey:w,isRunning:p||v.length>0,workflowDurationStats:y});return b.useEffect(()=>{const k=C.current;if(!k)return;const O=()=>{const R=k.getBoundingClientRect();document.documentElement.style.setProperty("--bottom-bar-offset",`${R.height}px`)};return O(),window.addEventListener("resize",O),()=>window.removeEventListener("resize",O)},[]),u.jsxs("div",{id:"bottom-bar-root",ref:C,className:"fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 shadow-lg safe-area-bottom z-[2200]",children:[u.jsxs("div",{id:"bottom-bar-content",className:"flex items-center gap-3 px-3 py-2 max-w-lg mx-auto",children:[u.jsx(Y4,{}),u.jsx(P4,{}),d&&u.jsx(q4,{}),!d&&u.jsx(G4,{}),u.jsx(K4,{viewerOpen:s,followQueue:a,queueSize:N,overallProgress:j,onToggleFollowQueue:l,onOpenFollowQueue:c})]}),u.jsx(U4,{}),u.jsx($4,{})]})}const Nb=n=>Symbol.iterator in n,Cb=n=>"entries"in n,kb=(n,o)=>{const s=n instanceof Map?n:new Map(n.entries()),a=o instanceof Map?o:new Map(o.entries());if(s.size!==a.size)return!1;for(const[l,c]of s)if(!a.has(l)||!Object.is(c,a.get(l)))return!1;return!0},X4=(n,o)=>{const s=n[Symbol.iterator](),a=o[Symbol.iterator]();let l=s.next(),c=a.next();for(;!l.done&&!c.done;){if(!Object.is(l.value,c.value))return!1;l=s.next(),c=a.next()}return!!l.done&&!!c.done};function Z4(n,o){return Object.is(n,o)?!0:typeof n!="object"||n===null||typeof o!="object"||o===null||Object.getPrototypeOf(n)!==Object.getPrototypeOf(o)?!1:Nb(n)&&Nb(o)?Cb(n)&&Cb(o)?kb(n,o):X4(n,o):kb({entries:()=>Object.entries(n)},{entries:()=>Object.entries(o)})}function J4(n){const o=ia.useRef(void 0);return s=>{const a=n(s);return Z4(o.current,a)?o.current:o.current=a}}function Vf(n){return!!n&&typeof n=="object"&&!Array.isArray(n)}function nv(n){return Array.isArray(n)&&n.length>=2&&(typeof n[0]=="string"||typeof n[0]=="number")&&typeof n[1]=="number"}function ic(n){return n.class_type??n.type??null}function th(n,o){for(const s of o){const a=n.inputs?.[s];if(!nv(a)&&a!==void 0)return a}}function ca(n,o){const s=th(n,o);if(s!=null)return typeof s=="string"?s:String(s)}function $f(n,o){if(!nv(o))return null;const s=String(o[0]);return n[s]??null}function e5(n){if(!n)return;const o=ca(n,["sampler_name","sampler","name"]);if(o)return o;if(ic(n)==="KSamplerSelect"&&Array.isArray(n.widgets_values)){const a=n.widgets_values[0];return a==null?void 0:String(a)}}function t5(n){if(!n)return;const o=ca(n,["scheduler","scheduler_name","name"]);if(o)return o;if(ic(n)==="BasicScheduler"&&Array.isArray(n.widgets_values)){const a=n.widgets_values[0];return a==null?void 0:String(a)}}function n5(n){if(!n)return;const o=th(n,["steps","step_count"]);if(o!==void 0)return o;if(ic(n)==="BasicScheduler"&&Array.isArray(n.widgets_values)){const a=n.widgets_values[1];return a??void 0}}function o5(n){if(!n)return;const o=th(n,["cfg","guidance","guidance_scale"]);if(o!==void 0)return o;if(Array.isArray(n.widgets_values)){const s=n.widgets_values[0];return s??void 0}}function nh(n){const o={};if(!Vf(n)&&!Array.isArray(n))return o;let s=null;if(Array.isArray(n)&&n.length>=3&&Vf(n[2])?s=n[2]:Vf(n)&&(s=n),!s)return o;const l=Object.entries(s).sort((c,d)=>Number(c[0])-Number(d[0])).map(([,c])=>c);for(const c of l){const d=ic(c);if(d){if(d==="CheckpointLoaderSimple"||d==="CheckpointLoader"){const h=c.inputs?.ckpt_name;typeof h=="string"?o.model=h.replace(/\.(safetensors|ckpt|pt)$/i,""):h!=null&&(o.model=String(h).replace(/\.(safetensors|ckpt|pt)$/i,""))}if(d==="KSampler"||d==="KSamplerAdvanced"){if(o.steps===void 0&&c.inputs?.steps!==void 0&&(o.steps=c.inputs.steps),o.cfg===void 0&&c.inputs?.cfg!==void 0&&(o.cfg=c.inputs.cfg),o.sampler===void 0){const h=ca(c,["sampler_name"]);h&&(o.sampler=h)}if(o.scheduler===void 0){const h=ca(c,["scheduler"]);h&&(o.scheduler=h)}}if(d==="SamplerCustom"||d==="SamplerCustomAdvanced"){if(o.steps===void 0&&c.inputs?.steps!==void 0&&(o.steps=c.inputs.steps),o.cfg===void 0&&c.inputs?.cfg!==void 0&&(o.cfg=c.inputs.cfg),o.sampler===void 0){const h=ca(c,["sampler","sampler_name"]),p=$f(s,c.inputs?.sampler),m=h??e5(p);m&&(o.sampler=m)}if(o.scheduler===void 0){const h=ca(c,["scheduler","scheduler_name"]),p=$f(s,c.inputs?.sigmas??c.inputs?.scheduler),m=h??t5(p);m&&(o.scheduler=m)}if(o.steps===void 0){const h=$f(s,c.inputs?.sigmas??c.inputs?.scheduler),p=n5(h);p!==void 0&&(o.steps=p)}}if(d==="FluxGuidance"&&o.cfg===void 0){const h=o5(c);h!==void 0&&(o.cfg=h)}}}return o}function oh(n,o={}){const{onlyOutput:s=!1,alt:a}=o,l=[];return n.forEach((c,d)=>{const h=c.outputs?.images??[],p=nh(c.prompt),m=c.durationSeconds,y=c.success!==!1;h.forEach((x,v)=>{if(s&&x.type!=="output")return;const C=typeof a=="function"?a(v,d):a,N=x.subfolder?`${x.subfolder}/${x.filename}`:x.filename,w=Vl(x.filename),j=w==="video"?"video":"image";l.push({src:mo(x.filename,x.subfolder,x.type),alt:C,mediaType:w,metadata:p,durationSeconds:m,success:y,filename:x.filename,file:{id:`${x.type}/${N}`,name:x.filename,type:j,fullUrl:mo(x.filename,x.subfolder,x.type)}})})}),l}function r5({menuState:n,unifiedList:o,onClose:s,onLoadWorkflow:a,onCopyWorkflow:l,onDownload:c,onBatchDownload:d,onDeleteHistory:h,getBatchSources:p}){const m=n?.promptId??"",y=Ht(k=>k.queueItemHideImages[m]),x=Ht(k=>k.toggleQueueItemHideImages),v=()=>{n?.workflow&&n.promptId&&a(n.workflow,n.promptId),s()},C=()=>{l(n?.workflow),s()},N=async()=>{const k=n?.promptId?p(n.promptId,o):[];k.length>1?await d(k):n&&await c(n.imageSrc),s()},w=()=>{x(m),s()},j=()=>{n?.promptId&&h(n.promptId),s()};return n?.open?_n.createPortal(u.jsx("div",{id:"queue-image-menu",className:"fixed z-[1200] w-44",style:{top:n.top,right:n.right},children:u.jsx(xr,{items:[{key:"load-workflow",label:"Load workflow",icon:u.jsx(Cs,{className:"w-4 h-4"}),onClick:v,disabled:!n.workflow},{key:"copy-workflow",label:"Copy workflow",icon:u.jsx(uS,{className:"w-4 h-4"}),onClick:C,disabled:!n.workflow},{key:"download",label:n.promptId&&p(n.promptId,o).length>1?"Download batch":"Download",icon:u.jsx(cS,{className:"w-4 h-4"}),onClick:N},{key:"toggle-images",label:y?"Show images":"Hide images",icon:y?u.jsx(gr,{className:"w-4 h-4"}):u.jsx(Po,{className:"w-4 h-4"}),onClick:w,hidden:!(n.hasVideoOutputs&&n.hasImageOutputs&&n.promptId)},{key:"delete",label:"Delete",icon:u.jsx(Ho,{className:"w-4 h-4"}),onClick:j,color:"danger"}]})}),document.body):null}function s5({message:n}){return n?_n.createPortal(u.jsx("div",{className:"fixed top-20 left-1/2 -translate-x-1/2 z-[1300] bg-gray-800 text-white px-4 py-2 rounded-lg shadow-lg text-sm font-medium animate-in fade-in slide-in-from-top-2 duration-200",children:n}),document.body):null}function ov(n){return"outputs"in n}function a5(n,o){const s=o.find(l=>l.id===n);return!s||s.status!=="done"?[]:ov(s.data)?(s.data.outputs.images??[]).filter(l=>l.type==="output").map(l=>mo(l.filename,l.subfolder,l.type)):[]}async function rv(n,o="image.png",s){try{const l=await(await fetch(n)).blob(),c=URL.createObjectURL(l),d=document.createElement("a");d.href=c,d.download=o,document.body.appendChild(d),d.click(),d.remove(),URL.revokeObjectURL(c),s?.(n)}catch(a){console.error("Failed to download image:",a)}}async function l5(n,o){for(const s of n)await rv(s,"image.png",o)}async function i5(n){try{if(navigator.clipboard?.writeText)await navigator.clipboard.writeText(n);else{const o=document.createElement("textarea");o.value=n,o.style.position="fixed",o.style.opacity="0",document.body.appendChild(o),o.select(),document.execCommand("copy"),document.body.removeChild(o)}return!0}catch(o){return console.error("Failed to copy to clipboard:",o),!1}}function u5({item:n,isActuallyRunning:o,progress:s,overallProgress:a,executingNodeLabel:l,onDelete:c,onStop:d,onImageClick:h,viewerImages:p,runningImages:m,onOpenMenu:y,downloaded:x,isTopDoneItem:v}){const C=Ht(W=>W.previewVisibility),N=Ht(W=>W.previewVisibilityDefault),w=Ht(W=>W.showQueueMetadata),j=Ht(W=>W.queueItemExpanded[n.id]),k=Ht(W=>W.setQueueItemExpanded),O=Ht(W=>W.queueItemHideImages[n.id]),R=b.useRef(new Map),D=b.useRef(new Set),[I,H]=b.useState(new Set),A=n.status==="pending"&&!o,V=n.status==="running"||o,J=n.status==="done",X=j!==void 0,re=X?j:!1,te=b.useRef(J);b.useEffect(()=>{X||k(n.id,!1)},[X,n.id,k]),b.useEffect(()=>{!te.current&&J&&k(n.id,!0),te.current=J},[J,n.id,k]),b.useEffect(()=>{D.current.clear(),H(new Set)},[n.id]);const me=()=>{k(n.id,!re)},Te=J&&ov(n.data)?n.data:null,F=b.useMemo(()=>Te?Te.outputs.images:V?m:[],[Te,V,m]),_=!!(n.data.prompt_id?C[n.data.prompt_id]??N:N),{savedImages:q,displayImages:de}=b.useMemo(()=>{const W=F.filter(z=>z.type==="output"),P=_||W.length===0;return{savedImages:W,displayImages:P?F:F.filter(z=>z.type==="output")}},[_,F]),Me=b.useMemo(()=>F.some(W=>aa(W.filename)),[F]),Ne=b.useMemo(()=>F.some(W=>!aa(W.filename)),[F]),M=b.useMemo(()=>!O||!Me?de:de.filter(W=>aa(W.filename)),[de,Me,O]),L=q.map(W=>({src:mo(W.filename,W.subfolder,W.type),alt:"Generation"})),K="aspect-square w-full bg-gray-100 flex flex-col items-center justify-center text-gray-400",je=Te?.durationSeconds,We=Te?Te.success!==!1:!0,Re=c5(je),Se=a===100?100:s,Ee=b.useMemo(()=>!w||!n.data.prompt?null:nh(n.data.prompt),[w,n.data.prompt]),xe=b.useMemo(()=>V?M.map(W=>({src:mo(W.filename,W.subfolder,W.type),alt:"Generation",mediaType:Vl(W.filename)})):p,[V,p,M]);b.useEffect(()=>{re&&M.forEach(W=>{if(!aa(W.filename))return;const P=mo(W.filename,W.subfolder,W.type);if(D.current.has(P))return;D.current.add(P);const z=R.current.get(P);if(!z)return;z.currentTime=0,H(ee=>{const pe=new Set(ee);return pe.delete(P),pe});const $=z.play();$&&typeof $.catch=="function"&&$.catch(()=>{})})},[re,M]);const se=W=>{W.stopPropagation(),me()},Z=W=>{W.stopPropagation(),d()},T=W=>{W.stopPropagation(),c()},ie=W=>{W.stopPropagation();const P=W.currentTarget.getBoundingClientRect(),z=Math.max(8,window.innerWidth-P.right),$=L[0]?.src||"";y({top:P.bottom+6,right:z,imageSrc:$,workflow:Te?.workflow,promptId:n.data.prompt_id||n.id,hasVideoOutputs:Me,hasImageOutputs:Ne})},G=W=>()=>{H(P=>new Set(P).add(W))},ge=W=>()=>{H(P=>{const z=new Set(P);return z.delete(W),z})},B=(W,P,z)=>()=>{const $=xe.findIndex(ee=>ee.src===W);h?.(xe,$>=0?$:P,z)},ne=W=>P=>{P.stopPropagation();const z=R.current.get(W);if(!z)return;z.currentTime=0;const $=z.play();$&&typeof $.catch=="function"&&$.catch(()=>{})};return u.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden transition-all duration-300",children:[u.jsxs("div",{onClick:me,className:`px-3 py-2 border-b flex justify-between items-center cursor-pointer select-none ${V?"bg-blue-50 border-blue-100":"bg-gray-50 border-gray-100"}`,children:[u.jsxs("div",{className:"flex items-center gap-1 min-w-0",children:[u.jsx("button",{onClick:se,className:"w-8 h-8 -ml-2 flex items-center justify-center text-gray-400 hover:text-gray-600 shrink-0",children:re?u.jsx(no,{className:"w-6 h-6"}):u.jsx(ws,{className:"w-6 h-6"})}),V&&u.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"}),A&&u.jsx("span",{className:"text-xs font-bold text-gray-400",children:"PENDING"}),V&&u.jsx("span",{className:"text-xs font-bold text-blue-600",children:"GENERATING"}),J&&u.jsx("span",{className:"text-xs font-bold text-gray-500",children:new Date(n.timestamp||0).toLocaleTimeString()}),V&&!re&&o&&a!=null&&u.jsxs("span",{className:"ml-1 text-xs font-semibold text-blue-600",children:[Math.min(100,Math.max(0,a)),"%"]})]}),u.jsx("div",{className:"flex items-center gap-2",children:V?u.jsx("button",{onClick:Z,className:"px-2 py-1 text-xs font-semibold text-white bg-red-600 rounded hover:bg-red-700",children:"Stop"}):J?u.jsx(Qr,{onClick:ie,ariaLabel:"Image options",buttonSize:7,iconSize:4}):u.jsx("button",{onClick:T,className:"text-gray-400 hover:text-red-500 px-2",title:A?"Remove from Queue":"Delete from History","aria-label":A?"Remove from Queue":"Delete from History",children:u.jsx(Rl,{className:"w-4 h-4"})})})]}),re&&u.jsx("div",{className:"relative w-full animate-in fade-in duration-200",children:M.length>0?u.jsx("div",{className:"flex flex-col",children:(()=>{let W=0,P=0;return M.map((z,$)=>{const ee=z.type!=="output",pe=ee?++P:++W,ae=`${ee?"Preview":"Save"} #${pe}`,ke=mo(z.filename,z.subfolder,z.type),U=x[ke],ce=M.length>1;return u.jsxs("div",{className:"relative",children:[Re&&u.jsxs("div",{className:`absolute top-2 left-2 flex items-center gap-1 px-2 py-1 rounded text-xs font-semibold ${We?"bg-green-600/90 text-white":"bg-red-600/90 text-white"}`,children:[We?u.jsx(zo,{className:"w-3.5 h-3.5"}):u.jsx(sS,{className:"w-3.5 h-3.5"}),u.jsx("span",{children:Re})]}),aa(z.filename)?u.jsxs(u.Fragment,{children:[u.jsx("video",{src:ke,className:"w-full h-auto block",muted:!0,playsInline:!0,preload:"metadata",ref:He=>{He?R.current.set(ke,He):R.current.delete(ke)},onEnded:G(ke),onPlay:ge(ke),onClick:B(ke,$,v)}),I.has(ke)&&u.jsx("button",{type:"button",className:"absolute inset-0 flex items-center justify-center bg-black/35 text-white",onClick:ne(ke),"aria-label":"Replay video",children:u.jsx("span",{className:"flex h-12 w-12 items-center justify-center rounded-full bg-black/60 text-2xl",children:""})})]}):u.jsx("img",{src:ke,alt:"Generation",className:"w-full h-auto block",loading:"lazy",onClick:B(ke,$,v)}),U&&u.jsx("div",{className:"absolute bottom-2 right-2 w-7 h-7 rounded-full bg-black/60 text-white flex items-center justify-center",children:u.jsx(aS,{className:"w-4 h-4"})}),ce&&u.jsx("div",{className:"absolute bottom-2 left-2 px-2 py-1 bg-black/60 text-white text-xs font-medium rounded backdrop-blur-sm shadow-sm pointer-events-none",children:ae}),Ee&&u.jsxs("div",{className:`absolute right-2 flex flex-col-reverse items-end gap-1 pointer-events-none ${U?"bottom-10":"bottom-2"}`,children:[Ee.model&&u.jsxs("div",{className:"px-1.5 py-0.5 bg-black/50 text-white text-[10px] rounded backdrop-blur-sm",children:["model: ",Ee.model]}),Ee.sampler&&u.jsxs("div",{className:"px-1.5 py-0.5 bg-black/50 text-white text-[10px] rounded backdrop-blur-sm",children:["sampler: ",Ee.sampler]}),Ee.steps&&u.jsxs("div",{className:"px-1.5 py-0.5 bg-black/50 text-white text-[10px] rounded backdrop-blur-sm",children:["steps: ",Ee.steps]}),Ee.cfg&&u.jsxs("div",{className:"px-1.5 py-0.5 bg-black/50 text-white text-[10px] rounded backdrop-blur-sm",children:["cfg: ",Ee.cfg]})]})]},$)})})()}):J?u.jsx("div",{className:K,children:u.jsx("span",{className:"text-sm",children:"No images saved"})}):V?u.jsx("div",{className:K,style:{minHeight:"300px"},children:o&&a!=null?u.jsxs("div",{className:"w-full max-w-xs px-4",children:[u.jsxs("p",{className:"font-semibold text-base text-gray-900 mb-3",children:["Executing: ",l||"Running"]}),u.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 mb-1",children:[u.jsx("span",{children:"Progress"}),u.jsxs("span",{children:[Se,"%"]})]}),u.jsx("div",{className:"h-2 rounded-full bg-gray-200 overflow-hidden",children:u.jsx("div",{className:"h-full bg-green-500 transition-none",style:{width:`${Math.min(100,Math.max(0,Se))}%`}})}),u.jsxs("div",{className:"mt-3 flex items-center justify-between text-xs text-gray-500 mb-1",children:[u.jsx("span",{children:"Overall"}),u.jsxs("span",{children:[a,"%"]})]}),u.jsx("div",{className:"h-2 rounded-full bg-gray-200 overflow-hidden",children:u.jsx("div",{className:"h-full bg-blue-500 transition-none",style:{width:`${Math.min(100,Math.max(0,a))}%`}})})]}):u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"w-12 h-12 border-4 border-blue-200 border-t-blue-500 rounded-full animate-spin mb-4"}),u.jsx("p",{className:"font-medium text-lg text-blue-600",children:"Generating..."})]})}):u.jsxs("div",{className:K,style:{minHeight:"100px"},children:[u.jsx(kS,{className:"w-8 h-8 text-gray-300"}),u.jsx("span",{className:"text-xs mt-2 opacity-40",children:"Waiting to start..."})]})})]})}function c5(n){const o=n===void 0||Number.isNaN(n)?0:n;return o<10?`${o.toFixed(1)}s`:`${Math.round(o)}s`}function d5({listRef:n,unifiedList:o,visibleCount:s,hasLoadedOnce:a,effectiveExecutingId:l,progress:c,overallProgress:d,executingNodeLabel:h,onDeleteItem:p,onStop:m,onImageClick:y,viewerImages:x,promptOutputs:v,onOpenMenu:C,downloaded:N,firstDoneItemId:w,onScroll:j}){return u.jsxs("div",{ref:n,className:"flex-1 overflow-y-auto p-4 space-y-4 overscroll-contain scroll-container","data-queue-list":"true",onScroll:j,children:[o.length===0&&!a&&u.jsx("div",{className:"flex items-center justify-center min-h-[calc(100vh-180px)] text-gray-400",children:u.jsxs("div",{className:"text-center",children:[u.jsx($p,{size:"lg",color:"gray",className:"mx-auto mb-4"}),u.jsx("p",{className:"text-lg",children:"Loading..."})]})}),o.length===0&&a&&u.jsx("div",{className:"flex items-center justify-center min-h-[calc(100vh-180px)] text-gray-500",children:u.jsxs("div",{className:"text-center p-8",children:[u.jsx("div",{className:"flex items-center justify-center mb-4",children:u.jsx(oS,{className:"w-10 h-10 text-gray-300"})}),u.jsx("p",{className:"text-lg font-medium",children:"Queue is empty"}),u.jsx("p",{className:"text-sm mt-2",children:"Run a workflow to see items here"})]})}),o.slice(0,s).map(k=>u.jsx(u5,{item:k,isActuallyRunning:k.id===l,progress:c,overallProgress:d,executingNodeLabel:h,onDelete:()=>p(k),onStop:m,onImageClick:y,viewerImages:x,runningImages:v[k.id]??[],onOpenMenu:C,downloaded:N,isTopDoneItem:k.id===w},k.id)),u.jsx("div",{className:"h-20"})]})}function f5(n,o,s){b.useEffect(()=>{if(!n)return;const a=()=>o(),l=c=>{const d=c.target,h=document.getElementById(s);h&&d&&h.contains(d)||o()};return document.addEventListener("scroll",a,!0),document.addEventListener("mousedown",l),()=>{document.removeEventListener("scroll",a,!0),document.removeEventListener("mousedown",l)}},[n,o,s])}function p5({visible:n,onImageClick:o}){const s=Ht(T=>T.running),a=Ht(T=>T.pending),l=Ht(T=>T.fetchQueue),c=Ht(T=>T.deleteItem),d=Ht(T=>T.interrupt),h=fe(T=>T.loadWorkflow),p=oo(T=>T.setCurrentPanel),m=fe(T=>T.workflow),y=fe(T=>T.nodeTypes),x=fe(T=>T.executingNodeId),v=fe(T=>T.workflowDurationStats),C=fe(T=>T.promptOutputs),N=Yn(T=>T.history),w=Yn(T=>T.fetchHistory),j=Yn(T=>T.deleteItem),{isExecuting:k,progress:O,executingPromptId:R}=fe(J4(T=>({isExecuting:T.isExecuting,progress:T.progress,executingPromptId:T.executingPromptId}))),D=R||(s.length===1?s[0].prompt_id:null),I=b.useMemo(()=>{if(!m||!x)return null;const T=m.nodes.find(G=>String(G.id)===x);return T?y?.[T.type]?.display_name||T.type:`Node ${x}`},[m,x,y]),H=Hl({workflow:m,runKey:R||D,isRunning:k||!!D,workflowDurationStats:v}),[A,V]=b.useState(null),[J,X]=b.useState({}),[re,te]=b.useState(null),[me,Te]=b.useState(!1),[F,_]=b.useState(0),q=b.useRef(null),de=b.useRef(0),Me=b.useRef(!1),Ne=b.useRef(!1);b.useEffect(()=>{n&&(Me.current||Ne.current&&q.current&&(q.current.scrollTop=0),Promise.all([l(),w()]).then(()=>{Te(!0)})),Me.current=n,Ne.current||(Ne.current=!0)},[n,l,w]),b.useEffect(()=>{!k&&n&&w()},[k,n,w]),f5(!!A?.open,()=>V(null),"queue-image-menu");const M=async T=>{if(!T)return;const ie=JSON.stringify(T,null,2),G=await i5(ie);te(G?"Copied to clipboard":"Failed to copy"),setTimeout(()=>te(null),2e3)},L=async T=>{await rv(T,"image.png",ie=>{X(G=>({...G,[ie]:!0}))})},K=b.useMemo(()=>{const T={};N.forEach(G=>{T[G.prompt_id]={id:G.prompt_id,status:"done",data:G,timestamp:G.timestamp}}),s.forEach(G=>{T[G.prompt_id]||(T[G.prompt_id]={id:G.prompt_id,status:"running",data:G})}),a.forEach(G=>{T[G.prompt_id]||(T[G.prompt_id]={id:G.prompt_id,status:"pending",data:G})}),R&&T[R]&&(T[R].status="running");const ie=Object.values(T);return ie.sort((G,ge)=>{const B={pending:0,running:1,done:2};if(B[G.status]!==B[ge.status])return B[G.status]-B[ge.status];if(G.status==="pending"){const ne=G.data.number;return ge.data.number-ne}return G.status==="done"?(ge.timestamp||0)-(G.timestamp||0):0}),ie},[a,s,N,R]),je=b.useMemo(()=>{if(K.length===0)return 0;const T=K.filter(B=>B.status==="pending").length,ie=K.filter(B=>B.status==="running").length,ge=K.filter(B=>B.status==="done").length>0?1:0;return Math.min(K.length,T+ie+ge)},[K]),We=b.useMemo(()=>{const T=K.filter(ie=>ie.status==="done").map(ie=>ie.data);return oh(T,{alt:"Generation"})},[K]),Re=b.useMemo(()=>K.find(ie=>ie.status==="done")?.id??null,[K]);b.useEffect(()=>{n&&(de.current=K.length,queueMicrotask(()=>{_(T=>Math.max(T,je))}))},[n,K.length,je]),b.useEffect(()=>{if(!n)return;const T=q.current;T&&(F>=K.length||T.scrollHeight<=T.clientHeight+20&&queueMicrotask(()=>{_(ie=>Math.min(K.length,ie+10))}))},[n,F,K.length]);const Se=T=>{T.status==="pending"&&c(T.id),T.status==="done"&&j(T.id)},Ee=T=>{const{top:ie,right:G,imageSrc:ge,workflow:B,promptId:ne,hasVideoOutputs:W,hasImageOutputs:P}=T;V({open:!0,top:ie,right:G,imageSrc:ge,workflow:B,promptId:ne,hasVideoOutputs:W,hasImageOutputs:P})},xe=()=>{const T=q.current;if(!T)return;T.scrollHeight-T.scrollTop-T.clientHeight<400&&_(G=>Math.min(de.current,G+10))},se=(T,ie)=>{h(T,`history-${ie}.json`,{source:{type:"history",promptId:ie}}),p("workflow")},Z=async T=>{await l5(T,ie=>{X(G=>({...G,[ie]:!0}))})};return u.jsx("div",{id:"queue-panel-wrapper",className:"absolute inset-x-0 top-[69px] bottom-0",style:{display:n?"block":"none"},children:u.jsxs("div",{className:"flex flex-col bg-gray-100 min-h-full",children:[u.jsx(d5,{listRef:q,unifiedList:K,visibleCount:F,hasLoadedOnce:me,effectiveExecutingId:D,progress:O,overallProgress:H,executingNodeLabel:I,onDeleteItem:Se,onStop:d,onImageClick:o,viewerImages:We,promptOutputs:C,onOpenMenu:Ee,downloaded:J,firstDoneItemId:Re,onScroll:xe}),u.jsx(r5,{menuState:A,unifiedList:K,onClose:()=>V(null),onLoadWorkflow:se,onCopyWorkflow:M,onDownload:T=>L(T),onBatchDownload:Z,onDeleteHistory:T=>j(T),getBatchSources:a5}),u.jsx(s5,{message:re})]})})}let Kf=null,Tu=[];function jb(n){return encodeURIComponent(n)}async function h5(){if(Tu.length===0)return;const n=[...Tu];Tu=[];const o=n.map(s=>{const a=new Date(s.timestamp).toISOString(),l=s.data!==void 0?` | ${JSON.stringify(s.data)}`:"";return`${a} ${s.message}${l}`}).join(`
`)+`
`;try{let s="";try{const l=await fetch(`${rn}/api/userdata/${jb("mobile-debug.log")}`);l.ok&&(s=await l.text())}catch{}const a=s+o;await fetch(`${rn}/api/userdata/${jb("mobile-debug.log")}?overwrite=true`,{method:"POST",headers:{"Content-Type":"text/plain"},body:a})}catch(s){console.error("[debugLog] Failed to write to server:",s)}}function g5(){Kf||(Kf=setTimeout(()=>{Kf=null,h5()},500))}function bp(n,o){const s={timestamp:Date.now(),message:n,data:o};Tu.push(s),o!==void 0?console.log(`[DEBUG] ${n}`,o):console.log(`[DEBUG] ${n}`),g5()}function m5(n,o,s){const a=n.closest("[data-textarea-root]")?.querySelector("[data-textarea-header]"),l=getComputedStyle(document.documentElement),c=parseFloat(l.getPropertyValue("--top-bar-offset"))||0,d=window.visualViewport?.offsetTop??0,h=window.visualViewport?.height??window.innerHeight,p=c+8,m=sv(n),y=a?.getBoundingClientRect(),x=m===window?{type:"window",scrollY:window.scrollY}:(()=>{const H=m;return{type:"element",tag:H.tagName.toLowerCase(),scrollTop:H.scrollTop,height:H.clientHeight}})();bp("textarea-scroll: start",{reason:s,behavior:o,headerTop:y?.top??null,layoutTopEdge:p,viewportTopEdge:d+c+8,viewportTop:d,viewportHeight:h,topBarOffset:c,container:x,selectionStart:n.selectionStart});const v=b5(n),C=d+c+h*.25,N=d+h-24,w=y?y.top-p:null,j=v-C,k=v>N?v-N:0;let O=0;const R=w!==null&&w>2,D=R?v-w:v,I=D<=N;R&&I?O=w??0:!R&&v<=N?O=0:(O=j,k>O&&(O=k)),O<0&&(O=0),y&&w!==null&&y.top>p+2&&O>w&&(O=w),bp("textarea-scroll: align",{caretTop:v,targetTop:C,visibilityBottom:N,deltaHeader:w,deltaCaret:j,deltaCaretMin:k,caretAfterHeader:D,caretVisibleAfterHeader:I,canAlignHeader:R,delta:O}),Math.abs(O)>8&&av(m,O,o)}function y5(n){const o=n.closest("[data-textarea-root]")?.querySelector("[data-textarea-header]");if(!o)return;const s=getComputedStyle(document.documentElement),l=(parseFloat(s.getPropertyValue("--top-bar-offset"))||0)+8,c=o.getBoundingClientRect(),d=c.top-l;if(Math.abs(d)<2)return;const h=sv(n);bp("textarea-scroll: align-header-request",{headerTop:c.top,layoutTopEdge:l,delta:d}),av(h,d,"auto")}function b5(n){const o=n.getBoundingClientRect(),s=x5(n);return o.top+s-n.scrollTop}function x5(n){const o=n.selectionStart??0,s=n.value,a=document.createElement("div"),l=getComputedStyle(n),c=a.style;c.position="absolute",c.top="0",c.left="-9999px",c.visibility="hidden",c.whiteSpace="pre-wrap",c.wordWrap="break-word",c.overflowWrap="break-word",c.boxSizing=l.boxSizing,c.width=`${n.clientWidth}px`,c.padding=l.padding,c.border=l.border,c.fontFamily=l.fontFamily,c.fontSize=l.fontSize,c.fontWeight=l.fontWeight,c.fontStyle=l.fontStyle,c.letterSpacing=l.letterSpacing,c.lineHeight=l.lineHeight,c.textTransform=l.textTransform,c.textIndent=l.textIndent,c.tabSize=l.tabSize;const d=document.createTextNode(s.slice(0,o)),h=document.createElement("span");h.textContent=s.slice(o,o+1)||" ",h.style.display="inline-block",h.style.width="1px",a.appendChild(d),a.appendChild(h),document.body.appendChild(a);const p=a.getBoundingClientRect(),y=h.getBoundingClientRect().top-p.top;return document.body.removeChild(a),y}function Uf(n){n?document.body.dataset.textareaFocus="true":delete document.body.dataset.textareaFocus}function sv(n){let o=n?.parentElement??null;for(;o;){const a=getComputedStyle(o).overflowY;if((a==="auto"||a==="scroll")&&o.scrollHeight>o.clientHeight)return o;o=o.parentElement}return window}function av(n,o,s="smooth"){if(Math.abs(o)<1)return;if(n===window){window.scrollBy({top:o,behavior:s});return}const a=n;a.scrollTo({top:a.scrollTop+o,behavior:s})}function lv(){const[n,o]=b.useState(!1),s=b.useRef(null),a=b.useRef(null),l=b.useRef(null);return b.useEffect(()=>{const c=h=>{const p=h.target;if(!(p instanceof HTMLElement))return;const m=p.tagName.toLowerCase();if((p.isContentEditable||m==="input"||m==="textarea"||m==="select")&&o(!0),p instanceof HTMLTextAreaElement){Uf(!0);const y=()=>m5(p,"smooth","focus");s.current&&clearTimeout(s.current),a.current&&window.visualViewport&&(window.visualViewport.removeEventListener("resize",a.current),a.current=null),l.current&&(document.removeEventListener("selectionchange",l.current),l.current=null);const x=()=>{document.activeElement===p&&(y(),l.current&&(document.removeEventListener("selectionchange",l.current),l.current=null))};if(l.current=x,document.addEventListener("selectionchange",x),setTimeout(()=>{l.current&&(document.removeEventListener("selectionchange",l.current),l.current=null)},1200),window.visualViewport){let v=!1;const C=()=>{v=!0,y(),a.current&&(window.visualViewport?.removeEventListener("resize",a.current),a.current=null)};a.current=C,window.visualViewport.addEventListener("resize",C),s.current=setTimeout(()=>{v||y(),setTimeout(y,300),a.current&&(window.visualViewport?.removeEventListener("resize",a.current),a.current=null)},600)}else requestAnimationFrame(y)}},d=()=>{const h=document.activeElement;if(!(h instanceof HTMLElement)){o(!1),Uf(!1),l.current&&(document.removeEventListener("selectionchange",l.current),l.current=null);return}const p=h.tagName.toLowerCase(),m=h.isContentEditable||p==="input"||p==="textarea"||p==="select";o(m),Uf(h instanceof HTMLTextAreaElement)};return document.addEventListener("focusin",c),document.addEventListener("focusout",d),()=>{document.removeEventListener("focusin",c),document.removeEventListener("focusout",d),s.current&&clearTimeout(s.current),a.current&&window.visualViewport&&(window.visualViewport.removeEventListener("resize",a.current),a.current=null),l.current&&(document.removeEventListener("selectionchange",l.current),l.current=null)}},[]),b.useEffect(()=>{const c=d=>{const p=d.detail?.textarea;p&&y5(p)};return document.addEventListener("textarea-align-header",c),()=>{document.removeEventListener("textarea-align-header",c)}},[]),{isInputFocused:n}}function v5({index:n,total:o,displayName:s}){return u.jsx("div",{id:"media-viewer-header",className:"absolute top-0 inset-x-0 px-3 pt-3 pb-4 bg-gradient-to-b from-black/50 to-transparent",children:u.jsxs("div",{className:"grid grid-cols-3 items-center",children:[u.jsxs("div",{className:"flex items-center gap-3 text-white text-sm",children:[n+1," / ",o]}),u.jsx("div",{className:"justify-self-center text-white/90 text-sm font-medium max-w-[70vw] truncate",children:s}),u.jsx("div",{})]})})}function w5({onClick:n}){return u.jsx("button",{type:"button",onClick:n,"aria-label":"Delete output",className:"pointer-events-auto w-9 h-9 rounded-full bg-black/40 text-red-500 flex items-center justify-center hover:bg-black/60 transition-colors",children:u.jsx(Ho,{className:"w-5 h-5"})})}function S5({onClick:n}){return u.jsx("button",{type:"button",onClick:n,"aria-label":"Load workflow",className:"pointer-events-auto w-9 h-9 rounded-full bg-black/40 text-white flex items-center justify-center hover:bg-black/60 transition-colors",children:u.jsx(Cs,{className:"w-5 h-5"})})}function N5({onClick:n}){return u.jsx("button",{type:"button",onClick:n,"aria-label":"Use in workflow",className:"pointer-events-auto w-9 h-9 rounded-full bg-black/40 text-white flex items-center justify-center hover:bg-black/60 transition-colors",children:u.jsx(Xb,{className:"w-5 h-5"})})}function C5({onClick:n,disabled:o}){return u.jsx("button",{type:"button",onClick:n,"aria-label":"Toggle metadata",className:`pointer-events-auto w-9 h-9 rounded-full bg-black/40 text-white flex items-center justify-center hover:bg-black/60 transition-colors ${o?"opacity-40":""}`,disabled:o,children:u.jsx(Qb,{className:"w-5 h-5"})})}function k5({isVideo:n,showMetadataToggle:o,canToggleMetadata:s,onDelete:a,onLoadWorkflow:l,onUseInWorkflow:c,onToggleMetadata:d}){return u.jsxs("div",{className:"absolute inset-x-0 px-3 pb-2 pt-2 flex items-center justify-between",style:{bottom:"calc(var(--bottom-bar-offset, 0px) + 4px)"},children:[u.jsx(w5,{onClick:a}),!n&&u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(S5,{onClick:l}),u.jsx(N5,{onClick:c}),o&&u.jsx(C5,{onClick:d,disabled:!s})]})]})}function j5({isVideo:n,showMetadataToggle:o,showMetadataOverlay:s,metadataIsLoading:a,metadata:l,durationLabel:c}){return o?u.jsx("div",{className:`absolute right-3 flex flex-col items-end gap-1 pointer-events-none transition-opacity duration-300 ${s?"opacity-100":"opacity-0"}`,style:{bottom:n?"calc(var(--bottom-bar-offset, 0px) + 120px)":"calc(var(--bottom-bar-offset, 0px) + 64px)"},children:a?u.jsx("div",{className:"px-1.5 py-0.5 bg-black/50 text-white text-[10px] rounded backdrop-blur-sm",children:"Loading metadata..."}):l?u.jsxs(u.Fragment,{children:[l.model&&u.jsxs("div",{className:"px-1.5 py-0.5 bg-black/50 text-white text-[10px] rounded backdrop-blur-sm",children:["model: ",l.model]}),l.sampler&&u.jsxs("div",{className:"px-1.5 py-0.5 bg-black/50 text-white text-[10px] rounded backdrop-blur-sm",children:["sampler: ",l.sampler]}),l.steps&&u.jsxs("div",{className:"px-1.5 py-0.5 bg-black/50 text-white text-[10px] rounded backdrop-blur-sm",children:["steps: ",l.steps]}),l.cfg&&u.jsxs("div",{className:"px-1.5 py-0.5 bg-black/50 text-white text-[10px] rounded backdrop-blur-sm",children:["cfg: ",l.cfg]}),c&&u.jsxs("div",{className:"px-1.5 py-0.5 bg-black/50 text-white text-[10px] rounded backdrop-blur-sm",children:["time: ",c]})]}):u.jsx("div",{className:"px-1.5 py-0.5 bg-black/50 text-white text-[10px] rounded backdrop-blur-sm",children:"No metadata found"})}):null}function Il(n){return n.id.startsWith("input/")?"input":n.id.startsWith("temp/")?"temp":"output"}function Ns(n,o){const a=`${o??Il(n)}/`;return n.id.startsWith(a)?n.id.slice(a.length):n.id}function M5(n){return`output-${n.replace(/[\\/]/g,"_")}.json`}async function iv(n){const{file:o,source:s,loadWorkflow:a,onLoaded:l,onError:c}=n;try{const d=s??Il(o),h=Ns(o,d),p=await n2(h,d);a(p,M5(h),{source:{type:"other"}}),l?.()}catch(d){throw c?.(d),d}}function O5(n){const{workflow:o,nodeTypes:s,nodeId:a}=n;if(!o||!s)return null;const l=o.nodes.find(d=>d.id===a);if(!l)return null;const c=["image","filename","file"];for(const d of c){const h=$n(o,s,l,d);if(h!==null)return{node:l,index:h,name:d}}return null}function Mb(n,o){const s=n.title,a=typeof s=="string"&&s.trim()?s.trim():null,l=o?.[n.type];return a||l?.display_name||n.type}const T5={x:0,y:0},xp=2100,Wf=xp+10;function uv({open:n,items:o,index:s,onIndexChange:a,onClose:l,onDelete:c,onLoadWorkflow:d,onLoadInWorkflow:h,showMetadataToggle:p=!1,showLoadingPlaceholder:m=!1,loadingProgress:y=0,loadingLabel:x,initialScale:v=1,initialTranslate:C=T5,onTransformChange:N,zoomResetKey:w}){const j=b.useRef(null),k=b.useRef(null),O=b.useRef(null),R=b.useRef(null),D=b.useRef(null),[I,H]=b.useState(1),[A,V]=b.useState({x:0,y:0}),J=b.useRef(1),X=b.useRef({x:0,y:0}),re=b.useRef(null),te=b.useRef(null),me=b.useRef(null),Te=b.useRef(null),[F,_]=b.useState(null),[q,de]=b.useState(null),[Me,Ne]=b.useState(!1),[M,L]=b.useState(!1),K=b.useRef(null),je=b.useRef("fit"),[We,Re]=b.useState({}),[Se,Ee]=b.useState({}),[xe,se]=b.useState(!1),{isInputFocused:Z}=lv(),T=s>=0?o[s]??o[0]??null:null,ie=T?.filename??T?.file?.name??T?.alt??T?.src??"",G=!!(T?.mediaType==="video"||T?.file?.type==="video"||ie&&aa(ie)),ge=T?.file?.id??null,B=ge?We[ge]:void 0,ne=T?.metadata??(B===void 0?void 0:B),W=E5(T?.durationSeconds),P=T?.filename||T?.alt||"Output",z=M&&!Me,$=p,ee=ge?!!Se[ge]:!1,pe=b.useCallback(()=>{Ne(!1),K.current&&clearTimeout(K.current),K.current=setTimeout(()=>{Ne(!0)},3e3)},[]),ae=b.useCallback(()=>{pe(),L(Pe=>!Pe)},[pe]),ke=b.useCallback(()=>{T&&(pe(),c(T))},[T,c,pe]),U=b.useCallback(()=>{T&&(pe(),d(T))},[T,d,pe]),ce=b.useCallback(()=>{T&&(pe(),h(T))},[T,h,pe]);b.useEffect(()=>(n?queueMicrotask(pe):K.current&&clearTimeout(K.current),()=>{K.current&&clearTimeout(K.current)}),[n,pe]),b.useLayoutEffect(()=>{n&&(H(v),V(C),J.current=v,X.current=C,re.current=null,te.current=null,me.current=null,Te.current=null,je.current="fit")},[n,s,v,C]),b.useEffect(()=>{D.current=null,_(null),se(!1)},[T?.src]),b.useEffect(()=>{if(n)return document.body.style.overflow="hidden",()=>{document.body.style.overflow=""}},[n]),b.useEffect(()=>{n&&N&&N(I,A)},[n,I,A,N]),b.useEffect(()=>{if(!n)return;const Pe=Fe=>{Fe.key==="Escape"&&l()};return document.addEventListener("keydown",Pe),()=>document.removeEventListener("keydown",Pe)},[n,l]),b.useEffect(()=>{if(!n||!p||!T?.file||T.metadata||!ge||ne!==void 0||ee)return;const Pe=Il(T.file),Fe=Ns(T.file,Pe);Ee(Ke=>({...Ke,[ge]:!0})),o2(Fe,Pe).then(Ke=>{const Je=Ke?.prompt?nh(Ke.prompt):null,mt=Je&&Object.keys(Je).length>0?Je:null;Re(Et=>({...Et,[ge]:mt}))}).catch(()=>{Re(Ke=>({...Ke,[ge]:null}))}).finally(()=>{Ee(Ke=>({...Ke,[ge]:!1}))})},[n,p,T,ge,ne,ee]);const He=b.useMemo(()=>!F||!q?null:q.height/F.height,[F,q]),Ve=b.useMemo(()=>He===null?1:Math.min(1,He),[He]),qe=b.useMemo(()=>He===null?1:Math.max(1,He),[He]),ot=(Pe=I,Fe=F)=>{if(!Fe||!q)return{x:0,y:0};const Ke=Fe.width*Pe,Je=Fe.height*Pe;return{x:Ke<q.width?(q.width-Ke)/2:0,y:Je<q.height?(q.height-Je)/2:0}},Ge=b.useCallback((Pe,Fe=I)=>{if(!F||!q)return Pe;const Ke=q.width,Je=q.height,mt=F.width*Fe,Et=F.height*Fe,be=mt<=Ke?0:Math.max(Ke-mt,Math.min(0,Pe.x)),ye=Et<=Je?0:Math.max(Je-Et,Math.min(0,Pe.y));return{x:be,y:ye}},[F,q,I]),Xe=b.useRef(Ge),Ie=b.useCallback(Pe=>{let Fe=Ve;if(Pe==="cover"?Fe=qe:Fe=Ve,je.current=Pe,J.current=Fe,H(Fe),!F||!q)X.current={x:0,y:0},V({x:0,y:0});else{const Ke=F.width*Fe,Je=F.height*Fe,mt={x:(q.width-Ke)/2,y:(q.height-Je)/2},Et=Ge(mt,Fe);X.current=Et,V(Et)}},[F,Ge,q,qe,Ve]),_e=b.useRef(Ie);b.useEffect(()=>{Xe.current=Ge},[Ge]),b.useEffect(()=>{_e.current=Ie},[Ie]);const Ze=Pe=>{const Fe=Pe.currentTarget;D.current={width:Fe.naturalWidth,height:Fe.naturalHeight};const Ke=k.current;if(!Ke||Fe.naturalWidth===0)return;const Je=Ke.clientWidth,mt=Ke.clientHeight,Et=Je/Fe.naturalWidth;_({width:Je,height:Fe.naturalHeight*Et}),de({width:Je,height:mt})};b.useEffect(()=>{if(G||!n)return;const Pe=O.current,Fe=k.current;if(!Pe||!Fe)return;const Ke=()=>{const mt=D.current,Et=Fe.clientWidth,be=Fe.clientHeight;if(de({width:Et,height:be}),!mt||mt.width===0)return;const ye=Et/mt.width,De=mt.height*ye;_({width:Et,height:De});const Ye=Xe.current(X.current);X.current=Ye,V(Ye)};Ke();const Je=new ResizeObserver(Ke);return Je.observe(Fe),()=>Je.disconnect()},[n,T?.src,G]),b.useEffect(()=>{G||!n||!F||!q||_e.current(je.current)},[n,T?.src,F,q,G]),b.useEffect(()=>{n&&w!==void 0&&_e.current(je.current)},[n,w]);const wt=()=>{const Pe=O.current;if(!Pe)return;const Fe=J.current,Ke=X.current,Je=ot(Fe);Pe.style.transform=`translate3d(${Je.x+Ke.x}px, ${Je.y+Ke.y}px, 0) scale(${Fe})`},pt=Pe=>{if(G){const Ke=R.current;if(Ke&&Pe.target===Ke){const Je=Ke.getBoundingClientRect();if(Pe.clientY>Je.bottom-60)return}}Pe.currentTarget.setPointerCapture(Pe.pointerId);const Fe=Ff(k.current);if(Fe.set(Pe.pointerId,{x:Pe.clientX,y:Pe.clientY}),Fe.size===1){if(te.current={x:Pe.clientX,y:Pe.clientY,time:Date.now()},!G){re.current={x:Pe.clientX-X.current.x,y:Pe.clientY-X.current.y};const Ke=O.current;Ke&&(Ke.style.transition="none")}}else if(Fe.size===2&&!G){const[Ke,Je]=Array.from(Fe.values()),mt=Math.hypot(Je.x-Ke.x,Je.y-Ke.y),Et=(Ke.x+Je.x)/2,be=(Ke.y+Je.y)/2,ye=k.current?.getBoundingClientRect(),De=J.current,Ye=X.current,et=ot(De),rt=ye?{x:(Et-ye.left-et.x-Ye.x)/De,y:(be-ye.top-et.y-Ye.y)/De}:void 0;me.current={distance:mt,scale:De,centerX:Et,centerY:be,imagePoint:rt}}},Lt=Pe=>{const Fe=Ff(k.current);if(Fe.has(Pe.pointerId)){if(Fe.set(Pe.pointerId,{x:Pe.clientX,y:Pe.clientY}),Fe.size===2&&me.current&&!G){const Ke=me.current,[Je,mt]=Array.from(Fe.values()),Et=Math.hypot(mt.x-Je.x,mt.y-Je.y),ye=Math.max(Ve,Math.min(5,Ke.scale*(Et/Ke.distance)));J.current=ye;const De=k.current?.getBoundingClientRect(),Ye=(Je.x+mt.x)/2,et=(Je.y+mt.y)/2;if(De&&Ke.imagePoint){const rt=ot(ye),Be={x:Ye-De.left-rt.x-Ke.imagePoint.x*ye,y:et-De.top-rt.y-Ke.imagePoint.y*ye};X.current=Ge(Be,ye)}else X.current=Ge(X.current,ye);wt();return}if(Fe.size===1&&!G){const Ke=J.current;(Ke>1||F&&k.current&&F.height*Ke>k.current.clientHeight+1)&&re.current&&(X.current=Ge({x:Pe.clientX-re.current.x,y:Pe.clientY-re.current.y},Ke),wt())}}},_t=Pe=>{const Fe=Ff(k.current);if(Fe.delete(Pe.pointerId),Fe.size<2){if(Fe.size===1&&me.current){const[Ke]=Array.from(Fe.values());re.current={x:Ke.x-X.current.x,y:Ke.y-X.current.y}}me.current=null}if(Fe.size===0){const Ke=O.current;Ke&&(Ke.style.transition="transform 0.05s linear");const Je=Date.now(),mt=Te.current,Et=mt?Pe.clientX-mt.x:0,be=mt?Pe.clientY-mt.y:0,ye=!!(mt&&Je-mt.time<300&&Math.hypot(Et,be)<24);if(!G&&ye){Te.current=null;const De=je.current;Ie(De==="fit"?"cover":"fit"),pe()}else{Te.current={time:Je,x:Pe.clientX,y:Pe.clientY};const De=te.current;if(!Z&&De){const Ye=Pe.clientX-De.x,et=Pe.clientY-De.y,rt=Date.now()-De.time,Be=Math.abs(Ye),ct=Math.abs(et),St=J.current,bt=Math.abs(St-Ve)<.05||Math.abs(St-qe)<.05,lt=rt<250&&Be<10&&ct<10;rt<=350&&Be>60&&Be>ct&&bt?Ye<0?s<o.length-1&&a(s+1):Ye>0&&s>0&&a(s-1):lt&&pe()}H(J.current),V(X.current)}re.current=null}},Vt=b.useCallback(Pe=>{if(G||!Pe.ctrlKey)return;Pe.preventDefault();const Fe=-Pe.deltaY*.005,Ke=Math.max(Ve,Math.min(5,J.current+Fe));J.current=Ke,H(Ke);const Je=Ge(X.current,Ke);X.current=Je,V(Je)},[Ge,Ve,G]);return b.useEffect(()=>{const Pe=j.current;if(Pe)return Pe.addEventListener("wheel",Vt,{passive:!1}),()=>{Pe.removeEventListener("wheel",Vt)}},[Vt]),n?!T&&!m?_n.createPortal(u.jsxs("div",{className:"fixed inset-0 bg-black flex flex-col items-center justify-center text-white",style:{zIndex:xp},role:"dialog","aria-modal":"true",children:[u.jsx(Ml,{onClick:l,buttonSize:9,iconSize:6,zIndex:Wf}),u.jsx("p",{className:"text-gray-400 mb-2",children:"No images to display"}),u.jsxs("p",{className:"text-gray-500 text-sm",children:["images: ",o.length,", index: ",s]})]}),document.body):_n.createPortal(u.jsxs("div",{ref:j,id:"media-viewer-overlay",className:"fixed inset-0 bg-black",style:{zIndex:xp},children:[u.jsx("div",{ref:k,className:`absolute inset-x-0 top-0 overflow-hidden ${G?"":"touch-none"}`,style:{overscrollBehavior:"contain",height:"calc(100vh - var(--bottom-bar-offset, 0px))",zIndex:1},onPointerDown:pt,onPointerMove:Lt,onPointerUp:_t,onPointerCancel:_t,children:m?u.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center text-white",children:[u.jsx("div",{className:"w-12 h-12 border-4 border-gray-600 border-t-white rounded-full animate-spin"}),u.jsx("div",{className:"mt-4 w-48 h-2 rounded-full bg-gray-700 overflow-hidden",children:u.jsx("div",{className:"h-full bg-white transition-all duration-300",style:{width:`${Math.min(100,Math.max(0,y))}%`}})}),u.jsx("div",{className:"mt-2 text-sm text-gray-300",children:x??`${Math.min(100,Math.max(0,y))}%`})]}):T&&u.jsx(u.Fragment,{children:G?u.jsxs(u.Fragment,{children:[u.jsx("video",{ref:R,src:T.src,controls:!0,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,className:"w-full h-full object-contain select-none",onDragStart:Pe=>Pe.preventDefault(),onError:()=>se(!0)}),xe&&u.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-white text-sm bg-black/60",children:"Unable to play this video."})]}):u.jsx("img",{ref:O,src:T.src,alt:T.alt||"Generation",className:"w-full h-auto block select-none relative",draggable:!1,onLoad:Ze,style:{transform:`translate3d(${ot(I).x+A.x}px, ${ot(I).y+A.y}px, 0) scale(${I})`,transformOrigin:"top left",willChange:"transform",backfaceVisibility:"hidden",WebkitBackfaceVisibility:"hidden"}})})}),u.jsx(Ml,{onClick:l,buttonSize:9,iconSize:6,isIdle:Me,zIndex:Wf}),u.jsx("div",{className:`absolute inset-0 pointer-events-none transition-opacity duration-300 ${Me?"opacity-0":"opacity-100"}`,style:{zIndex:Wf},children:T&&u.jsxs(u.Fragment,{children:[u.jsx(v5,{index:s,total:o.length,displayName:P}),u.jsx(k5,{isVideo:G,showMetadataToggle:p,canToggleMetadata:$,onDelete:ke,onLoadWorkflow:U,onUseInWorkflow:ce,onToggleMetadata:ae}),u.jsx(j5,{isVideo:G,showMetadataToggle:p,showMetadataOverlay:z,metadataIsLoading:ee,metadata:ne,durationLabel:W})]})})]}),document.body):null}function Ff(n){const o=n;return o?(o.__activePointers||(o.__activePointers=new Map),o.__activePointers):new Map}function E5(n){const o=n===void 0||Number.isNaN(n)?0:n;return o===0?"":o<10?`${o.toFixed(1)}s`:`${Math.round(o)}s`}function I5(n){const o=n.replace(/^\/+/,""),s=o.split("/").filter(Boolean);return s.length<=1?{filename:o,subfolder:""}:{filename:s.pop()??o,subfolder:s.join("/")}}async function L5(n,o){if(o==="input")return Ns(n,o);const s=Ns(n,o),{filename:a,subfolder:l}=I5(s),c=n.fullUrl||mo(a,l,o),d=await fetch(c);if(!d.ok)throw new Error("Failed to fetch image data.");const h=await d.blob(),p=a||n.name||"image.png",m=new File([h],p,{type:h.type||"image/png"}),y=await Vb(m,{type:"input",overwrite:!0}),x=y.subfolder?`${y.subfolder}/${y.name}`:y.name;if(!(await fetch(mo(y.name,y.subfolder??"","input"))).ok)throw new Error("Uploaded image was not found in inputs.");return x}function cv({open:n,file:o,source:s,onClose:a,onLoaded:l}){const c=fe(O=>O.workflow),d=fe(O=>O.nodeTypes),h=fe(O=>O.setNodeTypes),p=fe(O=>O.updateNodeWidget),m=pn(O=>O.clearNodeError),y=fe(O=>O.scrollToNode),x=oo(O=>O.setCurrentPanel),[v,C]=b.useState(null),[N,w]=b.useState(null),j=b.useMemo(()=>c?c.nodes.filter(O=>/loadimage/i.test(O.type)).map(O=>({node:O,stableKey:O.stableKey??null})).filter(O=>O.stableKey!==null):[],[c]);b.useEffect(()=>{n||(C(null),w(null))},[n]);const k=async O=>{if(!(!o||!c)){w(O),C(null);try{const R=c.nodes.find(H=>H.stableKey===O);if(!R)throw new Error("Could not resolve selected node.");const D=O5({workflow:c,nodeTypes:d,nodeId:R.id});if(!D)throw new Error("Selected node does not accept image inputs.");const I=await L5(o,s);if(s!=="input")try{const H=await Op();h(H)}catch(H){console.warn("Failed to refresh node types after upload:",H)}p(O,D.index,I,D.name),m(D.node.id),x("workflow"),l?.(),setTimeout(()=>{y(O,Mb(D.node,d))},150)}catch(R){console.error("Failed to load image into node:",R),C(R instanceof Error?R.message:"Failed to load image.")}finally{w(null)}}};return!n||!o?null:u.jsx("div",{id:"outputs-load-node-overlay",className:"fixed inset-0 z-[2150] bg-black/50 flex items-center justify-center p-4",onClick:a,role:"dialog","aria-modal":"true",children:u.jsxs("div",{id:"outputs-load-node-modal",className:"w-full max-w-sm bg-white border border-gray-200 rounded-xl shadow-lg overflow-hidden",onClick:O=>O.stopPropagation(),children:[u.jsx("div",{className:"px-4 py-3 text-sm font-semibold text-gray-700 border-b border-gray-100",children:"Load image into node"}),u.jsx("div",{className:"px-4 pt-3 text-xs text-gray-500",children:o.name}),u.jsxs("div",{className:"max-h-[50vh] overflow-y-auto",children:[j.length===0&&u.jsx("div",{className:"px-4 py-3 text-sm text-gray-400",children:"No Load Image nodes found in the current workflow."}),j.map(({node:O,stableKey:R})=>{const D=Mb(O,d),I=N===R;return u.jsxs("button",{className:"w-full text-left px-4 py-3 text-sm hover:bg-gray-50 flex items-center gap-2 disabled:opacity-60 disabled:cursor-not-allowed",onClick:()=>k(R),disabled:N!==null,children:[u.jsxs("span",{className:"text-gray-500 dark:text-gray-300",children:["#",O.id]}),u.jsx("span",{className:"flex-1 text-gray-900 dark:text-gray-100 truncate",children:D}),I&&u.jsx("span",{className:"text-xs text-gray-400",children:"Loading"})]},`load-node-${R}`)})]}),v&&u.jsx("div",{className:"px-4 py-2 text-xs text-red-600 border-t border-gray-100",children:v}),u.jsx("div",{className:"px-4 py-3 border-t border-gray-100 flex justify-end",children:u.jsx("button",{className:"px-3 py-2 text-sm font-medium text-gray-600 hover:bg-gray-100 rounded-lg disabled:opacity-60",onClick:a,disabled:N!==null,children:"Close"})})]})})}function _5({onClose:n}){const o=To(Se=>Se.viewerOpen),s=To(Se=>Se.viewerImages),a=To(Se=>Se.viewerIndex),l=To(Se=>Se.viewerScale),c=To(Se=>Se.viewerTranslate),d=fe(Se=>Se.followQueue),h=To(Se=>Se.setViewerState),p=fe(Se=>Se.workflow),m=fe(Se=>Se.originalWorkflow),y=fe(Se=>Se.workflowDurationStats),x=fe(Se=>Se.isExecuting),v=fe(Se=>Se.executingPromptId),C=oo(Se=>Se.setCurrentPanel),N=fe(Se=>Se.loadWorkflow),w=Ht(Se=>Se.running),j=Yn(Se=>Se.history),[k,O]=b.useState(null),[R,D]=b.useState(null),[I,H]=b.useState(null),[A,V]=b.useState(!1),J=b.useRef(null),X=b.useMemo(()=>!!(p&&m&&JSON.stringify(p)!==JSON.stringify(m)),[p,m]),re=b.useMemo(()=>!o||!d?null:j[0]?.prompt_id??null,[o,d,j]),te=v||(w.length===1?w[0].prompt_id:null),me=Hl({workflow:p,runKey:te,isRunning:x||w.length>0,workflowDurationStats:y}),Te=x||w.length>0,F=Math.min(100,Math.max(0,me??0)),q=!(a>=0?s[a]??s[0]??null:null)&&(d||Te)||a<0&&Te;b.useEffect(()=>{if(!o||!d){J.current=null;return}!J.current&&j[0]?.prompt_id&&(J.current=j[0]?.prompt_id??null)},[o,d,j]),b.useEffect(()=>{if(!o||!d||j.length===0)return;const Se=j[0];if(J.current===Se.prompt_id||Se.outputs.images.length===0)return;const Ee=oh(j,{alt:"Generation"});Ee.length!==0&&(J.current=Se.prompt_id,h({viewerImages:Ee,viewerIndex:0,viewerScale:1,viewerTranslate:{x:0,y:0}}))},[o,d,j,h]);const de=Se=>{h({viewerIndex:Se})},Me=(Se,Ee)=>{h({viewerScale:Se,viewerTranslate:Ee})},Ne=Se=>{Se.file&&O(Se.file)},M=async()=>{if(!k)return;const Se=k;try{const Ee=Ns(Se);await Xf(Ee,Il(Se));const xe=s.filter(T=>T.file?.id!==Se.id),se=s.findIndex(T=>T.file?.id===Se.id),Z=xe.length===0?0:se<0?a:se<a?a-1:se===a?Math.min(a,xe.length-1):a;h({viewerImages:xe,viewerIndex:Z}),xe.length===0&&n()}catch(Ee){console.error("Failed to delete file:",Ee),window.alert("Failed to delete file.")}finally{O(null)}},L=Se=>{if(Se.file){if(X){D(Se.file);return}K(Se.file)}},K=async Se=>{try{await iv({file:Se,loadWorkflow:N,onLoaded:()=>{n(),queueMicrotask(()=>C("workflow"))}})}catch(Ee){console.error("Failed to load workflow from file:",Ee),window.alert("Failed to load workflow from file.")}finally{D(null)}},je=Se=>{!Se.file||Se.file.type!=="image"||(H(Se.file),V(!0))},We=()=>{V(!1),H(null)},Re=()=>{We(),n(),queueMicrotask(()=>C("workflow"))};return o?u.jsxs(u.Fragment,{children:[u.jsx(uv,{open:o,items:s,index:a,onIndexChange:de,onClose:n,onDelete:Ne,onLoadWorkflow:L,onLoadInWorkflow:je,showMetadataToggle:!0,showLoadingPlaceholder:q,loadingProgress:F,loadingLabel:Te?`${F}%`:"Waiting for output",initialScale:l,initialTranslate:c,onTransformChange:Me,zoomResetKey:re}),R&&_n.createPortal(u.jsx(Yo,{onClose:()=>D(null),title:"Unsaved changes",description:"Are you sure you want to load this workflow? You have unsaved changes.",actions:[{label:"Cancel",onClick:()=>D(null),className:"px-3 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-100"},{label:"Continue",onClick:()=>{(async()=>(await K(R),D(null)))()},className:"px-3 py-2 rounded-lg text-sm font-medium text-white bg-red-600 hover:bg-red-700"}]}),document.body),u.jsx(cv,{open:A,file:I,source:I?Il(I):"output",onClose:We,onLoaded:Re}),k&&_n.createPortal(u.jsx(Yo,{onClose:()=>O(null),title:"Delete file?",description:`This will permanently delete "${k.name}" from the server. This cannot be undone.`,actions:[{label:"Cancel",onClick:()=>O(null),className:"px-3 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-100"},{label:"Delete",onClick:()=>{M()},className:"px-3 py-2 rounded-lg text-sm font-medium text-white bg-red-600 hover:bg-red-700"}]}),document.body)]}):null}function A5(n){const o=["text","string","strings","result","value","__value__","ui"],s=new Set(["images","image","videos","video","gifs","audio","filename","filenames","subfolder","type"]),a=(l,c,d)=>{if(c>5||l==null||d&&s.has(d))return null;if(typeof l=="string"){const h=l.trim();return h||null}if(Array.isArray(l)){for(const h of l){const p=a(h,c+1,d);if(p)return p}return null}if(typeof l=="object"){const h=l;for(const p of o){if(!(p in h))continue;const m=a(h[p],c+1,p);if(m)return m}}return null};return a(n,0)}function R5(){const[n,o]=b.useState(!1),s=b.useRef(null),a=b.useRef(null),l=b.useRef({}),c=b.useRef({setExecutionState:fe.getState().setExecutionState,setNodeOutput:fe.getState().setNodeOutput,setNodeTextOutput:fe.getState().setNodeTextOutput,clearNodeOutputs:fe.getState().clearNodeOutputs,addPromptOutputs:fe.getState().addPromptOutputs,clearPromptOutputs:fe.getState().clearPromptOutputs,applyControlAfterGenerate:fe.getState().applyControlAfterGenerate,applyLoraCodeUpdate:hr.getState().applyLoraCodeUpdate,applyTriggerWordUpdate:hr.getState().applyTriggerWordUpdate,applyWidgetUpdate:hr.getState().applyWidgetUpdate,registerLoraManagerNodes:hr.getState().registerLoraManagerNodes,updateFromStatus:Ht.getState().updateFromStatus,fetchQueue:Ht.getState().fetchQueue,addHistoryEntry:Yn.getState().addHistoryEntry,fetchHistory:Yn.getState().fetchHistory});b.useEffect(()=>{c.current={setExecutionState:fe.getState().setExecutionState,setNodeOutput:fe.getState().setNodeOutput,setNodeTextOutput:fe.getState().setNodeTextOutput,clearNodeOutputs:fe.getState().clearNodeOutputs,addPromptOutputs:fe.getState().addPromptOutputs,clearPromptOutputs:fe.getState().clearPromptOutputs,applyControlAfterGenerate:fe.getState().applyControlAfterGenerate,applyLoraCodeUpdate:hr.getState().applyLoraCodeUpdate,applyTriggerWordUpdate:hr.getState().applyTriggerWordUpdate,applyWidgetUpdate:hr.getState().applyWidgetUpdate,registerLoraManagerNodes:hr.getState().registerLoraManagerNodes,updateFromStatus:Ht.getState().updateFromStatus,fetchQueue:Ht.getState().fetchQueue,addHistoryEntry:Yn.getState().addHistoryEntry,fetchHistory:Yn.getState().fetchHistory}},[]);const d=b.useRef(null);return b.useEffect(()=>{const h=v=>{if(v==null)return null;const C=Number(v);if(!Number.isFinite(C))return null;const w=fe.getState().workflow;if(!w)return null;let j=w.nodes.filter(O=>O.id===C);return j.length===0&&(j=w.nodes.filter(O=>{const R=O.properties?.__mobile_origin;if(!R||typeof R!="object")return!1;const D=R.nodeId;return Number(D)===C})),j.length===0?null:(j.find(O=>O.stableKey)??j[0])?.stableKey??null},p=v=>{if(v==null)return[];const C=Number(v);if(!Number.isFinite(C))return[];const w=fe.getState().workflow;if(!w)return[];const j=new Set,k=w.nodes.filter(R=>R.id===C);k.forEach(R=>{R.stableKey&&j.add(R.stableKey)}),w.nodes.filter(R=>{const D=R.properties?.__mobile_origin;if(!D||typeof D!="object")return!1;const I=D.nodeId;return Number(I)===C}).forEach(R=>{R.stableKey&&j.add(R.stableKey)});for(const R of k){const D=R.properties?.__mobile_origin;if(!D||typeof D!="object")continue;const I=Number(D.nodeId);Number.isFinite(I)&&w.nodes.filter(H=>H.id===I).forEach(H=>{H.stableKey&&j.add(H.stableKey)})}return Array.from(j)},m=v=>{const{setExecutionState:C,setNodeOutput:N,setNodeTextOutput:w,addPromptOutputs:j,clearPromptOutputs:k,updateFromStatus:O,fetchQueue:R,addHistoryEntry:D,fetchHistory:I,applyLoraCodeUpdate:H,applyTriggerWordUpdate:A,applyWidgetUpdate:V,registerLoraManagerNodes:J}=c.current,X=v;switch(X.type){case"status":{const te=X.data.status.exec_info.queue_remaining;O(te),te===0&&C(!1,null,null,0);break}case"progress":{const re=X,{value:te,max:me,node:Te,prompt_id:F}=re.data,_=Math.round(te/me*100);C(!0,h(Te),F||null,_);break}case"executing":{const re=X,te=re.data.node,me=re.data.prompt_id;if(te===null){if(C(!1,null,null,0),c.current.applyControlAfterGenerate(),me){const Te=Ht.getState().running.find(_=>_.prompt_id===me),F=l.current[me]||[];Te&&D({prompt_id:me,timestamp:Date.now(),outputs:{images:F},prompt:Te.prompt}),delete l.current[me],k(me)}R(),I()}else{me&&me!==d.current&&(d.current=me),C(!0,h(te),me||null,0);const Te=Ht.getState();me&&!Te.running.some(F=>F.prompt_id===me)&&R()}break}case"executed":{const re=X,{node:te,prompt_id:me,output:Te}=re.data,F=h(te),_=p(te);Te.images&&(l.current[me]||(l.current[me]=[]),l.current[me].push(...Te.images),j(me,Te.images),F&&N(F,Te.images));const q=A5(Te);q&&_.length>0&&_.forEach(de=>{w(de,q)});break}case"execution_error":{C(!1,null,null,0),k(),R(),I();break}case"execution_cached":break;case"lora_code_update":{H?.(X.data);break}case"trigger_word_update":{A?.(X.data);break}case"lm_widget_update":{V?.(X.data);break}case"lora_registry_refresh":{J?.();break}}},y=()=>{s.current?.readyState!==WebSocket.OPEN&&(s.current=e2(Bb,m,async()=>{o(!0);const{fetchQueue:v,fetchHistory:C,setExecutionState:N}=c.current;await v(),C();const w=Ht.getState(),j=fe.getState();if(w.running.length>0&&!j.executingPromptId){const k=w.running[0];N(!0,null,k.prompt_id,0)}},()=>{o(!1),a.current=setTimeout(y,2e3)},()=>{o(!1)}))};y();const x=setInterval(()=>{const{fetchQueue:v,fetchHistory:C}=c.current;Ht.getState().running.length>0&&(v(),C())},2e3);return()=>{a.current&&clearTimeout(a.current),s.current&&s.current.close(),clearInterval(x)}},[]),{isConnected:n}}function D5({onSwipeLeft:n,onSwipeRight:o,onSwipeUp:s,onSwipeDown:a,enabled:l=!0,threshold:c=50,preventScroll:d=!0,deferResetOnSwipe:h=!1,deferResetDurationMs:p=350}){const[m,y]=b.useState(0),[x,v]=b.useState(!1),[C,N]=b.useState(l),w=b.useRef(null),j=b.useRef(null);b.useEffect(()=>{N(l)},[l]);const k=b.useCallback(()=>{w.current=null,v(!1),y(0)},[]),O=b.useCallback(R=>{N(R)},[]);return b.useEffect(()=>{if(!C)return;const R=A=>{if(!(A instanceof HTMLElement))return!1;if(A.isContentEditable)return!0;const V=A.tagName.toLowerCase();return V==="input"||V==="textarea"||V==="select"},D=A=>{if(R(A.target)||R(document.activeElement))return;j.current!==null&&(window.clearTimeout(j.current),j.current=null);const V=A.touches[0];w.current={startX:V.clientX,startY:V.clientY,currentX:V.clientX,currentY:V.clientY,isHorizontal:null,isTracking:!0}},I=A=>{const V=w.current;if(!V?.isTracking)return;const J=A.touches[0],X=J.clientX-V.startX,re=J.clientY-V.startY;if(V.isHorizontal===null){if(Math.abs(X)>20||Math.abs(re)>20){const te=Math.abs(X)>Math.abs(re);V.isHorizontal=te,te?(X>0?!!o:!!n)?v(!0):V.isTracking=!1:(re>0?a:s)||(V.isTracking=!1)}return}V.isHorizontal?(d&&A.cancelable&&A.preventDefault(),V.currentX=J.clientX,y(J.clientX-V.startX)):V.currentY=J.clientY},H=()=>{const A=w.current;if(!A?.isTracking){k();return}const V=A.currentX-A.startX,J=A.currentY-A.startY,X=c||window.innerWidth*.25;let re=!1;A.isHorizontal===!0?V<-X&&n?(n(),re=!0):V>X&&o&&(o(),re=!0):A.isHorizontal===!1&&(J<-X&&s?(s(),re=!0):J>X&&a&&(a(),re=!0)),re?h?(w.current=null,v(!1),j.current!==null&&window.clearTimeout(j.current),j.current=window.setTimeout(()=>{k(),j.current=null},p)):requestAnimationFrame(()=>{k()}):k()};return document.addEventListener("touchstart",D,{passive:!0}),document.addEventListener("touchmove",I,{passive:!1}),document.addEventListener("touchend",H,{passive:!0}),document.addEventListener("touchcancel",H,{passive:!0}),()=>{document.removeEventListener("touchstart",D),document.removeEventListener("touchmove",I),document.removeEventListener("touchend",H),document.removeEventListener("touchcancel",H),j.current!==null&&(window.clearTimeout(j.current),j.current=null),k()}},[C,n,o,s,a,c,d,h,p,k]),{swipeOffset:m,isSwiping:x,setSwipeEnabled:O,resetSwipeState:k}}function Ob({idPrefix:n,title:o,items:s,selectedValue:a,onSelect:l,gridClassName:c="grid grid-cols-2 gap-2",buttonClassName:d=""}){return u.jsxs("div",{id:`${n}-container`,children:[u.jsx("h4",{id:`${n}-label`,className:"text-sm font-medium text-gray-700 mb-2",children:o}),u.jsx("div",{id:`${n}-options`,className:c,children:s.map(h=>{const p=a===h.value;return u.jsxs("button",{className:`px-3 py-2 rounded-lg text-sm border ${d} ${p?"bg-blue-500 border-blue-500 text-white shadow-sm":"border-gray-200 text-gray-700 hover:bg-gray-50"}`,onClick:()=>l(h.value),children:[h.label,p&&h.suffix?h.suffix:""]},h.value)})})]})}function B5({checked:n,onChange:o}){return u.jsxs("div",{id:"favorites-toggle-container",className:"flex items-center gap-2",children:[u.jsx("input",{type:"checkbox",id:"favOnly",checked:n,onChange:s=>o(s.target.checked),className:"rounded text-blue-600 focus:ring-blue-500"}),u.jsx("label",{htmlFor:"favOnly",className:"text-sm text-gray-700",children:"Show Favorites Only"})]})}function z5({open:n,onClose:o,filter:s,sort:a,onChangeFilter:l,onChangeSort:c}){if(!n)return null;const d=a?.mode||"modified",h=d.includes("name")?"name":d.includes("size")?"size":"date",p=(()=>{const y=d.endsWith("reverse");return h==="date"?y?"asc":"desc":y?"desc":"asc"})(),m=(y,x)=>{let v;y==="name"?v=x==="asc"?"name":"name-reverse":y==="size"?v=x==="asc"?"size":"size-reverse":v=x==="desc"?"modified":"modified-reverse",c({mode:v})};return u.jsx("div",{id:"filter-modal-root",className:"fixed inset-0 z-[1600] bg-black/50 flex items-center justify-center p-4",onClick:o,children:u.jsxs("div",{id:"filter-modal-content",className:"bg-white rounded-xl shadow-lg w-full max-w-sm max-h-[90vh] overflow-y-auto",onClick:y=>y.stopPropagation(),children:[u.jsxs("div",{id:"filter-modal-header",className:"p-4 border-b border-gray-100 flex items-center justify-between",children:[u.jsx("h3",{id:"filter-modal-title",className:"font-semibold text-gray-900",children:"Filter & Sort"}),u.jsx(Ml,{variant:"plain",onClick:o,buttonSize:8,iconSize:6})]}),u.jsxs("div",{id:"filter-modal-body",className:"p-4 space-y-6",children:[u.jsx(Ob,{idPrefix:"sort-group",title:"Sort By",items:[{value:"name",label:"Name",suffix:h==="name"?p==="asc"?" ":" ":void 0},{value:"date",label:"Date",suffix:h==="date"?p==="asc"?" ":" ":void 0},{value:"size",label:"Size",suffix:h==="size"?p==="asc"?" ":" ":void 0}],selectedValue:h,onSelect:y=>{m(y,h===y?p==="asc"?"desc":"asc":y==="name"?"asc":"desc")}}),u.jsx(Ob,{idPrefix:"filter-type-group",title:"File Type",items:[{value:"all",label:"All"},{value:"image",label:"Image"},{value:"video",label:"Video"}],selectedValue:s.type,onSelect:y=>l({type:y}),gridClassName:"flex gap-2",buttonClassName:"flex-1"}),u.jsxs("div",{id:"search-input-container",children:[u.jsx("label",{id:"search-input-label",className:"block text-sm font-medium text-gray-700 mb-1",children:"Search"}),u.jsx(zl,{placeholder:"Search by filename...",value:s.search,onChange:y=>l({search:y})})]}),u.jsx(B5,{checked:s.favoritesOnly,onChange:y=>l({favoritesOnly:y})})]}),u.jsx("div",{id:"filter-modal-footer",className:"p-4 border-t border-gray-100 bg-gray-50 flex justify-end",children:u.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700",onClick:o,children:"Apply"})})]})})}function vu({onClose:n,zIndex:o=2200,children:s}){return u.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4",style:{zIndex:o},onClick:n,role:"dialog","aria-modal":"true",children:u.jsx("div",{className:"w-full max-w-sm bg-white border border-gray-200 rounded-xl shadow-lg overflow-hidden",onClick:a=>a.stopPropagation(),children:s})})}function H5({breadcrumbs:n,selectionMode:o,selectedCount:s,onClearSelection:a}){return u.jsx("div",{id:"outputs-panel-header",className:"px-4 py-3 flex flex-col gap-3 border-b border-gray-100",children:u.jsxs("div",{id:"outputs-header-top-row",className:"flex items-center justify-between min-h-[24px]",children:[n,o&&u.jsxs("div",{className:"selection-status-container flex items-center gap-2 shrink-0 ml-2",children:[u.jsxs("span",{className:"text-[10px] font-bold text-blue-600 uppercase",children:[s," selected"]}),u.jsx("button",{onClick:a,className:"text-[10px] text-gray-500 underline uppercase font-bold",children:"Clear"})]})]})})}function vp({file:n,viewMode:o,selectionMode:s,isSelected:a,isFavorited:l,onNavigateFolder:c,onOpen:d,onMenu:h,onToggleSelection:p}){const m=n.type==="folder",[y,x]=b.useState(!1);b.useEffect(()=>{x(!1)},[n.previewUrl,n.id]);const v=()=>{s?p(n.id):m?c(n.name):d(n)},C=N=>{N.stopPropagation(),h(n,N)};return o==="list"?u.jsxs("div",{className:`file-card-list-item flex items-center gap-3 p-2 hover:bg-gray-50 border-b border-gray-100 last:border-0 ${a?"bg-blue-50":""}`,onClick:v,children:[s&&u.jsx("div",{className:`selection-checkbox w-5 h-5 rounded border flex items-center justify-center flex-shrink-0 ${a?"bg-blue-600 border-blue-600 text-white":"border-gray-300 bg-white"}`,children:a&&u.jsx(zo,{className:"w-3.5 h-3.5"})}),u.jsx("div",{className:`file-preview-container w-10 h-10 flex-shrink-0 flex items-center justify-center rounded text-gray-500 overflow-hidden relative ${m?"":"bg-gray-100"}`,children:m?u.jsx(mr,{className:"w-6 h-6 text-amber-500"}):n.previewUrl&&!y?u.jsx("img",{src:n.previewUrl,className:"w-full h-full object-cover",loading:"lazy",onError:()=>x(!0)}):n.type==="video"?u.jsx(wy,{className:"w-5 h-5 text-gray-500"}):u.jsx("span",{className:"text-xs font-bold",children:"IMG"})}),u.jsx("div",{className:"file-info-container flex-1 min-w-0",children:u.jsx("div",{className:"file-name text-sm font-medium text-gray-900 truncate",children:n.name})}),u.jsxs("div",{className:"file-actions-container flex items-center gap-2",children:[l&&u.jsx(Yr,{className:"w-4 h-4 text-yellow-500"}),u.jsx(Qr,{onClick:C,ariaLabel:"File options",buttonSize:8,iconSize:5})]})]}):u.jsxs("div",{className:"file-card-grid-item flex flex-col gap-1",children:[u.jsxs("div",{className:`relative aspect-square bg-gray-100 rounded-lg overflow-hidden transition-all ${a?"ring-4 ring-blue-500 ring-offset-2":""}`,onClick:v,children:[m?u.jsx("div",{className:"folder-grid-content w-full h-full flex flex-col items-center justify-center text-gray-500",children:u.jsx(mr,{className:"w-12 h-12 mb-2 text-amber-500"})}):n.previewUrl&&!y?u.jsx("img",{src:n.previewUrl,className:"w-full h-full object-cover",loading:"lazy",onError:()=>x(!0)}):u.jsx("div",{className:"media-placeholder w-full h-full flex items-center justify-center bg-gray-800 text-white font-bold",children:n.type==="video"?u.jsx(wy,{className:"w-10 h-10 text-white/80"}):"IMG"}),s?u.jsx("div",{className:"selection-badge-container absolute top-2 left-2",children:u.jsx("div",{className:`selection-badge w-6 h-6 rounded-full border-2 flex items-center justify-center shadow-sm ${a?"bg-blue-600 border-blue-600 text-white":"border-white bg-black/20"}`,children:a&&u.jsx(zo,{className:"w-4 h-4"})})}):u.jsxs("div",{className:"file-menu-trigger-container absolute top-1 right-1 flex flex-col items-center gap-1 text-white",children:[u.jsx(Qr,{onClick:C,ariaLabel:"File options",buttonSize:7,iconSize:4}),l&&u.jsx(Yr,{className:"w-4 h-4 text-yellow-400 drop-shadow"})]}),n.type==="video"&&u.jsx("div",{className:"video-label absolute top-1 left-1 bg-black/50 px-1 rounded text-[10px] text-white",children:"VID"})]}),u.jsx("div",{className:"file-name text-xs text-gray-700 truncate px-1",children:n.name})]})}function V5({folders:n,foldersCollapsed:o,toggleFoldersCollapsed:s,selectionMode:a,selectedIds:l,favorites:c,setCurrentFolder:d,handleOpen:h,handleMenu:p,toggleSelection:m}){return n.length===0?null:u.jsxs("div",{id:"outputs-folders-section",className:"mb-4",children:[u.jsxs("button",{onClick:s,className:"flex items-center gap-2 w-full text-left mb-2 py-1 text-sm font-medium text-gray-600 hover:text-gray-900",children:[o?u.jsx(Vp,{className:"w-4 h-4"}):u.jsx($u,{className:"w-4 h-4"}),u.jsxs("span",{children:["Folders (",n.length,")"]})]}),!o&&u.jsx("div",{className:"flex flex-col border border-gray-200 rounded-lg overflow-hidden",children:n.map(y=>u.jsx(vp,{file:y,viewMode:"list",selectionMode:a,isSelected:l.includes(y.id),isFavorited:c.includes(y.id),onNavigateFolder:d,onOpen:h,onMenu:p,onToggleSelection:m},y.id))})]})}function $5({fileSections:n,collapsedSections:o,viewMode:s,selectionMode:a,selectedIds:l,favorites:c,setCurrentFolder:d,handleOpen:h,handleMenu:p,toggleSelection:m,toggleSectionCollapsed:y,selectIds:x}){return u.jsx("div",{id:"outputs-files-section",className:"flex flex-col gap-4",children:n.map(v=>u.jsxs("div",{className:"flex flex-col gap-2",children:[u.jsxs("div",{className:"flex items-center justify-between gap-3",children:[u.jsxs("button",{className:"flex items-center gap-2 text-[11px] font-semibold uppercase tracking-wide text-gray-500 hover:text-gray-800",onClick:()=>y(v.key),children:[o[v.key]?u.jsx(Vp,{className:"w-3.5 h-3.5"}):u.jsx($u,{className:"w-3.5 h-3.5"}),u.jsxs("span",{children:[v.label," (",v.files.length,")"]})]}),a&&u.jsx("button",{className:"text-[10px] font-bold uppercase text-blue-600 hover:text-blue-700",onClick:()=>x(v.files.map(C=>C.id)),children:"Select all"})]}),!o[v.key]&&(s==="grid"?u.jsx("div",{className:"grid grid-cols-2 gap-4 auto-rows-min",children:v.files.map(C=>u.jsx(vp,{file:C,viewMode:s,selectionMode:a,isSelected:l.includes(C.id),isFavorited:c.includes(C.id),onNavigateFolder:d,onOpen:h,onMenu:p,onToggleSelection:m},C.id))}):u.jsx("div",{className:"flex flex-col",children:v.files.map(C=>u.jsx(vp,{file:C,viewMode:s,selectionMode:a,isSelected:l.includes(C.id),isFavorited:c.includes(C.id),onNavigateFolder:d,onOpen:h,onMenu:p,onToggleSelection:m},C.id))}))]},v.key))})}function K5({menuTarget:n,favorites:o,setMenuTarget:s,menuRef:a,menuStyle:l,handleFavorite:c,handleSelectSingle:d,handleMoveSingle:h,handleRenameRequest:p,handleLoadWorkflow:m,handleLoadInWorkflow:y,handleDeleteRequest:x}){if(!n)return null;const v=[{key:"favorite",label:o.includes(n.file.id)?"Unfavorite":"Favorite",icon:o.includes(n.file.id)?u.jsx(Yr,{className:"w-4 h-4"}):u.jsx(nc,{className:"w-4 h-4"}),onClick:()=>c()},{key:"select",label:"Select",icon:u.jsx(zo,{className:"w-4 h-4"}),onClick:()=>d()},{key:"move",label:"Move",icon:u.jsx(mr,{className:"w-4 h-4"}),onClick:()=>h()},{key:"rename",label:"Rename",icon:u.jsx(Bp,{className:"w-4 h-4"}),onClick:()=>p()},{key:"load-workflow",label:"Load workflow",icon:u.jsx(Cs,{className:"w-4 h-4"}),onClick:()=>m(),hidden:n.file.type!=="image"},{key:"use-in-workflow",label:"Use in workflow",icon:u.jsx(Xb,{className:"w-4 h-4"}),onClick:()=>y(),hidden:n.file.type!=="image"},{key:"delete",label:"Delete",icon:u.jsx(Ho,{className:"w-4 h-4"}),onClick:()=>x(),color:"danger"}];return u.jsxs(u.Fragment,{children:[u.jsx("div",{id:"outputs-context-menu-overlay",className:"fixed inset-0 z-[1690]",onClick:()=>s(null),onPointerDown:C=>C.stopPropagation()}),u.jsx("div",{id:"outputs-context-menu",ref:a,className:"fixed z-[1700] min-w-44 w-max",style:l,onPointerDown:C=>C.stopPropagation(),onClick:C=>C.stopPropagation(),children:u.jsx(xr,{items:v})})]})}const Tb="outputs-folders-collapsed",U5=1440*60*1e3;function W5(n){if(!n)return"Unknown date";const o=new Date,s=new Date(o.getFullYear(),o.getMonth(),o.getDate()),a=new Date(n),l=new Date(a.getFullYear(),a.getMonth(),a.getDate()),c=Math.round((s.getTime()-l.getTime())/U5);return c===0?"Today":c===1?"Yesterday":a.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})}function F5({visible:n}){const{source:o,currentFolder:s,isLoading:a,viewMode:l,showHidden:c,filter:d,sort:h,favorites:p,selectionMode:m,selectedIds:y,setCurrentFolder:x,navigateToPath:v,fetchFolders:C,fetchFiles:N,toggleFavorite:w,toggleSelection:j,getDisplayedFiles:k,refresh:O,selectIds:R,toggleSelectionMode:D,setFilter:I,setSort:H}=Xt(),A=Xt(Oe=>Oe.selectionActionOpen),V=Xt(Oe=>Oe.setSelectionActionOpen),J=Xt(Oe=>Oe.filterModalOpen),X=Xt(Oe=>Oe.setFilterModalOpen),re=Xt(Oe=>Oe.newFolderModalOpen),te=Xt(Oe=>Oe.setNewFolderModalOpen),me=Xt(Oe=>Oe.setOutputsViewerOpen),Te=Xt(Oe=>Oe.addFavorites),F=Xt(Oe=>Oe.removeFavorites),_=Xt(Oe=>Oe.clearSelection),q=fe(Oe=>Oe.loadWorkflow),de=oo(Oe=>Oe.setCurrentPanel),Me=fe(Oe=>Oe.workflow),Ne=fe(Oe=>Oe.originalWorkflow),M=b.useMemo(()=>!!(Me&&Ne&&JSON.stringify(Me)!==JSON.stringify(Ne)),[Me,Ne]),[L,K]=b.useState(null),[je,We]=b.useState(null),[Re,Se]=b.useState(null),[Ee,xe]=b.useState(null),[se,Z]=b.useState(!1),[T,ie]=b.useState(null),[G,ge]=b.useState(""),[B,ne]=b.useState(!1),[W,P]=b.useState(!1),[z,$]=b.useState(null),[ee,pe]=b.useState([]),[ae,ke]=b.useState(!1),[U,ce]=b.useState(""),[He,Ve]=b.useState([]),[qe,ot]=b.useState(null),[Ge,Xe]=b.useState(""),[Ie,_e]=b.useState(!1),[Ze,wt]=b.useState([]),[pt,Lt]=b.useState(0),_t=b.useRef(null),Vt=b.useRef(null),Pe=b.useRef(!1),[Fe,Ke]=b.useState(()=>localStorage.getItem(Tb)==="true"),[Je,mt]=b.useState({}),Et=b.useRef(null),be=b.useRef(null),ye=b.useRef(!1),De=()=>{We(null),Et.current=null},Ye=()=>{Z(!1),Se(null),be.current=null},et=(Oe,at)=>{Et.current=at?.onDeleted??null,We(Oe)},rt=(Oe,at)=>{Oe.type==="image"&&(be.current=at?.onLoaded??null,Se(Oe),Z(!0))},{menuStyle:Be,resetMenuPosition:ct}=Kp({open:!!L,buttonRef:Vt,menuRef:_t,repositionToken:L?.file.id,menuWidth:176,horizontalAnchorOffset:160,viewportPadding:8,bottomBarReserve:104});ya({open:!!L,onDismiss:()=>{K(null),ct()},triggerRef:Vt,contentRef:_t}),b.useEffect(()=>{Pe.current=!1},[o]),b.useEffect(()=>{n&&!Pe.current&&!a&&(Pe.current=!0,C(),N())},[n,C,N,a]),b.useEffect(()=>{!n&&Ie&&(_e(!1),me(!1))},[n,Ie,me]),b.useEffect(()=>{!n&&J&&X(!1)},[n,J,X]);const St=k(),bt=Xt(Oe=>Oe.sort.mode),lt=Oe=>{const yt=k().filter(Ft=>(Ft.type==="image"||Ft.type==="video")&&Ft.fullUrl),gn=yt.map(Ft=>({src:Ft.fullUrl,alt:Ft.name,mediaType:Vl(Ft.name),file:Ft,filename:Ft.name})),Mn=yt.findIndex(Ft=>Ft.id===Oe.id);Mn>=0&&(wt(gn),Lt(Mn),_e(!0),me(!0))},ht=()=>{_e(!1),me(!1)},Ct=Oe=>{Oe.file&&et(Oe.file,{onDeleted:at=>{wt(yt=>{const gn=yt.findIndex(Ft=>Ft.file?.id===at.id),Mn=yt.filter(Ft=>Ft.file?.id!==at.id);return Lt(Ft=>Mn.length===0?0:gn===-1?Ft:gn<Ft?Ft-1:gn===Ft?Math.min(Ft,Mn.length-1):Ft),Mn.length===0&&(_e(!1),me(!1)),Mn})}})},Nt=Oe=>{!Oe.file||Oe.file.type!=="image"||rt(Oe.file,{onLoaded:()=>{_e(!1),me(!1)}})},ut=Oe=>{Oe.file&&Kt(Oe.file,{closeViewer:!0})},{folders:At,nonFolders:tn}=b.useMemo(()=>{const Oe=[],at=[];for(const yt of St)yt.type==="folder"?Oe.push(yt):at.push(yt);return{folders:Oe,nonFolders:at}},[St]),kn=bt.startsWith("name"),nn=bt.startsWith("size"),Q=d.favoritesOnly||!kn&&!nn,Ae=b.useMemo(()=>{if(kn){const at=[];for(const yt of tn){const gn=yt.name?.trim()?.charAt(0).toUpperCase()||"#",Mn=`Starting with ${gn}`,Ft=at[at.length-1];Ft&&Ft.key===gn?Ft.files.push(yt):at.push({key:gn,label:Mn,files:[yt]})}return at}if(nn){const at=[];for(const yt of tn){const Mn=(yt.size??0)/(1024*1024),Ft=Mn<1?0:Math.round(Mn),xo=Ft===0?"<1MB":`${Ft}MB`,wa=Ft===0?"<1MB":`${Ft}MB`,Xr=at[at.length-1];Xr&&Xr.key===xo?Xr.files.push(yt):at.push({key:xo,label:wa,files:[yt]})}return at}if(!Q)return[{key:"all",label:"All files",files:tn}];const Oe=[];for(const at of tn){const yt=at.date?new Date(at.date).toISOString().slice(0,10):"unknown",gn=W5(at.date),Mn=Oe[Oe.length-1];Mn&&Mn.key===yt?Mn.files.push(at):Oe.push({key:yt,label:gn,files:[at]})}return Oe},[tn,Q,kn,nn]),le=()=>{const Oe=!Fe;Ke(Oe),localStorage.setItem(Tb,String(Oe))},st=Oe=>{mt(at=>({...at,[Oe]:!at[Oe]}))},nt=Oe=>{lt(Oe)},tt=(Oe,at)=>{at.preventDefault(),at.stopPropagation(),Vt.current=at.currentTarget,K({file:Oe})},Qe=()=>{L&&(w(L.file.id),K(null))},Mt=()=>{L&&(m||D(),R([L.file.id],"replace"),K(null))},gt=()=>{L&&L.file.type==="image"&&(Se(L.file),Z(!0),K(null))},xt=()=>{L&&(We(L.file),K(null))},ue=()=>{L&&(ie(L.file),ge(L.file.name),K(null))},vt=()=>{y.length!==0&&(V(!1),ne(!0))},dt=async(Oe,at)=>{try{await iv({file:Oe,source:o,loadWorkflow:q,onLoaded:()=>{de("workflow"),at?.closeViewer&&(_e(!1),me(!1))}})}catch(yt){console.error("Failed to load workflow from file:",yt),window.alert("Failed to load workflow from file.")}},Kt=(Oe,at)=>{if(Oe.type==="folder"){window.alert("Workflow metadata is not available for folders.");return}if(M){ye.current=!!at?.closeViewer,xe(Oe);return}dt(Oe,at)},Bt=()=>{if(!L)return;const Oe=L.file;K(null),Kt(Oe,{closeViewer:!1})},ln=async()=>{if(!Ee)return;const Oe=Ee,at=ye.current;ye.current=!1,xe(null),await dt(Oe,{closeViewer:at})},bn=()=>{ye.current=!1,xe(null)},jn=async()=>{if(!je)return;const Oe=je;try{const at=Ns(je,o);await Xf(at,o),O(),Et.current?.(Oe),Et.current=null}catch(at){console.error("Failed to delete file:",at),window.alert("Failed to delete file.")}finally{We(null)}},Kl=async()=>{if(y.length===0){ne(!1);return}try{const Oe=`${o}/`,at=y.map(yt=>yt.startsWith(Oe)?yt.slice(Oe.length):yt);await Promise.all(at.map(yt=>Xf(yt,o))),O(),_()}catch(Oe){console.error("Failed to delete selected files:",Oe),window.alert("Failed to delete selected files.")}finally{ne(!1)}},uc=()=>{if(y.length===0)return;y.every(at=>p.includes(at))?F(y):Te(y),V(!1)},xa=()=>{y.length!==0&&(V(!1),Ve([...y]),ot(s),$(s),P(!0))},Ul=()=>{L&&(Ve([L.file.id]),ot(s),$(s),P(!0),K(null))},Xo=()=>{ie(null),ge("")},Wl=async()=>{if(!T)return;const Oe=G.trim();if(Oe){if(Oe===T.name){Xo();return}try{const at=Ns(T,o);await s2(at,Oe,o),O(),Xo()}catch(at){console.error("Failed to rename item:",at),window.alert("Failed to rename item.")}}},Un=()=>{P(!1),Ve([]),ot(null)},va=async()=>{if(He.length!==0)try{const Oe=`${o}/`,at=He.map(yt=>yt.startsWith(Oe)?yt.slice(Oe.length):yt);await r2(at,z,o),O(),m&&(_(),D())}catch(Oe){console.error("Failed to move selected files:",Oe),window.alert("Failed to move selected files.")}finally{Un()}},Fl=async()=>{const Oe=U.trim();if(!Oe)return;const at=z?`${z}/${Oe}`:Oe;try{await ty(at,o),ce(""),ke(!0);const yt=await Qf(o,1e3,0,"modified",!1,z,c);pe(yt.filter(gn=>gn.type==="folder"))}catch(yt){console.error("Failed to create folder:",yt),window.alert("Failed to create folder.")}finally{ke(!1)}},ks=async()=>{const Oe=Ge.trim();if(!Oe)return;const at=s?`${s}/${Oe}`:Oe;try{await ty(at,o),Xe(""),te(!1),O()}catch(yt){console.error("Failed to create folder:",yt),window.alert("Failed to create folder.")}},so=b.useMemo(()=>{const at=[{name:o==="output"?"Outputs":"Inputs",path:null}];if(s){const yt=s.split("/");yt.forEach((gn,Mn)=>{at.push({name:gn,path:yt.slice(0,Mn+1).join("/")})})}return at},[o,s]),ql=()=>{const Oe=so.length,at=[];return Oe<=3?so.forEach((yt,gn)=>{at.push({...yt,isClickable:gn<Oe-1})}):(at.push({...so[0],isClickable:!0}),at.push({name:"...",path:so[Oe-3].path,isEllipsis:!0,isClickable:!0}),at.push({...so[Oe-2],isClickable:!0}),at.push({...so[Oe-1],isClickable:!1})),u.jsx("div",{id:"outputs-breadcrumb-trail",className:"flex items-center text-sm overflow-hidden whitespace-nowrap",children:at.map((yt,gn)=>u.jsxs("div",{className:"flex items-center min-w-0",children:[gn>0&&u.jsx("span",{className:"mx-1.5 text-gray-400 shrink-0",children:"/"}),u.jsx("button",{onClick:()=>yt.isClickable&&v(yt.path),disabled:!yt.isClickable,className:`
                truncate transition-colors
                ${yt.isClickable?"text-blue-600 hover:text-blue-700 active:opacity-70":"text-gray-700 font-medium"}
                ${yt.isEllipsis?"px-1 bg-gray-100 rounded":""}
              `,title:yt.name,children:yt.name})]},gn))})};b.useEffect(()=>{if(!W)return;let Oe=!1;return(async()=>{ke(!0);try{const yt=await Qf(o,1e3,0,"modified",!1,z,c);if(Oe)return;pe(yt.filter(gn=>gn.type==="folder"))}catch(yt){if(Oe)return;console.error("Failed to load folders:",yt),pe([])}finally{Oe||ke(!1)}})(),()=>{Oe=!0}},[W,z,o,c]),b.useEffect(()=>{A&&y.length===0&&V(!1)},[A,y.length,V]);const Gl=()=>{const Oe=Xt.getState();Oe.clearSelection(),Oe.toggleSelectionMode()},Cr=()=>{if(!z)return;const Oe=z.split("/");Oe.pop(),$(Oe.length?Oe.join("/"):null)},cc=Oe=>()=>{$(z?`${z}/${Oe}`:Oe)};return u.jsx("div",{id:"outputs-panel-wrapper",className:"absolute inset-x-0 top-[60px] bottom-0",style:{display:n?"block":"none"},children:u.jsxs("div",{id:"outputs-panel-root",className:"h-full bg-white flex flex-col pt-[4px] pb-[80px]",children:[u.jsx(H5,{breadcrumbs:ql(),selectionMode:m,selectedCount:y.length,onClearSelection:Gl}),u.jsxs("div",{id:"outputs-content-container",className:"flex-1 overflow-y-auto p-4",children:[u.jsx(V5,{folders:At,foldersCollapsed:Fe,toggleFoldersCollapsed:le,selectionMode:m,selectedIds:y,favorites:p,setCurrentFolder:x,handleOpen:nt,handleMenu:tt,toggleSelection:j}),u.jsx($5,{fileSections:Ae,collapsedSections:Je,viewMode:l,selectionMode:m,selectedIds:y,favorites:p,setCurrentFolder:x,handleOpen:nt,handleMenu:tt,toggleSelection:j,toggleSectionCollapsed:st,selectIds:R}),a&&u.jsx("div",{id:"outputs-loading-indicator",className:"py-4 flex justify-center",children:u.jsx("span",{className:"text-gray-400 text-sm",children:"Loading..."})}),!a&&St.length===0&&u.jsx("div",{id:"outputs-empty-message",className:"text-center text-gray-400 py-8",children:s?"No images in this folder":o==="output"?"No generated images yet":"No imported images"})]}),u.jsx(K5,{menuTarget:L,favorites:p,setMenuTarget:K,menuRef:_t,menuStyle:Be,handleFavorite:Qe,handleSelectSingle:Mt,handleMoveSingle:Ul,handleRenameRequest:ue,handleLoadWorkflow:Bt,handleLoadInWorkflow:gt,handleDeleteRequest:xt}),A&&u.jsxs(vu,{onClose:()=>V(!1),zIndex:1800,children:[u.jsxs("div",{className:"px-4 py-3 text-sm font-semibold text-gray-700 border-b border-gray-100",children:[y.length," selected"]}),u.jsxs("button",{className:"w-full text-left px-4 py-3 text-sm hover:bg-gray-50 flex items-center gap-2",onClick:uc,children:[y.every(Oe=>p.includes(Oe))?u.jsx(nc,{className:"w-4 h-4"}):u.jsx(Yr,{className:"w-4 h-4"}),y.every(Oe=>p.includes(Oe))?"Unfavorite":"Favorite"]}),u.jsxs("button",{className:"w-full text-left px-4 py-3 text-sm hover:bg-gray-50 flex items-center gap-2",onClick:xa,children:[u.jsx(mr,{className:"w-4 h-4 text-gray-500"}),"Move"]}),u.jsxs("button",{className:"w-full text-left px-4 py-3 text-sm text-red-600 hover:bg-red-50 flex items-center gap-2",onClick:vt,children:[u.jsx(Ho,{className:"w-4 h-4"}),"Delete"]}),u.jsx("button",{className:"w-full text-left px-4 py-3 text-sm text-gray-600 hover:bg-gray-50",onClick:()=>V(!1),children:"Cancel"})]}),W&&u.jsxs(vu,{onClose:Un,zIndex:1850,children:[u.jsx("div",{className:"px-4 py-3 text-sm font-semibold text-gray-700 border-b border-gray-100",children:z!==qe?u.jsxs(u.Fragment,{children:["Move to ",u.jsx(mr,{className:"w-4 h-4 text-amber-500 inline"})," ",z||"root"]}):"Move to..."}),u.jsxs("div",{className:"max-h-[50vh] overflow-y-auto",children:[ae&&u.jsx("div",{className:"px-4 py-3 text-sm text-gray-400",children:"Loading folders..."}),!ae&&z&&u.jsx("button",{className:"w-full text-left px-4 py-3 text-sm hover:bg-gray-50 flex items-center gap-2",onClick:Cr,children:u.jsx("span",{className:"text-gray-500",children:".."})}),!ae&&ee.filter(Oe=>!He.includes(Oe.id)).length===0&&u.jsx("div",{className:"px-4 py-3 text-sm text-gray-400",children:"No folders"}),!ae&&ee.filter(Oe=>!He.includes(Oe.id)).map(Oe=>u.jsxs("button",{className:"w-full text-left px-4 py-3 text-sm hover:bg-gray-50 flex items-center gap-2",onClick:cc(Oe.name),children:[u.jsx(mr,{className:"w-4 h-4 text-amber-500"}),Oe.name]},Oe.id)),u.jsx("div",{className:"px-4 py-3 border-t border-gray-100",children:u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("input",{value:U,onChange:Oe=>ce(Oe.target.value),placeholder:"New folder",className:"flex-1 border border-gray-200 rounded-lg px-3 py-2 text-sm"}),u.jsx("button",{className:"px-3 py-2 text-sm font-medium text-blue-600 hover:text-blue-700",onClick:Fl,children:"Create"})]})})]}),u.jsxs("div",{className:"px-4 py-3 border-t border-gray-100 flex justify-end gap-2",children:[u.jsx("button",{className:"px-3 py-2 text-sm font-medium text-gray-600 hover:bg-gray-100 rounded-lg",onClick:Un,children:"Cancel"}),u.jsx("button",{className:`px-3 py-2 text-sm font-medium rounded-lg ${z!==qe?"text-white bg-blue-600 hover:bg-blue-700":"text-gray-400 bg-gray-200 cursor-not-allowed"}`,onClick:va,disabled:z===qe,children:"Submit"})]})]}),je&&u.jsx(Yo,{onClose:De,title:"Delete file?",description:je.type==="folder"?`This will permanently delete the folder "${je.name}" and all of its contents from the server. This cannot be undone.`:`This will permanently delete "${je.name}" from the server. This cannot be undone.`,actions:[{label:"Cancel",onClick:De,className:"px-3 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-100"},{label:"Delete",onClick:jn,className:"px-3 py-2 rounded-lg text-sm font-medium text-white bg-red-600 hover:bg-red-700"}]}),B&&u.jsx(Yo,{onClose:()=>ne(!1),title:"Delete selected files?",description:`This will permanently delete ${y.length} selected file${y.length===1?"":"s"} from the server. This cannot be undone.`,zIndex:1800,actions:[{label:"Cancel",onClick:()=>ne(!1),className:"px-3 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-100"},{label:"Delete",onClick:Kl,className:"px-3 py-2 rounded-lg text-sm font-medium text-white bg-red-600 hover:bg-red-700"}]}),T&&u.jsx(vu,{onClose:Xo,zIndex:1850,children:u.jsxs("div",{className:"p-4",children:[u.jsxs("div",{className:"text-gray-900 text-base font-semibold",children:["Rename ",T.type==="folder"?"folder":"file"]}),u.jsxs("div",{className:"text-gray-600 text-sm mt-1 truncate",children:["Current: ",T.name]}),u.jsx("input",{value:G,onChange:Oe=>ge(Oe.target.value),onKeyDown:Oe=>{Oe.key==="Enter"&&Wl()},placeholder:T.type==="folder"?"Folder name":"File name",className:"mt-3 w-full border border-gray-200 rounded-lg px-3 py-2 text-sm",autoFocus:!0}),u.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[u.jsx("button",{className:"px-3 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-100",onClick:Xo,children:"Cancel"}),u.jsx("button",{className:`px-3 py-2 rounded-lg text-sm font-medium ${G.trim()&&G.trim()!==T.name?"text-white bg-blue-600 hover:bg-blue-700":"text-gray-400 bg-gray-200 cursor-not-allowed"}`,onClick:()=>{Wl()},disabled:!G.trim()||G.trim()===T.name,children:"Rename"})]})]})}),re&&u.jsx(vu,{onClose:()=>{te(!1),Xe("")},zIndex:1850,children:u.jsxs("div",{className:"p-4",children:[u.jsx("div",{className:"text-gray-900 text-base font-semibold",children:"New folder"}),u.jsxs("div",{className:"text-gray-600 text-sm mt-1",children:["Create a new folder in ",s?u.jsxs(u.Fragment,{children:[u.jsx(mr,{className:"w-3.5 h-3.5 text-amber-500 inline"})," ",s]}):"root"]}),u.jsx("input",{value:Ge,onChange:Oe=>Xe(Oe.target.value),onKeyDown:Oe=>{Oe.key==="Enter"&&ks()},placeholder:"Folder name",className:"mt-3 w-full border border-gray-200 rounded-lg px-3 py-2 text-sm",autoFocus:!0}),u.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[u.jsx("button",{className:"px-3 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-100",onClick:()=>{te(!1),Xe("")},children:"Cancel"}),u.jsx("button",{className:`px-3 py-2 rounded-lg text-sm font-medium ${Ge.trim()?"text-white bg-blue-600 hover:bg-blue-700":"text-gray-400 bg-gray-200 cursor-not-allowed"}`,onClick:ks,disabled:!Ge.trim(),children:"Create"})]})]})}),u.jsx(cv,{open:se,file:Re,source:o,onClose:Ye,onLoaded:()=>{Z(!1),Se(null),be.current?.(),be.current=null}}),u.jsx(z5,{open:J,onClose:()=>X(!1),filter:d,sort:h,onChangeFilter:I,onChangeSort:H}),Ee&&_n.createPortal(u.jsx(Yo,{onClose:bn,title:"Unsaved changes",description:"Are you sure you want to load this workflow? You have unsaved changes.",actions:[{label:"Cancel",onClick:bn,className:"px-3 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-100"},{label:"Continue",onClick:()=>{ln()},className:"px-3 py-2 rounded-lg text-sm font-medium text-white bg-red-600 hover:bg-red-700"}]}),document.body),u.jsx(uv,{open:Ie,items:Ze,index:pt,onClose:ht,onIndexChange:Lt,onDelete:Ct,onLoadInWorkflow:Nt,onLoadWorkflow:ut,showMetadataToggle:!0})]})})}function q5(){const n=oo(_=>_.currentPanel),o=oo(_=>_.setCurrentPanel),s=tp(_=>_.appMenuOpen),a=To(_=>_.viewerOpen),l=To(_=>_.setViewerState),c=fe(_=>_.followQueue),d=fe(_=>_.setFollowQueue),h=Pn(_=>_.bookmarkRepositioningActive),p=b.useRef(null),{isInputFocused:m}=lv(),y=Xt(_=>_.outputsViewerOpen),x=Xt(_=>_.selectionMode),v=Xt(_=>_.filterModalOpen),C=Xt(_=>_.selectionActionOpen),N=Xt(_=>_.currentFolder),w=Xt(_=>_.navigateUp);R5();const j=b.useCallback(()=>{n==="workflow"?o("queue"):n==="outputs"&&o("workflow")},[n,o]),k=b.useCallback(()=>{n==="outputs"&&N?w():n==="workflow"?o("outputs"):n==="queue"&&o("workflow")},[n,N,w,o]),O=n==="workflow"||n==="outputs",R=n==="workflow"||n==="queue"||n==="outputs"&&!!N,{swipeOffset:D,isSwiping:I,setSwipeEnabled:H,resetSwipeState:A}=D5({onSwipeLeft:O?j:void 0,onSwipeRight:R?k:void 0,enabled:!m&&!a&&!s&&!y&&!h&&!x&&!v&&!C}),V=fe(_=>_.setNodeTypes),J=ga(_=>_.theme),X=fe(_=>_.workflowLoadedAt),re=Ht(_=>_.fetchQueue),te=Yn(_=>_.history);b.useEffect(()=>{!I&&D!==0&&A()},[I,D,A]),b.useEffect(()=>{y&&A()},[y,A]);const me=()=>{l({viewerOpen:!1}),d(!1),H(!0),A()};b.useEffect(()=>{Op().then(_=>{V(_)}).catch(_=>{console.error("Failed to load node types:",_)})},[V]),b.useEffect(()=>{re()},[re]);const Te=(_,q,de=!0)=>{H(!1),A(),l({viewerImages:_,viewerIndex:q,viewerScale:1,viewerTranslate:{x:0,y:0},viewerOpen:!0}),d(de)},F=()=>{const _=oh(te,{alt:"Generation"});H(!1),A();const q=_.length>0?0:-1;l({viewerImages:_,viewerIndex:q,viewerScale:1,viewerTranslate:{x:0,y:0},viewerOpen:!0}),d(!0)};return b.useLayoutEffect(()=>{const _=document.documentElement;_.classList.toggle("dark",J==="dark"),_.style.colorScheme=J},[J]),b.useEffect(()=>{X&&queueMicrotask(()=>{d(!1)})},[X,d]),u.jsxs("div",{id:"app-root",className:"min-h-screen bg-gray-100",children:[u.jsx(tN,{mode:n}),u.jsxs("main",{id:"main-content",ref:p,className:"pt-[69px] pb-[80px] min-h-screen relative",children:[u.jsxs(u.Fragment,{children:[u.jsx(F5,{visible:n==="outputs"}),u.jsx(V4,{visible:n==="workflow",onImageClick:Te}),u.jsx(p5,{visible:n==="queue",onImageClick:Te})]}),u.jsx("div",{id:"bottom-bar-spacer",className:"fixed inset-x-0 bottom-0 bg-gray-100 pointer-events-none z-[1500]",style:{height:"var(--bottom-bar-offset, 80px)"}})]}),u.jsx(Q4,{currentPanel:n,viewerOpen:a,followQueue:c,onToggleFollowQueue:()=>d(!c),onOpenFollowQueue:F}),u.jsx(_5,{onClose:me})]})}Nw.createRoot(document.getElementById("root")).render(u.jsx(b.StrictMode,{children:u.jsx(q5,{})}));
//# sourceMappingURL=index-DEtW7WzZ.js.map
