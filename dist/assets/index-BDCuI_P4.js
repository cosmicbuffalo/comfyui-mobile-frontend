function Mw(n,o){for(var s=0;s<o.length;s++){const a=o[s];if(typeof a!="string"&&!Array.isArray(a)){for(const l in a)if(l!=="default"&&!(l in n)){const c=Object.getOwnPropertyDescriptor(a,l);c&&Object.defineProperty(n,l,c.get?c:{enumerable:!0,get:()=>a[l]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))a(l);new MutationObserver(l=>{for(const c of l)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&a(d)}).observe(document,{childList:!0,subtree:!0});function s(l){const c={};return l.integrity&&(c.integrity=l.integrity),l.referrerPolicy&&(c.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?c.credentials="include":l.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function a(l){if(l.ep)return;l.ep=!0;const c=s(l);fetch(l.href,c)}})();function Ow(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Nf={exports:{}},gl={};var q0;function Tw(){if(q0)return gl;q0=1;var n=Symbol.for("react.transitional.element"),o=Symbol.for("react.fragment");function s(a,l,c){var d=null;if(c!==void 0&&(d=""+c),l.key!==void 0&&(d=""+l.key),"key"in l){c={};for(var h in l)h!=="key"&&(c[h]=l[h])}else c=l;return l=c.ref,{$$typeof:n,type:a,key:d,ref:l!==void 0?l:null,props:c}}return gl.Fragment=o,gl.jsx=s,gl.jsxs=s,gl}var G0;function Ew(){return G0||(G0=1,Nf.exports=Tw()),Nf.exports}var u=Ew(),kf={exports:{}},At={};var P0;function Iw(){if(P0)return At;P0=1;var n=Symbol.for("react.transitional.element"),o=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),c=Symbol.for("react.consumer"),d=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),x=Symbol.for("react.activity"),v=Symbol.iterator;function k(O){return O===null||typeof O!="object"?null:(O=v&&O[v]||O["@@iterator"],typeof O=="function"?O:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,j={};function C(O,_,q){this.props=O,this.context=_,this.refs=j,this.updater=q||w}C.prototype.isReactComponent={},C.prototype.setState=function(O,_){if(typeof O!="object"&&typeof O!="function"&&O!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,O,_,"setState")},C.prototype.forceUpdate=function(O){this.updater.enqueueForceUpdate(this,O,"forceUpdate")};function T(){}T.prototype=C.prototype;function R(O,_,q){this.props=O,this.context=_,this.refs=j,this.updater=q||w}var D=R.prototype=new T;D.constructor=R,S(D,C.prototype),D.isPureReactComponent=!0;var L=Array.isArray;function B(){}var A={H:null,A:null,T:null,S:null},F=Object.prototype.hasOwnProperty;function te(O,_,q){var je=q.ref;return{$$typeof:n,type:O,key:_,ref:je!==void 0?je:null,props:q}}function ee(O,_){return te(O.type,_,O.props)}function ae(O){return typeof O=="object"&&O!==null&&O.$$typeof===n}function ne(O){var _={"=":"=0",":":"=2"};return"$"+O.replace(/[=:]/g,function(q){return _[q]})}var me=/\/+/g;function Le(O,_){return typeof O=="object"&&O!==null&&O.key!=null?ne(""+O.key):_.toString(36)}function P(O){switch(O.status){case"fulfilled":return O.value;case"rejected":throw O.reason;default:switch(typeof O.status=="string"?O.then(B,B):(O.status="pending",O.then(function(_){O.status==="pending"&&(O.status="fulfilled",O.value=_)},function(_){O.status==="pending"&&(O.status="rejected",O.reason=_)})),O.status){case"fulfilled":return O.value;case"rejected":throw O.reason}}throw O}function V(O,_,q,je,Ke){var De=typeof O;(De==="undefined"||De==="boolean")&&(O=null);var Fe=!1;if(O===null)Fe=!0;else switch(De){case"bigint":case"string":case"number":Fe=!0;break;case"object":switch(O.$$typeof){case n:case o:Fe=!0;break;case y:return Fe=O._init,V(Fe(O._payload),_,q,je,Ke)}}if(Fe)return Ke=Ke(O),Fe=je===""?"."+Le(O,0):je,L(Ke)?(q="",Fe!=null&&(q=Fe.replace(me,"$&/")+"/"),V(Ke,_,q,"",function(et){return et})):Ke!=null&&(ae(Ke)&&(Ke=ee(Ke,q+(Ke.key==null||O&&O.key===Ke.key?"":(""+Ke.key).replace(me,"$&/")+"/")+Fe)),_.push(Ke)),1;Fe=0;var ue=je===""?".":je+":";if(L(O))for(var ye=0;ye<O.length;ye++)je=O[ye],De=ue+Le(je,ye),Fe+=V(je,_,q,De,Ke);else if(ye=k(O),typeof ye=="function")for(O=ye.call(O),ye=0;!(je=O.next()).done;)je=je.value,De=ue+Le(je,ye++),Fe+=V(je,_,q,De,Ke);else if(De==="object"){if(typeof O.then=="function")return V(P(O),_,q,je,Ke);throw _=String(O),Error("Objects are not valid as a React child (found: "+(_==="[object Object]"?"object with keys {"+Object.keys(O).join(", ")+"}":_)+"). If you meant to render a collection of children, use an array instead.")}return Fe}function H(O,_,q){if(O==null)return O;var je=[],Ke=0;return V(O,je,"","",function(De){return _.call(q,De,Ke++)}),je}function ce(O){if(O._status===-1){var _=O._result;_=_(),_.then(function(q){(O._status===0||O._status===-1)&&(O._status=1,O._result=q)},function(q){(O._status===0||O._status===-1)&&(O._status=2,O._result=q)}),O._status===-1&&(O._status=0,O._result=_)}if(O._status===1)return O._result.default;throw O._result}var ke=typeof reportError=="function"?reportError:function(O){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var _=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof O=="object"&&O!==null&&typeof O.message=="string"?String(O.message):String(O),error:O});if(!window.dispatchEvent(_))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",O);return}console.error(O)},Ne={map:H,forEach:function(O,_,q){H(O,function(){_.apply(this,arguments)},q)},count:function(O){var _=0;return H(O,function(){_++}),_},toArray:function(O){return H(O,function(_){return _})||[]},only:function(O){if(!ae(O))throw Error("React.Children.only expected to receive a single React element child.");return O}};return At.Activity=x,At.Children=Ne,At.Component=C,At.Fragment=s,At.Profiler=l,At.PureComponent=R,At.StrictMode=a,At.Suspense=p,At.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=A,At.__COMPILER_RUNTIME={__proto__:null,c:function(O){return A.H.useMemoCache(O)}},At.cache=function(O){return function(){return O.apply(null,arguments)}},At.cacheSignal=function(){return null},At.cloneElement=function(O,_,q){if(O==null)throw Error("The argument must be a React element, but you passed "+O+".");var je=S({},O.props),Ke=O.key;if(_!=null)for(De in _.key!==void 0&&(Ke=""+_.key),_)!F.call(_,De)||De==="key"||De==="__self"||De==="__source"||De==="ref"&&_.ref===void 0||(je[De]=_[De]);var De=arguments.length-2;if(De===1)je.children=q;else if(1<De){for(var Fe=Array(De),ue=0;ue<De;ue++)Fe[ue]=arguments[ue+2];je.children=Fe}return te(O.type,Ke,je)},At.createContext=function(O){return O={$$typeof:d,_currentValue:O,_currentValue2:O,_threadCount:0,Provider:null,Consumer:null},O.Provider=O,O.Consumer={$$typeof:c,_context:O},O},At.createElement=function(O,_,q){var je,Ke={},De=null;if(_!=null)for(je in _.key!==void 0&&(De=""+_.key),_)F.call(_,je)&&je!=="key"&&je!=="__self"&&je!=="__source"&&(Ke[je]=_[je]);var Fe=arguments.length-2;if(Fe===1)Ke.children=q;else if(1<Fe){for(var ue=Array(Fe),ye=0;ye<Fe;ye++)ue[ye]=arguments[ye+2];Ke.children=ue}if(O&&O.defaultProps)for(je in Fe=O.defaultProps,Fe)Ke[je]===void 0&&(Ke[je]=Fe[je]);return te(O,De,Ke)},At.createRef=function(){return{current:null}},At.forwardRef=function(O){return{$$typeof:h,render:O}},At.isValidElement=ae,At.lazy=function(O){return{$$typeof:y,_payload:{_status:-1,_result:O},_init:ce}},At.memo=function(O,_){return{$$typeof:m,type:O,compare:_===void 0?null:_}},At.startTransition=function(O){var _=A.T,q={};A.T=q;try{var je=O(),Ke=A.S;Ke!==null&&Ke(q,je),typeof je=="object"&&je!==null&&typeof je.then=="function"&&je.then(B,ke)}catch(De){ke(De)}finally{_!==null&&q.types!==null&&(_.types=q.types),A.T=_}},At.unstable_useCacheRefresh=function(){return A.H.useCacheRefresh()},At.use=function(O){return A.H.use(O)},At.useActionState=function(O,_,q){return A.H.useActionState(O,_,q)},At.useCallback=function(O,_){return A.H.useCallback(O,_)},At.useContext=function(O){return A.H.useContext(O)},At.useDebugValue=function(){},At.useDeferredValue=function(O,_){return A.H.useDeferredValue(O,_)},At.useEffect=function(O,_){return A.H.useEffect(O,_)},At.useEffectEvent=function(O){return A.H.useEffectEvent(O)},At.useId=function(){return A.H.useId()},At.useImperativeHandle=function(O,_,q){return A.H.useImperativeHandle(O,_,q)},At.useInsertionEffect=function(O,_){return A.H.useInsertionEffect(O,_)},At.useLayoutEffect=function(O,_){return A.H.useLayoutEffect(O,_)},At.useMemo=function(O,_){return A.H.useMemo(O,_)},At.useOptimistic=function(O,_){return A.H.useOptimistic(O,_)},At.useReducer=function(O,_,q){return A.H.useReducer(O,_,q)},At.useRef=function(O){return A.H.useRef(O)},At.useState=function(O){return A.H.useState(O)},At.useSyncExternalStore=function(O,_,q){return A.H.useSyncExternalStore(O,_,q)},At.useTransition=function(){return A.H.useTransition()},At.version="19.2.3",At}var Y0;function Lp(){return Y0||(Y0=1,kf.exports=Iw()),kf.exports}var b=Lp();const ga=Ow(b),Q0=Mw({__proto__:null,default:ga},[b]);var Cf={exports:{}},ml={},jf={exports:{}},Mf={};var X0;function Lw(){return X0||(X0=1,(function(n){function o(V,H){var ce=V.length;V.push(H);e:for(;0<ce;){var ke=ce-1>>>1,Ne=V[ke];if(0<l(Ne,H))V[ke]=H,V[ce]=Ne,ce=ke;else break e}}function s(V){return V.length===0?null:V[0]}function a(V){if(V.length===0)return null;var H=V[0],ce=V.pop();if(ce!==H){V[0]=ce;e:for(var ke=0,Ne=V.length,O=Ne>>>1;ke<O;){var _=2*(ke+1)-1,q=V[_],je=_+1,Ke=V[je];if(0>l(q,ce))je<Ne&&0>l(Ke,q)?(V[ke]=Ke,V[je]=ce,ke=je):(V[ke]=q,V[_]=ce,ke=_);else if(je<Ne&&0>l(Ke,ce))V[ke]=Ke,V[je]=ce,ke=je;else break e}}return H}function l(V,H){var ce=V.sortIndex-H.sortIndex;return ce!==0?ce:V.id-H.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var c=performance;n.unstable_now=function(){return c.now()}}else{var d=Date,h=d.now();n.unstable_now=function(){return d.now()-h}}var p=[],m=[],y=1,x=null,v=3,k=!1,w=!1,S=!1,j=!1,C=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,R=typeof setImmediate<"u"?setImmediate:null;function D(V){for(var H=s(m);H!==null;){if(H.callback===null)a(m);else if(H.startTime<=V)a(m),H.sortIndex=H.expirationTime,o(p,H);else break;H=s(m)}}function L(V){if(S=!1,D(V),!w)if(s(p)!==null)w=!0,B||(B=!0,ne());else{var H=s(m);H!==null&&P(L,H.startTime-V)}}var B=!1,A=-1,F=5,te=-1;function ee(){return j?!0:!(n.unstable_now()-te<F)}function ae(){if(j=!1,B){var V=n.unstable_now();te=V;var H=!0;try{e:{w=!1,S&&(S=!1,T(A),A=-1),k=!0;var ce=v;try{t:{for(D(V),x=s(p);x!==null&&!(x.expirationTime>V&&ee());){var ke=x.callback;if(typeof ke=="function"){x.callback=null,v=x.priorityLevel;var Ne=ke(x.expirationTime<=V);if(V=n.unstable_now(),typeof Ne=="function"){x.callback=Ne,D(V),H=!0;break t}x===s(p)&&a(p),D(V)}else a(p);x=s(p)}if(x!==null)H=!0;else{var O=s(m);O!==null&&P(L,O.startTime-V),H=!1}}break e}finally{x=null,v=ce,k=!1}H=void 0}}finally{H?ne():B=!1}}}var ne;if(typeof R=="function")ne=function(){R(ae)};else if(typeof MessageChannel<"u"){var me=new MessageChannel,Le=me.port2;me.port1.onmessage=ae,ne=function(){Le.postMessage(null)}}else ne=function(){C(ae,0)};function P(V,H){A=C(function(){V(n.unstable_now())},H)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(V){V.callback=null},n.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<V?Math.floor(1e3/V):5},n.unstable_getCurrentPriorityLevel=function(){return v},n.unstable_next=function(V){switch(v){case 1:case 2:case 3:var H=3;break;default:H=v}var ce=v;v=H;try{return V()}finally{v=ce}},n.unstable_requestPaint=function(){j=!0},n.unstable_runWithPriority=function(V,H){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var ce=v;v=V;try{return H()}finally{v=ce}},n.unstable_scheduleCallback=function(V,H,ce){var ke=n.unstable_now();switch(typeof ce=="object"&&ce!==null?(ce=ce.delay,ce=typeof ce=="number"&&0<ce?ke+ce:ke):ce=ke,V){case 1:var Ne=-1;break;case 2:Ne=250;break;case 5:Ne=1073741823;break;case 4:Ne=1e4;break;default:Ne=5e3}return Ne=ce+Ne,V={id:y++,callback:H,priorityLevel:V,startTime:ce,expirationTime:Ne,sortIndex:-1},ce>ke?(V.sortIndex=ce,o(m,V),s(p)===null&&V===s(m)&&(S?(T(A),A=-1):S=!0,P(L,ce-ke))):(V.sortIndex=Ne,o(p,V),w||k||(w=!0,B||(B=!0,ne()))),V},n.unstable_shouldYield=ee,n.unstable_wrapCallback=function(V){var H=v;return function(){var ce=v;v=H;try{return V.apply(this,arguments)}finally{v=ce}}}})(Mf)),Mf}var Z0;function _w(){return Z0||(Z0=1,jf.exports=Lw()),jf.exports}var Of={exports:{}},Wn={};var J0;function Aw(){if(J0)return Wn;J0=1;var n=Lp();function o(p){var m="https://react.dev/errors/"+p;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var y=2;y<arguments.length;y++)m+="&args[]="+encodeURIComponent(arguments[y])}return"Minified React error #"+p+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(){}var a={d:{f:s,r:function(){throw Error(o(522))},D:s,C:s,L:s,m:s,X:s,S:s,M:s},p:0,findDOMNode:null},l=Symbol.for("react.portal");function c(p,m,y){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:l,key:x==null?null:""+x,children:p,containerInfo:m,implementation:y}}var d=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function h(p,m){if(p==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return Wn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,Wn.createPortal=function(p,m){var y=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(o(299));return c(p,m,null,y)},Wn.flushSync=function(p){var m=d.T,y=a.p;try{if(d.T=null,a.p=2,p)return p()}finally{d.T=m,a.p=y,a.d.f()}},Wn.preconnect=function(p,m){typeof p=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,a.d.C(p,m))},Wn.prefetchDNS=function(p){typeof p=="string"&&a.d.D(p)},Wn.preinit=function(p,m){if(typeof p=="string"&&m&&typeof m.as=="string"){var y=m.as,x=h(y,m.crossOrigin),v=typeof m.integrity=="string"?m.integrity:void 0,k=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;y==="style"?a.d.S(p,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:x,integrity:v,fetchPriority:k}):y==="script"&&a.d.X(p,{crossOrigin:x,integrity:v,fetchPriority:k,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},Wn.preinitModule=function(p,m){if(typeof p=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var y=h(m.as,m.crossOrigin);a.d.M(p,{crossOrigin:y,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&a.d.M(p)},Wn.preload=function(p,m){if(typeof p=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var y=m.as,x=h(y,m.crossOrigin);a.d.L(p,y,{crossOrigin:x,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},Wn.preloadModule=function(p,m){if(typeof p=="string")if(m){var y=h(m.as,m.crossOrigin);a.d.m(p,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:y,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else a.d.m(p)},Wn.requestFormReset=function(p){a.d.r(p)},Wn.unstable_batchedUpdates=function(p,m){return p(m)},Wn.useFormState=function(p,m,y){return d.H.useFormState(p,m,y)},Wn.useFormStatus=function(){return d.H.useHostTransitionStatus()},Wn.version="19.2.3",Wn}var ey;function Kb(){if(ey)return Of.exports;ey=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(o){console.error(o)}}return n(),Of.exports=Aw(),Of.exports}var ty;function Rw(){if(ty)return ml;ty=1;var n=_w(),o=Lp(),s=Kb();function a(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var r=2;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function c(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function d(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function h(e){if(e.tag===31){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function p(e){if(c(e)!==e)throw Error(a(188))}function m(e){var t=e.alternate;if(!t){if(t=c(e),t===null)throw Error(a(188));return t!==e?null:e}for(var r=e,i=t;;){var f=r.return;if(f===null)break;var g=f.alternate;if(g===null){if(i=f.return,i!==null){r=i;continue}break}if(f.child===g.child){for(g=f.child;g;){if(g===r)return p(f),e;if(g===i)return p(f),t;g=g.sibling}throw Error(a(188))}if(r.return!==i.return)r=f,i=g;else{for(var N=!1,E=f.child;E;){if(E===r){N=!0,r=f,i=g;break}if(E===i){N=!0,i=f,r=g;break}E=E.sibling}if(!N){for(E=g.child;E;){if(E===r){N=!0,r=g,i=f;break}if(E===i){N=!0,i=g,r=f;break}E=E.sibling}if(!N)throw Error(a(189))}}if(r.alternate!==i)throw Error(a(190))}if(r.tag!==3)throw Error(a(188));return r.stateNode.current===r?e:t}function y(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e;for(e=e.child;e!==null;){if(t=y(e),t!==null)return t;e=e.sibling}return null}var x=Object.assign,v=Symbol.for("react.element"),k=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),j=Symbol.for("react.strict_mode"),C=Symbol.for("react.profiler"),T=Symbol.for("react.consumer"),R=Symbol.for("react.context"),D=Symbol.for("react.forward_ref"),L=Symbol.for("react.suspense"),B=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),F=Symbol.for("react.lazy"),te=Symbol.for("react.activity"),ee=Symbol.for("react.memo_cache_sentinel"),ae=Symbol.iterator;function ne(e){return e===null||typeof e!="object"?null:(e=ae&&e[ae]||e["@@iterator"],typeof e=="function"?e:null)}var me=Symbol.for("react.client.reference");function Le(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===me?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case S:return"Fragment";case C:return"Profiler";case j:return"StrictMode";case L:return"Suspense";case B:return"SuspenseList";case te:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case w:return"Portal";case R:return e.displayName||"Context";case T:return(e._context.displayName||"Context")+".Consumer";case D:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case A:return t=e.displayName||null,t!==null?t:Le(e.type)||"Memo";case F:t=e._payload,e=e._init;try{return Le(e(t))}catch{}}return null}var P=Array.isArray,V=o.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,H=s.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ce={pending:!1,data:null,method:null,action:null},ke=[],Ne=-1;function O(e){return{current:e}}function _(e){0>Ne||(e.current=ke[Ne],ke[Ne]=null,Ne--)}function q(e,t){Ne++,ke[Ne]=e.current,e.current=t}var je=O(null),Ke=O(null),De=O(null),Fe=O(null);function ue(e,t){switch(q(De,t),q(Ke,e),q(je,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?g0(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)t=g0(t),e=m0(t,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}_(je),q(je,e)}function ye(){_(je),_(Ke),_(De)}function et(e){e.memoizedState!==null&&q(Fe,e);var t=je.current,r=m0(t,e.type);t!==r&&(q(Ke,e),q(je,r))}function oe(e){Ke.current===e&&(_(je),_(Ke)),Fe.current===e&&(_(Fe),dl._currentValue=ce)}var z,U;function se(e){if(z===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);z=t&&t[1]||"",U=-1<r.stack.indexOf(`
    at`)?" (<anonymous>)":-1<r.stack.indexOf("@")?"@unknown:0:0":""}return`
`+z+e+U}var fe=!1;function M(e,t){if(!e||fe)return"";fe=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var i={DetermineComponentFrameRoot:function(){try{if(t){var $e=function(){throw Error()};if(Object.defineProperty($e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct($e,[])}catch(Ae){var Ce=Ae}Reflect.construct(e,[],$e)}else{try{$e.call()}catch(Ae){Ce=Ae}e.call($e.prototype)}}else{try{throw Error()}catch(Ae){Ce=Ae}($e=e())&&typeof $e.catch=="function"&&$e.catch(function(){})}}catch(Ae){if(Ae&&Ce&&typeof Ae.stack=="string")return[Ae.stack,Ce.stack]}return[null,null]}};i.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var f=Object.getOwnPropertyDescriptor(i.DetermineComponentFrameRoot,"name");f&&f.configurable&&Object.defineProperty(i.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var g=i.DetermineComponentFrameRoot(),N=g[0],E=g[1];if(N&&E){var X=N.split(`
`),we=E.split(`
`);for(f=i=0;i<X.length&&!X[i].includes("DetermineComponentFrameRoot");)i++;for(;f<we.length&&!we[f].includes("DetermineComponentFrameRoot");)f++;if(i===X.length||f===we.length)for(i=X.length-1,f=we.length-1;1<=i&&0<=f&&X[i]!==we[f];)f--;for(;1<=i&&0<=f;i--,f--)if(X[i]!==we[f]){if(i!==1||f!==1)do if(i--,f--,0>f||X[i]!==we[f]){var ze=`
`+X[i].replace(" at new "," at ");return e.displayName&&ze.includes("<anonymous>")&&(ze=ze.replace("<anonymous>",e.displayName)),ze}while(1<=i&&0<=f);break}}}finally{fe=!1,Error.prepareStackTrace=r}return(r=e?e.displayName||e.name:"")?se(r):""}function re(e,t){switch(e.tag){case 26:case 27:case 5:return se(e.type);case 16:return se("Lazy");case 13:return e.child!==t&&t!==null?se("Suspense Fallback"):se("Suspense");case 19:return se("SuspenseList");case 0:case 15:return M(e.type,!1);case 11:return M(e.type.render,!1);case 1:return M(e.type,!0);case 31:return se("Activity");default:return""}}function W(e){try{var t="",r=null;do t+=re(e,r),r=e,e=e.return;while(e);return t}catch(i){return`
Error generating stack: `+i.message+`
`+i.stack}}var G=Object.prototype.hasOwnProperty,I=n.unstable_scheduleCallback,$=n.unstable_cancelCallback,Z=n.unstable_shouldYield,Se=n.unstable_requestPaint,Q=n.unstable_now,Me=n.unstable_getCurrentPriorityLevel,K=n.unstable_ImmediatePriority,Te=n.unstable_UserBlockingPriority,_e=n.unstable_NormalPriority,qe=n.unstable_LowPriority,Ge=n.unstable_IdlePriority,Ve=n.log,Je=n.unstable_setDisableYieldValue,Ue=null,Xe=null;function Pe(e){if(typeof Ve=="function"&&Je(e),Xe&&typeof Xe.setStrictMode=="function")try{Xe.setStrictMode(Ue,e)}catch{}}var he=Math.clz32?Math.clz32:it,Qe=Math.log,ut=Math.LN2;function it(e){return e>>>=0,e===0?32:31-(Qe(e)/ut|0)|0}var _t=256,Ot=262144,wt=4194304;function It(e){var t=e&42;if(t!==0)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Kt(e,t,r){var i=e.pendingLanes;if(i===0)return 0;var f=0,g=e.suspendedLanes,N=e.pingedLanes;e=e.warmLanes;var E=i&134217727;return E!==0?(i=E&~g,i!==0?f=It(i):(N&=E,N!==0?f=It(N):r||(r=E&~e,r!==0&&(f=It(r))))):(E=i&~g,E!==0?f=It(E):N!==0?f=It(N):r||(r=i&~e,r!==0&&(f=It(r)))),f===0?0:t!==0&&t!==f&&(t&g)===0&&(g=f&-f,r=t&-t,g>=r||g===32&&(r&4194048)!==0)?t:f}function pt(e,t){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)===0}function Lt(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Gt(){var e=wt;return wt<<=1,(wt&62914560)===0&&(wt=4194304),e}function xe(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function J(e,t){e.pendingLanes|=t,t!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function be(e,t,r,i,f,g){var N=e.pendingLanes;e.pendingLanes=r,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=r,e.entangledLanes&=r,e.errorRecoveryDisabledLanes&=r,e.shellSuspendCounter=0;var E=e.entanglements,X=e.expirationTimes,we=e.hiddenUpdates;for(r=N&~r;0<r;){var ze=31-he(r),$e=1<<ze;E[ze]=0,X[ze]=-1;var Ce=we[ze];if(Ce!==null)for(we[ze]=null,ze=0;ze<Ce.length;ze++){var Ae=Ce[ze];Ae!==null&&(Ae.lane&=-536870913)}r&=~$e}i!==0&&Ie(e,i,0),g!==0&&f===0&&e.tag!==0&&(e.suspendedLanes|=g&~(N&~t))}function Ie(e,t,r){e.pendingLanes|=t,e.suspendedLanes&=~t;var i=31-he(t);e.entangledLanes|=t,e.entanglements[i]=e.entanglements[i]|1073741824|r&261930}function Be(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var i=31-he(r),f=1<<i;f&t|e[i]&t&&(e[i]|=t),r&=~f}}function We(e,t){var r=t&-t;return r=(r&42)!==0?1:Oe(r),(r&(e.suspendedLanes|t))!==0?0:r}function Oe(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function lt(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function st(){var e=H.p;return e!==0?e:(e=window.event,e===void 0?32:H0(e.type))}function at(e,t){var r=H.p;try{return H.p=e,t()}finally{H.p=r}}var ct=Math.random().toString(36).slice(2),dt="__reactFiber$"+ct,nt="__reactProps$"+ct,bt="__reactContainer$"+ct,gt="__reactEvents$"+ct,kt="__reactListeners$"+ct,Qt="__reactHandles$"+ct,en="__reactResources$"+ct,Yt="__reactMarker$"+ct;function Y(e){delete e[dt],delete e[nt],delete e[gt],delete e[kt],delete e[Qt]}function Re(e){var t=e[dt];if(t)return t;for(var r=e.parentNode;r;){if(t=r[bt]||r[dt]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=N0(e);e!==null;){if(r=e[dt])return r;e=N0(e)}return t}e=r,r=e.parentNode}return null}function ie(e){if(e=e[dt]||e[bt]){var t=e.tag;if(t===5||t===6||t===13||t===31||t===26||t===27||t===3)return e}return null}function ot(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e.stateNode;throw Error(a(33))}function tt(e){var t=e[en];return t||(t=e[en]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function Ze(e){e[Yt]=!0}var Ye=new Set,Ct={};function mt(e,t){Tt(e,t),Tt(e+"Capture",t)}function Tt(e,t){for(Ct[e]=t,e=0;e<t.length;e++)Ye.add(t[e])}var pe=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),xt={},yt={};function Vt(e){return G.call(yt,e)?!0:G.call(xt,e)?!1:pe.test(e)?yt[e]=!0:(xt[e]=!0,!1)}function Rt(e,t,r){if(Vt(t))if(r===null)e.removeAttribute(t);else{switch(typeof r){case"undefined":case"function":case"symbol":e.removeAttribute(t);return;case"boolean":var i=t.toLowerCase().slice(0,5);if(i!=="data-"&&i!=="aria-"){e.removeAttribute(t);return}}e.setAttribute(t,""+r)}}function cn(e,t,r){if(r===null)e.removeAttribute(t);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttribute(t,""+r)}}function wn(e,t,r,i){if(i===null)e.removeAttribute(r);else{switch(typeof i){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(r);return}e.setAttributeNS(t,r,""+i)}}function jn(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Ql(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function xc(e,t,r){var i=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&typeof i<"u"&&typeof i.get=="function"&&typeof i.set=="function"){var f=i.get,g=i.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return f.call(this)},set:function(N){r=""+N,g.call(this,N)}}),Object.defineProperty(e,t,{enumerable:i.enumerable}),{getValue:function(){return r},setValue:function(N){r=""+N},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Ca(e){if(!e._valueTracker){var t=Ql(e)?"checked":"value";e._valueTracker=xc(e,t,""+e[t])}}function Xl(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),i="";return e&&(i=Ql(e)?e.checked?"true":"false":e.value),e=i,e!==r?(t.setValue(e),!0):!1}function Es(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var Is=/[\n"\\]/g;function Gn(e){return e.replace(Is,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function os(e,t,r,i,f,g,N,E){e.name="",N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"?e.type=N:e.removeAttribute("type"),t!=null?N==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+jn(t)):e.value!==""+jn(t)&&(e.value=""+jn(t)):N!=="submit"&&N!=="reset"||e.removeAttribute("value"),t!=null?ja(e,N,jn(t)):r!=null?ja(e,N,jn(r)):i!=null&&e.removeAttribute("value"),f==null&&g!=null&&(e.defaultChecked=!!g),f!=null&&(e.checked=f&&typeof f!="function"&&typeof f!="symbol"),E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"?e.name=""+jn(E):e.removeAttribute("name")}function Zl(e,t,r,i,f,g,N,E){if(g!=null&&typeof g!="function"&&typeof g!="symbol"&&typeof g!="boolean"&&(e.type=g),t!=null||r!=null){if(!(g!=="submit"&&g!=="reset"||t!=null)){Ca(e);return}r=r!=null?""+jn(r):"",t=t!=null?""+jn(t):r,E||t===e.value||(e.value=t),e.defaultValue=t}i=i??f,i=typeof i!="function"&&typeof i!="symbol"&&!!i,e.checked=E?e.checked:!!i,e.defaultChecked=!!i,N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"&&(e.name=N),Ca(e)}function ja(e,t,r){t==="number"&&Es(e.ownerDocument)===e||e.defaultValue===""+r||(e.defaultValue=""+r)}function Zo(e,t,r,i){if(e=e.options,t){t={};for(var f=0;f<r.length;f++)t["$"+r[f]]=!0;for(r=0;r<e.length;r++)f=t.hasOwnProperty("$"+e[r].value),e[r].selected!==f&&(e[r].selected=f),f&&i&&(e[r].defaultSelected=!0)}else{for(r=""+jn(r),t=null,f=0;f<e.length;f++){if(e[f].value===r){e[f].selected=!0,i&&(e[f].defaultSelected=!0);return}t!==null||e[f].disabled||(t=e[f])}t!==null&&(t.selected=!0)}}function Jo(e,t,r){if(t!=null&&(t=""+jn(t),t!==e.value&&(e.value=t),r==null)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=r!=null?""+jn(r):""}function Jl(e,t,r,i){if(t==null){if(i!=null){if(r!=null)throw Error(a(92));if(P(i)){if(1<i.length)throw Error(a(93));i=i[0]}r=i}r==null&&(r=""),t=r}r=jn(t),e.defaultValue=r,i=e.textContent,i===r&&i!==""&&i!==null&&(e.value=i),Ca(e)}function Or(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var vc=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function ei(e,t,r){var i=t.indexOf("--")===0;r==null||typeof r=="boolean"||r===""?i?e.setProperty(t,""):t==="float"?e.cssFloat="":e[t]="":i?e.setProperty(t,r):typeof r!="number"||r===0||vc.has(t)?t==="float"?e.cssFloat=r:e[t]=(""+r).trim():e[t]=r+"px"}function Ee(e,t,r){if(t!=null&&typeof t!="object")throw Error(a(62));if(e=e.style,r!=null){for(var i in r)!r.hasOwnProperty(i)||t!=null&&t.hasOwnProperty(i)||(i.indexOf("--")===0?e.setProperty(i,""):i==="float"?e.cssFloat="":e[i]="");for(var f in t)i=t[f],t.hasOwnProperty(f)&&r[f]!==i&&ei(e,f,i)}else for(var g in t)t.hasOwnProperty(g)&&ei(e,g,t[g])}function rt(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var vt=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),yn=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Sn(e){return yn.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function Bt(){}var er=null;function Ma(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var $o=null,Ls=null;function hh(e){var t=ie(e);if(t&&(e=t.stateNode)){var r=e[nt]||null;e:switch(e=t.stateNode,t.type){case"input":if(os(e,r.value,r.defaultValue,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll('input[name="'+Gn(""+t)+'"][type="radio"]'),t=0;t<r.length;t++){var i=r[t];if(i!==e&&i.form===e.form){var f=i[nt]||null;if(!f)throw Error(a(90));os(i,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name)}}for(t=0;t<r.length;t++)i=r[t],i.form===e.form&&Xl(i)}break e;case"textarea":Jo(e,r.value,r.defaultValue);break e;case"select":t=r.value,t!=null&&Zo(e,!!r.multiple,t,!1)}}}var wc=!1;function gh(e,t,r){if(wc)return e(t,r);wc=!0;try{var i=e(t);return i}finally{if(wc=!1,($o!==null||Ls!==null)&&(Ki(),$o&&(t=$o,e=Ls,Ls=$o=null,hh(t),e)))for(t=0;t<e.length;t++)hh(e[t])}}function Oa(e,t){var r=e.stateNode;if(r===null)return null;var i=r[nt]||null;if(i===null)return null;r=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(e=e.type,i=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!i;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(a(231,t,typeof r));return r}var tr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Sc=!1;if(tr)try{var Ta={};Object.defineProperty(Ta,"passive",{get:function(){Sc=!0}}),window.addEventListener("test",Ta,Ta),window.removeEventListener("test",Ta,Ta)}catch{Sc=!1}var Tr=null,Nc=null,ti=null;function mh(){if(ti)return ti;var e,t=Nc,r=t.length,i,f="value"in Tr?Tr.value:Tr.textContent,g=f.length;for(e=0;e<r&&t[e]===f[e];e++);var N=r-e;for(i=1;i<=N&&t[r-i]===f[g-i];i++);return ti=f.slice(e,1<i?1-i:void 0)}function ni(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function oi(){return!0}function yh(){return!1}function Zn(e){function t(r,i,f,g,N){this._reactName=r,this._targetInst=f,this.type=i,this.nativeEvent=g,this.target=N,this.currentTarget=null;for(var E in e)e.hasOwnProperty(E)&&(r=e[E],this[E]=r?r(g):g[E]);return this.isDefaultPrevented=(g.defaultPrevented!=null?g.defaultPrevented:g.returnValue===!1)?oi:yh,this.isPropagationStopped=yh,this}return x(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=oi)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=oi)},persist:function(){},isPersistent:oi}),t}var rs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ri=Zn(rs),Ea=x({},rs,{view:0,detail:0}),Cv=Zn(Ea),kc,Cc,Ia,si=x({},Ea,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Mc,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ia&&(Ia&&e.type==="mousemove"?(kc=e.screenX-Ia.screenX,Cc=e.screenY-Ia.screenY):Cc=kc=0,Ia=e),kc)},movementY:function(e){return"movementY"in e?e.movementY:Cc}}),bh=Zn(si),jv=x({},si,{dataTransfer:0}),Mv=Zn(jv),Ov=x({},Ea,{relatedTarget:0}),jc=Zn(Ov),Tv=x({},rs,{animationName:0,elapsedTime:0,pseudoElement:0}),Ev=Zn(Tv),Iv=x({},rs,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Lv=Zn(Iv),_v=x({},rs,{data:0}),xh=Zn(_v),Av={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Rv={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Dv={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Bv(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Dv[e])?!!t[e]:!1}function Mc(){return Bv}var zv=x({},Ea,{key:function(e){if(e.key){var t=Av[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=ni(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Rv[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Mc,charCode:function(e){return e.type==="keypress"?ni(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?ni(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Hv=Zn(zv),$v=x({},si,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),vh=Zn($v),Kv=x({},Ea,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Mc}),Vv=Zn(Kv),Uv=x({},rs,{propertyName:0,elapsedTime:0,pseudoElement:0}),Wv=Zn(Uv),Fv=x({},si,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),qv=Zn(Fv),Gv=x({},rs,{newState:0,oldState:0}),Pv=Zn(Gv),Yv=[9,13,27,32],Oc=tr&&"CompositionEvent"in window,La=null;tr&&"documentMode"in document&&(La=document.documentMode);var Qv=tr&&"TextEvent"in window&&!La,wh=tr&&(!Oc||La&&8<La&&11>=La),Sh=" ",Nh=!1;function kh(e,t){switch(e){case"keyup":return Yv.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ch(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var _s=!1;function Xv(e,t){switch(e){case"compositionend":return Ch(t);case"keypress":return t.which!==32?null:(Nh=!0,Sh);case"textInput":return e=t.data,e===Sh&&Nh?null:e;default:return null}}function Zv(e,t){if(_s)return e==="compositionend"||!Oc&&kh(e,t)?(e=mh(),ti=Nc=Tr=null,_s=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return wh&&t.locale!=="ko"?null:t.data;default:return null}}var Jv={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function jh(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Jv[e.type]:t==="textarea"}function Mh(e,t,r,i){$o?Ls?Ls.push(i):Ls=[i]:$o=i,t=Pi(t,"onChange"),0<t.length&&(r=new ri("onChange","change",null,r,i),e.push({event:r,listeners:t}))}var _a=null,Aa=null;function e1(e){u0(e,0)}function ai(e){var t=ot(e);if(Xl(t))return e}function Oh(e,t){if(e==="change")return t}var Th=!1;if(tr){var Tc;if(tr){var Ec="oninput"in document;if(!Ec){var Eh=document.createElement("div");Eh.setAttribute("oninput","return;"),Ec=typeof Eh.oninput=="function"}Tc=Ec}else Tc=!1;Th=Tc&&(!document.documentMode||9<document.documentMode)}function Ih(){_a&&(_a.detachEvent("onpropertychange",Lh),Aa=_a=null)}function Lh(e){if(e.propertyName==="value"&&ai(Aa)){var t=[];Mh(t,Aa,e,Ma(e)),gh(e1,t)}}function t1(e,t,r){e==="focusin"?(Ih(),_a=t,Aa=r,_a.attachEvent("onpropertychange",Lh)):e==="focusout"&&Ih()}function n1(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return ai(Aa)}function o1(e,t){if(e==="click")return ai(t)}function r1(e,t){if(e==="input"||e==="change")return ai(t)}function s1(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var io=typeof Object.is=="function"?Object.is:s1;function Ra(e,t){if(io(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),i=Object.keys(t);if(r.length!==i.length)return!1;for(i=0;i<r.length;i++){var f=r[i];if(!G.call(t,f)||!io(e[f],t[f]))return!1}return!0}function _h(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Ah(e,t){var r=_h(e);e=0;for(var i;r;){if(r.nodeType===3){if(i=e+r.textContent.length,e<=t&&i>=t)return{node:r,offset:t-e};e=i}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=_h(r)}}function Rh(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Rh(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Dh(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var t=Es(e.document);t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Es(e.document)}return t}function Ic(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}var a1=tr&&"documentMode"in document&&11>=document.documentMode,As=null,Lc=null,Da=null,_c=!1;function Bh(e,t,r){var i=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;_c||As==null||As!==Es(i)||(i=As,"selectionStart"in i&&Ic(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),Da&&Ra(Da,i)||(Da=i,i=Pi(Lc,"onSelect"),0<i.length&&(t=new ri("onSelect","select",null,t,r),e.push({event:t,listeners:i}),t.target=As)))}function ss(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Rs={animationend:ss("Animation","AnimationEnd"),animationiteration:ss("Animation","AnimationIteration"),animationstart:ss("Animation","AnimationStart"),transitionrun:ss("Transition","TransitionRun"),transitionstart:ss("Transition","TransitionStart"),transitioncancel:ss("Transition","TransitionCancel"),transitionend:ss("Transition","TransitionEnd")},Ac={},zh={};tr&&(zh=document.createElement("div").style,"AnimationEvent"in window||(delete Rs.animationend.animation,delete Rs.animationiteration.animation,delete Rs.animationstart.animation),"TransitionEvent"in window||delete Rs.transitionend.transition);function as(e){if(Ac[e])return Ac[e];if(!Rs[e])return e;var t=Rs[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in zh)return Ac[e]=t[r];return e}var Hh=as("animationend"),$h=as("animationiteration"),Kh=as("animationstart"),l1=as("transitionrun"),i1=as("transitionstart"),u1=as("transitioncancel"),Vh=as("transitionend"),Uh=new Map,Rc="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Rc.push("scrollEnd");function Lo(e,t){Uh.set(e,t),mt(t,[e])}var li=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},wo=[],Ds=0,Dc=0;function ii(){for(var e=Ds,t=Dc=Ds=0;t<e;){var r=wo[t];wo[t++]=null;var i=wo[t];wo[t++]=null;var f=wo[t];wo[t++]=null;var g=wo[t];if(wo[t++]=null,i!==null&&f!==null){var N=i.pending;N===null?f.next=f:(f.next=N.next,N.next=f),i.pending=f}g!==0&&Wh(r,f,g)}}function ui(e,t,r,i){wo[Ds++]=e,wo[Ds++]=t,wo[Ds++]=r,wo[Ds++]=i,Dc|=i,e.lanes|=i,e=e.alternate,e!==null&&(e.lanes|=i)}function Bc(e,t,r,i){return ui(e,t,r,i),ci(e)}function ls(e,t){return ui(e,null,null,t),ci(e)}function Wh(e,t,r){e.lanes|=r;var i=e.alternate;i!==null&&(i.lanes|=r);for(var f=!1,g=e.return;g!==null;)g.childLanes|=r,i=g.alternate,i!==null&&(i.childLanes|=r),g.tag===22&&(e=g.stateNode,e===null||e._visibility&1||(f=!0)),e=g,g=g.return;return e.tag===3?(g=e.stateNode,f&&t!==null&&(f=31-he(r),e=g.hiddenUpdates,i=e[f],i===null?e[f]=[t]:i.push(t),t.lane=r|536870912),g):null}function ci(e){if(50<rl)throw rl=0,qd=null,Error(a(185));for(var t=e.return;t!==null;)e=t,t=e.return;return e.tag===3?e.stateNode:null}var Bs={};function c1(e,t,r,i){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function uo(e,t,r,i){return new c1(e,t,r,i)}function zc(e){return e=e.prototype,!(!e||!e.isReactComponent)}function nr(e,t){var r=e.alternate;return r===null?(r=uo(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&65011712,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r.refCleanup=e.refCleanup,r}function Fh(e,t){e.flags&=65011714;var r=e.alternate;return r===null?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=r.childLanes,e.lanes=r.lanes,e.child=r.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=r.memoizedProps,e.memoizedState=r.memoizedState,e.updateQueue=r.updateQueue,e.type=r.type,t=r.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function di(e,t,r,i,f,g){var N=0;if(i=e,typeof e=="function")zc(e)&&(N=1);else if(typeof e=="string")N=gw(e,r,je.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case te:return e=uo(31,r,t,f),e.elementType=te,e.lanes=g,e;case S:return is(r.children,f,g,t);case j:N=8,f|=24;break;case C:return e=uo(12,r,t,f|2),e.elementType=C,e.lanes=g,e;case L:return e=uo(13,r,t,f),e.elementType=L,e.lanes=g,e;case B:return e=uo(19,r,t,f),e.elementType=B,e.lanes=g,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case R:N=10;break e;case T:N=9;break e;case D:N=11;break e;case A:N=14;break e;case F:N=16,i=null;break e}N=29,r=Error(a(130,e===null?"null":typeof e,"")),i=null}return t=uo(N,r,t,f),t.elementType=e,t.type=i,t.lanes=g,t}function is(e,t,r,i){return e=uo(7,e,i,t),e.lanes=r,e}function Hc(e,t,r){return e=uo(6,e,null,t),e.lanes=r,e}function qh(e){var t=uo(18,null,null,0);return t.stateNode=e,t}function $c(e,t,r){return t=uo(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Gh=new WeakMap;function So(e,t){if(typeof e=="object"&&e!==null){var r=Gh.get(e);return r!==void 0?r:(t={value:e,source:t,stack:W(t)},Gh.set(e,t),t)}return{value:e,source:t,stack:W(t)}}var zs=[],Hs=0,fi=null,Ba=0,No=[],ko=0,Er=null,Ko=1,Vo="";function or(e,t){zs[Hs++]=Ba,zs[Hs++]=fi,fi=e,Ba=t}function Ph(e,t,r){No[ko++]=Ko,No[ko++]=Vo,No[ko++]=Er,Er=e;var i=Ko;e=Vo;var f=32-he(i)-1;i&=~(1<<f),r+=1;var g=32-he(t)+f;if(30<g){var N=f-f%5;g=(i&(1<<N)-1).toString(32),i>>=N,f-=N,Ko=1<<32-he(t)+f|r<<f|i,Vo=g+e}else Ko=1<<g|r<<f|i,Vo=e}function Kc(e){e.return!==null&&(or(e,1),Ph(e,1,0))}function Vc(e){for(;e===fi;)fi=zs[--Hs],zs[Hs]=null,Ba=zs[--Hs],zs[Hs]=null;for(;e===Er;)Er=No[--ko],No[ko]=null,Vo=No[--ko],No[ko]=null,Ko=No[--ko],No[ko]=null}function Yh(e,t){No[ko++]=Ko,No[ko++]=Vo,No[ko++]=Er,Ko=t.id,Vo=t.overflow,Er=e}var Bn=null,bn=null,Pt=!1,Ir=null,Co=!1,Uc=Error(a(519));function Lr(e){var t=Error(a(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw za(So(t,e)),Uc}function Qh(e){var t=e.stateNode,r=e.type,i=e.memoizedProps;switch(t[dt]=e,t[nt]=i,r){case"dialog":Wt("cancel",t),Wt("close",t);break;case"iframe":case"object":case"embed":Wt("load",t);break;case"video":case"audio":for(r=0;r<al.length;r++)Wt(al[r],t);break;case"source":Wt("error",t);break;case"img":case"image":case"link":Wt("error",t),Wt("load",t);break;case"details":Wt("toggle",t);break;case"input":Wt("invalid",t),Zl(t,i.value,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name,!0);break;case"select":Wt("invalid",t);break;case"textarea":Wt("invalid",t),Jl(t,i.value,i.defaultValue,i.children)}r=i.children,typeof r!="string"&&typeof r!="number"&&typeof r!="bigint"||t.textContent===""+r||i.suppressHydrationWarning===!0||p0(t.textContent,r)?(i.popover!=null&&(Wt("beforetoggle",t),Wt("toggle",t)),i.onScroll!=null&&Wt("scroll",t),i.onScrollEnd!=null&&Wt("scrollend",t),i.onClick!=null&&(t.onclick=Bt),t=!0):t=!1,t||Lr(e,!0)}function Xh(e){for(Bn=e.return;Bn;)switch(Bn.tag){case 5:case 31:case 13:Co=!1;return;case 27:case 3:Co=!0;return;default:Bn=Bn.return}}function $s(e){if(e!==Bn)return!1;if(!Pt)return Xh(e),Pt=!0,!1;var t=e.tag,r;if((r=t!==3&&t!==27)&&((r=t===5)&&(r=e.type,r=!(r!=="form"&&r!=="button")||lf(e.type,e.memoizedProps)),r=!r),r&&bn&&Lr(e),Xh(e),t===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(a(317));bn=S0(e)}else if(t===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(a(317));bn=S0(e)}else t===27?(t=bn,qr(e.type)?(e=pf,pf=null,bn=e):bn=t):bn=Bn?Mo(e.stateNode.nextSibling):null;return!0}function us(){bn=Bn=null,Pt=!1}function Wc(){var e=Ir;return e!==null&&(no===null?no=e:no.push.apply(no,e),Ir=null),e}function za(e){Ir===null?Ir=[e]:Ir.push(e)}var Fc=O(null),cs=null,rr=null;function _r(e,t,r){q(Fc,t._currentValue),t._currentValue=r}function sr(e){e._currentValue=Fc.current,_(Fc)}function qc(e,t,r){for(;e!==null;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,i!==null&&(i.childLanes|=t)):i!==null&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===r)break;e=e.return}}function Gc(e,t,r,i){var f=e.child;for(f!==null&&(f.return=e);f!==null;){var g=f.dependencies;if(g!==null){var N=f.child;g=g.firstContext;e:for(;g!==null;){var E=g;g=f;for(var X=0;X<t.length;X++)if(E.context===t[X]){g.lanes|=r,E=g.alternate,E!==null&&(E.lanes|=r),qc(g.return,r,e),i||(N=null);break e}g=E.next}}else if(f.tag===18){if(N=f.return,N===null)throw Error(a(341));N.lanes|=r,g=N.alternate,g!==null&&(g.lanes|=r),qc(N,r,e),N=null}else N=f.child;if(N!==null)N.return=f;else for(N=f;N!==null;){if(N===e){N=null;break}if(f=N.sibling,f!==null){f.return=N.return,N=f;break}N=N.return}f=N}}function Ks(e,t,r,i){e=null;for(var f=t,g=!1;f!==null;){if(!g){if((f.flags&524288)!==0)g=!0;else if((f.flags&262144)!==0)break}if(f.tag===10){var N=f.alternate;if(N===null)throw Error(a(387));if(N=N.memoizedProps,N!==null){var E=f.type;io(f.pendingProps.value,N.value)||(e!==null?e.push(E):e=[E])}}else if(f===Fe.current){if(N=f.alternate,N===null)throw Error(a(387));N.memoizedState.memoizedState!==f.memoizedState.memoizedState&&(e!==null?e.push(dl):e=[dl])}f=f.return}e!==null&&Gc(t,e,r,i),t.flags|=262144}function pi(e){for(e=e.firstContext;e!==null;){if(!io(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function ds(e){cs=e,rr=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function zn(e){return Zh(cs,e)}function hi(e,t){return cs===null&&ds(e),Zh(e,t)}function Zh(e,t){var r=t._currentValue;if(t={context:t,memoizedValue:r,next:null},rr===null){if(e===null)throw Error(a(308));rr=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else rr=rr.next=t;return r}var d1=typeof AbortController<"u"?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(r,i){e.push(i)}};this.abort=function(){t.aborted=!0,e.forEach(function(r){return r()})}},f1=n.unstable_scheduleCallback,p1=n.unstable_NormalPriority,Tn={$$typeof:R,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Pc(){return{controller:new d1,data:new Map,refCount:0}}function Ha(e){e.refCount--,e.refCount===0&&f1(p1,function(){e.controller.abort()})}var $a=null,Yc=0,Vs=0,Us=null;function h1(e,t){if($a===null){var r=$a=[];Yc=0,Vs=Zd(),Us={status:"pending",value:void 0,then:function(i){r.push(i)}}}return Yc++,t.then(Jh,Jh),t}function Jh(){if(--Yc===0&&$a!==null){Us!==null&&(Us.status="fulfilled");var e=$a;$a=null,Vs=0,Us=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function g1(e,t){var r=[],i={status:"pending",value:null,reason:null,then:function(f){r.push(f)}};return e.then(function(){i.status="fulfilled",i.value=t;for(var f=0;f<r.length;f++)(0,r[f])(t)},function(f){for(i.status="rejected",i.reason=f,f=0;f<r.length;f++)(0,r[f])(void 0)}),i}var eg=V.S;V.S=function(e,t){Bm=Q(),typeof t=="object"&&t!==null&&typeof t.then=="function"&&h1(e,t),eg!==null&&eg(e,t)};var fs=O(null);function Qc(){var e=fs.current;return e!==null?e:hn.pooledCache}function gi(e,t){t===null?q(fs,fs.current):q(fs,t.pool)}function tg(){var e=Qc();return e===null?null:{parent:Tn._currentValue,pool:e}}var Ws=Error(a(460)),Xc=Error(a(474)),mi=Error(a(542)),yi={then:function(){}};function ng(e){return e=e.status,e==="fulfilled"||e==="rejected"}function og(e,t,r){switch(r=e[r],r===void 0?e.push(t):r!==t&&(t.then(Bt,Bt),t=r),t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,sg(e),e;default:if(typeof t.status=="string")t.then(Bt,Bt);else{if(e=hn,e!==null&&100<e.shellSuspendCounter)throw Error(a(482));e=t,e.status="pending",e.then(function(i){if(t.status==="pending"){var f=t;f.status="fulfilled",f.value=i}},function(i){if(t.status==="pending"){var f=t;f.status="rejected",f.reason=i}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,sg(e),e}throw hs=t,Ws}}function ps(e){try{var t=e._init;return t(e._payload)}catch(r){throw r!==null&&typeof r=="object"&&typeof r.then=="function"?(hs=r,Ws):r}}var hs=null;function rg(){if(hs===null)throw Error(a(459));var e=hs;return hs=null,e}function sg(e){if(e===Ws||e===mi)throw Error(a(483))}var Fs=null,Ka=0;function bi(e){var t=Ka;return Ka+=1,Fs===null&&(Fs=[]),og(Fs,e,t)}function Va(e,t){t=t.props.ref,e.ref=t!==void 0?t:null}function xi(e,t){throw t.$$typeof===v?Error(a(525)):(e=Object.prototype.toString.call(t),Error(a(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)))}function ag(e){function t(ge,le){if(e){var ve=ge.deletions;ve===null?(ge.deletions=[le],ge.flags|=16):ve.push(le)}}function r(ge,le){if(!e)return null;for(;le!==null;)t(ge,le),le=le.sibling;return null}function i(ge){for(var le=new Map;ge!==null;)ge.key!==null?le.set(ge.key,ge):le.set(ge.index,ge),ge=ge.sibling;return le}function f(ge,le){return ge=nr(ge,le),ge.index=0,ge.sibling=null,ge}function g(ge,le,ve){return ge.index=ve,e?(ve=ge.alternate,ve!==null?(ve=ve.index,ve<le?(ge.flags|=67108866,le):ve):(ge.flags|=67108866,le)):(ge.flags|=1048576,le)}function N(ge){return e&&ge.alternate===null&&(ge.flags|=67108866),ge}function E(ge,le,ve,He){return le===null||le.tag!==6?(le=Hc(ve,ge.mode,He),le.return=ge,le):(le=f(le,ve),le.return=ge,le)}function X(ge,le,ve,He){var St=ve.type;return St===S?ze(ge,le,ve.props.children,He,ve.key):le!==null&&(le.elementType===St||typeof St=="object"&&St!==null&&St.$$typeof===F&&ps(St)===le.type)?(le=f(le,ve.props),Va(le,ve),le.return=ge,le):(le=di(ve.type,ve.key,ve.props,null,ge.mode,He),Va(le,ve),le.return=ge,le)}function we(ge,le,ve,He){return le===null||le.tag!==4||le.stateNode.containerInfo!==ve.containerInfo||le.stateNode.implementation!==ve.implementation?(le=$c(ve,ge.mode,He),le.return=ge,le):(le=f(le,ve.children||[]),le.return=ge,le)}function ze(ge,le,ve,He,St){return le===null||le.tag!==7?(le=is(ve,ge.mode,He,St),le.return=ge,le):(le=f(le,ve),le.return=ge,le)}function $e(ge,le,ve){if(typeof le=="string"&&le!==""||typeof le=="number"||typeof le=="bigint")return le=Hc(""+le,ge.mode,ve),le.return=ge,le;if(typeof le=="object"&&le!==null){switch(le.$$typeof){case k:return ve=di(le.type,le.key,le.props,null,ge.mode,ve),Va(ve,le),ve.return=ge,ve;case w:return le=$c(le,ge.mode,ve),le.return=ge,le;case F:return le=ps(le),$e(ge,le,ve)}if(P(le)||ne(le))return le=is(le,ge.mode,ve,null),le.return=ge,le;if(typeof le.then=="function")return $e(ge,bi(le),ve);if(le.$$typeof===R)return $e(ge,hi(ge,le),ve);xi(ge,le)}return null}function Ce(ge,le,ve,He){var St=le!==null?le.key:null;if(typeof ve=="string"&&ve!==""||typeof ve=="number"||typeof ve=="bigint")return St!==null?null:E(ge,le,""+ve,He);if(typeof ve=="object"&&ve!==null){switch(ve.$$typeof){case k:return ve.key===St?X(ge,le,ve,He):null;case w:return ve.key===St?we(ge,le,ve,He):null;case F:return ve=ps(ve),Ce(ge,le,ve,He)}if(P(ve)||ne(ve))return St!==null?null:ze(ge,le,ve,He,null);if(typeof ve.then=="function")return Ce(ge,le,bi(ve),He);if(ve.$$typeof===R)return Ce(ge,le,hi(ge,ve),He);xi(ge,ve)}return null}function Ae(ge,le,ve,He,St){if(typeof He=="string"&&He!==""||typeof He=="number"||typeof He=="bigint")return ge=ge.get(ve)||null,E(le,ge,""+He,St);if(typeof He=="object"&&He!==null){switch(He.$$typeof){case k:return ge=ge.get(He.key===null?ve:He.key)||null,X(le,ge,He,St);case w:return ge=ge.get(He.key===null?ve:He.key)||null,we(le,ge,He,St);case F:return He=ps(He),Ae(ge,le,ve,He,St)}if(P(He)||ne(He))return ge=ge.get(ve)||null,ze(le,ge,He,St,null);if(typeof He.then=="function")return Ae(ge,le,ve,bi(He),St);if(He.$$typeof===R)return Ae(ge,le,ve,hi(le,He),St);xi(le,He)}return null}function ft(ge,le,ve,He){for(var St=null,Xt=null,ht=le,$t=le=0,qt=null;ht!==null&&$t<ve.length;$t++){ht.index>$t?(qt=ht,ht=null):qt=ht.sibling;var Zt=Ce(ge,ht,ve[$t],He);if(Zt===null){ht===null&&(ht=qt);break}e&&ht&&Zt.alternate===null&&t(ge,ht),le=g(Zt,le,$t),Xt===null?St=Zt:Xt.sibling=Zt,Xt=Zt,ht=qt}if($t===ve.length)return r(ge,ht),Pt&&or(ge,$t),St;if(ht===null){for(;$t<ve.length;$t++)ht=$e(ge,ve[$t],He),ht!==null&&(le=g(ht,le,$t),Xt===null?St=ht:Xt.sibling=ht,Xt=ht);return Pt&&or(ge,$t),St}for(ht=i(ht);$t<ve.length;$t++)qt=Ae(ht,ge,$t,ve[$t],He),qt!==null&&(e&&qt.alternate!==null&&ht.delete(qt.key===null?$t:qt.key),le=g(qt,le,$t),Xt===null?St=qt:Xt.sibling=qt,Xt=qt);return e&&ht.forEach(function(Xr){return t(ge,Xr)}),Pt&&or(ge,$t),St}function Mt(ge,le,ve,He){if(ve==null)throw Error(a(151));for(var St=null,Xt=null,ht=le,$t=le=0,qt=null,Zt=ve.next();ht!==null&&!Zt.done;$t++,Zt=ve.next()){ht.index>$t?(qt=ht,ht=null):qt=ht.sibling;var Xr=Ce(ge,ht,Zt.value,He);if(Xr===null){ht===null&&(ht=qt);break}e&&ht&&Xr.alternate===null&&t(ge,ht),le=g(Xr,le,$t),Xt===null?St=Xr:Xt.sibling=Xr,Xt=Xr,ht=qt}if(Zt.done)return r(ge,ht),Pt&&or(ge,$t),St;if(ht===null){for(;!Zt.done;$t++,Zt=ve.next())Zt=$e(ge,Zt.value,He),Zt!==null&&(le=g(Zt,le,$t),Xt===null?St=Zt:Xt.sibling=Zt,Xt=Zt);return Pt&&or(ge,$t),St}for(ht=i(ht);!Zt.done;$t++,Zt=ve.next())Zt=Ae(ht,ge,$t,Zt.value,He),Zt!==null&&(e&&Zt.alternate!==null&&ht.delete(Zt.key===null?$t:Zt.key),le=g(Zt,le,$t),Xt===null?St=Zt:Xt.sibling=Zt,Xt=Zt);return e&&ht.forEach(function(jw){return t(ge,jw)}),Pt&&or(ge,$t),St}function pn(ge,le,ve,He){if(typeof ve=="object"&&ve!==null&&ve.type===S&&ve.key===null&&(ve=ve.props.children),typeof ve=="object"&&ve!==null){switch(ve.$$typeof){case k:e:{for(var St=ve.key;le!==null;){if(le.key===St){if(St=ve.type,St===S){if(le.tag===7){r(ge,le.sibling),He=f(le,ve.props.children),He.return=ge,ge=He;break e}}else if(le.elementType===St||typeof St=="object"&&St!==null&&St.$$typeof===F&&ps(St)===le.type){r(ge,le.sibling),He=f(le,ve.props),Va(He,ve),He.return=ge,ge=He;break e}r(ge,le);break}else t(ge,le);le=le.sibling}ve.type===S?(He=is(ve.props.children,ge.mode,He,ve.key),He.return=ge,ge=He):(He=di(ve.type,ve.key,ve.props,null,ge.mode,He),Va(He,ve),He.return=ge,ge=He)}return N(ge);case w:e:{for(St=ve.key;le!==null;){if(le.key===St)if(le.tag===4&&le.stateNode.containerInfo===ve.containerInfo&&le.stateNode.implementation===ve.implementation){r(ge,le.sibling),He=f(le,ve.children||[]),He.return=ge,ge=He;break e}else{r(ge,le);break}else t(ge,le);le=le.sibling}He=$c(ve,ge.mode,He),He.return=ge,ge=He}return N(ge);case F:return ve=ps(ve),pn(ge,le,ve,He)}if(P(ve))return ft(ge,le,ve,He);if(ne(ve)){if(St=ne(ve),typeof St!="function")throw Error(a(150));return ve=St.call(ve),Mt(ge,le,ve,He)}if(typeof ve.then=="function")return pn(ge,le,bi(ve),He);if(ve.$$typeof===R)return pn(ge,le,hi(ge,ve),He);xi(ge,ve)}return typeof ve=="string"&&ve!==""||typeof ve=="number"||typeof ve=="bigint"?(ve=""+ve,le!==null&&le.tag===6?(r(ge,le.sibling),He=f(le,ve),He.return=ge,ge=He):(r(ge,le),He=Hc(ve,ge.mode,He),He.return=ge,ge=He),N(ge)):r(ge,le)}return function(ge,le,ve,He){try{Ka=0;var St=pn(ge,le,ve,He);return Fs=null,St}catch(ht){if(ht===Ws||ht===mi)throw ht;var Xt=uo(29,ht,null,ge.mode);return Xt.lanes=He,Xt.return=ge,Xt}}}var gs=ag(!0),lg=ag(!1),Ar=!1;function Zc(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Jc(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function Rr(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function Dr(e,t,r){var i=e.updateQueue;if(i===null)return null;if(i=i.shared,(tn&2)!==0){var f=i.pending;return f===null?t.next=t:(t.next=f.next,f.next=t),i.pending=t,t=ci(e),Wh(e,null,r),t}return ui(e,i,t,r),ci(e)}function Ua(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194048)!==0)){var i=t.lanes;i&=e.pendingLanes,r|=i,t.lanes=r,Be(e,r)}}function ed(e,t){var r=e.updateQueue,i=e.alternate;if(i!==null&&(i=i.updateQueue,r===i)){var f=null,g=null;if(r=r.firstBaseUpdate,r!==null){do{var N={lane:r.lane,tag:r.tag,payload:r.payload,callback:null,next:null};g===null?f=g=N:g=g.next=N,r=r.next}while(r!==null);g===null?f=g=t:g=g.next=t}else f=g=t;r={baseState:i.baseState,firstBaseUpdate:f,lastBaseUpdate:g,shared:i.shared,callbacks:i.callbacks},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}var td=!1;function Wa(){if(td){var e=Us;if(e!==null)throw e}}function Fa(e,t,r,i){td=!1;var f=e.updateQueue;Ar=!1;var g=f.firstBaseUpdate,N=f.lastBaseUpdate,E=f.shared.pending;if(E!==null){f.shared.pending=null;var X=E,we=X.next;X.next=null,N===null?g=we:N.next=we,N=X;var ze=e.alternate;ze!==null&&(ze=ze.updateQueue,E=ze.lastBaseUpdate,E!==N&&(E===null?ze.firstBaseUpdate=we:E.next=we,ze.lastBaseUpdate=X))}if(g!==null){var $e=f.baseState;N=0,ze=we=X=null,E=g;do{var Ce=E.lane&-536870913,Ae=Ce!==E.lane;if(Ae?(Ft&Ce)===Ce:(i&Ce)===Ce){Ce!==0&&Ce===Vs&&(td=!0),ze!==null&&(ze=ze.next={lane:0,tag:E.tag,payload:E.payload,callback:null,next:null});e:{var ft=e,Mt=E;Ce=t;var pn=r;switch(Mt.tag){case 1:if(ft=Mt.payload,typeof ft=="function"){$e=ft.call(pn,$e,Ce);break e}$e=ft;break e;case 3:ft.flags=ft.flags&-65537|128;case 0:if(ft=Mt.payload,Ce=typeof ft=="function"?ft.call(pn,$e,Ce):ft,Ce==null)break e;$e=x({},$e,Ce);break e;case 2:Ar=!0}}Ce=E.callback,Ce!==null&&(e.flags|=64,Ae&&(e.flags|=8192),Ae=f.callbacks,Ae===null?f.callbacks=[Ce]:Ae.push(Ce))}else Ae={lane:Ce,tag:E.tag,payload:E.payload,callback:E.callback,next:null},ze===null?(we=ze=Ae,X=$e):ze=ze.next=Ae,N|=Ce;if(E=E.next,E===null){if(E=f.shared.pending,E===null)break;Ae=E,E=Ae.next,Ae.next=null,f.lastBaseUpdate=Ae,f.shared.pending=null}}while(!0);ze===null&&(X=$e),f.baseState=X,f.firstBaseUpdate=we,f.lastBaseUpdate=ze,g===null&&(f.shared.lanes=0),Kr|=N,e.lanes=N,e.memoizedState=$e}}function ig(e,t){if(typeof e!="function")throw Error(a(191,e));e.call(t)}function ug(e,t){var r=e.callbacks;if(r!==null)for(e.callbacks=null,e=0;e<r.length;e++)ig(r[e],t)}var qs=O(null),vi=O(0);function cg(e,t){e=hr,q(vi,e),q(qs,t),hr=e|t.baseLanes}function nd(){q(vi,hr),q(qs,qs.current)}function od(){hr=vi.current,_(qs),_(vi)}var co=O(null),jo=null;function Br(e){var t=e.alternate;q(Mn,Mn.current&1),q(co,e),jo===null&&(t===null||qs.current!==null||t.memoizedState!==null)&&(jo=e)}function rd(e){q(Mn,Mn.current),q(co,e),jo===null&&(jo=e)}function dg(e){e.tag===22?(q(Mn,Mn.current),q(co,e),jo===null&&(jo=e)):zr()}function zr(){q(Mn,Mn.current),q(co,co.current)}function fo(e){_(co),jo===e&&(jo=null),_(Mn)}var Mn=O(0);function wi(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||df(r)||ff(r)))return t}else if(t.tag===19&&(t.memoizedProps.revealOrder==="forwards"||t.memoizedProps.revealOrder==="backwards"||t.memoizedProps.revealOrder==="unstable_legacy-backwards"||t.memoizedProps.revealOrder==="together")){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ar=0,zt=null,dn=null,En=null,Si=!1,Gs=!1,ms=!1,Ni=0,qa=0,Ps=null,m1=0;function Nn(){throw Error(a(321))}function sd(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!io(e[r],t[r]))return!1;return!0}function ad(e,t,r,i,f,g){return ar=g,zt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,V.H=e===null||e.memoizedState===null?Pg:wd,ms=!1,g=r(i,f),ms=!1,Gs&&(g=pg(t,r,i,f)),fg(e),g}function fg(e){V.H=Ya;var t=dn!==null&&dn.next!==null;if(ar=0,En=dn=zt=null,Si=!1,qa=0,Ps=null,t)throw Error(a(300));e===null||In||(e=e.dependencies,e!==null&&pi(e)&&(In=!0))}function pg(e,t,r,i){zt=e;var f=0;do{if(Gs&&(Ps=null),qa=0,Gs=!1,25<=f)throw Error(a(301));if(f+=1,En=dn=null,e.updateQueue!=null){var g=e.updateQueue;g.lastEffect=null,g.events=null,g.stores=null,g.memoCache!=null&&(g.memoCache.index=0)}V.H=Yg,g=t(r,i)}while(Gs);return g}function y1(){var e=V.H,t=e.useState()[0];return t=typeof t.then=="function"?Ga(t):t,e=e.useState()[0],(dn!==null?dn.memoizedState:null)!==e&&(zt.flags|=1024),t}function ld(){var e=Ni!==0;return Ni=0,e}function id(e,t,r){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r}function ud(e){if(Si){for(e=e.memoizedState;e!==null;){var t=e.queue;t!==null&&(t.pending=null),e=e.next}Si=!1}ar=0,En=dn=zt=null,Gs=!1,qa=Ni=0,Ps=null}function Pn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return En===null?zt.memoizedState=En=e:En=En.next=e,En}function On(){if(dn===null){var e=zt.alternate;e=e!==null?e.memoizedState:null}else e=dn.next;var t=En===null?zt.memoizedState:En.next;if(t!==null)En=t,dn=e;else{if(e===null)throw zt.alternate===null?Error(a(467)):Error(a(310));dn=e,e={memoizedState:dn.memoizedState,baseState:dn.baseState,baseQueue:dn.baseQueue,queue:dn.queue,next:null},En===null?zt.memoizedState=En=e:En=En.next=e}return En}function ki(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ga(e){var t=qa;return qa+=1,Ps===null&&(Ps=[]),e=og(Ps,e,t),t=zt,(En===null?t.memoizedState:En.next)===null&&(t=t.alternate,V.H=t===null||t.memoizedState===null?Pg:wd),e}function Ci(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return Ga(e);if(e.$$typeof===R)return zn(e)}throw Error(a(438,String(e)))}function cd(e){var t=null,r=zt.updateQueue;if(r!==null&&(t=r.memoCache),t==null){var i=zt.alternate;i!==null&&(i=i.updateQueue,i!==null&&(i=i.memoCache,i!=null&&(t={data:i.data.map(function(f){return f.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),r===null&&(r=ki(),zt.updateQueue=r),r.memoCache=t,r=t.data[t.index],r===void 0)for(r=t.data[t.index]=Array(e),i=0;i<e;i++)r[i]=ee;return t.index++,r}function lr(e,t){return typeof t=="function"?t(e):t}function ji(e){var t=On();return dd(t,dn,e)}function dd(e,t,r){var i=e.queue;if(i===null)throw Error(a(311));i.lastRenderedReducer=r;var f=e.baseQueue,g=i.pending;if(g!==null){if(f!==null){var N=f.next;f.next=g.next,g.next=N}t.baseQueue=f=g,i.pending=null}if(g=e.baseState,f===null)e.memoizedState=g;else{t=f.next;var E=N=null,X=null,we=t,ze=!1;do{var $e=we.lane&-536870913;if($e!==we.lane?(Ft&$e)===$e:(ar&$e)===$e){var Ce=we.revertLane;if(Ce===0)X!==null&&(X=X.next={lane:0,revertLane:0,gesture:null,action:we.action,hasEagerState:we.hasEagerState,eagerState:we.eagerState,next:null}),$e===Vs&&(ze=!0);else if((ar&Ce)===Ce){we=we.next,Ce===Vs&&(ze=!0);continue}else $e={lane:0,revertLane:we.revertLane,gesture:null,action:we.action,hasEagerState:we.hasEagerState,eagerState:we.eagerState,next:null},X===null?(E=X=$e,N=g):X=X.next=$e,zt.lanes|=Ce,Kr|=Ce;$e=we.action,ms&&r(g,$e),g=we.hasEagerState?we.eagerState:r(g,$e)}else Ce={lane:$e,revertLane:we.revertLane,gesture:we.gesture,action:we.action,hasEagerState:we.hasEagerState,eagerState:we.eagerState,next:null},X===null?(E=X=Ce,N=g):X=X.next=Ce,zt.lanes|=$e,Kr|=$e;we=we.next}while(we!==null&&we!==t);if(X===null?N=g:X.next=E,!io(g,e.memoizedState)&&(In=!0,ze&&(r=Us,r!==null)))throw r;e.memoizedState=g,e.baseState=N,e.baseQueue=X,i.lastRenderedState=g}return f===null&&(i.lanes=0),[e.memoizedState,i.dispatch]}function fd(e){var t=On(),r=t.queue;if(r===null)throw Error(a(311));r.lastRenderedReducer=e;var i=r.dispatch,f=r.pending,g=t.memoizedState;if(f!==null){r.pending=null;var N=f=f.next;do g=e(g,N.action),N=N.next;while(N!==f);io(g,t.memoizedState)||(In=!0),t.memoizedState=g,t.baseQueue===null&&(t.baseState=g),r.lastRenderedState=g}return[g,i]}function hg(e,t,r){var i=zt,f=On(),g=Pt;if(g){if(r===void 0)throw Error(a(407));r=r()}else r=t();var N=!io((dn||f).memoizedState,r);if(N&&(f.memoizedState=r,In=!0),f=f.queue,gd(yg.bind(null,i,f,e),[e]),f.getSnapshot!==t||N||En!==null&&En.memoizedState.tag&1){if(i.flags|=2048,Ys(9,{destroy:void 0},mg.bind(null,i,f,r,t),null),hn===null)throw Error(a(349));g||(ar&127)!==0||gg(i,t,r)}return r}function gg(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=zt.updateQueue,t===null?(t=ki(),zt.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function mg(e,t,r,i){t.value=r,t.getSnapshot=i,bg(t)&&xg(e)}function yg(e,t,r){return r(function(){bg(t)&&xg(e)})}function bg(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!io(e,r)}catch{return!0}}function xg(e){var t=ls(e,2);t!==null&&oo(t,e,2)}function pd(e){var t=Pn();if(typeof e=="function"){var r=e;if(e=r(),ms){Pe(!0);try{r()}finally{Pe(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:lr,lastRenderedState:e},t}function vg(e,t,r,i){return e.baseState=r,dd(e,dn,typeof i=="function"?i:lr)}function b1(e,t,r,i,f){if(Ti(e))throw Error(a(485));if(e=t.action,e!==null){var g={payload:f,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(N){g.listeners.push(N)}};V.T!==null?r(!0):g.isTransition=!1,i(g),r=t.pending,r===null?(g.next=t.pending=g,wg(t,g)):(g.next=r.next,t.pending=r.next=g)}}function wg(e,t){var r=t.action,i=t.payload,f=e.state;if(t.isTransition){var g=V.T,N={};V.T=N;try{var E=r(f,i),X=V.S;X!==null&&X(N,E),Sg(e,t,E)}catch(we){hd(e,t,we)}finally{g!==null&&N.types!==null&&(g.types=N.types),V.T=g}}else try{g=r(f,i),Sg(e,t,g)}catch(we){hd(e,t,we)}}function Sg(e,t,r){r!==null&&typeof r=="object"&&typeof r.then=="function"?r.then(function(i){Ng(e,t,i)},function(i){return hd(e,t,i)}):Ng(e,t,r)}function Ng(e,t,r){t.status="fulfilled",t.value=r,kg(t),e.state=r,t=e.pending,t!==null&&(r=t.next,r===t?e.pending=null:(r=r.next,t.next=r,wg(e,r)))}function hd(e,t,r){var i=e.pending;if(e.pending=null,i!==null){i=i.next;do t.status="rejected",t.reason=r,kg(t),t=t.next;while(t!==i)}e.action=null}function kg(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function Cg(e,t){return t}function jg(e,t){if(Pt){var r=hn.formState;if(r!==null){e:{var i=zt;if(Pt){if(bn){t:{for(var f=bn,g=Co;f.nodeType!==8;){if(!g){f=null;break t}if(f=Mo(f.nextSibling),f===null){f=null;break t}}g=f.data,f=g==="F!"||g==="F"?f:null}if(f){bn=Mo(f.nextSibling),i=f.data==="F!";break e}}Lr(i)}i=!1}i&&(t=r[0])}}return r=Pn(),r.memoizedState=r.baseState=t,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Cg,lastRenderedState:t},r.queue=i,r=Fg.bind(null,zt,i),i.dispatch=r,i=pd(!1),g=vd.bind(null,zt,!1,i.queue),i=Pn(),f={state:t,dispatch:null,action:e,pending:null},i.queue=f,r=b1.bind(null,zt,f,g,r),f.dispatch=r,i.memoizedState=e,[t,r,!1]}function Mg(e){var t=On();return Og(t,dn,e)}function Og(e,t,r){if(t=dd(e,t,Cg)[0],e=ji(lr)[0],typeof t=="object"&&t!==null&&typeof t.then=="function")try{var i=Ga(t)}catch(N){throw N===Ws?mi:N}else i=t;t=On();var f=t.queue,g=f.dispatch;return r!==t.memoizedState&&(zt.flags|=2048,Ys(9,{destroy:void 0},x1.bind(null,f,r),null)),[i,g,e]}function x1(e,t){e.action=t}function Tg(e){var t=On(),r=dn;if(r!==null)return Og(t,r,e);On(),t=t.memoizedState,r=On();var i=r.queue.dispatch;return r.memoizedState=e,[t,i,!1]}function Ys(e,t,r,i){return e={tag:e,create:r,deps:i,inst:t,next:null},t=zt.updateQueue,t===null&&(t=ki(),zt.updateQueue=t),r=t.lastEffect,r===null?t.lastEffect=e.next=e:(i=r.next,r.next=e,e.next=i,t.lastEffect=e),e}function Eg(){return On().memoizedState}function Mi(e,t,r,i){var f=Pn();zt.flags|=e,f.memoizedState=Ys(1|t,{destroy:void 0},r,i===void 0?null:i)}function Oi(e,t,r,i){var f=On();i=i===void 0?null:i;var g=f.memoizedState.inst;dn!==null&&i!==null&&sd(i,dn.memoizedState.deps)?f.memoizedState=Ys(t,g,r,i):(zt.flags|=e,f.memoizedState=Ys(1|t,g,r,i))}function Ig(e,t){Mi(8390656,8,e,t)}function gd(e,t){Oi(2048,8,e,t)}function v1(e){zt.flags|=4;var t=zt.updateQueue;if(t===null)t=ki(),zt.updateQueue=t,t.events=[e];else{var r=t.events;r===null?t.events=[e]:r.push(e)}}function Lg(e){var t=On().memoizedState;return v1({ref:t,nextImpl:e}),function(){if((tn&2)!==0)throw Error(a(440));return t.impl.apply(void 0,arguments)}}function _g(e,t){return Oi(4,2,e,t)}function Ag(e,t){return Oi(4,4,e,t)}function Rg(e,t){if(typeof t=="function"){e=e();var r=t(e);return function(){typeof r=="function"?r():t(null)}}if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Dg(e,t,r){r=r!=null?r.concat([e]):null,Oi(4,4,Rg.bind(null,t,e),r)}function md(){}function Bg(e,t){var r=On();t=t===void 0?null:t;var i=r.memoizedState;return t!==null&&sd(t,i[1])?i[0]:(r.memoizedState=[e,t],e)}function zg(e,t){var r=On();t=t===void 0?null:t;var i=r.memoizedState;if(t!==null&&sd(t,i[1]))return i[0];if(i=e(),ms){Pe(!0);try{e()}finally{Pe(!1)}}return r.memoizedState=[i,t],i}function yd(e,t,r){return r===void 0||(ar&1073741824)!==0&&(Ft&261930)===0?e.memoizedState=t:(e.memoizedState=r,e=Hm(),zt.lanes|=e,Kr|=e,r)}function Hg(e,t,r,i){return io(r,t)?r:qs.current!==null?(e=yd(e,r,i),io(e,t)||(In=!0),e):(ar&42)===0||(ar&1073741824)!==0&&(Ft&261930)===0?(In=!0,e.memoizedState=r):(e=Hm(),zt.lanes|=e,Kr|=e,t)}function $g(e,t,r,i,f){var g=H.p;H.p=g!==0&&8>g?g:8;var N=V.T,E={};V.T=E,vd(e,!1,t,r);try{var X=f(),we=V.S;if(we!==null&&we(E,X),X!==null&&typeof X=="object"&&typeof X.then=="function"){var ze=g1(X,i);Pa(e,t,ze,go(e))}else Pa(e,t,i,go(e))}catch($e){Pa(e,t,{then:function(){},status:"rejected",reason:$e},go())}finally{H.p=g,N!==null&&E.types!==null&&(N.types=E.types),V.T=N}}function w1(){}function bd(e,t,r,i){if(e.tag!==5)throw Error(a(476));var f=Kg(e).queue;$g(e,f,t,ce,r===null?w1:function(){return Vg(e),r(i)})}function Kg(e){var t=e.memoizedState;if(t!==null)return t;t={memoizedState:ce,baseState:ce,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:lr,lastRenderedState:ce},next:null};var r={};return t.next={memoizedState:r,baseState:r,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:lr,lastRenderedState:r},next:null},e.memoizedState=t,e=e.alternate,e!==null&&(e.memoizedState=t),t}function Vg(e){var t=Kg(e);t.next===null&&(t=e.alternate.memoizedState),Pa(e,t.next.queue,{},go())}function xd(){return zn(dl)}function Ug(){return On().memoizedState}function Wg(){return On().memoizedState}function S1(e){for(var t=e.return;t!==null;){switch(t.tag){case 24:case 3:var r=go();e=Rr(r);var i=Dr(t,e,r);i!==null&&(oo(i,t,r),Ua(i,t,r)),t={cache:Pc()},e.payload=t;return}t=t.return}}function N1(e,t,r){var i=go();r={lane:i,revertLane:0,gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null},Ti(e)?qg(t,r):(r=Bc(e,t,r,i),r!==null&&(oo(r,e,i),Gg(r,t,i)))}function Fg(e,t,r){var i=go();Pa(e,t,r,i)}function Pa(e,t,r,i){var f={lane:i,revertLane:0,gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null};if(Ti(e))qg(t,f);else{var g=e.alternate;if(e.lanes===0&&(g===null||g.lanes===0)&&(g=t.lastRenderedReducer,g!==null))try{var N=t.lastRenderedState,E=g(N,r);if(f.hasEagerState=!0,f.eagerState=E,io(E,N))return ui(e,t,f,0),hn===null&&ii(),!1}catch{}if(r=Bc(e,t,f,i),r!==null)return oo(r,e,i),Gg(r,t,i),!0}return!1}function vd(e,t,r,i){if(i={lane:2,revertLane:Zd(),gesture:null,action:i,hasEagerState:!1,eagerState:null,next:null},Ti(e)){if(t)throw Error(a(479))}else t=Bc(e,r,i,2),t!==null&&oo(t,e,2)}function Ti(e){var t=e.alternate;return e===zt||t!==null&&t===zt}function qg(e,t){Gs=Si=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function Gg(e,t,r){if((r&4194048)!==0){var i=t.lanes;i&=e.pendingLanes,r|=i,t.lanes=r,Be(e,r)}}var Ya={readContext:zn,use:Ci,useCallback:Nn,useContext:Nn,useEffect:Nn,useImperativeHandle:Nn,useLayoutEffect:Nn,useInsertionEffect:Nn,useMemo:Nn,useReducer:Nn,useRef:Nn,useState:Nn,useDebugValue:Nn,useDeferredValue:Nn,useTransition:Nn,useSyncExternalStore:Nn,useId:Nn,useHostTransitionStatus:Nn,useFormState:Nn,useActionState:Nn,useOptimistic:Nn,useMemoCache:Nn,useCacheRefresh:Nn};Ya.useEffectEvent=Nn;var Pg={readContext:zn,use:Ci,useCallback:function(e,t){return Pn().memoizedState=[e,t===void 0?null:t],e},useContext:zn,useEffect:Ig,useImperativeHandle:function(e,t,r){r=r!=null?r.concat([e]):null,Mi(4194308,4,Rg.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Mi(4194308,4,e,t)},useInsertionEffect:function(e,t){Mi(4,2,e,t)},useMemo:function(e,t){var r=Pn();t=t===void 0?null:t;var i=e();if(ms){Pe(!0);try{e()}finally{Pe(!1)}}return r.memoizedState=[i,t],i},useReducer:function(e,t,r){var i=Pn();if(r!==void 0){var f=r(t);if(ms){Pe(!0);try{r(t)}finally{Pe(!1)}}}else f=t;return i.memoizedState=i.baseState=f,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:f},i.queue=e,e=e.dispatch=N1.bind(null,zt,e),[i.memoizedState,e]},useRef:function(e){var t=Pn();return e={current:e},t.memoizedState=e},useState:function(e){e=pd(e);var t=e.queue,r=Fg.bind(null,zt,t);return t.dispatch=r,[e.memoizedState,r]},useDebugValue:md,useDeferredValue:function(e,t){var r=Pn();return yd(r,e,t)},useTransition:function(){var e=pd(!1);return e=$g.bind(null,zt,e.queue,!0,!1),Pn().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,r){var i=zt,f=Pn();if(Pt){if(r===void 0)throw Error(a(407));r=r()}else{if(r=t(),hn===null)throw Error(a(349));(Ft&127)!==0||gg(i,t,r)}f.memoizedState=r;var g={value:r,getSnapshot:t};return f.queue=g,Ig(yg.bind(null,i,g,e),[e]),i.flags|=2048,Ys(9,{destroy:void 0},mg.bind(null,i,g,r,t),null),r},useId:function(){var e=Pn(),t=hn.identifierPrefix;if(Pt){var r=Vo,i=Ko;r=(i&~(1<<32-he(i)-1)).toString(32)+r,t="_"+t+"R_"+r,r=Ni++,0<r&&(t+="H"+r.toString(32)),t+="_"}else r=m1++,t="_"+t+"r_"+r.toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:xd,useFormState:jg,useActionState:jg,useOptimistic:function(e){var t=Pn();t.memoizedState=t.baseState=e;var r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=r,t=vd.bind(null,zt,!0,r),r.dispatch=t,[e,t]},useMemoCache:cd,useCacheRefresh:function(){return Pn().memoizedState=S1.bind(null,zt)},useEffectEvent:function(e){var t=Pn(),r={impl:e};return t.memoizedState=r,function(){if((tn&2)!==0)throw Error(a(440));return r.impl.apply(void 0,arguments)}}},wd={readContext:zn,use:Ci,useCallback:Bg,useContext:zn,useEffect:gd,useImperativeHandle:Dg,useInsertionEffect:_g,useLayoutEffect:Ag,useMemo:zg,useReducer:ji,useRef:Eg,useState:function(){return ji(lr)},useDebugValue:md,useDeferredValue:function(e,t){var r=On();return Hg(r,dn.memoizedState,e,t)},useTransition:function(){var e=ji(lr)[0],t=On().memoizedState;return[typeof e=="boolean"?e:Ga(e),t]},useSyncExternalStore:hg,useId:Ug,useHostTransitionStatus:xd,useFormState:Mg,useActionState:Mg,useOptimistic:function(e,t){var r=On();return vg(r,dn,e,t)},useMemoCache:cd,useCacheRefresh:Wg};wd.useEffectEvent=Lg;var Yg={readContext:zn,use:Ci,useCallback:Bg,useContext:zn,useEffect:gd,useImperativeHandle:Dg,useInsertionEffect:_g,useLayoutEffect:Ag,useMemo:zg,useReducer:fd,useRef:Eg,useState:function(){return fd(lr)},useDebugValue:md,useDeferredValue:function(e,t){var r=On();return dn===null?yd(r,e,t):Hg(r,dn.memoizedState,e,t)},useTransition:function(){var e=fd(lr)[0],t=On().memoizedState;return[typeof e=="boolean"?e:Ga(e),t]},useSyncExternalStore:hg,useId:Ug,useHostTransitionStatus:xd,useFormState:Tg,useActionState:Tg,useOptimistic:function(e,t){var r=On();return dn!==null?vg(r,dn,e,t):(r.baseState=e,[e,r.queue.dispatch])},useMemoCache:cd,useCacheRefresh:Wg};Yg.useEffectEvent=Lg;function Sd(e,t,r,i){t=e.memoizedState,r=r(i,t),r=r==null?t:x({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Nd={enqueueSetState:function(e,t,r){e=e._reactInternals;var i=go(),f=Rr(i);f.payload=t,r!=null&&(f.callback=r),t=Dr(e,f,i),t!==null&&(oo(t,e,i),Ua(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var i=go(),f=Rr(i);f.tag=1,f.payload=t,r!=null&&(f.callback=r),t=Dr(e,f,i),t!==null&&(oo(t,e,i),Ua(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=go(),i=Rr(r);i.tag=2,t!=null&&(i.callback=t),t=Dr(e,i,r),t!==null&&(oo(t,e,r),Ua(t,e,r))}};function Qg(e,t,r,i,f,g,N){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(i,g,N):t.prototype&&t.prototype.isPureReactComponent?!Ra(r,i)||!Ra(f,g):!0}function Xg(e,t,r,i){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,i),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,i),t.state!==e&&Nd.enqueueReplaceState(t,t.state,null)}function ys(e,t){var r=t;if("ref"in t){r={};for(var i in t)i!=="ref"&&(r[i]=t[i])}if(e=e.defaultProps){r===t&&(r=x({},r));for(var f in e)r[f]===void 0&&(r[f]=e[f])}return r}function Zg(e){li(e)}function Jg(e){console.error(e)}function em(e){li(e)}function Ei(e,t){try{var r=e.onUncaughtError;r(t.value,{componentStack:t.stack})}catch(i){setTimeout(function(){throw i})}}function tm(e,t,r){try{var i=e.onCaughtError;i(r.value,{componentStack:r.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(f){setTimeout(function(){throw f})}}function kd(e,t,r){return r=Rr(r),r.tag=3,r.payload={element:null},r.callback=function(){Ei(e,t)},r}function nm(e){return e=Rr(e),e.tag=3,e}function om(e,t,r,i){var f=r.type.getDerivedStateFromError;if(typeof f=="function"){var g=i.value;e.payload=function(){return f(g)},e.callback=function(){tm(t,r,i)}}var N=r.stateNode;N!==null&&typeof N.componentDidCatch=="function"&&(e.callback=function(){tm(t,r,i),typeof f!="function"&&(Vr===null?Vr=new Set([this]):Vr.add(this));var E=i.stack;this.componentDidCatch(i.value,{componentStack:E!==null?E:""})})}function k1(e,t,r,i,f){if(r.flags|=32768,i!==null&&typeof i=="object"&&typeof i.then=="function"){if(t=r.alternate,t!==null&&Ks(t,r,f,!0),r=co.current,r!==null){switch(r.tag){case 31:case 13:return jo===null?Vi():r.alternate===null&&kn===0&&(kn=3),r.flags&=-257,r.flags|=65536,r.lanes=f,i===yi?r.flags|=16384:(t=r.updateQueue,t===null?r.updateQueue=new Set([i]):t.add(i),Yd(e,i,f)),!1;case 22:return r.flags|=65536,i===yi?r.flags|=16384:(t=r.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([i])},r.updateQueue=t):(r=t.retryQueue,r===null?t.retryQueue=new Set([i]):r.add(i)),Yd(e,i,f)),!1}throw Error(a(435,r.tag))}return Yd(e,i,f),Vi(),!1}if(Pt)return t=co.current,t!==null?((t.flags&65536)===0&&(t.flags|=256),t.flags|=65536,t.lanes=f,i!==Uc&&(e=Error(a(422),{cause:i}),za(So(e,r)))):(i!==Uc&&(t=Error(a(423),{cause:i}),za(So(t,r))),e=e.current.alternate,e.flags|=65536,f&=-f,e.lanes|=f,i=So(i,r),f=kd(e.stateNode,i,f),ed(e,f),kn!==4&&(kn=2)),!1;var g=Error(a(520),{cause:i});if(g=So(g,r),ol===null?ol=[g]:ol.push(g),kn!==4&&(kn=2),t===null)return!0;i=So(i,r),r=t;do{switch(r.tag){case 3:return r.flags|=65536,e=f&-f,r.lanes|=e,e=kd(r.stateNode,i,e),ed(r,e),!1;case 1:if(t=r.type,g=r.stateNode,(r.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(Vr===null||!Vr.has(g))))return r.flags|=65536,f&=-f,r.lanes|=f,f=nm(f),om(f,e,r,i),ed(r,f),!1}r=r.return}while(r!==null);return!1}var Cd=Error(a(461)),In=!1;function Hn(e,t,r,i){t.child=e===null?lg(t,null,r,i):gs(t,e.child,r,i)}function rm(e,t,r,i,f){r=r.render;var g=t.ref;if("ref"in i){var N={};for(var E in i)E!=="ref"&&(N[E]=i[E])}else N=i;return ds(t),i=ad(e,t,r,N,g,f),E=ld(),e!==null&&!In?(id(e,t,f),ir(e,t,f)):(Pt&&E&&Kc(t),t.flags|=1,Hn(e,t,i,f),t.child)}function sm(e,t,r,i,f){if(e===null){var g=r.type;return typeof g=="function"&&!zc(g)&&g.defaultProps===void 0&&r.compare===null?(t.tag=15,t.type=g,am(e,t,g,i,f)):(e=di(r.type,null,i,t,t.mode,f),e.ref=t.ref,e.return=t,t.child=e)}if(g=e.child,!_d(e,f)){var N=g.memoizedProps;if(r=r.compare,r=r!==null?r:Ra,r(N,i)&&e.ref===t.ref)return ir(e,t,f)}return t.flags|=1,e=nr(g,i),e.ref=t.ref,e.return=t,t.child=e}function am(e,t,r,i,f){if(e!==null){var g=e.memoizedProps;if(Ra(g,i)&&e.ref===t.ref)if(In=!1,t.pendingProps=i=g,_d(e,f))(e.flags&131072)!==0&&(In=!0);else return t.lanes=e.lanes,ir(e,t,f)}return jd(e,t,r,i,f)}function lm(e,t,r,i){var f=i.children,g=e!==null?e.memoizedState:null;if(e===null&&t.stateNode===null&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.mode==="hidden"){if((t.flags&128)!==0){if(g=g!==null?g.baseLanes|r:r,e!==null){for(i=t.child=e.child,f=0;i!==null;)f=f|i.lanes|i.childLanes,i=i.sibling;i=f&~g}else i=0,t.child=null;return im(e,t,g,r,i)}if((r&536870912)!==0)t.memoizedState={baseLanes:0,cachePool:null},e!==null&&gi(t,g!==null?g.cachePool:null),g!==null?cg(t,g):nd(),dg(t);else return i=t.lanes=536870912,im(e,t,g!==null?g.baseLanes|r:r,r,i)}else g!==null?(gi(t,g.cachePool),cg(t,g),zr(),t.memoizedState=null):(e!==null&&gi(t,null),nd(),zr());return Hn(e,t,f,r),t.child}function Qa(e,t){return e!==null&&e.tag===22||t.stateNode!==null||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function im(e,t,r,i,f){var g=Qc();return g=g===null?null:{parent:Tn._currentValue,pool:g},t.memoizedState={baseLanes:r,cachePool:g},e!==null&&gi(t,null),nd(),dg(t),e!==null&&Ks(e,t,i,!0),t.childLanes=f,null}function Ii(e,t){return t=_i({mode:t.mode,children:t.children},e.mode),t.ref=e.ref,e.child=t,t.return=e,t}function um(e,t,r){return gs(t,e.child,null,r),e=Ii(t,t.pendingProps),e.flags|=2,fo(t),t.memoizedState=null,e}function C1(e,t,r){var i=t.pendingProps,f=(t.flags&128)!==0;if(t.flags&=-129,e===null){if(Pt){if(i.mode==="hidden")return e=Ii(t,i),t.lanes=536870912,Qa(null,e);if(rd(t),(e=bn)?(e=w0(e,Co),e=e!==null&&e.data==="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:Er!==null?{id:Ko,overflow:Vo}:null,retryLane:536870912,hydrationErrors:null},r=qh(e),r.return=t,t.child=r,Bn=t,bn=null)):e=null,e===null)throw Lr(t);return t.lanes=536870912,null}return Ii(t,i)}var g=e.memoizedState;if(g!==null){var N=g.dehydrated;if(rd(t),f)if(t.flags&256)t.flags&=-257,t=um(e,t,r);else if(t.memoizedState!==null)t.child=e.child,t.flags|=128,t=null;else throw Error(a(558));else if(In||Ks(e,t,r,!1),f=(r&e.childLanes)!==0,In||f){if(i=hn,i!==null&&(N=We(i,r),N!==0&&N!==g.retryLane))throw g.retryLane=N,ls(e,N),oo(i,e,N),Cd;Vi(),t=um(e,t,r)}else e=g.treeContext,bn=Mo(N.nextSibling),Bn=t,Pt=!0,Ir=null,Co=!1,e!==null&&Yh(t,e),t=Ii(t,i),t.flags|=4096;return t}return e=nr(e.child,{mode:i.mode,children:i.children}),e.ref=t.ref,t.child=e,e.return=t,e}function Li(e,t){var r=t.ref;if(r===null)e!==null&&e.ref!==null&&(t.flags|=4194816);else{if(typeof r!="function"&&typeof r!="object")throw Error(a(284));(e===null||e.ref!==r)&&(t.flags|=4194816)}}function jd(e,t,r,i,f){return ds(t),r=ad(e,t,r,i,void 0,f),i=ld(),e!==null&&!In?(id(e,t,f),ir(e,t,f)):(Pt&&i&&Kc(t),t.flags|=1,Hn(e,t,r,f),t.child)}function cm(e,t,r,i,f,g){return ds(t),t.updateQueue=null,r=pg(t,i,r,f),fg(e),i=ld(),e!==null&&!In?(id(e,t,g),ir(e,t,g)):(Pt&&i&&Kc(t),t.flags|=1,Hn(e,t,r,g),t.child)}function dm(e,t,r,i,f){if(ds(t),t.stateNode===null){var g=Bs,N=r.contextType;typeof N=="object"&&N!==null&&(g=zn(N)),g=new r(i,g),t.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=Nd,t.stateNode=g,g._reactInternals=t,g=t.stateNode,g.props=i,g.state=t.memoizedState,g.refs={},Zc(t),N=r.contextType,g.context=typeof N=="object"&&N!==null?zn(N):Bs,g.state=t.memoizedState,N=r.getDerivedStateFromProps,typeof N=="function"&&(Sd(t,r,N,i),g.state=t.memoizedState),typeof r.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(N=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),N!==g.state&&Nd.enqueueReplaceState(g,g.state,null),Fa(t,i,g,f),Wa(),g.state=t.memoizedState),typeof g.componentDidMount=="function"&&(t.flags|=4194308),i=!0}else if(e===null){g=t.stateNode;var E=t.memoizedProps,X=ys(r,E);g.props=X;var we=g.context,ze=r.contextType;N=Bs,typeof ze=="object"&&ze!==null&&(N=zn(ze));var $e=r.getDerivedStateFromProps;ze=typeof $e=="function"||typeof g.getSnapshotBeforeUpdate=="function",E=t.pendingProps!==E,ze||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(E||we!==N)&&Xg(t,g,i,N),Ar=!1;var Ce=t.memoizedState;g.state=Ce,Fa(t,i,g,f),Wa(),we=t.memoizedState,E||Ce!==we||Ar?(typeof $e=="function"&&(Sd(t,r,$e,i),we=t.memoizedState),(X=Ar||Qg(t,r,X,i,Ce,we,N))?(ze||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount()),typeof g.componentDidMount=="function"&&(t.flags|=4194308)):(typeof g.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=we),g.props=i,g.state=we,g.context=N,i=X):(typeof g.componentDidMount=="function"&&(t.flags|=4194308),i=!1)}else{g=t.stateNode,Jc(e,t),N=t.memoizedProps,ze=ys(r,N),g.props=ze,$e=t.pendingProps,Ce=g.context,we=r.contextType,X=Bs,typeof we=="object"&&we!==null&&(X=zn(we)),E=r.getDerivedStateFromProps,(we=typeof E=="function"||typeof g.getSnapshotBeforeUpdate=="function")||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(N!==$e||Ce!==X)&&Xg(t,g,i,X),Ar=!1,Ce=t.memoizedState,g.state=Ce,Fa(t,i,g,f),Wa();var Ae=t.memoizedState;N!==$e||Ce!==Ae||Ar||e!==null&&e.dependencies!==null&&pi(e.dependencies)?(typeof E=="function"&&(Sd(t,r,E,i),Ae=t.memoizedState),(ze=Ar||Qg(t,r,ze,i,Ce,Ae,X)||e!==null&&e.dependencies!==null&&pi(e.dependencies))?(we||typeof g.UNSAFE_componentWillUpdate!="function"&&typeof g.componentWillUpdate!="function"||(typeof g.componentWillUpdate=="function"&&g.componentWillUpdate(i,Ae,X),typeof g.UNSAFE_componentWillUpdate=="function"&&g.UNSAFE_componentWillUpdate(i,Ae,X)),typeof g.componentDidUpdate=="function"&&(t.flags|=4),typeof g.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof g.componentDidUpdate!="function"||N===e.memoizedProps&&Ce===e.memoizedState||(t.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||N===e.memoizedProps&&Ce===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=Ae),g.props=i,g.state=Ae,g.context=X,i=ze):(typeof g.componentDidUpdate!="function"||N===e.memoizedProps&&Ce===e.memoizedState||(t.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||N===e.memoizedProps&&Ce===e.memoizedState||(t.flags|=1024),i=!1)}return g=i,Li(e,t),i=(t.flags&128)!==0,g||i?(g=t.stateNode,r=i&&typeof r.getDerivedStateFromError!="function"?null:g.render(),t.flags|=1,e!==null&&i?(t.child=gs(t,e.child,null,f),t.child=gs(t,null,r,f)):Hn(e,t,r,f),t.memoizedState=g.state,e=t.child):e=ir(e,t,f),e}function fm(e,t,r,i){return us(),t.flags|=256,Hn(e,t,r,i),t.child}var Md={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Od(e){return{baseLanes:e,cachePool:tg()}}function Td(e,t,r){return e=e!==null?e.childLanes&~r:0,t&&(e|=ho),e}function pm(e,t,r){var i=t.pendingProps,f=!1,g=(t.flags&128)!==0,N;if((N=g)||(N=e!==null&&e.memoizedState===null?!1:(Mn.current&2)!==0),N&&(f=!0,t.flags&=-129),N=(t.flags&32)!==0,t.flags&=-33,e===null){if(Pt){if(f?Br(t):zr(),(e=bn)?(e=w0(e,Co),e=e!==null&&e.data!=="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:Er!==null?{id:Ko,overflow:Vo}:null,retryLane:536870912,hydrationErrors:null},r=qh(e),r.return=t,t.child=r,Bn=t,bn=null)):e=null,e===null)throw Lr(t);return ff(e)?t.lanes=32:t.lanes=536870912,null}var E=i.children;return i=i.fallback,f?(zr(),f=t.mode,E=_i({mode:"hidden",children:E},f),i=is(i,f,r,null),E.return=t,i.return=t,E.sibling=i,t.child=E,i=t.child,i.memoizedState=Od(r),i.childLanes=Td(e,N,r),t.memoizedState=Md,Qa(null,i)):(Br(t),Ed(t,E))}var X=e.memoizedState;if(X!==null&&(E=X.dehydrated,E!==null)){if(g)t.flags&256?(Br(t),t.flags&=-257,t=Id(e,t,r)):t.memoizedState!==null?(zr(),t.child=e.child,t.flags|=128,t=null):(zr(),E=i.fallback,f=t.mode,i=_i({mode:"visible",children:i.children},f),E=is(E,f,r,null),E.flags|=2,i.return=t,E.return=t,i.sibling=E,t.child=i,gs(t,e.child,null,r),i=t.child,i.memoizedState=Od(r),i.childLanes=Td(e,N,r),t.memoizedState=Md,t=Qa(null,i));else if(Br(t),ff(E)){if(N=E.nextSibling&&E.nextSibling.dataset,N)var we=N.dgst;N=we,i=Error(a(419)),i.stack="",i.digest=N,za({value:i,source:null,stack:null}),t=Id(e,t,r)}else if(In||Ks(e,t,r,!1),N=(r&e.childLanes)!==0,In||N){if(N=hn,N!==null&&(i=We(N,r),i!==0&&i!==X.retryLane))throw X.retryLane=i,ls(e,i),oo(N,e,i),Cd;df(E)||Vi(),t=Id(e,t,r)}else df(E)?(t.flags|=192,t.child=e.child,t=null):(e=X.treeContext,bn=Mo(E.nextSibling),Bn=t,Pt=!0,Ir=null,Co=!1,e!==null&&Yh(t,e),t=Ed(t,i.children),t.flags|=4096);return t}return f?(zr(),E=i.fallback,f=t.mode,X=e.child,we=X.sibling,i=nr(X,{mode:"hidden",children:i.children}),i.subtreeFlags=X.subtreeFlags&65011712,we!==null?E=nr(we,E):(E=is(E,f,r,null),E.flags|=2),E.return=t,i.return=t,i.sibling=E,t.child=i,Qa(null,i),i=t.child,E=e.child.memoizedState,E===null?E=Od(r):(f=E.cachePool,f!==null?(X=Tn._currentValue,f=f.parent!==X?{parent:X,pool:X}:f):f=tg(),E={baseLanes:E.baseLanes|r,cachePool:f}),i.memoizedState=E,i.childLanes=Td(e,N,r),t.memoizedState=Md,Qa(e.child,i)):(Br(t),r=e.child,e=r.sibling,r=nr(r,{mode:"visible",children:i.children}),r.return=t,r.sibling=null,e!==null&&(N=t.deletions,N===null?(t.deletions=[e],t.flags|=16):N.push(e)),t.child=r,t.memoizedState=null,r)}function Ed(e,t){return t=_i({mode:"visible",children:t},e.mode),t.return=e,e.child=t}function _i(e,t){return e=uo(22,e,null,t),e.lanes=0,e}function Id(e,t,r){return gs(t,e.child,null,r),e=Ed(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function hm(e,t,r){e.lanes|=t;var i=e.alternate;i!==null&&(i.lanes|=t),qc(e.return,t,r)}function Ld(e,t,r,i,f,g){var N=e.memoizedState;N===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:r,tailMode:f,treeForkCount:g}:(N.isBackwards=t,N.rendering=null,N.renderingStartTime=0,N.last=i,N.tail=r,N.tailMode=f,N.treeForkCount=g)}function gm(e,t,r){var i=t.pendingProps,f=i.revealOrder,g=i.tail;i=i.children;var N=Mn.current,E=(N&2)!==0;if(E?(N=N&1|2,t.flags|=128):N&=1,q(Mn,N),Hn(e,t,i,r),i=Pt?Ba:0,!E&&e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&hm(e,r,t);else if(e.tag===19)hm(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(f){case"forwards":for(r=t.child,f=null;r!==null;)e=r.alternate,e!==null&&wi(e)===null&&(f=r),r=r.sibling;r=f,r===null?(f=t.child,t.child=null):(f=r.sibling,r.sibling=null),Ld(t,!1,f,r,g,i);break;case"backwards":case"unstable_legacy-backwards":for(r=null,f=t.child,t.child=null;f!==null;){if(e=f.alternate,e!==null&&wi(e)===null){t.child=f;break}e=f.sibling,f.sibling=r,r=f,f=e}Ld(t,!0,r,null,g,i);break;case"together":Ld(t,!1,null,null,void 0,i);break;default:t.memoizedState=null}return t.child}function ir(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Kr|=t.lanes,(r&t.childLanes)===0)if(e!==null){if(Ks(e,t,r,!1),(r&t.childLanes)===0)return null}else return null;if(e!==null&&t.child!==e.child)throw Error(a(153));if(t.child!==null){for(e=t.child,r=nr(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=nr(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function _d(e,t){return(e.lanes&t)!==0?!0:(e=e.dependencies,!!(e!==null&&pi(e)))}function j1(e,t,r){switch(t.tag){case 3:ue(t,t.stateNode.containerInfo),_r(t,Tn,e.memoizedState.cache),us();break;case 27:case 5:et(t);break;case 4:ue(t,t.stateNode.containerInfo);break;case 10:_r(t,t.type,t.memoizedProps.value);break;case 31:if(t.memoizedState!==null)return t.flags|=128,rd(t),null;break;case 13:var i=t.memoizedState;if(i!==null)return i.dehydrated!==null?(Br(t),t.flags|=128,null):(r&t.child.childLanes)!==0?pm(e,t,r):(Br(t),e=ir(e,t,r),e!==null?e.sibling:null);Br(t);break;case 19:var f=(e.flags&128)!==0;if(i=(r&t.childLanes)!==0,i||(Ks(e,t,r,!1),i=(r&t.childLanes)!==0),f){if(i)return gm(e,t,r);t.flags|=128}if(f=t.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),q(Mn,Mn.current),i)break;return null;case 22:return t.lanes=0,lm(e,t,r,t.pendingProps);case 24:_r(t,Tn,e.memoizedState.cache)}return ir(e,t,r)}function mm(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps)In=!0;else{if(!_d(e,r)&&(t.flags&128)===0)return In=!1,j1(e,t,r);In=(e.flags&131072)!==0}else In=!1,Pt&&(t.flags&1048576)!==0&&Ph(t,Ba,t.index);switch(t.lanes=0,t.tag){case 16:e:{var i=t.pendingProps;if(e=ps(t.elementType),t.type=e,typeof e=="function")zc(e)?(i=ys(e,i),t.tag=1,t=dm(null,t,e,i,r)):(t.tag=0,t=jd(null,t,e,i,r));else{if(e!=null){var f=e.$$typeof;if(f===D){t.tag=11,t=rm(null,t,e,i,r);break e}else if(f===A){t.tag=14,t=sm(null,t,e,i,r);break e}}throw t=Le(e)||e,Error(a(306,t,""))}}return t;case 0:return jd(e,t,t.type,t.pendingProps,r);case 1:return i=t.type,f=ys(i,t.pendingProps),dm(e,t,i,f,r);case 3:e:{if(ue(t,t.stateNode.containerInfo),e===null)throw Error(a(387));i=t.pendingProps;var g=t.memoizedState;f=g.element,Jc(e,t),Fa(t,i,null,r);var N=t.memoizedState;if(i=N.cache,_r(t,Tn,i),i!==g.cache&&Gc(t,[Tn],r,!0),Wa(),i=N.element,g.isDehydrated)if(g={element:i,isDehydrated:!1,cache:N.cache},t.updateQueue.baseState=g,t.memoizedState=g,t.flags&256){t=fm(e,t,i,r);break e}else if(i!==f){f=So(Error(a(424)),t),za(f),t=fm(e,t,i,r);break e}else for(e=t.stateNode.containerInfo,e.nodeType===9?e=e.body:e=e.nodeName==="HTML"?e.ownerDocument.body:e,bn=Mo(e.firstChild),Bn=t,Pt=!0,Ir=null,Co=!0,r=lg(t,null,i,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(us(),i===f){t=ir(e,t,r);break e}Hn(e,t,i,r)}t=t.child}return t;case 26:return Li(e,t),e===null?(r=M0(t.type,null,t.pendingProps,null))?t.memoizedState=r:Pt||(r=t.type,e=t.pendingProps,i=Yi(De.current).createElement(r),i[dt]=t,i[nt]=e,$n(i,r,e),Ze(i),t.stateNode=i):t.memoizedState=M0(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return et(t),e===null&&Pt&&(i=t.stateNode=k0(t.type,t.pendingProps,De.current),Bn=t,Co=!0,f=bn,qr(t.type)?(pf=f,bn=Mo(i.firstChild)):bn=f),Hn(e,t,t.pendingProps.children,r),Li(e,t),e===null&&(t.flags|=4194304),t.child;case 5:return e===null&&Pt&&((f=i=bn)&&(i=nw(i,t.type,t.pendingProps,Co),i!==null?(t.stateNode=i,Bn=t,bn=Mo(i.firstChild),Co=!1,f=!0):f=!1),f||Lr(t)),et(t),f=t.type,g=t.pendingProps,N=e!==null?e.memoizedProps:null,i=g.children,lf(f,g)?i=null:N!==null&&lf(f,N)&&(t.flags|=32),t.memoizedState!==null&&(f=ad(e,t,y1,null,null,r),dl._currentValue=f),Li(e,t),Hn(e,t,i,r),t.child;case 6:return e===null&&Pt&&((e=r=bn)&&(r=ow(r,t.pendingProps,Co),r!==null?(t.stateNode=r,Bn=t,bn=null,e=!0):e=!1),e||Lr(t)),null;case 13:return pm(e,t,r);case 4:return ue(t,t.stateNode.containerInfo),i=t.pendingProps,e===null?t.child=gs(t,null,i,r):Hn(e,t,i,r),t.child;case 11:return rm(e,t,t.type,t.pendingProps,r);case 7:return Hn(e,t,t.pendingProps,r),t.child;case 8:return Hn(e,t,t.pendingProps.children,r),t.child;case 12:return Hn(e,t,t.pendingProps.children,r),t.child;case 10:return i=t.pendingProps,_r(t,t.type,i.value),Hn(e,t,i.children,r),t.child;case 9:return f=t.type._context,i=t.pendingProps.children,ds(t),f=zn(f),i=i(f),t.flags|=1,Hn(e,t,i,r),t.child;case 14:return sm(e,t,t.type,t.pendingProps,r);case 15:return am(e,t,t.type,t.pendingProps,r);case 19:return gm(e,t,r);case 31:return C1(e,t,r);case 22:return lm(e,t,r,t.pendingProps);case 24:return ds(t),i=zn(Tn),e===null?(f=Qc(),f===null&&(f=hn,g=Pc(),f.pooledCache=g,g.refCount++,g!==null&&(f.pooledCacheLanes|=r),f=g),t.memoizedState={parent:i,cache:f},Zc(t),_r(t,Tn,f)):((e.lanes&r)!==0&&(Jc(e,t),Fa(t,null,null,r),Wa()),f=e.memoizedState,g=t.memoizedState,f.parent!==i?(f={parent:i,cache:i},t.memoizedState=f,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=f),_r(t,Tn,i)):(i=g.cache,_r(t,Tn,i),i!==f.cache&&Gc(t,[Tn],r,!0))),Hn(e,t,t.pendingProps.children,r),t.child;case 29:throw t.pendingProps}throw Error(a(156,t.tag))}function ur(e){e.flags|=4}function Ad(e,t,r,i,f){if((t=(e.mode&32)!==0)&&(t=!1),t){if(e.flags|=16777216,(f&335544128)===f)if(e.stateNode.complete)e.flags|=8192;else if(Um())e.flags|=8192;else throw hs=yi,Xc}else e.flags&=-16777217}function ym(e,t){if(t.type!=="stylesheet"||(t.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!L0(t))if(Um())e.flags|=8192;else throw hs=yi,Xc}function Ai(e,t){t!==null&&(e.flags|=4),e.flags&16384&&(t=e.tag!==22?Gt():536870912,e.lanes|=t,Js|=t)}function Xa(e,t){if(!Pt)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var i=null;r!==null;)r.alternate!==null&&(i=r),r=r.sibling;i===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:i.sibling=null}}function xn(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,i=0;if(t)for(var f=e.child;f!==null;)r|=f.lanes|f.childLanes,i|=f.subtreeFlags&65011712,i|=f.flags&65011712,f.return=e,f=f.sibling;else for(f=e.child;f!==null;)r|=f.lanes|f.childLanes,i|=f.subtreeFlags,i|=f.flags,f.return=e,f=f.sibling;return e.subtreeFlags|=i,e.childLanes=r,t}function M1(e,t,r){var i=t.pendingProps;switch(Vc(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return xn(t),null;case 1:return xn(t),null;case 3:return r=t.stateNode,i=null,e!==null&&(i=e.memoizedState.cache),t.memoizedState.cache!==i&&(t.flags|=2048),sr(Tn),ye(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&($s(t)?ur(t):e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,Wc())),xn(t),null;case 26:var f=t.type,g=t.memoizedState;return e===null?(ur(t),g!==null?(xn(t),ym(t,g)):(xn(t),Ad(t,f,null,i,r))):g?g!==e.memoizedState?(ur(t),xn(t),ym(t,g)):(xn(t),t.flags&=-16777217):(e=e.memoizedProps,e!==i&&ur(t),xn(t),Ad(t,f,e,i,r)),null;case 27:if(oe(t),r=De.current,f=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==i&&ur(t);else{if(!i){if(t.stateNode===null)throw Error(a(166));return xn(t),null}e=je.current,$s(t)?Qh(t):(e=k0(f,i,r),t.stateNode=e,ur(t))}return xn(t),null;case 5:if(oe(t),f=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==i&&ur(t);else{if(!i){if(t.stateNode===null)throw Error(a(166));return xn(t),null}if(g=je.current,$s(t))Qh(t);else{var N=Yi(De.current);switch(g){case 1:g=N.createElementNS("http://www.w3.org/2000/svg",f);break;case 2:g=N.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;default:switch(f){case"svg":g=N.createElementNS("http://www.w3.org/2000/svg",f);break;case"math":g=N.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;case"script":g=N.createElement("div"),g.innerHTML="<script><\/script>",g=g.removeChild(g.firstChild);break;case"select":g=typeof i.is=="string"?N.createElement("select",{is:i.is}):N.createElement("select"),i.multiple?g.multiple=!0:i.size&&(g.size=i.size);break;default:g=typeof i.is=="string"?N.createElement(f,{is:i.is}):N.createElement(f)}}g[dt]=t,g[nt]=i;e:for(N=t.child;N!==null;){if(N.tag===5||N.tag===6)g.appendChild(N.stateNode);else if(N.tag!==4&&N.tag!==27&&N.child!==null){N.child.return=N,N=N.child;continue}if(N===t)break e;for(;N.sibling===null;){if(N.return===null||N.return===t)break e;N=N.return}N.sibling.return=N.return,N=N.sibling}t.stateNode=g;e:switch($n(g,f,i),f){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}i&&ur(t)}}return xn(t),Ad(t,t.type,e===null?null:e.memoizedProps,t.pendingProps,r),null;case 6:if(e&&t.stateNode!=null)e.memoizedProps!==i&&ur(t);else{if(typeof i!="string"&&t.stateNode===null)throw Error(a(166));if(e=De.current,$s(t)){if(e=t.stateNode,r=t.memoizedProps,i=null,f=Bn,f!==null)switch(f.tag){case 27:case 5:i=f.memoizedProps}e[dt]=t,e=!!(e.nodeValue===r||i!==null&&i.suppressHydrationWarning===!0||p0(e.nodeValue,r)),e||Lr(t,!0)}else e=Yi(e).createTextNode(i),e[dt]=t,t.stateNode=e}return xn(t),null;case 31:if(r=t.memoizedState,e===null||e.memoizedState!==null){if(i=$s(t),r!==null){if(e===null){if(!i)throw Error(a(318));if(e=t.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(a(557));e[dt]=t}else us(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;xn(t),e=!1}else r=Wc(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=r),e=!0;if(!e)return t.flags&256?(fo(t),t):(fo(t),null);if((t.flags&128)!==0)throw Error(a(558))}return xn(t),null;case 13:if(i=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(f=$s(t),i!==null&&i.dehydrated!==null){if(e===null){if(!f)throw Error(a(318));if(f=t.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(a(317));f[dt]=t}else us(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;xn(t),f=!1}else f=Wc(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=f),f=!0;if(!f)return t.flags&256?(fo(t),t):(fo(t),null)}return fo(t),(t.flags&128)!==0?(t.lanes=r,t):(r=i!==null,e=e!==null&&e.memoizedState!==null,r&&(i=t.child,f=null,i.alternate!==null&&i.alternate.memoizedState!==null&&i.alternate.memoizedState.cachePool!==null&&(f=i.alternate.memoizedState.cachePool.pool),g=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(g=i.memoizedState.cachePool.pool),g!==f&&(i.flags|=2048)),r!==e&&r&&(t.child.flags|=8192),Ai(t,t.updateQueue),xn(t),null);case 4:return ye(),e===null&&nf(t.stateNode.containerInfo),xn(t),null;case 10:return sr(t.type),xn(t),null;case 19:if(_(Mn),i=t.memoizedState,i===null)return xn(t),null;if(f=(t.flags&128)!==0,g=i.rendering,g===null)if(f)Xa(i,!1);else{if(kn!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(g=wi(e),g!==null){for(t.flags|=128,Xa(i,!1),e=g.updateQueue,t.updateQueue=e,Ai(t,e),t.subtreeFlags=0,e=r,r=t.child;r!==null;)Fh(r,e),r=r.sibling;return q(Mn,Mn.current&1|2),Pt&&or(t,i.treeForkCount),t.child}e=e.sibling}i.tail!==null&&Q()>Hi&&(t.flags|=128,f=!0,Xa(i,!1),t.lanes=4194304)}else{if(!f)if(e=wi(g),e!==null){if(t.flags|=128,f=!0,e=e.updateQueue,t.updateQueue=e,Ai(t,e),Xa(i,!0),i.tail===null&&i.tailMode==="hidden"&&!g.alternate&&!Pt)return xn(t),null}else 2*Q()-i.renderingStartTime>Hi&&r!==536870912&&(t.flags|=128,f=!0,Xa(i,!1),t.lanes=4194304);i.isBackwards?(g.sibling=t.child,t.child=g):(e=i.last,e!==null?e.sibling=g:t.child=g,i.last=g)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Q(),e.sibling=null,r=Mn.current,q(Mn,f?r&1|2:r&1),Pt&&or(t,i.treeForkCount),e):(xn(t),null);case 22:case 23:return fo(t),od(),i=t.memoizedState!==null,e!==null?e.memoizedState!==null!==i&&(t.flags|=8192):i&&(t.flags|=8192),i?(r&536870912)!==0&&(t.flags&128)===0&&(xn(t),t.subtreeFlags&6&&(t.flags|=8192)):xn(t),r=t.updateQueue,r!==null&&Ai(t,r.retryQueue),r=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(r=e.memoizedState.cachePool.pool),i=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(i=t.memoizedState.cachePool.pool),i!==r&&(t.flags|=2048),e!==null&&_(fs),null;case 24:return r=null,e!==null&&(r=e.memoizedState.cache),t.memoizedState.cache!==r&&(t.flags|=2048),sr(Tn),xn(t),null;case 25:return null;case 30:return null}throw Error(a(156,t.tag))}function O1(e,t){switch(Vc(t),t.tag){case 1:return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return sr(Tn),ye(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 26:case 27:case 5:return oe(t),null;case 31:if(t.memoizedState!==null){if(fo(t),t.alternate===null)throw Error(a(340));us()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 13:if(fo(t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(a(340));us()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return _(Mn),null;case 4:return ye(),null;case 10:return sr(t.type),null;case 22:case 23:return fo(t),od(),e!==null&&_(fs),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 24:return sr(Tn),null;case 25:return null;default:return null}}function bm(e,t){switch(Vc(t),t.tag){case 3:sr(Tn),ye();break;case 26:case 27:case 5:oe(t);break;case 4:ye();break;case 31:t.memoizedState!==null&&fo(t);break;case 13:fo(t);break;case 19:_(Mn);break;case 10:sr(t.type);break;case 22:case 23:fo(t),od(),e!==null&&_(fs);break;case 24:sr(Tn)}}function Za(e,t){try{var r=t.updateQueue,i=r!==null?r.lastEffect:null;if(i!==null){var f=i.next;r=f;do{if((r.tag&e)===e){i=void 0;var g=r.create,N=r.inst;i=g(),N.destroy=i}r=r.next}while(r!==f)}}catch(E){un(t,t.return,E)}}function Hr(e,t,r){try{var i=t.updateQueue,f=i!==null?i.lastEffect:null;if(f!==null){var g=f.next;i=g;do{if((i.tag&e)===e){var N=i.inst,E=N.destroy;if(E!==void 0){N.destroy=void 0,f=t;var X=r,we=E;try{we()}catch(ze){un(f,X,ze)}}}i=i.next}while(i!==g)}}catch(ze){un(t,t.return,ze)}}function xm(e){var t=e.updateQueue;if(t!==null){var r=e.stateNode;try{ug(t,r)}catch(i){un(e,e.return,i)}}}function vm(e,t,r){r.props=ys(e.type,e.memoizedProps),r.state=e.memoizedState;try{r.componentWillUnmount()}catch(i){un(e,t,i)}}function Ja(e,t){try{var r=e.ref;if(r!==null){switch(e.tag){case 26:case 27:case 5:var i=e.stateNode;break;case 30:i=e.stateNode;break;default:i=e.stateNode}typeof r=="function"?e.refCleanup=r(i):r.current=i}}catch(f){un(e,t,f)}}function Uo(e,t){var r=e.ref,i=e.refCleanup;if(r!==null)if(typeof i=="function")try{i()}catch(f){un(e,t,f)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof r=="function")try{r(null)}catch(f){un(e,t,f)}else r.current=null}function wm(e){var t=e.type,r=e.memoizedProps,i=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":r.autoFocus&&i.focus();break e;case"img":r.src?i.src=r.src:r.srcSet&&(i.srcset=r.srcSet)}}catch(f){un(e,e.return,f)}}function Rd(e,t,r){try{var i=e.stateNode;Q1(i,e.type,r,t),i[nt]=t}catch(f){un(e,e.return,f)}}function Sm(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&qr(e.type)||e.tag===4}function Dd(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Sm(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&qr(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Bd(e,t,r){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r).insertBefore(e,t):(t=r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,t.appendChild(e),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Bt));else if(i!==4&&(i===27&&qr(e.type)&&(r=e.stateNode,t=null),e=e.child,e!==null))for(Bd(e,t,r),e=e.sibling;e!==null;)Bd(e,t,r),e=e.sibling}function Ri(e,t,r){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(i!==4&&(i===27&&qr(e.type)&&(r=e.stateNode),e=e.child,e!==null))for(Ri(e,t,r),e=e.sibling;e!==null;)Ri(e,t,r),e=e.sibling}function Nm(e){var t=e.stateNode,r=e.memoizedProps;try{for(var i=e.type,f=t.attributes;f.length;)t.removeAttributeNode(f[0]);$n(t,i,r),t[dt]=e,t[nt]=r}catch(g){un(e,e.return,g)}}var cr=!1,Ln=!1,zd=!1,km=typeof WeakSet=="function"?WeakSet:Set,Dn=null;function T1(e,t){if(e=e.containerInfo,sf=nu,e=Dh(e),Ic(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var i=r.getSelection&&r.getSelection();if(i&&i.rangeCount!==0){r=i.anchorNode;var f=i.anchorOffset,g=i.focusNode;i=i.focusOffset;try{r.nodeType,g.nodeType}catch{r=null;break e}var N=0,E=-1,X=-1,we=0,ze=0,$e=e,Ce=null;t:for(;;){for(var Ae;$e!==r||f!==0&&$e.nodeType!==3||(E=N+f),$e!==g||i!==0&&$e.nodeType!==3||(X=N+i),$e.nodeType===3&&(N+=$e.nodeValue.length),(Ae=$e.firstChild)!==null;)Ce=$e,$e=Ae;for(;;){if($e===e)break t;if(Ce===r&&++we===f&&(E=N),Ce===g&&++ze===i&&(X=N),(Ae=$e.nextSibling)!==null)break;$e=Ce,Ce=$e.parentNode}$e=Ae}r=E===-1||X===-1?null:{start:E,end:X}}else r=null}r=r||{start:0,end:0}}else r=null;for(af={focusedElem:e,selectionRange:r},nu=!1,Dn=t;Dn!==null;)if(t=Dn,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Dn=e;else for(;Dn!==null;){switch(t=Dn,g=t.alternate,e=t.flags,t.tag){case 0:if((e&4)!==0&&(e=t.updateQueue,e=e!==null?e.events:null,e!==null))for(r=0;r<e.length;r++)f=e[r],f.ref.impl=f.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&g!==null){e=void 0,r=t,f=g.memoizedProps,g=g.memoizedState,i=r.stateNode;try{var ft=ys(r.type,f);e=i.getSnapshotBeforeUpdate(ft,g),i.__reactInternalSnapshotBeforeUpdate=e}catch(Mt){un(r,r.return,Mt)}}break;case 3:if((e&1024)!==0){if(e=t.stateNode.containerInfo,r=e.nodeType,r===9)cf(e);else if(r===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":cf(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(a(163))}if(e=t.sibling,e!==null){e.return=t.return,Dn=e;break}Dn=t.return}}function Cm(e,t,r){var i=r.flags;switch(r.tag){case 0:case 11:case 15:fr(e,r),i&4&&Za(5,r);break;case 1:if(fr(e,r),i&4)if(e=r.stateNode,t===null)try{e.componentDidMount()}catch(N){un(r,r.return,N)}else{var f=ys(r.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(f,t,e.__reactInternalSnapshotBeforeUpdate)}catch(N){un(r,r.return,N)}}i&64&&xm(r),i&512&&Ja(r,r.return);break;case 3:if(fr(e,r),i&64&&(e=r.updateQueue,e!==null)){if(t=null,r.child!==null)switch(r.child.tag){case 27:case 5:t=r.child.stateNode;break;case 1:t=r.child.stateNode}try{ug(e,t)}catch(N){un(r,r.return,N)}}break;case 27:t===null&&i&4&&Nm(r);case 26:case 5:fr(e,r),t===null&&i&4&&wm(r),i&512&&Ja(r,r.return);break;case 12:fr(e,r);break;case 31:fr(e,r),i&4&&Om(e,r);break;case 13:fr(e,r),i&4&&Tm(e,r),i&64&&(e=r.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(r=z1.bind(null,r),rw(e,r))));break;case 22:if(i=r.memoizedState!==null||cr,!i){t=t!==null&&t.memoizedState!==null||Ln,f=cr;var g=Ln;cr=i,(Ln=t)&&!g?pr(e,r,(r.subtreeFlags&8772)!==0):fr(e,r),cr=f,Ln=g}break;case 30:break;default:fr(e,r)}}function jm(e){var t=e.alternate;t!==null&&(e.alternate=null,jm(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&Y(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var vn=null,Jn=!1;function dr(e,t,r){for(r=r.child;r!==null;)Mm(e,t,r),r=r.sibling}function Mm(e,t,r){if(Xe&&typeof Xe.onCommitFiberUnmount=="function")try{Xe.onCommitFiberUnmount(Ue,r)}catch{}switch(r.tag){case 26:Ln||Uo(r,t),dr(e,t,r),r.memoizedState?r.memoizedState.count--:r.stateNode&&(r=r.stateNode,r.parentNode.removeChild(r));break;case 27:Ln||Uo(r,t);var i=vn,f=Jn;qr(r.type)&&(vn=r.stateNode,Jn=!1),dr(e,t,r),il(r.stateNode),vn=i,Jn=f;break;case 5:Ln||Uo(r,t);case 6:if(i=vn,f=Jn,vn=null,dr(e,t,r),vn=i,Jn=f,vn!==null)if(Jn)try{(vn.nodeType===9?vn.body:vn.nodeName==="HTML"?vn.ownerDocument.body:vn).removeChild(r.stateNode)}catch(g){un(r,t,g)}else try{vn.removeChild(r.stateNode)}catch(g){un(r,t,g)}break;case 18:vn!==null&&(Jn?(e=vn,x0(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,r.stateNode),la(e)):x0(vn,r.stateNode));break;case 4:i=vn,f=Jn,vn=r.stateNode.containerInfo,Jn=!0,dr(e,t,r),vn=i,Jn=f;break;case 0:case 11:case 14:case 15:Hr(2,r,t),Ln||Hr(4,r,t),dr(e,t,r);break;case 1:Ln||(Uo(r,t),i=r.stateNode,typeof i.componentWillUnmount=="function"&&vm(r,t,i)),dr(e,t,r);break;case 21:dr(e,t,r);break;case 22:Ln=(i=Ln)||r.memoizedState!==null,dr(e,t,r),Ln=i;break;default:dr(e,t,r)}}function Om(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{la(e)}catch(r){un(t,t.return,r)}}}function Tm(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{la(e)}catch(r){un(t,t.return,r)}}function E1(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return t===null&&(t=e.stateNode=new km),t;case 22:return e=e.stateNode,t=e._retryCache,t===null&&(t=e._retryCache=new km),t;default:throw Error(a(435,e.tag))}}function Di(e,t){var r=E1(e);t.forEach(function(i){if(!r.has(i)){r.add(i);var f=H1.bind(null,e,i);i.then(f,f)}})}function eo(e,t){var r=t.deletions;if(r!==null)for(var i=0;i<r.length;i++){var f=r[i],g=e,N=t,E=N;e:for(;E!==null;){switch(E.tag){case 27:if(qr(E.type)){vn=E.stateNode,Jn=!1;break e}break;case 5:vn=E.stateNode,Jn=!1;break e;case 3:case 4:vn=E.stateNode.containerInfo,Jn=!0;break e}E=E.return}if(vn===null)throw Error(a(160));Mm(g,N,f),vn=null,Jn=!1,g=f.alternate,g!==null&&(g.return=null),f.return=null}if(t.subtreeFlags&13886)for(t=t.child;t!==null;)Em(t,e),t=t.sibling}var _o=null;function Em(e,t){var r=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:eo(t,e),to(e),i&4&&(Hr(3,e,e.return),Za(3,e),Hr(5,e,e.return));break;case 1:eo(t,e),to(e),i&512&&(Ln||r===null||Uo(r,r.return)),i&64&&cr&&(e=e.updateQueue,e!==null&&(i=e.callbacks,i!==null&&(r=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=r===null?i:r.concat(i))));break;case 26:var f=_o;if(eo(t,e),to(e),i&512&&(Ln||r===null||Uo(r,r.return)),i&4){var g=r!==null?r.memoizedState:null;if(i=e.memoizedState,r===null)if(i===null)if(e.stateNode===null){e:{i=e.type,r=e.memoizedProps,f=f.ownerDocument||f;t:switch(i){case"title":g=f.getElementsByTagName("title")[0],(!g||g[Yt]||g[dt]||g.namespaceURI==="http://www.w3.org/2000/svg"||g.hasAttribute("itemprop"))&&(g=f.createElement(i),f.head.insertBefore(g,f.querySelector("head > title"))),$n(g,i,r),g[dt]=e,Ze(g),i=g;break e;case"link":var N=E0("link","href",f).get(i+(r.href||""));if(N){for(var E=0;E<N.length;E++)if(g=N[E],g.getAttribute("href")===(r.href==null||r.href===""?null:r.href)&&g.getAttribute("rel")===(r.rel==null?null:r.rel)&&g.getAttribute("title")===(r.title==null?null:r.title)&&g.getAttribute("crossorigin")===(r.crossOrigin==null?null:r.crossOrigin)){N.splice(E,1);break t}}g=f.createElement(i),$n(g,i,r),f.head.appendChild(g);break;case"meta":if(N=E0("meta","content",f).get(i+(r.content||""))){for(E=0;E<N.length;E++)if(g=N[E],g.getAttribute("content")===(r.content==null?null:""+r.content)&&g.getAttribute("name")===(r.name==null?null:r.name)&&g.getAttribute("property")===(r.property==null?null:r.property)&&g.getAttribute("http-equiv")===(r.httpEquiv==null?null:r.httpEquiv)&&g.getAttribute("charset")===(r.charSet==null?null:r.charSet)){N.splice(E,1);break t}}g=f.createElement(i),$n(g,i,r),f.head.appendChild(g);break;default:throw Error(a(468,i))}g[dt]=e,Ze(g),i=g}e.stateNode=i}else I0(f,e.type,e.stateNode);else e.stateNode=T0(f,i,e.memoizedProps);else g!==i?(g===null?r.stateNode!==null&&(r=r.stateNode,r.parentNode.removeChild(r)):g.count--,i===null?I0(f,e.type,e.stateNode):T0(f,i,e.memoizedProps)):i===null&&e.stateNode!==null&&Rd(e,e.memoizedProps,r.memoizedProps)}break;case 27:eo(t,e),to(e),i&512&&(Ln||r===null||Uo(r,r.return)),r!==null&&i&4&&Rd(e,e.memoizedProps,r.memoizedProps);break;case 5:if(eo(t,e),to(e),i&512&&(Ln||r===null||Uo(r,r.return)),e.flags&32){f=e.stateNode;try{Or(f,"")}catch(ft){un(e,e.return,ft)}}i&4&&e.stateNode!=null&&(f=e.memoizedProps,Rd(e,f,r!==null?r.memoizedProps:f)),i&1024&&(zd=!0);break;case 6:if(eo(t,e),to(e),i&4){if(e.stateNode===null)throw Error(a(162));i=e.memoizedProps,r=e.stateNode;try{r.nodeValue=i}catch(ft){un(e,e.return,ft)}}break;case 3:if(Zi=null,f=_o,_o=Qi(t.containerInfo),eo(t,e),_o=f,to(e),i&4&&r!==null&&r.memoizedState.isDehydrated)try{la(t.containerInfo)}catch(ft){un(e,e.return,ft)}zd&&(zd=!1,Im(e));break;case 4:i=_o,_o=Qi(e.stateNode.containerInfo),eo(t,e),to(e),_o=i;break;case 12:eo(t,e),to(e);break;case 31:eo(t,e),to(e),i&4&&(i=e.updateQueue,i!==null&&(e.updateQueue=null,Di(e,i)));break;case 13:eo(t,e),to(e),e.child.flags&8192&&e.memoizedState!==null!=(r!==null&&r.memoizedState!==null)&&(zi=Q()),i&4&&(i=e.updateQueue,i!==null&&(e.updateQueue=null,Di(e,i)));break;case 22:f=e.memoizedState!==null;var X=r!==null&&r.memoizedState!==null,we=cr,ze=Ln;if(cr=we||f,Ln=ze||X,eo(t,e),Ln=ze,cr=we,to(e),i&8192)e:for(t=e.stateNode,t._visibility=f?t._visibility&-2:t._visibility|1,f&&(r===null||X||cr||Ln||bs(e)),r=null,t=e;;){if(t.tag===5||t.tag===26){if(r===null){X=r=t;try{if(g=X.stateNode,f)N=g.style,typeof N.setProperty=="function"?N.setProperty("display","none","important"):N.display="none";else{E=X.stateNode;var $e=X.memoizedProps.style,Ce=$e!=null&&$e.hasOwnProperty("display")?$e.display:null;E.style.display=Ce==null||typeof Ce=="boolean"?"":(""+Ce).trim()}}catch(ft){un(X,X.return,ft)}}}else if(t.tag===6){if(r===null){X=t;try{X.stateNode.nodeValue=f?"":X.memoizedProps}catch(ft){un(X,X.return,ft)}}}else if(t.tag===18){if(r===null){X=t;try{var Ae=X.stateNode;f?v0(Ae,!0):v0(X.stateNode,!1)}catch(ft){un(X,X.return,ft)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;r===t&&(r=null),t=t.return}r===t&&(r=null),t.sibling.return=t.return,t=t.sibling}i&4&&(i=e.updateQueue,i!==null&&(r=i.retryQueue,r!==null&&(i.retryQueue=null,Di(e,r))));break;case 19:eo(t,e),to(e),i&4&&(i=e.updateQueue,i!==null&&(e.updateQueue=null,Di(e,i)));break;case 30:break;case 21:break;default:eo(t,e),to(e)}}function to(e){var t=e.flags;if(t&2){try{for(var r,i=e.return;i!==null;){if(Sm(i)){r=i;break}i=i.return}if(r==null)throw Error(a(160));switch(r.tag){case 27:var f=r.stateNode,g=Dd(e);Ri(e,g,f);break;case 5:var N=r.stateNode;r.flags&32&&(Or(N,""),r.flags&=-33);var E=Dd(e);Ri(e,E,N);break;case 3:case 4:var X=r.stateNode.containerInfo,we=Dd(e);Bd(e,we,X);break;default:throw Error(a(161))}}catch(ze){un(e,e.return,ze)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Im(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var t=e;Im(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),e=e.sibling}}function fr(e,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)Cm(e,t.alternate,t),t=t.sibling}function bs(e){for(e=e.child;e!==null;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:Hr(4,t,t.return),bs(t);break;case 1:Uo(t,t.return);var r=t.stateNode;typeof r.componentWillUnmount=="function"&&vm(t,t.return,r),bs(t);break;case 27:il(t.stateNode);case 26:case 5:Uo(t,t.return),bs(t);break;case 22:t.memoizedState===null&&bs(t);break;case 30:bs(t);break;default:bs(t)}e=e.sibling}}function pr(e,t,r){for(r=r&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var i=t.alternate,f=e,g=t,N=g.flags;switch(g.tag){case 0:case 11:case 15:pr(f,g,r),Za(4,g);break;case 1:if(pr(f,g,r),i=g,f=i.stateNode,typeof f.componentDidMount=="function")try{f.componentDidMount()}catch(we){un(i,i.return,we)}if(i=g,f=i.updateQueue,f!==null){var E=i.stateNode;try{var X=f.shared.hiddenCallbacks;if(X!==null)for(f.shared.hiddenCallbacks=null,f=0;f<X.length;f++)ig(X[f],E)}catch(we){un(i,i.return,we)}}r&&N&64&&xm(g),Ja(g,g.return);break;case 27:Nm(g);case 26:case 5:pr(f,g,r),r&&i===null&&N&4&&wm(g),Ja(g,g.return);break;case 12:pr(f,g,r);break;case 31:pr(f,g,r),r&&N&4&&Om(f,g);break;case 13:pr(f,g,r),r&&N&4&&Tm(f,g);break;case 22:g.memoizedState===null&&pr(f,g,r),Ja(g,g.return);break;case 30:break;default:pr(f,g,r)}t=t.sibling}}function Hd(e,t){var r=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(r=e.memoizedState.cachePool.pool),e=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(e=t.memoizedState.cachePool.pool),e!==r&&(e!=null&&e.refCount++,r!=null&&Ha(r))}function $d(e,t){e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&Ha(e))}function Ao(e,t,r,i){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)Lm(e,t,r,i),t=t.sibling}function Lm(e,t,r,i){var f=t.flags;switch(t.tag){case 0:case 11:case 15:Ao(e,t,r,i),f&2048&&Za(9,t);break;case 1:Ao(e,t,r,i);break;case 3:Ao(e,t,r,i),f&2048&&(e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&Ha(e)));break;case 12:if(f&2048){Ao(e,t,r,i),e=t.stateNode;try{var g=t.memoizedProps,N=g.id,E=g.onPostCommit;typeof E=="function"&&E(N,t.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(X){un(t,t.return,X)}}else Ao(e,t,r,i);break;case 31:Ao(e,t,r,i);break;case 13:Ao(e,t,r,i);break;case 23:break;case 22:g=t.stateNode,N=t.alternate,t.memoizedState!==null?g._visibility&2?Ao(e,t,r,i):el(e,t):g._visibility&2?Ao(e,t,r,i):(g._visibility|=2,Qs(e,t,r,i,(t.subtreeFlags&10256)!==0||!1)),f&2048&&Hd(N,t);break;case 24:Ao(e,t,r,i),f&2048&&$d(t.alternate,t);break;default:Ao(e,t,r,i)}}function Qs(e,t,r,i,f){for(f=f&&((t.subtreeFlags&10256)!==0||!1),t=t.child;t!==null;){var g=e,N=t,E=r,X=i,we=N.flags;switch(N.tag){case 0:case 11:case 15:Qs(g,N,E,X,f),Za(8,N);break;case 23:break;case 22:var ze=N.stateNode;N.memoizedState!==null?ze._visibility&2?Qs(g,N,E,X,f):el(g,N):(ze._visibility|=2,Qs(g,N,E,X,f)),f&&we&2048&&Hd(N.alternate,N);break;case 24:Qs(g,N,E,X,f),f&&we&2048&&$d(N.alternate,N);break;default:Qs(g,N,E,X,f)}t=t.sibling}}function el(e,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var r=e,i=t,f=i.flags;switch(i.tag){case 22:el(r,i),f&2048&&Hd(i.alternate,i);break;case 24:el(r,i),f&2048&&$d(i.alternate,i);break;default:el(r,i)}t=t.sibling}}var tl=8192;function Xs(e,t,r){if(e.subtreeFlags&tl)for(e=e.child;e!==null;)_m(e,t,r),e=e.sibling}function _m(e,t,r){switch(e.tag){case 26:Xs(e,t,r),e.flags&tl&&e.memoizedState!==null&&mw(r,_o,e.memoizedState,e.memoizedProps);break;case 5:Xs(e,t,r);break;case 3:case 4:var i=_o;_o=Qi(e.stateNode.containerInfo),Xs(e,t,r),_o=i;break;case 22:e.memoizedState===null&&(i=e.alternate,i!==null&&i.memoizedState!==null?(i=tl,tl=16777216,Xs(e,t,r),tl=i):Xs(e,t,r));break;default:Xs(e,t,r)}}function Am(e){var t=e.alternate;if(t!==null&&(e=t.child,e!==null)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(e!==null)}}function nl(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var r=0;r<t.length;r++){var i=t[r];Dn=i,Dm(i,e)}Am(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)Rm(e),e=e.sibling}function Rm(e){switch(e.tag){case 0:case 11:case 15:nl(e),e.flags&2048&&Hr(9,e,e.return);break;case 3:nl(e);break;case 12:nl(e);break;case 22:var t=e.stateNode;e.memoizedState!==null&&t._visibility&2&&(e.return===null||e.return.tag!==13)?(t._visibility&=-3,Bi(e)):nl(e);break;default:nl(e)}}function Bi(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var r=0;r<t.length;r++){var i=t[r];Dn=i,Dm(i,e)}Am(e)}for(e=e.child;e!==null;){switch(t=e,t.tag){case 0:case 11:case 15:Hr(8,t,t.return),Bi(t);break;case 22:r=t.stateNode,r._visibility&2&&(r._visibility&=-3,Bi(t));break;default:Bi(t)}e=e.sibling}}function Dm(e,t){for(;Dn!==null;){var r=Dn;switch(r.tag){case 0:case 11:case 15:Hr(8,r,t);break;case 23:case 22:if(r.memoizedState!==null&&r.memoizedState.cachePool!==null){var i=r.memoizedState.cachePool.pool;i!=null&&i.refCount++}break;case 24:Ha(r.memoizedState.cache)}if(i=r.child,i!==null)i.return=r,Dn=i;else e:for(r=e;Dn!==null;){i=Dn;var f=i.sibling,g=i.return;if(jm(i),i===r){Dn=null;break e}if(f!==null){f.return=g,Dn=f;break e}Dn=g}}}var I1={getCacheForType:function(e){var t=zn(Tn),r=t.data.get(e);return r===void 0&&(r=e(),t.data.set(e,r)),r},cacheSignal:function(){return zn(Tn).controller.signal}},L1=typeof WeakMap=="function"?WeakMap:Map,tn=0,hn=null,Ut=null,Ft=0,ln=0,po=null,$r=!1,Zs=!1,Kd=!1,hr=0,kn=0,Kr=0,xs=0,Vd=0,ho=0,Js=0,ol=null,no=null,Ud=!1,zi=0,Bm=0,Hi=1/0,$i=null,Vr=null,Rn=0,Ur=null,ea=null,gr=0,Wd=0,Fd=null,zm=null,rl=0,qd=null;function go(){return(tn&2)!==0&&Ft!==0?Ft&-Ft:V.T!==null?Zd():st()}function Hm(){if(ho===0)if((Ft&536870912)===0||Pt){var e=Ot;Ot<<=1,(Ot&3932160)===0&&(Ot=262144),ho=e}else ho=536870912;return e=co.current,e!==null&&(e.flags|=32),ho}function oo(e,t,r){(e===hn&&(ln===2||ln===9)||e.cancelPendingCommit!==null)&&(ta(e,0),Wr(e,Ft,ho,!1)),J(e,r),((tn&2)===0||e!==hn)&&(e===hn&&((tn&2)===0&&(xs|=r),kn===4&&Wr(e,Ft,ho,!1)),Wo(e))}function $m(e,t,r){if((tn&6)!==0)throw Error(a(327));var i=!r&&(t&127)===0&&(t&e.expiredLanes)===0||pt(e,t),f=i?R1(e,t):Pd(e,t,!0),g=i;do{if(f===0){Zs&&!i&&Wr(e,t,0,!1);break}else{if(r=e.current.alternate,g&&!_1(r)){f=Pd(e,t,!1),g=!1;continue}if(f===2){if(g=t,e.errorRecoveryDisabledLanes&g)var N=0;else N=e.pendingLanes&-536870913,N=N!==0?N:N&536870912?536870912:0;if(N!==0){t=N;e:{var E=e;f=ol;var X=E.current.memoizedState.isDehydrated;if(X&&(ta(E,N).flags|=256),N=Pd(E,N,!1),N!==2){if(Kd&&!X){E.errorRecoveryDisabledLanes|=g,xs|=g,f=4;break e}g=no,no=f,g!==null&&(no===null?no=g:no.push.apply(no,g))}f=N}if(g=!1,f!==2)continue}}if(f===1){ta(e,0),Wr(e,t,0,!0);break}e:{switch(i=e,g=f,g){case 0:case 1:throw Error(a(345));case 4:if((t&4194048)!==t)break;case 6:Wr(i,t,ho,!$r);break e;case 2:no=null;break;case 3:case 5:break;default:throw Error(a(329))}if((t&62914560)===t&&(f=zi+300-Q(),10<f)){if(Wr(i,t,ho,!$r),Kt(i,0,!0)!==0)break e;gr=t,i.timeoutHandle=y0(Km.bind(null,i,r,no,$i,Ud,t,ho,xs,Js,$r,g,"Throttled",-0,0),f);break e}Km(i,r,no,$i,Ud,t,ho,xs,Js,$r,g,null,-0,0)}}break}while(!0);Wo(e)}function Km(e,t,r,i,f,g,N,E,X,we,ze,$e,Ce,Ae){if(e.timeoutHandle=-1,$e=t.subtreeFlags,$e&8192||($e&16785408)===16785408){$e={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Bt},_m(t,g,$e);var ft=(g&62914560)===g?zi-Q():(g&4194048)===g?Bm-Q():0;if(ft=yw($e,ft),ft!==null){gr=g,e.cancelPendingCommit=ft(Ym.bind(null,e,t,g,r,i,f,N,E,X,ze,$e,null,Ce,Ae)),Wr(e,g,N,!we);return}}Ym(e,t,g,r,i,f,N,E,X)}function _1(e){for(var t=e;;){var r=t.tag;if((r===0||r===11||r===15)&&t.flags&16384&&(r=t.updateQueue,r!==null&&(r=r.stores,r!==null)))for(var i=0;i<r.length;i++){var f=r[i],g=f.getSnapshot;f=f.value;try{if(!io(g(),f))return!1}catch{return!1}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Wr(e,t,r,i){t&=~Vd,t&=~xs,e.suspendedLanes|=t,e.pingedLanes&=~t,i&&(e.warmLanes|=t),i=e.expirationTimes;for(var f=t;0<f;){var g=31-he(f),N=1<<g;i[g]=-1,f&=~N}r!==0&&Ie(e,r,t)}function Ki(){return(tn&6)===0?(sl(0),!1):!0}function Gd(){if(Ut!==null){if(ln===0)var e=Ut.return;else e=Ut,rr=cs=null,ud(e),Fs=null,Ka=0,e=Ut;for(;e!==null;)bm(e.alternate,e),e=e.return;Ut=null}}function ta(e,t){var r=e.timeoutHandle;r!==-1&&(e.timeoutHandle=-1,J1(r)),r=e.cancelPendingCommit,r!==null&&(e.cancelPendingCommit=null,r()),gr=0,Gd(),hn=e,Ut=r=nr(e.current,null),Ft=t,ln=0,po=null,$r=!1,Zs=pt(e,t),Kd=!1,Js=ho=Vd=xs=Kr=kn=0,no=ol=null,Ud=!1,(t&8)!==0&&(t|=t&32);var i=e.entangledLanes;if(i!==0)for(e=e.entanglements,i&=t;0<i;){var f=31-he(i),g=1<<f;t|=e[f],i&=~g}return hr=t,ii(),r}function Vm(e,t){zt=null,V.H=Ya,t===Ws||t===mi?(t=rg(),ln=3):t===Xc?(t=rg(),ln=4):ln=t===Cd?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,po=t,Ut===null&&(kn=1,Ei(e,So(t,e.current)))}function Um(){var e=co.current;return e===null?!0:(Ft&4194048)===Ft?jo===null:(Ft&62914560)===Ft||(Ft&536870912)!==0?e===jo:!1}function Wm(){var e=V.H;return V.H=Ya,e===null?Ya:e}function Fm(){var e=V.A;return V.A=I1,e}function Vi(){kn=4,$r||(Ft&4194048)!==Ft&&co.current!==null||(Zs=!0),(Kr&134217727)===0&&(xs&134217727)===0||hn===null||Wr(hn,Ft,ho,!1)}function Pd(e,t,r){var i=tn;tn|=2;var f=Wm(),g=Fm();(hn!==e||Ft!==t)&&($i=null,ta(e,t)),t=!1;var N=kn;e:do try{if(ln!==0&&Ut!==null){var E=Ut,X=po;switch(ln){case 8:Gd(),N=6;break e;case 3:case 2:case 9:case 6:co.current===null&&(t=!0);var we=ln;if(ln=0,po=null,na(e,E,X,we),r&&Zs){N=0;break e}break;default:we=ln,ln=0,po=null,na(e,E,X,we)}}A1(),N=kn;break}catch(ze){Vm(e,ze)}while(!0);return t&&e.shellSuspendCounter++,rr=cs=null,tn=i,V.H=f,V.A=g,Ut===null&&(hn=null,Ft=0,ii()),N}function A1(){for(;Ut!==null;)qm(Ut)}function R1(e,t){var r=tn;tn|=2;var i=Wm(),f=Fm();hn!==e||Ft!==t?($i=null,Hi=Q()+500,ta(e,t)):Zs=pt(e,t);e:do try{if(ln!==0&&Ut!==null){t=Ut;var g=po;t:switch(ln){case 1:ln=0,po=null,na(e,t,g,1);break;case 2:case 9:if(ng(g)){ln=0,po=null,Gm(t);break}t=function(){ln!==2&&ln!==9||hn!==e||(ln=7),Wo(e)},g.then(t,t);break e;case 3:ln=7;break e;case 4:ln=5;break e;case 7:ng(g)?(ln=0,po=null,Gm(t)):(ln=0,po=null,na(e,t,g,7));break;case 5:var N=null;switch(Ut.tag){case 26:N=Ut.memoizedState;case 5:case 27:var E=Ut;if(N?L0(N):E.stateNode.complete){ln=0,po=null;var X=E.sibling;if(X!==null)Ut=X;else{var we=E.return;we!==null?(Ut=we,Ui(we)):Ut=null}break t}}ln=0,po=null,na(e,t,g,5);break;case 6:ln=0,po=null,na(e,t,g,6);break;case 8:Gd(),kn=6;break e;default:throw Error(a(462))}}D1();break}catch(ze){Vm(e,ze)}while(!0);return rr=cs=null,V.H=i,V.A=f,tn=r,Ut!==null?0:(hn=null,Ft=0,ii(),kn)}function D1(){for(;Ut!==null&&!Z();)qm(Ut)}function qm(e){var t=mm(e.alternate,e,hr);e.memoizedProps=e.pendingProps,t===null?Ui(e):Ut=t}function Gm(e){var t=e,r=t.alternate;switch(t.tag){case 15:case 0:t=cm(r,t,t.pendingProps,t.type,void 0,Ft);break;case 11:t=cm(r,t,t.pendingProps,t.type.render,t.ref,Ft);break;case 5:ud(t);default:bm(r,t),t=Ut=Fh(t,hr),t=mm(r,t,hr)}e.memoizedProps=e.pendingProps,t===null?Ui(e):Ut=t}function na(e,t,r,i){rr=cs=null,ud(t),Fs=null,Ka=0;var f=t.return;try{if(k1(e,f,t,r,Ft)){kn=1,Ei(e,So(r,e.current)),Ut=null;return}}catch(g){if(f!==null)throw Ut=f,g;kn=1,Ei(e,So(r,e.current)),Ut=null;return}t.flags&32768?(Pt||i===1?e=!0:Zs||(Ft&536870912)!==0?e=!1:($r=e=!0,(i===2||i===9||i===3||i===6)&&(i=co.current,i!==null&&i.tag===13&&(i.flags|=16384))),Pm(t,e)):Ui(t)}function Ui(e){var t=e;do{if((t.flags&32768)!==0){Pm(t,$r);return}e=t.return;var r=M1(t.alternate,t,hr);if(r!==null){Ut=r;return}if(t=t.sibling,t!==null){Ut=t;return}Ut=t=e}while(t!==null);kn===0&&(kn=5)}function Pm(e,t){do{var r=O1(e.alternate,e);if(r!==null){r.flags&=32767,Ut=r;return}if(r=e.return,r!==null&&(r.flags|=32768,r.subtreeFlags=0,r.deletions=null),!t&&(e=e.sibling,e!==null)){Ut=e;return}Ut=e=r}while(e!==null);kn=6,Ut=null}function Ym(e,t,r,i,f,g,N,E,X){e.cancelPendingCommit=null;do Wi();while(Rn!==0);if((tn&6)!==0)throw Error(a(327));if(t!==null){if(t===e.current)throw Error(a(177));if(g=t.lanes|t.childLanes,g|=Dc,be(e,r,g,N,E,X),e===hn&&(Ut=hn=null,Ft=0),ea=t,Ur=e,gr=r,Wd=g,Fd=f,zm=i,(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,$1(_e,function(){return e0(),null})):(e.callbackNode=null,e.callbackPriority=0),i=(t.flags&13878)!==0,(t.subtreeFlags&13878)!==0||i){i=V.T,V.T=null,f=H.p,H.p=2,N=tn,tn|=4;try{T1(e,t,r)}finally{tn=N,H.p=f,V.T=i}}Rn=1,Qm(),Xm(),Zm()}}function Qm(){if(Rn===1){Rn=0;var e=Ur,t=ea,r=(t.flags&13878)!==0;if((t.subtreeFlags&13878)!==0||r){r=V.T,V.T=null;var i=H.p;H.p=2;var f=tn;tn|=4;try{Em(t,e);var g=af,N=Dh(e.containerInfo),E=g.focusedElem,X=g.selectionRange;if(N!==E&&E&&E.ownerDocument&&Rh(E.ownerDocument.documentElement,E)){if(X!==null&&Ic(E)){var we=X.start,ze=X.end;if(ze===void 0&&(ze=we),"selectionStart"in E)E.selectionStart=we,E.selectionEnd=Math.min(ze,E.value.length);else{var $e=E.ownerDocument||document,Ce=$e&&$e.defaultView||window;if(Ce.getSelection){var Ae=Ce.getSelection(),ft=E.textContent.length,Mt=Math.min(X.start,ft),pn=X.end===void 0?Mt:Math.min(X.end,ft);!Ae.extend&&Mt>pn&&(N=pn,pn=Mt,Mt=N);var ge=Ah(E,Mt),le=Ah(E,pn);if(ge&&le&&(Ae.rangeCount!==1||Ae.anchorNode!==ge.node||Ae.anchorOffset!==ge.offset||Ae.focusNode!==le.node||Ae.focusOffset!==le.offset)){var ve=$e.createRange();ve.setStart(ge.node,ge.offset),Ae.removeAllRanges(),Mt>pn?(Ae.addRange(ve),Ae.extend(le.node,le.offset)):(ve.setEnd(le.node,le.offset),Ae.addRange(ve))}}}}for($e=[],Ae=E;Ae=Ae.parentNode;)Ae.nodeType===1&&$e.push({element:Ae,left:Ae.scrollLeft,top:Ae.scrollTop});for(typeof E.focus=="function"&&E.focus(),E=0;E<$e.length;E++){var He=$e[E];He.element.scrollLeft=He.left,He.element.scrollTop=He.top}}nu=!!sf,af=sf=null}finally{tn=f,H.p=i,V.T=r}}e.current=t,Rn=2}}function Xm(){if(Rn===2){Rn=0;var e=Ur,t=ea,r=(t.flags&8772)!==0;if((t.subtreeFlags&8772)!==0||r){r=V.T,V.T=null;var i=H.p;H.p=2;var f=tn;tn|=4;try{Cm(e,t.alternate,t)}finally{tn=f,H.p=i,V.T=r}}Rn=3}}function Zm(){if(Rn===4||Rn===3){Rn=0,Se();var e=Ur,t=ea,r=gr,i=zm;(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?Rn=5:(Rn=0,ea=Ur=null,Jm(e,e.pendingLanes));var f=e.pendingLanes;if(f===0&&(Vr=null),lt(r),t=t.stateNode,Xe&&typeof Xe.onCommitFiberRoot=="function")try{Xe.onCommitFiberRoot(Ue,t,void 0,(t.current.flags&128)===128)}catch{}if(i!==null){t=V.T,f=H.p,H.p=2,V.T=null;try{for(var g=e.onRecoverableError,N=0;N<i.length;N++){var E=i[N];g(E.value,{componentStack:E.stack})}}finally{V.T=t,H.p=f}}(gr&3)!==0&&Wi(),Wo(e),f=e.pendingLanes,(r&261930)!==0&&(f&42)!==0?e===qd?rl++:(rl=0,qd=e):rl=0,sl(0)}}function Jm(e,t){(e.pooledCacheLanes&=t)===0&&(t=e.pooledCache,t!=null&&(e.pooledCache=null,Ha(t)))}function Wi(){return Qm(),Xm(),Zm(),e0()}function e0(){if(Rn!==5)return!1;var e=Ur,t=Wd;Wd=0;var r=lt(gr),i=V.T,f=H.p;try{H.p=32>r?32:r,V.T=null,r=Fd,Fd=null;var g=Ur,N=gr;if(Rn=0,ea=Ur=null,gr=0,(tn&6)!==0)throw Error(a(331));var E=tn;if(tn|=4,Rm(g.current),Lm(g,g.current,N,r),tn=E,sl(0,!1),Xe&&typeof Xe.onPostCommitFiberRoot=="function")try{Xe.onPostCommitFiberRoot(Ue,g)}catch{}return!0}finally{H.p=f,V.T=i,Jm(e,t)}}function t0(e,t,r){t=So(r,t),t=kd(e.stateNode,t,2),e=Dr(e,t,2),e!==null&&(J(e,2),Wo(e))}function un(e,t,r){if(e.tag===3)t0(e,e,r);else for(;t!==null;){if(t.tag===3){t0(t,e,r);break}else if(t.tag===1){var i=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(Vr===null||!Vr.has(i))){e=So(r,e),r=nm(2),i=Dr(t,r,2),i!==null&&(om(r,i,t,e),J(i,2),Wo(i));break}}t=t.return}}function Yd(e,t,r){var i=e.pingCache;if(i===null){i=e.pingCache=new L1;var f=new Set;i.set(t,f)}else f=i.get(t),f===void 0&&(f=new Set,i.set(t,f));f.has(r)||(Kd=!0,f.add(r),e=B1.bind(null,e,t,r),t.then(e,e))}function B1(e,t,r){var i=e.pingCache;i!==null&&i.delete(t),e.pingedLanes|=e.suspendedLanes&r,e.warmLanes&=~r,hn===e&&(Ft&r)===r&&(kn===4||kn===3&&(Ft&62914560)===Ft&&300>Q()-zi?(tn&2)===0&&ta(e,0):Vd|=r,Js===Ft&&(Js=0)),Wo(e)}function n0(e,t){t===0&&(t=Gt()),e=ls(e,t),e!==null&&(J(e,t),Wo(e))}function z1(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),n0(e,r)}function H1(e,t){var r=0;switch(e.tag){case 31:case 13:var i=e.stateNode,f=e.memoizedState;f!==null&&(r=f.retryLane);break;case 19:i=e.stateNode;break;case 22:i=e.stateNode._retryCache;break;default:throw Error(a(314))}i!==null&&i.delete(t),n0(e,r)}function $1(e,t){return I(e,t)}var Fi=null,oa=null,Qd=!1,qi=!1,Xd=!1,Fr=0;function Wo(e){e!==oa&&e.next===null&&(oa===null?Fi=oa=e:oa=oa.next=e),qi=!0,Qd||(Qd=!0,V1())}function sl(e,t){if(!Xd&&qi){Xd=!0;do for(var r=!1,i=Fi;i!==null;){if(e!==0){var f=i.pendingLanes;if(f===0)var g=0;else{var N=i.suspendedLanes,E=i.pingedLanes;g=(1<<31-he(42|e)+1)-1,g&=f&~(N&~E),g=g&201326741?g&201326741|1:g?g|2:0}g!==0&&(r=!0,a0(i,g))}else g=Ft,g=Kt(i,i===hn?g:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),(g&3)===0||pt(i,g)||(r=!0,a0(i,g));i=i.next}while(r);Xd=!1}}function K1(){o0()}function o0(){qi=Qd=!1;var e=0;Fr!==0&&Z1()&&(e=Fr);for(var t=Q(),r=null,i=Fi;i!==null;){var f=i.next,g=r0(i,t);g===0?(i.next=null,r===null?Fi=f:r.next=f,f===null&&(oa=r)):(r=i,(e!==0||(g&3)!==0)&&(qi=!0)),i=f}Rn!==0&&Rn!==5||sl(e),Fr!==0&&(Fr=0)}function r0(e,t){for(var r=e.suspendedLanes,i=e.pingedLanes,f=e.expirationTimes,g=e.pendingLanes&-62914561;0<g;){var N=31-he(g),E=1<<N,X=f[N];X===-1?((E&r)===0||(E&i)!==0)&&(f[N]=Lt(E,t)):X<=t&&(e.expiredLanes|=E),g&=~E}if(t=hn,r=Ft,r=Kt(e,e===t?r:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),i=e.callbackNode,r===0||e===t&&(ln===2||ln===9)||e.cancelPendingCommit!==null)return i!==null&&i!==null&&$(i),e.callbackNode=null,e.callbackPriority=0;if((r&3)===0||pt(e,r)){if(t=r&-r,t===e.callbackPriority)return t;switch(i!==null&&$(i),lt(r)){case 2:case 8:r=Te;break;case 32:r=_e;break;case 268435456:r=Ge;break;default:r=_e}return i=s0.bind(null,e),r=I(r,i),e.callbackPriority=t,e.callbackNode=r,t}return i!==null&&i!==null&&$(i),e.callbackPriority=2,e.callbackNode=null,2}function s0(e,t){if(Rn!==0&&Rn!==5)return e.callbackNode=null,e.callbackPriority=0,null;var r=e.callbackNode;if(Wi()&&e.callbackNode!==r)return null;var i=Ft;return i=Kt(e,e===hn?i:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),i===0?null:($m(e,i,t),r0(e,Q()),e.callbackNode!=null&&e.callbackNode===r?s0.bind(null,e):null)}function a0(e,t){if(Wi())return null;$m(e,t,!0)}function V1(){ew(function(){(tn&6)!==0?I(K,K1):o0()})}function Zd(){if(Fr===0){var e=Vs;e===0&&(e=_t,_t<<=1,(_t&261888)===0&&(_t=256)),Fr=e}return Fr}function l0(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:Sn(""+e)}function i0(e,t){var r=t.ownerDocument.createElement("input");return r.name=t.name,r.value=t.value,e.id&&r.setAttribute("form",e.id),t.parentNode.insertBefore(r,t),e=new FormData(e),r.parentNode.removeChild(r),e}function U1(e,t,r,i,f){if(t==="submit"&&r&&r.stateNode===f){var g=l0((f[nt]||null).action),N=i.submitter;N&&(t=(t=N[nt]||null)?l0(t.formAction):N.getAttribute("formAction"),t!==null&&(g=t,N=null));var E=new ri("action","action",null,i,f);e.push({event:E,listeners:[{instance:null,listener:function(){if(i.defaultPrevented){if(Fr!==0){var X=N?i0(f,N):new FormData(f);bd(r,{pending:!0,data:X,method:f.method,action:g},null,X)}}else typeof g=="function"&&(E.preventDefault(),X=N?i0(f,N):new FormData(f),bd(r,{pending:!0,data:X,method:f.method,action:g},g,X))},currentTarget:f}]})}}for(var Jd=0;Jd<Rc.length;Jd++){var ef=Rc[Jd],W1=ef.toLowerCase(),F1=ef[0].toUpperCase()+ef.slice(1);Lo(W1,"on"+F1)}Lo(Hh,"onAnimationEnd"),Lo($h,"onAnimationIteration"),Lo(Kh,"onAnimationStart"),Lo("dblclick","onDoubleClick"),Lo("focusin","onFocus"),Lo("focusout","onBlur"),Lo(l1,"onTransitionRun"),Lo(i1,"onTransitionStart"),Lo(u1,"onTransitionCancel"),Lo(Vh,"onTransitionEnd"),Tt("onMouseEnter",["mouseout","mouseover"]),Tt("onMouseLeave",["mouseout","mouseover"]),Tt("onPointerEnter",["pointerout","pointerover"]),Tt("onPointerLeave",["pointerout","pointerover"]),mt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),mt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),mt("onBeforeInput",["compositionend","keypress","textInput","paste"]),mt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),mt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),mt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var al="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),q1=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(al));function u0(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var i=e[r],f=i.event;i=i.listeners;e:{var g=void 0;if(t)for(var N=i.length-1;0<=N;N--){var E=i[N],X=E.instance,we=E.currentTarget;if(E=E.listener,X!==g&&f.isPropagationStopped())break e;g=E,f.currentTarget=we;try{g(f)}catch(ze){li(ze)}f.currentTarget=null,g=X}else for(N=0;N<i.length;N++){if(E=i[N],X=E.instance,we=E.currentTarget,E=E.listener,X!==g&&f.isPropagationStopped())break e;g=E,f.currentTarget=we;try{g(f)}catch(ze){li(ze)}f.currentTarget=null,g=X}}}}function Wt(e,t){var r=t[gt];r===void 0&&(r=t[gt]=new Set);var i=e+"__bubble";r.has(i)||(c0(t,e,2,!1),r.add(i))}function tf(e,t,r){var i=0;t&&(i|=4),c0(r,e,i,t)}var Gi="_reactListening"+Math.random().toString(36).slice(2);function nf(e){if(!e[Gi]){e[Gi]=!0,Ye.forEach(function(r){r!=="selectionchange"&&(q1.has(r)||tf(r,!1,e),tf(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Gi]||(t[Gi]=!0,tf("selectionchange",!1,t))}}function c0(e,t,r,i){switch(H0(t)){case 2:var f=vw;break;case 8:f=ww;break;default:f=bf}r=f.bind(null,t,r,e),f=void 0,!Sc||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(f=!0),i?f!==void 0?e.addEventListener(t,r,{capture:!0,passive:f}):e.addEventListener(t,r,!0):f!==void 0?e.addEventListener(t,r,{passive:f}):e.addEventListener(t,r,!1)}function of(e,t,r,i,f){var g=i;if((t&1)===0&&(t&2)===0&&i!==null)e:for(;;){if(i===null)return;var N=i.tag;if(N===3||N===4){var E=i.stateNode.containerInfo;if(E===f)break;if(N===4)for(N=i.return;N!==null;){var X=N.tag;if((X===3||X===4)&&N.stateNode.containerInfo===f)return;N=N.return}for(;E!==null;){if(N=Re(E),N===null)return;if(X=N.tag,X===5||X===6||X===26||X===27){i=g=N;continue e}E=E.parentNode}}i=i.return}gh(function(){var we=g,ze=Ma(r),$e=[];e:{var Ce=Uh.get(e);if(Ce!==void 0){var Ae=ri,ft=e;switch(e){case"keypress":if(ni(r)===0)break e;case"keydown":case"keyup":Ae=Hv;break;case"focusin":ft="focus",Ae=jc;break;case"focusout":ft="blur",Ae=jc;break;case"beforeblur":case"afterblur":Ae=jc;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ae=bh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ae=Mv;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ae=Vv;break;case Hh:case $h:case Kh:Ae=Ev;break;case Vh:Ae=Wv;break;case"scroll":case"scrollend":Ae=Cv;break;case"wheel":Ae=qv;break;case"copy":case"cut":case"paste":Ae=Lv;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ae=vh;break;case"toggle":case"beforetoggle":Ae=Pv}var Mt=(t&4)!==0,pn=!Mt&&(e==="scroll"||e==="scrollend"),ge=Mt?Ce!==null?Ce+"Capture":null:Ce;Mt=[];for(var le=we,ve;le!==null;){var He=le;if(ve=He.stateNode,He=He.tag,He!==5&&He!==26&&He!==27||ve===null||ge===null||(He=Oa(le,ge),He!=null&&Mt.push(ll(le,He,ve))),pn)break;le=le.return}0<Mt.length&&(Ce=new Ae(Ce,ft,null,r,ze),$e.push({event:Ce,listeners:Mt}))}}if((t&7)===0){e:{if(Ce=e==="mouseover"||e==="pointerover",Ae=e==="mouseout"||e==="pointerout",Ce&&r!==er&&(ft=r.relatedTarget||r.fromElement)&&(Re(ft)||ft[bt]))break e;if((Ae||Ce)&&(Ce=ze.window===ze?ze:(Ce=ze.ownerDocument)?Ce.defaultView||Ce.parentWindow:window,Ae?(ft=r.relatedTarget||r.toElement,Ae=we,ft=ft?Re(ft):null,ft!==null&&(pn=c(ft),Mt=ft.tag,ft!==pn||Mt!==5&&Mt!==27&&Mt!==6)&&(ft=null)):(Ae=null,ft=we),Ae!==ft)){if(Mt=bh,He="onMouseLeave",ge="onMouseEnter",le="mouse",(e==="pointerout"||e==="pointerover")&&(Mt=vh,He="onPointerLeave",ge="onPointerEnter",le="pointer"),pn=Ae==null?Ce:ot(Ae),ve=ft==null?Ce:ot(ft),Ce=new Mt(He,le+"leave",Ae,r,ze),Ce.target=pn,Ce.relatedTarget=ve,He=null,Re(ze)===we&&(Mt=new Mt(ge,le+"enter",ft,r,ze),Mt.target=ve,Mt.relatedTarget=pn,He=Mt),pn=He,Ae&&ft)t:{for(Mt=G1,ge=Ae,le=ft,ve=0,He=ge;He;He=Mt(He))ve++;He=0;for(var St=le;St;St=Mt(St))He++;for(;0<ve-He;)ge=Mt(ge),ve--;for(;0<He-ve;)le=Mt(le),He--;for(;ve--;){if(ge===le||le!==null&&ge===le.alternate){Mt=ge;break t}ge=Mt(ge),le=Mt(le)}Mt=null}else Mt=null;Ae!==null&&d0($e,Ce,Ae,Mt,!1),ft!==null&&pn!==null&&d0($e,pn,ft,Mt,!0)}}e:{if(Ce=we?ot(we):window,Ae=Ce.nodeName&&Ce.nodeName.toLowerCase(),Ae==="select"||Ae==="input"&&Ce.type==="file")var Xt=Oh;else if(jh(Ce))if(Th)Xt=r1;else{Xt=n1;var ht=t1}else Ae=Ce.nodeName,!Ae||Ae.toLowerCase()!=="input"||Ce.type!=="checkbox"&&Ce.type!=="radio"?we&&rt(we.elementType)&&(Xt=Oh):Xt=o1;if(Xt&&(Xt=Xt(e,we))){Mh($e,Xt,r,ze);break e}ht&&ht(e,Ce,we),e==="focusout"&&we&&Ce.type==="number"&&we.memoizedProps.value!=null&&ja(Ce,"number",Ce.value)}switch(ht=we?ot(we):window,e){case"focusin":(jh(ht)||ht.contentEditable==="true")&&(As=ht,Lc=we,Da=null);break;case"focusout":Da=Lc=As=null;break;case"mousedown":_c=!0;break;case"contextmenu":case"mouseup":case"dragend":_c=!1,Bh($e,r,ze);break;case"selectionchange":if(a1)break;case"keydown":case"keyup":Bh($e,r,ze)}var $t;if(Oc)e:{switch(e){case"compositionstart":var qt="onCompositionStart";break e;case"compositionend":qt="onCompositionEnd";break e;case"compositionupdate":qt="onCompositionUpdate";break e}qt=void 0}else _s?kh(e,r)&&(qt="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(qt="onCompositionStart");qt&&(wh&&r.locale!=="ko"&&(_s||qt!=="onCompositionStart"?qt==="onCompositionEnd"&&_s&&($t=mh()):(Tr=ze,Nc="value"in Tr?Tr.value:Tr.textContent,_s=!0)),ht=Pi(we,qt),0<ht.length&&(qt=new xh(qt,e,null,r,ze),$e.push({event:qt,listeners:ht}),$t?qt.data=$t:($t=Ch(r),$t!==null&&(qt.data=$t)))),($t=Qv?Xv(e,r):Zv(e,r))&&(qt=Pi(we,"onBeforeInput"),0<qt.length&&(ht=new xh("onBeforeInput","beforeinput",null,r,ze),$e.push({event:ht,listeners:qt}),ht.data=$t)),U1($e,e,we,r,ze)}u0($e,t)})}function ll(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Pi(e,t){for(var r=t+"Capture",i=[];e!==null;){var f=e,g=f.stateNode;if(f=f.tag,f!==5&&f!==26&&f!==27||g===null||(f=Oa(e,r),f!=null&&i.unshift(ll(e,f,g)),f=Oa(e,t),f!=null&&i.push(ll(e,f,g))),e.tag===3)return i;e=e.return}return[]}function G1(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function d0(e,t,r,i,f){for(var g=t._reactName,N=[];r!==null&&r!==i;){var E=r,X=E.alternate,we=E.stateNode;if(E=E.tag,X!==null&&X===i)break;E!==5&&E!==26&&E!==27||we===null||(X=we,f?(we=Oa(r,g),we!=null&&N.unshift(ll(r,we,X))):f||(we=Oa(r,g),we!=null&&N.push(ll(r,we,X)))),r=r.return}N.length!==0&&e.push({event:t,listeners:N})}var P1=/\r\n?/g,Y1=/\u0000|\uFFFD/g;function f0(e){return(typeof e=="string"?e:""+e).replace(P1,`
`).replace(Y1,"")}function p0(e,t){return t=f0(t),f0(e)===t}function fn(e,t,r,i,f,g){switch(r){case"children":typeof i=="string"?t==="body"||t==="textarea"&&i===""||Or(e,i):(typeof i=="number"||typeof i=="bigint")&&t!=="body"&&Or(e,""+i);break;case"className":cn(e,"class",i);break;case"tabIndex":cn(e,"tabindex",i);break;case"dir":case"role":case"viewBox":case"width":case"height":cn(e,r,i);break;case"style":Ee(e,i,g);break;case"data":if(t!=="object"){cn(e,"data",i);break}case"src":case"href":if(i===""&&(t!=="a"||r!=="href")){e.removeAttribute(r);break}if(i==null||typeof i=="function"||typeof i=="symbol"||typeof i=="boolean"){e.removeAttribute(r);break}i=Sn(""+i),e.setAttribute(r,i);break;case"action":case"formAction":if(typeof i=="function"){e.setAttribute(r,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof g=="function"&&(r==="formAction"?(t!=="input"&&fn(e,t,"name",f.name,f,null),fn(e,t,"formEncType",f.formEncType,f,null),fn(e,t,"formMethod",f.formMethod,f,null),fn(e,t,"formTarget",f.formTarget,f,null)):(fn(e,t,"encType",f.encType,f,null),fn(e,t,"method",f.method,f,null),fn(e,t,"target",f.target,f,null)));if(i==null||typeof i=="symbol"||typeof i=="boolean"){e.removeAttribute(r);break}i=Sn(""+i),e.setAttribute(r,i);break;case"onClick":i!=null&&(e.onclick=Bt);break;case"onScroll":i!=null&&Wt("scroll",e);break;case"onScrollEnd":i!=null&&Wt("scrollend",e);break;case"dangerouslySetInnerHTML":if(i!=null){if(typeof i!="object"||!("__html"in i))throw Error(a(61));if(r=i.__html,r!=null){if(f.children!=null)throw Error(a(60));e.innerHTML=r}}break;case"multiple":e.multiple=i&&typeof i!="function"&&typeof i!="symbol";break;case"muted":e.muted=i&&typeof i!="function"&&typeof i!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(i==null||typeof i=="function"||typeof i=="boolean"||typeof i=="symbol"){e.removeAttribute("xlink:href");break}r=Sn(""+i),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",r);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":i!=null&&typeof i!="function"&&typeof i!="symbol"?e.setAttribute(r,""+i):e.removeAttribute(r);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":i&&typeof i!="function"&&typeof i!="symbol"?e.setAttribute(r,""):e.removeAttribute(r);break;case"capture":case"download":i===!0?e.setAttribute(r,""):i!==!1&&i!=null&&typeof i!="function"&&typeof i!="symbol"?e.setAttribute(r,i):e.removeAttribute(r);break;case"cols":case"rows":case"size":case"span":i!=null&&typeof i!="function"&&typeof i!="symbol"&&!isNaN(i)&&1<=i?e.setAttribute(r,i):e.removeAttribute(r);break;case"rowSpan":case"start":i==null||typeof i=="function"||typeof i=="symbol"||isNaN(i)?e.removeAttribute(r):e.setAttribute(r,i);break;case"popover":Wt("beforetoggle",e),Wt("toggle",e),Rt(e,"popover",i);break;case"xlinkActuate":wn(e,"http://www.w3.org/1999/xlink","xlink:actuate",i);break;case"xlinkArcrole":wn(e,"http://www.w3.org/1999/xlink","xlink:arcrole",i);break;case"xlinkRole":wn(e,"http://www.w3.org/1999/xlink","xlink:role",i);break;case"xlinkShow":wn(e,"http://www.w3.org/1999/xlink","xlink:show",i);break;case"xlinkTitle":wn(e,"http://www.w3.org/1999/xlink","xlink:title",i);break;case"xlinkType":wn(e,"http://www.w3.org/1999/xlink","xlink:type",i);break;case"xmlBase":wn(e,"http://www.w3.org/XML/1998/namespace","xml:base",i);break;case"xmlLang":wn(e,"http://www.w3.org/XML/1998/namespace","xml:lang",i);break;case"xmlSpace":wn(e,"http://www.w3.org/XML/1998/namespace","xml:space",i);break;case"is":Rt(e,"is",i);break;case"innerText":case"textContent":break;default:(!(2<r.length)||r[0]!=="o"&&r[0]!=="O"||r[1]!=="n"&&r[1]!=="N")&&(r=vt.get(r)||r,Rt(e,r,i))}}function rf(e,t,r,i,f,g){switch(r){case"style":Ee(e,i,g);break;case"dangerouslySetInnerHTML":if(i!=null){if(typeof i!="object"||!("__html"in i))throw Error(a(61));if(r=i.__html,r!=null){if(f.children!=null)throw Error(a(60));e.innerHTML=r}}break;case"children":typeof i=="string"?Or(e,i):(typeof i=="number"||typeof i=="bigint")&&Or(e,""+i);break;case"onScroll":i!=null&&Wt("scroll",e);break;case"onScrollEnd":i!=null&&Wt("scrollend",e);break;case"onClick":i!=null&&(e.onclick=Bt);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Ct.hasOwnProperty(r))e:{if(r[0]==="o"&&r[1]==="n"&&(f=r.endsWith("Capture"),t=r.slice(2,f?r.length-7:void 0),g=e[nt]||null,g=g!=null?g[r]:null,typeof g=="function"&&e.removeEventListener(t,g,f),typeof i=="function")){typeof g!="function"&&g!==null&&(r in e?e[r]=null:e.hasAttribute(r)&&e.removeAttribute(r)),e.addEventListener(t,i,f);break e}r in e?e[r]=i:i===!0?e.setAttribute(r,""):Rt(e,r,i)}}}function $n(e,t,r){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Wt("error",e),Wt("load",e);var i=!1,f=!1,g;for(g in r)if(r.hasOwnProperty(g)){var N=r[g];if(N!=null)switch(g){case"src":i=!0;break;case"srcSet":f=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,t));default:fn(e,t,g,N,r,null)}}f&&fn(e,t,"srcSet",r.srcSet,r,null),i&&fn(e,t,"src",r.src,r,null);return;case"input":Wt("invalid",e);var E=g=N=f=null,X=null,we=null;for(i in r)if(r.hasOwnProperty(i)){var ze=r[i];if(ze!=null)switch(i){case"name":f=ze;break;case"type":N=ze;break;case"checked":X=ze;break;case"defaultChecked":we=ze;break;case"value":g=ze;break;case"defaultValue":E=ze;break;case"children":case"dangerouslySetInnerHTML":if(ze!=null)throw Error(a(137,t));break;default:fn(e,t,i,ze,r,null)}}Zl(e,g,E,X,we,N,f,!1);return;case"select":Wt("invalid",e),i=N=g=null;for(f in r)if(r.hasOwnProperty(f)&&(E=r[f],E!=null))switch(f){case"value":g=E;break;case"defaultValue":N=E;break;case"multiple":i=E;default:fn(e,t,f,E,r,null)}t=g,r=N,e.multiple=!!i,t!=null?Zo(e,!!i,t,!1):r!=null&&Zo(e,!!i,r,!0);return;case"textarea":Wt("invalid",e),g=f=i=null;for(N in r)if(r.hasOwnProperty(N)&&(E=r[N],E!=null))switch(N){case"value":i=E;break;case"defaultValue":f=E;break;case"children":g=E;break;case"dangerouslySetInnerHTML":if(E!=null)throw Error(a(91));break;default:fn(e,t,N,E,r,null)}Jl(e,i,f,g);return;case"option":for(X in r)r.hasOwnProperty(X)&&(i=r[X],i!=null)&&(X==="selected"?e.selected=i&&typeof i!="function"&&typeof i!="symbol":fn(e,t,X,i,r,null));return;case"dialog":Wt("beforetoggle",e),Wt("toggle",e),Wt("cancel",e),Wt("close",e);break;case"iframe":case"object":Wt("load",e);break;case"video":case"audio":for(i=0;i<al.length;i++)Wt(al[i],e);break;case"image":Wt("error",e),Wt("load",e);break;case"details":Wt("toggle",e);break;case"embed":case"source":case"link":Wt("error",e),Wt("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(we in r)if(r.hasOwnProperty(we)&&(i=r[we],i!=null))switch(we){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,t));default:fn(e,t,we,i,r,null)}return;default:if(rt(t)){for(ze in r)r.hasOwnProperty(ze)&&(i=r[ze],i!==void 0&&rf(e,t,ze,i,r,void 0));return}}for(E in r)r.hasOwnProperty(E)&&(i=r[E],i!=null&&fn(e,t,E,i,r,null))}function Q1(e,t,r,i){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var f=null,g=null,N=null,E=null,X=null,we=null,ze=null;for(Ae in r){var $e=r[Ae];if(r.hasOwnProperty(Ae)&&$e!=null)switch(Ae){case"checked":break;case"value":break;case"defaultValue":X=$e;default:i.hasOwnProperty(Ae)||fn(e,t,Ae,null,i,$e)}}for(var Ce in i){var Ae=i[Ce];if($e=r[Ce],i.hasOwnProperty(Ce)&&(Ae!=null||$e!=null))switch(Ce){case"type":g=Ae;break;case"name":f=Ae;break;case"checked":we=Ae;break;case"defaultChecked":ze=Ae;break;case"value":N=Ae;break;case"defaultValue":E=Ae;break;case"children":case"dangerouslySetInnerHTML":if(Ae!=null)throw Error(a(137,t));break;default:Ae!==$e&&fn(e,t,Ce,Ae,i,$e)}}os(e,N,E,X,we,ze,g,f);return;case"select":Ae=N=E=Ce=null;for(g in r)if(X=r[g],r.hasOwnProperty(g)&&X!=null)switch(g){case"value":break;case"multiple":Ae=X;default:i.hasOwnProperty(g)||fn(e,t,g,null,i,X)}for(f in i)if(g=i[f],X=r[f],i.hasOwnProperty(f)&&(g!=null||X!=null))switch(f){case"value":Ce=g;break;case"defaultValue":E=g;break;case"multiple":N=g;default:g!==X&&fn(e,t,f,g,i,X)}t=E,r=N,i=Ae,Ce!=null?Zo(e,!!r,Ce,!1):!!i!=!!r&&(t!=null?Zo(e,!!r,t,!0):Zo(e,!!r,r?[]:"",!1));return;case"textarea":Ae=Ce=null;for(E in r)if(f=r[E],r.hasOwnProperty(E)&&f!=null&&!i.hasOwnProperty(E))switch(E){case"value":break;case"children":break;default:fn(e,t,E,null,i,f)}for(N in i)if(f=i[N],g=r[N],i.hasOwnProperty(N)&&(f!=null||g!=null))switch(N){case"value":Ce=f;break;case"defaultValue":Ae=f;break;case"children":break;case"dangerouslySetInnerHTML":if(f!=null)throw Error(a(91));break;default:f!==g&&fn(e,t,N,f,i,g)}Jo(e,Ce,Ae);return;case"option":for(var ft in r)Ce=r[ft],r.hasOwnProperty(ft)&&Ce!=null&&!i.hasOwnProperty(ft)&&(ft==="selected"?e.selected=!1:fn(e,t,ft,null,i,Ce));for(X in i)Ce=i[X],Ae=r[X],i.hasOwnProperty(X)&&Ce!==Ae&&(Ce!=null||Ae!=null)&&(X==="selected"?e.selected=Ce&&typeof Ce!="function"&&typeof Ce!="symbol":fn(e,t,X,Ce,i,Ae));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Mt in r)Ce=r[Mt],r.hasOwnProperty(Mt)&&Ce!=null&&!i.hasOwnProperty(Mt)&&fn(e,t,Mt,null,i,Ce);for(we in i)if(Ce=i[we],Ae=r[we],i.hasOwnProperty(we)&&Ce!==Ae&&(Ce!=null||Ae!=null))switch(we){case"children":case"dangerouslySetInnerHTML":if(Ce!=null)throw Error(a(137,t));break;default:fn(e,t,we,Ce,i,Ae)}return;default:if(rt(t)){for(var pn in r)Ce=r[pn],r.hasOwnProperty(pn)&&Ce!==void 0&&!i.hasOwnProperty(pn)&&rf(e,t,pn,void 0,i,Ce);for(ze in i)Ce=i[ze],Ae=r[ze],!i.hasOwnProperty(ze)||Ce===Ae||Ce===void 0&&Ae===void 0||rf(e,t,ze,Ce,i,Ae);return}}for(var ge in r)Ce=r[ge],r.hasOwnProperty(ge)&&Ce!=null&&!i.hasOwnProperty(ge)&&fn(e,t,ge,null,i,Ce);for($e in i)Ce=i[$e],Ae=r[$e],!i.hasOwnProperty($e)||Ce===Ae||Ce==null&&Ae==null||fn(e,t,$e,Ce,i,Ae)}function h0(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function X1(){if(typeof performance.getEntriesByType=="function"){for(var e=0,t=0,r=performance.getEntriesByType("resource"),i=0;i<r.length;i++){var f=r[i],g=f.transferSize,N=f.initiatorType,E=f.duration;if(g&&E&&h0(N)){for(N=0,E=f.responseEnd,i+=1;i<r.length;i++){var X=r[i],we=X.startTime;if(we>E)break;var ze=X.transferSize,$e=X.initiatorType;ze&&h0($e)&&(X=X.responseEnd,N+=ze*(X<E?1:(E-we)/(X-we)))}if(--i,t+=8*(g+N)/(f.duration/1e3),e++,10<e)break}}if(0<e)return t/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var sf=null,af=null;function Yi(e){return e.nodeType===9?e:e.ownerDocument}function g0(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function m0(e,t){if(e===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&t==="foreignObject"?0:e}function lf(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var uf=null;function Z1(){var e=window.event;return e&&e.type==="popstate"?e===uf?!1:(uf=e,!0):(uf=null,!1)}var y0=typeof setTimeout=="function"?setTimeout:void 0,J1=typeof clearTimeout=="function"?clearTimeout:void 0,b0=typeof Promise=="function"?Promise:void 0,ew=typeof queueMicrotask=="function"?queueMicrotask:typeof b0<"u"?function(e){return b0.resolve(null).then(e).catch(tw)}:y0;function tw(e){setTimeout(function(){throw e})}function qr(e){return e==="head"}function x0(e,t){var r=t,i=0;do{var f=r.nextSibling;if(e.removeChild(r),f&&f.nodeType===8)if(r=f.data,r==="/$"||r==="/&"){if(i===0){e.removeChild(f),la(t);return}i--}else if(r==="$"||r==="$?"||r==="$~"||r==="$!"||r==="&")i++;else if(r==="html")il(e.ownerDocument.documentElement);else if(r==="head"){r=e.ownerDocument.head,il(r);for(var g=r.firstChild;g;){var N=g.nextSibling,E=g.nodeName;g[Yt]||E==="SCRIPT"||E==="STYLE"||E==="LINK"&&g.rel.toLowerCase()==="stylesheet"||r.removeChild(g),g=N}}else r==="body"&&il(e.ownerDocument.body);r=f}while(r);la(t)}function v0(e,t){var r=e;e=0;do{var i=r.nextSibling;if(r.nodeType===1?t?(r._stashedDisplay=r.style.display,r.style.display="none"):(r.style.display=r._stashedDisplay||"",r.getAttribute("style")===""&&r.removeAttribute("style")):r.nodeType===3&&(t?(r._stashedText=r.nodeValue,r.nodeValue=""):r.nodeValue=r._stashedText||""),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(e===0)break;e--}else r!=="$"&&r!=="$?"&&r!=="$~"&&r!=="$!"||e++;r=i}while(r)}function cf(e){var t=e.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var r=t;switch(t=t.nextSibling,r.nodeName){case"HTML":case"HEAD":case"BODY":cf(r),Y(r);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(r.rel.toLowerCase()==="stylesheet")continue}e.removeChild(r)}}function nw(e,t,r,i){for(;e.nodeType===1;){var f=r;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!i&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(i){if(!e[Yt])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(g=e.getAttribute("rel"),g==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(g!==f.rel||e.getAttribute("href")!==(f.href==null||f.href===""?null:f.href)||e.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin)||e.getAttribute("title")!==(f.title==null?null:f.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(g=e.getAttribute("src"),(g!==(f.src==null?null:f.src)||e.getAttribute("type")!==(f.type==null?null:f.type)||e.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin))&&g&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(t==="input"&&e.type==="hidden"){var g=f.name==null?null:""+f.name;if(f.type==="hidden"&&e.getAttribute("name")===g)return e}else return e;if(e=Mo(e.nextSibling),e===null)break}return null}function ow(e,t,r){if(t==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!r||(e=Mo(e.nextSibling),e===null))return null;return e}function w0(e,t){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!t||(e=Mo(e.nextSibling),e===null))return null;return e}function df(e){return e.data==="$?"||e.data==="$~"}function ff(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function rw(e,t){var r=e.ownerDocument;if(e.data==="$~")e._reactRetry=t;else if(e.data!=="$?"||r.readyState!=="loading")t();else{var i=function(){t(),r.removeEventListener("DOMContentLoaded",i)};r.addEventListener("DOMContentLoaded",i),e._reactRetry=i}}function Mo(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?"||t==="$~"||t==="&"||t==="F!"||t==="F")break;if(t==="/$"||t==="/&")return null}}return e}var pf=null;function S0(e){e=e.nextSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"||r==="/&"){if(t===0)return Mo(e.nextSibling);t--}else r!=="$"&&r!=="$!"&&r!=="$?"&&r!=="$~"&&r!=="&"||t++}e=e.nextSibling}return null}function N0(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"){if(t===0)return e;t--}else r!=="/$"&&r!=="/&"||t++}e=e.previousSibling}return null}function k0(e,t,r){switch(t=Yi(r),e){case"html":if(e=t.documentElement,!e)throw Error(a(452));return e;case"head":if(e=t.head,!e)throw Error(a(453));return e;case"body":if(e=t.body,!e)throw Error(a(454));return e;default:throw Error(a(451))}}function il(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Y(e)}var Oo=new Map,C0=new Set;function Qi(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var mr=H.d;H.d={f:sw,r:aw,D:lw,C:iw,L:uw,m:cw,X:fw,S:dw,M:pw};function sw(){var e=mr.f(),t=Ki();return e||t}function aw(e){var t=ie(e);t!==null&&t.tag===5&&t.type==="form"?Vg(t):mr.r(e)}var ra=typeof document>"u"?null:document;function j0(e,t,r){var i=ra;if(i&&typeof t=="string"&&t){var f=Gn(t);f='link[rel="'+e+'"][href="'+f+'"]',typeof r=="string"&&(f+='[crossorigin="'+r+'"]'),C0.has(f)||(C0.add(f),e={rel:e,crossOrigin:r,href:t},i.querySelector(f)===null&&(t=i.createElement("link"),$n(t,"link",e),Ze(t),i.head.appendChild(t)))}}function lw(e){mr.D(e),j0("dns-prefetch",e,null)}function iw(e,t){mr.C(e,t),j0("preconnect",e,t)}function uw(e,t,r){mr.L(e,t,r);var i=ra;if(i&&e&&t){var f='link[rel="preload"][as="'+Gn(t)+'"]';t==="image"&&r&&r.imageSrcSet?(f+='[imagesrcset="'+Gn(r.imageSrcSet)+'"]',typeof r.imageSizes=="string"&&(f+='[imagesizes="'+Gn(r.imageSizes)+'"]')):f+='[href="'+Gn(e)+'"]';var g=f;switch(t){case"style":g=sa(e);break;case"script":g=aa(e)}Oo.has(g)||(e=x({rel:"preload",href:t==="image"&&r&&r.imageSrcSet?void 0:e,as:t},r),Oo.set(g,e),i.querySelector(f)!==null||t==="style"&&i.querySelector(ul(g))||t==="script"&&i.querySelector(cl(g))||(t=i.createElement("link"),$n(t,"link",e),Ze(t),i.head.appendChild(t)))}}function cw(e,t){mr.m(e,t);var r=ra;if(r&&e){var i=t&&typeof t.as=="string"?t.as:"script",f='link[rel="modulepreload"][as="'+Gn(i)+'"][href="'+Gn(e)+'"]',g=f;switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":g=aa(e)}if(!Oo.has(g)&&(e=x({rel:"modulepreload",href:e},t),Oo.set(g,e),r.querySelector(f)===null)){switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(r.querySelector(cl(g)))return}i=r.createElement("link"),$n(i,"link",e),Ze(i),r.head.appendChild(i)}}}function dw(e,t,r){mr.S(e,t,r);var i=ra;if(i&&e){var f=tt(i).hoistableStyles,g=sa(e);t=t||"default";var N=f.get(g);if(!N){var E={loading:0,preload:null};if(N=i.querySelector(ul(g)))E.loading=5;else{e=x({rel:"stylesheet",href:e,"data-precedence":t},r),(r=Oo.get(g))&&hf(e,r);var X=N=i.createElement("link");Ze(X),$n(X,"link",e),X._p=new Promise(function(we,ze){X.onload=we,X.onerror=ze}),X.addEventListener("load",function(){E.loading|=1}),X.addEventListener("error",function(){E.loading|=2}),E.loading|=4,Xi(N,t,i)}N={type:"stylesheet",instance:N,count:1,state:E},f.set(g,N)}}}function fw(e,t){mr.X(e,t);var r=ra;if(r&&e){var i=tt(r).hoistableScripts,f=aa(e),g=i.get(f);g||(g=r.querySelector(cl(f)),g||(e=x({src:e,async:!0},t),(t=Oo.get(f))&&gf(e,t),g=r.createElement("script"),Ze(g),$n(g,"link",e),r.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},i.set(f,g))}}function pw(e,t){mr.M(e,t);var r=ra;if(r&&e){var i=tt(r).hoistableScripts,f=aa(e),g=i.get(f);g||(g=r.querySelector(cl(f)),g||(e=x({src:e,async:!0,type:"module"},t),(t=Oo.get(f))&&gf(e,t),g=r.createElement("script"),Ze(g),$n(g,"link",e),r.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},i.set(f,g))}}function M0(e,t,r,i){var f=(f=De.current)?Qi(f):null;if(!f)throw Error(a(446));switch(e){case"meta":case"title":return null;case"style":return typeof r.precedence=="string"&&typeof r.href=="string"?(t=sa(r.href),r=tt(f).hoistableStyles,i=r.get(t),i||(i={type:"style",instance:null,count:0,state:null},r.set(t,i)),i):{type:"void",instance:null,count:0,state:null};case"link":if(r.rel==="stylesheet"&&typeof r.href=="string"&&typeof r.precedence=="string"){e=sa(r.href);var g=tt(f).hoistableStyles,N=g.get(e);if(N||(f=f.ownerDocument||f,N={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},g.set(e,N),(g=f.querySelector(ul(e)))&&!g._p&&(N.instance=g,N.state.loading=5),Oo.has(e)||(r={rel:"preload",as:"style",href:r.href,crossOrigin:r.crossOrigin,integrity:r.integrity,media:r.media,hrefLang:r.hrefLang,referrerPolicy:r.referrerPolicy},Oo.set(e,r),g||hw(f,e,r,N.state))),t&&i===null)throw Error(a(528,""));return N}if(t&&i!==null)throw Error(a(529,""));return null;case"script":return t=r.async,r=r.src,typeof r=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=aa(r),r=tt(f).hoistableScripts,i=r.get(t),i||(i={type:"script",instance:null,count:0,state:null},r.set(t,i)),i):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,e))}}function sa(e){return'href="'+Gn(e)+'"'}function ul(e){return'link[rel="stylesheet"]['+e+"]"}function O0(e){return x({},e,{"data-precedence":e.precedence,precedence:null})}function hw(e,t,r,i){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?i.loading=1:(t=e.createElement("link"),i.preload=t,t.addEventListener("load",function(){return i.loading|=1}),t.addEventListener("error",function(){return i.loading|=2}),$n(t,"link",r),Ze(t),e.head.appendChild(t))}function aa(e){return'[src="'+Gn(e)+'"]'}function cl(e){return"script[async]"+e}function T0(e,t,r){if(t.count++,t.instance===null)switch(t.type){case"style":var i=e.querySelector('style[data-href~="'+Gn(r.href)+'"]');if(i)return t.instance=i,Ze(i),i;var f=x({},r,{"data-href":r.href,"data-precedence":r.precedence,href:null,precedence:null});return i=(e.ownerDocument||e).createElement("style"),Ze(i),$n(i,"style",f),Xi(i,r.precedence,e),t.instance=i;case"stylesheet":f=sa(r.href);var g=e.querySelector(ul(f));if(g)return t.state.loading|=4,t.instance=g,Ze(g),g;i=O0(r),(f=Oo.get(f))&&hf(i,f),g=(e.ownerDocument||e).createElement("link"),Ze(g);var N=g;return N._p=new Promise(function(E,X){N.onload=E,N.onerror=X}),$n(g,"link",i),t.state.loading|=4,Xi(g,r.precedence,e),t.instance=g;case"script":return g=aa(r.src),(f=e.querySelector(cl(g)))?(t.instance=f,Ze(f),f):(i=r,(f=Oo.get(g))&&(i=x({},r),gf(i,f)),e=e.ownerDocument||e,f=e.createElement("script"),Ze(f),$n(f,"link",i),e.head.appendChild(f),t.instance=f);case"void":return null;default:throw Error(a(443,t.type))}else t.type==="stylesheet"&&(t.state.loading&4)===0&&(i=t.instance,t.state.loading|=4,Xi(i,r.precedence,e));return t.instance}function Xi(e,t,r){for(var i=r.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),f=i.length?i[i.length-1]:null,g=f,N=0;N<i.length;N++){var E=i[N];if(E.dataset.precedence===t)g=E;else if(g!==f)break}g?g.parentNode.insertBefore(e,g.nextSibling):(t=r.nodeType===9?r.head:r,t.insertBefore(e,t.firstChild))}function hf(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.title==null&&(e.title=t.title)}function gf(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.integrity==null&&(e.integrity=t.integrity)}var Zi=null;function E0(e,t,r){if(Zi===null){var i=new Map,f=Zi=new Map;f.set(r,i)}else f=Zi,i=f.get(r),i||(i=new Map,f.set(r,i));if(i.has(e))return i;for(i.set(e,null),r=r.getElementsByTagName(e),f=0;f<r.length;f++){var g=r[f];if(!(g[Yt]||g[dt]||e==="link"&&g.getAttribute("rel")==="stylesheet")&&g.namespaceURI!=="http://www.w3.org/2000/svg"){var N=g.getAttribute(t)||"";N=e+N;var E=i.get(N);E?E.push(g):i.set(N,[g])}}return i}function I0(e,t,r){e=e.ownerDocument||e,e.head.insertBefore(r,t==="title"?e.querySelector("head > title"):null)}function gw(e,t,r){if(r===1||t.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;return t.rel==="stylesheet"?(e=t.disabled,typeof t.precedence=="string"&&e==null):!0;case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function L0(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function mw(e,t,r,i){if(r.type==="stylesheet"&&(typeof i.media!="string"||matchMedia(i.media).matches!==!1)&&(r.state.loading&4)===0){if(r.instance===null){var f=sa(i.href),g=t.querySelector(ul(f));if(g){t=g._p,t!==null&&typeof t=="object"&&typeof t.then=="function"&&(e.count++,e=Ji.bind(e),t.then(e,e)),r.state.loading|=4,r.instance=g,Ze(g);return}g=t.ownerDocument||t,i=O0(i),(f=Oo.get(f))&&hf(i,f),g=g.createElement("link"),Ze(g);var N=g;N._p=new Promise(function(E,X){N.onload=E,N.onerror=X}),$n(g,"link",i),r.instance=g}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(r,t),(t=r.state.preload)&&(r.state.loading&3)===0&&(e.count++,r=Ji.bind(e),t.addEventListener("load",r),t.addEventListener("error",r))}}var mf=0;function yw(e,t){return e.stylesheets&&e.count===0&&tu(e,e.stylesheets),0<e.count||0<e.imgCount?function(r){var i=setTimeout(function(){if(e.stylesheets&&tu(e,e.stylesheets),e.unsuspend){var g=e.unsuspend;e.unsuspend=null,g()}},6e4+t);0<e.imgBytes&&mf===0&&(mf=62500*X1());var f=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&tu(e,e.stylesheets),e.unsuspend)){var g=e.unsuspend;e.unsuspend=null,g()}},(e.imgBytes>mf?50:800)+t);return e.unsuspend=r,function(){e.unsuspend=null,clearTimeout(i),clearTimeout(f)}}:null}function Ji(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)tu(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var eu=null;function tu(e,t){e.stylesheets=null,e.unsuspend!==null&&(e.count++,eu=new Map,t.forEach(bw,e),eu=null,Ji.call(e))}function bw(e,t){if(!(t.state.loading&4)){var r=eu.get(e);if(r)var i=r.get(null);else{r=new Map,eu.set(e,r);for(var f=e.querySelectorAll("link[data-precedence],style[data-precedence]"),g=0;g<f.length;g++){var N=f[g];(N.nodeName==="LINK"||N.getAttribute("media")!=="not all")&&(r.set(N.dataset.precedence,N),i=N)}i&&r.set(null,i)}f=t.instance,N=f.getAttribute("data-precedence"),g=r.get(N)||i,g===i&&r.set(null,f),r.set(N,f),this.count++,i=Ji.bind(this),f.addEventListener("load",i),f.addEventListener("error",i),g?g.parentNode.insertBefore(f,g.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(f,e.firstChild)),t.state.loading|=4}}var dl={$$typeof:R,Provider:null,Consumer:null,_currentValue:ce,_currentValue2:ce,_threadCount:0};function xw(e,t,r,i,f,g,N,E,X){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=xe(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=xe(0),this.hiddenUpdates=xe(null),this.identifierPrefix=i,this.onUncaughtError=f,this.onCaughtError=g,this.onRecoverableError=N,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=X,this.incompleteTransitions=new Map}function _0(e,t,r,i,f,g,N,E,X,we,ze,$e){return e=new xw(e,t,r,N,X,we,ze,$e,E),t=1,g===!0&&(t|=24),g=uo(3,null,null,t),e.current=g,g.stateNode=e,t=Pc(),t.refCount++,e.pooledCache=t,t.refCount++,g.memoizedState={element:i,isDehydrated:r,cache:t},Zc(g),e}function A0(e){return e?(e=Bs,e):Bs}function R0(e,t,r,i,f,g){f=A0(f),i.context===null?i.context=f:i.pendingContext=f,i=Rr(t),i.payload={element:r},g=g===void 0?null:g,g!==null&&(i.callback=g),r=Dr(e,i,t),r!==null&&(oo(r,e,t),Ua(r,e,t))}function D0(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function yf(e,t){D0(e,t),(e=e.alternate)&&D0(e,t)}function B0(e){if(e.tag===13||e.tag===31){var t=ls(e,67108864);t!==null&&oo(t,e,67108864),yf(e,67108864)}}function z0(e){if(e.tag===13||e.tag===31){var t=go();t=Oe(t);var r=ls(e,t);r!==null&&oo(r,e,t),yf(e,t)}}var nu=!0;function vw(e,t,r,i){var f=V.T;V.T=null;var g=H.p;try{H.p=2,bf(e,t,r,i)}finally{H.p=g,V.T=f}}function ww(e,t,r,i){var f=V.T;V.T=null;var g=H.p;try{H.p=8,bf(e,t,r,i)}finally{H.p=g,V.T=f}}function bf(e,t,r,i){if(nu){var f=xf(i);if(f===null)of(e,t,i,ou,r),$0(e,i);else if(Nw(f,e,t,r,i))i.stopPropagation();else if($0(e,i),t&4&&-1<Sw.indexOf(e)){for(;f!==null;){var g=ie(f);if(g!==null)switch(g.tag){case 3:if(g=g.stateNode,g.current.memoizedState.isDehydrated){var N=It(g.pendingLanes);if(N!==0){var E=g;for(E.pendingLanes|=2,E.entangledLanes|=2;N;){var X=1<<31-he(N);E.entanglements[1]|=X,N&=~X}Wo(g),(tn&6)===0&&(Hi=Q()+500,sl(0))}}break;case 31:case 13:E=ls(g,2),E!==null&&oo(E,g,2),Ki(),yf(g,2)}if(g=xf(i),g===null&&of(e,t,i,ou,r),g===f)break;f=g}f!==null&&i.stopPropagation()}else of(e,t,i,null,r)}}function xf(e){return e=Ma(e),vf(e)}var ou=null;function vf(e){if(ou=null,e=Re(e),e!==null){var t=c(e);if(t===null)e=null;else{var r=t.tag;if(r===13){if(e=d(t),e!==null)return e;e=null}else if(r===31){if(e=h(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return ou=e,null}function H0(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Me()){case K:return 2;case Te:return 8;case _e:case qe:return 32;case Ge:return 268435456;default:return 32}default:return 32}}var wf=!1,Gr=null,Pr=null,Yr=null,fl=new Map,pl=new Map,Qr=[],Sw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function $0(e,t){switch(e){case"focusin":case"focusout":Gr=null;break;case"dragenter":case"dragleave":Pr=null;break;case"mouseover":case"mouseout":Yr=null;break;case"pointerover":case"pointerout":fl.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":pl.delete(t.pointerId)}}function hl(e,t,r,i,f,g){return e===null||e.nativeEvent!==g?(e={blockedOn:t,domEventName:r,eventSystemFlags:i,nativeEvent:g,targetContainers:[f]},t!==null&&(t=ie(t),t!==null&&B0(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,f!==null&&t.indexOf(f)===-1&&t.push(f),e)}function Nw(e,t,r,i,f){switch(t){case"focusin":return Gr=hl(Gr,e,t,r,i,f),!0;case"dragenter":return Pr=hl(Pr,e,t,r,i,f),!0;case"mouseover":return Yr=hl(Yr,e,t,r,i,f),!0;case"pointerover":var g=f.pointerId;return fl.set(g,hl(fl.get(g)||null,e,t,r,i,f)),!0;case"gotpointercapture":return g=f.pointerId,pl.set(g,hl(pl.get(g)||null,e,t,r,i,f)),!0}return!1}function K0(e){var t=Re(e.target);if(t!==null){var r=c(t);if(r!==null){if(t=r.tag,t===13){if(t=d(r),t!==null){e.blockedOn=t,at(e.priority,function(){z0(r)});return}}else if(t===31){if(t=h(r),t!==null){e.blockedOn=t,at(e.priority,function(){z0(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function ru(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=xf(e.nativeEvent);if(r===null){r=e.nativeEvent;var i=new r.constructor(r.type,r);er=i,r.target.dispatchEvent(i),er=null}else return t=ie(r),t!==null&&B0(t),e.blockedOn=r,!1;t.shift()}return!0}function V0(e,t,r){ru(e)&&r.delete(t)}function kw(){wf=!1,Gr!==null&&ru(Gr)&&(Gr=null),Pr!==null&&ru(Pr)&&(Pr=null),Yr!==null&&ru(Yr)&&(Yr=null),fl.forEach(V0),pl.forEach(V0)}function su(e,t){e.blockedOn===t&&(e.blockedOn=null,wf||(wf=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,kw)))}var au=null;function U0(e){au!==e&&(au=e,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){au===e&&(au=null);for(var t=0;t<e.length;t+=3){var r=e[t],i=e[t+1],f=e[t+2];if(typeof i!="function"){if(vf(i||r)===null)continue;break}var g=ie(r);g!==null&&(e.splice(t,3),t-=3,bd(g,{pending:!0,data:f,method:r.method,action:i},i,f))}}))}function la(e){function t(X){return su(X,e)}Gr!==null&&su(Gr,e),Pr!==null&&su(Pr,e),Yr!==null&&su(Yr,e),fl.forEach(t),pl.forEach(t);for(var r=0;r<Qr.length;r++){var i=Qr[r];i.blockedOn===e&&(i.blockedOn=null)}for(;0<Qr.length&&(r=Qr[0],r.blockedOn===null);)K0(r),r.blockedOn===null&&Qr.shift();if(r=(e.ownerDocument||e).$$reactFormReplay,r!=null)for(i=0;i<r.length;i+=3){var f=r[i],g=r[i+1],N=f[nt]||null;if(typeof g=="function")N||U0(r);else if(N){var E=null;if(g&&g.hasAttribute("formAction")){if(f=g,N=g[nt]||null)E=N.formAction;else if(vf(f)!==null)continue}else E=N.action;typeof E=="function"?r[i+1]=E:(r.splice(i,3),i-=3),U0(r)}}}function W0(){function e(g){g.canIntercept&&g.info==="react-transition"&&g.intercept({handler:function(){return new Promise(function(N){return f=N})},focusReset:"manual",scroll:"manual"})}function t(){f!==null&&(f(),f=null),i||setTimeout(r,20)}function r(){if(!i&&!navigation.transition){var g=navigation.currentEntry;g&&g.url!=null&&navigation.navigate(g.url,{state:g.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var i=!1,f=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(r,100),function(){i=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),f!==null&&(f(),f=null)}}}function Sf(e){this._internalRoot=e}lu.prototype.render=Sf.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(a(409));var r=t.current,i=go();R0(r,i,e,t,null,null)},lu.prototype.unmount=Sf.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;R0(e.current,2,null,e,null,null),Ki(),t[bt]=null}};function lu(e){this._internalRoot=e}lu.prototype.unstable_scheduleHydration=function(e){if(e){var t=st();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Qr.length&&t!==0&&t<Qr[r].priority;r++);Qr.splice(r,0,e),r===0&&K0(e)}};var F0=o.version;if(F0!=="19.2.3")throw Error(a(527,F0,"19.2.3"));H.findDOMNode=function(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(a(188)):(e=Object.keys(e).join(","),Error(a(268,e)));return e=m(t),e=e!==null?y(e):null,e=e===null?null:e.stateNode,e};var Cw={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:V,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var iu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!iu.isDisabled&&iu.supportsFiber)try{Ue=iu.inject(Cw),Xe=iu}catch{}}return ml.createRoot=function(e,t){if(!l(e))throw Error(a(299));var r=!1,i="",f=Zg,g=Jg,N=em;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onUncaughtError!==void 0&&(f=t.onUncaughtError),t.onCaughtError!==void 0&&(g=t.onCaughtError),t.onRecoverableError!==void 0&&(N=t.onRecoverableError)),t=_0(e,1,!1,null,null,r,i,null,f,g,N,W0),e[bt]=t.current,nf(e),new Sf(t)},ml.hydrateRoot=function(e,t,r){if(!l(e))throw Error(a(299));var i=!1,f="",g=Zg,N=Jg,E=em,X=null;return r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(f=r.identifierPrefix),r.onUncaughtError!==void 0&&(g=r.onUncaughtError),r.onCaughtError!==void 0&&(N=r.onCaughtError),r.onRecoverableError!==void 0&&(E=r.onRecoverableError),r.formState!==void 0&&(X=r.formState)),t=_0(e,1,!0,t,r??null,i,f,X,g,N,E,W0),t.context=A0(null),r=t.current,i=go(),i=Oe(i),f=Rr(i),f.callback=null,Dr(r,f,i),r=i,t.current.lanes=r,J(t,r),Wo(t),e[bt]=t.current,nf(e),new lu(t)},ml.version="19.2.3",ml}var ny;function Dw(){if(ny)return Cf.exports;ny=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(o){console.error(o)}}return n(),Cf.exports=Rw(),Cf.exports}var Bw=Dw();const oy=n=>{let o;const s=new Set,a=(m,y)=>{const x=typeof m=="function"?m(o):m;if(!Object.is(x,o)){const v=o;o=y??(typeof x!="object"||x===null)?x:Object.assign({},o,x),s.forEach(k=>k(o,v))}},l=()=>o,h={setState:a,getState:l,getInitialState:()=>p,subscribe:m=>(s.add(m),()=>s.delete(m))},p=o=n(a,l,h);return h},zw=(n=>n?oy(n):oy),Hw=n=>n;function $w(n,o=Hw){const s=ga.useSyncExternalStore(n.subscribe,ga.useCallback(()=>o(n.getState()),[n,o]),ga.useCallback(()=>o(n.getInitialState()),[n,o]));return ga.useDebugValue(s),s}const ry=n=>{const o=zw(n),s=a=>$w(o,a);return Object.assign(s,o),s},vo=(n=>n?ry(n):ry);function Cr(n,o){let s;try{s=n()}catch{return}return{getItem:l=>{var c;const d=p=>p===null?null:JSON.parse(p,void 0),h=(c=s.getItem(l))!=null?c:null;return h instanceof Promise?h.then(d):d(h)},setItem:(l,c)=>s.setItem(l,JSON.stringify(c,void 0)),removeItem:l=>s.removeItem(l)}}const np=n=>o=>{try{const s=n(o);return s instanceof Promise?s:{then(a){return np(a)(s)},catch(a){return this}}}catch(s){return{then(a){return this},catch(a){return np(a)(s)}}}},Kw=(n,o)=>(s,a,l)=>{let c={storage:Cr(()=>localStorage),partialize:S=>S,version:0,merge:(S,j)=>({...j,...S}),...o},d=!1;const h=new Set,p=new Set;let m=c.storage;if(!m)return n((...S)=>{console.warn(`[zustand persist middleware] Unable to update item '${c.name}', the given storage is currently unavailable.`),s(...S)},a,l);const y=()=>{const S=c.partialize({...a()});return m.setItem(c.name,{state:S,version:c.version})},x=l.setState;l.setState=(S,j)=>(x(S,j),y());const v=n((...S)=>(s(...S),y()),a,l);l.getInitialState=()=>v;let k;const w=()=>{var S,j;if(!m)return;d=!1,h.forEach(T=>{var R;return T((R=a())!=null?R:v)});const C=((j=c.onRehydrateStorage)==null?void 0:j.call(c,(S=a())!=null?S:v))||void 0;return np(m.getItem.bind(m))(c.name).then(T=>{if(T)if(typeof T.version=="number"&&T.version!==c.version){if(c.migrate){const R=c.migrate(T.state,T.version);return R instanceof Promise?R.then(D=>[!0,D]):[!0,R]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,T.state];return[!1,void 0]}).then(T=>{var R;const[D,L]=T;if(k=c.merge(L,(R=a())!=null?R:v),s(k,!0),D)return y()}).then(()=>{C?.(k,void 0),k=a(),d=!0,p.forEach(T=>T(k))}).catch(T=>{C?.(void 0,T)})};return l.persist={setOptions:S=>{c={...c,...S},S.storage&&(m=S.storage)},clearStorage:()=>{m?.removeItem(c.name)},getOptions:()=>c,rehydrate:()=>w(),hasHydrated:()=>d,onHydrate:S=>(h.add(S),()=>{h.delete(S)}),onFinishHydration:S=>(p.add(S),()=>{p.delete(S)})},c.skipHydration||w(),k||v},jr=Kw,Eo=vo()(n=>({viewerOpen:!1,viewerImages:[],viewerIndex:0,viewerScale:1,viewerTranslate:{x:0,y:0},setViewerState:o=>{n(s=>{const a={viewerOpen:o.viewerOpen??s.viewerOpen,viewerImages:o.viewerImages??s.viewerImages,viewerIndex:o.viewerIndex??s.viewerIndex,viewerScale:o.viewerScale??s.viewerScale,viewerTranslate:o.viewerTranslate??s.viewerTranslate};return a.viewerOpen===s.viewerOpen&&a.viewerIndex===s.viewerIndex&&a.viewerScale===s.viewerScale&&a.viewerTranslate.x===s.viewerTranslate.x&&a.viewerTranslate.y===s.viewerTranslate.y&&a.viewerImages===s.viewerImages?s:{...s,...a}})}})),gn=vo()(jr(n=>({error:null,nodeErrors:{},errorCycleIndex:0,errorsDismissed:!1,setError:o=>{n({error:o,errorsDismissed:!1})},setNodeErrors:o=>{n({nodeErrors:o,errorCycleIndex:0,errorsDismissed:!1})},clearNodeErrors:()=>{n({error:null,nodeErrors:{},errorCycleIndex:0,errorsDismissed:!1})},clearNodeError:o=>{n(s=>{const a={...s.nodeErrors};return delete a[String(o)],{nodeErrors:a}})},setErrorCycleIndex:o=>{n({errorCycleIndex:o})},setErrorsDismissed:o=>{n({errorsDismissed:o})}}),{name:"workflow-errors-storage",storage:Cr(()=>localStorage),partialize:n=>({error:n.error,nodeErrors:n.nodeErrors,errorCycleIndex:n.errorCycleIndex,errorsDismissed:n.errorsDismissed}),onRehydrateStorage:()=>n=>{if(!n)return;const o=Object.values(n.nodeErrors||{}).reduce((s,a)=>s+a.length,0);o>0&&!n.error&&n.setError(`Workflow load error: ${o} input${o===1?"":"s"} reference missing options.`),o>0&&n.setErrorCycleIndex(0)}})),sn="";function Vw(){const n="comfyui-mobile-client-id";let o=localStorage.getItem(n);return o||(o="mobile-"+Math.random().toString(36).substring(2,15),localStorage.setItem(n,o)),o}const Vb=Vw();async function _p(){const n=await fetch(`${sn}/api/object_info`);if(!n.ok)throw new Error("Failed to fetch node types");return n.json()}async function Uw(){const n=await fetch(`${sn}/api/queue`);if(!n.ok)throw new Error("Failed to fetch queue");return n.json()}async function Ww(n){const o=`${sn}/api/history?max_items=${n}`,s=await fetch(o);if(!s.ok)throw new Error("Failed to fetch history");return s.json()}async function Fw(n){if(n.length===0)return;if(!(await fetch(`${sn}/api/lm/register-nodes`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({nodes:n})})).ok)throw new Error("Failed to register Lora Manager nodes")}async function qw(n,o){if(!o||o.length===0)return;if(!(await fetch(`${sn}/api/lm/loras/get_trigger_words`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({lora_names:n??[],node_ids:o})})).ok)throw new Error("Failed to fetch trigger words")}async function Gw(){const n=await fetch(`${sn}/api/v2/userdata?path=workflows`);if(!n.ok){if(n.status===404)return[];throw new Error("Failed to list user workflows")}return(await n.json()).filter(s=>s.type==="file"&&s.name.endsWith(".json"))}function Ub(n){return encodeURIComponent(n)}async function Ap(n){const o=await fetch(`${sn}/api/userdata/${Ub("workflows/"+n)}`);if(!o.ok)throw new Error("Failed to load workflow");return o.json()}async function Wb(n,o){if(!(await fetch(`${sn}/api/userdata/${Ub("workflows/"+n)}?overwrite=true`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)})).ok)throw new Error("Failed to save workflow")}async function Pw(){const n=await fetch(`${sn}/api/workflow_templates`);if(!n.ok)throw new Error("Failed to fetch templates");return n.json()}async function Rp(n,o){const s=await fetch(`${sn}/api/workflow_templates/${encodeURIComponent(n)}/${encodeURIComponent(o)}`);if(!s.ok)throw new Error("Failed to load template");return s.json()}async function Yw(){await fetch(`${sn}/api/interrupt`,{method:"POST"})}async function Qw(){await fetch(`${sn}/api/queue`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({clear:!0})})}async function Xw(n){await fetch(`${sn}/api/queue`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({delete:[n]})})}async function Fb(n,o){const s=new FormData;s.append("image",n),o?.type&&s.append("type",o.type),o?.subfolder&&s.append("subfolder",o.subfolder),o?.overwrite!==void 0&&s.append("overwrite",o.overwrite?"true":"false");const a=await fetch(`${sn}/upload/image`,{method:"POST",body:s});if(!a.ok)throw new Error("Failed to upload image");return a.json()}async function Zw(n){await fetch(`${sn}/api/history`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({delete:[n]})})}async function sy(n){n.length!==0&&await fetch(`${sn}/api/history`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({delete:n})})}async function Jw(){await fetch(`${sn}/api/history`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({clear:!0})})}function bo(n,o,s){return`${sn}/view?filename=${encodeURIComponent(n)}&subfolder=${encodeURIComponent(o)}&type=${encodeURIComponent(s)}`}function e2(n,o,s,a,l){const d=`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}/ws?clientId=${n}`,h=new WebSocket(d);return h.onopen=()=>{s?.()},h.onmessage=p=>{try{const m=JSON.parse(p.data);o(m)}catch(m){console.error("[WS] Failed to parse message:",m)}},h.onclose=()=>{a?.()},h.onerror=p=>{console.error("[WS] Error:",p),l?.(p)},h}async function op(n="",o=!1,s="output",a){const l=new URLSearchParams;n&&l.set("path",n),o&&l.set("recursive","true"),s&&l.set("source",s),a&&l.set("showHidden","true");const c=await fetch(`${sn}/mobile/api/files?${l}`);if(!c.ok)throw new Error("Failed to fetch files");return c.json()}async function t2(n){const o=await op("",!1,"output",n),s=await op("",!1,"input",n),a=o.files.filter(c=>c.type==="dir").map(c=>c.name);return{input:s.files.filter(c=>c.type==="dir").map(c=>c.name),output:a}}async function rp(n,o=1e3,s=0,a="modified",l=!1,c=null,d){return(await op(c||"",l,n,d)).files.map(p=>{if(p.type==="dir")return{id:`${n}/${p.path}`,name:p.name,type:"folder",date:p.date,size:p.size};const m=p.folder||(p.path.includes("/")?p.path.substring(0,p.path.lastIndexOf("/")):"");return{id:`${n}/${p.path}`,name:p.name,type:p.type,previewUrl:`${sn}/mobile/api/thumbnail?filename=${encodeURIComponent(p.name)}&subfolder=${encodeURIComponent(m)}&source=${n}`,fullUrl:`${sn}/view?filename=${encodeURIComponent(p.name)}&type=${n}&subfolder=${encodeURIComponent(m)}`,date:p.date,size:p.size}})}async function sp(n,o="output"){const s=await fetch(`${sn}/mobile/api/files`,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:n,source:o})});if(!s.ok){const a=await s.json();throw new Error(a.error||"Failed to delete file")}}async function n2(n,o="output",s){const a=new URLSearchParams({path:n,source:o}),l=await fetch(`${sn}/mobile/api/file-metadata?${a.toString()}`,{signal:s?.signal});if(!l.ok){const d=await l.json().catch(()=>({}));throw new Error(d.error||"Failed to load file metadata")}const c=await l.json();if(!c.workflow)throw new Error("No workflow metadata found");return c.workflow}async function o2(n,o="output",s){const a=new URLSearchParams({path:n,source:o}),l=await fetch(`${sn}/mobile/api/workflow-availability?${a.toString()}`,{signal:s?.signal});if(!l.ok){const d=await l.json().catch(()=>({}));throw new Error(d.error||"Failed to load workflow availability")}return!!(await l.json()).available}async function r2(n,o="output"){const s=new URLSearchParams({path:n,source:o}),a=await fetch(`${sn}/mobile/api/image-metadata?${s.toString()}`);if(!a.ok){const l=await a.json().catch(()=>({}));throw new Error(l.error||"Failed to load image metadata")}return a.json()}async function s2(n,o,s="output"){const a=await fetch(`${sn}/mobile/api/files/move`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sources:n,destination:o??"",source:s})});if(!a.ok){const l=await a.json().catch(()=>({}));throw new Error(l.error||"Failed to move files")}}async function ay(n,o="output"){const s=await fetch(`${sn}/mobile/api/files/mkdir`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:n,source:o})});if(!s.ok){const a=await s.json().catch(()=>({}));throw new Error(a.error||"Failed to create folder")}}async function a2(n,o,s="output"){const a=await fetch(`${sn}/mobile/api/files/rename`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:n,newName:o,source:s})});if(!a.ok){const l=await a.json().catch(()=>({}));throw new Error(l.error||"Failed to rename file")}}const Ht=vo()(jr((n,o)=>({running:[],pending:[],isLoading:!1,lastExecutedId:null,queueItemExpanded:{},queueItemUserToggled:{},queueItemHideImages:{},showQueueMetadata:!1,previewVisibility:{},previewVisibilityDefault:!1,fetchQueue:async()=>{const{running:s}=o();n({isLoading:!0});try{const a=await Uw(),l=a.queue_running.map(d=>({number:d[0],prompt_id:d[1],prompt:d[2],extra:d[3],outputs_to_execute:d[4]})),c=a.queue_pending.map(d=>({number:d[0],prompt_id:d[1],prompt:d[2],extra:d[3],outputs_to_execute:d[4]}));s.length>0&&l.length===0&&(n({lastExecutedId:s[0].prompt_id}),setTimeout(()=>n({lastExecutedId:null}),100)),n({running:l,pending:c})}catch(a){console.error("Failed to fetch queue:",a)}finally{n({isLoading:!1})}},clearQueue:async()=>{try{await Qw(),n({pending:[]})}catch(s){console.error("Failed to clear queue:",s)}},deleteItem:async s=>{try{await Xw(s),n(a=>({pending:a.pending.filter(l=>l.prompt_id!==s)}))}catch(a){console.error("Failed to delete queue item:",a)}},interrupt:async()=>{try{await Yw()}catch(s){console.error("Failed to interrupt execution:",s)}},updateFromStatus:s=>{const{pending:a}=o();s!==a.length&&o().fetchQueue()},setQueueItemExpanded:(s,a)=>{n(l=>({queueItemExpanded:{...l.queueItemExpanded,[s]:a}}))},setQueueItemUserToggled:(s,a)=>{n(l=>({queueItemUserToggled:{...l.queueItemUserToggled,[s]:a}}))},setQueueItemHideImages:(s,a)=>{n(l=>({queueItemHideImages:{...l.queueItemHideImages,[s]:a}}))},toggleQueueItemHideImages:s=>{n(a=>({queueItemHideImages:{...a.queueItemHideImages,[s]:!a.queueItemHideImages[s]}}))},setShowQueueMetadata:s=>{n({showQueueMetadata:s})},toggleShowQueueMetadata:()=>{n(s=>({showQueueMetadata:!s.showQueueMetadata}))},setPreviewVisibility:(s,a)=>{n(l=>({previewVisibility:{...l.previewVisibility,[s]:a}}))},togglePreviewVisibility:s=>{n(a=>({previewVisibility:{...a.previewVisibility,[s]:!a.previewVisibility[s]}}))},setPreviewVisibilityDefault:s=>{n({previewVisibilityDefault:s})}}),{name:"queue-storage",storage:Cr(()=>localStorage),partialize:n=>({queueItemExpanded:n.queueItemExpanded,queueItemUserToggled:n.queueItemUserToggled,queueItemHideImages:n.queueItemHideImages,showQueueMetadata:n.showQueueMetadata,previewVisibility:n.previewVisibility,previewVisibilityDefault:n.previewVisibilityDefault})})),ao=vo()(jr(n=>({currentPanel:"workflow",setCurrentPanel:o=>{n({currentPanel:o})}}),{name:"navigation-storage",storage:Cr(()=>localStorage),partialize:n=>({currentPanel:n.currentPanel})})),yo=vo()(jr((n,o)=>({pinnedWidgets:{},pinnedWidget:null,pinOverlayOpen:!1,setPinnedWidget:(s,a)=>{const{pinnedWidgets:l}=o();if(a&&s)n({pinnedWidget:s,pinnedWidgets:{...l,[a]:s}});else if(a&&!s){const c={...l};delete c[a],n({pinnedWidget:null,pinnedWidgets:c})}else n({pinnedWidget:s})},setPinOverlayOpen:s=>{n({pinOverlayOpen:s})},togglePinOverlay:()=>{n(s=>({pinOverlayOpen:!s.pinOverlayOpen}))},clearPinnedWidgetForKey:s=>{if(!s){n({pinnedWidget:null,pinOverlayOpen:!1});return}n(a=>{const l={...a.pinnedWidgets};return delete l[s],{pinnedWidgets:l,pinnedWidget:null,pinOverlayOpen:!1}})},restorePinnedWidgetForWorkflow:(s,a)=>{if(!s){n({pinnedWidget:null,pinOverlayOpen:!1});return}const l=o().pinnedWidgets[s];if(!l){n({pinnedWidget:null,pinOverlayOpen:!1});return}const c=a.nodes.some(d=>d.id===l.nodeId);n({pinnedWidget:c?l:null,pinOverlayOpen:!1})},clearCurrentPin:()=>{n({pinnedWidget:null,pinOverlayOpen:!1})}}),{name:"pinned-widget-storage",storage:Cr(()=>localStorage),partialize:n=>({pinnedWidgets:n.pinnedWidgets,pinnedWidget:n.pinnedWidget,pinOverlayOpen:n.pinOverlayOpen})})),l2=new Set(["Lora Loader (LoraManager)"]),i2=new Set(["Lora Stacker (LoraManager)","Lora Randomizer (LoraManager)","Lora Cycler (LoraManager)"]),u2=new Set(["Lora Stacker (LoraManager)","Lora Randomizer (LoraManager)","Lora Cycler (LoraManager)","WanVideo Lora Select (LoraManager)"]),c2=new Set(["Lora Cycler (LoraManager)"]),qb=Number.EPSILON,Gb=n=>!!n&&typeof n=="object"&&!Array.isArray(n),zu=/<lora:([^:>]+):([-\d.]+)(?::([-\d.]+))?>/g;function vr(n){return Hu(n)||Dp(n)}function Hu(n){if(l2.has(n))return!0;const o=n.toLowerCase();return o.includes("(loramanager)")&&o.includes("lora loader")}function Tu(n){if(i2.has(n))return!0;const o=n.toLowerCase();return o.includes("(loramanager)")&&(o.includes("lora stacker")||o.includes("lora randomizer")||o.includes("lora cycler"))}function Dp(n){if(u2.has(n))return!0;const o=n.toLowerCase();return o.includes("(loramanager)")&&(o.includes("lora stacker")||o.includes("lora randomizer")||o.includes("lora cycler")||o.includes("wanvideo lora select"))}function d2(n){if(c2.has(n))return!0;const o=n.toLowerCase();return o.includes("(loramanager)")&&o.includes("lora cycler")}function $u(n){return Array.isArray(n)?n.length===0?!0:n.every(o=>Gb(o)&&typeof o.name=="string"&&"strength"in o):!1}function Ku(n){return $u(n)?n:Gb(n)&&$u(n.__value__)?n.__value__:null}function Ns(n,o){if(!Array.isArray(n.widgets_values))return null;const s=n.widgets_values;for(let l=0;l<s.length;l+=1){const c=s[l];if($u(c)&&c.length>0)return l}if(o!=null){const l=o+1;if(l>=0&&l<s.length){const c=s[l];if(Array.isArray(c))return l}else if(l===s.length)return l}const a=s.findIndex(l=>Array.isArray(l)&&l.length===0);return a>=0?a:null}function ly(n,o){return typeof n=="number"&&Number.isFinite(n)?n:typeof n=="string"&&n.trim()!==""&&!Number.isNaN(Number(n))?Number(n):o}function Vu(n){const o=ly(n.strength,1),s=ly(n.clipStrength??o,o),a=n.active!==void 0?!!n.active:!0,l=n.expanded!==void 0?!!n.expanded:Math.abs(s-o)>qb;return{...n,strength:o,clipStrength:s,active:a,expanded:l}}function Pb(n){const o=Array.isArray(n)&&n.length>0?String(n[0]):"";return Vu({name:o,strength:1,clipStrength:1,active:!!o,expanded:!1})}function ap(n,o){const s={};let a;for(zu.lastIndex=0;(a=zu.exec(n))!==null;){const d=a[1],h=Number(a[2]),p=a[3]?Number(a[3]):h;s[d]={strength:h,clipStrength:p}}const l=[],c=new Set;for(const d of o){if(!d||!s[d.name])continue;const h=s[d.name];l.push({...d,strength:d.strength!==void 0?d.strength:h.strength,clipStrength:d.clipStrength!==void 0?d.clipStrength:h.clipStrength,active:d.active!==void 0?d.active:!0,expanded:d.expanded!==void 0?d.expanded:!1}),c.add(d.name)}for(const d of Object.keys(s)){if(c.has(d))continue;const h=s[d];l.push({name:d,strength:h.strength,clipStrength:h.clipStrength,active:!0})}return l}function uu(n){const o=Number(n);return Number.isFinite(o)?o.toFixed(2):1 .toFixed(2)}function iy(n,o){const s=n?.clipStrength,a=n?.strength;if(s==null)return!!o;const l=Number(s),c=Number(a);return!Number.isFinite(l)||!Number.isFinite(c)?!!o:Math.abs(l-c)>qb?!0:!!(n?.expanded||o)}function f2(n){if(!n)return"";let o=n.replace(/\s+/g," ").replace(/,\s*,+/g,",").replace(/\s*,\s*/g,",").trim();return o===","?"":(o=o.replace(/(^,)|(,$)/g,""),o=o.replace(/,\s*/g,", "),o.trim())}function Yb(n,o){const s=typeof n=="string"?n:"",a=Array.isArray(o)?o:[],l=new Map;a.forEach(y=>{!y||!y.name||l.set(y.name,y)}),zu.lastIndex=0;const c=new Set,d=s.replace(zu,(y,x,v,k)=>{const w=l.get(x);if(!w)return"";c.add(x);const S=uu(w.strength??v),j=uu(w.clipStrength??w.strength??k);return iy(w,k)?`<lora:${x}:${S}:${j}>`:`<lora:${x}:${S}>`}),h=f2(d);if(l.size===c.size)return h;const p=[];return l.forEach((y,x)=>{if(c.has(x))return;const v=uu(y.strength),k=uu(y.clipStrength??y.strength),S=iy(y,null)?`<lora:${x}:${v}:${k}>`:`<lora:${x}:${v}>`;p.push(S)}),p.length===0?h:`${h}${h?" ":""}${p.join(" ")}`.trim()}const p2=new Set(["TriggerWord Toggle (LoraManager)"]),ks=n=>!!n&&typeof n=="object"&&!Array.isArray(n);function Cs(n){if(p2.has(n))return!0;const o=n.toLowerCase();return o.includes("triggerword")&&o.includes("(loramanager)")}function h2(n){return!(!ks(n)||typeof n.text!="string"||"active"in n&&typeof n.active!="boolean")}function g2(n){return ks(n)&&typeof n.text=="string"}function Uu(n,o=!0){return Array.isArray(n)?n.length===0?!0:n.every(s=>o?h2(s):g2(s)):!1}function Hl(n){return Uu(n,!0)?n:ks(n)&&Uu(n.__value__,!0)?n.__value__:null}function $l(n){return Uu(n,!1)?n:ks(n)&&Uu(n.__value__,!1)?n.__value__:null}function ac(n){if(!Array.isArray(n.widgets_values))return null;const o=n.widgets_values;let s=null;const a=[];for(let d=0;d<o.length;d+=1){const h=o[d],p=Hl(h);if(p&&p.length>0)return d;const m=$l(h);if(m&&m.length>0){const x=m.length;(!s||x>s.score)&&(s={index:d,score:x})}const y=Array.isArray(h)?h:ks(h)&&Array.isArray(h.__value__)?h.__value__:null;y&&y.length===0&&a.push(d)}if(s)return s.index;if(a.length===0)return null;const l=d=>typeof d=="string"?d:ks(d)&&typeof d.__value__=="string"?d.__value__:null,c=a.find(d=>{const h=o[d-1],p=o[d+1];return l(h)!==null||l(p)!==null});return c!==void 0?c:a[0]}function Bp(n,o){if(!Array.isArray(n.widgets_values))return null;const s=n.widgets_values,a=o!=null?Math.min(o+1,s.length):0;for(let l=a;l<s.length;l+=1)if(typeof s[l]=="string")return l;for(let l=0;l<a;l+=1)if(typeof s[l]=="string")return l;return null}function zp(n){return typeof n=="string"?n:ks(n)&&typeof n.__value__=="string"?n.__value__:null}function Qb(n){if(n==null)return null;const o=Number(n);return Number.isFinite(o)?o:null}function Eu(n,o){const s=typeof n.text=="string"?n.text:"",a=typeof n.active=="boolean"?n.active:o?.defaultActive??!0,c=!!o?.allowStrengthAdjustment?Qb(n.strength):null,d=typeof n.highlighted=="boolean"?n.highlighted:void 0;return{...n,text:s,active:a,strength:c,highlighted:d}}function lp(n,o){const s=Array.isArray(o.existingList)?o.existingList:[],a={};s.forEach(h=>{!h||typeof h.text!="string"||!h.text||(a[h.text]||(a[h.text]=[]),a[h.text].push({active:typeof h.active=="boolean"?h.active:o.defaultActive,strength:o.allowStrengthAdjustment?Qb(h.strength):null}))});const l=h=>{const p=a[h];return p&&p.length>0?p.shift()??null:null},c=typeof n=="string"?n.trim():"";if(!c)return[];let d=[];return o.groupMode?/,{2,}/.test(c)?d=c.split(/,{2,}/):d=[c]:d=c.split(","),d.map(h=>h.trim()).filter(h=>h.length>0).map(h=>{const p=l(h);return{text:h,active:p?p.active:o.defaultActive,strength:o.allowStrengthAdjustment?p?.strength??null:null}})}const ip={d:n=>n.getDate(),M:n=>n.getMonth()+1,h:n=>n.getHours(),m:n=>n.getMinutes(),s:n=>n.getSeconds()},m2=Object.keys(ip).map(n=>`${n}${n}?`).join("|")+"|yyy?y?",y2=/[/?<>\\:*|"\x00-\x1F\x7F]/g;function Xb(n){return!!n&&typeof n=="object"&&!Array.isArray(n)}function b2(n,o){return n.replace(new RegExp(m2,"g"),s=>s==="yy"?`${o.getFullYear()}`.substring(2):s==="yyyy"?o.getFullYear().toString():s[0]in ip?`${ip[s[0]](o)}`.padStart(s.length,"0"):s)}function x2(n){const o=(n.definitions?.subgraphs??[]).flatMap(s=>s.nodes??[]);return[...n.nodes,...o]}function v2(n,o,s){const l=lc(n,o.id)?.[s];return l!==void 0?es(o,s,l):es(o,s,void 0)}function w2(n,o){const s=x2(n);return o.replace(/%([^%]+)%/g,(a,l)=>{const c=l.split(".");if(c.length!==2)return c[0]?.startsWith("date:")?b2(c[0].substring(5),new Date):(l!=="width"&&l!=="height"&&console.warn("[workflowInputs] Invalid replacement pattern",l),a);let d=s.filter(m=>m.properties?.["Node name for S&R"]===c[0]);if(d.length||(d=s.filter(m=>m.title===c[0])),!d.length)return console.warn("[workflowInputs] Unable to find node",c[0]),a;d.length>1&&console.warn("[workflowInputs] Multiple nodes matched",c[0],"using first match");const h=d[0],p=v2(n,h,c[1]);return p===void 0?(console.warn("[workflowInputs] Unable to find widget",c[1],"on node",c[0],h),a):`${p??""}`.replace(y2,"_")})}function cu(n,o,s){return o==="filename_prefix"&&typeof s=="string"?w2(n,s):s}function S2(n){if(!(!String(n.type||"").startsWith("Primitive")&&n.type!=="PrimitiveNode")){if(Array.isArray(n.widgets_values))return n.widgets_values[0];if(Xb(n.widgets_values)){const s=n.widgets_values.value;return s!==void 0?s:n.widgets_values[0]}}}function es(n,o,s){const a=n.widgets_values;if(Array.isArray(a))return s===void 0||s<0||s>=a.length?void 0:a[s];if(Xb(a)){if(a[o]!==void 0)return a[o];if(n.type==="VHS_VideoCombine"&&o==="save_image"&&a.save_output!==void 0)return a.save_output}}function lc(n,o){const s=n.widget_idx_map?.[String(o)];return s||(n.extra?.widget_idx_map?.[String(o)]??null)}function ic(n){if(Array.isArray(n)){const s=n.map(a=>String(a)).join(",").toUpperCase();return s.includes("AUTOCOMPLETE_TEXT_PROMPT")||s.includes("AUTOCOMPLETE_TEXT_LORAS"),!0}const o=String(n).toUpperCase();return o==="INT"||o==="FLOAT"||o==="BOOLEAN"||o==="STRING"||o.includes("AUTOCOMPLETE_TEXT_LORAS")||o.includes("AUTOCOMPLETE_TEXT_PROMPT")}function Hp(n,o,s){if(Array.isArray(o)){if(s?.comboIndexToValue&&typeof n=="number"&&Number.isFinite(n)){const a=Math.trunc(n);return o[a]??n}return n}if(o==="INT"&&typeof n=="string"&&n.trim()!==""&&!Number.isNaN(Number(n)))return Math.trunc(Number(n));if(o==="FLOAT"&&typeof n=="string"&&n.trim()!==""&&!Number.isNaN(Number(n)))return Number(n);if(o==="BOOLEAN"&&typeof n=="string"){if(n.toLowerCase()==="true")return!0;if(n.toLowerCase()==="false")return!1}return n}function N2(n,o,s){if(o.length===0)return n;const a=Kl(n,o);return a!==void 0?a:s!==void 0&&o.some(l=>String(l)===String(s))?s:o[0]}const uy=".safetensors";function cy(n){return n.toLowerCase().endsWith(uy)?n.slice(0,n.length-uy.length):n}function dy(n){return n.split(/[\\/]/).pop()??n}function Kl(n,o){if(!Array.isArray(o)||o.length===0)return;const s=Hp(n,o,{comboIndexToValue:!0}),a=String(s),l=dy(a),c=o.find(y=>String(y)===a);if(c!==void 0)return c;const d=o.find(y=>String(y)===l);if(d!==void 0)return d;const p=cy(l).toLowerCase();return o.find(y=>{const x=String(y),v=dy(x);return cy(v).toLowerCase()===p})}function $p(n,o){const s=n.links.find(d=>d[0]===o);if(!s)return null;const a=s[1],l=s[2],c=n.nodes.find(d=>d.id===a);if(!c)return null;if(c.mode===4||c.type==="Reroute"){const d=c.outputs[l];if(!d)return null;const h=c.inputs.find(p=>{if(p.link===null)return!1;const m=String(p.type).toUpperCase(),y=String(d.type).toUpperCase();return m===y||m==="*"||y==="*"});return h?.link!=null?$p(n,h.link):null}return{nodeId:a,slotIndex:l}}function k2(n,o,s,a,l,c,d){const h={};for(const w of s.inputs)if(w.link!=null){const S=$p(n,w.link);if(S)if(l.has(S.nodeId))h[w.name]=[String(S.nodeId),S.slotIndex];else{const j=n.nodes.find(C=>C.id===S.nodeId);if(j){const C=S2(j);C!==void 0?h[w.name]=C:console.warn(`[workflowInputs] Missing source node for input '${w.name}' on node ${s.id} (${s.type}).`,{sourceNodeId:S.nodeId,sourceNodeType:j.type,sourceAllowed:!1})}}}const p=o[a];if(!p?.input)return h;const m=p.input_order?.required||Object.keys(p.input.required||{}),y=p.input_order?.optional||Object.keys(p.input.optional||{}),x=[...m,...y];let v=0;const k=Array.isArray(s.widgets_values)?s.widgets_values:null;for(const w of x)try{const S=p.input.required?.[w]||p.input.optional?.[w];if(!S)continue;const[j]=S,C=s.inputs.find(te=>te.name===w),T=C?.link!=null,R=!!C?.widget&&!T,D=!!C,L=S[1]?.default,B=Object.prototype.hasOwnProperty.call(S[1]??{},"default");if(ic(j)||R||!D){let te=c?.[w];if(te===void 0&&(te=v),w==="seed"&&d?.[s.id]!==void 0&&!(w in h))h[w]=d[s.id];else if(te!==void 0&&!T&&!(w in h)){const ee=es(s,w,te);ee!==void 0&&(Array.isArray(j)?h[w]=cu(n,w,N2(ee,j,L)):h[w]=cu(n,w,Hp(ee,j)))}else!T&&B&&!(w in h)&&(h[w]=L);te!==void 0&&(v=Math.max(v,te+1)),String(j)==="INT"&&(w==="seed"||w==="noise_seed")&&(te!==void 0?v=Math.max(v,te+2):v=Math.max(v,v+1))}}catch(S){console.error(`Error processing input '${w}' for node ${s.id} (${s.type}):`,S)}if(c)for(const[w,S]of Object.entries(c)){if(!(w in h)&&k&&S<k.length){const j=k[S];j!=null&&(h[w]=cu(n,w,j))}if(!(w in h)&&!k){const j=es(s,w,S);j!=null&&(h[w]=cu(n,w,j))}}return(a==="Power Lora Loader (rgthree)"||s.type==="Power Lora Loader (rgthree)")&&k&&k.forEach((w,S)=>{if(typeof w=="object"&&w!==null&&"lora"in w&&!(Object.values(c||{}).some(C=>C===S)||c===null&&S<v)){const C=`lora_${S}`;C in h||(h[C]=w)}}),d?.[s.id]!==void 0&&!("seed"in h)&&!("noise_seed"in h)&&(h.seed=d[s.id]),C2(s,h,k,c),j2(s,h,k,c),h}function C2(n,o,s,a){if("loras"in o)return;const l=a?.loras,c=l!==void 0?l:Ns(n);if(c===null)return;const d=s?.[c],h=Ku(d);h&&(o.loras=h)}function j2(n,o,s,a){if(!Cs(n.type))return;const l=a?.toggle_trigger_words,c=l!==void 0?l:ac(n);if(c===null)return;if(!("toggle_trigger_words"in o)){const x=s?.[c],v=Hl(x)??$l(x);v&&(o.toggle_trigger_words=v)}const d=a?.originalMessage??a?.orinalMessage,h=d!==void 0?d:Bp(n,c);if(h===null)return;const p=s?.[h],m=zp(p);if(m===null)return;const y=a&&"originalMessage"in a?"originalMessage":(a&&"orinalMessage"in a,"orinalMessage");y in o||(o[y]=m)}const Kp=-1,uc=-2,cc=-3,du=0x4000000000000,Wu=new Set([Kp,uc,cc]);function Vp(n){return Wu.has(n)}function Zb(n){return n===Kp?"randomize":n===uc?"increment":n===cc?"decrement":null}function M2(n){return n==="randomize"?Kp:n==="increment"?uc:n==="decrement"?cc:null}function Vn(n,o,s,a){if(!o)return null;const c=lc(n,s.id)?.[a];if(c!==void 0)return c;const d=o[s.type];if(!d?.input)return null;const h=d.input_order?.required||Object.keys(d.input.required||{}),p=d.input_order?.optional||Object.keys(d.input.optional||{}),m=[...h,...p];let y=0;for(const x of m){const v=d.input.required?.[x]||d.input.optional?.[x];if(!v)continue;const[k]=v,w=s.inputs.find(D=>D.name===x),S=w?.link!=null,j=!!w?.widget&&!S,C=!!w;if(ic(k)||j||!C){if(x===a)return y;y+=1,String(k)==="INT"&&(x==="seed"||x==="noise_seed")&&(y+=1)}}return null}function ba(n,o,s){const a=Vn(n,o,s,"seed")??Vn(n,o,s,"noise_seed");if(a!==null)return a;if(!o)return s.outputs?.some(x=>String(x.name||"").toLowerCase().includes("seed")&&String(x.type||"").toUpperCase().includes("INT"))&&Array.isArray(s.widgets_values)&&s.widgets_values.length>0?0:null;const l=o[s.type];if(!l?.input)return s.outputs?.some(x=>String(x.name||"").toLowerCase().includes("seed")&&String(x.type||"").toUpperCase().includes("INT"))&&Array.isArray(s.widgets_values)&&s.widgets_values.length>0?0:null;const c=lc(n,s.id),d=l.input_order?.required||Object.keys(l.input.required||{}),h=l.input_order?.optional||Object.keys(l.input.optional||{}),p=[...d,...h];let m=0;for(const y of p){const x=l.input.required?.[y]||l.input.optional?.[y];if(!x)continue;const[v]=x,k=s.inputs.find(T=>T.name===y),w=k?.link!=null,S=!!k?.widget&&!w,j=!!k;if(ic(v)||S||!j){const R=c?.[y]??m;if(String(v)==="INT"&&y.toLowerCase().includes("seed"))return R;m+=1,String(v)==="INT"&&(y==="seed"||y==="noise_seed")&&(m+=1)}}return null}function O2(n,o){const s=n[o.type];if(!s?.input)return 1;const l=(s.input.required?.seed||s.input.optional?.seed)?.[1],c=typeof l?.step=="number"?l.step:1;return c>0?c:1}function T2(n){const o=Number(n.properties?.randomMin??0),s=Number(n.properties?.randomMax??du),a=Number.isFinite(o)?Math.max(-du,o):0,l=Number.isFinite(s)?Math.min(du,s):du;return a<=l?{min:a,max:l}:{min:l,max:a}}function Ol(n,o){const s=O2(n,o),{min:a,max:l}=T2(o),c=s>0?s/10:1,d=l-a;let h=a+Math.random()*d;return c>0&&(h=Math.round((h-a)/c)*c+a),h>l&&(h=l),h<a&&(h=a),Wu.has(h)&&(h=0),h}function E2(n,o,s,a){if(Wu.has(n)){if(typeof o=="number"&&!Wu.has(o)){if(n===uc)return o+1;if(n===cc)return o-1}return Ol(s,a)}return Number.isFinite(n)?n:0}const Qn=vo()(jr((n,o)=>({seedModes:{},seedLastValues:{},setSeedMode:(s,a,l)=>{const{seedModes:c,seedLastValues:d}=o();if(l?.workflow&&l.nodeTypes){const{workflow:h,nodeTypes:p,updateNodeWidgets:m}=l,y=h.nodes.find(x=>x.id===s);if(y){const x=ba(h,p,y);if(x!==null&&Array.isArray(y.widgets_values)){const v=x+1,k=typeof y.widgets_values[v]=="string",w={};if(k)w[v]=a;else{const S=M2(a);if(S!==null&&a!=="fixed")w[x]=S;else if(a==="fixed"){const j=Number(y.widgets_values[x]);if(Vp(j)){const C=d[s],T=typeof C=="number"?C:Ol(p,y);w[x]=T}}}Object.keys(w).length>0&&m(s,w)}}}n({seedModes:{...c,[s]:a}})},setSeedModes:s=>{n({seedModes:s})},setSeedLastValues:s=>{n({seedLastValues:s})},clearSeedState:()=>{n({seedModes:{},seedLastValues:{}})}}),{name:"seed-storage",storage:Cr(()=>localStorage),partialize:n=>({seedModes:n.seedModes,seedLastValues:n.seedLastValues})}));function Jb(n,o){return n&&n[o]||null}function ex(n){if(!n)return[];const o=Jb(n,"LoraLoader");if(o?.input?.required?.lora_name){const[s]=o.input.required.lora_name;if(Array.isArray(s))return s}return[]}function fy(n,o){if(!Array.isArray(n.widgets_values))return[];const s=Ns(n);if(s===null)return[];const a=n.widgets_values[s];if(!$u(a))return[];const l=ex(o),c=[],d=a;return d.length>0&&c.push({name:"Loras",type:"LM_LORA_HEADER",options:void 0,value:d.every(h=>h?.active!==!1),widgetIndex:s,isCombo:!1,connected:!1,inputIndex:-1}),d.forEach((h,p)=>{c.push({name:h?.name||"Lora",type:"LM_LORA",options:{entryIndex:p,choices:l.length>0?l:void 0},value:h,widgetIndex:s,isCombo:!1,connected:!1,inputIndex:-1})}),c.push({name:"Add Lora",type:"LM_LORA_ADD",options:{choices:l.length>0?l:void 0},value:null,widgetIndex:s,isCombo:!1,connected:!1,inputIndex:-1}),c}function py(n,o,s){if(!Array.isArray(n.widgets_values))return[];const a=s??ac(n);if(a===null)return[];if(a<0||a>=n.widgets_values.length)return[];const l=n.widgets_values[a],c=Hl(l)??$l(l);return!Array.isArray(c)||c.length===0?[]:c.map((d,h)=>({name:d?.text||"Trigger Word",type:"TW_WORD",options:{entryIndex:h,allowStrengthAdjustment:o},value:d,widgetIndex:a,isCombo:!1,connected:!1,inputIndex:-1}))}function tx(n,o){try{if(o.type==="PrimitiveNode"){const p=o.outputs?.[0]?.type;if(!p)return[];const m=String(p).toUpperCase(),y=Array.isArray(o.widgets_values)?o.widgets_values[0]:void 0;return[{name:o.outputs?.[0]?.name||"value",type:m,options:void 0,value:y,widgetIndex:0,isCombo:!1,connected:!1,inputIndex:-1}]}if(o.type==="Power Lora Loader (rgthree)"){const p=[],m=o.properties?.["Show Strengths"]==="Separate Model & Clip",y=ex(n);if(Array.isArray(o.widgets_values)){const x=o.widgets_values,v=[];x.forEach((k,w)=>{typeof k=="object"&&k!==null&&"lora"in k&&"strength"in k&&v.push(w)}),v.length>0&&(p.push({name:"Loras",type:"POWER_LORA_HEADER",options:{loraIndices:v},value:null,widgetIndex:-1,isCombo:!1,connected:!1,inputIndex:-1}),v.forEach(k=>{const w=x[k];p.push({name:"Lora",type:"POWER_LORA",options:{choices:y.length>0?y:void 0,showSeparate:m},value:w,widgetIndex:k,isCombo:!1,connected:!1,inputIndex:-1})})),p.push({name:"Add Lora",type:"POWER_LORA_ADD",options:void 0,value:null,widgetIndex:o.widgets_values.length,isCombo:!1,connected:!1,inputIndex:-1})}return p}const s=Jb(n,o.type);if(!s?.input){const p=vr(o.type)?fy(o,n):[];if(p.length>0)return p;const m=Cs(o.type)?py(o,!1):[];return m.length>0?m:o.outputs?.some(x=>String(x.name||"").toLowerCase().includes("seed")&&String(x.type||"").toUpperCase().includes("INT"))&&Array.isArray(o.widgets_values)&&o.widgets_values.length>0?[{name:"seed",type:"INT",options:void 0,value:o.widgets_values[0],widgetIndex:0,isCombo:!1,connected:!1,inputIndex:-1}]:[]}const a=s.input_order?.required||Object.keys(s.input.required||{}),l=s.input_order?.optional||Object.keys(s.input.optional||{}),c=[];let d=0;const h=(p,m)=>{if(!m)return;const[y,x]=m,k=(Array.isArray(y)?y.map(ne=>String(ne)).join(","):String(y)).toUpperCase(),w=String(y),S=k.includes("AUTOCOMPLETE_TEXT_LORAS"),j=k.includes("AUTOCOMPLETE_TEXT_PROMPT"),C=vr(o.type)&&p==="text",T=S||j||C,R=o.inputs.findIndex(ne=>ne.name===p),D=R>=0?o.inputs[R]:void 0,L=D?.link!=null,B=!!D?.widget&&!L,A=!!D,F=Object.prototype.hasOwnProperty.call(x??{},"default"),te=ic(y)||B||!A||F,ee=Array.isArray(y)&&!T,ae=ee?{...x??{},options:y}:{...x??{}};if(T&&(ae.multiline=!0),te){const ne=es(o,p,d);c.push({name:p,type:ee?"COMBO":T?"STRING":w,options:ae,value:ne,widgetIndex:d,isCombo:ee,connected:!!L,inputIndex:R})}te&&(d+=1,String(y)==="INT"&&(p==="seed"||p==="noise_seed")&&(d+=1))};for(const p of a){const m=s.input.required?.[p];m&&h(p,m)}for(const p of l){const m=s.input.optional?.[p];m&&h(p,m)}if(vr(o.type)&&c.push(...fy(o,n)),Cs(o.type)){const p=c.find(y=>y.name==="allow_strength_adjustment")?.value,m=c.find(y=>y.name==="toggle_trigger_words")?.widgetIndex;c.push(...py(o,!!p,m??null))}return c}catch(s){return console.error(`Error collecting widget definitions for node ${o.id} (${o.type}):`,s),[]}}function Up(n,o){return tx(n,o).filter(s=>!s.isCombo).map(s=>({name:s.name,type:s.type,options:s.options,value:s.value,widgetIndex:s.widgetIndex,connected:s.connected,inputIndex:s.inputIndex}))}function Wp(n,o){return tx(n,o).filter(s=>s.isCombo).map(s=>({name:s.name,type:s.type,value:s.value,options:s.options,widgetIndex:s.widgetIndex,connected:s.connected,inputIndex:s.inputIndex}))}function I2(n){let o=5381;for(let s=0;s<n.length;s+=1)o=(o<<5)+o+n.charCodeAt(s),o&=4294967295;return(o>>>0).toString(16).padStart(8,"0")}function L2(n,o){if(!n)return!1;const s=Up(n,o).filter(l=>!l.connected),a=Wp(n,o).filter(l=>!l.connected);return s.length===0&&a.length===0}function _2(n){const o=n.nodes??[],s=n.definitions?.subgraphs?.flatMap(a=>a.nodes??[])??[];return[...o,...s]}function Tf(n,o){const l=_2(n).filter(c=>!L2(o,c)).map(c=>c.type).sort().join("|");return`wf_${I2(l)}`}const hy="__mobile_origin",fu="__mobile_subgraph_group_map";function Ef(n,o,s){const a={...n.properties??{}};return s&&a[hy]===void 0&&(a[hy]=s),{...n,id:o,inputs:(n.inputs??[]).map(l=>({...l,link:null})),outputs:(n.outputs??[]).map(l=>({...l,links:[]})),widgets_values:n.widgets_values??[],flags:n.flags??{},properties:a,mode:n.mode??0,order:n.order??0}}function A2(n,o){if(!o||o.length===0)return null;const s=[...o].sort((m,y)=>m.id-y.id),[a,l]=n.pos,[c,d]=n.size,h=a+c/2,p=l+d/2;for(const m of s){const[y,x,v,k]=m.bounding;if(h>=y&&h<=y+v&&p>=x&&p<=x+k)return m.id}return null}function gy(n,o){const s=new Map,a=new Map;return o.forEach((l,c)=>{l?.name&&a.set(l.name,c)}),n.forEach((l,c)=>{const d=l?.name;if(d&&a.has(d)){s.set(c,a.get(d));return}c<o.length&&s.set(c,c)}),s}function R2(n,o){const s=new Map;for(const a of n)a.inputs=(a.inputs??[]).map(l=>({...l,link:null})),a.outputs=(a.outputs??[]).map(l=>({...l,links:[]})),s.set(a.id,a);for(const a of o){const[l,c,d,h,p]=a,m=s.get(c),y=s.get(h),x=m?.outputs?.[d],v=y?.inputs?.[p];x&&(x.links||(x.links=[]),x.links.push(l)),v&&(v.link=l)}return n}function D2(n,o){const s=n.nodes.filter(w=>o.has(w.type));if(s.length===0)return{workflow:n,changed:!1};const a=new Set(s.map(w=>w.id));let l=Math.max(0,...n.nodes.map(w=>w.id))+1;const c=[],d=n.groups??[],h=n.extra??{},p=typeof h[fu]=="object"&&h[fu]!==null?h[fu]:{},m={};for(const[w,S]of Object.entries(p))(typeof S=="number"||S===null)&&(m[w]=S);const y=new Map;for(const w of n.nodes){if(!a.has(w.id)){c.push(Ef(w,w.id,{scope:"root",nodeId:w.id}));continue}const S=o.get(w.type);if(!S){c.push(Ef(w,w.id,{scope:"root",nodeId:w.id}));continue}const j=A2(w,d);m[S.id]=j??null;const C=gy(w.inputs??[],S.inputs??[]),T=gy(w.outputs??[],S.outputs??[]),R=new Map,D=new Map,L=new Map,B=[];for(const A of S.nodes??[]){const F=l++;R.set(A.id,F),c.push(Ef(A,F,{scope:"subgraph",subgraphId:S.id,nodeId:A.id}))}for(const A of S.links??[]){const F=A.origin_id,te=A.target_id;if(F===-10){const ne=R.get(te);if(ne!==void 0){const me=D.get(A.origin_slot)??[];me.push({origin_id:-10,origin_slot:A.origin_slot,target_id:ne,target_slot:A.target_slot,type:A.type}),D.set(A.origin_slot,me)}continue}if(te===-20){const ne=R.get(F);if(ne!==void 0){const me=L.get(A.target_slot)??[];me.push({origin_id:ne,origin_slot:A.origin_slot,target_id:-20,target_slot:A.target_slot,type:A.type}),L.set(A.target_slot,me)}continue}const ee=R.get(F),ae=R.get(te);ee!==void 0&&ae!==void 0&&B.push({origin_id:ee,origin_slot:A.origin_slot,target_id:ae,target_slot:A.target_slot,type:A.type})}y.set(w.id,{inputSlotMap:C,outputSlotMap:T,inputTargets:D,outputSources:L,internalLinks:B})}const x=[],v=n.links??[];for(const w of v){const[,S,j,C,T,R]=w,D=a.has(S),L=a.has(C);if(!D&&!L){x.push({origin_id:S,origin_slot:j,target_id:C,target_slot:T,type:R});continue}if(D&&L){const B=y.get(S),A=y.get(C),F=B?.outputSlotMap.get(j),te=A?.inputSlotMap.get(T);if(F===void 0||te===void 0)continue;const ee=B?.outputSources.get(F)??[],ae=A?.inputTargets.get(te)??[];for(const ne of ee)for(const me of ae)x.push({origin_id:ne.origin_id,origin_slot:ne.origin_slot,target_id:me.target_id,target_slot:me.target_slot,type:ne.type});continue}if(D){const B=y.get(S),A=B?.outputSlotMap.get(j);if(A===void 0)continue;const F=B?.outputSources.get(A)??[];for(const te of F)x.push({origin_id:te.origin_id,origin_slot:te.origin_slot,target_id:C,target_slot:T,type:te.type});continue}if(L){const B=y.get(C),A=B?.inputSlotMap.get(T);if(A===void 0)continue;const F=B?.inputTargets.get(A)??[];for(const te of F)x.push({origin_id:S,origin_slot:j,target_id:te.target_id,target_slot:te.target_slot,type:te.type})}}for(const w of y.values())x.push(...w.internalLinks);const k=x.map((w,S)=>[S+1,w.origin_id,w.origin_slot,w.target_id,w.target_slot,w.type]);return R2(c,k),{workflow:{...n,extra:{...h,[fu]:m},nodes:c,links:k,last_node_id:Math.max(0,...c.map(w=>w.id)),last_link_id:k.length},changed:!0}}function B2(n){const o=n.definitions?.subgraphs??[];if(o.length===0)return n;const s=new Map;for(const l of o)l?.id&&s.set(l.id,l);let a=n;for(let l=0;l<o.length+4;l+=1){const{workflow:c,changed:d}=D2(a,s);if(!d)break;a=c}return a}function z2(n){const o=new Map,s=new Map,a=new Map;for(const l of n.nodes)o.set(l.id,l),s.set(l.id,[]),a.set(l.id,[]);for(const l of n.links){const[,c,,d]=l,h=s.get(d);h&&!h.includes(c)&&h.push(c);const p=a.get(c);p&&!p.includes(d)&&p.push(d)}return{nodes:o,dependencies:s,dependents:a}}function H2(n){return["SaveImage","PreviewImage","SaveAnimatedWEBP","SaveAnimatedPNG","SaveVideo","SaveAudio"].some(s=>n.type.includes(s))||n.outputs.length===0||n.outputs.every(s=>!s.links||s.links.length===0)}function $2(n){if(n.nodes.length===0)return[];const o=z2(n),s=new Set,a=[];function l(d){if(s.has(d))return;s.add(d);const h=o.nodes.get(d);if(!h)return;const p=o.dependencies.get(d)||[];for(const m of p)l(m);a.push(h)}const c=n.nodes.filter(H2);if(c.length===0)for(const d of n.nodes)(o.dependents.get(d.id)||[]).length===0&&c.push(d);for(const d of c)l(d.id);for(const d of n.nodes)s.has(d.id)||l(d.id);return a}function va(n,o,s){const a=n.nodes.find(m=>m.id===o);if(!a||!a.inputs[s])return null;const l=a.inputs[s].link;if(l===null)return null;const c=n.links.find(m=>m[0]===l);if(!c)return null;const[,d,h]=c,p=n.nodes.find(m=>m.id===d);return p?{node:p,outputIndex:h}:null}function Tl(n,o,s){const a=n.nodes.find(d=>d.id===o);if(!a||!a.outputs[s])return[];const l=a.outputs[s].links||[],c=[];for(const d of l){const h=n.links.find(x=>x[0]===d);if(!h)continue;const[,,,p,m]=h,y=n.nodes.find(x=>x.id===p);y&&c.push({node:y,inputIndex:m})}return c}function El(n){if(n==null)return[];if(Array.isArray(n))return n.flatMap(s=>El(s)).filter(Boolean);const o=String(n);return o?o.split(",").map(s=>s.trim().toUpperCase()).filter(Boolean):[]}function my(n){return!(n==="*"||n==="OPT_CONNECTION")}function yy(n,o){const s=El(n),a=El(o);return s.length===0||a.length===0?!1:s.includes("*")||a.includes("*")?!0:s.some(l=>a.includes(l))}function dc(n,o){const s=El(n).filter(my),a=El(o).filter(my);return s.length===0||a.length===0?!1:s.some(l=>a.includes(l))}function K2(n,o,s,a){const l=n.nodes.find(h=>h.id===s);if(!l)return[];const c=l.inputs[a];if(!c)return[];const d=[];for(const h of n.nodes)if(h.id!==s&&h.mode!==4)for(let p=0;p<h.outputs.length;p++){const m=h.outputs[p];if(dc(m.type,c.type)){d.push({node:h,outputIndex:p});break}}return d}function V2(n,o){const s=[];for(const[a,l]of Object.entries(n)){const c=l.output??[];for(let d=0;d<c.length;d++)if(dc(c[d],o)){s.push({typeName:a,def:l,outputIndex:d});break}}return s}function U2(n){const o=n.input?.required??{},s=n.input?.optional??{},a=n.input_order?.required??Object.keys(o),l=n.input_order?.optional??Object.keys(s),c=[],d=(h,p)=>{if(!Array.isArray(p)||p.length===0)return;const[m]=p;if(Array.isArray(m))return;const y=String(m).toUpperCase();["INT","FLOAT","BOOLEAN","STRING"].includes(y)||c.push({inputIndex:c.length,inputName:h,inputType:String(m)})};for(const h of a)d(h,o[h]);for(const h of l)d(h,s[h]);return c}function W2(n,o){const s=[];for(const[a,l]of Object.entries(n)){const c=U2(l);for(const d of c)if(dc(o,d.inputType)){s.push({typeName:a,def:l,inputIndex:d.inputIndex,inputName:d.inputName,inputType:d.inputType});break}}return s}function F2(n,o,s){const a=n.nodes.find(d=>d.id===o);if(!a)return[];const l=a.outputs?.[s];if(!l)return[];const c=[];for(const d of n.nodes)if(d.id!==o&&d.mode!==4)for(let h=0;h<(d.inputs?.length??0);h+=1){const p=d.inputs[h];dc(l.type,p.type)&&c.push({node:d,inputIndex:h})}return c}function Il(n,o){const s=new Map;if(!o||o.length===0)return s;const a=[...o].sort((l,c)=>{const d=l.bounding[2]*l.bounding[3],h=c.bounding[2]*c.bounding[3];return d!==h?d-h:l.id-c.id});for(const l of n){const[c,d]=l.pos,[h,p]=l.size,m=c+h/2,y=d+p/2;for(const x of a){const[v,k,w,S]=x.bounding;if(m>=v&&m<=v+w&&y>=k&&y<=k+S){s.set(l.id,x.id);break}}}return s}function Iu(){return{root:[],groups:{},groupParents:{},subgraphs:{},hiddenBlocks:{}}}function Vl(n){const o=n.split("/").filter(Boolean);if(o.length===0||o[0]!=="root")return null;const s=o.slice(1);if(s.length===0)return null;const a=h=>{const p=h.indexOf(":");if(p<=0)return null;const m=h.slice(0,p),y=h.slice(p+1);return m!=="node"&&m!=="group"&&m!=="subgraph"||y.length===0?null:{type:m,rawId:y}};let l=null;for(let h=0;h<s.length-1;h+=1){const p=a(s[h]);if(!p||p.type==="node")return null;p.type==="subgraph"&&(l=p.rawId)}const c=a(s[s.length-1]);if(!c)return null;if(c.type==="subgraph")return{type:"subgraph",subgraphId:c.rawId};const d=Number(c.rawId);return Number.isFinite(d)?c.type==="group"?{type:"group",groupId:d,subgraphId:l}:{type:"node",nodeId:d,subgraphId:l}:null}function mn(n){if(n.type==="group"&&n.groupKey)return n.groupKey;const o=n.subgraphId==null?"root":`root/subgraph:${n.subgraphId}`;return n.type==="group"?`${o}/group:${n.groupId}`:n.type==="node"?`${o}/node:${n.nodeId}`:`root/subgraph:${n.subgraphId}`}function q2(n,o){return n.type!==o.type?!1:n.type==="node"&&o.type==="node"?n.id===o.id:n.type==="group"&&o.type==="group"?n.stableKey===o.stableKey:n.type==="subgraph"&&o.type==="subgraph"?n.id===o.id:n.type==="hiddenBlock"&&o.type==="hiddenBlock"?n.blockId===o.blockId:!1}function G2(n){const s=n.properties?.__mobile_origin;if(!s||typeof s!="object")return null;const a=s.scope;if(a==="root")return{scope:"root"};if(a==="subgraph"){const l=s.subgraphId;if(typeof l=="string")return{scope:"subgraph",subgraphId:l}}return null}function P2(n,o,s){const a=o.groups??[],l=o.definitions?.subgraphs??[],c=new Map;for(const B of n){const A=G2(B);A?.scope==="subgraph"&&A.subgraphId&&c.set(B.id,A.subgraphId)}const d=n.filter(B=>!c.has(B.id)),h=Il(d,a),p=new Map;for(const B of l){const A=n.filter(te=>c.get(te.id)===B.id),F=B.groups??[];F.length>0&&p.set(B.id,Il(A,F))}const m=o.extra?.__mobile_subgraph_group_map,y=new Map;if(m&&typeof m=="object")for(const[B,A]of Object.entries(m))(typeof A=="number"||A===null)&&y.set(B,A);const x=Iu();for(const B of l)x.subgraphs[B.id]=[];const v=B=>{const A=new Map;for(const F of B){const[te,ee,ae,ne]=F.bounding,me=te+ae/2,Le=ee+ne/2,P=ae*ne;let V=null,H=Number.POSITIVE_INFINITY;for(const ce of B){if(ce.id===F.id)continue;const[ke,Ne,O,_]=ce.bounding,q=O*_;if(q<=P)continue;const je=te>=ke&&ee>=Ne&&te+ae<=ke+O&&ee+ne<=Ne+_,Ke=me>=ke&&me<=ke+O&&Le>=Ne&&Le<=Ne+_;!je&&!Ke||q<H&&(H=q,V=ce.id)}A.set(F.id,V)}return A};function k(B,A,F){const te=[];let ee=[],ae=0;const ne=()=>{if(ee.length===0)return;const me=`hidden-${A}-${ae}`;ae++,x.hiddenBlocks[me]=[...ee],te.push({type:"hiddenBlock",blockId:me}),ee=[]};for(const me of B)me.type==="node"&&s[mn({type:"node",nodeId:me.id,subgraphId:F})]?ee.push(me.id):(ne(),te.push(me));return ne(),te}for(const B of l){const A=n.filter(H=>c.get(H.id)===B.id),F=p.get(B.id),te=B.groups??[],ee=v(te),ae=new Map,ne=new Map((B.groups??[]).map(H=>[H.id,H])),me=new Set,Le=[],P=H=>ae.get(H)??`legacy-group-${B.id}-${H}`,V=H=>{const ce=[],ke=new Set;let Ne=H;for(;Ne!=null&&!ke.has(Ne);)ce.push(Ne),ke.add(Ne),Ne=ee.get(Ne)??null;ce.reverse();for(const O of ce){if(me.has(O))continue;const _=ee.get(O)??null,q=ne.get(O)?.stableKey??`legacy-group-${B.id}-${O}`;ae.set(O,q);const je={type:"group",id:O,subgraphId:B.id,stableKey:q};if(_==null)Le.push(je),x.groupParents[q]={scope:"subgraph",subgraphId:B.id};else{const Ke=P(_);x.groups[Ke]??=[],x.groups[Ke].push(je),x.groupParents[q]={scope:"group",groupKey:Ke}}me.add(O)}};for(const H of A){const ce=F?.get(H.id);if(ce===void 0){Le.push({type:"node",id:H.id});continue}V(ce),x.groups[P(ce)]??=[],x.groups[P(ce)].push({type:"node",id:H.id})}for(const H of te)V(H.id);for(const H of te){const ce=P(H.id);x.groups[ce]=k(x.groups[ce]??[],`group-${ce}`,B.id)}x.subgraphs[B.id]=k(Le,`subgraph-${B.id}`,B.id)}const w=v(a),S=new Set,j=new Set,C=[],T=new Map,R=new Map(a.map(B=>[B.id,B])),D=B=>T.get(B)??`legacy-group-root-${B}`,L=B=>{const A=[],F=new Set;let te=B;for(;te!=null&&!F.has(te);)A.push(te),F.add(te),te=w.get(te)??null;A.reverse();for(const ee of A){if(S.has(ee))continue;const ae=w.get(ee)??null,ne=R.get(ee)?.stableKey??`legacy-group-root-${ee}`;T.set(ee,ne);const me={type:"group",id:ee,subgraphId:null,stableKey:ne};if(ae==null)C.push(me),x.groupParents[ne]={scope:"root"};else{const Le=D(ae);x.groups[Le]??=[],x.groups[Le].push(me),x.groupParents[ne]={scope:"group",groupKey:Le}}S.add(ee)}};for(const B of d){const A=h.get(B.id);if(A===void 0){C.push({type:"node",id:B.id});continue}L(A),x.groups[D(A)]??=[],x.groups[D(A)].push({type:"node",id:B.id})}for(const B of l){if(j.has(B.id))continue;const A=y.get(B.id);A!=null?(L(A),x.groups[D(A)]??=[],x.groups[D(A)].push({type:"subgraph",id:B.id})):C.push({type:"subgraph",id:B.id}),j.add(B.id)}for(const B of a)L(B.id);for(const B of a){const A=D(B.id);x.groups[A]=k(x.groups[A]??[],`group-${A}`,null)}return x.root=k(C,"root",null),x}function by(n,o){const s=d=>{const h=[];for(const p of d)if(!(p.type==="node"&&p.id===o)){if(p.type==="hiddenBlock"){const m=n.hiddenBlocks[p.blockId];if(m&&m.filter(x=>x!==o).length===0)continue}h.push(p)}return h},a={};for(const[d,h]of Object.entries(n.hiddenBlocks)){const p=h.filter(m=>m!==o);p.length>0&&(a[d]=p)}const l={};for(const[d,h]of Object.entries(n.groups))l[d]=s(h);const c={};for(const[d,h]of Object.entries(n.subgraphs))c[d]=s(h);return{root:s(n.root),groups:l,groupParents:n.groupParents??{},subgraphs:c,hiddenBlocks:a}}function Y2(n,o,s){const a={type:"node",id:o},l=(c,d)=>{const h=(p,m)=>{for(const y of p){if(y.type==="group"&&y.id===c&&m===d)return y.stableKey;if(y.type==="group"){const x=h(n.groups[y.stableKey]??[],m);if(x)return x;continue}if(y.type==="subgraph"){const x=h(n.subgraphs[y.id]??[],y.id);if(x)return x}}return null};return h(n.root,null)};if(s?.subgraphId){const c=n.subgraphs[s.subgraphId]??[];if(s.groupId!=null){const d=l(s.groupId,s.subgraphId);if(!d)return{...n,subgraphs:{...n.subgraphs,[s.subgraphId]:[...c,a]}};const h=n.groups[d]??[];return{...n,groups:{...n.groups,[d]:[...h,a]}}}return{...n,subgraphs:{...n.subgraphs,[s.subgraphId]:[...c,a]}}}if(s?.groupId!=null){const c=l(s.groupId,s.subgraphId??null);if(!c)return{...n,root:[...n.root,a]};const d=n.groups[c]??[];return{...n,groups:{...n.groups,[c]:[...d,a]}}}return{...n,root:[...n.root,a]}}function Q2(n,o){const s=n.groups[o]??[],a=m=>{const y=[];for(const x of m)x.type==="group"&&x.stableKey===o?y.push(...s):y.push(x);return y},l={...n.groups},c={...n.groupParents??{}},d=c[o];delete l[o],delete c[o];let h=n.root;n.root.some(m=>m.type==="group"&&m.stableKey===o)&&(h=a(n.root));for(const[m,y]of Object.entries(l))y.some(x=>x.type==="group"&&x.stableKey===o)&&(l[m]=a(y));const p={...n.subgraphs};for(const[m,y]of Object.entries(p))y.some(x=>x.type==="group"&&x.stableKey===o)&&(p[m]=a(y));for(const m of s)m.type==="group"&&(d?c[m.stableKey]=d:delete c[m.stableKey]);return{root:h,groups:l,groupParents:c,subgraphs:p,hiddenBlocks:n.hiddenBlocks}}function X2(n,o,s,a,l,c){const d=n.groupParents??{},h=(w,S)=>S.scope==="root"?w.root:S.scope==="group"?w.groups[S.groupKey]??[]:w.subgraphs[S.subgraphId]??[],p=(w,S,j)=>S.scope==="root"?{...w,root:j}:S.scope==="group"?{...w,groups:{...w.groups,[S.groupKey]:j}}:{...w,subgraphs:{...w.subgraphs,[S.subgraphId]:j}},m=w=>w.scope==="root"?{scope:"root"}:w.scope==="group"?{scope:"group",groupKey:w.groupKey}:{scope:"subgraph",subgraphId:w.subgraphId};if(s.scope===l.scope&&(s.scope==="root"||s.scope==="group"&&l.scope==="group"&&s.groupKey===l.groupKey||s.scope==="subgraph"&&l.scope==="subgraph"&&s.subgraphId===l.subgraphId)){const w=[...h(n,s)],[S]=w.splice(a,1);if(!S)return n;const j=c>a?c-1:c;return w.splice(j,0,S),p(n,s,w)}const x=[...h(n,s)];x.splice(a,1);let v=p(n,s,x);const k=[...h(v,l)];return k.splice(c,0,o),v=p(v,l,k),o.type==="group"&&(v={...v,groupParents:{...v.groupParents??d,[o.stableKey]:m(l)}}),v}function nx(n){const o=[],s=a=>{for(const l of a)if(l.type==="node")o.push(l.id);else if(l.type==="group"){const c=n.groups[l.stableKey];c&&s(c)}else if(l.type==="subgraph"){const c=n.subgraphs[l.id];c&&s(c)}else if(l.type==="hiddenBlock"){const c=n.hiddenBlocks[l.blockId];c&&o.push(...c)}};return s(n.root),o}function Z2(n,o){return o.scope==="root"?n.root:o.scope==="group"?n.groups[o.groupKey]??[]:n.subgraphs[o.subgraphId]??[]}function ox(n,o){const s=(l,c)=>{const d=l.findIndex(h=>q2(h,o));return d>=0?{containerId:c,index:d}:null},a=s(n.root,{scope:"root"});if(a)return a;for(const[l,c]of Object.entries(n.groups)){const d=s(c,{scope:"group",groupKey:l});if(d)return d}for(const[l,c]of Object.entries(n.subgraphs)){const d=s(c,{scope:"subgraph",subgraphId:l});if(d)return d}return null}function J2(n,o,s=250){const a=n.nodes.find(l=>l.id===o);return a?[a.pos[0]+s,a.pos[1]]:null}function xy(n){return n.nodes.length===0?[0,0]:[0,Math.max(...n.nodes.map(s=>s.pos[1]+(s.size?.[1]??100)))+80]}function eS(n,o,s,a=24){const[l,c,d,h]=o.bounding,[p,m]=s,y=l+a,x=c+48,v=Math.max(y,l+d-p-a),k=Math.max(x,c+h-m-a);return[Math.min(Math.max(n[0],y),v),Math.min(Math.max(n[1],x),k)]}function rx(n,o){const s=(a,l,c,d)=>{for(const h of a){if(o({ref:h,groupKeys:l,subgraphIds:c,currentSubgraphId:d}))return{groupKeys:l,subgraphIds:c,currentSubgraphId:d};if(h.type==="group"){const p=s(n.groups[h.stableKey]??[],[...l,h.stableKey],c,d);if(p)return p;continue}if(h.type==="subgraph"){const p=s(n.subgraphs[h.id]??[],l,[...c,h.id],h.id);if(p)return p}}return null};return s(n.root,[],[],null)}const Fu="__mobile_origin",Jr="__mobile_subgraph_group_map";let tS=0;function Zr(n,o){return P2($2(n),n,o)}function da(){return typeof crypto<"u"&&typeof crypto.randomUUID=="function"?`sk_${crypto.randomUUID()}`:`sk_${Math.random().toString(36).slice(2)}_${Date.now().toString(36)}`}function nS(n){const o=[],s=new Set,a=new Set,l=(c,d)=>{for(const h of c){if(h.type==="node"){o.push(mn({type:"node",nodeId:h.id,subgraphId:d}));continue}if(h.type==="group"){if(o.push(h.stableKey),s.has(h.stableKey))continue;s.add(h.stableKey),l(n.groups[h.stableKey]??[],d);continue}if(h.type==="subgraph"){const p=mn({type:"subgraph",subgraphId:h.id});if(o.push(p),a.has(h.id))continue;a.add(h.id),l(n.subgraphs[h.id]??[],h.id)}}};return l(n.root,null),o}function vy(n){const o=Vl(n);return o?o.type==="node"?`node:${o.nodeId}`:o.type==="group"?`group:${o.subgraphId??"root"}:${o.groupId}`:`subgraph:${o.subgraphId}`:`unknown:${n}`}function To(n,o,s){const a=nS(n),l=new Map;for(const[p,m]of Object.entries(s)){const y=vy(m),x=l.get(y)??[];x.push(p),l.set(y,x)}const c=new Set,d={},h={};for(const p of a){let m=o[p];if(m&&c.has(m)&&(m=void 0),!m&&!Vl(p)&&(m=p),!m){const y=vy(p),x=l.get(y)??[];for(;x.length>0;){const v=x.shift();if(!(!v||c.has(v))){m=v;break}}l.set(y,x)}m||(m=da()),c.add(m),d[p]=m,h[m]=p}return{layoutToStable:d,stableToLayout:h}}function oS(n,o){const s=new Set(o.nodes.map(l=>l.id)),a=new Set(nx(n));if(s.size!==a.size)return!1;for(const l of s)if(!a.has(l))return!1;return!0}function Ll(n,o=null){return mn({type:"node",nodeId:n,subgraphId:o})}function rS(n){const o=mo(n);return Ll(n.id,o?.scope==="subgraph"?o.subgraphId:null)}const wy=new WeakMap;function sS(n){const o=wy.get(n);if(o)return o;const s=new Map;for(const a of n.nodes){const l=rS(a),c=s.get(a.id);c?c.includes(l)||c.push(l):s.set(a.id,[l])}return wy.set(n,s),s}function Cl(n,o,s=null){if(s!=null)return[Ll(o,s)];const a=sS(n).get(o)??[];return a.length>0?[...a]:[Ll(o,null)]}function If(n,o){if(!o)return{};const s={};for(const[a,l]of Object.entries(o)){if(!l)continue;if(a.includes(":node:")||a.includes("/node:")){const d=Vl(a);if(d?.type==="node"){s[Ll(d.nodeId,d.subgraphId)]=!0;continue}const h=a.match(/^(root|subgraph:(.*)):node:(\d+)$/);if(!h)continue;const p=Number(h[3]);if(!Number.isFinite(p))continue;s[Ll(p,h[1]==="root"?null:h[2]??null)]=!0;continue}const c=Number(a);if(Number.isFinite(c))for(const d of Cl(n,c))s[d]=!0}return s}function Sy(n){const o=l=>l.map(c=>c.type!=="group"?c:{...c}),s={};for(const[l,c]of Object.entries(n.groups)){const d=l,h=o(c);s[d]?s[d]=[...s[d],...h]:s[d]=h}const a={};for(const[l,c]of Object.entries(n.subgraphs))a[l]=o(c);return{...n,root:o(n.root),groups:s,subgraphs:a}}function pu(n,o,s=null){const a=new Set,l=(c,d)=>{for(const h of c)h.type==="group"?(h.id===o&&d===s&&a.add(h.stableKey),l(n.groups[h.stableKey]??[],d)):h.type==="subgraph"&&l(n.subgraphs[h.id]??[],h.id)};return l(n.root,null),[...a]}function Fp(n,o){return o[n]??null}function aS(n,o){const s=new Set,a=[];for(const l of n){const c=Fp(l,o);!c||s.has(c)||(s.add(c),a.push(c))}return a}function lS(n,o,s=null){const a=[],l=new Set;for(const[c,d]of Object.entries(n)){if(l.has(d))continue;const h=Vl(c);h?.type==="node"&&h.nodeId===o&&(s!==null&&h.subgraphId!==s||(l.add(d),a.push(d)))}return a}function vs(n,o,s,a=null){const l=lS(o,s,a);return l.length>0?l:aS(Cl(n,s,a),o)}function Kn(n,o,s){const a=n.nodes.find(l=>l.stableKey===o);if(a){const l=mo(a);return{nodeId:a.id,subgraphId:l?.scope==="subgraph"?l.subgraphId:null}}return null}function qp(n,o){const s=o[n];return s||(Vl(n)?n:null)}function hu(n,o,s){const a=(n.groups??[]).find(l=>l.stableKey===o);if(a)return{type:"group",groupId:a.id,subgraphId:null,stableKey:o};for(const l of n.definitions?.subgraphs??[]){if(l.stableKey===o)return{type:"subgraph",subgraphId:l.id,stableKey:o};const c=(l.groups??[]).find(d=>d.stableKey===o);if(c)return{type:"group",groupId:c.id,subgraphId:l.id,stableKey:o}}return null}function gu(n,o){return(n.definitions?.subgraphs??[]).find(a=>a.id===o)?.stableKey??null}function sx(n,o){const s=n.groupParents?.[o];return s?s.scope==="subgraph"?s.subgraphId:s.scope==="root"?null:sx(n,s.groupKey):null}function Lf(n,o){if(!n)return{};const s={};for(const[a,l]of Object.entries(n)){if(!l)continue;const c=Fp(a,o);c&&(s[c]=!0)}return s}function iS(n,o){if(!n)return{};const s={};for(const[a,l]of Object.entries(n)){if(l!==!0)continue;const c=Fp(a,o);c&&(s[c]=!0)}return s}function mu(n,o,s){if(!n)return{};const a={};for(const[l,c]of Object.entries(n)){if(!c)continue;const d=qp(l,s),h=d?o[d]:o[l];h&&(a[h]=!0)}return a}function yl(n,o,s){if(!n)return{};const a={};for(const[l,c]of Object.entries(n)){if(c!==!0)continue;const d=qp(l,s),h=d?o[d]:o[l];h&&(a[h]=!0)}return a}function uS(n,o,s){if(!n||n.length===0)return[];const a=[],l=new Set;for(const c of n){if(!c)continue;const d=qp(c,s),h=d?o[d]:o[c];!h||l.has(h)||(l.add(h),a.push(h))}return a}function bl(n,o){if(!n)return{};const s={};for(const[a,l]of Object.entries(n)){if(!l)continue;const c=o[a];c&&(s[c]=!0)}return s}function up(n){return n.map(o=>({...o,widgets_values:o.widgets_values??[],inputs:o.inputs??[],outputs:o.outputs??[],flags:o.flags??{},properties:o.properties??{},mode:o.mode??0,order:o.order??0}))}function ro(n){const o=JSON.parse(JSON.stringify(n));return o.nodes=up(o.nodes??[]),o.links=o.links??[],o.groups=o.groups??[],o.config=o.config??{},o.definitions?.subgraphs&&(o.definitions.subgraphs=o.definitions.subgraphs.map(s=>({...s,nodes:up(s.nodes??[]),links:s.links??[]}))),o.last_node_id=o.last_node_id??Math.max(0,...o.nodes.map(s=>s.id)),o.last_link_id=o.last_link_id??0,o.version=o.version??.4,o}function Ny(n){if(!("stableKey"in n))return n;const{stableKey:o,...s}=n;return s}function ky(n){if(!("stableKey"in n))return n;const{stableKey:o,...s}=n;return s}function qu(n){const o=n.nodes.map(Ny),s=(n.groups??[]).map(ky),a=o.some((h,p)=>h!==n.nodes[p])||s.some((h,p)=>h!==(n.groups??[])[p]),l=n.definitions?.subgraphs;if(!l)return a?{...n,nodes:o,groups:s}:n;let c=!1;const d=l.map(h=>{const p=h.nodes.map(Ny),m=(h.groups??[]).map(ky);let y=p.some((k,w)=>k!==h.nodes[w])||m.some((k,w)=>k!==(h.groups??[])[w]);if(h.stableKey!=null&&(y=!0),!y)return h;c=!0;const{stableKey:x,...v}=h;return{...v,nodes:p,groups:m}});return!a&&!c?n:{...n,nodes:o,groups:s,definitions:{...n.definitions??{},subgraphs:d}}}function mo(n){if(!n)return null;const s=n.properties?.[Fu];if(!s||typeof s!="object")return null;const a=s.scope;if(a==="root"){const l=s.nodeId;return typeof l=="number"?{scope:"root",nodeId:l}:null}if(a==="subgraph"){const l=s.nodeId,c=s.subgraphId;if(typeof l=="number"&&typeof c=="string")return{scope:"subgraph",subgraphId:c,nodeId:l}}return null}function cS(n){const o=mo(n);return mn({type:"node",nodeId:n.id,subgraphId:o?.scope==="subgraph"?o.subgraphId:null})}function Cy(n,o,s=null){return n.map(a=>{const l=s===null?cS(a):mn({type:"node",nodeId:a.id,subgraphId:s}),c=o[l];return!c||a.stableKey===c?a:{...a,stableKey:c}})}function jy(n,o,s){return n.map(a=>{const l=mn({type:"group",groupId:a.id,subgraphId:s}),c=o[l];return!c||a.stableKey===c?a:{...a,stableKey:c}})}function cp(n){if(n.nodes.some(o=>!o.stableKey)||(n.groups??[]).some(o=>!o.stableKey))return!0;for(const o of n.definitions?.subgraphs??[])if(!o.stableKey||(o.nodes??[]).some(s=>!s.stableKey)||(o.groups??[]).some(s=>!s.stableKey))return!0;return!1}function My(n,o){for(const s of n.groups??[])if(s.stableKey&&!(s.stableKey in o.groups))return!0;for(const s of n.definitions?.subgraphs??[])for(const a of s.groups??[])if(a.stableKey&&!(a.stableKey in o.groups))return!0;return!1}function dS(n){if(!cp(n))return n;const o=(n.nodes??[]).map(l=>l.stableKey?l:{...l,stableKey:da()}),s=(n.groups??[]).map(l=>l.stableKey?l:{...l,stableKey:da()}),a=(n.definitions?.subgraphs??[]).map(l=>{const c=l.stableKey??da(),d=(l.nodes??[]).map(p=>p.stableKey?p:{...p,stableKey:da()}),h=(l.groups??[]).map(p=>p.stableKey?p:{...p,stableKey:da()});return{...l,stableKey:c,nodes:d,groups:h}});return{...n,nodes:o,groups:s,definitions:n.definitions?{...n.definitions,subgraphs:a}:n.definitions}}function yu(n,o){return Yn(n,o)}function Yn(n,o){const s=dS(n),a=Cy(s.nodes,o),l=jy(s.groups??[],o,null),c=a.some((y,x)=>y!==s.nodes[x]),d=l.some((y,x)=>y!==(s.groups??[])[x]),h=s.definitions?.subgraphs;if(!h)return c||d?{...s,nodes:a,groups:l}:s;let p=!1;const m=h.map(y=>{const x=Cy(y.nodes??[],o,y.id),v=jy(y.groups??[],o,y.id),k=mn({type:"subgraph",subgraphId:y.id}),w=o[k];return x.some((j,C)=>j!==(y.nodes??[])[C])||v.some((j,C)=>j!==(y.groups??[])[C])||w!=null&&y.stableKey!==w?(p=!0,{...y,stableKey:w??y.stableKey,nodes:x,groups:v}):y});return!c&&!d&&!p?s:{...s,nodes:a,groups:l,definitions:{...s.definitions??{},subgraphs:m}}}function Gu(n,o){const s=new Set,a=Array.from(n);for(;a.length>0;){const l=a.pop();if(!l||s.has(l))continue;s.add(l);const c=o.get(l);if(c)for(const d of c)s.has(d)||a.push(d)}return s}function fS(n){const o=new Set(n.map(a=>a.id)),s=new Map;for(const a of n)for(const l of a.nodes??[]){if(!o.has(l.type))continue;const c=s.get(l.type)??[];c.push({parentId:a.id,nodeId:l.id}),s.set(l.type,c)}return s}function xl(n,o,s){return!s||s.length===0?null:Il(o,s).get(n)??null}function pS(n,o){const s=rx(n,({ref:a,currentSubgraphId:l})=>a.type==="node"&&o.type==="node"?a.id===o.id:a.type==="group"&&o.type==="group"?o.id===a.id&&(o.subgraphId??null)===l:a.type==="subgraph"&&o.type==="subgraph"?o.id===a.id:!1);return s?{groupKeys:s.groupKeys,subgraphIds:s.subgraphIds}:null}function dp(n,o,s=null){const a=n.nodes??[],l=n.groups??[],c=n.definitions?.subgraphs??[],d=new Map(c.map(v=>[v.id,v])),h=new Set(c.map(v=>v.id)),p=new Map,m=[];for(const v of a){const k=mo(v);if(k?.scope==="subgraph"){const w=p.get(k.subgraphId);w?w.push(v):p.set(k.subgraphId,[v])}else m.push(v)}const y=new Map;for(const v of c){const k=new Set;for(const w of v.nodes??[])h.has(w.type)&&k.add(w.type);k.size>0&&y.set(v.id,k)}const x=new Set;if(s){const v=d.get(s);if(!v)return x;const k=v.groups??[];if(!k.find(L=>L.id===o))return x;const S=v.nodes??[],j=Il(S,k),C=new Set,T=new Set;for(const L of S)j.get(L.id)===o&&(h.has(L.type)?C.add(L.type):T.add(L.id));const R=p.get(s)??[];for(const L of R){const B=mo(L);B?.scope==="subgraph"&&T.has(B.nodeId)&&x.add(L.id)}const D=Gu(C,y);for(const L of D){const B=p.get(L)??[];for(const A of B)x.add(A.id)}}else{if(!l.find(C=>C.id===o))return x;const k=Il(m,l);for(const C of m)k.get(C.id)===o&&x.add(C.id);const w=n.extra?.[Jr],S=new Set;if(w&&typeof w=="object")for(const[C,T]of Object.entries(w))T===o&&S.add(C);const j=Gu(S,y);for(const C of j){const T=p.get(C)??[];for(const R of T)x.add(R.id)}}return x}function ax(n){const o=n.definitions?.subgraphs??[],s=new Set(o.map(l=>l.id)),a=new Map;for(const l of o){const c=new Set;for(const d of l.nodes??[])s.has(d.type)&&c.add(d.type);c.size>0&&a.set(l.id,c)}return a}function Oy(n,o){const s=ax(n),a=Gu([o],s),l=new Set;for(const c of n.nodes??[]){const d=mo(c);d?.scope==="subgraph"&&a.has(d.subgraphId)&&l.add(c.id)}return l}function hS(n,o){return n.scope==="subgraph"?n.subgraphId:n.scope==="root"?null:sx(o,n.groupKey)}function gS(n,o){const s=new Map;let a=Math.max(0,...o.map(c=>c.id))+1;const l=n.map(c=>{const d=a++;return s.set(c.id,d),{...c,id:d}});return{idMap:s,promotedGroups:l}}function Ty(n,o){if(o.size===0)return n;const s=new Set;for(const c of n.links??[])(o.has(c[1])||o.has(c[3]))&&s.add(c[0]);const a=(n.links??[]).filter(c=>!s.has(c[0])),l=(n.nodes??[]).filter(c=>!o.has(c.id)).map(c=>{const d=(c.inputs??[]).map(p=>p.link!=null&&s.has(p.link)?{...p,link:null}:p),h=(c.outputs??[]).map(p=>{const m=(p.links??[]).filter(y=>!s.has(y));return{...p,links:m.length>0?m:null}});return{...c,inputs:d,outputs:h}});return{...n,nodes:l,links:a}}function mS(n,o,s,a){if(!Array.isArray(n.widgets_values)){const c={...n.widgets_values||{}};return a?(c[a]=s,n.type==="VHS_VideoCombine"&&a==="save_image"&&"save_output"in c&&(c.save_output=s)):o>=0&&(c[String(o)]=s),{...n,widgets_values:c}}let l=[...n.widgets_values];return o>=l.length?l.push(s):l[o]=s,n.type==="Power Lora Loader (rgthree)"&&(l=l.filter(c=>c!==null)),{...n,widgets_values:l}}function yS(n,o){if(!Array.isArray(n.widgets_values))return n;const s=[...n.widgets_values];for(const[a,l]of Object.entries(o)){const c=parseInt(a,10);s[c]=l}return{...n,widgets_values:s}}function fa(n,o){const s=d=>{const h={...d.properties??{}},p=o.properties??{};for(const[y,x]of Object.entries(p))y!==Fu&&(h[y]=x);const m={...d,widgets_values:o.widgets_values??d.widgets_values,mode:o.mode??d.mode,flags:o.flags??d.flags,properties:h};return"title"in o&&(m.title=o.title),"color"in o&&(m.color=o.color),"bgcolor"in o&&(m.bgcolor=o.bgcolor),m},a=mo(o)??{scope:"root",nodeId:o.id};if(a.scope==="root"){const d=n.nodes.map(h=>h.id===a.nodeId?s(h):h);return{...n,nodes:d}}const l=n.definitions?.subgraphs;if(!l)return n;const c=l.map(d=>{if(d.id!==a.subgraphId)return d;const h=d.nodes.map(p=>p.id===a.nodeId?s(p):p);return{...d,nodes:h}});return{...n,definitions:{...n.definitions,subgraphs:c}}}function vl(n,o){if(!n)return null;let s=n;for(const a of o)s=fa(s,a);return s}function _f(n,o,s){const a=["fixed","randomize","increment","decrement"];if(Array.isArray(s.widgets_values)){const c=s.widgets_values.find(d=>typeof d=="string"&&a.includes(d.toLowerCase()));if(typeof c=="string"){const d=c.toLowerCase();if(a.includes(d))return d}}const l=ba(n,o,s);if(l!==null&&Array.isArray(s.widgets_values)){const c=Number(s.widgets_values[l]),d=Zb(c);if(d)return d;const p=(s.outputs??[]).some(v=>String(v.name||"").toLowerCase().includes("seed")&&String(v.type||"").toUpperCase().includes("INT")),m=s.widgets_values.slice(l+1),y=m.length>0&&m.every(v=>v===""||v===null||v===void 0),x=s.properties&&("randomMin"in s.properties||"randomMax"in s.properties);if(p&&y&&x)return"randomize"}return"fixed"}function bS(n,o){const s={};for(const a of n.nodes){const l=o[a.type];if(!l?.input)continue;const c=l.input_order?.required||Object.keys(l.input.required||{}),d=l.input_order?.optional||Object.keys(l.input.optional||{}),h=[...c,...d];for(const p of h){const m=l.input.required?.[p]||l.input.optional?.[p];if(!m)continue;const[y]=m;if(!Array.isArray(y)||y.length===0||a.inputs.find(R=>R.name===p)?.link!=null)continue;const v=Vn(n,o,a,p);if(v===null)continue;const k=es(a,p,v);if(k==null)continue;const w=Kl(k,y),S=Hp(k,y,{comboIndexToValue:!0}),j=String(S),C=j.split(/[\\/]/).pop()??j;if(!(w!==void 0||y.some(R=>{const D=String(R);return D===j||D===C}))){const R=String(a.id);s[R]||(s[R]=[]),s[R].push({type:"workflow_load",message:`Missing value: ${j}`,details:"Not found on server.",inputName:p})}}}return s}function Ey(n,o){let s=!1;const a=n.nodes.map(l=>{if(!Array.isArray(l.widgets_values))return l;const c=o[l.type];if(!c?.input)return l;const d=c.input_order?.required||Object.keys(c.input.required||{}),h=c.input_order?.optional||Object.keys(c.input.optional||{}),p=[...d,...h];let m=null;for(const y of p){const x=c.input.required?.[y]||c.input.optional?.[y];if(!x)continue;const[v]=x;if(!Array.isArray(v)||v.length===0||l.inputs.find(C=>C.name===y)?.link!=null)continue;const w=Vn(n,o,l,y);if(w===null||w<0||w>=l.widgets_values.length)continue;const S=es(l,y,w);if(S==null)continue;const j=Kl(S,v);j===void 0||j===S||(m||(m=[...l.widgets_values]),m[w]=j,s=!0)}return m?{...l,widgets_values:m}:l});return s?{workflow:{...n,nodes:a},changed:!0}:{workflow:n,changed:!1}}const de=vo()(jr((n,o)=>{const s=oe=>{const{hiddenItems:z,workflow:U,stableKeyByPointer:se}=o();if(!U){gn.getState().setNodeErrors(oe);return}const M=Object.keys(oe).filter(re=>{const W=Number(re);return Number.isFinite(W)?vs(U,se,W).some(G=>!!z[G]):!1});if(M.length>0){const re={...z};for(const W of M){const G=Number(W);if(Number.isFinite(G))for(const I of vs(U,se,G))delete re[I]}n({hiddenItems:re})}gn.getState().setNodeErrors(oe)},a=(oe,z)=>{const{workflow:U,hiddenItems:se,connectionHighlightModes:fe,mobileLayout:M,stableKeyByPointer:re,pointerByStableKey:W}=o();if(!U)return;const G=Kn(U,oe);if(!G)return;const{nodeId:I,subgraphId:$}=G;if(!U.nodes.some(he=>{if(he.id!==I)return!1;const Qe=mo(he);return $==null?Qe?.scope!=="subgraph":Qe?.scope==="subgraph"&&Qe.subgraphId===$}))return;const Z=new Set,Se=U.links.filter(he=>{const Qe=he[3]===I;return Qe&&Z.add(he[0]),Qe}),Q=U.links.filter(he=>{const Qe=he[1]===I;return Qe&&Z.add(he[0]),Qe});let Me=U.last_link_id;const K=new Map,Te=new Map,_e=[];if(z)for(const he of Q){const[,,,Qe,ut,it]=he,_t=Se.find(Gt=>yy(Gt[5],it));if(!_t)continue;const[,Ot,wt]=_t;Me+=1;const It=[Me,Ot,wt,Qe,ut,it];_e.push(It);const Kt=`${Qe}:${ut}`;K.set(Kt,It[0]);const pt=`${Ot}:${wt}`,Lt=Te.get(pt)??[];Lt.push(It[0]),Te.set(pt,Lt)}const qe=[...U.links.filter(he=>!Z.has(he[0])),..._e],Ge=U.nodes.filter(he=>he.id!==I).map(he=>{const Qe=he.inputs.map((it,_t)=>{const Ot=`${he.id}:${_t}`,wt=K.get(Ot);return wt!=null?{...it,link:wt}:it.link!=null&&Z.has(it.link)?{...it,link:null}:it}),ut=he.outputs.map((it,_t)=>{const wt=(it.links??[]).filter(Lt=>!Z.has(Lt)),It=`${he.id}:${_t}`,Kt=Te.get(It)??[],pt=[...wt,...Kt];return{...it,links:pt.length>0?pt:null}});return{...he,inputs:Qe,outputs:ut}}),Ve={...se};for(const he of vs(U,re,I,$))delete Ve[he];for(const he of Cl(U,I,$))delete Ve[he];const Je={...fe};delete Je[I];const Ue=by(M,I),Xe=To(Ue,re,W),Pe=Yn({...U,nodes:Ge,links:qe,last_link_id:Me},Xe.layoutToStable);n({workflow:Pe,embedWorkflow:ro(Pe),hiddenItems:Ve,connectionHighlightModes:Je,mobileLayout:Ue,stableKeyByPointer:Xe.layoutToStable,pointerByStableKey:Xe.stableToLayout})},l=(oe,z,U,se,fe)=>{const{workflow:M,pointerByStableKey:re}=o();if(!M)return;const W=Kn(M,oe),G=Kn(M,U);if(!W||!G)return;const I=W.nodeId,$=G.nodeId,Z=M.nodes.find(Ve=>Ve.id===I),Se=M.nodes.find(Ve=>Ve.id===$);if(!Z||!Se)return;let Q=[...M.links],Me=M.last_link_id;const K=Se.inputs[se]?.link;K!=null&&(Q=Q.filter(Ve=>Ve[0]!==K)),Me++;const Te=Me,_e=[Te,I,z,$,se,fe];Q.push(_e);const qe=M.nodes.map(Ve=>{if(Ve.id===$){const Je=[...Ve.inputs];return Je[se]={...Je[se],link:Te},{...Ve,inputs:Je}}if(Ve.id===I){const Je=[...Ve.outputs],Pe=[...(Je[z]?.links??[]).filter(he=>he!==K),Te];return Je[z]={...Je[z],links:Pe},{...Ve,outputs:Je}}if(K!=null&&Ve.id!==I&&Ve.outputs.some(Ue=>Ue.links?.includes(K))){const Ue=Ve.outputs.map(Xe=>{if(Xe.links?.includes(K)){const Pe=Xe.links.filter(he=>he!==K);return{...Xe,links:Pe.length>0?Pe:null}}return Xe});return{...Ve,outputs:Ue}}return Ve}),Ge={...M,nodes:qe,links:Q,last_link_id:Me};n({workflow:Ge,embedWorkflow:ro(Ge)})},c=(oe,z)=>{const{workflow:U,pointerByStableKey:se}=o();if(!U)return;const fe=Kn(U,oe);if(!fe)return;const M=fe.nodeId,re=U.nodes.find(Z=>Z.id===M);if(!re)return;const W=re.inputs[z]?.link;if(W==null)return;const G=U.links.filter(Z=>Z[0]!==W),I=U.nodes.map(Z=>{if(Z.id===M){const Q=[...Z.inputs];return Q[z]={...Q[z],link:null},{...Z,inputs:Q}}if(Z.outputs.some(Q=>Q.links?.includes(W))){const Q=Z.outputs.map(Me=>{if(Me.links?.includes(W)){const K=Me.links.filter(Te=>Te!==W);return{...Me,links:K.length>0?K:null}}return Me});return{...Z,outputs:Q}}return Z}),$={...U,nodes:I,links:G};n({workflow:$,embedWorkflow:ro($)})},d=(oe,z)=>{const{workflow:U,nodeTypes:se,mobileLayout:fe}=o();if(!U||!se)return null;const M=se[oe];if(!M)return null;const re=U.last_node_id+1,W=[],G=M.input?.required??{},I=M.input?.optional??{},$=M.input_order?.required??Object.keys(G),Z=M.input_order?.optional??Object.keys(I);for(const Ue of $){const Xe=G[Ue];if(!Xe)continue;const[Pe]=Xe;if(Array.isArray(Pe))continue;const he=String(Pe).toUpperCase();["INT","FLOAT","BOOLEAN","STRING"].includes(he)||W.push({name:Ue,type:String(Pe),link:null})}for(const Ue of Z){const Xe=I[Ue];if(!Xe)continue;const[Pe]=Xe;if(Array.isArray(Pe))continue;const he=String(Pe).toUpperCase();["INT","FLOAT","BOOLEAN","STRING"].includes(he)||W.push({name:Ue,type:String(Pe),link:null})}const Se=(M.output??[]).map((Ue,Xe)=>({name:M.output_name?.[Xe]??Ue,type:Ue,links:null,slot_index:Xe})),Q=[];for(const Ue of $){const Xe=G[Ue];if(!Xe)continue;const[Pe,he]=Xe;if(Array.isArray(Pe)){Q.push(Pe[0]??"");continue}const Qe=String(Pe).toUpperCase();Qe==="INT"||Qe==="FLOAT"?Q.push(he?.default??0):Qe==="STRING"?Q.push(he?.default??""):Qe==="BOOLEAN"&&Q.push(he?.default??!1)}for(const Ue of Z){const Xe=I[Ue];if(!Xe)continue;const[Pe,he]=Xe;if(Array.isArray(Pe)){Q.push(Pe[0]??"");continue}const Qe=String(Pe).toUpperCase();Qe==="INT"||Qe==="FLOAT"?Q.push(he?.default??0):Qe==="STRING"?Q.push(he?.default??""):Qe==="BOOLEAN"&&Q.push(he?.default??!1)}let Me=[0,0];if(z?.nearNodeStableKey){const Ue=Kn(U,z.nearNodeStableKey,o().pointerByStableKey);Ue&&(Me=J2(U,Ue.nodeId)??Me)}else if(z?.inSubgraphId){const Ue=U.nodes.filter(Xe=>{const Pe=mo(Xe);return Pe?.scope==="subgraph"&&Pe.subgraphId===z.inSubgraphId});if(Ue.length>0){const Xe=Math.max(...Ue.map(he=>he.pos[1]+(he.size?.[1]??100)));Me=[Math.min(...Ue.map(he=>he.pos[0])),Xe+80]}else Me=xy(U)}else Me=xy(U);if(z?.inGroupId!=null){const Xe=[...U.groups??[],...(U.definitions?.subgraphs??[]).flatMap(Pe=>Pe.groups??[])].find(Pe=>Pe.id===z.inGroupId);Xe&&(Me=eS(Me,Xe,[200,100]))}const K={};z?.inSubgraphId&&(K[Fu]={scope:"subgraph",subgraphId:z.inSubgraphId,nodeId:re});const Te={id:re,type:oe,pos:Me,size:[200,100],flags:{},order:0,mode:0,inputs:W,outputs:Se,properties:K,widgets_values:Q},_e=Y2(fe,re,{groupId:z?.inGroupId??void 0,subgraphId:z?.inSubgraphId??void 0}),{stableKeyByPointer:qe,pointerByStableKey:Ge}=o(),Ve=To(_e,qe,Ge),Je=Yn({...U,nodes:[...U.nodes,Te],last_node_id:re},Ve.layoutToStable);return n({workflow:Je,embedWorkflow:ro(Je),mobileLayout:_e,stableKeyByPointer:Ve.layoutToStable,pointerByStableKey:Ve.stableToLayout}),re},h=(oe,z,U)=>{const{workflow:se,nodeTypes:fe,pointerByStableKey:M}=o();if(!se||!fe)return null;const re=Kn(se,z);if(!re)return null;const W=re.nodeId,G=se.nodes.find(Te=>Te.id===W);if(!G)return null;const I=G.inputs[U];if(!I)return null;const $=fe[oe];if(!$)return null;const Z=I.type.toUpperCase(),Se=($.output??[]).findIndex(Te=>yy(String(Te),Z));if(Se<0)return null;const Q=o().addNode(oe,{nearNodeStableKey:z});if(Q===null)return null;const Me=mn({type:"node",nodeId:Q,subgraphId:re.subgraphId}),K=o().stableKeyByPointer[Me];return K?(o().connectNodes(K,Se,z,U,I.type),Q):null},p=(oe,z)=>{n(U=>({...(()=>{const se=U.workflow?Kn(U.workflow,oe,U.pointerByStableKey):null;if(!se)return{};const fe=String(se.nodeId);return{nodeOutputs:{...U.nodeOutputs,[fe]:z}}})()}))},m=(oe,z)=>{n(U=>({...(()=>{const se=U.workflow?Kn(U.workflow,oe,U.pointerByStableKey):null;if(!se)return{};const fe=String(se.nodeId);return{nodeTextOutputs:{...U.nodeTextOutputs,[fe]:z}}})()}))},y=oe=>{n(z=>{const U=z.workflow?Kn(z.workflow,oe,z.pointerByStableKey):null;if(!U)return{};const se=U.nodeId,fe=z.connectionHighlightModes[se]??"off",M=fe==="off"?"inputs":fe==="inputs"?"outputs":fe==="outputs"?"both":"off";return{connectionHighlightModes:{...z.connectionHighlightModes,[se]:M}}})},x=(oe,z)=>{n(U=>({...(()=>{const se=U.workflow?Kn(U.workflow,oe,U.pointerByStableKey):null;return se?{connectionHighlightModes:{...U.connectionHighlightModes,[se.nodeId]:z}}:{}})()}))},v=(oe,z)=>{oe&&n(U=>{const se=U.stableKeyByPointer[oe]??oe,fe=U.pointerByStableKey[se],M={...U.hiddenItems};return z?M[se]=!0:(delete M[oe],delete M[se],fe&&delete M[fe]),{hiddenItems:M}})},k=oe=>{const{workflow:z,pointerByStableKey:U}=o();if(!z)return;const se=Kn(z,oe);if(!se)return;const fe=z.definitions?.subgraphs??[],M=se.subgraphId??null,re=z.nodes.find(K=>{if(K.id!==se.nodeId)return!1;const Te=mo(K);return M===null?Te?.scope!=="subgraph":Te?.scope==="subgraph"&&Te.subgraphId===M});if(!re)return;const W=new Map(fe.map(K=>[K.id,K])),G=fS(fe),I=mo(re),$=z.nodes.filter(K=>mo(K)?.scope!=="subgraph"),Z=I?.scope==="subgraph"?I.nodeId:re.id,Q=(()=>{const K=new Set,Te=[Z];if(I?.scope==="subgraph"){const _e=W.get(I.subgraphId),qe=new Map;for(_e?.links?.forEach(Ge=>{const Ve=qe.get(Ge.target_id)??[];Ve.push(Ge.origin_id),qe.set(Ge.target_id,Ve)});Te.length>0;){const Ge=Te.pop();if(Ge===void 0)continue;(qe.get(Ge)??[]).forEach(Je=>{K.has(Je)||(K.add(Je),Te.push(Je))})}return K}for(;Te.length>0;){const _e=Te.pop();if(_e===void 0)continue;const qe=z.nodes.find(Ge=>Ge.id===_e);qe&&qe.inputs?.forEach((Ge,Ve)=>{if(Ge.link===null)return;const Je=va(z,_e,Ve);if(!Je)return;const Ue=Je.node.id;K.has(Ue)||(K.add(Ue),Te.push(Ue))})}return K})(),Me=I?.scope==="subgraph"?I.subgraphId:null;n(K=>{const Te={...K.hiddenItems};for(const Ve of vs(z,K.stableKeyByPointer,se.nodeId,M))delete Te[Ve];Q.forEach(Ve=>{for(const Je of vs(z,K.stableKeyByPointer,Ve,Me))delete Te[Je]});const _e={...K.collapsedItems},qe=(Ve,Je=null)=>{if(Ve!=null)for(const Ue of pu(K.mobileLayout,Ve,Je))delete Te[Ue],delete _e[Ue]},Ge=Ve=>{if(!Ve)return;const Je=gu(z,Ve);Je&&(delete _e[Je],delete Te[Je])};if(!I||I.scope==="root"){const Ve=xl(re.id,$,z.groups??[]);qe(Ve,null),Q.forEach(Je=>{const Ue=xl(Je,$,z.groups??[]);qe(Ue,null)})}else{Ge(I.subgraphId);const Ve=W.get(I.subgraphId);if(Ve){const he=xl(I.nodeId,Ve.nodes??[],Ve.groups??[]);qe(he,I.subgraphId)}const Je=z.extra?.[Jr],Ue=Je&&typeof Je=="object"?Je[I.subgraphId]:void 0;typeof Ue=="number"&&qe(Ue,null),Ve&&Q.forEach(he=>{const Qe=xl(he,Ve.nodes??[],Ve.groups??[]);qe(Qe,I.subgraphId)});const Xe=[I.subgraphId],Pe=new Set;for(;Xe.length>0;){const he=Xe.pop();if(!he||Pe.has(he))continue;Pe.add(he);const Qe=G.get(he)??[];for(const ut of Qe){Ge(ut.parentId);const it=W.get(ut.parentId);if(it){const _t=xl(ut.nodeId,it.nodes??[],it.groups??[]);qe(_t,ut.parentId)}Pe.has(ut.parentId)||Xe.push(ut.parentId)}}}return{hiddenItems:Te,collapsedItems:_e}})},w=(oe,z,U,se)=>{const{workflow:fe,embedWorkflow:M,pointerByStableKey:re}=o();if(!fe)return;const W=Kn(fe,oe);if(!W)return;const G=W.nodeId,I=fe.nodes.map(Se=>Se.id===G?mS(Se,z,U,se):Se),$=I.find(Se=>Se.id===G),Z=M&&$?fa(M,$):M;n({workflow:{...fe,nodes:I},embedWorkflow:Z}),gn.getState().clearNodeError(G)},S=(oe,z)=>{const{workflow:U,embedWorkflow:se,pointerByStableKey:fe}=o();if(!U)return;const M=Kn(U,oe);if(!M)return;const re=M.nodeId,W=U.nodes.map($=>$.id===re?yS($,z):$),G=W.find($=>$.id===re),I=se&&G?fa(se,G):se;n({workflow:{...U,nodes:W},embedWorkflow:I}),gn.getState().clearNodeError(re)},j=(oe,z)=>{const{workflow:U,embedWorkflow:se,pointerByStableKey:fe}=o();if(!U)return;const M=Kn(U,oe);if(!M)return;const re=M.nodeId,W=z?.trim()??"";let G=null;const I=U.nodes.map(Z=>{if(Z.id!==re)return Z;const Se={...Z.properties??{}},Q={...Z,properties:Se};return W?(Q.title=W,Se.title=W):(delete Q.title,delete Se.title),G=Q,Q}),$={...U,nodes:I};n({workflow:$,embedWorkflow:vl(se,G?[G]:[])})},C=oe=>{const{workflow:z,embedWorkflow:U,pointerByStableKey:se}=o();if(!z)return;const fe=Kn(z,oe);if(!fe)return;const M=fe.nodeId;let re=null;const W=z.nodes.map(G=>{if(G.id===M){const $=(G.mode||0)===4?0:4,Z={...G,mode:$};return re=Z,Z}return G});n({workflow:{...z,nodes:W},embedWorkflow:vl(U,re?[re]:[])})},T=(oe,z)=>{const{hiddenItems:U,workflow:se,pointerByStableKey:fe}=o();if(!se)return;const M=Kn(se,oe);if(!M)return;const re=M.nodeId;if(U[oe]&&o().setItemHidden(oe,!1),document.body.dataset.textareaFocus==="true")return;o().setItemCollapsed(oe,!1);const G=(I,$)=>{const Z=document.getElementById(`node-anchor-${re}`)??document.getElementById(`node-${re}`),Se=document.getElementById(`node-card-${re}`)??document.getElementById(`node-${re}`);if(!Z||!Se){I>0?requestAnimationFrame(()=>G(I-1,$)):$>0&&setTimeout(()=>G(10,$-1),200);return}const Q=Z.closest('[data-node-list="true"]');if(Q){const Ge=Z.getBoundingClientRect(),Ve=Q.getBoundingClientRect(),Je=Ge.top-Ve.top,Ue=Math.max(0,Q.scrollTop+Je);Q.scrollTo({top:Ue,behavior:"smooth"})}else Z.scrollIntoView({behavior:"smooth",block:"start"});const Me=Q||window;let K=null;const Te=()=>{document.querySelectorAll(".highlight-pulse").forEach(Ge=>Ge.classList.remove("highlight-pulse")),Se.classList.add("highlight-pulse"),setTimeout(()=>Se.classList.remove("highlight-pulse"),1200),"vibrate"in navigator&&navigator.vibrate(10),z&&window.dispatchEvent(new CustomEvent("node-show-label",{detail:{nodeId:re,label:z}}))},_e=()=>{K&&clearTimeout(K),K=setTimeout(()=>{qe(),Te()},120)},qe=()=>{K&&(clearTimeout(K),K=null),Me.removeEventListener("scroll",_e)};Me.addEventListener("scroll",_e,{passive:!0}),K=setTimeout(()=>{qe(),Te()},200)};G(10,2)},R=(oe,z,U,se)=>{n(fe=>{const M=Date.now(),re=oe&&z&&fe.workflow?(()=>{const Q=Kn(fe.workflow,z,fe.pointerByStableKey);return Q?String(Q.nodeId):null})():null,W=oe?U??fe.executingPromptId:null,G=oe?re??fe.executingNodeId:null,I={isExecuting:oe,executingNodeId:G,executingPromptId:W,progress:se},$=(Q,Me)=>{if(!Q||Me<=0||fe.workflow?.nodes.find(Ve=>String(Ve.id)===Q)?.mode===4)return fe.nodeDurationStats;const Te=String(Q),_e=fe.nodeDurationStats[Te],qe=(_e?.count??0)+1,Ge=_e?(_e.avgMs*_e.count+Me)/qe:Me;return{...fe.nodeDurationStats,[Te]:{avgMs:Ge,count:qe}}};if(!oe){if(fe.currentNodeStartTime&&fe.executingNodeId){const Q=M-fe.currentNodeStartTime;I.nodeDurationStats=$(fe.executingNodeId,Q)}if(fe.executionStartTime&&fe.workflow){const Q=M-fe.executionStartTime,Me=Pu(fe.workflow),K=fe.workflowDurationStats[Me],Te=(K?.count??0)+1,_e=K?(K.avgMs*K.count+Q)/Te:Q;I.workflowDurationStats={...fe.workflowDurationStats,[Me]:{avgMs:_e,count:Te}}}return I.executionStartTime=null,I.currentNodeStartTime=null,I}const Z=W&&W!==fe.executingPromptId,Se=G&&G!==fe.executingNodeId;if(Z&&(I.executionStartTime=M,I.currentNodeStartTime=M),Se&&fe.currentNodeStartTime&&fe.executingNodeId){const Q=M-fe.currentNodeStartTime;I.nodeDurationStats=$(fe.executingNodeId,Q),I.currentNodeStartTime=M}else fe.currentNodeStartTime||(I.currentNodeStartTime=M);return I})},D=oe=>{n(z=>{const U=Sy(oe),se=To(U,z.stableKeyByPointer,z.pointerByStableKey);return{workflow:z.workflow?Yn(z.workflow,se.layoutToStable):z.workflow,mobileLayout:U,stableKeyByPointer:se.layoutToStable,pointerByStableKey:se.stableToLayout}})},L=(oe,z,U)=>{const{currentFilename:se,savedWorkflowStates:fe,nodeTypes:M,stableKeyByPointer:re,pointerByStableKey:W}=o(),G=U?.fresh??!1,I=U?.source??{type:"other"};gn.getState().clearNodeErrors();const $=B2(oe),Z=ro(oe),Se=up($.nodes),Q={...$,nodes:Se,links:$.links??[],groups:$.groups??[],config:$.config??{},last_node_id:$.last_node_id??Math.max(0,...Se.map(Je=>Je.id)),last_link_id:$.last_link_id??0,version:$.version??.4},Me=yu(Q,re),K=Tf(Q,M),Te=yo.getState(),_e=z?Te.pinnedWidgets[z]:void 0;if(_e&&!Te.pinnedWidgets[K]&&Te.setPinnedWidget(_e,K),Te.restorePinnedWidgetForWorkflow(K,Me),se&&o().saveCurrentWorkflowState(),G&&fe[K]){const Je={...fe};delete Je[K],n({savedWorkflowStates:Je})}const qe={};if(M)for(const Je of Me.nodes)ba(Me,M,Je)!==null&&(qe[Je.id]=_f(Me,M,Je));let Ge=G?null:fe[K];!Ge&&!G&&z&&fe[z]&&(Ge=fe[z],n({savedWorkflowStates:{...fe,[K]:fe[z]}}));let Ve=Me;if(Ge){Ve=(M?Ey(Me,M):{workflow:Me}).workflow;const Ue=If(Ve,o().hiddenItems),Xe={...Ge.collapsedItems??{}},Pe={...Ge.hiddenItems??{}},he=Zr(Ve,Ue),Qe=To(he,re,W),ut=Lf(Ue,Qe.layoutToStable),it=iS(Xe,Qe.layoutToStable),_t=Lf(Pe,Qe.layoutToStable),Ot=yl({...Xe,...it},Qe.layoutToStable,Qe.stableToLayout),wt=mu({...Pe,..._t},Qe.layoutToStable,Qe.stableToLayout),It={},Kt=Yn(Ve,Qe.layoutToStable);Ve=Kt;let pt=Z;if(pt)for(const Lt of Kt.nodes)pt=fa(pt,Lt);n({workflowSource:I,workflow:Kt,embedWorkflow:pt,originalWorkflow:JSON.parse(JSON.stringify(Kt)),currentFilename:z||null,currentWorkflowKey:K,collapsedItems:{...It,...Ot},hiddenItems:{...wt,...ut},mobileLayout:he,stableKeyByPointer:Qe.layoutToStable,pointerByStableKey:Qe.stableToLayout,runCount:1,followQueue:!1,workflowLoadedAt:Date.now()}),Qn.getState().setSeedModes(qe),Qn.getState().setSeedLastValues({}),ao.getState().setCurrentPanel("workflow"),Eo.getState().setViewerState({viewerOpen:!1,viewerImages:[],viewerIndex:0,viewerScale:1,viewerTranslate:{x:0,y:0}})}else{const Je=o(),Ue=Je.currentWorkflowKey===K,Xe=If(Me,o().hiddenItems),Pe=Zr(Me,Xe),he=To(Pe,re,W),Qe=Lf(Xe,he.layoutToStable),ut={},it=Ue?yl(Je.collapsedItems,he.layoutToStable,he.stableToLayout):{};gn.getState().setError(null),Ve=(M?Ey(Me,M):{workflow:Me}).workflow;const Ot=Yn(Ve,he.layoutToStable);let wt=Z;if(wt)for(const It of Ot.nodes)wt=fa(wt,It);n({workflowSource:I,workflow:Ot,embedWorkflow:wt,originalWorkflow:JSON.parse(JSON.stringify(Ot)),currentFilename:z||null,currentWorkflowKey:K,collapsedItems:{...ut,...it},mobileLayout:Pe,stableKeyByPointer:he.layoutToStable,pointerByStableKey:he.stableToLayout,hiddenItems:Qe,runCount:1,followQueue:!1,workflowLoadedAt:Date.now()}),Qn.getState().setSeedModes(qe),Qn.getState().setSeedLastValues({}),ao.getState().setCurrentPanel("workflow"),Eo.getState().setViewerState({viewerOpen:!1,viewerImages:[],viewerIndex:0,viewerScale:1,viewerTranslate:{x:0,y:0}})}if(M){const Je=bS(Ve,M),Ue=Object.values(Je).reduce((Xe,Pe)=>Xe+Pe.length,0);Ue>0?(s(Je),gn.getState().setError(`Workflow load error: ${Ue} input${Ue===1?"":"s"} reference missing options.`)):gn.getState().clearNodeErrors()}},B=()=>{const{currentWorkflowKey:oe,savedWorkflowStates:z}=o();if(oe){const U={...z};delete U[oe],n({savedWorkflowStates:U})}gn.getState().clearNodeErrors(),n({workflowSource:null,workflow:null,embedWorkflow:null,originalWorkflow:null,currentFilename:null,currentWorkflowKey:null,collapsedItems:{},hiddenItems:{},mobileLayout:Iu(),stableKeyByPointer:{},pointerByStableKey:{},runCount:1,nodeOutputs:{},nodeTextOutputs:{},promptOutputs:{},followQueue:!1,workflowLoadedAt:Date.now(),connectionHighlightModes:{}}),Qn.getState().clearSeedState(),yo.getState().clearCurrentPin(),ao.getState().setCurrentPanel("workflow"),Eo.getState().setViewerState({viewerOpen:!1,viewerImages:[],viewerIndex:0,viewerScale:1,viewerTranslate:{x:0,y:0}})},A=(oe,z)=>{gn.getState().setError(null);const U=Tf(oe,o().nodeTypes),se=Zr(oe,bl(o().hiddenItems,o().pointerByStableKey)),fe=To(se,o().stableKeyByPointer,o().pointerByStableKey),M=Yn(oe,fe.layoutToStable);n({workflow:M,embedWorkflow:ro(M),originalWorkflow:JSON.parse(JSON.stringify(M)),currentFilename:z,currentWorkflowKey:U,mobileLayout:se,stableKeyByPointer:fe.layoutToStable,pointerByStableKey:fe.stableToLayout})},F=oe=>{n({nodeTypes:oe});const{workflow:z,currentWorkflowKey:U,currentFilename:se,savedWorkflowStates:fe}=o();if(!z)return;const M=Tf(z,oe);if(U===M)return;const re={...fe};U&&re[U]&&!re[M]?(re[M]=re[U],delete re[U]):!U&&se&&re[se]&&!re[M]&&(re[M]=re[se]);const W=yo.getState(),G=se?W.pinnedWidgets[se]:void 0,I=U?W.pinnedWidgets[U]:void 0;G&&!W.pinnedWidgets[M]?W.setPinnedWidget(G,M):I&&!W.pinnedWidgets[M]&&W.setPinnedWidget(I,M),n({currentWorkflowKey:M,savedWorkflowStates:re}),W.restorePinnedWidgetForWorkflow(M,z)},te=()=>{const{workflow:oe,currentWorkflowKey:z,savedWorkflowStates:U,collapsedItems:se,hiddenItems:fe}=o(),M=Qn.getState().seedModes;if(!oe||!z)return;const re=U[z]?.bookmarkedItems??[],W={};for(const G of oe.nodes)W[G.id]={mode:G.mode,flags:G.flags?{collapsed:!!G.flags.collapsed}:void 0,widgets_values:G.widgets_values};n({savedWorkflowStates:{...U,[z]:{nodes:W,seedModes:{...M},collapsedItems:{...se},hiddenItems:{...fe},bookmarkedItems:[...re]}}})},ee=()=>{n({nodeOutputs:{},nodeTextOutputs:{}})},ae=(oe,z)=>{!oe||z.length===0||n(U=>({promptOutputs:{...U.promptOutputs,[oe]:[...U.promptOutputs[oe]??[],...z]}}))},ne=oe=>{if(!oe){n({promptOutputs:{}});return}n(z=>{if(!z.promptOutputs[oe])return z;const U={...z.promptOutputs};return delete U[oe],{promptOutputs:U}})},me=oe=>{n({runCount:Math.max(1,Math.floor(oe))})},Le=oe=>{n({followQueue:oe})},P=()=>{n(oe=>({connectionButtonsVisible:!oe.connectionButtonsVisible}))},V=()=>{n({hiddenItems:{}})},H=(oe,z)=>{n(U=>{const se=U.stableKeyByPointer[oe]??oe,fe=U.pointerByStableKey[se],M={...U.collapsedItems};return z?M[se]=!0:(delete M[oe],delete M[se],fe&&delete M[fe]),{collapsedItems:M}})},ce=(oe,z)=>{const{workflow:U,embedWorkflow:se,pointerByStableKey:fe}=o();if(!U)return;const M=hu(U,oe);if(!M)return;if(M.type==="group"){const $=dp(U,M.groupId,M.subgraphId);if($.size===0)return;const Z=z?4:0,Se=[],Q=(U.nodes??[]).map(Me=>$.has(Me.id)?(()=>{const K={...Me,mode:Z};return Se.push(K),K})():Me);n({workflow:{...U,nodes:Q},embedWorkflow:vl(se,Se)});return}if(M.type!=="subgraph")return;const re=Oy(U,M.subgraphId);if(re.size===0)return;const W=z?4:0,G=[],I=(U.nodes??[]).map($=>re.has($.id)?(()=>{const Z={...$,mode:W};return G.push(Z),Z})():$);n({workflow:{...U,nodes:I},embedWorkflow:vl(se,G)})},ke=(oe,z)=>{const{workflow:U,embedWorkflow:se,stableKeyByPointer:fe,pointerByStableKey:M}=o();if(!U)return;const re=hu(U,oe);if(!re)return;if(re.type==="group"){const{hiddenItems:pt,connectionHighlightModes:Lt,mobileLayout:Gt,collapsedItems:xe}=o(),J=re.groupId,be=re.subgraphId??null,Ie=pu(Gt,J,be),Be=new Set(Ie);Be.add(re.stableKey);const We=Be.size>0?[...Be]:[re.stableKey],lt=z?.deleteNodes??!1?dp(U,J,be):new Set;let st=U;if(be){const Qt=(U.definitions?.subgraphs??[]).map(en=>en.id!==be?en:{...en,groups:(en.groups??[]).filter(Yt=>Yt.id!==J)});st={...U,definitions:{...U.definitions??{},subgraphs:Qt}}}else{let kt=U.extra;const Qt=U.extra?.[Jr];if(Qt&&typeof Qt=="object"){let en=!1;const Yt={};for(const[Y,Re]of Object.entries(Qt))Re===J?(Yt[Y]=null,en=!0):Yt[Y]=Re;en&&(kt={...U.extra??{},[Jr]:Yt})}st={...U,groups:(U.groups??[]).filter(en=>en.id!==J),extra:kt}}lt.size>0&&(st=Ty(st,lt));const at={...pt},ct={...Lt};for(const kt of lt){for(const Qt of vs(U,fe,kt))delete at[Qt];for(const Qt of Cl(U,kt))delete at[Qt];delete ct[kt]}let dt=Gt;for(const kt of lt)dt=by(dt,kt);for(const kt of We)dt=Q2(dt,kt);const nt={...xe};for(const kt of We)delete nt[kt],delete at[kt];const bt=To(dt,fe,M),gt=Yn(st,bt.layoutToStable);n({workflow:gt,embedWorkflow:se&&ro(gt),hiddenItems:at,connectionHighlightModes:ct,mobileLayout:dt,stableKeyByPointer:bt.layoutToStable,pointerByStableKey:bt.stableToLayout,collapsedItems:nt});return}if(re.type!=="subgraph")return;const{hiddenItems:W,connectionHighlightModes:G,mobileLayout:I,collapsedItems:$}=o(),Z=z?.deleteNodes??!1,Se=re.subgraphId,Q=U.definitions?.subgraphs??[],Me=Q.find(pt=>pt.id===Se);if(!Me)return;const Te=ox(I,{type:"subgraph",id:Se}),_e=Te?hS(Te.containerId,I):null;if(Z){const pt=ax(U),Lt=Gu([Se],pt),Gt=Oy(U,Se),xe={...W},J={...G};for(const nt of Gt){for(const bt of vs(U,fe,nt))delete xe[bt];for(const bt of Cl(U,nt))delete xe[bt];delete J[nt]}const be=Q.filter(nt=>!Lt.has(nt.id));let Ie=U.extra;const Be=U.extra?.[Jr];if(Be&&typeof Be=="object"){const nt={};for(const[bt,gt]of Object.entries(Be))Lt.has(bt)||(nt[bt]=gt);Ie={...U.extra??{},[Jr]:nt}}let We=Ty(U,Gt);We={...We,definitions:{...We.definitions??{},subgraphs:be},extra:Ie};const Oe=Zr(We,bl(xe,M)),lt=To(Oe,fe,M),st=Yn(We,lt.layoutToStable),at={...$},ct={...xe},dt=new Set(Q.filter(nt=>Lt.has(nt.id)).map(nt=>nt.stableKey).filter(nt=>typeof nt=="string"));for(const nt of dt)delete at[nt],delete ct[nt];n({workflow:st,embedWorkflow:se&&ro(st),hiddenItems:ct,connectionHighlightModes:J,mobileLayout:Oe,stableKeyByPointer:lt.layoutToStable,pointerByStableKey:lt.stableToLayout,collapsedItems:at});return}const qe=_e==null?U.groups??[]:Q.find(pt=>pt.id===_e)?.groups??[],{idMap:Ge,promotedGroups:Ve}=gS(Me.groups??[],qe),Je=(U.nodes??[]).map(pt=>{const Lt=mo(pt);if(Lt?.scope!=="subgraph"||Lt.subgraphId!==Se)return pt;const Gt={...pt.properties??{}};return Gt[Fu]=_e==null?{scope:"root",nodeId:Lt.nodeId}:{scope:"subgraph",subgraphId:_e,nodeId:Lt.nodeId},{...pt,properties:Gt}}),Ue=Q.filter(pt=>pt.id!==Se).map(pt=>_e!=null&&pt.id===_e?{...pt,groups:[...pt.groups??[],...Ve]}:pt);let Xe=U.groups??[];_e==null&&Ve.length>0&&(Xe=[...Xe,...Ve]);let Pe=U.extra;const he=U.extra?.[Jr];if(he&&typeof he=="object"){const pt={};for(const[Lt,Gt]of Object.entries(he))Lt!==Se&&(pt[Lt]=Gt);Pe={...U.extra??{},[Jr]:pt}}const Qe={...U,nodes:Je,groups:Xe,definitions:{...U.definitions??{},subgraphs:Ue},extra:Pe},ut=Zr(Qe,bl(W,M)),it=To(ut,fe,M),_t={...$},Ot={...W},wt=Me.stableKey??gu(U,Se);wt&&(delete _t[wt],delete Ot[wt]);const It=pt=>{const Lt={};for(const[Gt,xe]of Object.entries(pt)){if(!xe)continue;const J=hu(U,Gt);if(J?.type==="group"&&J.subgraphId===Se){const be=Ge.get(J.groupId);if(be==null)continue;const Ie=pu(ut,be,_e);for(const Be of Ie)Lt[Be]=!0;continue}Lt[Gt]=!0}return Lt},Kt=Yn(Qe,it.layoutToStable);n(()=>({workflow:Kt,embedWorkflow:se&&ro(Kt),mobileLayout:ut,stableKeyByPointer:it.layoutToStable,pointerByStableKey:it.stableToLayout,collapsedItems:It(_t),hiddenItems:Ot}))},Ne=(oe,z)=>{const{workflow:U,pointerByStableKey:se}=o();if(!U)return;const fe=hu(U,oe);if(!fe)return;const M=z.trim();if(fe.type==="group"){const{groupId:re,subgraphId:W}=fe;if(W){const Z=(U.definitions?.subgraphs??[]).map(Q=>{if(Q.id!==W)return Q;const K=(Q.groups??[]).map(Te=>Te.id===re?{...Te,title:M}:Te);return{...Q,groups:K}});gn.getState().setError(null);const Se={...U,definitions:{...U.definitions??{},subgraphs:Z}};n({workflow:Se,embedWorkflow:ro(Se)});return}const G=(U.groups??[]).map($=>$.id===re?{...$,title:M}:$),I={...U,groups:G};n({workflow:I,embedWorkflow:ro(I)});return}if(fe.type==="subgraph"){const re=fe.subgraphId,G=(U.definitions?.subgraphs??[]).map($=>$.id===re?{...$,name:M}:$),I={...U,definitions:{...U.definitions??{},subgraphs:G}};n({workflow:I,embedWorkflow:ro(I)})}},O=oe=>{n({searchQuery:oe})},_=oe=>{n({searchOpen:oe})},q=oe=>{n({addNodeModalRequest:{id:++tS,groupId:oe?.groupId??null,subgraphId:oe?.subgraphId??null}})},je=()=>{n({addNodeModalRequest:null})},Ke=oe=>{n(z=>{const U=pS(z.mobileLayout,oe);if(!U)return{};const se={...z.collapsedItems};for(const fe of U.groupKeys)delete se[fe];for(const fe of U.subgraphIds){const M=z.workflow?gu(z.workflow,fe):null;M&&delete se[M]}if(oe.type==="group")for(const fe of pu(z.mobileLayout,oe.id,oe.subgraphId??null))se[fe]=!0;else if(oe.type==="subgraph"){const fe=z.workflow?gu(z.workflow,oe.id):null;fe&&(se[fe]=!0)}return{collapsedItems:se}})},De=(oe,z)=>{!oe||z<=0||n(U=>{const se=U.workflowDurationStats[oe],fe=(se?.count??0)+1,M=se?(se.avgMs*se.count+z)/fe:z;return{workflowDurationStats:{...U.workflowDurationStats,[oe]:{avgMs:M,count:fe}}}})},Fe=()=>{const{currentWorkflowKey:oe,savedWorkflowStates:z,originalWorkflow:U,nodeTypes:se}=o(),fe={...z};if(oe?(delete fe[oe],yo.getState().clearPinnedWidgetForKey(oe)):yo.getState().clearCurrentPin(),!U){Qn.getState().setSeedModes({}),Qn.getState().setSeedLastValues({}),n({savedWorkflowStates:fe});return}const M={};if(se)for(const W of U.nodes)ba(U,se,W)!==null&&(M[W.id]=_f(U,se,W));const re=JSON.parse(JSON.stringify(U));Qn.getState().setSeedModes(M),Qn.getState().setSeedLastValues({}),gn.getState().setError(null),n({savedWorkflowStates:fe,...(()=>{const W=Zr(re,bl(o().hiddenItems,o().pointerByStableKey)),G=To(W,{},{}),I=Yn(re,G.layoutToStable);return{workflow:I,embedWorkflow:ro(I),mobileLayout:W,stableKeyByPointer:G.layoutToStable,pointerByStableKey:G.stableToLayout}})(),runCount:1,workflowLoadedAt:Date.now()})},ue=()=>{const{workflow:oe,originalWorkflow:z,stableKeyByPointer:U,pointerByStableKey:se,mobileLayout:fe,hiddenItems:M,collapsedItems:re,embedWorkflow:W}=o();if(!oe||!cp(oe)&&!My(oe,fe))return!1;const G=yu(oe,U),I=Zr(G,bl(M,se)),$=To(I,U,se),Z=Yn(G,$.layoutToStable),Se=z&&Yn(z,$.layoutToStable),Q=mu(M,$.layoutToStable,$.stableToLayout),Me=yl(re,$.layoutToStable,$.stableToLayout);return cp(Z)||My(Z,I)?!1:(n({workflow:Z,originalWorkflow:Se,embedWorkflow:W&&ro(Z),mobileLayout:fe===I?fe:I,stableKeyByPointer:$.layoutToStable,pointerByStableKey:$.stableToLayout,hiddenItems:Q,collapsedItems:Me}),!0)},ye=()=>{const{workflow:oe,embedWorkflow:z}=o();if(!oe)return;let U=!1;const se=oe.nodes.map(fe=>{if(fe.type==="PrimitiveNode"){if(!Array.isArray(fe.widgets_values))return fe;const M=fe.outputs?.[0]?.type,re=String(M).toUpperCase();if(re!=="INT"&&re!=="FLOAT")return fe;const W=fe.widgets_values?.[1];if(!W||W==="fixed")return fe;const G=fe.widgets_values?.[0];if(typeof G!="number")return fe;let I=G;if(W==="increment"?I=re==="INT"?G+1:G+.01:W==="decrement"?I=re==="INT"?G-1:G-.01:W==="randomize"&&(I=re==="INT"?Math.floor(Math.random()*0xffffffffffff):Math.random()),I!==G){U=!0;const $=[...fe.widgets_values];return $[0]=I,{...fe,widgets_values:$}}}return fe});if(U){const fe=se.filter((M,re)=>M!==oe.nodes[re]);n({workflow:{...oe,nodes:se},embedWorkflow:vl(z,fe)})}},et=async oe=>{const z=Qn.getState(),U=z.seedModes,se=z.seedLastValues,{workflow:fe,nodeTypes:M,embedWorkflow:re}=o();if(!fe||!M){gn.getState().setError("Node types are still loading. Try again in a moment.");return}gn.getState().setError(null),n({isLoading:!0});try{let W=fe,G=re,I={...se};for(let $=0;$<oe;$++){const Z={},Se=W.nodes.map(_e=>{const qe=ba(W,M,_e);if(qe===null||!Array.isArray(_e.widgets_values))return _e;const Ge=U[_e.id]??_f(W,M,_e),Ve=qe+1;if(typeof _e.widgets_values[Ve]=="string"){if(!Ge||Ge==="fixed")return _e;const Qe=Number(_e.widgets_values[qe])||0;let ut;switch(Ge){case"randomize":ut=Ol(M,_e);break;case"increment":ut=Qe+1;break;case"decrement":ut=Qe-1;break;default:return _e}const it=[..._e.widgets_values];return it[qe]=ut,{..._e,widgets_values:it}}const Xe=Number(_e.widgets_values[qe]),Pe=I[_e.id]??null;let he=null;return Vp(Xe)?he=E2(Xe,Pe,M,_e):Ge&&Ge!=="fixed"&&(Ge==="randomize"?he=Ol(M,_e):Ge==="increment"?he=(typeof Pe=="number"?Pe:Xe)+1:Ge==="decrement"&&(he=(typeof Pe=="number"?Pe:Xe)-1)),he===null||(Z[_e.id]=he,I={...I,[_e.id]:he}),_e});if(W={...W,nodes:Se},G){let _e=G;for(const qe of Se)_e=fa(_e,qe);G=_e}z.setSeedLastValues(I),n({workflow:W,embedWorkflow:G});const Q={},Me=new Set,K=new Map;for(const _e of W.nodes){if(_e.mode===4)continue;let qe=null;if(M[_e.type])qe=_e.type;else{const Ge=Object.entries(M).find(([,Ve])=>Ve.display_name===_e.type||Ve.name===_e.type);Ge&&(qe=Ge[0])}qe&&(Me.add(_e.id),K.set(_e.id,qe))}for(const _e of W.nodes){if(_e.mode===4)continue;const qe=K.get(_e.id);if(!qe)continue;const Ge=k2(W,M,_e,qe,Me,lc(W,_e.id),Z);Q[String(_e.id)]={class_type:qe,inputs:Ge}}const Te=await fetch(`${sn}/api/prompt`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:Q,client_id:Vb,extra_data:{extra_pnginfo:{workflow:qu(G??W)}}})});if(!Te.ok){const _e=await Te.json(),qe={};if(_e.node_errors)for(const[Ge,Ve]of Object.entries(_e.node_errors)){const Je=Ve.errors;Je&&Je.length>0&&(qe[Ge]=Je.map(Ue=>({type:Ue.type,message:Ue.message,details:Ue.details,inputName:Ue.extra_info?.input_name})))}throw Object.keys(qe).length>0&&s(qe),new Error(_e.error?.message||"Failed to queue prompt")}gn.getState().clearNodeErrors()}}catch(W){gn.getState().setError(W instanceof Error?W.message:"Failed to queue workflow")}finally{Ht.getState().fetchQueue(),n({isLoading:!1})}};return{workflowSource:null,workflow:null,embedWorkflow:null,originalWorkflow:null,currentFilename:null,currentWorkflowKey:null,nodeTypes:null,isLoading:!1,savedWorkflowStates:{},isExecuting:!1,executingNodeId:null,executingPromptId:null,progress:0,executionStartTime:null,currentNodeStartTime:null,nodeDurationStats:{},workflowDurationStats:{},nodeOutputs:{},nodeTextOutputs:{},promptOutputs:{},runCount:1,followQueue:!1,workflowLoadedAt:0,connectionHighlightModes:{},connectionButtonsVisible:!0,searchQuery:"",searchOpen:!1,addNodeModalRequest:null,collapsedItems:{},hiddenItems:{},stableKeyByPointer:{},pointerByStableKey:{},mobileLayout:Iu(),setMobileLayout:D,addNode:d,addNodeAndConnect:h,deleteNode:a,deleteContainer:ke,connectNodes:l,disconnectInput:c,setNodeOutput:p,setNodeTextOutput:m,clearNodeOutputs:ee,requestAddNodeModal:q,clearAddNodeModalRequest:je,toggleBypass:C,bypassAllInContainer:ce,updateNodeWidget:w,updateNodeWidgets:S,updateNodeTitle:j,updateContainerTitle:Ne,setExecutionState:R,addPromptOutputs:ae,clearPromptOutputs:ne,queueWorkflow:et,applyControlAfterGenerate:ye,setRunCount:me,setFollowQueue:Le,cycleConnectionHighlight:y,setConnectionHighlightMode:x,toggleConnectionButtonsVisible:P,setSearchQuery:O,setSearchOpen:_,prepareRepositionScrollTarget:Ke,scrollToNode:T,setItemHidden:v,revealNodeWithParents:k,showAllHiddenNodes:V,setItemCollapsed:H,setNodeTypes:F,loadWorkflow:L,unloadWorkflow:B,setSavedWorkflow:A,clearWorkflowCache:Fe,ensureStableKeysAndRepair:ue,updateWorkflowDuration:De,saveCurrentWorkflowState:te}},{name:"workflow-storage",storage:Cr(()=>localStorage),partialize:n=>({workflow:n.workflow,embedWorkflow:n.embedWorkflow,originalWorkflow:n.originalWorkflow,currentFilename:n.currentFilename,currentWorkflowKey:n.currentWorkflowKey,savedWorkflowStates:n.savedWorkflowStates,runCount:n.runCount,hiddenItems:n.hiddenItems,collapsedItems:n.collapsedItems,stableKeyByPointer:n.stableKeyByPointer,pointerByStableKey:n.pointerByStableKey,connectionButtonsVisible:n.connectionButtonsVisible,mobileLayout:n.mobileLayout,isExecuting:n.isExecuting,executingNodeId:n.executingNodeId,executingPromptId:n.executingPromptId,progress:n.progress,executionStartTime:n.executionStartTime,currentNodeStartTime:n.currentNodeStartTime,nodeDurationStats:n.nodeDurationStats,workflowDurationStats:n.workflowDurationStats}),onRehydrateStorage:()=>n=>{if(n)if(n.workflow){const o=yu(n.workflow,n.stableKeyByPointer??{}),s=n.mobileLayout?Sy(n.mobileLayout):null,a=If(o,n.hiddenItems??{});n.mobileLayout=s&&oS(s,o)?s:Zr(o,a);const l=To(n.mobileLayout,n.stableKeyByPointer??{},n.pointerByStableKey??{});if(n.workflow=Yn(o,l.layoutToStable),n.originalWorkflow){const d=yu(n.originalWorkflow,n.stableKeyByPointer??{});n.originalWorkflow=Yn(d,l.layoutToStable)}n.stableKeyByPointer=l.layoutToStable,n.pointerByStableKey=l.stableToLayout,n.hiddenItems=mu(n.hiddenItems,l.layoutToStable,l.stableToLayout),n.collapsedItems=yl(n.collapsedItems,l.layoutToStable,l.stableToLayout);const c=n.currentWorkflowKey;if(c&&n.savedWorkflowStates&&n.savedWorkflowStates[c]){const d=n.savedWorkflowStates[c],h=yl(d.collapsedItems,l.layoutToStable,l.stableToLayout),p=mu(d.hiddenItems,l.layoutToStable,l.stableToLayout),m=uS(d.bookmarkedItems,l.layoutToStable,l.stableToLayout);n.savedWorkflowStates={...n.savedWorkflowStates,[c]:{...d,collapsedItems:h,hiddenItems:p,bookmarkedItems:m}}}}else n.mobileLayout=Iu(),n.stableKeyByPointer={},n.pointerByStableKey={}}}));function Pu(n){const o=[...n.nodes].sort((s,a)=>s.id-a.id).map(s=>({id:s.id,type:s.type,mode:s.mode,inputs:s.inputs?.map(a=>a.link??null)??[],outputs:s.outputs?.map(a=>a.links??[])??[]}));return JSON.stringify({nodes:o,links:n.links??[]})}const fp=vo(n=>({appMenuOpen:!1,setAppMenuOpen:o=>n({appMenuOpen:o})})),qn=vo((n,o)=>({history:[],isLoading:!1,addHistoryEntry:s=>{n(l=>l.history.some(c=>c.prompt_id===s.prompt_id)?l:{history:[s,...l.history]});const a=Ht.getState();if(a.queueItemExpanded[s.prompt_id]===void 0&&a.setQueueItemExpanded(s.prompt_id,!0),s.workflow&&s.durationSeconds){const l=Pu(s.workflow);de.getState().updateWorkflowDuration(l,s.durationSeconds*1e3)}},fetchHistory:async()=>{n({isLoading:!0});try{const s=await Ww(50),a=Object.entries(s).map(([c,d])=>{const h=[];for(const j of Object.values(d.outputs))j.images&&h.push(...j.images),j.gifs&&h.push(...j.gifs),j.videos&&h.push(...j.videos);let p=Date.now(),m=null,y=null,x=!1;if(d.status?.messages)for(const[j,C]of d.status.messages)j==="execution_start"&&C.timestamp&&(p=C.timestamp,m=C.timestamp),(j==="execution_end"||j==="execution_success")&&C.timestamp&&(y=C.timestamp),j==="execution_error"&&(x=!0);m===null&&p&&(m=p);const v=m!==null&&y!==null&&y>=m?(y-m)/1e3:void 0,k=d.status?.status_str?.toLowerCase()||"",w=!x&&d.status?.completed!==!1&&!k.includes("error"),S=d.prompt?.[3]?.extra_pnginfo?.workflow;return{prompt_id:c,timestamp:p,durationSeconds:v,success:w,outputs:{images:h},prompt:d.prompt[2],workflow:S}});a.sort((c,d)=>d.timestamp-c.timestamp),n({history:a});const l=Ht.getState();for(const c of a)if(l.queueItemExpanded[c.prompt_id]===void 0&&l.setQueueItemExpanded(c.prompt_id,!0),c.workflow&&c.durationSeconds){const d=Pu(c.workflow);de.getState().updateWorkflowDuration(d,c.durationSeconds*1e3)}}catch(s){console.error("Failed to fetch history:",s)}finally{n({isLoading:!1})}},deleteItem:async s=>{try{await Zw(s),n(a=>({history:a.history.filter(l=>l.prompt_id!==s)}))}catch(a){console.error("Failed to delete history item:",a)}},clearHistory:async()=>{try{await Jw()}catch(s){console.error("Failed to clear history:",s);try{const a=o().history.map(l=>l.prompt_id);await sy(a)}catch(a){console.error("Failed to delete history items:",a)}}finally{n({history:[]})}},clearEmptyItems:async()=>{const s=o().history.filter(a=>a.outputs.images.length===0).map(a=>a.prompt_id);if(s.length!==0)try{await sy(s),n(a=>({history:a.history.filter(l=>!s.includes(l.prompt_id))}))}catch(a){console.error("Failed to delete empty history items:",a)}}})),Jt=vo()(jr((n,o)=>({source:"output",currentFolder:null,folders:[],files:[],isLoading:!1,error:null,viewMode:"grid",showHidden:!1,filter:{search:"",favoritesOnly:!1,type:"all"},sort:{mode:"modified"},favorites:[],selectionMode:!1,selectedIds:[],selectionActionOpen:!1,filterModalOpen:!1,newFolderModalOpen:!1,outputsViewerOpen:!1,setSource:s=>{n({source:s,currentFolder:null,files:[],folders:[],selectionMode:!1,selectedIds:[]}),o().fetchFolders(),o().fetchFiles()},setCurrentFolder:s=>{const{currentFolder:a}=o(),l=a?`${a}/${s}`:s;n({currentFolder:l,files:[],selectionMode:!1,selectedIds:[]}),o().fetchFiles()},navigateToPath:s=>{n({currentFolder:s,files:[],selectionMode:!1,selectedIds:[]}),o().fetchFiles()},navigateUp:()=>{const{currentFolder:s}=o();if(!s)return;const a=s.split("/");a.pop();const l=a.length>0?a.join("/"):null;n({currentFolder:l,files:[],selectionMode:!1,selectedIds:[]}),o().fetchFiles()},fetchFolders:async()=>{try{const{showHidden:s}=o(),a=await t2(s),{source:l}=o();n({folders:l==="output"?a.output:a.input})}catch(s){console.error("Failed to fetch folders:",s)}},fetchFiles:async()=>{const{source:s,currentFolder:a,sort:l,showHidden:c}=o();n({isLoading:!0,error:null});try{const d=await rp(s,1e3,0,l.mode,!1,a,c);n({files:d,isLoading:!1})}catch(d){n({error:d.message,isLoading:!1})}},setFilter:s=>{n(a=>({filter:{...a.filter,...s}}))},setSort:s=>{n({sort:s}),o().fetchFiles()},setViewMode:s=>{n({viewMode:s})},toggleShowHidden:()=>{n(s=>({showHidden:!s.showHidden})),o().fetchFolders(),o().fetchFiles()},toggleFavorite:s=>{n(a=>({favorites:a.favorites.includes(s)?a.favorites.filter(c=>c!==s):[...a.favorites,s]}))},toggleSelectionMode:()=>{n(s=>({selectionMode:!s.selectionMode,selectedIds:[],selectionActionOpen:!1}))},toggleSelection:s=>{n(a=>({selectedIds:a.selectedIds.includes(s)?a.selectedIds.filter(c=>c!==s):[...a.selectedIds,s]}))},selectAll:()=>{const s=o().getDisplayedFiles();n({selectedIds:s.map(a=>a.id)})},selectIds:(s,a="add")=>{n(l=>{if(a==="replace")return{selectedIds:[...s]};const c=new Set(l.selectedIds);return s.forEach(d=>c.add(d)),{selectedIds:Array.from(c)}})},clearSelection:()=>{n({selectedIds:[],selectionActionOpen:!1})},setSelectionActionOpen:s=>{n({selectionActionOpen:s})},setFilterModalOpen:s=>{n({filterModalOpen:s})},setNewFolderModalOpen:s=>{n({newFolderModalOpen:s})},setOutputsViewerOpen:s=>{n({outputsViewerOpen:s})},addFavorites:s=>{n(a=>{const l=new Set(a.favorites);return s.forEach(c=>l.add(c)),{favorites:Array.from(l)}})},removeFavorites:s=>{n(a=>({favorites:a.favorites.filter(l=>!s.includes(l))}))},refresh:()=>{o().fetchFolders(),o().fetchFiles()},getDisplayedFiles:()=>{const{files:s,filter:a,favorites:l,showHidden:c,sort:d}=o();let h=[...s];if(c||(h=h.filter(m=>!m.name.startsWith("."))),a.search){const m=a.search.toLowerCase();h=h.filter(y=>y.name.toLowerCase().includes(m))}a.favoritesOnly&&(h=h.filter(m=>l.includes(m.id))),a.type!=="all"&&(h=h.filter(m=>m.type==="folder"||m.type===a.type));const p=d.mode.endsWith("-reverse")?-1:1;return d.mode.startsWith("name")?h.sort((m,y)=>m.name.localeCompare(y.name)*p):d.mode.startsWith("size")?h.sort((m,y)=>((m.size??0)-(y.size??0))*p):h.sort((m,y)=>((m.date??0)-(y.date??0))*p),h}}),{name:"outputs-storage",version:1,migrate:(n,o)=>{if(o===0){if(n.sort&&!n.sort.mode){const{field:s,order:a}=n.sort;s==="name"?n.sort={mode:a==="asc"?"name":"name-reverse"}:n.sort={mode:a==="desc"?"modified":"modified-reverse"}}n.filter&&!n.filter.type&&(n.filter.type="all")}return n},partialize:n=>({source:n.source,viewMode:n.viewMode,showHidden:n.showHidden,sort:n.sort,filter:n.filter,favorites:n.favorites})}));var An=Kb();function xS({open:n,onClose:o,side:s,title:a,children:l}){const c=b.useRef(null);return b.useEffect(()=>{if(!n)return;const d=h=>{h.key==="Escape"&&o()};return document.addEventListener("keydown",d),()=>document.removeEventListener("keydown",d)},[n,o]),b.useEffect(()=>(n?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[n]),n?An.createPortal(u.jsxs("div",{className:"fixed inset-0 z-[2300]",children:[u.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm",onClick:o}),u.jsxs("div",{ref:c,className:`
          absolute top-0 bottom-0 w-[85%] max-w-sm bg-white shadow-xl
          flex flex-col overflow-hidden
          ${s==="left"?"left-0 animate-slide-in-left":"right-0 animate-slide-in-right"}
        `,style:{animation:`${s==="left"?"slideInLeft":"slideInRight"} 0.2s ease-out`},children:[a&&u.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[u.jsx("h2",{className:"text-xl font-bold text-gray-900",children:a}),u.jsx("button",{onClick:o,className:`w-10 h-10 flex items-center justify-center rounded-full
                         text-gray-500 hover:bg-gray-100 text-2xl`,children:""})]}),u.jsx("div",{className:"flex-1 overflow-auto p-4 overscroll-contain scroll-container",children:l})]}),u.jsx("style",{children:`
        @keyframes slideInLeft {
          from { transform: translateX(-100%); }
          to { transform: translateX(0); }
        }
        @keyframes slideInRight {
          from { transform: translateX(100%); }
          to { transform: translateX(0); }
        }
      `})]}),document.body):null}function vS(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",...n,children:u.jsx("path",{d:"M12 11V16M12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12C21 16.9706 16.9706 21 12 21ZM12.0498 8V8.1L11.9502 8.1002V8H12.0498Z"})})}function lx({className:n}){return u.jsx(vS,{className:n})}function wS(n){return u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",...n,children:[u.jsx("path",{d:"M19 4H5L10.5 10.5V17L13.5 19V10.5L19 4Z"}),u.jsx("path",{d:"M2.5 9L4.5 7L6.5 9"}),u.jsx("path",{d:"M4.5 7V17"}),u.jsx("path",{d:"M2.5 15L4.5 17L6.5 15"})]})}function SS(n){return u.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...n,children:[u.jsx("path",{d:"M6 4h9l3 3v13a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2Z",stroke:"currentColor",strokeWidth:"1.5",fill:"none"}),u.jsx("path",{d:"M9 10h6M9 14h6",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]})}function NS(n){return u.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...n,children:[u.jsx("path",{d:"M6 4h9l3 3v13a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2Z",stroke:"currentColor",strokeWidth:"1.5",fill:"none"}),u.jsx("path",{d:"M9 10h6M9 14h6M9 18h4",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]})}function kS(n){return u.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...n,children:u.jsx("path",{d:"M4 20h16M6 16l4-4m0 0l4-4m-4 4l4 4",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none"})})}function CS(n){return u.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...n,children:[u.jsx("path",{d:"M3 7h18v10a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V7Z",stroke:"currentColor",strokeWidth:"1.5",fill:"none"}),u.jsx("path",{d:"M3 7l9 6 9-6",stroke:"currentColor",strokeWidth:"1.5",fill:"none"})]})}function jS(n){return u.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...n,style:{transform:"rotate(90deg)",...n.style??{}},children:[u.jsx("circle",{cx:"12",cy:"5",r:"2",fill:"currentColor"}),u.jsx("circle",{cx:"12",cy:"12",r:"2",fill:"currentColor"}),u.jsx("circle",{cx:"12",cy:"19",r:"2",fill:"currentColor"})]})}function js(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",...n,children:u.jsx("path",{d:"M10 17l5-5-5-5v10z"})})}function so(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",...n,children:u.jsx("path",{d:"M7 10l5 5 5-5H7z"})})}function Yu(n){return u.jsx("svg",{viewBox:"0 0 20 20","aria-hidden":"true",...n,children:u.jsx("g",{transform:"translate(-164 -6319)",fill:"currentColor",children:u.jsx("path",{d:"M170.673,6324.726 L170.669,6324.729 C170.266,6325.104 170.244,6325.735 170.62,6326.137 L171.577,6327.158 C171.876,6327.478 171.649,6328 171.212,6328 L165,6328 C164.447,6328 164,6328.448 164,6329 C164,6329.552 164.447,6330 165,6330 L171.197,6330 C171.637,6330 171.862,6330.527 171.558,6330.845 L170.63,6331.819 C170.248,6332.218 170.266,6332.852 170.669,6333.229 C171.068,6333.603 171.695,6333.584 172.071,6333.186 L174.76,6330.338 C175.49,6329.564 175.487,6328.354 174.753,6327.585 L172.067,6324.769 C171.692,6324.376 171.071,6324.357 170.673,6324.726 M182.222,6319 L175.777,6319 C174.8,6319 174,6319.68 174,6321.111 L174,6322.007 C174,6322.555 174.444,6323 174.993,6323 L175.006,6323 C175.555,6323 176,6322.555 176,6322.007 L176,6321.993 C176,6321.445 176.444,6321 176.993,6321 L181.006,6321 C181.555,6321 182,6321.445 182,6321.993 L182,6336.007 C182,6336.555 181.555,6337 181.006,6337 L176.993,6337 C176.444,6337 176,6336.555 176,6336.007 L176,6335.993 C176,6335.445 175.555,6335 175.006,6335 L174.993,6335 C174.444,6335 174,6335.445 174,6335.993 L174,6337.111 C174,6338.293 174.847,6339 175.777,6339 L182.222,6339 C183.204,6339 184,6338.204 184,6337.222 L184,6337.111 L184,6320.778 C184,6319.796 183.204,6319 182.222,6319"})})})}function Gp(n){return u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",...n,children:[u.jsx("path",{d:"M18.4101 3.6512L20.5315 5.77252C21.4101 6.6512 21.4101 8.07582 20.5315 8.9545L9.54019 19.9458C9.17774 20.3082 8.70239 20.536 8.19281 20.5915L4.57509 20.9856C3.78097 21.072 3.11061 20.4017 3.1971 19.6076L3.59111 15.9898C3.64661 15.4803 3.87444 15.0049 4.23689 14.6425L15.2282 3.6512C16.1068 2.77252 17.5315 2.77252 18.4101 3.6512Z",stroke:"currentColor",strokeWidth:"1.5"}),u.jsx("path",{d:"M15.2282 3.6512C16.1068 2.77252 17.5315 2.77252 18.4101 3.6512L20.5315 5.77252C21.4101 6.6512 21.4101 8.07582 20.5315 8.9545L18.7283 10.7576L13.425 5.45432L15.2282 3.6512Z",stroke:"currentColor",strokeWidth:"1.5"})]})}function Ul(n){return u.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...n,children:u.jsx("path",{d:"M6 6l12 12M18 6l-12 12",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round"})})}function zo(n){return u.jsx("svg",{viewBox:"0 0 16 16","aria-hidden":"true",...n,children:u.jsx("path",{d:"M6.4 11.2L3.2 8l1.1-1.1 2.1 2.1 5-5L12.5 5l-6.1 6.2Z",fill:"currentColor"})})}function MS(n){return u.jsx("svg",{viewBox:"0 0 16 16","aria-hidden":"true",...n,children:u.jsx("path",{d:"M4.2 4.2l7.6 7.6m0-7.6l-7.6 7.6",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"})})}function OS(n){return u.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...n,children:[u.jsx("path",{d:"M7 18a4 4 0 0 1 0-8 6 6 0 0 1 11.3-2.2A4.5 4.5 0 0 1 18 18H7Z",fill:"none",stroke:"currentColor",strokeWidth:"1.5"}),u.jsx("path",{d:"M12 10v7m0 0l-3-3m3 3l3-3",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]})}function br(n){return u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2","aria-hidden":"true",...n,children:[u.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),u.jsx("circle",{cx:"12",cy:"12",r:"3"})]})}function Yo(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2","aria-hidden":"true",...n,children:u.jsx("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24M1 1l22 22"})})}function Ho(n){return u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2","aria-hidden":"true",...n,children:[u.jsx("path",{d:"M3 6h18M8 6V4h8v2M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),u.jsx("path",{d:"M10 11v6M14 11v6"})]})}function TS(n){return u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2","aria-hidden":"true",...n,children:[u.jsx("circle",{cx:"12",cy:"12",r:"10"}),u.jsx("path",{d:"M15 9l-6 6M9 9l6 6"})]})}function Pp(n){return u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2","aria-hidden":"true",...n,children:[u.jsx("path",{d:"M23 4v6h-6M1 20v-6h6"}),u.jsx("path",{d:"M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"})]})}function ES(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2","aria-hidden":"true",...n,children:u.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4M16 17l5-5-5-5M21 12H9"})})}function Ts(n){return u.jsx("svg",{viewBox:"0 0 16 16",fill:"none","aria-hidden":"true",...n,children:u.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeWidth:"1.3",d:"M9.18613 3.09999H6.81377M9.18613 12.9H7.55288c-3.08678 0-5.35171-2.99581-4.60305-6.08843l.3054-1.26158M14.7486 2.1721l-.5931 2.45c-.132.54533-.6065.92789-1.1508.92789h-2.2993c-.77173 0-1.33797-.74895-1.1508-1.5221l.5931-2.45c.132-.54533.6065-.9279 1.1508-.9279h2.2993c.7717 0 1.3379.74896 1.1508 1.52211Zm-8.3033 0-.59309 2.45c-.13201.54533-.60646.92789-1.15076.92789H2.4021c-.7717 0-1.33793-.74895-1.15077-1.5221l.59309-2.45c.13201-.54533.60647-.9279 1.15077-.9279h2.29935c.77169 0 1.33792.74896 1.15076 1.52211Zm8.3033 9.8-.5931 2.45c-.132.5453-.6065.9279-1.1508.9279h-2.2993c-.77173 0-1.33797-.749-1.1508-1.5221l.5931-2.45c.132-.5453.6065-.9279 1.1508-.9279h2.2993c.7717 0 1.3379.7489 1.1508 1.5221Z"})})}function ix(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",...n,children:u.jsx("path",{d:"M13 20.74C12.9039 20.7541 12.8062 20.7541 12.71 20.74C12.5724 20.6823 12.4551 20.5849 12.3732 20.4602C12.2912 20.3355 12.2484 20.1892 12.25 20.04V16.7H3.00001C2.81189 16.6956 2.63208 16.6216 2.49538 16.4923C2.35868 16.363 2.27481 16.1876 2.26001 16V8.00002C2.25463 7.89856 2.26965 7.79706 2.30417 7.7015C2.3387 7.60595 2.39204 7.51829 2.46103 7.44371C2.53002 7.36913 2.61326 7.30913 2.70584 7.26727C2.79841 7.22542 2.89844 7.20255 3.00001 7.20002H12.25V4.01002C12.2498 3.86106 12.2946 3.71551 12.3784 3.59241C12.4623 3.4693 12.5813 3.37436 12.72 3.32002C12.8551 3.26039 13.0053 3.24376 13.1502 3.27238C13.2951 3.301 13.4277 3.37349 13.53 3.48002L21.53 11.48C21.6705 11.6206 21.7493 11.8113 21.7493 12.01C21.7493 12.2088 21.6705 12.3994 21.53 12.54L13.53 20.54C13.4601 20.6079 13.377 20.6608 13.2858 20.6952C13.1946 20.7296 13.0973 20.7448 13 20.74ZM3.76001 15.2H13C13.1981 15.2026 13.3874 15.2825 13.5275 15.4226C13.6676 15.5626 13.7474 15.7519 13.75 15.95V18.18L19.93 12L13.75 5.83002V8.00002C13.7477 8.19843 13.6689 8.3883 13.53 8.53002C13.3817 8.65257 13.1919 8.71343 13 8.70002H3.76001V15.2Z",fill:"currentColor"})})}function IS(n){return u.jsxs("svg",{viewBox:"0 0 16 16",fill:"none","aria-hidden":"true",...n,children:[u.jsx("path",{d:"M10.667 2.667c1.45.008 2.235.072 2.748.585C14 3.837 14 4.78 14 6.666v4c0 1.885 0 2.828-.585 3.414-.586.585-1.529.585-3.415.585H6c-1.886 0-2.829 0-3.414-.585C2 13.494 2 12.55 2 10.666v-4c0-1.886 0-2.829.586-3.414.512-.513 1.297-.577 2.747-.585",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round"}),u.jsx("path",{d:"M5.333 2.333c0-.552.448-1 1-1h3.334c.552 0 1 .448 1 1v.667c0 .553-.448 1-1 1H6.333c-.552 0-1-.447-1-1v-.667Z",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round"})]})}function LS(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2","aria-hidden":"true",...n,children:u.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M7 10l5 5 5-5M12 15V3"})})}function _S(n){return u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",...n,children:[u.jsx("rect",{x:"9",y:"9",width:"10",height:"12",rx:"2"}),u.jsx("path",{d:"M5 15V5a2 2 0 0 1 2-2h8"})]})}function AS(n){return u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",...n,children:[u.jsx("circle",{cx:"12",cy:"12",r:"9"}),u.jsx("path",{d:"M7 12h10"})]})}function Qu(n){return u.jsx("svg",{viewBox:"0 0 20 20",fill:"none","aria-hidden":"true",...n,children:u.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M6 8l4 4 4-4"})})}function ts(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"currentColor",strokeWidth:"2","aria-hidden":"true",...n,children:u.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})})}function ux({showSlash:n=!1,...o}){return u.jsxs("svg",{viewBox:"0 0 32 32","aria-hidden":"true",overflow:"visible",...o,children:[u.jsx("path",{d:"M28 28H4a2.002 2.002 0 0 1-2-2V21h2v5h24v-5h2v5a2.002 2.002 0 0 1-2 2Z",fill:"currentColor"}),u.jsx("rect",{x:"7",y:"21",width:"18",height:"2",fill:"currentColor"}),u.jsx("rect",{x:"7",y:"16",width:"18",height:"2",fill:"currentColor"}),u.jsx("rect",{x:"7",y:"11",width:"18",height:"2",fill:"currentColor"}),u.jsx("rect",{x:"7",y:"6",width:"18",height:"2",fill:"currentColor"}),u.jsx("path",{d:"M16 -3l5 4H11l5-4Z",fill:"currentColor"}),n&&u.jsx("line",{x1:"2",y1:"30",x2:"28",y2:"4",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round"})]})}const Dt={transparent:"transparent",transparentBlack:"rgba(0, 0, 0, 0)",surface:{white:"#ffffff",darkPanel:"#151a23",gray100:"#f3f4f6",gray200:"#e5e7eb"},text:{primary:"#111827",secondary:"#6b7280",onDark:"#e5e7eb"},border:{gray200:"#e5e7eb",focusBlue:"#3b82f6"},status:{success:"#22c55e",successStrong:"rgba(34,197,94,0.9)",warning:"#facc15",danger:"#f97316"},brand:{blue500:"#3b82f6",subgraphBackground08:"rgba(59, 130, 246, 0.08)",subgraphBackground10:"rgba(59, 130, 246, 0.10)",subgraphBackground14:"rgba(59, 130, 246, 0.14)",subgraphBorder20:"rgba(59, 130, 246, 0.20)",subgraphBorder25:"rgba(59, 130, 246, 0.25)"},workflow:{defaultGroupDot:"#9ca3af",fastGroupBypassColors:{nocolor:"#353535",red:"#553333",brown:"#593930",green:"#335533",blue:"#333355",pale_blue:"#3f5159",cyan:"#335555",purple:"#553355",yellow:"#665533",black:"#000000"}}};function RS({progress:n,radius:o=11,...s}){const a=Math.min(100,Math.max(0,n)),l=2*Math.PI*o,c=l*(1-a/100);return u.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...s,children:u.jsx("circle",{cx:"12",cy:"12",r:o,fill:"none",stroke:Dt.status.successStrong,strokeWidth:"2",strokeLinecap:"round",strokeDasharray:l,strokeDashoffset:c})})}function Yp(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","aria-hidden":"true",...n,children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}function Io(n){return u.jsx("svg",{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",...n,children:u.jsx("path",{fillRule:"evenodd",d:"M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z",clipRule:"evenodd"})})}function DS(n){return u.jsx("svg",{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",...n,children:u.jsx("path",{fillRule:"evenodd",d:"M4 10a1 1 0 011-1h10a1 1 0 110 2H5a1 1 0 01-1-1z",clipRule:"evenodd"})})}function cx(n){return u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",...n,children:[u.jsx("circle",{cx:"11",cy:"11",r:"7"}),u.jsx("path",{d:"M20 20l-3.5-3.5"})]})}function BS(n){return u.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...n,children:[u.jsx("rect",{x:"4",y:"4",width:"16",height:"16",rx:"3",stroke:"currentColor",strokeWidth:"1.5",fill:"none"}),u.jsx("circle",{cx:"9",cy:"9",r:"1.5",fill:"currentColor"}),u.jsx("circle",{cx:"15",cy:"15",r:"1.5",fill:"currentColor"}),u.jsx("circle",{cx:"15",cy:"9",r:"1.5",fill:"currentColor"}),u.jsx("circle",{cx:"9",cy:"15",r:"1.5",fill:"currentColor"}),u.jsx("circle",{cx:"12",cy:"12",r:"1.5",fill:"currentColor"})]})}function dx(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","aria-hidden":"true",...n,children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}function fx(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",...n,children:u.jsx("path",{d:"M12 2L1 21h22L12 2zm0 3.5L19.5 19h-15L12 5.5zM11 10v4h2v-4h-2zm0 6v2h2v-2h-2z"})})}function fc(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2","aria-hidden":"true",...n,children:u.jsx("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"})})}function Iy(n){return u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",...n,children:[u.jsx("rect",{x:"3",y:"7",width:"12",height:"10",rx:"2"}),u.jsx("path",{d:"M15 10l5-3v10l-5-3z"})]})}function _l(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",...n,children:u.jsx("path",{d:"M19.1835 7.80516L16.2188 4.83755C14.1921 2.8089 13.1788 1.79457 12.0904 2.03468C11.0021 2.2748 10.5086 3.62155 9.5217 6.31506L8.85373 8.1381C8.59063 8.85617 8.45908 9.2152 8.22239 9.49292C8.11619 9.61754 7.99536 9.72887 7.86251 9.82451C7.56644 10.0377 7.19811 10.1392 6.46145 10.3423C4.80107 10.8 3.97088 11.0289 3.65804 11.5721C3.5228 11.8069 3.45242 12.0735 3.45413 12.3446C3.45809 12.9715 4.06698 13.581 5.28476 14.8L6.69935 16.2163L2.22345 20.6964C1.92552 20.9946 1.92552 21.4782 2.22345 21.7764C2.52138 22.0746 3.00443 22.0746 3.30236 21.7764L7.77841 17.2961L9.24441 18.7635C10.4699 19.9902 11.0827 20.6036 11.7134 20.6045C11.9792 20.6049 12.2404 20.5358 12.4713 20.4041C13.0192 20.0914 13.2493 19.2551 13.7095 17.5825C13.9119 16.8472 14.013 16.4795 14.2254 16.1835C14.3184 16.054 14.4262 15.9358 14.5468 15.8314C14.8221 15.593 15.1788 15.459 15.8922 15.191L17.7362 14.4981C20.4 13.4973 21.7319 12.9969 21.9667 11.9115C22.2014 10.826 21.1954 9.81905 19.1835 7.80516Z"})})}function pp(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",...n,children:u.jsx("path",{d:"M15.9894 4.9502L16.52 4.42014L15.9894 4.9502ZM19.0716 8.03562L18.541 8.56568L19.0716 8.03562ZM8.73837 19.429L8.20777 19.9591L8.73837 19.429ZM4.62169 15.3081L5.15229 14.7781L4.62169 15.3081ZM17.5669 14.9943L17.3032 14.2922L17.5669 14.9943ZM15.6498 15.7146L15.9136 16.4167H15.9136L15.6498 15.7146ZM8.3322 8.38177L7.62798 8.12375L8.3322 8.38177ZM9.02665 6.48636L9.73087 6.74438V6.74438L9.02665 6.48636ZM5.84504 10.6735L6.04438 11.3965L5.84504 10.6735ZM7.30167 10.1351L6.86346 9.52646L6.86346 9.52646L7.30167 10.1351ZM7.67582 9.79038L8.24665 10.2768H8.24665L7.67582 9.79038ZM14.251 16.3805L14.742 16.9475L14.742 16.9475L14.251 16.3805ZM13.3806 18.2012L12.6574 18.0022V18.0022L13.3806 18.2012ZM13.9169 16.7466L13.3075 16.3094L13.3075 16.3094L13.9169 16.7466ZM2.71846 12.7552L1.96848 12.76L1.96848 12.76L2.71846 12.7552ZM2.93045 11.9521L2.28053 11.5778H2.28053L2.93045 11.9521ZM11.3052 21.3431L11.3064 20.5931H11.3064L11.3052 21.3431ZM12.0933 21.1347L11.7215 20.4833L11.7215 20.4833L12.0933 21.1347ZM11.6973 2.03606L11.8588 2.76845L11.6973 2.03606ZM1.4694 21.4699C1.17666 21.763 1.1769 22.2379 1.46994 22.5306C1.76298 22.8233 2.23786 22.8231 2.5306 22.5301L1.4694 21.4699ZM7.18383 17.8721C7.47657 17.5791 7.47633 17.1042 7.18329 16.8114C6.89024 16.5187 6.41537 16.5189 6.12263 16.812L7.18383 17.8721ZM15.4588 5.48026L18.541 8.56568L19.6022 7.50556L16.52 4.42014L15.4588 5.48026ZM9.26897 18.8989L5.15229 14.7781L4.09109 15.8382L8.20777 19.9591L9.26897 18.8989ZM17.3032 14.2922L15.386 15.0125L15.9136 16.4167L17.8307 15.6964L17.3032 14.2922ZM9.03642 8.63979L9.73087 6.74438L8.32243 6.22834L7.62798 8.12375L9.03642 8.63979ZM6.04438 11.3965C6.75583 11.2003 7.29719 11.0625 7.73987 10.7438L6.86346 9.52646C6.69053 9.65097 6.46601 9.72428 5.6457 9.95044L6.04438 11.3965ZM7.62798 8.12375C7.33502 8.92332 7.24338 9.14153 7.10499 9.30391L8.24665 10.2768C8.60041 9.86175 8.7823 9.33337 9.03642 8.63979L7.62798 8.12375ZM7.73987 10.7438C7.92696 10.6091 8.09712 10.4523 8.24665 10.2768L7.10499 9.30391C7.0337 9.38757 6.9526 9.46229 6.86346 9.52646L7.73987 10.7438ZM15.386 15.0125C14.697 15.2714 14.1716 15.4571 13.76 15.8135L14.742 16.9475C14.9028 16.8082 15.1192 16.7152 15.9136 16.4167L15.386 15.0125ZM14.1037 18.4001C14.329 17.5813 14.4021 17.3569 14.5263 17.1838L13.3075 16.3094C12.9902 16.7517 12.8529 17.2919 12.6574 18.0022L14.1037 18.4001ZM13.76 15.8135C13.5903 15.9605 13.4384 16.1269 13.3075 16.3094L14.5263 17.1838C14.5887 17.0968 14.6611 17.0175 14.742 16.9475L13.76 15.8135ZM5.15229 14.7781C4.50615 14.1313 4.06799 13.691 3.78366 13.3338C3.49835 12.9753 3.46889 12.8201 3.46845 12.7505L1.96848 12.76C1.97215 13.3422 2.26127 13.8297 2.61002 14.2679C2.95976 14.7073 3.47115 15.2176 4.09109 15.8382L5.15229 14.7781ZM5.6457 9.95044C4.80048 10.1835 4.10396 10.3743 3.58296 10.5835C3.06341 10.792 2.57116 11.0732 2.28053 11.5778L3.58038 12.3264C3.615 12.2663 3.71693 12.146 4.1418 11.9755C4.56523 11.8055 5.16337 11.6394 6.04438 11.3965L5.6457 9.95044ZM3.46845 12.7505C3.46751 12.6016 3.50616 12.4553 3.58038 12.3264L2.28053 11.5778C2.07354 11.9372 1.96586 12.3452 1.96848 12.76L3.46845 12.7505ZM8.20777 19.9591C8.83164 20.5836 9.34464 21.0987 9.78647 21.4506C10.227 21.8015 10.7179 22.0922 11.3041 22.0931L11.3064 20.5931C11.2369 20.593 11.0814 20.5644 10.721 20.2773C10.3618 19.9912 9.91923 19.5499 9.26897 18.8989L8.20777 19.9591ZM12.6574 18.0022C12.4133 18.8897 12.2462 19.4924 12.0751 19.9188C11.9033 20.3467 11.7821 20.4487 11.7215 20.4833L12.465 21.7861C12.974 21.4956 13.2573 21.0004 13.4671 20.4775C13.6776 19.9532 13.8694 19.2516 14.1037 18.4001L12.6574 18.0022ZM11.3041 22.0931C11.7112 22.0937 12.1114 21.9879 12.465 21.7861L11.7215 20.4833C11.595 20.5555 11.4519 20.5933 11.3064 20.5931L11.3041 22.0931ZM18.541 8.56568C19.6045 9.63022 20.3403 10.3695 20.7917 10.9788C21.2353 11.5774 21.2863 11.8959 21.2321 12.1464L22.6982 12.4634C22.8881 11.5854 22.5382 10.8162 21.9969 10.0857C21.4635 9.36592 20.6305 8.53486 19.6022 7.50556L18.541 8.56568ZM17.8307 15.6964C19.1921 15.1849 20.294 14.773 21.0771 14.3384C21.8718 13.8973 22.5083 13.3416 22.6982 12.4634L21.2321 12.1464C21.178 12.3968 21.0001 12.6655 20.3491 13.0268C19.6865 13.3946 18.7112 13.7632 17.3032 14.2922L17.8307 15.6964ZM16.52 4.42014C15.4841 3.3832 14.6481 2.54353 13.9246 2.00638C13.1908 1.46165 12.4175 1.10912 11.5357 1.30367L11.8588 2.76845C12.1086 2.71335 12.4277 2.7633 13.0304 3.21075C13.6433 3.66579 14.3876 4.40801 15.4588 5.48026L16.52 4.42014ZM9.73087 6.74438C10.2525 5.32075 10.6161 4.33403 10.9812 3.66315C11.3402 3.00338 11.609 2.82357 11.8588 2.76845L11.5357 1.30367C10.654 1.49819 10.1005 2.14332 9.66362 2.94618C9.23278 3.73793 8.82688 4.85154 8.32243 6.22834L9.73087 6.74438ZM2.5306 22.5301L7.18383 17.8721L6.12263 16.812L1.4694 21.4699L2.5306 22.5301Z"})})}function Qp(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2","aria-hidden":"true",...n,children:u.jsx("path",{d:"M9 6l6 6-6 6"})})}function zS(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",...n,children:u.jsx("path",{d:"M15 19l-7-7 7-7"})})}function hp({isBypassed:n,...o}){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2","aria-hidden":"true",...o,children:n?u.jsxs(u.Fragment,{children:[u.jsx("path",{d:"M5 12h14"}),u.jsx("path",{d:"M12 5l7 7-7 7"})]}):u.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})}function px({nodeId:n,connectionHighlightMode:o,leftLineCount:s,rightLineCount:a,inactiveColor:l=Dt.text.secondary,inputHighlightColor:c=Dt.status.danger,outputHighlightColor:d=Dt.status.danger,offLineColor:h=l,...p}){const m=o==="inputs"||o==="both",y=o==="outputs"||o==="both",x=m?c:h,v=y?d:h;return u.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...p,children:[u.jsxs("defs",{children:[u.jsx("clipPath",{id:`node-rect-left-${n}`,children:u.jsx("rect",{x:"0",y:"0",width:"12",height:"24"})}),u.jsx("clipPath",{id:`node-rect-right-${n}`,children:u.jsx("rect",{x:"12",y:"0",width:"12",height:"24"})})]}),u.jsxs(u.Fragment,{children:[u.jsx("rect",{x:"7",y:"7",width:"10",height:"10",rx:"2",stroke:x,strokeWidth:"1.6",fill:"none",strokeLinejoin:"round",clipPath:`url(#node-rect-left-${n})`}),u.jsx("rect",{x:"7",y:"7",width:"10",height:"10",rx:"2",stroke:v,strokeWidth:"1.6",fill:"none",strokeLinejoin:"round",clipPath:`url(#node-rect-right-${n})`})]}),u.jsxs("g",{style:{color:x},children:[s===1&&u.jsx("line",{x1:"7",y1:"12",x2:"-4.25",y2:"12",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"}),s===2&&u.jsxs(u.Fragment,{children:[u.jsx("line",{x1:"7",y1:"12",x2:"-4.25",y2:"8.625",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"}),u.jsx("line",{x1:"7",y1:"12",x2:"-4.25",y2:"15.375",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"})]}),s>=3&&u.jsxs(u.Fragment,{children:[u.jsx("line",{x1:"7",y1:"12",x2:"-4.25",y2:"12",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"}),u.jsx("line",{x1:"7",y1:"12",x2:"-2.743",y2:"6.375",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"}),u.jsx("line",{x1:"7",y1:"12",x2:"-2.743",y2:"17.625",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"})]})]}),u.jsxs("g",{style:{color:v},children:[a===1&&u.jsx("line",{x1:"17",y1:"12",x2:"28.25",y2:"12",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"}),a===2&&u.jsxs(u.Fragment,{children:[u.jsx("line",{x1:"17",y1:"12",x2:"28.25",y2:"8.625",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"}),u.jsx("line",{x1:"17",y1:"12",x2:"28.25",y2:"15.375",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"})]}),a>=3&&u.jsxs(u.Fragment,{children:[u.jsx("line",{x1:"17",y1:"12",x2:"28.25",y2:"12",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"}),u.jsx("line",{x1:"17",y1:"12",x2:"26.743",y2:"6.375",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"}),u.jsx("line",{x1:"17",y1:"12",x2:"26.743",y2:"17.625",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"})]})]})]})}function HS(n){return u.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...n,children:[u.jsxs("defs",{children:[u.jsx("clipPath",{id:"legend-trace-left",children:u.jsx("rect",{x:"0",y:"0",width:"12",height:"24"})}),u.jsx("clipPath",{id:"legend-trace-right",children:u.jsx("rect",{x:"12",y:"0",width:"12",height:"24"})})]}),u.jsx("rect",{x:"7",y:"7",width:"10",height:"10",rx:"2",stroke:"currentColor",strokeWidth:"1.6",fill:"none",clipPath:"url(#legend-trace-left)",className:"text-gray-400"}),u.jsx("rect",{x:"7",y:"7",width:"10",height:"10",rx:"2",stroke:"currentColor",strokeWidth:"1.6",fill:"none",clipPath:"url(#legend-trace-right)",className:"text-orange-500"}),u.jsx("line",{x1:"7",y1:"12",x2:"-4.25",y2:"12",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round",className:"text-gray-400"}),u.jsx("line",{x1:"17",y1:"12",x2:"28.25",y2:"12",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round",className:"text-orange-500"})]})}function hx(n){return u.jsx("svg",{viewBox:"0 0 16 16",fill:"none","aria-hidden":"true",...n,children:u.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeWidth:"1.3",d:"m14.6685 5.7416.6425-2.57c.2028-.811-.4106-1.5967-1.2466-1.5967H2.5782a1.285 1.285 0 0 0-1.2467.9733l-.6425 2.57c-.2027.8111.4107 1.5968 1.2467 1.5968h11.4861a1.285 1.285 0 0 0 1.2467-.9734Zm0 7.7102.6425-2.5701c.2028-.811-.4106-1.5967-1.2466-1.5967h-5.061a1.285 1.285 0 0 0-1.2467.9734l-.6425 2.5701c-.2028.811.4106 1.5966 1.2466 1.5966h5.061a1.285 1.285 0 0 0 1.2467-.9733Zm-10.2802 0 .6425-2.5701c.2027-.811-.4107-1.5967-1.2467-1.5967H2.5782a1.285 1.285 0 0 0-1.2467.9734L.689 12.8285c-.2027.811.4107 1.5966 1.2467 1.5966h1.206a1.285 1.285 0 0 0 1.2466-.9733Z"})})}function $S(n){return u.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...n,children:u.jsx("path",{d:"M12 3v10m0 0l-4-4m4 4l4-4M5 19h14",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none"})})}function KS(n){return u.jsxs("svg",{viewBox:"0 0 16 16",fill:"none","aria-hidden":"true",...n,children:[u.jsx("path",{d:"M10.667 2.667c1.45.008 2.235.072 2.748.585C14 3.837 14 4.78 14 6.666v4c0 1.885 0 2.828-.585 3.414-.586.585-1.529.585-3.415.585H6c-1.886 0-2.829 0-3.414-.585C2 13.494 2 12.55 2 10.666v-4c0-1.886 0-2.829.586-3.414.512-.513 1.297-.577 2.747-.585",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round"}),u.jsx("path",{d:"M5.333 2.333c0-.552.448-1 1-1h3.334c.552 0 1 .448 1 1v.667c0 .553-.448 1-1 1H6.333c-.552 0-1-.447-1-1v-.667Z",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round"}),u.jsx("path",{d:"M8 6.667v4.666m0 0L5.667 9m2.333 2.333L10.333 9",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round"})]})}function xr(n){return u.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...n,children:[u.jsx("path",{d:"M3 7a2 2 0 0 1 2-2h4l2 2h8a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V7Z",stroke:"currentColor",strokeWidth:"1.5",fill:"none"}),u.jsx("path",{d:"M3 9h18",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]})}function gx(n){return u.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...n,children:[u.jsx("path",{d:"M5 4h12l3 3v13H4V5a1 1 0 0 1 1-1Z",stroke:"currentColor",strokeWidth:"1.5",fill:"none"}),u.jsx("rect",{x:"7",y:"4",width:"8",height:"4",fill:"currentColor"}),u.jsx("rect",{x:"7",y:"13",width:"10",height:"6",rx:"1",stroke:"currentColor",strokeWidth:"1.5",fill:"none"})]})}function mx(n){return u.jsxs("svg",{viewBox:"0 0 16 16",fill:"none","aria-hidden":"true",...n,children:[u.jsx("path",{d:"M12.667 14H3.333C2.597 14 2 13.403 2 12.667V3.333C2 2.597 2.597 2 3.333 2h7.334L14 5.333v7.334c0 .736-.597 1.333-1.333 1.333Z",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round"}),u.jsx("path",{d:"M11.333 14v-4H4.667v4M4.667 2v3.333h5.333",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round"})]})}function VS(n){return u.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...n,children:[u.jsx("circle",{cx:"12",cy:"12",r:"4",fill:"currentColor"}),u.jsx("path",{d:"M12 2v3M12 19v3M4.22 4.22l2.12 2.12M17.66 17.66l2.12 2.12M2 12h3M19 12h3M4.22 19.78l2.12-2.12M17.66 6.34l2.12-2.12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",fill:"none"})]})}function US(n){return u.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...n,children:u.jsx("path",{d:"M21 14.5A9 9 0 0 1 9.5 3a7 7 0 1 0 11.5 11.5Z",fill:"currentColor"})})}function WS(n){return u.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",fill:"currentColor",...n,children:u.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z"})})}function gp(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","aria-hidden":"true",...n,children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})}function FS(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","aria-hidden":"true",...n,children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}function qS(n){return u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","aria-hidden":"true",...n,children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})}function GS(n){return u.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...n,children:u.jsx("path",{d:"M8 4h8M8 20h8M9 6h6l-1 4 1 4H9l1-4-1-4Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"none"})})}function yx(n){return u.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",...n,children:[u.jsx("path",{d:"M12 3v18"}),u.jsx("path",{d:"m8 7 4-4 4 4"}),u.jsx("path",{d:"m8 17 4 4 4-4"})]})}function PS({progress:n,radius:o=10,trackColor:s=Dt.border.gray200,progressColor:a=Dt.brand.blue500,...l}){const c=Math.min(100,Math.max(0,n)),d=2*Math.PI*o,h=d*(1-c/100);return u.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",...l,children:[u.jsx("circle",{cx:"12",cy:"12",r:o,fill:"none",stroke:s,strokeWidth:"2"}),u.jsx("circle",{cx:"12",cy:"12",r:o,fill:"none",stroke:a,strokeWidth:"2",strokeLinecap:"round",strokeDasharray:d,strokeDashoffset:h})]})}function Wl({title:n,onBack:o,rightElement:s}){return u.jsxs("div",{className:"flex items-center mb-3",children:[u.jsxs("button",{onClick:o,className:"flex items-center gap-2 text-sm font-semibold text-gray-500 uppercase tracking-wide",children:[u.jsx(zS,{className:"w-5 h-5 text-gray-400"}),u.jsx("span",{children:n})]}),s&&u.jsx("div",{className:"ml-auto",children:s})]})}function YS({icon:n,title:o,description:s}){return u.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 bg-white border border-gray-100 rounded-lg shadow-sm",children:[n,u.jsxs("div",{children:[u.jsx("p",{className:"text-sm font-medium text-gray-900",children:o}),u.jsx("p",{className:"text-xs text-gray-500",children:s})]})]})}function QS(){return[{icon:u.jsx("div",{className:"w-8 h-8 flex items-center justify-center bg-blue-500 text-white rounded-lg font-bold text-xs shadow-sm",children:"Run"}),title:"Run",description:"Execute current workflow"},{icon:u.jsx("div",{className:"w-10 h-10 flex items-center justify-center bg-white border border-gray-200 rounded-lg text-gray-700 shadow-sm overflow-hidden",children:u.jsx(ux,{className:"w-5 h-5"})}),title:"Queue / Follow",description:"View queue & follow execution"},{icon:u.jsx("div",{className:"w-10 h-10 flex items-center justify-center bg-yellow-500 text-white rounded-lg shadow-sm",children:u.jsx(_l,{className:"w-5 h-5"})}),title:"Pinned Widget",description:"Quick access to pinned parameter"},{icon:u.jsx("div",{className:"w-8 h-8 flex items-center justify-center bg-gray-100 rounded-full border border-gray-200 text-gray-700 font-bold",children:""}),title:"Input",description:"Node input connection point"},{icon:u.jsx("div",{className:"w-8 h-8 flex items-center justify-center bg-gray-100 rounded-full border border-gray-200 text-gray-700 font-bold",children:""}),title:"Output",description:"Node output connection point"},{icon:u.jsx("div",{className:"w-8 h-8 flex items-center justify-center text-gray-700",children:u.jsx(HS,{className:"w-6 h-6 overflow-visible"})}),title:"Trace Connections",description:"Highlight connected nodes"},{icon:u.jsx("div",{className:"w-8 h-8 flex items-center justify-center text-gray-500",children:u.jsx(so,{className:"w-6 h-6"})}),title:"Fold / Unfold",description:"Collapse or expand node card"},{icon:u.jsx("div",{className:"w-8 h-8 flex items-center justify-center text-gray-700",children:u.jsx(dx,{className:"w-5 h-5"})}),title:"Bypass",description:"Skip node execution"},{icon:u.jsx("div",{className:"w-8 h-8 flex items-center justify-center text-gray-700",children:u.jsx(Yo,{className:"w-5 h-5"})}),title:"Hide",description:"Hide node from view"},{icon:u.jsx("div",{className:"w-8 h-8 flex items-center justify-center text-gray-700",children:u.jsx(br,{className:"w-5 h-5"})}),title:"Show",description:"Make node visible again"},{icon:u.jsx("div",{className:"w-8 h-8 flex items-center justify-center text-gray-700",children:u.jsx(pp,{className:"w-5 h-5"})}),title:"Pin widget",description:"Pin widget to bottom bar"}]}function XS({onBack:n}){const o=QS();return u.jsxs("div",{className:"flex flex-col h-full",children:[u.jsx(Wl,{title:"Icon Legend",onBack:n}),u.jsx("div",{className:"space-y-3 overflow-y-auto flex-1 pb-4",children:o.map(s=>u.jsx(YS,{icon:s.icon,title:s.title,description:s.description},s.title))})]})}function Fl({error:n,onDismiss:o}){return n?u.jsxs("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:[n,u.jsx("button",{onClick:o,className:"ml-2 text-red-500 font-medium",children:"Dismiss"})]}):null}function ZS({error:n,workflow:o,currentFilename:s,isDirty:a,loading:l,theme:c,menuSectionsOpen:d,fileInputRef:h,loadSectionRef:p,saveSectionRef:m,appearanceSectionRef:y,infoSectionRef:x,onDismissError:v,onFileChange:k,onLoadFromFile:w,onToggleSection:S,onOpenUserWorkflows:j,onOpenTemplates:C,onOpenPasteJson:T,onSave:R,onOpenSaveAs:D,onToggleTheme:L,onOpenLegend:B}){return u.jsxs(u.Fragment,{children:[u.jsx("input",{ref:h,type:"file",accept:".json",onChange:k,className:"hidden"}),u.jsx(Fl,{error:n,onDismiss:v}),u.jsxs("section",{ref:p,className:"mb-6",children:[u.jsxs("button",{type:"button",onClick:()=>S("load"),className:"w-full flex items-center justify-between text-sm font-semibold text-gray-500 uppercase tracking-wide mb-3","aria-expanded":d.load,children:[u.jsx("span",{children:"Load Workflow"}),u.jsx(so,{className:`w-5 h-5 text-gray-400 transition-transform ${d.load?"rotate-0":"-rotate-90"}`})]}),d.load&&u.jsxs("div",{className:"space-y-2",children:[u.jsxs("button",{onClick:j,className:`w-full flex items-center gap-3 p-4 bg-white border border-gray-200
                         rounded-xl text-left hover:bg-gray-50 min-h-[56px]`,children:[u.jsx(Ts,{className:"w-6 h-6 text-gray-600"}),u.jsx("span",{className:"font-medium text-gray-900",children:"My Workflows"}),u.jsx("span",{className:"ml-auto text-gray-400",children:""})]}),u.jsxs("button",{onClick:C,className:`w-full flex items-center gap-3 p-4 bg-white border border-gray-200
                         rounded-xl text-left hover:bg-gray-50 min-h-[56px]`,children:[u.jsx(hx,{className:"w-6 h-6 text-gray-600"}),u.jsx("span",{className:"font-medium text-gray-900",children:"Templates"}),u.jsx("span",{className:"ml-auto text-gray-400",children:""})]}),u.jsxs("button",{onClick:T,className:`w-full flex items-center gap-3 p-4 bg-white border border-gray-200
                         rounded-xl text-left hover:bg-gray-50 min-h-[56px]`,children:[u.jsx(KS,{className:"w-6 h-6 text-gray-600"}),u.jsx("span",{className:"font-medium text-gray-900",children:"Paste JSON"}),u.jsx("span",{className:"ml-auto text-gray-400",children:""})]}),u.jsxs("button",{onClick:w,className:`w-full flex items-center gap-3 p-4 bg-white border border-gray-200
                         rounded-xl text-left hover:bg-gray-50 min-h-[56px]`,children:[u.jsx(xr,{className:"w-6 h-6 text-gray-600"}),u.jsx("span",{className:"font-medium text-gray-900",children:"From Device"})]})]})]}),u.jsxs("section",{ref:m,className:"mb-6",children:[u.jsxs("button",{type:"button",onClick:()=>S("save"),className:"w-full flex items-center justify-between text-sm font-semibold text-gray-500 uppercase tracking-wide mb-3","aria-expanded":d.save,children:[u.jsx("span",{children:"Save Workflow"}),u.jsx(so,{className:`w-5 h-5 text-gray-400 transition-transform ${d.save?"rotate-0":"-rotate-90"}`})]}),d.save&&u.jsxs("div",{className:"space-y-2",children:[s&&u.jsxs("button",{onClick:R,disabled:!o||!a||l,className:`w-full flex items-center gap-3 p-4 bg-white border border-gray-200
                           rounded-xl text-left hover:bg-gray-50 min-h-[56px]
                           disabled:opacity-50 disabled:cursor-not-allowed`,children:[u.jsx(gx,{className:"w-6 h-6 text-gray-600 shrink-0"}),u.jsxs("span",{className:"font-medium text-gray-900 truncate",children:["Save ",s.replace(".json","")]})]}),u.jsxs("button",{onClick:D,disabled:!o,className:`w-full flex items-center gap-3 p-4 bg-white border border-gray-200
                         rounded-xl text-left hover:bg-gray-50 min-h-[56px]`,children:[u.jsx(mx,{className:"w-6 h-6 text-gray-600"}),u.jsx("span",{className:"font-medium text-gray-900",children:"Save As..."}),u.jsx("span",{className:"ml-auto text-gray-400",children:""})]})]})]}),u.jsx("div",{className:"border-t border-gray-200 mb-6"}),u.jsxs("section",{ref:y,className:"mb-6",children:[u.jsxs("button",{type:"button",onClick:()=>S("appearance"),className:"w-full flex items-center justify-between text-sm font-semibold text-gray-500 uppercase tracking-wide mb-3","aria-expanded":d.appearance,children:[u.jsx("span",{children:"Appearance"}),u.jsx(so,{className:`w-5 h-5 text-gray-400 transition-transform ${d.appearance?"rotate-0":"-rotate-90"}`})]}),d.appearance&&u.jsx("div",{className:"space-y-2",children:u.jsxs("button",{onClick:L,className:`w-full flex items-center gap-3 p-4 bg-white border border-gray-200
                         rounded-xl text-left hover:bg-gray-50 min-h-[56px]`,children:[c==="dark"?u.jsx(US,{className:"w-6 h-6 text-gray-600"}):u.jsx(VS,{className:"w-6 h-6 text-gray-600"}),u.jsx("span",{className:"font-medium text-gray-900",children:c==="dark"?"Dark mode":"Light mode"})]})})]}),u.jsxs("section",{ref:x,className:"mt-auto pt-6 border-t border-gray-200",children:[u.jsxs("button",{type:"button",onClick:()=>S("info"),className:"w-full flex items-center justify-between text-sm font-semibold text-gray-500 uppercase tracking-wide mb-3","aria-expanded":d.info,children:[u.jsx("span",{children:"About"}),u.jsx(so,{className:`w-5 h-5 text-gray-400 transition-transform ${d.info?"rotate-0":"-rotate-90"}`})]}),d.info&&u.jsxs("div",{className:"space-y-2 pb-4",children:[u.jsxs("a",{href:"https://github.com/cosmicbuffalo/comfyui-mobile-frontend",target:"_blank",rel:"noopener noreferrer",className:`w-full flex items-center gap-3 p-4 bg-white border border-gray-200
                         rounded-xl text-left hover:bg-gray-50 min-h-[56px]`,children:[u.jsx(WS,{className:"w-6 h-6 text-gray-600"}),u.jsx("span",{className:"font-medium text-gray-900",children:"Open in GitHub"}),u.jsx(gp,{className:"w-4 h-4 ml-auto text-gray-400"})]}),u.jsxs("button",{onClick:B,className:`w-full flex items-center gap-3 p-4 bg-white border border-gray-200
                         rounded-xl text-left hover:bg-gray-50 min-h-[56px]`,children:[u.jsx(FS,{className:"w-6 h-6 text-gray-600"}),u.jsx("span",{className:"font-medium text-gray-900",children:"Icon Legend"}),u.jsx("span",{className:"ml-auto text-gray-400",children:""})]}),u.jsxs("a",{href:"https://github.com/cosmicbuffalo/comfyui-mobile-frontend/blob/main/USER_GUIDE.md",target:"_blank",rel:"noopener noreferrer",className:`w-full flex items-center gap-3 p-4 bg-white border border-gray-200
                         rounded-xl text-left hover:bg-gray-50 min-h-[56px]`,children:[u.jsx(qS,{className:"w-6 h-6 text-gray-600"}),u.jsx("span",{className:"font-medium text-gray-900",children:"User Manual"}),u.jsx(gp,{className:"w-4 h-4 ml-auto text-gray-400"})]})]})]})]})}async function JS(n){if(navigator.clipboard?.writeText)try{await navigator.clipboard.writeText(n);return}catch{}const o=document.createElement("textarea");o.value=n,o.readOnly=!0,o.style.position="fixed",o.style.top="0",o.style.left="0",o.style.opacity="0",document.body.appendChild(o),o.focus(),o.select(),o.setSelectionRange(0,o.value.length),document.execCommand("copy"),document.body.removeChild(o)}function Ly(n,o,s){const a=n.current;if(a){if(a.focus(),o)a.setSelectionRange(o.start,o.end);else if(s!==void 0){const l=s.length;a.setSelectionRange(l,l)}}}function eN(n){const o=n.current;if(!o)return;const a=o.closest('[data-textarea-root="true"]')?.querySelector('[data-textarea-header="true"]');a?a.scrollIntoView({block:"nearest",behavior:"auto"}):o.scrollIntoView({block:"nearest",behavior:"auto"})}function jl({value:n,onChange:o,textareaRef:s,className:a=""}){const[l,c]=b.useState(!1),d=b.useRef(null),h=b.useRef(null),p=()=>{c(!0),d.current&&clearTimeout(d.current),d.current=setTimeout(()=>c(!1),900)},m=v=>{v.preventDefault()},y=async()=>{const v=s.current;v&&(h.current={start:v.selectionStart??0,end:v.selectionEnd??0});const k=s.current?.value??n;await JS(k),requestAnimationFrame(()=>Ly(s,h.current||void 0)),p()},x=()=>{o(""),requestAnimationFrame(()=>{Ly(s,void 0,""),eN(s)})};return u.jsxs("div",{className:`flex items-center text-[11px] text-gray-500 ${a}`,children:[u.jsxs("button",{type:"button",className:"inline-flex items-center gap-1 px-1 py-0.5 text-gray-600",onMouseDown:m,onClick:y,"aria-label":"Copy to clipboard",children:[l?u.jsx(zo,{className:"w-3.5 h-3.5 text-green-500"}):u.jsx(_S,{className:"w-3.5 h-3.5"}),u.jsx("span",{children:"Copy"})]}),u.jsx("span",{className:"text-gray-500/50",children:"|"}),u.jsxs("button",{type:"button",className:"inline-flex items-center gap-1 px-1 py-0.5 text-red-600",onMouseDown:m,onClick:x,"aria-label":"Clear text",children:[u.jsx(AS,{className:"w-3.5 h-3.5"}),u.jsx("span",{children:"Clear"})]})]})}function tN({error:n,pastedJson:o,pasteTextareaRef:s,onBack:a,onDismissError:l,onChangeJson:c,onLoad:d}){return u.jsxs("div",{className:"flex flex-col h-full",children:[u.jsx(Wl,{title:"Paste JSON",onBack:a}),u.jsx(Fl,{error:n,onDismiss:l}),u.jsxs("div",{className:"flex-1 flex flex-col space-y-4",children:[u.jsx("p",{className:"text-sm text-gray-600",children:"Paste your workflow JSON below."}),u.jsxs("div",{className:"group","data-textarea-root":"true",children:[u.jsxs("div",{className:"flex items-center justify-between mb-1","data-textarea-header":"true",children:[u.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Workflow JSON"}),u.jsx(jl,{value:o,onChange:c,textareaRef:s,className:"opacity-70 transition-opacity group-focus-within:opacity-100"})]}),u.jsx("textarea",{ref:s,value:o,onChange:h=>c(h.target.value),placeholder:'{"last_node_id": ...}',className:"w-full flex-1 p-3 border border-gray-300 rounded-lg font-mono text-xs resize-none outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),u.jsxs("div",{className:"flex gap-3 pt-2",children:[u.jsx("button",{onClick:a,className:"flex-1 py-3 bg-gray-100 text-gray-700 rounded-lg font-medium hover:bg-gray-200 min-h-[48px]",children:"Cancel"}),u.jsx("button",{onClick:d,disabled:!o.trim(),className:`flex-1 py-3 bg-blue-500 text-white rounded-lg font-medium hover:bg-blue-600
                       disabled:opacity-50 disabled:cursor-not-allowed min-h-[48px]`,children:"Load"})]})]})]})}function nN({error:n,loading:o,workflow:s,saveFilenameInput:a,onBack:l,onDismissError:c,onSaveFilenameChange:d,onSaveAs:h,onDownload:p}){return u.jsxs("div",{className:"flex flex-col h-full",children:[u.jsx(Wl,{title:"Save Workflow",onBack:l}),u.jsx(Fl,{error:n,onDismiss:c}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"p-4 bg-white border border-gray-200 rounded-xl",children:[u.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Save to ComfyUI server:"}),u.jsx("input",{type:"text",value:a,onChange:m=>d(m.target.value),placeholder:"Enter filename (e.g., my_workflow.json)",className:"w-full p-3 border border-gray-300 rounded-lg mb-3"}),u.jsx("button",{onClick:h,disabled:!s||!a.trim()||o,className:`w-full py-3 bg-blue-500 text-white rounded-lg font-medium
                       disabled:opacity-50 disabled:cursor-not-allowed min-h-[48px]`,children:o?"Saving...":"Save As"})]}),u.jsxs("button",{onClick:p,disabled:!s,className:`w-full flex items-center gap-3 px-4 py-3 bg-white border border-gray-200
                     rounded-xl text-left hover:bg-gray-50 min-h-[56px]
                     disabled:opacity-50 disabled:cursor-not-allowed`,children:[u.jsx($S,{className:"w-6 h-6 text-gray-600"}),u.jsx("span",{className:"font-medium text-gray-900",children:"Download to Device"})]})]})]})}function ql({value:n,onChange:o,onClear:s,placeholder:a="Search...",autoFocus:l=!1,className:c="",inputClassName:d="",disabled:h=!1,readOnly:p=!1,inputRef:m,showClearButton:y=!0}){const x=y&&n.trim().length>0&&!h&&!p;return u.jsxs("div",{className:`relative ${c}`.trim(),children:[u.jsx(cx,{className:"w-4 h-4 text-gray-400 absolute left-3 top-1/2 -translate-y-1/2 pointer-events-none"}),u.jsx("input",{ref:m,value:n,onChange:v=>o(v.target.value),placeholder:a,className:`w-full rounded-lg border border-gray-200 pl-9 pr-9 py-2 text-sm text-gray-900 placeholder:text-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent ${d}`.trim(),autoFocus:l,disabled:h,readOnly:p}),x&&u.jsx("button",{type:"button",onClick:()=>{if(s){s();return}o("")},className:"absolute right-2 top-1/2 -translate-y-1/2 p-1 text-gray-400 hover:text-gray-600","aria-label":"Clear search",children:u.jsx(Ul,{className:"w-4 h-4"})})]})}const oN={sm:"w-4 h-4 border-2",md:"w-6 h-6 border-2",lg:"w-10 h-10 border-4"},rN={blue:"border-blue-500 border-t-transparent",gray:"border-gray-200 border-t-gray-500"};function Xp({size:n="md",color:o="blue",className:s=""}){return u.jsx("div",{className:`animate-spin rounded-full ${oN[n]} ${rN[o]} ${s}`})}function sN({error:n,loading:o,templates:s,onBack:a,onDismissError:l,onLoadTemplate:c}){const[d,h]=b.useState(""),p=Object.entries(s),m=d.toLowerCase(),y=p.map(([v,k])=>[v,k.filter(w=>w.toLowerCase().includes(m))]).filter(([,v])=>v.length>0),x=p.length>0;return u.jsxs("div",{className:"flex flex-col h-full",children:[u.jsx(Wl,{title:"Templates",onBack:a}),u.jsx(Fl,{error:n,onDismiss:l}),!o&&x&&u.jsx("div",{className:"py-2",children:u.jsx(ql,{value:d,onChange:h,placeholder:"Search",inputClassName:"bg-white"})}),o?u.jsx("div",{className:"flex items-center justify-center py-8",children:u.jsx(Xp,{})}):x?y.length===0?u.jsx("p",{className:"text-gray-500 text-center py-8",children:"No matching templates"}):u.jsx("div",{className:"space-y-4 overflow-y-auto flex-1",children:y.map(([v,k])=>u.jsxs("div",{children:[u.jsx("h4",{className:"text-sm font-semibold text-gray-600 mb-2",children:v}),u.jsx("div",{className:"space-y-2",children:k.map(w=>u.jsxs("button",{onClick:()=>c(v,w),className:`w-full flex items-center gap-3 px-4 py-3 bg-white border border-gray-200
                               rounded-xl text-left hover:bg-gray-50 min-h-[56px]`,children:[u.jsx(hx,{className:"w-5 h-5 text-gray-600"}),u.jsx("span",{className:"font-medium text-gray-900 truncate",children:w.replace(/\.json$/,"")})]},w))})]},v))}):u.jsx("p",{className:"text-gray-500 text-center py-8",children:"No templates available"})]})}function aN(n){const o=new Date,s=new Date(n*1e3),a=o.getTime()-s.getTime(),l=Math.floor(a/(1e3*60*60*24)),c=String(s.getMonth()+1),d=String(s.getDate()),h=String(s.getFullYear()).slice(-2),p=`${c}/${d}/${h}`;return l===0?`${p} (Today)`:l===1?`${p} (Yesterday)`:`${p} (${l} days ago)`}function lN({error:n,loading:o,userWorkflows:s,onBack:a,onDismissError:l,onLoadWorkflow:c}){const[d,h]=b.useState(""),[p,m]=b.useState("name"),y=s.filter(v=>v.name.toLowerCase().includes(d.toLowerCase())).sort((v,k)=>p==="name"?v.name.localeCompare(k.name):(k.modified??0)-(v.modified??0)),x=u.jsxs("button",{onClick:()=>m(p==="name"?"date":"name"),className:"flex items-center gap-0.5 text-xs font-semibold text-blue-500",children:[u.jsx("span",{children:p==="name"?"NAME":"DATE"}),u.jsx("span",{children:""})]});return u.jsxs("div",{className:"flex flex-col h-full",children:[u.jsx(Wl,{title:"My Workflows",onBack:a,rightElement:x}),u.jsx(Fl,{error:n,onDismiss:l}),!o&&s.length>0&&u.jsx("div",{className:"py-2",children:u.jsx(ql,{value:d,onChange:h,placeholder:"Search",inputClassName:"bg-white"})}),o?u.jsx("div",{className:"flex items-center justify-center py-8",children:u.jsx(Xp,{})}):s.length===0?u.jsx("p",{className:"text-gray-500 text-center py-8",children:"No saved workflows yet"}):y.length===0?u.jsx("p",{className:"text-gray-500 text-center py-8",children:"No matching workflows"}):u.jsx("div",{className:"space-y-2 overflow-y-auto flex-1",children:y.map(v=>u.jsxs("button",{onClick:()=>c(v.name),className:`w-full flex items-center gap-3 px-4 py-3 bg-white border border-gray-200
                         rounded-xl text-left hover:bg-gray-50 min-h-[56px]`,children:[u.jsx(Ts,{className:"w-5 h-5 text-gray-600"}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("p",{className:"font-medium text-gray-900 truncate",children:v.name.replace(/\.json$/,"")}),v.modified&&u.jsx("p",{className:"text-xs text-gray-500",children:aN(v.modified)})]})]},v.path))})]})}const wa=vo()(jr(n=>({theme:"dark",setTheme:o=>{n({theme:o})},toggleTheme:()=>{n(o=>({theme:o.theme==="dark"?"light":"dark"}))}}),{name:"theme-storage",storage:Cr(()=>localStorage)}));function iN({open:n,onClose:o}){const s=de(ue=>ue.loadWorkflow),a=de(ue=>ue.workflow),l=de(ue=>ue.currentFilename),c=de(ue=>ue.originalWorkflow),d=de(ue=>ue.setSavedWorkflow),h=wa(ue=>ue.theme),p=wa(ue=>ue.toggleTheme),m=b.useRef(null),y=!!(a&&c&&JSON.stringify(a)!==JSON.stringify(c)),x=b.useRef(null),[v,k]=b.useState(null),[w,S]=b.useState("menu"),[j,C]=b.useState([]),[T,R]=b.useState({}),[D,L]=b.useState(!1),[B,A]=b.useState(l||""),[F,te]=b.useState(""),[ee,ae]=b.useState({load:!0,save:!0,appearance:!0,info:!0}),ne=b.useRef(null),me=b.useRef(null),Le=b.useRef(null),P=b.useRef(null),V=b.useRef(ee);b.useEffect(()=>{const ue=V.current,ye=ee;!ue.load&&ye.load?setTimeout(()=>ne.current?.scrollIntoView({behavior:"smooth",block:"nearest"}),100):!ue.save&&ye.save?setTimeout(()=>me.current?.scrollIntoView({behavior:"smooth",block:"nearest"}),100):!ue.appearance&&ye.appearance?setTimeout(()=>Le.current?.scrollIntoView({behavior:"smooth",block:"nearest"}),100):!ue.info&&ye.info&&setTimeout(()=>P.current?.scrollIntoView({behavior:"smooth",block:"nearest"}),100),V.current=ye},[ee]),b.useEffect(()=>{n||(S("menu"),k(null),A(l||""),te(""),ae({load:!0,save:!0,appearance:!0,info:!0}))},[n,l]),b.useEffect(()=>{w==="userWorkflows"&&(L(!0),Gw().then(C).catch(ue=>k(ue.message)).finally(()=>L(!1)))},[w]),b.useEffect(()=>{w==="templates"&&(L(!0),Pw().then(R).catch(ue=>k(ue.message)).finally(()=>L(!1)))},[w]);const H=ue=>{"vibrate"in navigator&&navigator.vibrate(ue)},ce=()=>{x.current?.click()},ke=async ue=>{const ye=ue.target.files?.[0];if(ye){try{const et=await ye.text(),oe=JSON.parse(et);if(!oe.nodes||!Array.isArray(oe.nodes))throw new Error("Invalid workflow: missing nodes array");s(oe,ye.name),k(null),o(),H(10)}catch(et){k(et instanceof Error?et.message:"Failed to load workflow")}x.current&&(x.current.value="")}},Ne=async ue=>{try{L(!0);const ye=await Ap(ue);s(ye,ue,{fresh:!0,source:{type:"user",filename:ue}}),k(null),o(),H(10)}catch(ye){k(ye instanceof Error?ye.message:"Failed to load workflow")}finally{L(!1)}},O=async(ue,ye)=>{try{L(!0);const et=await Rp(ue,ye);s(et,`${ue}/${ye}`,{fresh:!0,source:{type:"template",moduleName:ue,templateName:ye}}),k(null),o(),H(10)}catch(et){k(et instanceof Error?et.message:"Failed to load template")}finally{L(!1)}},_=async ue=>{if(!a)return;const ye=ue.endsWith(".json")?ue:`${ue}.json`;try{L(!0),await Wb(ye,qu(a)),d(a,ye),k(null),o(),H(10)}catch(et){k(et instanceof Error?et.message:"Failed to save workflow")}finally{L(!1)}},q=()=>{l?_(l):S("save")},je=()=>{A(l||""),S("save")},Ke=()=>{B.trim()?_(B):k("Please enter a filename.")},De=()=>{if(!a)return;const ue=JSON.stringify(qu(a),null,2),ye=new Blob([ue],{type:"application/json"}),et=URL.createObjectURL(ye),oe=document.createElement("a");oe.href=et,oe.download=`${l||`workflow-${Date.now()}`}.json`,oe.click(),URL.revokeObjectURL(et),H(10),o()},Fe=()=>{try{const ue=JSON.parse(F);if(!ue.nodes||!Array.isArray(ue.nodes))throw new Error("Invalid workflow: missing nodes array");const ye=new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"});s(ue,`Pasted workflow (${ye})`),k(null),o(),H(10),te("")}catch(ue){k(ue instanceof Error?ue.message:"Failed to parse JSON")}};return u.jsxs(xS,{open:n,onClose:o,side:"left",title:"ComfyUI Mobile",children:[w==="menu"&&u.jsx(ZS,{error:v,workflow:a,currentFilename:l,isDirty:y,loading:D,theme:h,menuSectionsOpen:ee,fileInputRef:x,loadSectionRef:ne,saveSectionRef:me,appearanceSectionRef:Le,infoSectionRef:P,onDismissError:()=>k(null),onFileChange:ke,onLoadFromFile:ce,onToggleSection:ue=>ae(ye=>({...ye,[ue]:!ye[ue]})),onOpenUserWorkflows:()=>S("userWorkflows"),onOpenTemplates:()=>S("templates"),onOpenPasteJson:()=>S("pasteJson"),onSave:q,onOpenSaveAs:je,onToggleTheme:p,onOpenLegend:()=>S("aboutLegend")}),w==="userWorkflows"&&u.jsx(lN,{error:v,loading:D,userWorkflows:j,onBack:()=>S("menu"),onDismissError:()=>k(null),onLoadWorkflow:Ne}),w==="templates"&&u.jsx(sN,{error:v,loading:D,templates:T,onBack:()=>S("menu"),onDismissError:()=>k(null),onLoadTemplate:O}),w==="save"&&u.jsx(nN,{error:v,loading:D,workflow:a,saveFilenameInput:B,onBack:()=>S("menu"),onDismissError:()=>k(null),onSaveFilenameChange:A,onSaveAs:Ke,onDownload:De}),w==="pasteJson"&&u.jsx(tN,{error:v,pastedJson:F,pasteTextareaRef:m,onBack:()=>S("menu"),onDismissError:()=>k(null),onChangeJson:te,onLoad:Fe}),w==="aboutLegend"&&u.jsx(XS,{onBack:()=>S("menu")})]})}function Na({open:n,onDismiss:o,triggerRef:s,contentRef:a,ignoreScrollWithinContent:l=!1}){b.useEffect(()=>{if(!n)return;const c=h=>{const p=h.target;s.current&&p&&s.current.contains(p)||a.current&&p&&a.current.contains(p)||o()},d=h=>{if(l){const p=h.target;if(a.current&&p&&a.current.contains(p))return}o()};return document.addEventListener("mousedown",c),document.addEventListener("scroll",d,!0),()=>{document.removeEventListener("mousedown",c),document.removeEventListener("scroll",d,!0)}},[n,o,s,a,l])}function Qo({onClose:n,title:o,description:s,actions:a,actionsLayout:l="inline",zIndex:c=2200}){const d=h=>h==="danger"?"px-3 py-2 rounded-lg text-sm font-medium text-white bg-red-600 hover:bg-red-700":h==="primary"?"px-3 py-2 rounded-lg text-sm font-medium text-white bg-blue-600 hover:bg-blue-700":"px-3 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-100";return u.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4",style:{zIndex:c},onClick:n,role:"dialog","aria-modal":"true",children:u.jsxs("div",{className:"w-full max-w-sm bg-white border border-gray-200 rounded-xl shadow-lg p-4",onClick:h=>h.stopPropagation(),children:[u.jsx("div",{className:"text-gray-900 text-base font-semibold",children:o}),s&&u.jsx("div",{className:"text-gray-600 text-sm mt-1",children:s}),u.jsx("div",{className:l==="stack"?"mt-4 flex flex-col gap-2":"mt-4 flex justify-end gap-2",children:a.map(h=>u.jsx("button",{className:`${d(h.variant)} ${h.className??""}`.trim(),onClick:h.onClick,children:h.label},h.label))})]})})}function ns({onClick:n,ariaLabel:o,buttonRef:s,icon:a,buttonSize:l=10,iconSize:c=5}){return u.jsx("button",{type:"button",onClick:n,"aria-label":o,className:`w-${l} h-${l} flex items-center justify-center rounded-lg bg-transparent hover:bg-transparent text-inherit`,ref:s,children:a??u.jsx(jS,{className:`w-${c} h-${c}`})})}const uN={default:{row:"text-gray-900 hover:bg-gray-50",icon:"text-gray-500"},muted:{row:"text-gray-600 hover:bg-gray-50",icon:"text-gray-500"},danger:{row:"text-red-600 hover:bg-red-50",icon:"text-red-500"},primary:{row:"text-blue-600 hover:bg-blue-50",icon:"text-blue-500"}};function Sr({items:n,className:o,itemClassName:s}){return u.jsx("div",{className:`bg-white border border-gray-200 rounded-lg shadow-lg overflow-hidden ${o??""}`.trim(),children:n.map(a=>{if(a.type==="divider")return u.jsx("div",{className:`border-t border-gray-200 my-1 ${a.className??""}`.trim()},a.key);if(a.type==="custom")return a.hidden?null:u.jsx("div",{children:typeof a.render=="function"?a.render():a.render},a.key);if(a.hidden)return null;const l=uN[a.color??"default"];return u.jsxs("button",{type:"button",className:["w-full flex items-center gap-2 text-left px-3 py-2 text-sm",a.rightSlot?"justify-between":"",l.row,a.disabled?"opacity-50 cursor-not-allowed":"",s??"",a.className??""].join(" ").trim(),onClick:a.onClick,disabled:a.disabled,children:[u.jsxs("span",{className:"flex items-center gap-2 min-w-0",children:[a.icon?u.jsx("span",{className:l.icon,children:a.icon}):null,u.jsx("span",{className:"truncate",children:a.label})]}),a.rightSlot?u.jsx("span",{className:"shrink-0",children:a.rightSlot}):null]},a.key)})})}function cN({open:n,buttonRef:o,menuRef:s,onToggle:a,onClose:l,onGoToWorkflow:c,onOpenClearHistoryConfirm:d}){const h=Ht(_=>_.setQueueItemExpanded),p=Ht(_=>_.queueItemExpanded),m=Ht(_=>_.showQueueMetadata),y=Ht(_=>_.toggleShowQueueMetadata),x=Ht(_=>_.previewVisibility),v=Ht(_=>_.setPreviewVisibility),k=Ht(_=>_.previewVisibilityDefault),w=Ht(_=>_.setPreviewVisibilityDefault),S=Ht(_=>_.pending),j=Ht(_=>_.running),C=Ht(_=>_.clearQueue),T=qn(_=>_.history),R=qn(_=>_.clearEmptyItems),D=S.length>0,L=T.length>0,B=T.some(_=>_.outputs.images.length===0),A=S.length+j.length+T.length>0,F=b.useMemo(()=>{const _=new Set;return S.forEach(q=>_.add(q.prompt_id)),j.forEach(q=>_.add(q.prompt_id)),T.forEach(q=>{q.prompt_id&&_.add(String(q.prompt_id))}),Array.from(_)},[S,j,T]),te=b.useMemo(()=>F.some(_=>p[_]===!1),[F,p]),ee=b.useMemo(()=>F.some(_=>p[_]!==!1),[F,p]),ae=b.useMemo(()=>{const _=new Set;return T.forEach(q=>{(q.outputs?.images??[]).some(De=>De.type!=="output")&&q.prompt_id&&_.add(String(q.prompt_id))}),Array.from(_)},[T]),ne=A||ae.length>0||k,me=ae.length>0?ae.every(_=>x[_]??k):k,Le=()=>{c(),l()},P=async()=>{await C(),l()},V=()=>{F.forEach(_=>h(_,!1)),l()},H=()=>{F.forEach(_=>h(_,!0)),l()},ce=()=>{y(),l()},ke=()=>{const _=!me;w(_),ae.forEach(q=>v(q,_)),l()},Ne=async()=>{await R(),l()},O=()=>{l(),d()};return u.jsxs("div",{id:"queue-menu-container",className:"relative",children:[u.jsx(ns,{buttonRef:o,onClick:a,ariaLabel:"Queue options"}),n?u.jsx("div",{id:"queue-options-dropdown",ref:s,className:"absolute right-0 top-11 z-50 w-48",children:u.jsx(Sr,{items:[{key:"go-to-workflow",label:"Go to workflow",icon:u.jsx(Yu,{className:"w-3 h-3 rotate-180"}),onClick:Le},{key:"cancel-pending",label:"Cancel all pending",icon:u.jsx(TS,{className:"w-4 h-4"}),onClick:P,hidden:!D},{key:"fold-all",label:"Fold all",icon:u.jsx(js,{className:"w-7 h-7 -ml-1"}),onClick:V,hidden:!ee},{key:"unfold-all",label:"Unfold all",icon:u.jsx(so,{className:"w-7 h-7 -ml-1"}),onClick:H,hidden:!te},{key:"toggle-metadata",label:m?"Hide metadata":"Show metadata",icon:u.jsx(lx,{className:"w-4 h-4"}),onClick:ce,hidden:!L},{key:"toggle-previews",label:me?"Hide previews":"Show previews",icon:me?u.jsx(Yo,{className:"w-4 h-4"}):u.jsx(br,{className:"w-4 h-4"}),onClick:ke,hidden:!ne},{key:"clear-empty",label:"Clear empty items",icon:u.jsx(Ho,{className:"w-4 h-4"}),onClick:Ne,color:"muted",hidden:!B},{key:"clear-history",label:"Clear history",icon:u.jsx(Ho,{className:"w-4 h-4"}),onClick:O,color:"danger",hidden:!L}]})}):null]})}function dN(){const[n,o]=b.useState(!1),[s,a]=b.useState(!1),l=ao(p=>p.setCurrentPanel),c=qn(p=>p.clearHistory),d=b.useRef(null),h=b.useRef(null);return Na({open:n,onDismiss:()=>o(!1),triggerRef:d,contentRef:h}),u.jsxs(u.Fragment,{children:[u.jsx(cN,{open:n,buttonRef:d,menuRef:h,onToggle:()=>o(p=>!p),onClose:()=>o(!1),onGoToWorkflow:()=>l("workflow"),onOpenClearHistoryConfirm:()=>a(!0)}),s&&An.createPortal(u.jsx(Qo,{onClose:()=>a(!1),title:"Clear history?",description:"This will permanently remove all completed generations from history. Generated files will still be present in your server's output folder.",actions:[{label:"Cancel",onClick:()=>a(!1),variant:"secondary"},{label:"Clear history",onClick:()=>{(async()=>(await c(),a(!1)))()},variant:"danger"}]}),document.body)]})}function fN({open:n,buttonRef:o,menuRef:s,onToggle:a,onClose:l,onGoToWorkflow:c}){const d=Jt(D=>D.source),h=Jt(D=>D.viewMode),p=Jt(D=>D.showHidden),m=Jt(D=>D.setSource),y=Jt(D=>D.setViewMode),x=Jt(D=>D.toggleShowHidden),v=Jt(D=>D.toggleSelectionMode),k=Jt(D=>D.setNewFolderModalOpen),w=()=>{k(!0),l()},S=()=>{m(d==="output"?"input":"output"),l()},j=()=>{c(),l()},C=()=>{v(),l()},T=()=>{x(),l()},R=()=>{y(h==="grid"?"list":"grid"),l()};return u.jsxs("div",{id:"outputs-topbar-actions",className:"relative flex items-center gap-1",children:[u.jsx(ns,{buttonRef:o,onClick:a,ariaLabel:"Outputs options"}),n?u.jsx("div",{id:"outputs-options-dropdown",ref:s,className:"absolute right-0 top-11 z-50 w-48",children:u.jsx(Sr,{items:[{key:"toggle-source",label:d==="output"?"Switch to inputs":"Switch to outputs",icon:u.jsx(Pp,{className:"w-4 h-4"}),onClick:S},{key:"go-to-workflow",label:"Go to workflow",icon:u.jsx(Yu,{className:"w-3 h-3"}),onClick:j},{key:"select",label:"Select",icon:u.jsx(zo,{className:"w-4 h-4"}),onClick:C},{key:"new-folder",label:"New folder",icon:u.jsx(xr,{className:"w-4 h-4"}),onClick:w},{key:"toggle-hidden",label:p?"Hide hidden files":"Show hidden files",icon:p?u.jsx(Yo,{className:"w-4 h-4"}):u.jsx(br,{className:"w-4 h-4"}),onClick:T},{key:"toggle-view",label:h==="grid"?"List view":"Grid view",icon:h==="grid"?u.jsx(NS,{className:"w-4 h-4"}):u.jsx(BS,{className:"w-4 h-4"}),onClick:R}]})}):null]})}function pN(){const[n,o]=b.useState(!1),s=ao(c=>c.setCurrentPanel),a=b.useRef(null),l=b.useRef(null);return Na({open:n,onDismiss:()=>o(!1),triggerRef:a,contentRef:l}),u.jsx(fN,{open:n,buttonRef:a,menuRef:l,onToggle:()=>o(c=>!c),onClose:()=>o(!1),onGoToWorkflow:()=>s("workflow")})}const hN=5;function gN(n){const o={};for(const s of n)o[s.id]={mode:s.mode,flags:s.flags?{collapsed:!!s.flags.collapsed}:void 0,widgets_values:s.widgets_values};return o}function mN(n,o,s,a){return{nodes:gN(n.nodes),seedModes:{...o},collapsedItems:{...s},hiddenItems:{...a}}}function _y(n,o){if(n===o)return!0;if(n.length!==o.length)return!1;for(let s=0;s<n.length;s+=1)if(n[s]!==o[s])return!1;return!0}function Ay(n){const{workflow:o}=de.getState();if(!o)return[];const s=new Set;for(const c of o.nodes??[])c.stableKey&&s.add(c.stableKey);for(const c of o.groups??[])c.stableKey&&s.add(c.stableKey);for(const c of o.definitions?.subgraphs??[]){c.stableKey&&s.add(c.stableKey);for(const d of c.groups??[])d.stableKey&&s.add(d.stableKey)}const a=[],l=new Set;for(const c of n)!c||l.has(c)||s.has(c)&&(l.add(c),a.push(c));return a}const Xn=vo()(jr((n,o)=>({bookmarkedItems:[],bookmarkBarSide:"right",bookmarkBarTop:null,bookmarkRepositioningActive:!1,toggleBookmark:s=>{if(!s)return;const{bookmarkedItems:a}=o(),{currentWorkflowKey:l,savedWorkflowStates:c,workflow:d,collapsedItems:h,hiddenItems:p}=de.getState(),m=Qn.getState().seedModes,x=a.includes(s)?a.filter(v=>v!==s):a.length>=hN?a:[...a,s];if(x!==a){if(l){let k=c[l];!k&&d&&(k=mN(d,m,h,p)),k&&de.setState({savedWorkflowStates:{...c,[l]:{...k,bookmarkedItems:[...x]}}})}n({bookmarkedItems:x})}},clearBookmarks:()=>{const{currentWorkflowKey:s,savedWorkflowStates:a}=de.getState();if(s&&a[s]){const l=a[s];de.setState({savedWorkflowStates:{...a,[s]:{...l,bookmarkedItems:[]}}})}n({bookmarkedItems:[]})},setBookmarkBarPosition:s=>{n(a=>({bookmarkBarSide:s.side??a.bookmarkBarSide,bookmarkBarTop:s.top??a.bookmarkBarTop}))},setBookmarkRepositioningActive:s=>{n({bookmarkRepositioningActive:s})}}),{name:"bookmark-bar-storage",storage:Cr(()=>localStorage),partialize:n=>({bookmarkBarSide:n.bookmarkBarSide,bookmarkBarTop:n.bookmarkBarTop})}));function yN(){const{workflow:n,currentWorkflowKey:o,savedWorkflowStates:s}=de.getState(),{bookmarkedItems:a}=Xn.getState();if(!n){a.length>0&&Xn.setState({bookmarkedItems:[]});return}if(!o){const d=Ay(a);_y(a,d)||Xn.setState({bookmarkedItems:d});return}const l=s[o],c=Ay(l?.bookmarkedItems??[]);_y(a,c)||Xn.setState({bookmarkedItems:c})}de.subscribe(()=>{yN()});function rn(n,o){if(!n)throw new Error(`Missing stable key for ${o}. Workflow must be canonicalized before render.`);return n}function bN({open:n,buttonRef:o,menuRef:s,onToggle:a,onClose:l,onGoToQueue:c,onGoToOutputs:d,onAddNode:h,onOpenWorkflowActions:p}){const m=de(K=>K.workflow),y=de(K=>K.nodeTypes),x=de(K=>K.setItemCollapsed),v=de(K=>K.setItemHidden),k=de(K=>K.showAllHiddenNodes),w=de(K=>K.hiddenItems),S=Xn(K=>K.bookmarkedItems),j=Xn(K=>K.clearBookmarks),C=de(K=>K.collapsedItems),T=de(K=>K.workflowSource),R=de(K=>K.loadWorkflow),D=de(K=>K.searchOpen),L=de(K=>K.setSearchOpen),B=de(K=>K.setSearchQuery),A=de(K=>K.connectionButtonsVisible),F=de(K=>K.toggleConnectionButtonsVisible),te=qn(K=>K.history),ee=b.useCallback((K,Te)=>!!K[Te],[]),ae=!!m,ne=b.useMemo(()=>m?.nodes.map(K=>rn(K.stableKey,`node ${K.id}`))??[],[m]),me=b.useMemo(()=>[...m?.groups??[],...(m?.definitions?.subgraphs??[]).flatMap(Te=>Te.groups??[])].map(Te=>rn(Te.stableKey,`group ${Te.id}`)),[m]),Le=b.useMemo(()=>m?.definitions?.subgraphs?.map(K=>rn(K.stableKey,`subgraph ${K.id}`))??[],[m]),P=b.useMemo(()=>m?.nodes.filter(K=>K.mode===4)??[],[m]),V=b.useMemo(()=>!m||!y?[]:m.nodes.filter(K=>{if(K.type==="Fast Groups Bypasser (rgthree)")return!1;const Te=Up(y,K).filter(qe=>!qe.connected),_e=Wp(y,K).filter(qe=>!qe.connected);return Te.length===0&&_e.length===0}),[m,y]),H=P.length,ce=V.length,ke=b.useMemo(()=>Object.values(w).filter(Boolean).length,[w]),Ne=b.useMemo(()=>P.filter(K=>(()=>{const Te=rn(K.stableKey,`node ${K.id}`);return w[Te]})()).length,[P,w]),O=b.useMemo(()=>V.filter(K=>(()=>{const Te=rn(K.stableKey,`node ${K.id}`);return w[Te]})()).length,[V,w]),_=b.useMemo(()=>m?m.nodes.filter(K=>(()=>{const Te=rn(K.stableKey,`node ${K.id}`);return!w[Te]})()):[],[m,w]),q=b.useMemo(()=>_.some(K=>{const Te=rn(K.stableKey,`node ${K.id}`);return C[Te]===!0}),[C,_]),je=b.useMemo(()=>_.some(K=>{const Te=rn(K.stableKey,`node ${K.id}`);return C[Te]!==!0}),[C,_]),Ke=b.useMemo(()=>me.some(K=>C[K]===!0),[me,C]),De=b.useMemo(()=>me.some(K=>(C[K]??!1)===!1),[me,C]),Fe=b.useMemo(()=>Le.some(K=>C[K]??!1),[Le,C]),ue=b.useMemo(()=>Le.some(K=>(C[K]??!1)===!1),[Le,C]),ye=q||Ke||Fe,et=je||De||ue,oe=b.useMemo(()=>ke>0||me.some(Te=>ee(w,Te))?!0:Le.some(Te=>w[Te]===!0),[ke,w,me,Le,ee]),[z,U]=b.useState(!1),se=()=>{l()},fe=()=>{c(),se()},M=()=>{d(),se()},re=()=>{B(""),L(!0),se()},W=()=>{h(),se()},G=()=>{ne.forEach(K=>x(K,!0)),me.forEach(K=>x(K,!0)),Le.forEach(K=>x(K,!0)),se()},I=()=>{ne.forEach(K=>x(K,!1)),me.forEach(K=>x(K,!1)),Le.forEach(K=>x(K,!1)),se()},$=()=>{k(),me.forEach(K=>v(K,!1)),Le.forEach(K=>v(K,!1))},Z=()=>{j(),se()},Se=async()=>{if(!(!T||T.type!=="user")){try{const K=await Ap(T.filename);R(K,T.filename,{fresh:!0,source:T})}catch(K){console.error("Failed to reload workflow:",K)}se()}},Q=async()=>{if(!(!T||T.type!=="template")){try{const K=await Rp(T.moduleName,T.templateName);R(K,`${T.moduleName}/${T.templateName}`,{fresh:!0,source:T})}catch(K){console.error("Failed to reload template:",K)}se()}},Me=()=>{if(!T||T.type!=="history")return;const K=te.find(Te=>Te.prompt_id===T.promptId);K?.workflow&&R(K.workflow,`history-${T.promptId}.json`,{source:T}),se()};return u.jsxs("div",{id:"workflow-menu-container",className:"relative",children:[u.jsx(ns,{buttonRef:o,onClick:a,ariaLabel:"Workflow options"}),n?u.jsx("div",{id:"workflow-options-dropdown",ref:s,className:"absolute right-0 top-11 z-50 w-52",children:u.jsx(Sr,{items:[{key:"go-to-queue",label:"Go to queue",icon:u.jsx(Yu,{className:"w-3 h-3"}),onClick:fe},{key:"go-to-outputs",label:"Go to outputs",icon:u.jsx(Yu,{className:"w-3 h-3 rotate-180"}),onClick:M},{key:"search",label:"Search",icon:u.jsx(cx,{className:"w-4 h-4"}),onClick:re,hidden:D},{key:"add-node",label:"Add node",icon:u.jsx(Io,{className:"w-4 h-4"}),onClick:W,hidden:!ae},{key:"hide-show",label:"Hide / Show",icon:u.jsx(br,{className:"w-4 h-4"}),onClick:()=>{U(!0),se()}},{key:"fold-all",label:"Fold all",icon:u.jsx(js,{className:"w-6 h-6 -ml-1"}),onClick:G,hidden:!et},{key:"unfold-all",label:"Unfold all",icon:u.jsx(so,{className:"w-6 h-6 -ml-1"}),onClick:I,hidden:!ye},{key:"clear-bookmarks",label:"Clear bookmarks",icon:u.jsx(Ho,{className:"w-4 h-4"}),onClick:Z,hidden:S.length===0},{key:"reload-workflow",label:"Reload workflow",icon:u.jsx(Pp,{className:"w-4 h-4"}),onClick:T?.type==="user"?Se:T?.type==="template"?Q:T?.type==="history"&&te.find(K=>K.prompt_id===T.promptId)?.workflow?Me:void 0,hidden:!T||T.type==="history"&&!te.find(K=>K.prompt_id===T.promptId)?.workflow},{key:"workflow-actions",label:"Workflow actions",icon:u.jsx(Ts,{className:"w-4 h-4"}),onClick:()=>{p(),se()}}]})}):null,z&&u.jsx("div",{className:"fixed inset-0 z-[2150] bg-black/50 flex items-center justify-center p-4",onClick:()=>U(!1),role:"dialog","aria-modal":"true",children:u.jsxs("div",{className:"w-full max-w-sm bg-white border border-gray-200 rounded-xl shadow-lg overflow-hidden",onClick:K=>K.stopPropagation(),children:[u.jsx("div",{className:"px-4 py-3 text-sm font-semibold text-gray-700 border-b border-gray-100",children:"Hide / Show"}),u.jsx("div",{className:"max-h-[50vh] overflow-y-auto",children:u.jsx(Sr,{itemClassName:"px-4 py-3",items:[{key:"static-nodes",label:O<ce?`Hide static nodes (${ce})`:`Show static nodes (${ce})`,icon:O<ce?u.jsx(Yo,{className:"w-4 h-4"}):u.jsx(br,{className:"w-4 h-4"}),onClick:()=>{O<ce?V.forEach(K=>{const Te=rn(K.stableKey,`node ${K.id}`);v(Te,!0)}):V.forEach(K=>{const Te=rn(K.stableKey,`node ${K.id}`);v(Te,!1)})},hidden:ce===0},{key:"bypassed-nodes",label:Ne>0?`Show bypassed nodes (${H})`:`Hide bypassed nodes (${H})`,icon:Ne>0?u.jsx(br,{className:"w-4 h-4"}):u.jsx(Yo,{className:"w-4 h-4"}),onClick:()=>{Ne>0?P.forEach(K=>{const Te=rn(K.stableKey,`node ${K.id}`);v(Te,!1)}):P.forEach(K=>{const Te=rn(K.stableKey,`node ${K.id}`);v(Te,!0)})},hidden:H===0},{key:"toggle-connection-buttons",label:A?"Hide connection buttons":"Show connection buttons",icon:A?u.jsx(Yo,{className:"w-4 h-4"}):u.jsx(br,{className:"w-4 h-4"}),onClick:F},{key:"show-all-hidden",label:"Show all hidden nodes",icon:u.jsx(br,{className:"w-4 h-4"}),onClick:$,hidden:!oe}]})}),u.jsx("div",{className:"px-4 py-3 border-t border-gray-100 flex justify-end",children:u.jsx("button",{className:"px-3 py-2 text-sm font-medium text-gray-600 hover:bg-gray-100 rounded-lg",onClick:()=>U(!1),children:"Cancel"})})]})})]})}function ia({icon:n,label:o,onClick:s,disabled:a,description:l,tone:c="default"}){const d=c==="danger";return u.jsxs("button",{className:`w-full flex items-start gap-3 text-left px-4 py-3 disabled:opacity-50 ${d?"text-red-600 hover:bg-red-50":"hover:bg-gray-50"}`,onClick:s,disabled:a,children:[u.jsx("span",{className:"shrink-0 self-start mt-[3px]",children:n}),u.jsxs("span",{className:"flex flex-col min-w-0",children:[u.jsx("span",{className:`text-sm ${d?"text-red-600":"text-gray-900"}`,children:o}),l?u.jsx("span",{className:"text-xs text-gray-500",children:l}):null]})]})}function xN(){const[n,o]=b.useState(null),[s,a]=b.useState(null),[l,c]=b.useState(!1),[d,h]=b.useState(!1),[p,m]=b.useState(""),[y,x]=b.useState(null),[v,k]=b.useState(!1),w=de(O=>O.workflow),S=de(O=>O.originalWorkflow),j=de(O=>O.currentFilename),C=de(O=>O.workflowSource),T=de(O=>O.loadWorkflow),R=de(O=>O.setSavedWorkflow),D=de(O=>O.clearWorkflowCache),L=de(O=>O.unloadWorkflow),B=de(O=>O.requestAddNodeModal),A=ao(O=>O.setCurrentPanel),F=de(O=>O.workflowLoadedAt),te=qn(O=>O.history),ee=b.useRef(null),ae=b.useRef(null),ne=n!==null&&n===F,me=b.useMemo(()=>!!(w&&S&&JSON.stringify(w)!==JSON.stringify(S)),[w,S]);Na({open:ne,onDismiss:()=>o(null),triggerRef:ee,contentRef:ae});const Le=async()=>{if(localStorage.clear(),sessionStorage.clear(),"caches"in window){const O=await caches.keys();await Promise.all(O.map(_=>caches.delete(_)))}document.cookie.split(";").forEach(O=>{const[_]=O.split("=");document.cookie=`${_.trim()}=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/`}),window.location.reload()},P=async O=>{if(!w)return;const _=O.endsWith(".json")?O:`${O}.json`;try{k(!0),await Wb(_,qu(w)),R(w,_),x(null),h(!1),c(!1)}catch(q){x(q instanceof Error?q.message:"Failed to save workflow")}finally{k(!1)}},V=async()=>{if(!C){S&&T(S,j??void 0,{fresh:!0,source:{type:"other"}});return}if(C.type==="user"){const O=await Ap(C.filename);T(O,C.filename,{fresh:!0,source:C});return}if(C.type==="template"){const O=await Rp(C.moduleName,C.templateName);T(O,`${C.moduleName}/${C.templateName}`,{fresh:!0,source:C});return}if(C.type==="history"){const O=te.find(_=>_.prompt_id===C.promptId);O?.workflow&&T(O.workflow,`history-${C.promptId}.json`,{fresh:!0,source:C});return}S&&T(S,j??void 0,{fresh:!0,source:C})},H=O=>{if(me){a(O);return}O==="unload"?L():O==="clearWorkflowCache"?D():O==="clearAllCache"?Le():V(),c(!1)},ce=async O=>{a(null);try{k(!0),O==="unload"?L():O==="clearWorkflowCache"?D():O==="clearAllCache"?await Le():await V(),c(!1)}catch(_){x(_ instanceof Error?_.message:"Failed to complete action")}finally{k(!1)}},ke=()=>{o(null),x(null),c(!0)},Ne=()=>{B({groupId:null,subgraphId:null})};return u.jsxs(u.Fragment,{children:[u.jsx(bN,{open:ne,buttonRef:ee,menuRef:ae,onToggle:()=>o(ne?null:F),onClose:()=>o(null),onGoToQueue:()=>A("queue"),onGoToOutputs:()=>A("outputs"),onAddNode:Ne,onOpenWorkflowActions:ke}),l&&u.jsx("div",{className:"fixed inset-0 z-[1450] bg-black/50 flex items-center justify-center p-4",onClick:()=>c(!1),role:"dialog","aria-modal":"true",children:u.jsxs("div",{className:"w-full max-w-sm bg-white border border-gray-200 rounded-xl shadow-lg overflow-hidden",onClick:O=>O.stopPropagation(),children:[u.jsx("div",{className:"px-4 py-3 text-sm font-semibold text-gray-700 border-b border-gray-100",children:"Workflow actions"}),y&&u.jsx("div",{className:"px-4 py-2 text-sm text-red-700 bg-red-50 border-b border-red-100",children:y}),u.jsxs("div",{className:"max-h-[60vh] overflow-y-auto",children:[u.jsx(ia,{icon:u.jsx(gx,{className:"w-4 h-4 text-gray-500"}),label:"Save",onClick:()=>{if(w){if(!j){m(j??""),h(!0);return}P(j)}},disabled:!w||!me||v}),u.jsx(ia,{icon:u.jsx(mx,{className:"w-4 h-4 text-gray-500"}),label:"Save as",onClick:()=>{m(j??""),h(!0)},disabled:!w||v}),me&&u.jsx(ia,{icon:u.jsx(Pp,{className:"w-4 h-4 text-red-500"}),label:"Discard changes",tone:"danger",onClick:()=>H("discardChanges"),disabled:v}),u.jsx("div",{className:"border-t border-gray-200"}),u.jsx(ia,{icon:u.jsx(Ho,{className:"w-5 h-5 text-gray-500"}),label:"Clear workflow cache",description:"(hidden nodes, folds, etc.)",onClick:()=>H("clearWorkflowCache"),disabled:!w||v}),u.jsx(ia,{icon:u.jsx(ES,{className:"w-5 h-5 text-red-500"}),label:"Unload workflow",description:"Close the current workflow panel state",tone:"danger",onClick:()=>H("unload"),disabled:!w||v}),u.jsx(ia,{icon:u.jsx(Ho,{className:"w-5 h-5 text-red-500"}),label:"Clear device cache",description:"Reset local storage and reload app",tone:"danger",onClick:()=>H("clearAllCache"),disabled:v})]}),u.jsx("div",{className:"border-t border-gray-100 p-3",children:u.jsx("button",{className:"w-full px-4 py-2.5 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200",onClick:()=>c(!1),children:"Close"})})]})}),d&&u.jsx("div",{className:"fixed inset-0 z-[1460] bg-black/50 flex items-center justify-center p-4",onClick:()=>h(!1),role:"dialog","aria-modal":"true",children:u.jsxs("div",{className:"w-full max-w-sm bg-white border border-gray-200 rounded-xl shadow-lg p-4",onClick:O=>O.stopPropagation(),children:[u.jsx("div",{className:"text-base font-semibold text-gray-900 mb-3",children:"Save as"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"text",value:p,onChange:O=>m(O.target.value),className:"w-full border border-gray-300 rounded-lg px-3 pr-9 py-2 text-sm text-gray-900 focus:outline-none focus:border-2 focus:border-blue-500",placeholder:"workflow.json",autoFocus:!0}),p.length>0&&u.jsx("button",{type:"button",className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700",onClick:()=>m(""),"aria-label":"Clear filename",children:u.jsx(Ul,{className:"w-4 h-4"})})]}),u.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[u.jsx("button",{className:"px-3 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-100",onClick:()=>h(!1),children:"Cancel"}),u.jsx("button",{className:"px-3 py-2 rounded-lg text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 disabled:opacity-50",onClick:()=>{const O=p.trim();if(!O){x("Please enter a filename.");return}P(O)},disabled:!w||v,children:"Save"})]})]})}),s&&An.createPortal(u.jsx(Qo,{onClose:()=>a(null),title:"Unsaved changes",description:"You have unsaved changes in the current workflow. Continue without saving?",actions:[{label:"Cancel",onClick:()=>a(null),className:"px-3 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-100"},{label:s==="discardChanges"?"Discard changes":"Continue",onClick:()=>{ce(s)},className:"px-3 py-2 rounded-lg text-sm font-medium text-white bg-red-600 hover:bg-red-700"}]}),document.body)]})}function vN({onClick:n}){return u.jsx("button",{type:"button",onClick:n,"aria-label":"Menu",className:"w-10 h-10 flex items-center justify-center rounded-lg text-gray-700 hover:bg-gray-100",children:u.jsx(Yp,{className:"w-6 h-6"})})}function wN({title:n,mode:o,isDirty:s,hasWorkflow:a,nodeCountLabel:l,historyLength:c,pendingLength:d,onTap:h}){return u.jsxs("div",{id:"top-bar-title-container",className:"flex-1 text-center min-w-0 px-2 cursor-pointer",onClick:h,children:[u.jsxs("h1",{id:"top-bar-title",className:"font-semibold text-gray-900 text-lg truncate flex items-center justify-center",children:[u.jsx("span",{className:"truncate",children:n}),o==="workflow"&&s&&u.jsx("span",{id:"dirty-indicator",className:"text-blue-500 ml-1 font-bold",children:"*"})]}),o==="workflow"&&a&&u.jsx("p",{className:"node-count-display text-xs text-gray-500",children:l}),o==="queue"&&u.jsxs("p",{className:"run-count-display text-xs text-gray-500",children:[c," ",c===1?"run":"runs",d>0&&` (${d} pending)`]})]})}function SN(n){return n==="queue"?['[data-queue-list="true"]','[data-node-list="true"]']:['[data-node-list="true"]','[data-queue-list="true"]']}function NN({mode:n="workflow"}){const o=b.useRef(null),s=b.useRef(0),a=fp(C=>C.appMenuOpen),l=fp(C=>C.setAppMenuOpen),c=b.useCallback(()=>{const C=Date.now(),T=C-s.current;if(s.current=C,T<300){if(n==="workflow"){window.dispatchEvent(new Event("workflow-scroll-to-top")),"vibrate"in navigator&&navigator.vibrate(10);return}if(n==="outputs"){const D=document.querySelector("#outputs-content-container");D&&(D.scrollTo({top:0,behavior:"auto"}),"vibrate"in navigator&&navigator.vibrate(10));return}const R=SN(n);for(const D of R){const L=document.querySelector(D);if(L&&L.scrollHeight>0&&!L.closest(".pointer-events-none")){L.scrollTo({top:0,behavior:"smooth"}),"vibrate"in navigator&&navigator.vibrate(10);break}}}},[n]),d=de(C=>C.workflow),h=de(C=>C.originalWorkflow),p=de(C=>C.currentFilename),m=de(C=>C.hiddenItems),y=Ht(C=>C.pending),x=qn(C=>C.history),v=Jt(C=>C.source),k=d&&h&&JSON.stringify(d)!==JSON.stringify(h),w=b.useMemo(()=>{if(!d)return"";const C=d.nodes.length,T=Object.keys(m).length,R=Object.values(m).some(Boolean);if(T===0&&!R)return`${C} nodes ${k?"[Unsaved]":""}`.trim();const D=R?d.nodes.reduce((B,A)=>{const te=A.properties?.__mobile_origin;if(!te||typeof te!="object"||te.scope!=="subgraph")return B;const ae=te.subgraphId,ne=ae?d.definitions?.subgraphs?.find(me=>me.id===ae)?.stableKey:null;return ne&&m[ne]?B+1:B},0):0,L=T+D;return`${C} nodes (${L} hidden) ${k?"[Unsaved]":""}`.trim()},[d,m,k]);b.useEffect(()=>{const C=o.current;if(!C)return;const T=()=>{const D=C.getBoundingClientRect();document.documentElement.style.setProperty("--top-bar-offset",`${D.height}px`)};T();const R=new ResizeObserver(T);return R.observe(C),()=>R.disconnect()},[]);const S=b.useMemo(()=>{switch(n){case"queue":return"Queue";case"outputs":return v==="output"?"Outputs":"Inputs";default:return p?p.replace(".json",""):d?"Untitled":"ComfyUI Mobile"}},[n,v,p,d]),j=b.useMemo(()=>{switch(n){case"queue":return u.jsx(dN,{});case"outputs":return u.jsx(pN,{});default:return u.jsx(xN,{})}},[n]);return u.jsxs("div",{id:"top-bar-root",ref:o,className:"fixed top-0 left-0 right-0 bg-white border-b border-gray-200 z-[2000] safe-area-top","data-top-bar":"true",children:[u.jsxs("div",{id:"top-bar-content",className:"flex items-center justify-between px-4 py-3",children:[u.jsx(vN,{onClick:()=>l(!0)}),u.jsx(wN,{title:S,mode:n,isDirty:!!k,hasWorkflow:!!d,nodeCountLabel:w,historyLength:x.length,pendingLength:y.length,onTap:c}),u.jsx("div",{id:"top-bar-right-slot",className:"w-10 h-10 flex items-center justify-center",children:j})]}),u.jsx(iN,{open:a,onClose:()=>l(!1)})]})}function kN(){const n=de(k=>k.setMobileLayout),o=de(k=>k.mobileLayout),s=de(k=>k.prepareRepositionScrollTarget),[a,l]=b.useState(!1),[c,d]=b.useState(null),[h,p]=b.useState(null),m=b.useCallback((k,w)=>{const S=(j,C)=>{for(const T of j){if(T.type==="group"){if(T.id===k&&C===w)return T.stableKey;const R=S(o.groups[T.stableKey]??[],C);if(R)return R;continue}if(T.type==="subgraph"){const R=S(o.subgraphs[T.id]??[],T.id);if(R)return R}}return null};return S(o.root,null)},[o]),y=b.useCallback(k=>{let w;if(k.type==="node")w=`[data-reposition-item="node-${k.id}"]`;else if(k.type==="group"){const j=m(k.id,k.subgraphId??null);if(!j)return;w=`[data-reposition-item="group-${j}"]`}else w=`[data-reposition-item="subgraph-${k.id}"]`;const S=document.querySelector(w);p(S?{viewportTop:S.getBoundingClientRect().top}:null),d(k),l(!0)},[m]),x=b.useCallback((k,w,S)=>{n(k),l(!1),d(null),p(null),s(w),requestAnimationFrame(()=>{requestAnimationFrame(()=>{let j;if(w.type==="node")j=`[data-reposition-item="node-${w.id}"]`;else if(w.type==="group"){const C=m(w.id,w.subgraphId??null);if(!C)return;j=`[data-reposition-item="group-${C}"]`}else j=`[data-reposition-item="subgraph-${w.id}"]`;if(j){const C=document.querySelector(j);if(!C)return;if(S){const T=document.querySelector('[data-node-list="true"]');if(T){const D=C.getBoundingClientRect().top-S.viewportTop;Math.abs(D)>.5&&(T.scrollTop+=D);return}}C.scrollIntoView({behavior:"auto",block:"center"})}})})},[s,m,n]),v=b.useCallback(()=>{l(!1),d(null),p(null)},[]);return{overlayOpen:a,initialTarget:c,initialViewportAnchor:h,openOverlay:y,commitAndClose:x,cancelOverlay:v}}function Al(n){const o=n.replace("#","").trim();return/^[0-9a-f]{3}$/i.test(o)?`#${o.replace(/(.)/g,"$1$1").toLowerCase()}`:/^[0-9a-f]{6}$/i.test(o)?`#${o.toLowerCase()}`:null}function bx(n){if(typeof document>"u"||!document.body)return null;const o=document.createElement("span");o.style.color=n,document.body.appendChild(o);const s=getComputedStyle(o).color;document.body.removeChild(o);const a=s.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)/i);if(!a)return null;const[,l,c,d]=a.map(Number);return[l,c,d].some(h=>Number.isNaN(h))?null:`#${[l,c,d].map(h=>h.toString(16).padStart(2,"0")).join("")}`}function Ry(n,o){const s=new Set,a=n.trim().toLowerCase();if(a&&(s.add(a),o)){const d=o[a.replace(/\s+/g,"")]??o[a];d&&s.add(d)}const l=Al(n);if(l)return s.add(l),[...s];const c=bx(n);return c&&s.add(c),[...s]}function Dy(n){const o=Al(n);if(!o)return null;const s=parseInt(o.slice(1,3),16)/255,a=parseInt(o.slice(3,5),16)/255,l=parseInt(o.slice(5,7),16)/255,c=Math.max(s,a,l),d=Math.min(s,a,l),h=c-d;let p=0;h!==0&&(c===s?p=(a-l)/h%6:c===a?p=(l-s)/h+2:p=(s-a)/h+4,p=Math.round(p*60),p<0&&(p+=360));const m=(c+d)/2,y=h===0?0:h/(1-Math.abs(2*m-1));return{h:p,s:y,l:m}}function CN(n,o,s,a={},l={}){const c=(S,j)=>{if(j in S)return!!S[j];const C=l[j];return C?!!S[C]:!!S[j]},d=(S,j,C)=>{if(j in S)return S[j]??C;const T=l[j];return T?S[T]??C:S[j]??C},h=new Map(o.nodes.map(S=>[S.id,S])),p=o.groups??[],m=o.definitions?.subgraphs??[],y=new Map(m.map(S=>[S.id,S])),x=new Map(p.map(S=>[S.id,S])),v=new Map;for(const S of m){const j=new Map;for(const C of S.groups??[])j.set(C.id,C);v.set(S.id,j)}const k=(S,j,C=new Set,T=new Set)=>{let R=0;for(const D of S)if(D.type==="node"){const L=mn({type:"node",nodeId:D.id,subgraphId:j});c(a,L)||(R+=1)}else if(D.type==="hiddenBlock"){const L=n.hiddenBlocks[D.blockId]??[];R+=L.filter(B=>{const A=mn({type:"node",nodeId:B,subgraphId:j});return!c(a,A)}).length}else if(D.type==="group"){if(C.has(D.stableKey))continue;C.add(D.stableKey),R+=k(n.groups[D.stableKey]??[],j,C,T),C.delete(D.stableKey)}else if(D.type==="subgraph"){if(T.has(D.id))continue;T.add(D.id),R+=k(n.subgraphs[D.id]??[],D.id,C,T),T.delete(D.id)}return R},w=(S,j,C,T=new Set,R=new Set)=>{const D=[];for(const L of S){if(L.type==="hiddenBlock"){const ee=n.hiddenBlocks[L.blockId]??[];if(ee.length===0)continue;D.push({type:"hiddenBlock",blockId:L.blockId,nodeIds:ee,count:ee.length});continue}if(L.type==="node"){const ee=mn({type:"node",nodeId:L.id,subgraphId:C});if(c(a,ee))continue;const ae=h.get(L.id);if(!ae)continue;D.push({type:"node",node:ae,groupId:j,subgraphId:C});continue}if(L.type==="group"){if(c(a,L.stableKey)||T.has(L.stableKey))continue;let ee;if(C&&(ee=v.get(C)?.get(L.id)),ee??=x.get(L.id),!ee)for(const Le of v.values()){const P=Le.get(L.id);if(P){ee=P;break}}if(!ee)continue;const ae=n.groups[L.stableKey]??[],ne=d(s,L.stableKey,!1);T.add(L.stableKey);const me=ne?[]:w(ae,L.id,C,T,R);T.delete(L.stableKey),D.push({type:"group",group:ee,stableKey:L.stableKey,nodeCount:k(ae,C),isCollapsed:ne,subgraphId:C,children:me});continue}if(c(a,mn({type:"subgraph",subgraphId:L.id}))||R.has(L.id))continue;const B=y.get(L.id);if(!B)continue;const A=n.subgraphs[L.id]??[],F=d(s,mn({type:"subgraph",subgraphId:L.id}),!1);R.add(L.id);const te=F?[]:w(A,null,L.id,T,R);R.delete(L.id),D.push({type:"subgraph",subgraph:B,nodeCount:k(A,L.id),isCollapsed:F,groupId:j,children:te})}return D};return w(n.root,null,null)}function Do(n,o){const s=Al(n);if(!s)return Dt.transparentBlack;const a=s.slice(1),l=parseInt(a.slice(0,2),16),c=parseInt(a.slice(2,4),16),d=parseInt(a.slice(4,6),16);return`rgba(${l}, ${c}, ${d}, ${o})`}function By({containerKey:n,indexLabel:o,targetKey:s,height:a}){return u.jsx("div",{"data-reposition-placeholder":"true",className:"mb-3",style:{height:`${a}px`}},`placeholder-${n}-${o}-${s}`)}function zy({containerType:n,containerDataKey:o,dataKey:s,title:a,nodeCount:l,isTarget:c,isCollapsed:d,canToggleCollapse:h,isDragging:p,isDropTarget:m,isHighlighted:y,backgroundColor:x,borderColor:v,headerBackgroundColor:k,onToggleCollapse:w,childrenContent:S}){const j=`${l} node${l!==1?"s":""}${n==="subgraph"?" (subgraph)":""}`;return u.jsxs("div",{"data-container-type":n,className:`rounded-xl mb-3 shadow-md ${p?"overflow-visible":"overflow-hidden"} transition-shadow ${c?"border-blue-500 border-2 ring-2 ring-blue-400":"border"} ${y&&!c?"ring-2 ring-blue-500 transition-all":""} ${m?"ring-2 ring-blue-300 ring-dashed":""}`,style:{backgroundColor:x,borderColor:v,...c?{touchAction:"none"}:{},...c?{animation:p?"none":"node-card-wiggle 180ms ease-in-out infinite alternate"}:{}},"data-reposition-item":s,children:[u.jsxs("div",{"data-reposition-header":o,className:`flex items-center justify-between cursor-pointer gap-1 px-3 py-2 ${d?"rounded-xl":"rounded-t-xl mb-2"}`,style:{backgroundColor:k,borderColor:v},onClick:C=>{h&&(C.stopPropagation(),w())},children:[u.jsx("span",{"data-reposition-handle":s,className:"touch-none w-8 h-8 -ml-2 flex items-center justify-center shrink-0",children:u.jsx(Yp,{className:`w-5 h-5 ${c?"text-blue-500":"text-gray-500"}`})}),u.jsx("span",{className:"font-semibold text-gray-900 flex-1 min-w-0 truncate",children:a}),u.jsx("span",{className:"ml-auto text-sm shrink-0 text-gray-500",children:j}),d?u.jsx(js,{className:`w-6 h-6 shrink-0 ${h?"text-gray-500":"text-gray-500 opacity-50"}`}):u.jsx(so,{className:"w-6 h-6 shrink-0 text-gray-500"})]}),S,!d&&u.jsx("div",{"data-reposition-footer":o,className:`px-3 py-1.5 rounded-b-xl select-none ${h?"cursor-pointer":""}`,style:{backgroundColor:k,borderColor:v},onClick:C=>{h&&(C.stopPropagation(),w())},children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{className:"text-xs flex-1 min-w-0 truncate text-gray-500",children:a}),u.jsxs("div",{className:"ml-auto flex items-center gap-1",children:[u.jsx("span",{className:"text-xs shrink-0 text-gray-500",children:j}),u.jsx(so,{className:`w-6 h-6 shrink-0 rotate-180 ${h?"text-gray-500":"text-gray-500 opacity-50"}`})]})]})})]})}function jN({blockId:n,nodeCount:o}){return u.jsxs("div",{className:"bg-gray-200 rounded-lg px-3 py-2 mb-3 text-sm text-gray-500 text-center","data-reposition-item":`hidden-${n}`,children:[o," hidden node",o!==1?"s":""]},`hidden-${n}`)}function MN({dataKey:n,nodeId:o,displayName:s,isTarget:a,isBypassed:l,isDragging:c,borderClass:d,borderStyle:h,isHighlighted:p}){return u.jsxs("div",{className:`flex min-h-10 items-center gap-1 rounded-xl border-2 px-3 py-1 mb-3 shadow-md select-none ${d} ${l?"bg-purple-200":"bg-white"} ${p&&!a?"ring-2 ring-blue-500 transition-all":""}`,style:a?{...h??{},touchAction:"none",animation:c?"none":"node-card-wiggle 180ms ease-in-out infinite alternate"}:h,"data-reposition-item":n,children:[u.jsx("span",{"data-reposition-handle":n,className:"touch-none flex h-8 w-8 items-center justify-center -ml-2 shrink-0",children:u.jsx(Yp,{className:`w-5 h-5 ${a?"text-blue-500":"text-gray-300"}`})}),u.jsx("span",{className:"font-semibold min-w-0 flex-1 truncate text-gray-900",children:s}),u.jsxs("span",{className:"text-xs text-gray-400 shrink-0",children:["#",o]})]},n)}const ON={secondary:"bg-white border border-gray-300 text-gray-700",primary:"bg-blue-600 text-white",danger:"bg-red-600 text-white"};function xx({actions:n,zIndex:o}){return u.jsx("div",{className:"fixed bottom-6 left-0 right-0 flex justify-center gap-4 px-4",style:{zIndex:o,paddingBottom:"env(safe-area-inset-bottom)"},children:n.map(s=>{const a=s.variant??"secondary";return u.jsx("button",{type:"button",className:`px-5 py-2.5 rounded-full text-sm font-medium shadow-lg disabled:opacity-50 disabled:cursor-not-allowed ${ON[a]}`,onClick:s.onClick,disabled:s.disabled,children:s.label},s.key)})})}function TN({nodeId:n,canShowConnectionsToggle:o,connectionHighlightEnabled:s,onToggleConnections:a,connectionMode:l,leftLineCount:c,rightLineCount:d,inputHighlightColor:h,outputHighlightColor:p}){return u.jsx("div",{className:"bg-white border-b border-gray-200",style:{height:"var(--top-bar-offset, 69px)"},children:u.jsxs("div",{className:"h-full px-4 flex items-center justify-between",children:[u.jsx("div",{className:"w-10 h-10"}),u.jsx("h2",{className:"text-lg font-semibold text-gray-900 text-center",children:"Reposition Nodes"}),u.jsx("div",{className:"w-10 h-10 flex items-center justify-center",children:o&&u.jsx("button",{type:"button",className:"w-8 h-8 flex items-center justify-center","aria-label":"Highlight node connections","aria-pressed":s,onClick:a,children:u.jsx(px,{className:"w-6 h-6 overflow-visible",nodeId:n,connectionHighlightMode:l,leftLineCount:c,rightLineCount:d,inactiveColor:Dt.text.secondary,offLineColor:Dt.text.secondary,inputHighlightColor:h,outputHighlightColor:p})})})]})})}function EN({scrollContainerRef:n,isDragging:o,isPointerArmedForDrag:s,onPointerDown:a,onPointerMove:l,onPointerUp:c,onPointerCancel:d,children:h}){return u.jsx("div",{ref:n,className:"flex-1 overflow-auto px-4 pt-4 pb-40",style:{touchAction:o||s?"none":"pan-y"},onPointerDown:a,onPointerMove:l,onPointerUp:c,onPointerCancel:d,children:h})}function Lu(n,o,s){let a=null;const l=(c,d)=>{for(const h of c){if(h.type==="group"){if(h.id===o&&a==null&&(a=h.stableKey),h.id===o&&d===s)return h.stableKey;const p=l(n.groups[h.stableKey]??[],d);if(p)return p;continue}if(h.type==="subgraph"){const p=l(n.subgraphs[h.id]??[],h.id);if(p)return p}}return null};return l(n.root,null)??a}function vx(n,o){const s=n.groupParents?.[o];if(!s){const a=(l,c)=>{for(const d of l){if(d.type==="group"){if(d.stableKey===o)return c;const h=a(n.groups[d.stableKey]??[],c);if(h!==null)return h;continue}if(d.type==="subgraph"){const h=a(n.subgraphs[d.id]??[],d.id);if(h!==null)return h}}return null};return a(n.root,null)}return s.scope==="subgraph"?s.subgraphId:s.scope==="root"?null:vx(n,s.groupKey)}function Af(n,o){if(n.type==="node")return`node-${n.id}`;if(n.type==="group"){const s=o?Lu(o,n.id,n.subgraphId??null):null;return s?`group-${s}`:`group-${mn({type:"group",groupId:n.id,subgraphId:n.subgraphId??null})}`}return`subgraph-${n.id}`}function IN(n){return n.type==="node"?`node-${n.id}`:n.type==="group"?`group-${n.stableKey}`:n.type==="subgraph"?`subgraph-${n.id}`:`hidden-${n.blockId}`}function ua(n,o){return n.scope!==o.scope?!1:n.scope==="root"?!0:n.scope==="group"&&o.scope==="group"?n.groupKey===o.groupKey:n.scope==="subgraph"&&o.scope==="subgraph"?n.subgraphId===o.subgraphId:!1}function bu(n){return n.scope==="root"?"root":n.scope==="group"?`group-${n.groupKey}`:`subgraph-${n.subgraphId}`}function LN(n){return{groupKeys:Object.keys(n.groups),subgraphIds:Object.keys(n.subgraphs)}}function Hy(n,o,s){const a=[];return o.forEach((l,c)=>{if(l===s)return;const d=n.querySelector(`[data-reposition-item="${l}"]`);if(!d)return;const h=d.getBoundingClientRect();a.push({idx:c,top:h.top,bottom:h.bottom,height:h.height})}),a}function _N(n,o,s){const a=Math.max(n.top,o.top),l=Math.min(n.bottom,o.bottom);return Math.max(0,l-a)>=n.height*s}function $y(n,o,s,a,l,c){if(!(n.bottom>=o.top&&n.top<=o.bottom))return!1;if(!s||!a)return _N(n,o,c);if(l){const m=n.bottom>s.top+s.height*c,y=n.bottom>a.top+a.height*c;return m&&!y}const h=n.top<a.bottom-a.height*c,p=n.top<s.bottom-s.height*c;return h&&!p}function Ky(n,o,s,a,l){if(n.length===0)return 0;if(o){let d=0;for(const h of n){const p=h.top+h.height*l;if(a>p){d=h.idx+1;continue}break}return d}let c=n.length;for(let d=n.length-1;d>=0;d-=1){const h=n[d],p=h.bottom-h.height*l;if(s<p){c=h.idx;continue}break}return c}const Vy=5,xu=.625,AN=1/6,Uy=120,RN=640,DN=350,BN=300,Rf=Dt.status.success,Df=Dt.status.warning,zN=Dt.status.danger,vu=Dt.brand.blue500;function HN({mobileLayout:n,initialTarget:o,initialViewportAnchor:s=null,onDone:a,onCancel:l}){const c=de(xe=>xe.workflow),d=de(xe=>xe.nodeTypes),h=de(xe=>xe.executingNodeId),p=de(xe=>xe.collapsedItems),m=de(xe=>xe.stableKeyByPointer),y=gn(xe=>xe.nodeErrors),x=b.useCallback(xe=>m[xe]??xe,[m]),[v,k]=b.useState(()=>JSON.parse(JSON.stringify(n))),[w,S]=b.useState(!1),[j,C]=b.useState(o),[T,R]=b.useState(null),[D,L]=b.useState(null),[B,A]=b.useState(!1),F=b.useRef(null),te=b.useRef(0),ee=b.useRef(0),ae=b.useRef(0),ne=b.useRef(!0),me=b.useRef(-1),Le=b.useRef(null),P=b.useRef(0),V=b.useRef(0),H=b.useRef(0),ce=b.useRef(null),ke=b.useRef(null),Ne=b.useRef(null),O=b.useRef(null),_=b.useRef(null),q=b.useRef(null),je=b.useRef(0),Ke=b.useRef(0),De=b.useRef(!1),Fe=b.useRef(!1),ue=b.useRef(!1),ye=b.useRef(null),[et,oe]=b.useState(null),[z,U]=b.useState(()=>{const xe={...p??{}};if(o.type==="group"){const J=Lu(n,o.id,o.subgraphId??null);J&&(xe[J]=!0)}return o.type==="subgraph"&&(xe[x(mn({type:"subgraph",subgraphId:o.id}))]=!0),xe}),[se,fe]=b.useState(null),[M,re]=b.useState(null),W=b.useRef(v);b.useEffect(()=>{W.current=v},[v]);const G=b.useMemo(()=>Af(j,v),[j,v]),I=se===G,$=b.useMemo(()=>{const xe=j.type==="node"?{type:"node",id:j.id}:j.type==="group"?(()=>{const Ie=Lu(v,j.id,j.subgraphId??null);return Ie?{type:"group",id:j.id,subgraphId:j.subgraphId??null,stableKey:Ie}:null})():{type:"subgraph",id:j.id};if(!xe)return{groupIds:new Set,subgraphIds:new Set};const J=(Ie,Be)=>Ie.type!==Be.type?!1:Ie.type==="node"&&Be.type==="node"?Ie.id===Be.id:Ie.type==="group"&&Be.type==="group"?Ie.stableKey===Be.stableKey:Ie.type==="subgraph"&&Be.type==="subgraph"?Ie.id===Be.id:Ie.type==="hiddenBlock"&&Be.type==="hiddenBlock"?Ie.blockId===Be.blockId:!1,be=(Ie,Be,We)=>{for(const Oe of Ie){if(J(Oe,xe))return{groupIds:new Set(Be),subgraphIds:new Set(We)};if(Oe.type==="group"){const lt=be(v.groups[Oe.stableKey]??[],[...Be,Oe.stableKey],We);if(lt)return lt}else if(Oe.type==="subgraph"){const lt=be(v.subgraphs[Oe.id]??[],Be,[...We,Oe.id]);if(lt)return lt}}return null};return be(v.root,[],[])??{groupIds:new Set,subgraphIds:new Set}},[v,j]),Z=b.useMemo(()=>{if(!c||j.type!=="node")return{hasConnections:!1,hasUpstream:!1,hasDownstream:!1,leftLineCount:0,rightLineCount:0,upstreamNodeIds:new Set,downstreamNodeIds:new Set};const xe=c.nodes.find(We=>We.id===j.id);if(!xe)return{hasConnections:!1,hasUpstream:!1,hasDownstream:!1,leftLineCount:0,rightLineCount:0,upstreamNodeIds:new Set,downstreamNodeIds:new Set};const J=new Set;xe.inputs.forEach((We,Oe)=>{if(We.link==null)return;const lt=va(c,xe.id,Oe);lt&&J.add(lt.node.id)});const be=new Set;xe.outputs.forEach((We,Oe)=>{if(!We.links||We.links.length===0)return;const lt=Tl(c,xe.id,Oe);for(const st of lt)be.add(st.node.id)}),J.delete(xe.id),be.delete(xe.id);const Ie=xe.inputs.filter(We=>We.link!=null).length,Be=xe.outputs.reduce((We,Oe)=>We+(Oe.links?.length??0),0);return{hasConnections:Ie>0||Be>0,hasUpstream:J.size>0,hasDownstream:be.size>0,leftLineCount:Math.min(3,Ie),rightLineCount:Math.min(3,Be),upstreamNodeIds:J,downstreamNodeIds:be}},[c,j]),Se=b.useMemo(()=>new Map((c?.nodes??[]).map(xe=>[xe.id,xe])),[c]),Q=b.useMemo(()=>{const xe=new Map;for(const be of c?.groups??[])xe.set(be.id,be);const J=new Map;for(const be of c?.definitions?.subgraphs??[]){const Ie=new Map;for(const Be of be.groups??[])Ie.set(Be.id,Be);J.set(be.id,Ie)}return{rootMap:xe,bySubgraph:J}},[c]),Me=b.useMemo(()=>{const xe=new Map;for(const J of c?.groups??[]){const be=J.stableKey??`legacy-group-root-${J.id}`;xe.set(be,J)}for(const J of c?.definitions?.subgraphs??[])for(const be of J.groups??[]){const Ie=be.stableKey??`legacy-group-${J.id}-${be.id}`;xe.set(Ie,be)}return xe},[c]),K=b.useMemo(()=>new Map((c?.definitions?.subgraphs??[]).map(xe=>[xe.id,xe])),[c]),Te=b.useMemo(()=>{const xe=new Map,J=new Set,be=new Set,Ie=(Be,We)=>{for(const Oe of Be){if(Oe.type==="group"){if(xe.set(Oe.stableKey,{id:Oe.id,subgraphId:We}),J.has(Oe.stableKey))continue;J.add(Oe.stableKey),Ie(v.groups[Oe.stableKey]??[],We);continue}if(Oe.type==="subgraph"){if(be.has(Oe.id))continue;be.add(Oe.id),Ie(v.subgraphs[Oe.id]??[],Oe.id)}}};return Ie(v.root,null),xe},[v]);b.useEffect(()=>{const xe=Af(j,W.current);let J=null;return De.current?De.current=!1:requestAnimationFrame(()=>{const be=O.current,Ie=be?.querySelector(`[data-reposition-item="${xe}"]`);if(!Ie)return;const Be=!Fe.current;if(Be&&!ue.current&&s&&be){const lt=Ie.getBoundingClientRect().top-s.viewportTop;Math.abs(lt)>.5&&(be.scrollTop+=lt),ue.current=!0,Fe.current=!0;return}const We=Be?"auto":"smooth";Ie.scrollIntoView({behavior:We,block:"center"}),Fe.current=!0}),J=requestAnimationFrame(()=>{oe(xe)}),ye.current!=null&&window.clearTimeout(ye.current),ye.current=window.setTimeout(()=>{oe(null),ye.current=null},1500),()=>{J!=null&&window.cancelAnimationFrame(J),ye.current!=null&&window.clearTimeout(ye.current)}},[j,s]);const _e=b.useCallback(xe=>{if(xe.startsWith("node-")){const J=parseInt(xe.slice(5),10);return Number.isFinite(J)?{target:{type:"node",id:J},itemRef:{type:"node",id:J}}:null}if(xe.startsWith("group-")){const J=xe.slice(6),be=Te.get(J);if(!be)return null;const{id:Ie,subgraphId:Be}=be;return{target:{type:"group",id:Ie,subgraphId:Be},itemRef:{type:"group",id:Ie,subgraphId:Be,stableKey:J}}}if(xe.startsWith("subgraph-")){const J=xe.slice(9);return{target:{type:"subgraph",id:J},itemRef:{type:"subgraph",id:J}}}return null},[Te]),qe=b.useCallback(xe=>{const be=xe.target.closest("[data-reposition-item]")?.dataset.repositionItem??null,We=xe.target.closest("[data-reposition-handle]")?.dataset.repositionHandle??null??(be===G?G:null);if(!We)return;const Oe=_e(We);if(!Oe)return;const lt=ox(v,Oe.itemRef);if(!lt)return;if(xe.preventDefault(),We!==G){const nt=Oe.target;if(nt.type==="group"){const bt=Lu(v,nt.id,nt.subgraphId??null);if(!bt)return;U(gt=>({...gt,[bt]:!0}))}else if(nt.type==="subgraph"){const bt=nt.id;U(gt=>({...gt,[x(mn({type:"subgraph",subgraphId:bt}))]:!0}))}De.current=!0,C(Oe.target)}const st=Oe.itemRef.type==="node"||Oe.itemRef.type==="group",at=st?LN(v):{groupKeys:[],subgraphIds:[]},ct=new Set,dt=new Set;if(Oe.itemRef.type==="group"){const nt=bt=>{for(const gt of bt){if(gt.type==="group"){ct.has(gt.stableKey)||(ct.add(gt.stableKey),nt(v.groups[gt.stableKey]??[]));continue}gt.type==="subgraph"&&(dt.has(gt.id)||(dt.add(gt.id),nt(v.subgraphs[gt.id]??[])))}};ct.add(Oe.itemRef.stableKey),nt(v.groups[Oe.itemRef.stableKey]??[])}F.current={pointerId:xe.pointerId,startX:xe.clientX,startY:xe.clientY,origIndex:lt.index,containerId:lt.containerId,targetKey:We,targetRef:Oe.itemRef,target:Oe.target,allGroupKeys:at.groupKeys,allSubgraphIds:at.subgraphIds,crossContainerEnabled:st,disallowedGroupKeys:ct,disallowedSubgraphIds:dt},te.current=0,me.current=lt.index,Le.current=lt.containerId,ae.current=xe.clientY,ne.current=!0,A(!0),O.current&&(O.current.style.touchAction="none")},[v,G,_e,x]),Ge=b.useCallback((xe,J,be,Ie)=>{if(!J.crossContainerEnabled)return J.containerId;let Be={scope:"root"},We=1/0;for(const Oe of J.allGroupKeys){if(J.targetRef.type==="group"&&J.targetRef.stableKey===Oe||J.disallowedGroupKeys.has(Oe)||(z[Oe]??!1))continue;const lt=`group-${Oe}`,st=xe.querySelector(`[data-reposition-item="${lt}"]`);if(!st)continue;const at=st.getBoundingClientRect(),ct=st.querySelector(`[data-reposition-header="${lt}"]`),dt=st.querySelector(`[data-reposition-footer="${lt}"]`),nt=ct?.getBoundingClientRect()??null,bt=dt?.getBoundingClientRect()??null;if(!$y(be,at,nt,bt,Ie,xu))continue;const gt=at.width*at.height;gt<We&&(We=gt,Be={scope:"group",groupKey:Oe})}for(const Oe of J.allSubgraphIds){if(J.targetRef.type==="subgraph"&&J.targetRef.id===Oe||J.disallowedSubgraphIds.has(Oe)||(z[x(mn({type:"subgraph",subgraphId:Oe}))]??!1))continue;const lt=xe.querySelector(`[data-reposition-item="subgraph-${Oe}"]`);if(!lt)continue;const st=lt.getBoundingClientRect(),at=lt.querySelector(`[data-reposition-header="subgraph-${Oe}"]`),ct=lt.querySelector(`[data-reposition-footer="subgraph-${Oe}"]`),dt=at?.getBoundingClientRect()??null,nt=ct?.getBoundingClientRect()??null;if(!$y(be,st,dt,nt,Ie,xu))continue;const bt=st.width*st.height;bt<We&&(We=bt,Be={scope:"subgraph",subgraphId:Oe})}return Be},[z,x]),Ve=b.useCallback((xe,J,be,Ie,Be)=>{const Oe=Z2(v,be).map(IN);if(ua(be,J.containerId)){const at=Oe.filter(nt=>nt!==J.targetKey),ct=Hy(xe,at),dt=Ky(ct,Be,Ie.top,Ie.bottom,xu);return dt<=J.origIndex?dt:dt+1}const st=Hy(xe,Oe);return Ky(st,Be,Ie.top,Ie.bottom,xu)},[v]),Je=b.useCallback((xe,J,be,Ie)=>{re(Be=>{const We={targetKey:xe.targetKey,sourceContainer:xe.containerId,sourceIndex:xe.origIndex,hoverContainer:J,insertIndex:be,placeholderHeight:Ie};return Be&&Be.targetKey===We.targetKey&&ua(Be.sourceContainer,We.sourceContainer)&&Be.sourceIndex===We.sourceIndex&&ua(Be.hoverContainer,We.hoverContainer)&&Be.insertIndex===We.insertIndex&&Be.placeholderHeight===We.placeholderHeight?Be:We})},[]),Ue=b.useCallback(()=>{_.current!=null&&(window.cancelAnimationFrame(_.current),_.current=null),q.current=null,je.current=0,Ke.current=0},[]),Xe=b.useCallback(xe=>{if(!O.current)return;const be=performance.now();if(q.current!==xe&&(q.current=xe,je.current=be,Ke.current=be),_.current!=null)return;const Ie=Be=>{const We=O.current,Oe=q.current;if(!We||Oe==null||!F.current||!w){_.current=null;return}const lt=Ke.current||Be,st=Math.max(0,Be-lt);Ke.current=Be;const at=Math.max(0,Be-je.current-DN),ct=Math.min(1,at/BN),nt=(Uy+(RN-Uy)*ct)*st/1e3,bt=We.scrollTop,gt=Math.max(0,We.scrollHeight-We.clientHeight),kt=Math.max(0,Math.min(gt,bt+Oe*nt));if(We.scrollTop=kt,kt===bt){_.current=null;return}_.current=window.requestAnimationFrame(Ie)};_.current=window.requestAnimationFrame(Ie)},[w]),Pe=b.useCallback(xe=>{const J=F.current;if(!J||xe.pointerId!==J.pointerId)return;const be=xe.clientY-J.startY,Ie=xe.clientX-J.startX;if(!w){if(Math.abs(Ie)>Math.abs(be)&&Math.abs(Ie)>Vy){F.current=null,Ue(),A(!1),O.current&&(O.current.style.touchAction="");return}if(Math.abs(be)<Vy)return;S(!0);const Yt=O.current;if(Yt){const Y=Yt.querySelector(`[data-reposition-item="${J.targetKey}"]`);if(Y){const Re=Y.getBoundingClientRect();P.current=Re.top,V.current=Re.left,H.current=Y.offsetHeight||Re.height,Y.style.position="fixed",Y.style.top=`${Re.top}px`,Y.style.left=`${Re.left}px`,Y.style.width=`${Re.width}px`,Y.style.zIndex="70",Y.style.pointerEvents="none",re({targetKey:J.targetKey,sourceContainer:J.containerId,sourceIndex:J.origIndex,hoverContainer:J.containerId,insertIndex:J.origIndex,placeholderHeight:H.current})}}try{O.current?.setPointerCapture(xe.pointerId)}catch{}ae.current=xe.clientY,ne.current=be>=0;return}te.current=be,ee.current=Ie;const Be=O.current;if(!Be)return;const We=Be.getBoundingClientRect(),Oe=We.height*AN,lt=We.top+Oe,st=We.bottom-Oe;xe.clientY<=lt?Xe(-1):xe.clientY>=st?Xe(1):Ue();const at=Be.querySelector(`[data-reposition-item="${J.targetKey}"]`);at&&(at.style.top=`${P.current+be}px`,at.style.left=`${V.current}px`);const ct=at?.getBoundingClientRect();if(!ct)return;const dt=H.current||at?.offsetHeight||ct.height,nt=xe.clientY-ae.current;nt!==0&&(ne.current=nt>0);const bt=ne.current;ae.current=xe.clientY;const gt=Ge(Be,J,ct,bt);Le.current=gt;const kt=ua(gt,J.containerId),Qt=gt.scope==="group"?`group-${gt.groupKey}`:gt.scope==="subgraph"?`subgraph-${gt.subgraphId}`:null,en=gt.scope==="group"?z[gt.groupKey]??!1:gt.scope==="subgraph"?z[x(mn({type:"subgraph",subgraphId:gt.subgraphId}))]??!1:!1;Qt&&en&&!kt?ke.current!==Qt&&(ce.current!=null&&window.clearTimeout(ce.current),ke.current=Qt,ce.current=window.setTimeout(()=>{const Yt=Le.current;Yt&&(Yt.scope==="group"?U(Y=>({...Y,[Yt.groupKey]:!1})):Yt.scope==="subgraph"&&U(Y=>({...Y,[x(mn({type:"subgraph",subgraphId:Yt.subgraphId}))]:!1})),ce.current=null)},350)):ce.current!=null&&(window.clearTimeout(ce.current),ce.current=null,ke.current=null),R(!kt&&gt.scope==="group"?gt.groupKey:null),L(!kt&&gt.scope==="subgraph"?gt.subgraphId:null),me.current=Ve(Be,J,gt,ct,bt),Je(J,gt,me.current,dt)},[w,Ge,Ve,Je,z,x,Xe,Ue]),he=b.useCallback(()=>{const xe=O.current;if(!xe)return;xe.querySelectorAll("[data-reposition-item]").forEach(be=>{be.style.transform="",be.style.zIndex="",be.style.position="",be.style.top="",be.style.left="",be.style.width="",be.style.pointerEvents="",be.style.transition="",be.style.marginTop=""})},[]),Qe=b.useCallback(xe=>{const J=F.current;if(J&&xe.pointerId===J.pointerId){if(w){Ue();try{O.current?.releasePointerCapture(xe.pointerId)}catch{}he(),ce.current!=null&&(window.clearTimeout(ce.current),ce.current=null),ke.current=null;const be=Le.current??J.containerId,Ie=me.current;if(!ua(be,J.containerId)||Ie!==J.origIndex){const We=X2(v,J.targetRef,J.containerId,J.origIndex,be,Ie);if(k(We),J.target.type==="group"&&J.targetRef.type==="group"){const Oe=vx(We,J.targetRef.stableKey),lt={type:"group",id:J.target.id,subgraphId:Oe};De.current=!0,C(lt),Ne.current=lt}else Ne.current=J.target}S(!1),R(null),L(null),re(null)}F.current=null,Ue(),te.current=0,ee.current=0,me.current=-1,Le.current=null,P.current=0,V.current=0,H.current=0,ae.current=0,ne.current=!0,A(!1),O.current&&(O.current.style.touchAction="")}},[w,v,he,Ue]),ut=b.useCallback(xe=>{if(F.current){if(w){Ue();try{O.current?.releasePointerCapture(xe.pointerId)}catch{}he(),ce.current!=null&&(window.clearTimeout(ce.current),ce.current=null),ke.current=null,S(!1),R(null),L(null),re(null)}F.current=null,Ue(),te.current=0,ee.current=0,me.current=-1,Le.current=null,P.current=0,V.current=0,H.current=0,ae.current=0,ne.current=!0,A(!1),O.current&&(O.current.style.touchAction="")}},[w,he,Ue]);b.useEffect(()=>()=>{Ue(),ce.current!=null&&window.clearTimeout(ce.current)},[Ue]);const it=()=>{const xe=Ne.current??j,J=O.current?.querySelector(`[data-reposition-item="${Af(xe,v)}"]`),be=J?{viewportTop:J.getBoundingClientRect().top}:null;a(v,xe,be)},_t=xe=>{U(J=>{const be=J[xe]??!1;return{...J,[xe]:!be}})},Ot=xe=>{const J=x(mn({type:"subgraph",subgraphId:xe}));U(be=>{const Ie=be[J]??!1;return{...be,[J]:!Ie}})},wt=xe=>{const J=Se.get(xe);return J?(typeof J.title=="string"&&J.title.trim()?J.title.trim():null)||d?.[J.type]?.display_name||J.type:`Node #${xe}`},It=xe=>{if(G===`node-${xe}`)return"";const J=Se.get(xe);return J?y[String(xe)]?.length>0?"border-red-700 shadow-red-200":h===String(xe)?"border-green-500 shadow-green-200":J.mode===4?"border-purple-300":"border-transparent":"border-transparent"},Kt=xe=>Se.get(xe)?.mode===4;function pt(xe){let J=0;for(const be of xe)be.type==="node"?J+=1:be.type==="hiddenBlock"?J+=v.hiddenBlocks[be.blockId]?.length??0:be.type==="group"?J+=pt(v.groups[be.stableKey]??[]):be.type==="subgraph"&&(J+=pt(v.subgraphs[be.id]??[]));return J}const Lt=(xe,J)=>{const be=[],Ie=M!=null&&ua(J,M.hoverContainer);let Be=-1;Ie&&M&&(Be=M.insertIndex,Be<0&&(Be=0),Be>xe.length&&(Be=xe.length));const We=Oe=>{!Ie||!M||Be===Oe&&be.push(u.jsx(By,{containerKey:bu(J),indexLabel:String(Oe),targetKey:M.targetKey,height:M.placeholderHeight},`placeholder-${bu(J)}-${Oe}-${M.targetKey}`))};return xe.forEach((Oe,lt)=>{if(We(lt),Oe.type==="hiddenBlock"){const st=v.hiddenBlocks[Oe.blockId]??[];be.push(u.jsx(jN,{blockId:Oe.blockId,nodeCount:st.length},`hidden-${Oe.blockId}`));return}if(Oe.type==="node"){const st=`node-${Oe.id}`,at=st===G,ct=Kt(Oe.id),dt=I&&Z.hasConnections,nt=dt&&Z.upstreamNodeIds.has(Oe.id),bt=dt&&Z.downstreamNodeIds.has(Oe.id),gt=at?"border-blue-500 ring-2 ring-blue-400":nt||bt?"":It(Oe.id),kt={},Qt="7px";dt&&(at?(kt.borderTopColor=vu,kt.borderBottomColor=vu,kt.borderLeftColor=Z.hasUpstream?Rf:vu,kt.borderRightColor=Z.hasDownstream?Df:vu,Z.hasUpstream&&(kt.borderLeftWidth=Qt),Z.hasDownstream&&(kt.borderRightWidth=Qt)):(nt||bt)&&(kt.borderColor=zN,nt&&(kt.borderRightColor=Rf,kt.borderRightWidth=Qt),bt&&(kt.borderLeftColor=Df,kt.borderLeftWidth=Qt))),be.push(u.jsx(MN,{dataKey:st,nodeId:Oe.id,displayName:wt(Oe.id),isTarget:at,isBypassed:ct,isDragging:w,borderClass:gt,borderStyle:Object.keys(kt).length>0?kt:void 0,isHighlighted:et===st},st));return}if(Oe.type==="group"){const st=Te.get(Oe.stableKey),at=Me.get(Oe.stableKey)??(st?.subgraphId==null?Q.rootMap.get(Oe.id):Q.bySubgraph.get(st.subgraphId)?.get(Oe.id));if(!at)return null;const ct=`group-${Oe.stableKey}`,dt=ct===G,nt=z[Oe.stableKey]??!1,bt=$.groupIds.has(Oe.stableKey),gt=!dt&&!bt,kt=Do(at.color,.15),Qt=dt?void 0:Do(at.color,.4),en=at.title?.trim()||`Group ${Oe.id}`,Yt=v.groups[Oe.stableKey]??[],Y=pt(Yt),Re=T===Oe.stableKey;be.push(u.jsx(zy,{containerType:"group",containerDataKey:ct,dataKey:ct,title:en,nodeCount:Y,isTarget:dt,isCollapsed:nt,canToggleCollapse:gt,isDragging:w,isDropTarget:Re,isHighlighted:et===ct,backgroundColor:kt,borderColor:Qt,headerBackgroundColor:Do(at.color,.22),onToggleCollapse:()=>_t(Oe.stableKey),childrenContent:!nt&&Yt.length>0?u.jsx("div",{className:"px-1",children:Lt(Yt,{scope:"group",groupKey:Oe.stableKey})}):null},ct));return}if(Oe.type==="subgraph"){const st=K.get(Oe.id);if(!st)return null;const at=`subgraph-${Oe.id}`,ct=at===G,dt=z[x(mn({type:"subgraph",subgraphId:Oe.id}))]??!1,nt=$.subgraphIds.has(Oe.id),bt=!ct&&!nt,gt=st.name||st.id,kt=v.subgraphs[Oe.id]??[],Qt=pt(kt),en=D===Oe.id;be.push(u.jsx(zy,{containerType:"subgraph",containerDataKey:`subgraph-${Oe.id}`,dataKey:at,title:gt,nodeCount:Qt,isTarget:ct,isCollapsed:dt,canToggleCollapse:bt,isDragging:w,isDropTarget:en,isHighlighted:et===at,backgroundColor:Dt.brand.subgraphBackground08,borderColor:ct?void 0:Dt.brand.subgraphBorder25,headerBackgroundColor:Dt.brand.subgraphBackground14,onToggleCollapse:()=>Ot(Oe.id),childrenContent:!dt&&kt.length>0?u.jsx("div",{className:"px-1",children:Lt(kt,{scope:"subgraph",subgraphId:Oe.id})}):null},at));return}}),Ie&&M&&Be===xe.length&&be.push(u.jsx(By,{containerKey:bu(J),indexLabel:"end",targetKey:M.targetKey,height:M.placeholderHeight},`placeholder-${bu(J)}-end-${M.targetKey}`)),be},Gt=b.useRef(null);return b.useEffect(()=>{const xe=Gt.current;if(!xe)return;const J=be=>be.stopPropagation();return xe.addEventListener("touchstart",J,!0),xe.addEventListener("touchmove",J,!0),xe.addEventListener("touchend",J,!0),xe.addEventListener("touchcancel",J,!0),()=>{xe.removeEventListener("touchstart",J,!0),xe.removeEventListener("touchmove",J,!0),xe.removeEventListener("touchend",J,!0),xe.removeEventListener("touchcancel",J,!0)}},[]),An.createPortal(u.jsxs("div",{ref:Gt,className:"fixed inset-0 z-[2300] bg-gray-100 flex flex-col",children:[u.jsx(TN,{nodeId:j.type==="node"?j.id:0,canShowConnectionsToggle:j.type==="node"&&Z.hasConnections,connectionHighlightEnabled:I,onToggleConnections:()=>fe(xe=>xe===G?null:G),connectionMode:I?Z.hasUpstream&&Z.hasDownstream?"both":Z.hasUpstream?"inputs":"outputs":"off",leftLineCount:Z.leftLineCount,rightLineCount:Z.rightLineCount,inputHighlightColor:Rf,outputHighlightColor:Df}),u.jsxs(EN,{scrollContainerRef:O,isDragging:w,isPointerArmedForDrag:B,onPointerDown:qe,onPointerMove:Pe,onPointerUp:Qe,onPointerCancel:ut,children:[Lt(v.root,{scope:"root"}),u.jsx("div",{"data-reposition-footer":"root",className:"h-10"})]}),u.jsx(xx,{zIndex:2301,actions:[{key:"cancel",label:"Cancel",onClick:l,variant:"secondary"},{key:"done",label:"Done",onClick:it,variant:"primary"}]})]}),document.body)}function mp(n,o,s){const a=s?.parentHidden??!1,l=s?.parentSubgraphId??null,c=s?.visitedGroups??new Set,d=s?.visitedSubgraphs??new Set,h=s?.hiddenNodeKeys??new Set,p=s?.hiddenGroupKeys??new Set,m=s?.hiddenSubgraphIds??new Set,{layout:y,hiddenItems:x,stableKeyByPointer:v}=o,k=(S,j)=>{if(j in S)return!!S[j];const C=v[j];return C?!!S[C]:!!S[j]};let w=0;for(const S of n){if(S.type==="node"){const R=mn({type:"node",nodeId:S.id,subgraphId:l});(a||k(x,R))&&(w+=1),k(x,R)&&h.add(R);continue}if(S.type==="hiddenBlock"){const R=y.hiddenBlocks[S.blockId]??[];for(const D of R){const L=mn({type:"node",nodeId:D,subgraphId:l});(a||k(x,L))&&(w+=1),k(x,L)&&h.add(L)}continue}if(S.type==="group"){if(c.has(S.stableKey))continue;const R=a||k(x,S.stableKey);k(x,S.stableKey)&&p.add(S.stableKey),c.add(S.stableKey);const D=mp(y.groups[S.stableKey]??[],o,{parentHidden:R,parentSubgraphId:l,visitedGroups:c,visitedSubgraphs:d,hiddenNodeKeys:h,hiddenGroupKeys:p,hiddenSubgraphIds:m});w+=D.hiddenNodeCount,c.delete(S.stableKey);continue}if(d.has(S.id))continue;const j=mn({type:"subgraph",subgraphId:S.id}),C=a||k(x,j);k(x,j)&&m.add(S.id),d.add(S.id);const T=mp(y.subgraphs[S.id]??[],o,{parentHidden:C,parentSubgraphId:S.id,visitedGroups:c,visitedSubgraphs:d,hiddenNodeKeys:h,hiddenGroupKeys:p,hiddenSubgraphIds:m});w+=T.hiddenNodeCount,d.delete(S.id)}return{hiddenNodeKeys:h,hiddenGroupKeys:p,hiddenSubgraphIds:m,hiddenNodeCount:w}}function Gl({workflow:n,runKey:o,isRunning:s,workflowDurationStats:a}){const[l,c]=b.useState(null),d=b.useRef(null),h=b.useRef(null),p=b.useRef(null),m=b.useRef(null),y=b.useRef(null),x=b.useRef(0),v=b.useRef(null);return b.useEffect(()=>{let k=null,w=null;const S=()=>{if(!n){v.current!==null&&(v.current=null,c(null)),p.current=null,m.current=null,y.current=null,d.current=null,x.current=0,h.current=null;return}const j=250,C=Date.now();let T=null;if(!o)h.current?(p.current=C+j,h.current=null,x.current=100,T=100):p.current&&C<p.current?T=100:(p.current=null,m.current=null,y.current=null,d.current=null,x.current=0,T=null);else if(p.current&&C<p.current)m.current=o,T=100;else if(m.current&&C>=(p.current??0)&&(h.current=m.current,m.current=null,d.current=C-j,x.current=0,p.current=null),h.current&&o!==h.current)y.current!==o&&(y.current=o,p.current=C+j,x.current=100),T=100;else{h.current!==o&&(d.current=C,h.current=o,x.current=0,p.current=null);const R=Math.max(0,C-(d.current??C)),D=Pu(n),L=a[D]?.avgMs??null;let B;if(L){const F=R/L*100;B=Math.min(99,Math.max(0,F))}else{const F=R/1e3;F<=50?B=F:B=50+(F-50)*.5,B=Math.min(90,B)}const A=Math.max(x.current,B);x.current=A,T=Math.round(A)}v.current!==T&&(v.current=T,c(T))};return n?(k=setTimeout(S,0),(s||p.current||o)&&(w=setInterval(S,200))):k=setTimeout(S,0),()=>{k&&clearTimeout(k),w&&clearInterval(w)}},[n,o,s,a]),l}function $N(){const n=de(d=>d.workflowLoadedAt),[o,s]=b.useState(null),a=o===n,l=b.useCallback(d=>{s(d?n:null)},[n]),c=b.useCallback(()=>{s(null)},[]);return{errorPopoverOpen:a,setErrorPopoverOpen:l,resetErrorPopover:c}}const KN=new Set(["mp4","webm","mkv","mov","avi","m4v"]);function Pl(n){const o=n.split(".").pop()?.toLowerCase()??"";return KN.has(o)?"video":"image"}function pa(n){return Pl(n)==="video"}function Zp({open:n,buttonRef:o,menuRef:s,repositionToken:a,menuWidth:l=176,horizontalAnchorOffset:c=160,viewportPadding:d=8,bottomBarReserve:h=104}){const[p,m]=b.useState(null),y=b.useCallback(()=>{m(null)},[]);return b.useLayoutEffect(()=>{if(!n)return;const x=()=>{const w=o.current,S=s.current;if(!w||!S)return;const j=w.getBoundingClientRect(),C=S.getBoundingClientRect().height,T=j.bottom,R=j.top-C,D=window.innerHeight-h,L=T+C<=D,B=R>=d,F=Math.max(d,Math.min(L?T:B?R:T,D-C)),te=Math.max(d,Math.min(j.right-c,window.innerWidth-l-d));m({top:F,left:te})};x();const v=requestAnimationFrame(x),k=requestAnimationFrame(x);return window.addEventListener("resize",x),()=>{cancelAnimationFrame(v),cancelAnimationFrame(k),window.removeEventListener("resize",x)}},[n,o,s,l,c,d,h,a]),{menuPosition:p,menuStyle:{top:p?.top??-9999,left:p?.left??-9999,visibility:p?"visible":"hidden"},resetMenuPosition:y}}const Wy="/loras",VN=new Set(["http:","https:"]);function Fy(n){if(typeof window>"u")return n;try{const o=new URL(n,window.location.origin);return VN.has(o.protocol)?o.toString():null}catch{return null}}function UN(){const n=typeof window<"u"?window.localStorage.getItem("comfyui-mobile-lora-manager-ui-url")?.trim()??"":"";if(n){const s=Fy(n);if(s)return s}return Fy(Wy)??Wy}function WN(){return typeof window>"u"?!1:window.open(UN(),"_blank","noopener,noreferrer")!==null}function FN({nodeId:n,nodeStableKey:o,isLoraManagerNode:s,isBypassed:a,onEditLabel:l,pinnableWidgets:c,singlePinnableWidget:d,isSingleWidgetPinned:h,hasPinnedWidget:p,toggleWidgetPin:m,setPinnedWidget:y,isNodeBookmarked:x,canAddNodeBookmark:v,onToggleNodeBookmark:k,toggleBypass:w,setItemHidden:S,onDeleteNode:j,onMoveNode:C,connectionHighlightMode:T,setConnectionHighlightMode:R,leftLineCount:D,rightLineCount:L}){const[B,A]=b.useState(!1),[F,te]=b.useState(!1),ee=b.useRef(null),ae=b.useRef(null),ne=()=>{A(!1),te(!1),Le()},{menuStyle:me,resetMenuPosition:Le}=Zp({open:B,buttonRef:ae,menuRef:ee,repositionToken:F});Na({open:B,onDismiss:ne,triggerRef:ae,contentRef:ee,ignoreScrollWithinContent:!0});const P=D>0||L>0,V=De=>{De.stopPropagation();const Fe=D>0,ue=L>0;if(!Fe&&!ue)return;const ye=Fe&&ue?["off","inputs","outputs","both"]:Fe?["off","inputs"]:["off","outputs"],et=ye.indexOf(T),oe=ye[(et+1)%ye.length];R(o,oe)},H=De=>{De.stopPropagation(),Le(),A(Fe=>!Fe)},ce=De=>{De.stopPropagation(),l(),ne()},ke=De=>{De.stopPropagation(),w(o),ne()},Ne=De=>{De.stopPropagation(),S(o,!0),ne()},O=De=>{De.stopPropagation(),WN(),ne()},_=De=>{De.stopPropagation(),d&&(m(d.widgetIndex,d.name,d.type,d.options),ne())},q=De=>{De.stopPropagation(),y(null),ne()},je=De=>{De.stopPropagation(),te(!F)},Ke=De=>Fe=>{Fe.stopPropagation(),y({nodeId:n,widgetIndex:De.widgetIndex,widgetName:De.name,widgetType:De.type,options:De.options}),ne()};return u.jsxs("div",{className:"flex items-center gap-1 relative",onClick:De=>De.stopPropagation(),children:[P&&u.jsx("button",{type:"button",className:"w-8 h-8 flex items-center justify-center","aria-pressed":T!=="off","aria-label":"Highlight connected nodes",onClick:V,children:u.jsx(px,{className:"w-6 h-6 overflow-visible",nodeId:n,connectionHighlightMode:T,leftLineCount:D,rightLineCount:L})}),u.jsx(ns,{onClick:H,buttonRef:ae,ariaLabel:"Node options",buttonSize:8,iconSize:5,icon:x?u.jsx(ts,{className:"w-5 h-5 text-yellow-500"}):void 0}),B&&An.createPortal(u.jsx("div",{ref:ee,className:"fixed z-[1000] w-44",style:me,children:u.jsx(Sr,{items:[{key:"edit-label",label:"Edit Label",icon:u.jsx(Gp,{className:"w-4 h-4"}),onClick:ce},{key:"toggle-bookmark",label:x?"Remove bookmark":"Bookmark node",icon:x?u.jsx(fc,{className:"w-4 h-4"}):u.jsx(ts,{className:"w-4 h-4 text-yellow-500"}),onClick:De=>{De.stopPropagation(),k(),ne()},hidden:!(x||v)},{type:"divider",key:"divider-node-actions"},{key:"toggle-bypass",label:a?"Engage node":"Bypass node",icon:u.jsx(hp,{className:"w-4 h-4",isBypassed:a}),onClick:ke},{key:"hide-node",label:"Hide node",icon:u.jsx(Yo,{className:"w-4 h-4"}),onClick:Ne},{key:"move-node",label:"Move",icon:u.jsx(yx,{className:"w-4 h-4"}),onClick:De=>{De.stopPropagation(),C(),ne()}},{key:"open-lora-manager",label:"Open LoRA Manager",icon:u.jsx(gp,{className:"w-4 h-4"}),onClick:O,hidden:!s},{type:"divider",key:"divider-pin",className:c.length>0?"":"hidden"},{key:"pin-single-widget",label:h?"Remove pin":"Pin widget",icon:h?u.jsx(_l,{className:"w-4 h-4 text-fuchsia-500"}):u.jsx(pp,{className:"w-4 h-4"}),onClick:_,hidden:!(c.length>0&&d)},{key:"remove-pin",label:"Remove pin",icon:u.jsx(_l,{className:"w-4 h-4 text-fuchsia-500"}),onClick:q,hidden:!(c.length>0&&!d&&p)},{key:"pin-widget-submenu",label:"Pin widget",icon:u.jsx(pp,{className:"w-4 h-4"}),rightSlot:u.jsx(Qp,{className:`w-4 h-4 text-gray-400 transition-transform ${F?"rotate-90":""}`}),onClick:je,hidden:!(c.length>0&&!d)},{type:"custom",key:"pin-widget-items",hidden:!(c.length>0&&!d&&F),render:u.jsx("div",{className:"border-t border-gray-100 bg-gray-50 max-h-48 overflow-auto",children:c.map(De=>u.jsx("button",{className:"w-full text-left px-4 py-2 text-sm hover:bg-gray-100 text-gray-700",onClick:Ke(De),children:De.name},De.widgetIndex))})},{type:"divider",key:"divider-delete"},{key:"delete-node",label:"Delete node",icon:u.jsx(Ho,{className:"w-4 h-4"}),color:"danger",onClick:De=>{De.stopPropagation(),j(),ne()}}]})}),document.body)]})}function qN({nodeId:n,open:o,errors:s,anchorRef:a,onClose:l}){const c=y=>{y.stopPropagation(),l()},[d,h]=b.useState(null),p=b.useRef(null),m=ao(y=>y.currentPanel);return b.useEffect(()=>{o&&m!=="workflow"&&l()},[o,m,l]),b.useEffect(()=>{if(!o)return;const y=()=>{const k=a.current;if(!k)return;const w=k.getBoundingClientRect();h({top:w.bottom+8,left:Math.max(16,Math.min(w.left+w.width/2-140,window.innerWidth-296))})};y();const x=k=>{k.target&&(a.current?.contains(k.target)||p.current?.contains(k.target)||l())},v=()=>{l()};return document.addEventListener("pointerdown",x),document.addEventListener("scroll",v,!0),window.addEventListener("resize",y),()=>{document.removeEventListener("pointerdown",x),document.removeEventListener("scroll",v,!0),window.removeEventListener("resize",y)}},[o,n,l,a]),!o||s.length===0||!d?null:An.createPortal(u.jsxs("div",{ref:p,id:`error-popover-${n}`,className:"error-popover-root fixed z-[2000] bg-red-50 border border-red-700 rounded-lg shadow-lg w-72 max-h-64 overflow-hidden",style:{top:d.top,left:d.left},children:[u.jsxs("div",{id:`error-popover-header-${n}`,className:"popover-header flex items-center justify-between px-3 py-2 border-b border-red-200 bg-red-700",children:[u.jsxs("span",{id:`error-popover-title-${n}`,className:"popover-title text-sm font-semibold text-white",children:[s.length," ",s.length===1?"Error":"Errors"]}),u.jsx("button",{type:"button",onClick:c,className:"w-6 h-6 flex items-center justify-center text-red-200 hover:text-white rounded","aria-label":"Close",children:u.jsx(dx,{className:"w-4 h-4"})})]}),u.jsx("div",{id:`error-popover-body-${n}`,className:"popover-body p-3 space-y-2 bg-red-100",children:s.map((y,x)=>{const v=y.details?.toLowerCase().replace(/[_\s]/g,"")||"",k=y.inputName?.toLowerCase().replace(/[_\s]/g,"")||"",w=!y.details||y.details===y.message||y.inputName&&v===k;return u.jsxs("div",{className:"error-item flex items-start gap-2 text-sm",children:[u.jsx("span",{className:"error-dot mt-1.5 h-1.5 w-1.5 rounded-full bg-red-700 shrink-0","aria-hidden":"true"}),u.jsxs("div",{className:"error-content-wrapper min-w-0",children:[y.inputName&&u.jsx("div",{className:"error-input-name font-medium text-red-800 mb-0.5",children:y.inputName}),u.jsx("div",{className:"error-message-text text-red-800",children:y.message}),!w&&u.jsx("div",{className:"error-details-text text-xs text-red-700 mt-0.5 break-words",children:y.details})]})]},x)})})]}),document.body)}function GN({noteText:n,noteLinkified:o,noteWidgetIndex:s,isEditingNote:a,setIsEditingNote:l,onUpdateNote:c,noteTextareaRef:d,onNoteTap:h}){const p=y=>{s!==null&&c(y)},m=y=>{s!==null&&c(y.target.value)};return u.jsxs("div",{className:"mb-3 group","data-textarea-root":"true",children:[u.jsxs("div",{className:"flex items-center justify-between mb-1.5","data-textarea-header":"true",children:[u.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Note"}),a&&u.jsx(jl,{value:n,onChange:p,textareaRef:d,className:"opacity-70 transition-opacity group-focus-within:opacity-100"})]}),a?u.jsx("textarea",{ref:d,value:n,onChange:m,onBlur:()=>l(!1),className:"w-full p-3 border rounded-lg text-base resize-none note-display",rows:Math.min(8,Math.max(3,n.split(`
`).length))}):u.jsx("div",{className:"w-full p-3 border rounded-lg text-base whitespace-pre-wrap break-words note-display",onDoubleClick:()=>l(!0),onTouchEnd:h,children:o})]})}function PN({show:n,previewImage:o,previewText:s=null,displayName:a,onImageClick:l,isExecuting:c,overallProgress:d,displayNodeProgress:h}){return!n||!o&&!s?null:u.jsxs("div",{className:"mb-3",children:[u.jsx("div",{className:"text-xs text-gray-500 mb-1.5 uppercase tracking-wide",children:"Output Preview"}),o&&u.jsxs("div",{className:"relative",children:[u.jsx("img",{src:bo(o.filename,o.subfolder,o.type),alt:`${a} output`,className:"w-full h-auto rounded-lg border border-gray-100",loading:"lazy",onClick:l},"preview"),c&&d!==null&&u.jsx("div",{className:"absolute inset-0 bg-black/40 rounded-lg flex items-end p-3",children:u.jsxs("div",{className:"w-full",children:[u.jsxs("div",{className:"flex items-center justify-between text-xs text-white/90 mb-1",children:[u.jsx("span",{children:"Progress"}),u.jsxs("span",{children:[h,"%"]})]}),u.jsx("div",{className:"h-2 rounded-full bg-white/30 overflow-hidden",children:u.jsx("div",{className:"h-full bg-green-500 transition-none",style:{width:`${Math.min(100,Math.max(0,h))}%`}})}),u.jsxs("div",{className:"flex items-center justify-between text-xs text-white/90 mt-2 mb-1",children:[u.jsx("span",{children:"Overall"}),u.jsxs("span",{children:[d,"%"]})]}),u.jsx("div",{className:"h-2 rounded-full bg-white/30 overflow-hidden",children:u.jsx("div",{className:"h-full bg-blue-500 transition-none",style:{width:`${Math.min(100,Math.max(0,d))}%`}})})]})})]}),s&&u.jsx("div",{className:`${o?"mt-3":""}`,children:u.jsx("pre",{className:"w-full p-3 comfy-input text-base text-gray-600 opacity-60 whitespace-pre-wrap break-words font-sans",style:{overflowAnchor:"none"},children:s})})]})}function YN({nodeId:n,displayName:o,isEditingLabel:s,labelValue:a,labelInputRef:l,onLabelChange:c,onLabelBlur:d,isCollapsed:h,isBypassed:p,isExecuting:m,overallProgress:y,hasErrors:x,errorIconRef:v,errorPopoverOpen:k,setErrorPopoverOpen:w,toggleNodeFold:S,rightSlot:j}){const C=()=>{s||S()},T=D=>{D.stopPropagation(),S()},R=D=>{D.stopPropagation(),w(!k)};return u.jsxs("div",{id:`node-header-${n}`,className:`node-header flex items-center justify-between cursor-pointer gap-3 ${h?"":"mb-3 pb-2 border-b"} ${p?`bg-purple-200 border-purple-300 px-3 -mx-3 -mt-1 pt-1 rounded-t-xl ${h?"pb-1 -mb-1 rounded-b-xl":""}`:h?"":"border-gray-100"}`,onClick:C,children:[u.jsxs("div",{id:`node-title-container-${n}`,className:"flex items-center gap-1 min-w-0",children:[u.jsx("button",{onClick:T,className:"w-8 h-8 -ml-2 flex items-center justify-center text-gray-400 hover:text-gray-600 shrink-0",children:h?u.jsx(js,{className:"w-6 h-6"}):u.jsx(so,{className:"w-6 h-6"})}),s?u.jsx("input",{ref:l,value:a,onChange:D=>c(D.target.value),onBlur:d,onKeyDown:D=>{(D.key==="Enter"||D.key==="Escape")&&D.currentTarget.blur()},onClick:D=>D.stopPropagation(),className:"font-semibold text-gray-900 flex-1 min-w-0 text-sm bg-white border border-gray-200 rounded px-2 py-1"}):u.jsx("h3",{id:`node-display-name-${n}`,className:`font-semibold text-gray-900 select-none flex-1 min-w-0 ${h?"whitespace-nowrap overflow-hidden text-ellipsis":"whitespace-normal break-words"}`,children:o}),u.jsxs("span",{id:`node-id-badge-${n}`,className:"text-xs text-gray-400 min-w-[2ch] text-right",children:["#",n]}),x&&u.jsx("button",{ref:v,type:"button",onClick:R,className:"w-5 h-5 flex items-center justify-center text-red-500 hover:text-red-600 shrink-0","aria-label":"View errors",children:u.jsx(fx,{className:"w-4 h-4"})}),m&&h&&y!==null?u.jsxs("div",{id:`node-progress-indicator-${n}`,className:"relative w-6 h-6 flex items-center justify-center",children:[u.jsx(PS,{className:"absolute",width:"24",height:"24",style:{transform:"rotate(-90deg)"},progress:y,radius:10}),u.jsx("span",{id:`node-progress-text-${n}`,className:"text-[8px] font-bold text-blue-600",children:y})]}):null,m&&!h?u.jsx("span",{id:`node-executing-pulse-${n}`,className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}):null]}),u.jsx("div",{id:`node-header-right-slot-${n}`,className:"header-right-slot",children:j})]})}function QN({nodeId:n,displayName:o,hasConnections:s,onCancel:a,onDelete:l}){const c=[s?{label:"Delete & Reconnect",onClick:()=>l(!0),className:"w-full px-4 py-2.5 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700 active:bg-red-800"}:null,{label:s?"Delete & Disconnect":"Delete",onClick:()=>l(!1),className:s?"w-full px-4 py-2.5 text-sm font-medium text-red-700 bg-red-50 rounded-lg hover:bg-red-100 active:bg-red-200":"w-full px-4 py-2.5 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700 active:bg-red-800"},{label:"Cancel",onClick:a,className:"w-full px-4 py-2.5 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 active:bg-gray-300"}].filter(d=>d!==null);return An.createPortal(u.jsx(Qo,{onClose:a,title:"Delete node",description:u.jsxs(u.Fragment,{children:["Delete ",u.jsx("span",{className:"font-medium text-gray-700",children:o})," (#",n,")?"]}),actionsLayout:"stack",actions:c}),document.body)}function XN({label:n}){return u.jsx("div",{className:"absolute -top-6 left-1/2 -translate-x-1/2 z-[100] animate-in fade-in slide-in-from-bottom-2 duration-200",children:u.jsx("div",{className:"bg-red-600 text-white text-[10px] font-black px-2 py-0.5 rounded-full shadow-lg whitespace-nowrap uppercase tracking-tighter ring-2 ring-white",children:n})})}function Po(n){return n.toLowerCase().replace(/[_-]+/g," ").replace(/\s+/g," ").trim()}function yp(n,o){if(!n.trim())return!0;const s=Po(o);return Po(n).split(" ").filter(Boolean).every(a=>s.includes(a))}function Xu(n,o){if(!n)return!0;let s=0;for(const a of o)if(a===n[s]&&(s+=1),s>=n.length)return!0;return!1}function Ro(n,o){if(!n)return 0;const s=Po(n),a=Po(o);return a?a===s?120:a.startsWith(s)?90:a.includes(s)?70:Xu(s,a)?40:0:0}function ws(n){return n.replace(/^custom_nodes\./,"").replace(/[._-]+/g," ").replace(/\s+/g," ").trim()}function wx(n){const o=String(n).split(",")[0].trim().toUpperCase();return["IMAGE","LATENT","MODEL","CLIP","VAE","CONDITIONING","INT","FLOAT","STRING","BOOLEAN","MASK"].includes(o)?`type-${o}`:"type-default"}function Bf(n){if(n==null)return null;const o=String(n).trim();if(!o)return null;const s=o.toLowerCase();return s==="null"||s==="undefined"?null:o}function Ss(n,o){return Bf(n?.display_name)??Bf(n?.name)??Bf(o)??o}function bp(n,o,s,a){const l=o.trim(),c=n.map(d=>{const{displayName:h,typeName:p,category:m="",pack:y=""}=s(d),x=`${h} ${p} ${m} ${y}`;if(!(!l||yp(l,x)||Xu(Po(l),Po(x))))return null;const k=l?Ro(l,h)*10+Ro(l,p)*4:0;return{item:d,score:k}}).filter(d=>d!==null);return c.sort((d,h)=>h.score!==d.score?h.score-d.score:a(d.item)-a(h.item)),c.map(d=>d.item)}function ZN({nodeId:n,displayName:o,pack:s,outputName:a,outputType:l,inputName:c,isConnected:d,onSelect:h}){return u.jsx("button",{type:"button",className:`w-full text-left rounded-xl border px-4 py-3 shadow-sm transition ${d?"border-blue-300 bg-white":"border-gray-200 bg-white hover:border-gray-300 active:scale-[0.998]"}`,onClick:h,children:u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsxs("div",{className:"text-sm font-semibold text-gray-900 flex items-center gap-2 min-w-0",children:[u.jsxs("span",{className:"truncate",children:[o," ",u.jsxs("span",{className:"text-gray-400",children:["#",n]})]}),d&&u.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-blue-100 text-blue-700 text-[10px] font-medium shrink-0",children:[u.jsx(zo,{className:"w-3 h-3"}),"Currently connected"]})]}),u.jsx("div",{className:"text-xs text-gray-500 truncate mt-0.5",children:s||"Core"}),u.jsxs("div",{className:"text-xs text-gray-700 mt-1 inline-flex items-center gap-1.5",children:[u.jsx("span",{className:`inline-flex h-5 w-5 items-center justify-center rounded-full text-[11px] font-bold ${wx(l)}`,children:""}),u.jsxs("span",{className:"truncate",children:[a," -> ",c]})]})]})})}function Rl({onClick:n,ariaLabel:o="Close",variant:s="default",buttonSize:a=10,iconSize:l=6,isIdle:c,zIndex:d}){const h=typeof c=="boolean"||typeof d=="number",p=h?"viewer":s;return u.jsx("button",{onClick:n,className:`transition-colors flex items-center justify-center rounded-full ${p==="viewer"?`absolute top-3 right-3 w-${a} h-${a} text-white ${c?"bg-transparent":"bg-black/60"}`:p==="plain"?`w-${a} h-${a} text-gray-500 bg-transparent hover:bg-transparent`:`w-${a} h-${a} bg-gray-100 dark:bg-gray-800 text-gray-500 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700`}`.trim(),style:h&&typeof d=="number"?{zIndex:d}:void 0,"aria-label":o,children:u.jsx(Ul,{className:`w-${l} h-${l}`})})}function Sx({isOpen:n,onClose:o,title:s,searchQuery:a,onSearchQueryChange:l,searchPlaceholder:c,onBack:d,backLabel:h="Back",children:p,footer:m,zIndex:y=2200}){return n?An.createPortal(u.jsx("div",{className:"fixed inset-0 bg-gray-400/40 backdrop-blur-sm",style:{zIndex:y},onClick:o,children:u.jsxs("div",{className:"w-full h-full flex flex-col",onClick:x=>x.stopPropagation(),children:[u.jsxs("div",{className:"bg-white border-b border-gray-200 px-4 py-3 flex items-center justify-between safe-area-inset-top",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[d&&u.jsx("button",{type:"button",className:"text-sm text-blue-600 font-medium",onClick:d,children:h}),u.jsx("h2",{className:"text-base font-semibold text-gray-900",children:s})]}),u.jsx(Rl,{onClick:o,variant:"plain",buttonSize:8,iconSize:5})]}),u.jsx("div",{className:"bg-white px-4 py-2 border-b border-gray-100",children:u.jsx(ql,{value:a,onChange:l,placeholder:c,autoFocus:!0})}),p,m??u.jsx("div",{className:"flex-shrink-0 h-12 bg-white border-t border-gray-200 flex items-center justify-center",children:u.jsx("button",{type:"button",className:"text-sm text-gray-500 font-medium",onClick:o,children:"Cancel"})})]})}),document.body):null}function xp({title:n,subtitle:o,onSelect:s,outputType:a,outputName:l,inputName:c,titleClassName:d="text-sm font-semibold text-gray-900 truncate"}){return u.jsx("button",{type:"button",className:"w-full text-left rounded-xl border border-gray-200 bg-white px-4 py-3 shadow-sm hover:border-gray-300 active:scale-[0.998] transition",onClick:s,children:u.jsxs("div",{className:"min-w-0",children:[u.jsx("div",{className:d,children:n}),u.jsx("div",{className:"text-xs text-gray-500 truncate mt-0.5",children:o||"Core"}),a&&l&&c&&u.jsxs("div",{className:"text-xs text-gray-700 mt-1 inline-flex items-center gap-1.5",children:[u.jsx("span",{className:`inline-flex h-5 w-5 items-center justify-center rounded-full text-[11px] font-bold ${wx(a)}`,children:""}),u.jsxs("span",{className:"truncate",children:[String(l)," -> ",c]})]})]})})}function Nl({query:n,message:o}){return n.trim()?u.jsx("div",{className:"px-4 py-8 text-center text-sm text-gray-500",children:o}):null}function Fo(n,o){return`${n}:${o}`}function JN(n,o){if(n.size!==o.size)return!1;for(const s of n)if(!o.has(s))return!1;return!0}function qy(n){const{isOpen:o,onClose:s,nodeId:a,mode:l}=n,c=de(I=>I.workflow),d=de(I=>I.nodeTypes),h=de(I=>I.connectNodes),p=de(I=>I.disconnectInput),m=de(I=>I.addNode),y=de(I=>I.addNodeAndConnect),x=de(I=>I.scrollToNode),[v,k]=b.useState(""),[w,S]=b.useState("pick"),[j,C]=b.useState(()=>{if(l!=="output"||!c)return new Set;const I=new Set;for(const $ of c.links){const[,Z,Se,Q,Me]=$;Z===a&&Se===n.outputIndex&&I.add(Fo(Q,Me))}return I}),[T,R]=b.useState(!1),[D,L]=b.useState(null),[B,A]=b.useState(new Set),F=b.useMemo(()=>c?c.nodes.find($=>$.id===a)?.stableKey??null:null,[a,c]),te=I=>{const $=de.getState().workflow;return $?$.nodes.find(Se=>Se.id===I)?.stableKey??null:null},ee=b.useMemo(()=>l!=="input"||!c||!d?[]:K2(c,d,a,n.inputIndex),[l,c,d,a,n]),ae=b.useMemo(()=>{if(l!=="input")return[];const I=v.trim(),$=ee.map(Z=>{const{node:Se}=Z,Q=d?.[Se.type],Me=Se.title,K=typeof Me=="string"&&Me.trim()?Me.trim():Q?.display_name||Se.type,Te=`${K} ${Q?.display_name??""} ${Se.type} ${String(Se.id)}`;if(!(!I||yp(I,Te)||Xu(Po(I),Po(Te))))return null;const qe=Ro(I,K)*4+Ro(I,Q?.display_name??"")*3+Ro(I,Se.type)*2+Ro(I,String(Se.id));return{...Z,score:qe}}).filter(Boolean);return $.sort((Z,Se)=>Se.score-Z.score||Z.node.id-Se.node.id),$},[l,ee,v,d]),ne=b.useMemo(()=>l!=="input"||!d?[]:V2(d,n.inputType).map((I,$)=>({...I,index:$})),[l,d,n]),me=b.useMemo(()=>l!=="output"||!d?[]:W2(d,n.outputType).map((I,$)=>({...I,index:$})),[l,d,n]),Le=b.useMemo(()=>l!=="input"?[]:bp(ne,v,I=>{const $=Ss(I.def,I.typeName),Z=Ss({display_name:I.def.name,name:I.typeName},I.typeName),Se=ws(I.def.python_module||I.def.category?.split("/")[0]||"Core");return{displayName:$,typeName:Z,category:String(I.def.category??""),pack:Se}},I=>I.index),[l,ne,v]),P=b.useMemo(()=>l!=="output"?[]:bp(me,v,I=>{const $=Ss(I.def,I.typeName),Z=Ss({display_name:I.def.name,name:I.typeName},I.typeName),Se=ws(I.def.python_module||I.def.category?.split("/")[0]||"Core");return{displayName:$,typeName:Z,category:String(I.def.category??""),pack:Se}},I=>I.index),[l,me,v]),V=b.useMemo(()=>{if(l!=="output"||!c||!d)return[];const I=F2(c,a,n.outputIndex),$=new Set;for(const Me of c.links){const[,K,Te,_e,qe]=Me;K===a&&Te===n.outputIndex&&$.add(Fo(_e,qe))}const Z=v.trim(),Q=I.map(({node:Me,inputIndex:K})=>{const Te=d[Me.type],_e=Me.title,qe=typeof _e=="string"&&_e.trim()?_e.trim():Te?.display_name||Me.type,Ge=ws(String(Te?.python_module??Te?.category?.split("/")[0]??"Core")),Ve=Me.inputs?.[K];if(!Ve)return null;const Je=Ve.localized_name||Ve.name||`Input ${K+1}`,Ue=String(Ve.type),Xe=Fo(Me.id,K),Pe=$.has(Xe);let he=!1,Qe=null;const ut=Ve.link;if(ut!=null&&!Pe){const wt=c.links.find(It=>It[0]===ut);if(wt){he=!0;const[,It]=wt,Kt=c.nodes.find(pt=>pt.id===It);Kt&&(Qe=`${d[Kt.type]?.display_name||Kt.type} #${Kt.id}`)}}const it=`${qe} ${Te?.display_name??""} ${Me.type} ${String(Me.id)} ${Je}`;if(!(!Z||yp(Z,it)||Xu(Po(Z),Po(it))))return null;const Ot=Ro(Z,qe)*4+Ro(Z,Je)*3+Ro(Z,Te?.display_name??"")*2+Ro(Z,Me.type)*2+Ro(Z,String(Me.id));return{nodeId:Me.id,inputIndex:K,displayName:qe,pack:Ge,inputName:Je,inputType:Ue,currentlyConnectedFromThisOutput:Pe,hasExistingLink:he,existingSourceLabel:Qe,score:Ot}}).filter(Me=>Me!==null);return Q.sort((Me,K)=>K.score-Me.score||Me.nodeId-K.nodeId),Q},[l,c,d,a,n,v]),H=b.useMemo(()=>l!=="output"?new Set:new Set(V.filter(I=>I.currentlyConnectedFromThisOutput).map(I=>Fo(I.nodeId,I.inputIndex))),[l,V]),ce=b.useMemo(()=>{const I=new Map;for(const $ of V)I.set(Fo($.nodeId,$.inputIndex),$);return I},[V]),ke=b.useMemo(()=>{if(l!=="output")return[];const I=new Map;for(const $ of V){const Z=I.get($.nodeId);if(Z){Z.inputs.push($),$.score>Z.score&&(Z.score=$.score);continue}I.set($.nodeId,{nodeId:$.nodeId,displayName:$.displayName,pack:$.pack,score:$.score,inputs:[$]})}return Array.from(I.values()).sort(($,Z)=>Z.score-$.score||$.nodeId-Z.nodeId)},[l,V]),Ne=b.useMemo(()=>l!=="output"?!1:!JN(j,H),[l,j,H]),O=b.useMemo(()=>{if(l!=="output")return[];const I=[];for(const $ of j){if(H.has($))continue;const Z=ce.get($);Z?.hasExistingLink&&I.push(Z)}return I},[l,j,H,ce]),_=(I,$)=>{if(l!=="input")return;const Z=te(I);!Z||!F||(h(Z,$,F,n.inputIndex,n.inputType),s(),x(Z))},q=()=>{l==="input"&&F&&(p(F,n.inputIndex),s())},je=I=>{if(l!=="input"||!F)return;const $=y(I,F,n.inputIndex);if(s(),$!==null){const Z=te($);Z&&x(Z)}},Ke=(I,$,Z)=>{if(l!=="output"||!F)return;const Se=m(I,{nearNodeStableKey:F});if(Se===null)return;const Q=te(Se);if(!Q)return;const K=de.getState().workflow?.nodes.find(Ge=>Ge.id===Se);if(!K||!F)return;const Te=K.inputs.findIndex(Ge=>Ge.type.toUpperCase()===Z.toUpperCase()),_e=Te>=0?Te:$,qe=K.inputs[_e]?.type;qe!=null&&(h(F,n.outputIndex,Q,_e,qe),s(),x(Q))},De=(I,$)=>{const Z=Fo(I,$);C(Se=>{const Q=new Set(Se);return Q.has(Z)?Q.delete(Z):Q.add(Z),Q})},Fe=I=>{const $=new Set;for(const Z of I.inputs){const Se=Fo(Z.nodeId,Z.inputIndex);j.has(Se)&&$.add(Se)}L(I.nodeId),A($)},ue=()=>{L(null),A(new Set)},ye=I=>{A($=>{const Z=new Set($);return Z.has(I)?Z.delete(I):Z.add(I),Z})},et=()=>{if(D==null)return;const I=ke.find(Z=>Z.nodeId===D);if(!I){ue();return}const $=I.inputs.map(Z=>Fo(Z.nodeId,Z.inputIndex));C(Z=>{const Se=new Set(Z);for(const Q of $)Se.delete(Q);for(const Q of B)Se.add(Q);return Se}),ue()},oe=I=>{if(I.inputs.length>1){Fe(I);return}const $=I.inputs[0];$&&De($.nodeId,$.inputIndex)},z=()=>{if(l==="output"){for(const I of H){if(j.has(I))continue;const $=ce.get(I);if(!$)continue;const Z=te($.nodeId);Z&&p(Z,$.inputIndex)}for(const I of j){if(H.has(I))continue;const $=ce.get(I);if(!$)continue;const Z=te($.nodeId);!Z||!F||h(F,n.outputIndex,Z,$.inputIndex,$.inputType)}s()}},U=()=>{if(l==="output"){if(O.length>0){R(!0);return}z()}},se=l==="input"?w==="pick"?`Connect ${n.inputName}`:"Add new node":w==="pick"?`Connect ${n.outputName}`:"Add new node",fe=l==="input"?w==="pick"?"Search existing nodes...":"Search node types...":w==="pick"?"Search target nodes...":"Search node types...",M=()=>{if(l!=="input")return null;const I=n;return u.jsxs("div",{className:"px-3 pt-3 pb-20 flex flex-col gap-2",children:[ae.map(({node:$,outputIndex:Z})=>{const Se=d?.[$.type],Q=$.title,Me=typeof Q=="string"&&Q.trim()?Q.trim():Se?.display_name||$.type,K=ws(String(Se?.python_module??Se?.category?.split("/")[0]??"Core")),Te=$.outputs?.[Z],_e=Te?.localized_name||Te?.name||`Output ${Z+1}`,qe=String(Te?.type??I.inputType),Ge=$.id===I.currentlyConnectedNodeId;return u.jsx(ZN,{nodeId:$.id,displayName:Me,pack:K,outputName:_e,outputType:qe,inputName:I.inputName,isConnected:Ge,onSelect:()=>_($.id,Z)},$.id)}),ae.length===0&&u.jsx(Nl,{query:v,message:"No matching nodes found"}),u.jsxs("button",{type:"button",className:"w-full text-left rounded-xl border-2 border-gray-700 bg-white px-4 py-3 flex items-center gap-3 hover:bg-gray-100 active:scale-[0.998] transition shadow-sm",onClick:()=>{S("addNew"),k("")},children:[u.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-800 flex items-center justify-center flex-shrink-0",children:u.jsx(Io,{className:"w-4 h-4 text-white"})}),u.jsx("span",{className:"text-sm font-semibold text-gray-900",children:"Add new node..."})]}),I.currentlyConnectedNodeId!==null&&u.jsx("button",{type:"button",className:"w-full text-left rounded-xl border border-red-200 bg-red-50 px-4 py-3 text-sm font-semibold text-red-600 hover:bg-red-100 active:scale-[0.998] transition",onClick:q,children:"Disconnect"})]})},re=()=>{if(l!=="input")return null;const I=n;return u.jsxs("div",{className:"px-3 pt-3 pb-20 flex flex-col gap-2",children:[Le.length===0&&u.jsx(Nl,{query:v,message:"No matching node types found"}),Le.map(({typeName:$,def:Z,outputIndex:Se})=>{const Q=ws(String(Z.python_module??Z.category?.split("/")[0]??"Core")),Me=String(Z.output?.[Se]??I.inputType),K=Z.output_name?.[Se]??Z.output?.[Se]??"Output";return u.jsx(xp,{title:Ss(Z,$),subtitle:Q||"Core",outputType:Me,outputName:String(K),inputName:I.inputName,titleClassName:"text-sm font-medium text-gray-900 truncate",onSelect:()=>je($)},$)})]})},W=()=>{if(l!=="output")return null;const I=n;return u.jsxs("div",{className:"px-3 pt-3 pb-20 flex flex-col gap-2",children:[ke.map($=>{const Se=$.inputs.filter(Te=>j.has(Fo(Te.nodeId,Te.inputIndex))).length>0,Q=$.inputs.some(Te=>Te.hasExistingLink),Me=$.inputs.some(Te=>Te.currentlyConnectedFromThisOutput),K=$.inputs.length>1?`${$.inputs.length} compatible inputs`:`${I.outputName} -> ${$.inputs[0]?.inputName??"Input"}`;return u.jsx("button",{type:"button",className:`w-full text-left rounded-xl border px-4 py-3 shadow-sm transition ${Se?"border-blue-300 bg-blue-50":"border-gray-200 bg-white hover:border-gray-300 active:scale-[0.998]"}`,onClick:()=>oe($),children:u.jsxs("div",{className:"flex items-start justify-between gap-3",children:[u.jsxs("div",{className:"min-w-0 flex-1",children:[u.jsxs("div",{className:"text-sm font-semibold text-gray-900 flex items-center gap-2 min-w-0",children:[u.jsxs("span",{className:"truncate",children:[$.displayName," ",u.jsxs("span",{className:"text-gray-400",children:["#",$.nodeId]})]}),Me&&u.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-blue-100 text-blue-700 text-[10px] font-medium shrink-0",children:[u.jsx(zo,{className:"w-3 h-3"}),"Connected"]}),Q&&u.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full bg-amber-100 text-amber-700 text-[10px] font-medium shrink-0",children:"Already linked"})]}),u.jsx("div",{className:"text-xs text-gray-500 truncate mt-0.5",children:$.pack||"Core"}),u.jsx("div",{className:"text-xs text-gray-700 mt-1 truncate",children:K})]}),u.jsx("div",{className:`w-5 h-5 rounded border flex items-center justify-center ${Se?"bg-blue-600 border-blue-600":"bg-white border-gray-300"}`,children:Se&&u.jsx(zo,{className:"w-3 h-3 text-white"})})]})},`output-node-${$.nodeId}`)}),ke.length===0&&u.jsx(Nl,{query:v,message:"No matching target nodes found"}),u.jsxs("button",{type:"button",className:"w-full text-left rounded-xl border-2 border-gray-700 bg-white px-4 py-3 flex items-center gap-3 hover:bg-gray-100 active:scale-[0.998] transition shadow-sm",onClick:()=>{S("addNew"),k("")},children:[u.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-800 flex items-center justify-center flex-shrink-0",children:u.jsx(Io,{className:"w-4 h-4 text-white"})}),u.jsx("span",{className:"text-sm font-semibold text-gray-900",children:"Add new node..."})]})]})},G=()=>{if(l!=="output")return null;const I=n;return u.jsxs("div",{className:"px-3 pt-3 pb-20 flex flex-col gap-2",children:[P.length===0&&u.jsx(Nl,{query:v,message:"No matching node types found"}),P.map(({typeName:$,def:Z,inputIndex:Se,inputType:Q,inputName:Me})=>{const K=ws(String(Z.python_module??Z.category?.split("/")[0]??"Core"));return u.jsx(xp,{title:Ss(Z,$),subtitle:K||"Core",outputType:I.outputType,outputName:I.outputName,inputName:String(Me),titleClassName:"text-sm font-medium text-gray-900 truncate",onSelect:()=>Ke($,Se,Q)},$)})]})};return u.jsxs(Sx,{isOpen:o,onClose:s,title:se,searchQuery:v,onSearchQueryChange:k,searchPlaceholder:fe,onBack:w==="addNew"?()=>{S("pick"),k("")}:void 0,footer:u.jsx(xx,{zIndex:2201,actions:[{key:"cancel",label:"Cancel",onClick:s,variant:"secondary"},...l==="output"&&w==="pick"?[{key:"apply",label:"Apply",onClick:U,variant:"primary",disabled:!Ne}]:[]]}),children:[u.jsx("div",{className:"flex-1 overflow-auto bg-white",children:l==="input"?w==="pick"?M():re():w==="pick"?W():G()}),l==="output"&&D!=null&&u.jsx("div",{className:"fixed inset-0 z-[2250] bg-black/40 flex items-center justify-center p-4",onClick:ue,role:"dialog","aria-modal":"true",children:u.jsxs("div",{className:"w-full max-w-sm bg-white border border-gray-200 rounded-xl shadow-lg overflow-hidden",onClick:I=>I.stopPropagation(),children:[u.jsx("div",{className:"px-4 py-3 text-sm font-semibold text-gray-700 border-b border-gray-100",children:"Select compatible inputs"}),u.jsx("div",{className:"max-h-[45vh] overflow-y-auto",children:ke.find(I=>I.nodeId===D)?.inputs.map(I=>{const $=Fo(I.nodeId,I.inputIndex),Z=B.has($);return u.jsxs("button",{type:"button",className:`w-full flex items-center justify-between gap-3 text-left px-4 py-3 text-sm ${Z?"bg-blue-50":"hover:bg-gray-50"}`,onClick:()=>ye($),children:[u.jsxs("span",{className:"min-w-0",children:[u.jsx("span",{className:"block text-gray-900 truncate",children:I.inputName}),u.jsx("span",{className:"block text-xs text-gray-500 truncate",children:I.inputType})]}),u.jsx("span",{className:`w-5 h-5 rounded border flex items-center justify-center shrink-0 ${Z?"bg-blue-600 border-blue-600":"bg-white border-gray-300"}`,children:Z?u.jsx(zo,{className:"w-3 h-3 text-white"}):null})]},`input-picker-${$}`)})}),u.jsxs("div",{className:"px-3 py-3 border-t border-gray-100 flex justify-end gap-2",children:[u.jsx("button",{type:"button",className:"px-3 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-100",onClick:ue,children:"Cancel"}),u.jsx("button",{type:"button",className:"px-3 py-2 rounded-lg text-sm font-medium text-white bg-blue-600 hover:bg-blue-700",onClick:et,children:"Apply"})]})]})}),l==="output"&&T&&u.jsx(Qo,{onClose:()=>R(!1),title:"Overwrite existing connections?",description:"Some selected inputs are already connected. Continuing will disconnect their current source and reconnect to this output.",actions:[{label:"Cancel",onClick:()=>R(!1),className:"px-3 py-1.5 rounded-lg text-sm text-gray-700 border border-gray-300 hover:bg-gray-50"},{label:"Overwrite",onClick:()=>{R(!1),z()},className:"px-3 py-1.5 rounded-lg text-sm text-white bg-red-600 hover:bg-red-700"}]})]})}function ek(n,o,s,a){const l=n.nodes.find(y=>y.id===o);if(!l||l.type!=="Reroute")return a;let c=null;const d=[],h=new Set,p=l.inputs[0]?.link;if(p!=null){const y=n.links.find(x=>x[0]===p);if(y){const x=y[1],v=y[2],w=n.nodes.find(S=>S.id===x)?.outputs[v];c=w?.localized_name||w?.name||null}}for(const y of l.outputs){const x=y.links??[];for(const v of x){const k=n.links.find(R=>R[0]===v);if(!k)continue;const w=k[3],S=k[4],C=n.nodes.find(R=>R.id===w)?.inputs[S],T=C?.localized_name||C?.name||null;T&&!h.has(T)&&(h.add(T),d.push(T))}}const m=d.map((y,x)=>x<d.length-1?`${y}/`:y).join(`
`);return d.length>1?m:s==="input"?c||m||a:m||c||a}function tk({direction:n,hasConnection:o,isEmptyRequiredInput:s=!1,hideLabel:a,resolvedLabel:l,shouldWrapResolvedLabel:c,sizeClass:d,arrowClass:h,typeClass:p,buttonRef:m,connectionCount:y,onClick:x,onPointerDown:v,onPointerMove:k,onPointerUp:w}){const S=n==="input",j=S?!o&&!s:!1,C=!S&&!o,T=d.includes("w-7")?"w-3 h-3":"w-3.5 h-3.5";return u.jsxs(u.Fragment,{children:[S?null:!a&&u.jsx("span",{className:`text-sm text-gray-700 flex-1 min-w-0 ${c?"whitespace-pre-line break-words leading-tight text-right":"truncate"}`,children:l}),!S&&y>1&&u.jsx("span",{className:"bg-gray-200 text-gray-700 rounded-full px-2 py-0.5 text-xs font-medium flex-shrink-0",children:y}),u.jsx("button",{onClick:x,onPointerDown:v,onPointerMove:k,onPointerUp:w,onPointerCancel:w,disabled:j,ref:m,className:`
          flex items-center justify-center rounded-full font-medium box-border
          border-2
          ${d} flex-shrink-0
          transition-opacity
          ${p}
          ${S&&s?"opacity-100 cursor-pointer border-red-500":"border-transparent"}
          ${!S&&C?"border-dashed border-gray-400/70":""}
          ${j?"opacity-40 cursor-not-allowed":""}
          ${!j&&C?"opacity-50 cursor-pointer active:scale-95":""}
          ${!j&&!C?"opacity-100 cursor-pointer active:scale-95":""}
        `,children:S?u.jsxs(u.Fragment,{children:[o&&u.jsx("span",{className:h,children:""}),!o&&u.jsx(Io,{className:T})]}):o?u.jsx("span",{className:h,children:""}):u.jsx(Io,{className:T})}),!S&&a?null:S&&!a&&u.jsx("span",{className:`text-sm flex-1 min-w-0 ${c?"whitespace-pre-line break-words leading-tight":"truncate"} ${s?"text-red-600 font-medium":"text-gray-700"}`,children:l})]})}function nk(n){const o=String(n).split(",")[0].trim();return["IMAGE","LATENT","MODEL","CLIP","VAE","CONDITIONING","INT","FLOAT","STRING","BOOLEAN","MASK"].includes(o)?`type-${o}`:"type-default"}function Gy(n){return String(n).split(",").map(o=>o.trim().toUpperCase()).filter(Boolean)}const Py=b.memo(function({slot:o,nodeId:s,direction:a,slotIndex:l,compact:c=!1,hideLabel:d=!1,isRequired:h=!1}){const p=de(ye=>ye.workflow),m=de(ye=>ye.scrollToNode),y=de(ye=>ye.revealNodeWithParents),x=de(ye=>ye.nodeTypes),v=de(ye=>ye.hiddenItems),[k,w]=b.useState(!1),[S,j]=b.useState(!1),C=b.useRef(null),T=b.useRef(null),[R,D]=b.useState(null),L=b.useRef(null),B=b.useRef(null),A=b.useRef(null),F=b.useRef(!1),te=b.useMemo(()=>{const ye=o.localized_name||o.name;return p?ek(p,s,a,ye):ye},[p,a,o.localized_name,o.name,s]),ee=b.useMemo(()=>{if(!p)return[];const ye=[];if(a==="input"){if(o.link!=null){const oe=va(p,s,l);oe&&ye.push(oe.node)}}else{const et=Tl(p,s,l);for(const oe of et)ye.push(oe.node)}return ye},[p,s,a,o,l]),{effectiveNodes:ae,directNodes:ne,bypassedTargets:me}=b.useMemo(()=>{if(!p)return{effectiveNodes:[],directNodes:[],bypassedTargets:[]};if(Object.keys(v).length===0)return{effectiveNodes:ee,directNodes:ee,bypassedTargets:[]};const ye=new Map(p.nodes.map(G=>[G.id,G])),et=G=>!!(G.stableKey&&v[G.stableKey]),oe=new Set,z=G=>{if(oe.has(G))return[];oe.add(G);const I=ye.get(G);if(!I)return[];const $=[];return I.outputs?.forEach((Z,Se)=>{Tl(p,G,Se).forEach(Me=>{const K=Me.node;et(K)?$.push(...z(K.id)):$.push(K)})}),$},U=G=>{if(oe.has(G))return[];oe.add(G);const I=ye.get(G);if(!I)return[];const $=[];return I.inputs?.forEach((Z,Se)=>{if(Z.link===null)return;const Q=va(p,G,Se);Q&&(et(Q.node)?$.push(...U(Q.node.id)):$.push(Q.node))}),$},se=[],fe=[];ee.forEach(G=>{et(G)?a==="input"?fe.push(...U(G.id)):fe.push(...z(G.id)):se.push(G)});const M=new Set(se.map(G=>G.id));let W=(G=>{const I=[],$=new Set;return G.forEach(Z=>{M.has(Z.id)||$.has(Z.id)||($.add(Z.id),I.push(Z))}),I})(fe);if(a==="input"&&W.length>1){const G=new Set(Gy(o.type)),I=W.filter($=>$.outputs?.some(Z=>Gy(Z.type).some(Se=>G.has(Se))));I.length>0&&(W=I)}return{effectiveNodes:[...se,...W],directNodes:se,bypassedTargets:W}},[ee,p,a,o.type,v]),Le=ae.length,P=Le===1?ae[0].id:null,V=Le>0,H=a==="input"&&!V&&h,ce=b.useCallback(()=>{B.current!=null&&(window.clearTimeout(B.current),B.current=null)},[]),ke=b.useCallback(ye=>ye.stableKey??null,[]),Ne=()=>{if(F.current){F.current=!1;return}if(a==="output"&&!V){j(!0);return}if(H){j(!0);return}if(V){if(Le===1&&P!==null){const ye=ae[0],et=ye?ke(ye):null;et&&(y(et),m(et));return}w(ye=>!ye)}},O=b.useCallback(ye=>{(a!=="input"||V)&&(A.current={x:ye.clientX,y:ye.clientY},F.current=!1,B.current=window.setTimeout(()=>{B.current=null,F.current=!0,j(!0)},500))},[a,V]),_=b.useCallback(ye=>{if(!A.current)return;const et=ye.clientX-A.current.x,oe=ye.clientY-A.current.y;Math.hypot(et,oe)>8&&ce()},[ce]),q=b.useCallback(()=>{ce(),A.current=null},[ce]),je=ye=>et=>{et.stopPropagation();const oe=ae.find(U=>U.id===ye),z=oe?ke(oe):null;z&&(y(z),m(z)),w(!1)};b.useLayoutEffect(()=>{if(!k)return;const ye=()=>{const et=T.current;if(!et)return;const oe=et.getBoundingClientRect(),z=8;D({top:oe.bottom+6,...a==="input"?{left:Math.min(oe.left,window.innerWidth-z)}:{right:Math.max(z,window.innerWidth-oe.right)}})};return L.current=ye,ye(),()=>{}},[k,Le,a]),b.useEffect(()=>{if(!k)return;const ye=()=>L.current?.(),et=z=>{!C.current||!z.target||T.current?.contains(z.target)||C.current.contains(z.target)||w(!1)},oe=z=>{const U=z.target;C.current&&U&&C.current.contains(U)||w(!1)};return document.addEventListener("mousedown",et),document.addEventListener("scroll",oe,!0),window.addEventListener("resize",ye),()=>{document.removeEventListener("mousedown",et),document.removeEventListener("scroll",oe,!0),window.removeEventListener("resize",ye)}},[k]),b.useEffect(()=>()=>ce(),[ce]);const Ke=c?"w-7 h-7":"w-10 h-10",De=c?"text-sm":"text-base";if(!p)return null;const Fe=a==="input"&&V&&P!==null?P:null,ue=te.includes("/")||te.includes(`
`);return u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(tk,{direction:a,hasConnection:V,isEmptyRequiredInput:H,hideLabel:d,resolvedLabel:te,shouldWrapResolvedLabel:ue,sizeClass:Ke,arrowClass:De,typeClass:nk(o.type),buttonRef:T,connectionCount:Le,onClick:Ne,onPointerDown:O,onPointerMove:_,onPointerUp:q}),k&&R&&An.createPortal(u.jsx("div",{ref:C,className:"fixed z-[1000]",style:{top:R.top,right:R.right,left:R.left,maxWidth:"calc(100vw - 16px)"},children:u.jsx(Sr,{items:[...ne.map(ye=>{const oe=x?.[ye.type]?.display_name||ye.type;return{key:`direct-${ye.id}`,label:`${oe} #${ye.id}`,onClick:je(ye.id)}}),{type:"custom",key:"bypassed-label",hidden:!(ne.length>0&&me.length>0),render:u.jsx("div",{className:"px-3 py-1",children:u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("div",{className:"h-px flex-1 bg-gray-200"}),u.jsx("span",{className:"text-[10px] text-gray-400",children:"(via bypassed)"}),u.jsx("div",{className:"h-px flex-1 bg-gray-200"})]})})},...me.map(ye=>{const oe=x?.[ye.type]?.display_name||ye.type;return{key:`bypassed-${ye.id}`,label:`${oe} #${ye.id}`,onClick:je(ye.id)}})]})}),document.body),S&&(a==="input"?u.jsx(qy,{mode:"input",isOpen:S,onClose:()=>j(!1),nodeId:s,inputIndex:l,inputType:o.type,inputName:te,currentlyConnectedNodeId:Fe}):u.jsx(qy,{mode:"output",isOpen:S,onClose:()=>j(!1),nodeId:s,outputIndex:l,outputType:o.type,outputName:te}))]})});function ok({nodeId:n,nodeType:o,inputs:s,outputs:a,allInputs:l,allOutputs:c}){const d=de(m=>m.connectionButtonsVisible),h=de(m=>m.nodeTypes),p=b.useMemo(()=>{if(!o||!h)return new Set;const m=h[o];return m?.input?.required?new Set(Object.keys(m.input.required)):new Set},[o,h]);return!d||s.length===0&&a.length===0?null:u.jsxs("div",{className:"node-connections mb-3 grid grid-cols-2 gap-3",children:[u.jsx("div",{children:s.length>0&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"text-xs text-gray-500 mb-1.5 uppercase tracking-wide",children:"Inputs"}),u.jsx("div",{className:"flex flex-col gap-1.5",children:s.map((m,y)=>{const x=l.indexOf(m),v=x>=0?x:y;return u.jsx(Py,{slot:m,nodeId:n,direction:"input",slotIndex:v,isRequired:p.has(m.name)},`input-${v}`)})})]})}),u.jsx("div",{className:"flex flex-col items-end",children:a.length>0&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"text-xs text-gray-500 mb-1.5 uppercase tracking-wide text-right w-full",children:"Outputs"}),u.jsx("div",{className:"flex flex-col gap-1.5 w-full items-end",children:a.map((m,y)=>{const x=c.indexOf(m),v=x>=0?x:y;return u.jsx(Py,{slot:m,nodeId:n,direction:"output",slotIndex:v},`output-${v}`)})})]})})]})}function rk({nodeId:n,nodeType:o,inputs:s,outputs:a,allInputs:l,allOutputs:c}){return u.jsx(ok,{nodeId:n,nodeType:o,inputs:s,outputs:a,allInputs:l,allOutputs:c})}function sk({title:n,onClose:o,headerActions:s,isDark:a}){return u.jsx("div",{className:"bg-white p-4 border-b border-gray-200 dark:border-gray-800 shadow-sm relative z-50 min-h-0 overflow-y-auto shrink-0",style:{maxHeight:"var(--top-bar-offset)",...a?{backgroundColor:Dt.surface.darkPanel}:{}},children:u.jsxs("div",{className:"flex justify-between items-start mb-2",children:[u.jsx("span",{className:"font-semibold text-gray-700 dark:text-gray-200 truncate pr-4 pt-1 flex-1",children:n}),u.jsxs("div",{className:"flex items-center gap-2",children:[s,u.jsx(Rl,{onClick:o})]})]})})}function Jp({isOpen:n,title:o,onClose:s,children:a,headerActions:l}){const d=wa(h=>h.theme)==="dark";return b.useEffect(()=>{if(n){const h=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=h}}},[n]),n?An.createPortal(u.jsx("div",{className:"fixed inset-0 z-[2100] bg-gray-400/40 dark:bg-black/50 backdrop-blur-sm safe-area-top",onClick:s,children:u.jsxs("div",{className:"w-full h-full flex flex-col",style:{paddingTop:"env(--top-bar-offset, 0px)",paddingBottom:"var(--bottom-bar-offset, 0px)"},onClick:h=>h.stopPropagation(),children:[u.jsx(sk,{title:o,onClose:s,headerActions:l,isDark:d}),u.jsx("div",{className:"mt-2 px-4 pb-4",children:a}),u.jsx("div",{className:"flex-1",onClick:s})]})}),document.body):null}function ma({isPinned:n,onToggle:o}){if(!n||!o)return null;const s=a=>{a.preventDefault(),a.stopPropagation(),o()};return u.jsx("button",{type:"button",onClick:s,className:"flex items-center justify-center transition-colors text-fuchsia-500 hover:text-fuchsia-600","aria-label":"Remove pin",children:u.jsx(_l,{className:"w-5 h-5"})})}function Nx(){return typeof window>"u"?!1:window.matchMedia("(pointer: coarse)").matches}function zf({containerClass:n,name:o,value:s,options:a,onChange:l,disabled:c=!1,hideLabel:d=!1,hasPin:h,isPinned:p=!1,onTogglePin:m,hasError:y=!1,forceModalOpen:x=!1,onModalClose:v}){const k=ne=>{if(!Array.isArray(a))return a?.[ne]},w=k("multiline"),S=k("placeholder"),j=String(s??""),C=ne=>{l(ne.target.value)},[T,R]=b.useState(!1),D=x||T,B=wa(ne=>ne.theme)==="dark",A=Nx(),F=x||A,te=b.useRef(null),ee=b.useRef(null);b.useLayoutEffect(()=>{if(!w)return;const ne=te.current;ne&&(ne.style.height="0px",ne.style.height=`${ne.scrollHeight}px`)},[s,D,w]);const ae=()=>{R(!1),v?.()};return F?u.jsxs("div",{className:n,children:[w?u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"flex items-center justify-between mb-1 min-h-[18px]",children:[d?u.jsx("span",{className:"block text-sm font-medium text-gray-700"}):u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:o}),u.jsx(jl,{value:j,onChange:l,textareaRef:te,className:"opacity-100"})]}),u.jsxs("div",{className:`relative w-full p-3 comfy-input min-h-[100px] text-base group cursor-text ${c?"opacity-60 cursor-not-allowed":""} ${h?"pr-10":""} ${y?"border-red-700 ring-1 ring-red-700":""}`,onClick:()=>!c&&R(!0),children:[u.jsx("div",{className:"whitespace-pre-wrap break-words text-gray-900",style:B?{color:Dt.text.onDark}:void 0,children:j||u.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:S})}),h&&u.jsx("div",{className:"absolute right-2 top-2 pointer-events-none",children:u.jsx("div",{className:"pointer-events-auto",children:u.jsx(ma,{isPinned:p,onToggle:m})})})]})]}):u.jsxs(u.Fragment,{children:[!d&&u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:o}),u.jsxs("div",{className:`relative w-full p-3 comfy-input text-base min-h-[46px] flex items-center cursor-text ${c?"opacity-60 cursor-not-allowed":""} ${h?"pr-16":"pr-6"} ${y?"border-red-700 ring-1 ring-red-700":""}`,onClick:()=>!c&&R(!0),children:[u.jsx("div",{className:"truncate min-w-0 flex-1 text-gray-900",style:B?{color:Dt.text.onDark}:void 0,children:j||u.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:S})}),h&&u.jsx("div",{className:"absolute right-0 top-0 bottom-0 flex items-center pointer-events-none",children:u.jsx("div",{className:"pointer-events-auto px-3",children:u.jsx(ma,{isPinned:p,onToggle:m})})})]})]}),u.jsx(Jp,{title:o,isOpen:D,onClose:ae,headerActions:w?u.jsx(jl,{value:j,onChange:l,textareaRef:te,className:"mr-2"}):null,children:w?u.jsx("textarea",{ref:te,value:j,onChange:ne=>l(ne.target.value),placeholder:S,className:"w-full p-3 border border-gray-300 rounded-lg min-h-[150px] text-base resize-none outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500",autoFocus:!x,disabled:c}):u.jsx("input",{ref:ee,type:"text",value:j,onChange:ne=>l(ne.target.value),placeholder:S,className:"w-full p-3 border border-gray-300 rounded-lg text-base outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500",autoFocus:!x,disabled:c})})]}):w?u.jsxs("div",{className:`${n} group`,"data-textarea-root":"true",children:[u.jsxs("div",{className:"flex items-center justify-between mb-1 min-h-[18px]","data-textarea-header":"true",children:[d?u.jsx("span",{className:"block text-sm font-medium text-gray-700"}):u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:o}),u.jsx(jl,{value:j,onChange:l,textareaRef:te,className:"opacity-70 transition-opacity group-focus-within:opacity-100"})]}),u.jsxs("div",{className:"relative",children:[u.jsx("textarea",{ref:te,value:j,onChange:C,placeholder:S,className:`w-full p-3 comfy-input min-h-[100px] text-base resize-none overflow-hidden ${c?"opacity-60 cursor-not-allowed":""} ${h?"pr-10":""} ${y?"border-red-700 ring-1 ring-red-700":""}`,style:{overflowAnchor:"none"},disabled:c}),h&&u.jsx("div",{className:"absolute right-2 top-2",children:u.jsx(ma,{isPinned:p,onToggle:m})})]})]}):u.jsxs("div",{className:n,children:[!d&&u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:o}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"text",value:String(s??""),onChange:ne=>l(ne.target.value),placeholder:S,className:`w-full p-3 comfy-input text-base ${c?"opacity-60 cursor-not-allowed":""} ${h?"pr-16":""} ${y?"border-red-700 ring-1 ring-red-700":""}`,disabled:c}),h&&u.jsx("div",{className:"absolute right-0 top-0 bottom-0 flex items-center pointer-events-none",children:u.jsx("div",{className:"pointer-events-auto px-3",children:u.jsx(ma,{isPinned:p,onToggle:m})})})]})]})}function ha({containerClass:n,name:o,value:s,options:a,onChange:l,disabled:c,type:d,min:h,max:p,step:m,isInt:y,hasError:x=!1}){const[v,k]=b.useState(String(s||0)),w=y??(d?d.toUpperCase()==="INT":Number.isInteger(s)),S=m??a?.step??(w?1:.1),j=h??(a?.min!==void 0?a.min:-1/0),C=p??(a?.max!==void 0?a.max:1/0);b.useEffect(()=>{k(String(s))},[s]);const T=A=>{k(A.target.value)},R=()=>{let A=w?parseInt(v,10):parseFloat(v);isNaN(A)&&(A=s),A=Math.max(j,Math.min(C,A)),l(A),k(String(A))},D=A=>{const F=(w?parseInt(v,10):parseFloat(v))||0,te=Math.max(j,Math.min(C,F+A));l(te)},L=[`number-input-field-${o}`,"w-full p-3 comfy-input text-base text-gray-900",c?"opacity-60 cursor-not-allowed":"",x?"border-red-700 ring-1 ring-red-700":""].filter(Boolean).join(" "),B=["w-10 h-10 flex items-center justify-center rounded-full bg-gray-100 text-gray-700 flex-shrink-0",c?"opacity-60 cursor-not-allowed":"active:scale-95 transition-all"].filter(Boolean).join(" ");return u.jsxs("div",{className:`${n??""} number-control-${o}`,children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:o}),u.jsxs("div",{className:`number-stepper-container-${o} flex items-center gap-2`,children:[u.jsx("input",{className:L,type:"number",value:v,onChange:T,onBlur:R,disabled:c,"aria-label":d?`${o} ${d}`:o}),u.jsx("button",{type:"button",onClick:()=>D(-S),className:B,"aria-label":"Decrease value",disabled:c,children:u.jsx(DS,{className:"w-4 h-4"})}),u.jsx("button",{type:"button",onClick:()=>D(S),className:B,"aria-label":"Increase value",disabled:c,children:u.jsx(Io,{className:"w-4 h-4"})})]})]})}function Ms(n){"@babel/helpers - typeof";return Ms=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(o){return typeof o}:function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},Ms(n)}function ak(n,o){if(Ms(n)!="object"||!n)return n;var s=n[Symbol.toPrimitive];if(s!==void 0){var a=s.call(n,o);if(Ms(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(o==="string"?String:Number)(n)}function kx(n){var o=ak(n,"string");return Ms(o)=="symbol"?o:o+""}function kl(n,o,s){return(o=kx(o))in n?Object.defineProperty(n,o,{value:s,enumerable:!0,configurable:!0,writable:!0}):n[o]=s,n}function Yy(n,o){var s=Object.keys(n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(n);o&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(n,l).enumerable})),s.push.apply(s,a)}return s}function jt(n){for(var o=1;o<arguments.length;o++){var s=arguments[o]!=null?arguments[o]:{};o%2?Yy(Object(s),!0).forEach(function(a){kl(n,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(s)):Yy(Object(s)).forEach(function(a){Object.defineProperty(n,a,Object.getOwnPropertyDescriptor(s,a))})}return n}function lk(n){if(Array.isArray(n))return n}function ik(n,o){var s=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(s!=null){var a,l,c,d,h=[],p=!0,m=!1;try{if(c=(s=s.call(n)).next,o===0){if(Object(s)!==s)return;p=!1}else for(;!(p=(a=c.call(s)).done)&&(h.push(a.value),h.length!==o);p=!0);}catch(y){m=!0,l=y}finally{try{if(!p&&s.return!=null&&(d=s.return(),Object(d)!==d))return}finally{if(m)throw l}}return h}}function vp(n,o){(o==null||o>n.length)&&(o=n.length);for(var s=0,a=Array(o);s<o;s++)a[s]=n[s];return a}function Cx(n,o){if(n){if(typeof n=="string")return vp(n,o);var s={}.toString.call(n).slice(8,-1);return s==="Object"&&n.constructor&&(s=n.constructor.name),s==="Map"||s==="Set"?Array.from(n):s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?vp(n,o):void 0}}function uk(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wr(n,o){return lk(n)||ik(n,o)||Cx(n,o)||uk()}function ck(n,o){if(n==null)return{};var s={};for(var a in n)if({}.hasOwnProperty.call(n,a)){if(o.indexOf(a)!==-1)continue;s[a]=n[a]}return s}function Mr(n,o){if(n==null)return{};var s,a,l=ck(n,o);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(n);for(a=0;a<c.length;a++)s=c[a],o.indexOf(s)===-1&&{}.propertyIsEnumerable.call(n,s)&&(l[s]=n[s])}return l}var dk=["defaultInputValue","defaultMenuIsOpen","defaultValue","inputValue","menuIsOpen","onChange","onInputChange","onMenuClose","onMenuOpen","value"];function fk(n){var o=n.defaultInputValue,s=o===void 0?"":o,a=n.defaultMenuIsOpen,l=a===void 0?!1:a,c=n.defaultValue,d=c===void 0?null:c,h=n.inputValue,p=n.menuIsOpen,m=n.onChange,y=n.onInputChange,x=n.onMenuClose,v=n.onMenuOpen,k=n.value,w=Mr(n,dk),S=b.useState(h!==void 0?h:s),j=wr(S,2),C=j[0],T=j[1],R=b.useState(p!==void 0?p:l),D=wr(R,2),L=D[0],B=D[1],A=b.useState(k!==void 0?k:d),F=wr(A,2),te=F[0],ee=F[1],ae=b.useCallback(function(ce,ke){typeof m=="function"&&m(ce,ke),ee(ce)},[m]),ne=b.useCallback(function(ce,ke){var Ne;typeof y=="function"&&(Ne=y(ce,ke)),T(Ne!==void 0?Ne:ce)},[y]),me=b.useCallback(function(){typeof v=="function"&&v(),B(!0)},[v]),Le=b.useCallback(function(){typeof x=="function"&&x(),B(!1)},[x]),P=h!==void 0?h:C,V=p!==void 0?p:L,H=k!==void 0?k:te;return jt(jt({},w),{},{inputValue:P,menuIsOpen:V,onChange:ae,onInputChange:ne,onMenuClose:Le,onMenuOpen:me,value:H})}function Et(){return Et=Object.assign?Object.assign.bind():function(n){for(var o=1;o<arguments.length;o++){var s=arguments[o];for(var a in s)({}).hasOwnProperty.call(s,a)&&(n[a]=s[a])}return n},Et.apply(null,arguments)}function pk(n,o){if(!(n instanceof o))throw new TypeError("Cannot call a class as a function")}function Qy(n,o){for(var s=0;s<o.length;s++){var a=o[s];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(n,kx(a.key),a)}}function hk(n,o,s){return o&&Qy(n.prototype,o),s&&Qy(n,s),Object.defineProperty(n,"prototype",{writable:!1}),n}function wp(n,o){return wp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,a){return s.__proto__=a,s},wp(n,o)}function gk(n,o){if(typeof o!="function"&&o!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(o&&o.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),o&&wp(n,o)}function Zu(n){return Zu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(o){return o.__proto__||Object.getPrototypeOf(o)},Zu(n)}function jx(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(jx=function(){return!!n})()}function mk(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function yk(n,o){if(o&&(Ms(o)=="object"||typeof o=="function"))return o;if(o!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return mk(n)}function bk(n){var o=jx();return function(){var s,a=Zu(n);if(o){var l=Zu(this).constructor;s=Reflect.construct(a,arguments,l)}else s=a.apply(this,arguments);return yk(this,s)}}function xk(n){if(Array.isArray(n))return vp(n)}function vk(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function wk(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eh(n){return xk(n)||vk(n)||Cx(n)||wk()}function Sk(n){if(n.sheet)return n.sheet;for(var o=0;o<document.styleSheets.length;o++)if(document.styleSheets[o].ownerNode===n)return document.styleSheets[o]}function Nk(n){var o=document.createElement("style");return o.setAttribute("data-emotion",n.key),n.nonce!==void 0&&o.setAttribute("nonce",n.nonce),o.appendChild(document.createTextNode("")),o.setAttribute("data-s",""),o}var kk=(function(){function n(s){var a=this;this._insertTag=function(l){var c;a.tags.length===0?a.insertionPoint?c=a.insertionPoint.nextSibling:a.prepend?c=a.container.firstChild:c=a.before:c=a.tags[a.tags.length-1].nextSibling,a.container.insertBefore(l,c),a.tags.push(l)},this.isSpeedy=s.speedy===void 0?!0:s.speedy,this.tags=[],this.ctr=0,this.nonce=s.nonce,this.key=s.key,this.container=s.container,this.prepend=s.prepend,this.insertionPoint=s.insertionPoint,this.before=null}var o=n.prototype;return o.hydrate=function(a){a.forEach(this._insertTag)},o.insert=function(a){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(Nk(this));var l=this.tags[this.tags.length-1];if(this.isSpeedy){var c=Sk(l);try{c.insertRule(a,c.cssRules.length)}catch{}}else l.appendChild(document.createTextNode(a));this.ctr++},o.flush=function(){this.tags.forEach(function(a){var l;return(l=a.parentNode)==null?void 0:l.removeChild(a)}),this.tags=[],this.ctr=0},n})(),Fn="-ms-",Ju="-moz-",nn="-webkit-",Mx="comm",th="rule",nh="decl",Ck="@import",Ox="@keyframes",jk="@layer",Mk=Math.abs,pc=String.fromCharCode,Ok=Object.assign;function Tk(n,o){return Un(n,0)^45?(((o<<2^Un(n,0))<<2^Un(n,1))<<2^Un(n,2))<<2^Un(n,3):0}function Tx(n){return n.trim()}function Ek(n,o){return(n=o.exec(n))?n[0]:n}function on(n,o,s){return n.replace(o,s)}function Sp(n,o){return n.indexOf(o)}function Un(n,o){return n.charCodeAt(o)|0}function Dl(n,o,s){return n.slice(o,s)}function qo(n){return n.length}function oh(n){return n.length}function wu(n,o){return o.push(n),n}function Ik(n,o){return n.map(o).join("")}var hc=1,Sa=1,Ex=0,lo=0,_n=0,ka="";function gc(n,o,s,a,l,c,d){return{value:n,root:o,parent:s,type:a,props:l,children:c,line:hc,column:Sa,length:d,return:""}}function wl(n,o){return Ok(gc("",null,null,"",null,null,0),n,{length:-n.length},o)}function Lk(){return _n}function _k(){return _n=lo>0?Un(ka,--lo):0,Sa--,_n===10&&(Sa=1,hc--),_n}function xo(){return _n=lo<Ex?Un(ka,lo++):0,Sa++,_n===10&&(Sa=1,hc++),_n}function Xo(){return Un(ka,lo)}function _u(){return lo}function Yl(n,o){return Dl(ka,n,o)}function Bl(n){switch(n){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function Ix(n){return hc=Sa=1,Ex=qo(ka=n),lo=0,[]}function Lx(n){return ka="",n}function Au(n){return Tx(Yl(lo-1,Np(n===91?n+2:n===40?n+1:n)))}function Ak(n){for(;(_n=Xo())&&_n<33;)xo();return Bl(n)>2||Bl(_n)>3?"":" "}function Rk(n,o){for(;--o&&xo()&&!(_n<48||_n>102||_n>57&&_n<65||_n>70&&_n<97););return Yl(n,_u()+(o<6&&Xo()==32&&xo()==32))}function Np(n){for(;xo();)switch(_n){case n:return lo;case 34:case 39:n!==34&&n!==39&&Np(_n);break;case 40:n===41&&Np(n);break;case 92:xo();break}return lo}function Dk(n,o){for(;xo()&&n+_n!==57;)if(n+_n===84&&Xo()===47)break;return"/*"+Yl(o,lo-1)+"*"+pc(n===47?n:xo())}function Bk(n){for(;!Bl(Xo());)xo();return Yl(n,lo)}function zk(n){return Lx(Ru("",null,null,null,[""],n=Ix(n),0,[0],n))}function Ru(n,o,s,a,l,c,d,h,p){for(var m=0,y=0,x=d,v=0,k=0,w=0,S=1,j=1,C=1,T=0,R="",D=l,L=c,B=a,A=R;j;)switch(w=T,T=xo()){case 40:if(w!=108&&Un(A,x-1)==58){Sp(A+=on(Au(T),"&","&\f"),"&\f")!=-1&&(C=-1);break}case 34:case 39:case 91:A+=Au(T);break;case 9:case 10:case 13:case 32:A+=Ak(w);break;case 92:A+=Rk(_u()-1,7);continue;case 47:switch(Xo()){case 42:case 47:wu(Hk(Dk(xo(),_u()),o,s),p);break;default:A+="/"}break;case 123*S:h[m++]=qo(A)*C;case 125*S:case 59:case 0:switch(T){case 0:case 125:j=0;case 59+y:C==-1&&(A=on(A,/\f/g,"")),k>0&&qo(A)-x&&wu(k>32?Zy(A+";",a,s,x-1):Zy(on(A," ","")+";",a,s,x-2),p);break;case 59:A+=";";default:if(wu(B=Xy(A,o,s,m,y,l,h,R,D=[],L=[],x),c),T===123)if(y===0)Ru(A,o,B,B,D,c,x,h,L);else switch(v===99&&Un(A,3)===110?100:v){case 100:case 108:case 109:case 115:Ru(n,B,B,a&&wu(Xy(n,B,B,0,0,l,h,R,l,D=[],x),L),l,L,x,h,a?D:L);break;default:Ru(A,B,B,B,[""],L,0,h,L)}}m=y=k=0,S=C=1,R=A="",x=d;break;case 58:x=1+qo(A),k=w;default:if(S<1){if(T==123)--S;else if(T==125&&S++==0&&_k()==125)continue}switch(A+=pc(T),T*S){case 38:C=y>0?1:(A+="\f",-1);break;case 44:h[m++]=(qo(A)-1)*C,C=1;break;case 64:Xo()===45&&(A+=Au(xo())),v=Xo(),y=x=qo(R=A+=Bk(_u())),T++;break;case 45:w===45&&qo(A)==2&&(S=0)}}return c}function Xy(n,o,s,a,l,c,d,h,p,m,y){for(var x=l-1,v=l===0?c:[""],k=oh(v),w=0,S=0,j=0;w<a;++w)for(var C=0,T=Dl(n,x+1,x=Mk(S=d[w])),R=n;C<k;++C)(R=Tx(S>0?v[C]+" "+T:on(T,/&\f/g,v[C])))&&(p[j++]=R);return gc(n,o,s,l===0?th:h,p,m,y)}function Hk(n,o,s){return gc(n,o,s,Mx,pc(Lk()),Dl(n,2,-2),0)}function Zy(n,o,s,a){return gc(n,o,s,nh,Dl(n,0,a),Dl(n,a+1,-1),a)}function xa(n,o){for(var s="",a=oh(n),l=0;l<a;l++)s+=o(n[l],l,n,o)||"";return s}function $k(n,o,s,a){switch(n.type){case jk:if(n.children.length)break;case Ck:case nh:return n.return=n.return||n.value;case Mx:return"";case Ox:return n.return=n.value+"{"+xa(n.children,a)+"}";case th:n.value=n.props.join(",")}return qo(s=xa(n.children,a))?n.return=n.value+"{"+s+"}":""}function Kk(n){var o=oh(n);return function(s,a,l,c){for(var d="",h=0;h<o;h++)d+=n[h](s,a,l,c)||"";return d}}function Vk(n){return function(o){o.root||(o=o.return)&&n(o)}}function Uk(n){var o=Object.create(null);return function(s){return o[s]===void 0&&(o[s]=n(s)),o[s]}}var Wk=function(o,s,a){for(var l=0,c=0;l=c,c=Xo(),l===38&&c===12&&(s[a]=1),!Bl(c);)xo();return Yl(o,lo)},Fk=function(o,s){var a=-1,l=44;do switch(Bl(l)){case 0:l===38&&Xo()===12&&(s[a]=1),o[a]+=Wk(lo-1,s,a);break;case 2:o[a]+=Au(l);break;case 4:if(l===44){o[++a]=Xo()===58?"&\f":"",s[a]=o[a].length;break}default:o[a]+=pc(l)}while(l=xo());return o},qk=function(o,s){return Lx(Fk(Ix(o),s))},Jy=new WeakMap,Gk=function(o){if(!(o.type!=="rule"||!o.parent||o.length<1)){for(var s=o.value,a=o.parent,l=o.column===a.column&&o.line===a.line;a.type!=="rule";)if(a=a.parent,!a)return;if(!(o.props.length===1&&s.charCodeAt(0)!==58&&!Jy.get(a))&&!l){Jy.set(o,!0);for(var c=[],d=qk(s,c),h=a.props,p=0,m=0;p<d.length;p++)for(var y=0;y<h.length;y++,m++)o.props[m]=c[p]?d[p].replace(/&\f/g,h[y]):h[y]+" "+d[p]}}},Pk=function(o){if(o.type==="decl"){var s=o.value;s.charCodeAt(0)===108&&s.charCodeAt(2)===98&&(o.return="",o.value="")}};function _x(n,o){switch(Tk(n,o)){case 5103:return nn+"print-"+n+n;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return nn+n+n;case 5349:case 4246:case 4810:case 6968:case 2756:return nn+n+Ju+n+Fn+n+n;case 6828:case 4268:return nn+n+Fn+n+n;case 6165:return nn+n+Fn+"flex-"+n+n;case 5187:return nn+n+on(n,/(\w+).+(:[^]+)/,nn+"box-$1$2"+Fn+"flex-$1$2")+n;case 5443:return nn+n+Fn+"flex-item-"+on(n,/flex-|-self/,"")+n;case 4675:return nn+n+Fn+"flex-line-pack"+on(n,/align-content|flex-|-self/,"")+n;case 5548:return nn+n+Fn+on(n,"shrink","negative")+n;case 5292:return nn+n+Fn+on(n,"basis","preferred-size")+n;case 6060:return nn+"box-"+on(n,"-grow","")+nn+n+Fn+on(n,"grow","positive")+n;case 4554:return nn+on(n,/([^-])(transform)/g,"$1"+nn+"$2")+n;case 6187:return on(on(on(n,/(zoom-|grab)/,nn+"$1"),/(image-set)/,nn+"$1"),n,"")+n;case 5495:case 3959:return on(n,/(image-set\([^]*)/,nn+"$1$`$1");case 4968:return on(on(n,/(.+:)(flex-)?(.*)/,nn+"box-pack:$3"+Fn+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+nn+n+n;case 4095:case 3583:case 4068:case 2532:return on(n,/(.+)-inline(.+)/,nn+"$1$2")+n;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(qo(n)-1-o>6)switch(Un(n,o+1)){case 109:if(Un(n,o+4)!==45)break;case 102:return on(n,/(.+:)(.+)-([^]+)/,"$1"+nn+"$2-$3$1"+Ju+(Un(n,o+3)==108?"$3":"$2-$3"))+n;case 115:return~Sp(n,"stretch")?_x(on(n,"stretch","fill-available"),o)+n:n}break;case 4949:if(Un(n,o+1)!==115)break;case 6444:switch(Un(n,qo(n)-3-(~Sp(n,"!important")&&10))){case 107:return on(n,":",":"+nn)+n;case 101:return on(n,/(.+:)([^;!]+)(;|!.+)?/,"$1"+nn+(Un(n,14)===45?"inline-":"")+"box$3$1"+nn+"$2$3$1"+Fn+"$2box$3")+n}break;case 5936:switch(Un(n,o+11)){case 114:return nn+n+Fn+on(n,/[svh]\w+-[tblr]{2}/,"tb")+n;case 108:return nn+n+Fn+on(n,/[svh]\w+-[tblr]{2}/,"tb-rl")+n;case 45:return nn+n+Fn+on(n,/[svh]\w+-[tblr]{2}/,"lr")+n}return nn+n+Fn+n+n}return n}var Yk=function(o,s,a,l){if(o.length>-1&&!o.return)switch(o.type){case nh:o.return=_x(o.value,o.length);break;case Ox:return xa([wl(o,{value:on(o.value,"@","@"+nn)})],l);case th:if(o.length)return Ik(o.props,function(c){switch(Ek(c,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return xa([wl(o,{props:[on(c,/:(read-\w+)/,":"+Ju+"$1")]})],l);case"::placeholder":return xa([wl(o,{props:[on(c,/:(plac\w+)/,":"+nn+"input-$1")]}),wl(o,{props:[on(c,/:(plac\w+)/,":"+Ju+"$1")]}),wl(o,{props:[on(c,/:(plac\w+)/,Fn+"input-$1")]})],l)}return""})}},Qk=[Yk],Xk=function(o){var s=o.key;if(s==="css"){var a=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(a,function(S){var j=S.getAttribute("data-emotion");j.indexOf(" ")!==-1&&(document.head.appendChild(S),S.setAttribute("data-s",""))})}var l=o.stylisPlugins||Qk,c={},d,h=[];d=o.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+s+' "]'),function(S){for(var j=S.getAttribute("data-emotion").split(" "),C=1;C<j.length;C++)c[j[C]]=!0;h.push(S)});var p,m=[Gk,Pk];{var y,x=[$k,Vk(function(S){y.insert(S)})],v=Kk(m.concat(l,x)),k=function(j){return xa(zk(j),v)};p=function(j,C,T,R){y=T,k(j?j+"{"+C.styles+"}":C.styles),R&&(w.inserted[C.name]=!0)}}var w={key:s,sheet:new kk({key:s,container:d,nonce:o.nonce,speedy:o.speedy,prepend:o.prepend,insertionPoint:o.insertionPoint}),nonce:o.nonce,inserted:c,registered:{},insert:p};return w.sheet.hydrate(h),w},Hf={exports:{}},an={};var eb;function Zk(){if(eb)return an;eb=1;var n=typeof Symbol=="function"&&Symbol.for,o=n?Symbol.for("react.element"):60103,s=n?Symbol.for("react.portal"):60106,a=n?Symbol.for("react.fragment"):60107,l=n?Symbol.for("react.strict_mode"):60108,c=n?Symbol.for("react.profiler"):60114,d=n?Symbol.for("react.provider"):60109,h=n?Symbol.for("react.context"):60110,p=n?Symbol.for("react.async_mode"):60111,m=n?Symbol.for("react.concurrent_mode"):60111,y=n?Symbol.for("react.forward_ref"):60112,x=n?Symbol.for("react.suspense"):60113,v=n?Symbol.for("react.suspense_list"):60120,k=n?Symbol.for("react.memo"):60115,w=n?Symbol.for("react.lazy"):60116,S=n?Symbol.for("react.block"):60121,j=n?Symbol.for("react.fundamental"):60117,C=n?Symbol.for("react.responder"):60118,T=n?Symbol.for("react.scope"):60119;function R(L){if(typeof L=="object"&&L!==null){var B=L.$$typeof;switch(B){case o:switch(L=L.type,L){case p:case m:case a:case c:case l:case x:return L;default:switch(L=L&&L.$$typeof,L){case h:case y:case w:case k:case d:return L;default:return B}}case s:return B}}}function D(L){return R(L)===m}return an.AsyncMode=p,an.ConcurrentMode=m,an.ContextConsumer=h,an.ContextProvider=d,an.Element=o,an.ForwardRef=y,an.Fragment=a,an.Lazy=w,an.Memo=k,an.Portal=s,an.Profiler=c,an.StrictMode=l,an.Suspense=x,an.isAsyncMode=function(L){return D(L)||R(L)===p},an.isConcurrentMode=D,an.isContextConsumer=function(L){return R(L)===h},an.isContextProvider=function(L){return R(L)===d},an.isElement=function(L){return typeof L=="object"&&L!==null&&L.$$typeof===o},an.isForwardRef=function(L){return R(L)===y},an.isFragment=function(L){return R(L)===a},an.isLazy=function(L){return R(L)===w},an.isMemo=function(L){return R(L)===k},an.isPortal=function(L){return R(L)===s},an.isProfiler=function(L){return R(L)===c},an.isStrictMode=function(L){return R(L)===l},an.isSuspense=function(L){return R(L)===x},an.isValidElementType=function(L){return typeof L=="string"||typeof L=="function"||L===a||L===m||L===c||L===l||L===x||L===v||typeof L=="object"&&L!==null&&(L.$$typeof===w||L.$$typeof===k||L.$$typeof===d||L.$$typeof===h||L.$$typeof===y||L.$$typeof===j||L.$$typeof===C||L.$$typeof===T||L.$$typeof===S)},an.typeOf=R,an}var tb;function Jk(){return tb||(tb=1,Hf.exports=Zk()),Hf.exports}var $f,nb;function eC(){if(nb)return $f;nb=1;var n=Jk(),o={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},s={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},a={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},l={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},c={};c[n.ForwardRef]=a,c[n.Memo]=l;function d(w){return n.isMemo(w)?l:c[w.$$typeof]||o}var h=Object.defineProperty,p=Object.getOwnPropertyNames,m=Object.getOwnPropertySymbols,y=Object.getOwnPropertyDescriptor,x=Object.getPrototypeOf,v=Object.prototype;function k(w,S,j){if(typeof S!="string"){if(v){var C=x(S);C&&C!==v&&k(w,C,j)}var T=p(S);m&&(T=T.concat(m(S)));for(var R=d(w),D=d(S),L=0;L<T.length;++L){var B=T[L];if(!s[B]&&!(j&&j[B])&&!(D&&D[B])&&!(R&&R[B])){var A=y(S,B);try{h(w,B,A)}catch{}}}}return w}return $f=k,$f}eC();var tC=!0;function nC(n,o,s){var a="";return s.split(" ").forEach(function(l){n[l]!==void 0?o.push(n[l]+";"):l&&(a+=l+" ")}),a}var Ax=function(o,s,a){var l=o.key+"-"+s.name;(a===!1||tC===!1)&&o.registered[l]===void 0&&(o.registered[l]=s.styles)},oC=function(o,s,a){Ax(o,s,a);var l=o.key+"-"+s.name;if(o.inserted[s.name]===void 0){var c=s;do o.insert(s===c?"."+l:"",c,o.sheet,!0),c=c.next;while(c!==void 0)}};function rC(n){for(var o=0,s,a=0,l=n.length;l>=4;++a,l-=4)s=n.charCodeAt(a)&255|(n.charCodeAt(++a)&255)<<8|(n.charCodeAt(++a)&255)<<16|(n.charCodeAt(++a)&255)<<24,s=(s&65535)*1540483477+((s>>>16)*59797<<16),s^=s>>>24,o=(s&65535)*1540483477+((s>>>16)*59797<<16)^(o&65535)*1540483477+((o>>>16)*59797<<16);switch(l){case 3:o^=(n.charCodeAt(a+2)&255)<<16;case 2:o^=(n.charCodeAt(a+1)&255)<<8;case 1:o^=n.charCodeAt(a)&255,o=(o&65535)*1540483477+((o>>>16)*59797<<16)}return o^=o>>>13,o=(o&65535)*1540483477+((o>>>16)*59797<<16),((o^o>>>15)>>>0).toString(36)}var sC={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},aC=/[A-Z]|^ms/g,lC=/_EMO_([^_]+?)_([^]*?)_EMO_/g,Rx=function(o){return o.charCodeAt(1)===45},ob=function(o){return o!=null&&typeof o!="boolean"},Kf=Uk(function(n){return Rx(n)?n:n.replace(aC,"-$&").toLowerCase()}),rb=function(o,s){switch(o){case"animation":case"animationName":if(typeof s=="string")return s.replace(lC,function(a,l,c){return Go={name:l,styles:c,next:Go},l})}return sC[o]!==1&&!Rx(o)&&typeof s=="number"&&s!==0?s+"px":s};function zl(n,o,s){if(s==null)return"";var a=s;if(a.__emotion_styles!==void 0)return a;switch(typeof s){case"boolean":return"";case"object":{var l=s;if(l.anim===1)return Go={name:l.name,styles:l.styles,next:Go},l.name;var c=s;if(c.styles!==void 0){var d=c.next;if(d!==void 0)for(;d!==void 0;)Go={name:d.name,styles:d.styles,next:Go},d=d.next;var h=c.styles+";";return h}return iC(n,o,s)}case"function":{if(n!==void 0){var p=Go,m=s(n);return Go=p,zl(n,o,m)}break}}var y=s;return y}function iC(n,o,s){var a="";if(Array.isArray(s))for(var l=0;l<s.length;l++)a+=zl(n,o,s[l])+";";else for(var c in s){var d=s[c];if(typeof d!="object"){var h=d;ob(h)&&(a+=Kf(c)+":"+rb(c,h)+";")}else if(Array.isArray(d)&&typeof d[0]=="string"&&o==null)for(var p=0;p<d.length;p++)ob(d[p])&&(a+=Kf(c)+":"+rb(c,d[p])+";");else{var m=zl(n,o,d);switch(c){case"animation":case"animationName":{a+=Kf(c)+":"+m+";";break}default:a+=c+"{"+m+"}"}}}return a}var sb=/label:\s*([^\s;{]+)\s*(;|$)/g,Go;function Dx(n,o,s){if(n.length===1&&typeof n[0]=="object"&&n[0]!==null&&n[0].styles!==void 0)return n[0];var a=!0,l="";Go=void 0;var c=n[0];if(c==null||c.raw===void 0)a=!1,l+=zl(s,o,c);else{var d=c;l+=d[0]}for(var h=1;h<n.length;h++)if(l+=zl(s,o,n[h]),a){var p=c;l+=p[h]}sb.lastIndex=0;for(var m="",y;(y=sb.exec(l))!==null;)m+="-"+y[1];var x=rC(l)+m;return{name:x,styles:l,next:Go}}var uC=function(o){return o()},cC=Q0.useInsertionEffect?Q0.useInsertionEffect:!1,dC=cC||uC,Bx=b.createContext(typeof HTMLElement<"u"?Xk({key:"css"}):null);Bx.Provider;var fC=function(o){return b.forwardRef(function(s,a){var l=b.useContext(Bx);return o(s,l,a)})},pC=b.createContext({}),rh={}.hasOwnProperty,kp="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",hC=function(o,s){var a={};for(var l in s)rh.call(s,l)&&(a[l]=s[l]);return a[kp]=o,a},gC=function(o){var s=o.cache,a=o.serialized,l=o.isStringTag;return Ax(s,a,l),dC(function(){return oC(s,a,l)}),null},mC=fC(function(n,o,s){var a=n.css;typeof a=="string"&&o.registered[a]!==void 0&&(a=o.registered[a]);var l=n[kp],c=[a],d="";typeof n.className=="string"?d=nC(o.registered,c,n.className):n.className!=null&&(d=n.className+" ");var h=Dx(c,void 0,b.useContext(pC));d+=o.key+"-"+h.name;var p={};for(var m in n)rh.call(n,m)&&m!=="css"&&m!==kp&&(p[m]=n[m]);return p.className=d,s&&(p.ref=s),b.createElement(b.Fragment,null,b.createElement(gC,{cache:o,serialized:h,isStringTag:typeof l=="string"}),b.createElement(l,p))}),yC=mC,Nt=function(o,s){var a=arguments;if(s==null||!rh.call(s,"css"))return b.createElement.apply(void 0,a);var l=a.length,c=new Array(l);c[0]=yC,c[1]=hC(o,s);for(var d=2;d<l;d++)c[d]=a[d];return b.createElement.apply(null,c)};(function(n){var o;o||(o=n.JSX||(n.JSX={}))})(Nt||(Nt={}));function sh(){for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return Dx(o)}function bC(){var n=sh.apply(void 0,arguments),o="animation-"+n.name;return{name:o,styles:"@keyframes "+o+"{"+n.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}function xC(n,o){return o||(o=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(o)}}))}const vC=Math.min,wC=Math.max,ec=Math.round,Su=Math.floor,tc=n=>({x:n,y:n});function SC(n){const{x:o,y:s,width:a,height:l}=n;return{width:a,height:l,top:s,left:o,right:o+a,bottom:s+l,x:o,y:s}}function mc(){return typeof window<"u"}function zx(n){return $x(n)?(n.nodeName||"").toLowerCase():"#document"}function Nr(n){var o;return(n==null||(o=n.ownerDocument)==null?void 0:o.defaultView)||window}function Hx(n){var o;return(o=($x(n)?n.ownerDocument:n.document)||window.document)==null?void 0:o.documentElement}function $x(n){return mc()?n instanceof Node||n instanceof Nr(n).Node:!1}function NC(n){return mc()?n instanceof Element||n instanceof Nr(n).Element:!1}function ah(n){return mc()?n instanceof HTMLElement||n instanceof Nr(n).HTMLElement:!1}function ab(n){return!mc()||typeof ShadowRoot>"u"?!1:n instanceof ShadowRoot||n instanceof Nr(n).ShadowRoot}const kC=new Set(["inline","contents"]);function Kx(n){const{overflow:o,overflowX:s,overflowY:a,display:l}=lh(n);return/auto|scroll|overlay|hidden|clip/.test(o+a+s)&&!kC.has(l)}function CC(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const jC=new Set(["html","body","#document"]);function MC(n){return jC.has(zx(n))}function lh(n){return Nr(n).getComputedStyle(n)}function OC(n){if(zx(n)==="html")return n;const o=n.assignedSlot||n.parentNode||ab(n)&&n.host||Hx(n);return ab(o)?o.host:o}function Vx(n){const o=OC(n);return MC(o)?n.ownerDocument?n.ownerDocument.body:n.body:ah(o)&&Kx(o)?o:Vx(o)}function nc(n,o,s){var a;o===void 0&&(o=[]),s===void 0&&(s=!0);const l=Vx(n),c=l===((a=n.ownerDocument)==null?void 0:a.body),d=Nr(l);if(c){const h=Cp(d);return o.concat(d,d.visualViewport||[],Kx(l)?l:[],h&&s?nc(h):[])}return o.concat(l,nc(l,[],s))}function Cp(n){return n.parent&&Object.getPrototypeOf(n.parent)?n.frameElement:null}function TC(n){const o=lh(n);let s=parseFloat(o.width)||0,a=parseFloat(o.height)||0;const l=ah(n),c=l?n.offsetWidth:s,d=l?n.offsetHeight:a,h=ec(s)!==c||ec(a)!==d;return h&&(s=c,a=d),{width:s,height:a,$:h}}function ih(n){return NC(n)?n:n.contextElement}function lb(n){const o=ih(n);if(!ah(o))return tc(1);const s=o.getBoundingClientRect(),{width:a,height:l,$:c}=TC(o);let d=(c?ec(s.width):s.width)/a,h=(c?ec(s.height):s.height)/l;return(!d||!Number.isFinite(d))&&(d=1),(!h||!Number.isFinite(h))&&(h=1),{x:d,y:h}}const EC=tc(0);function IC(n){const o=Nr(n);return!CC()||!o.visualViewport?EC:{x:o.visualViewport.offsetLeft,y:o.visualViewport.offsetTop}}function LC(n,o,s){return!1}function ib(n,o,s,a){o===void 0&&(o=!1);const l=n.getBoundingClientRect(),c=ih(n);let d=tc(1);o&&(d=lb(n));const h=LC()?IC(c):tc(0);let p=(l.left+h.x)/d.x,m=(l.top+h.y)/d.y,y=l.width/d.x,x=l.height/d.y;if(c){const v=Nr(c),k=a;let w=v,S=Cp(w);for(;S&&a&&k!==w;){const j=lb(S),C=S.getBoundingClientRect(),T=lh(S),R=C.left+(S.clientLeft+parseFloat(T.paddingLeft))*j.x,D=C.top+(S.clientTop+parseFloat(T.paddingTop))*j.y;p*=j.x,m*=j.y,y*=j.x,x*=j.y,p+=R,m+=D,w=Nr(S),S=Cp(w)}}return SC({width:y,height:x,x:p,y:m})}function Ux(n,o){return n.x===o.x&&n.y===o.y&&n.width===o.width&&n.height===o.height}function _C(n,o){let s=null,a;const l=Hx(n);function c(){var h;clearTimeout(a),(h=s)==null||h.disconnect(),s=null}function d(h,p){h===void 0&&(h=!1),p===void 0&&(p=1),c();const m=n.getBoundingClientRect(),{left:y,top:x,width:v,height:k}=m;if(h||o(),!v||!k)return;const w=Su(x),S=Su(l.clientWidth-(y+v)),j=Su(l.clientHeight-(x+k)),C=Su(y),R={rootMargin:-w+"px "+-S+"px "+-j+"px "+-C+"px",threshold:wC(0,vC(1,p))||1};let D=!0;function L(B){const A=B[0].intersectionRatio;if(A!==p){if(!D)return d();A?d(!1,A):a=setTimeout(()=>{d(!1,1e-7)},1e3)}A===1&&!Ux(m,n.getBoundingClientRect())&&d(),D=!1}try{s=new IntersectionObserver(L,{...R,root:l.ownerDocument})}catch{s=new IntersectionObserver(L,R)}s.observe(n)}return d(!0),c}function AC(n,o,s,a){a===void 0&&(a={});const{ancestorScroll:l=!0,ancestorResize:c=!0,elementResize:d=typeof ResizeObserver=="function",layoutShift:h=typeof IntersectionObserver=="function",animationFrame:p=!1}=a,m=ih(n),y=l||c?[...m?nc(m):[],...nc(o)]:[];y.forEach(C=>{l&&C.addEventListener("scroll",s,{passive:!0}),c&&C.addEventListener("resize",s)});const x=m&&h?_C(m,s):null;let v=-1,k=null;d&&(k=new ResizeObserver(C=>{let[T]=C;T&&T.target===m&&k&&(k.unobserve(o),cancelAnimationFrame(v),v=requestAnimationFrame(()=>{var R;(R=k)==null||R.observe(o)})),s()}),m&&!p&&k.observe(m),k.observe(o));let w,S=p?ib(n):null;p&&j();function j(){const C=ib(n);S&&!Ux(S,C)&&s(),S=C,w=requestAnimationFrame(j)}return s(),()=>{var C;y.forEach(T=>{l&&T.removeEventListener("scroll",s),c&&T.removeEventListener("resize",s)}),x?.(),(C=k)==null||C.disconnect(),k=null,p&&cancelAnimationFrame(w)}}var jp=b.useLayoutEffect,RC=["className","clearValue","cx","getStyles","getClassNames","getValue","hasValue","isMulti","isRtl","options","selectOption","selectProps","setValue","theme"],oc=function(){};function DC(n,o){return o?o[0]==="-"?n+o:n+"__"+o:n}function BC(n,o){for(var s=arguments.length,a=new Array(s>2?s-2:0),l=2;l<s;l++)a[l-2]=arguments[l];var c=[].concat(a);if(o&&n)for(var d in o)o.hasOwnProperty(d)&&o[d]&&c.push("".concat(DC(n,d)));return c.filter(function(h){return h}).map(function(h){return String(h).trim()}).join(" ")}var ub=function(o){return qC(o)?o.filter(Boolean):Ms(o)==="object"&&o!==null?[o]:[]},Wx=function(o){o.className,o.clearValue,o.cx,o.getStyles,o.getClassNames,o.getValue,o.hasValue,o.isMulti,o.isRtl,o.options,o.selectOption,o.selectProps,o.setValue,o.theme;var s=Mr(o,RC);return jt({},s)},Cn=function(o,s,a){var l=o.cx,c=o.getStyles,d=o.getClassNames,h=o.className;return{css:c(s,o),className:l(a??{},d(s,o),h)}};function yc(n){return[document.documentElement,document.body,window].indexOf(n)>-1}function zC(n){return yc(n)?window.innerHeight:n.clientHeight}function Fx(n){return yc(n)?window.pageYOffset:n.scrollTop}function rc(n,o){if(yc(n)){window.scrollTo(0,o);return}n.scrollTop=o}function HC(n){var o=getComputedStyle(n),s=o.position==="absolute",a=/(auto|scroll)/;if(o.position==="fixed")return document.documentElement;for(var l=n;l=l.parentElement;)if(o=getComputedStyle(l),!(s&&o.position==="static")&&a.test(o.overflow+o.overflowY+o.overflowX))return l;return document.documentElement}function $C(n,o,s,a){return s*((n=n/a-1)*n*n+1)+o}function Nu(n,o){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:200,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:oc,l=Fx(n),c=o-l,d=10,h=0;function p(){h+=d;var m=$C(h,l,c,s);rc(n,m),h<s?window.requestAnimationFrame(p):a(n)}p()}function cb(n,o){var s=n.getBoundingClientRect(),a=o.getBoundingClientRect(),l=o.offsetHeight/3;a.bottom+l>s.bottom?rc(n,Math.min(o.offsetTop+o.clientHeight-n.offsetHeight+l,n.scrollHeight)):a.top-l<s.top&&rc(n,Math.max(o.offsetTop-l,0))}function KC(n){var o=n.getBoundingClientRect();return{bottom:o.bottom,height:o.height,left:o.left,right:o.right,top:o.top,width:o.width}}function db(){try{return document.createEvent("TouchEvent"),!0}catch{return!1}}function VC(){try{return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}catch{return!1}}var qx=!1,UC={get passive(){return qx=!0}},ku=typeof window<"u"?window:{};ku.addEventListener&&ku.removeEventListener&&(ku.addEventListener("p",oc,UC),ku.removeEventListener("p",oc,!1));var WC=qx;function FC(n){return n!=null}function qC(n){return Array.isArray(n)}function Cu(n,o,s){return n?o:s}var GC=function(o){for(var s=arguments.length,a=new Array(s>1?s-1:0),l=1;l<s;l++)a[l-1]=arguments[l];var c=Object.entries(o).filter(function(d){var h=wr(d,1),p=h[0];return!a.includes(p)});return c.reduce(function(d,h){var p=wr(h,2),m=p[0],y=p[1];return d[m]=y,d},{})},PC=["children","innerProps"],YC=["children","innerProps"];function QC(n){var o=n.maxHeight,s=n.menuEl,a=n.minHeight,l=n.placement,c=n.shouldScroll,d=n.isFixedPosition,h=n.controlHeight,p=HC(s),m={placement:"bottom",maxHeight:o};if(!s||!s.offsetParent)return m;var y=p.getBoundingClientRect(),x=y.height,v=s.getBoundingClientRect(),k=v.bottom,w=v.height,S=v.top,j=s.offsetParent.getBoundingClientRect(),C=j.top,T=d?window.innerHeight:zC(p),R=Fx(p),D=parseInt(getComputedStyle(s).marginBottom,10),L=parseInt(getComputedStyle(s).marginTop,10),B=C-L,A=T-S,F=B+R,te=x-R-S,ee=k-T+R+D,ae=R+S-L,ne=160;switch(l){case"auto":case"bottom":if(A>=w)return{placement:"bottom",maxHeight:o};if(te>=w&&!d)return c&&Nu(p,ee,ne),{placement:"bottom",maxHeight:o};if(!d&&te>=a||d&&A>=a){c&&Nu(p,ee,ne);var me=d?A-D:te-D;return{placement:"bottom",maxHeight:me}}if(l==="auto"||d){var Le=o,P=d?B:F;return P>=a&&(Le=Math.min(P-D-h,o)),{placement:"top",maxHeight:Le}}if(l==="bottom")return c&&rc(p,ee),{placement:"bottom",maxHeight:o};break;case"top":if(B>=w)return{placement:"top",maxHeight:o};if(F>=w&&!d)return c&&Nu(p,ae,ne),{placement:"top",maxHeight:o};if(!d&&F>=a||d&&B>=a){var V=o;return(!d&&F>=a||d&&B>=a)&&(V=d?B-L:F-L),c&&Nu(p,ae,ne),{placement:"top",maxHeight:V}}return{placement:"bottom",maxHeight:o};default:throw new Error('Invalid placement provided "'.concat(l,'".'))}return m}function XC(n){var o={bottom:"top",top:"bottom"};return n?o[n]:"bottom"}var Gx=function(o){return o==="auto"?"bottom":o},ZC=function(o,s){var a,l=o.placement,c=o.theme,d=c.borderRadius,h=c.spacing,p=c.colors;return jt((a={label:"menu"},kl(a,XC(l),"100%"),kl(a,"position","absolute"),kl(a,"width","100%"),kl(a,"zIndex",1),a),s?{}:{backgroundColor:p.neutral0,borderRadius:d,boxShadow:"0 0 0 1px hsla(0, 0%, 0%, 0.1), 0 4px 11px hsla(0, 0%, 0%, 0.1)",marginBottom:h.menuGutter,marginTop:h.menuGutter})},Px=b.createContext(null),JC=function(o){var s=o.children,a=o.minMenuHeight,l=o.maxMenuHeight,c=o.menuPlacement,d=o.menuPosition,h=o.menuShouldScrollIntoView,p=o.theme,m=b.useContext(Px)||{},y=m.setPortalPlacement,x=b.useRef(null),v=b.useState(l),k=wr(v,2),w=k[0],S=k[1],j=b.useState(null),C=wr(j,2),T=C[0],R=C[1],D=p.spacing.controlHeight;return jp(function(){var L=x.current;if(L){var B=d==="fixed",A=h&&!B,F=QC({maxHeight:l,menuEl:L,minHeight:a,placement:c,shouldScroll:A,isFixedPosition:B,controlHeight:D});S(F.maxHeight),R(F.placement),y?.(F.placement)}},[l,c,d,h,a,y,D]),s({ref:x,placerProps:jt(jt({},o),{},{placement:T||Gx(c),maxHeight:w})})},e3=function(o){var s=o.children,a=o.innerRef,l=o.innerProps;return Nt("div",Et({},Cn(o,"menu",{menu:!0}),{ref:a},l),s)},t3=e3,n3=function(o,s){var a=o.maxHeight,l=o.theme.spacing.baseUnit;return jt({maxHeight:a,overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},s?{}:{paddingBottom:l,paddingTop:l})},o3=function(o){var s=o.children,a=o.innerProps,l=o.innerRef,c=o.isMulti;return Nt("div",Et({},Cn(o,"menuList",{"menu-list":!0,"menu-list--is-multi":c}),{ref:l},a),s)},Yx=function(o,s){var a=o.theme,l=a.spacing.baseUnit,c=a.colors;return jt({textAlign:"center"},s?{}:{color:c.neutral40,padding:"".concat(l*2,"px ").concat(l*3,"px")})},r3=Yx,s3=Yx,a3=function(o){var s=o.children,a=s===void 0?"No options":s,l=o.innerProps,c=Mr(o,PC);return Nt("div",Et({},Cn(jt(jt({},c),{},{children:a,innerProps:l}),"noOptionsMessage",{"menu-notice":!0,"menu-notice--no-options":!0}),l),a)},l3=function(o){var s=o.children,a=s===void 0?"Loading...":s,l=o.innerProps,c=Mr(o,YC);return Nt("div",Et({},Cn(jt(jt({},c),{},{children:a,innerProps:l}),"loadingMessage",{"menu-notice":!0,"menu-notice--loading":!0}),l),a)},i3=function(o){var s=o.rect,a=o.offset,l=o.position;return{left:s.left,position:l,top:a,width:s.width,zIndex:1}},u3=function(o){var s=o.appendTo,a=o.children,l=o.controlElement,c=o.innerProps,d=o.menuPlacement,h=o.menuPosition,p=b.useRef(null),m=b.useRef(null),y=b.useState(Gx(d)),x=wr(y,2),v=x[0],k=x[1],w=b.useMemo(function(){return{setPortalPlacement:k}},[]),S=b.useState(null),j=wr(S,2),C=j[0],T=j[1],R=b.useCallback(function(){if(l){var A=KC(l),F=h==="fixed"?0:window.pageYOffset,te=A[v]+F;(te!==C?.offset||A.left!==C?.rect.left||A.width!==C?.rect.width)&&T({offset:te,rect:A})}},[l,h,v,C?.offset,C?.rect.left,C?.rect.width]);jp(function(){R()},[R]);var D=b.useCallback(function(){typeof m.current=="function"&&(m.current(),m.current=null),l&&p.current&&(m.current=AC(l,p.current,R,{elementResize:"ResizeObserver"in window}))},[l,R]);jp(function(){D()},[D]);var L=b.useCallback(function(A){p.current=A,D()},[D]);if(!s&&h!=="fixed"||!C)return null;var B=Nt("div",Et({ref:L},Cn(jt(jt({},o),{},{offset:C.offset,position:h,rect:C.rect}),"menuPortal",{"menu-portal":!0}),c),a);return Nt(Px.Provider,{value:w},s?An.createPortal(B,s):B)},c3=function(o){var s=o.isDisabled,a=o.isRtl;return{label:"container",direction:a?"rtl":void 0,pointerEvents:s?"none":void 0,position:"relative"}},d3=function(o){var s=o.children,a=o.innerProps,l=o.isDisabled,c=o.isRtl;return Nt("div",Et({},Cn(o,"container",{"--is-disabled":l,"--is-rtl":c}),a),s)},f3=function(o,s){var a=o.theme.spacing,l=o.isMulti,c=o.hasValue,d=o.selectProps.controlShouldRenderValue;return jt({alignItems:"center",display:l&&c&&d?"flex":"grid",flex:1,flexWrap:"wrap",WebkitOverflowScrolling:"touch",position:"relative",overflow:"hidden"},s?{}:{padding:"".concat(a.baseUnit/2,"px ").concat(a.baseUnit*2,"px")})},p3=function(o){var s=o.children,a=o.innerProps,l=o.isMulti,c=o.hasValue;return Nt("div",Et({},Cn(o,"valueContainer",{"value-container":!0,"value-container--is-multi":l,"value-container--has-value":c}),a),s)},h3=function(){return{alignItems:"center",alignSelf:"stretch",display:"flex",flexShrink:0}},g3=function(o){var s=o.children,a=o.innerProps;return Nt("div",Et({},Cn(o,"indicatorsContainer",{indicators:!0}),a),s)},fb,m3=["size"],y3=["innerProps","isRtl","size"],b3={name:"8mmkcg",styles:"display:inline-block;fill:currentColor;line-height:1;stroke:currentColor;stroke-width:0"},Qx=function(o){var s=o.size,a=Mr(o,m3);return Nt("svg",Et({height:s,width:s,viewBox:"0 0 20 20","aria-hidden":"true",focusable:"false",css:b3},a))},uh=function(o){return Nt(Qx,Et({size:20},o),Nt("path",{d:"M14.348 14.849c-0.469 0.469-1.229 0.469-1.697 0l-2.651-3.030-2.651 3.029c-0.469 0.469-1.229 0.469-1.697 0-0.469-0.469-0.469-1.229 0-1.697l2.758-3.15-2.759-3.152c-0.469-0.469-0.469-1.228 0-1.697s1.228-0.469 1.697 0l2.652 3.031 2.651-3.031c0.469-0.469 1.228-0.469 1.697 0s0.469 1.229 0 1.697l-2.758 3.152 2.758 3.15c0.469 0.469 0.469 1.229 0 1.698z"}))},Xx=function(o){return Nt(Qx,Et({size:20},o),Nt("path",{d:"M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"}))},Zx=function(o,s){var a=o.isFocused,l=o.theme,c=l.spacing.baseUnit,d=l.colors;return jt({label:"indicatorContainer",display:"flex",transition:"color 150ms"},s?{}:{color:a?d.neutral60:d.neutral20,padding:c*2,":hover":{color:a?d.neutral80:d.neutral40}})},x3=Zx,v3=function(o){var s=o.children,a=o.innerProps;return Nt("div",Et({},Cn(o,"dropdownIndicator",{indicator:!0,"dropdown-indicator":!0}),a),s||Nt(Xx,null))},w3=Zx,S3=function(o){var s=o.children,a=o.innerProps;return Nt("div",Et({},Cn(o,"clearIndicator",{indicator:!0,"clear-indicator":!0}),a),s||Nt(uh,null))},N3=function(o,s){var a=o.isDisabled,l=o.theme,c=l.spacing.baseUnit,d=l.colors;return jt({label:"indicatorSeparator",alignSelf:"stretch",width:1},s?{}:{backgroundColor:a?d.neutral10:d.neutral20,marginBottom:c*2,marginTop:c*2})},k3=function(o){var s=o.innerProps;return Nt("span",Et({},s,Cn(o,"indicatorSeparator",{"indicator-separator":!0})))},C3=bC(fb||(fb=xC([`
  0%, 80%, 100% { opacity: 0; }
  40% { opacity: 1; }
`]))),j3=function(o,s){var a=o.isFocused,l=o.size,c=o.theme,d=c.colors,h=c.spacing.baseUnit;return jt({label:"loadingIndicator",display:"flex",transition:"color 150ms",alignSelf:"center",fontSize:l,lineHeight:1,marginRight:l,textAlign:"center",verticalAlign:"middle"},s?{}:{color:a?d.neutral60:d.neutral20,padding:h*2})},Vf=function(o){var s=o.delay,a=o.offset;return Nt("span",{css:sh({animation:"".concat(C3," 1s ease-in-out ").concat(s,"ms infinite;"),backgroundColor:"currentColor",borderRadius:"1em",display:"inline-block",marginLeft:a?"1em":void 0,height:"1em",verticalAlign:"top",width:"1em"},"","")})},M3=function(o){var s=o.innerProps,a=o.isRtl,l=o.size,c=l===void 0?4:l,d=Mr(o,y3);return Nt("div",Et({},Cn(jt(jt({},d),{},{innerProps:s,isRtl:a,size:c}),"loadingIndicator",{indicator:!0,"loading-indicator":!0}),s),Nt(Vf,{delay:0,offset:a}),Nt(Vf,{delay:160,offset:!0}),Nt(Vf,{delay:320,offset:!a}))},O3=function(o,s){var a=o.isDisabled,l=o.isFocused,c=o.theme,d=c.colors,h=c.borderRadius,p=c.spacing;return jt({label:"control",alignItems:"center",cursor:"default",display:"flex",flexWrap:"wrap",justifyContent:"space-between",minHeight:p.controlHeight,outline:"0 !important",position:"relative",transition:"all 100ms"},s?{}:{backgroundColor:a?d.neutral5:d.neutral0,borderColor:a?d.neutral10:l?d.primary:d.neutral20,borderRadius:h,borderStyle:"solid",borderWidth:1,boxShadow:l?"0 0 0 1px ".concat(d.primary):void 0,"&:hover":{borderColor:l?d.primary:d.neutral30}})},T3=function(o){var s=o.children,a=o.isDisabled,l=o.isFocused,c=o.innerRef,d=o.innerProps,h=o.menuIsOpen;return Nt("div",Et({ref:c},Cn(o,"control",{control:!0,"control--is-disabled":a,"control--is-focused":l,"control--menu-is-open":h}),d,{"aria-disabled":a||void 0}),s)},E3=T3,I3=["data"],L3=function(o,s){var a=o.theme.spacing;return s?{}:{paddingBottom:a.baseUnit*2,paddingTop:a.baseUnit*2}},_3=function(o){var s=o.children,a=o.cx,l=o.getStyles,c=o.getClassNames,d=o.Heading,h=o.headingProps,p=o.innerProps,m=o.label,y=o.theme,x=o.selectProps;return Nt("div",Et({},Cn(o,"group",{group:!0}),p),Nt(d,Et({},h,{selectProps:x,theme:y,getStyles:l,getClassNames:c,cx:a}),m),Nt("div",null,s))},A3=function(o,s){var a=o.theme,l=a.colors,c=a.spacing;return jt({label:"group",cursor:"default",display:"block"},s?{}:{color:l.neutral40,fontSize:"75%",fontWeight:500,marginBottom:"0.25em",paddingLeft:c.baseUnit*3,paddingRight:c.baseUnit*3,textTransform:"uppercase"})},R3=function(o){var s=Wx(o);s.data;var a=Mr(s,I3);return Nt("div",Et({},Cn(o,"groupHeading",{"group-heading":!0}),a))},D3=_3,B3=["innerRef","isDisabled","isHidden","inputClassName"],z3=function(o,s){var a=o.isDisabled,l=o.value,c=o.theme,d=c.spacing,h=c.colors;return jt(jt({visibility:a?"hidden":"visible",transform:l?"translateZ(0)":""},H3),s?{}:{margin:d.baseUnit/2,paddingBottom:d.baseUnit/2,paddingTop:d.baseUnit/2,color:h.neutral80})},Jx={gridArea:"1 / 2",font:"inherit",minWidth:"2px",border:0,margin:0,outline:0,padding:0},H3={flex:"1 1 auto",display:"inline-grid",gridArea:"1 / 1 / 2 / 3",gridTemplateColumns:"0 min-content","&:after":jt({content:'attr(data-value) " "',visibility:"hidden",whiteSpace:"pre"},Jx)},$3=function(o){return jt({label:"input",color:"inherit",background:0,opacity:o?0:1,width:"100%"},Jx)},K3=function(o){var s=o.cx,a=o.value,l=Wx(o),c=l.innerRef,d=l.isDisabled,h=l.isHidden,p=l.inputClassName,m=Mr(l,B3);return Nt("div",Et({},Cn(o,"input",{"input-container":!0}),{"data-value":a||""}),Nt("input",Et({className:s({input:!0},p),ref:c,style:$3(h),disabled:d},m)))},V3=K3,U3=function(o,s){var a=o.theme,l=a.spacing,c=a.borderRadius,d=a.colors;return jt({label:"multiValue",display:"flex",minWidth:0},s?{}:{backgroundColor:d.neutral10,borderRadius:c/2,margin:l.baseUnit/2})},W3=function(o,s){var a=o.theme,l=a.borderRadius,c=a.colors,d=o.cropWithEllipsis;return jt({overflow:"hidden",textOverflow:d||d===void 0?"ellipsis":void 0,whiteSpace:"nowrap"},s?{}:{borderRadius:l/2,color:c.neutral80,fontSize:"85%",padding:3,paddingLeft:6})},F3=function(o,s){var a=o.theme,l=a.spacing,c=a.borderRadius,d=a.colors,h=o.isFocused;return jt({alignItems:"center",display:"flex"},s?{}:{borderRadius:c/2,backgroundColor:h?d.dangerLight:void 0,paddingLeft:l.baseUnit,paddingRight:l.baseUnit,":hover":{backgroundColor:d.dangerLight,color:d.danger}})},ev=function(o){var s=o.children,a=o.innerProps;return Nt("div",a,s)},q3=ev,G3=ev;function P3(n){var o=n.children,s=n.innerProps;return Nt("div",Et({role:"button"},s),o||Nt(uh,{size:14}))}var Y3=function(o){var s=o.children,a=o.components,l=o.data,c=o.innerProps,d=o.isDisabled,h=o.removeProps,p=o.selectProps,m=a.Container,y=a.Label,x=a.Remove;return Nt(m,{data:l,innerProps:jt(jt({},Cn(o,"multiValue",{"multi-value":!0,"multi-value--is-disabled":d})),c),selectProps:p},Nt(y,{data:l,innerProps:jt({},Cn(o,"multiValueLabel",{"multi-value__label":!0})),selectProps:p},s),Nt(x,{data:l,innerProps:jt(jt({},Cn(o,"multiValueRemove",{"multi-value__remove":!0})),{},{"aria-label":"Remove ".concat(s||"option")},h),selectProps:p}))},Q3=Y3,X3=function(o,s){var a=o.isDisabled,l=o.isFocused,c=o.isSelected,d=o.theme,h=d.spacing,p=d.colors;return jt({label:"option",cursor:"default",display:"block",fontSize:"inherit",width:"100%",userSelect:"none",WebkitTapHighlightColor:"rgba(0, 0, 0, 0)"},s?{}:{backgroundColor:c?p.primary:l?p.primary25:"transparent",color:a?p.neutral20:c?p.neutral0:"inherit",padding:"".concat(h.baseUnit*2,"px ").concat(h.baseUnit*3,"px"),":active":{backgroundColor:a?void 0:c?p.primary:p.primary50}})},Z3=function(o){var s=o.children,a=o.isDisabled,l=o.isFocused,c=o.isSelected,d=o.innerRef,h=o.innerProps;return Nt("div",Et({},Cn(o,"option",{option:!0,"option--is-disabled":a,"option--is-focused":l,"option--is-selected":c}),{ref:d,"aria-disabled":a},h),s)},J3=Z3,e4=function(o,s){var a=o.theme,l=a.spacing,c=a.colors;return jt({label:"placeholder",gridArea:"1 / 1 / 2 / 3"},s?{}:{color:c.neutral50,marginLeft:l.baseUnit/2,marginRight:l.baseUnit/2})},t4=function(o){var s=o.children,a=o.innerProps;return Nt("div",Et({},Cn(o,"placeholder",{placeholder:!0}),a),s)},n4=t4,o4=function(o,s){var a=o.isDisabled,l=o.theme,c=l.spacing,d=l.colors;return jt({label:"singleValue",gridArea:"1 / 1 / 2 / 3",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},s?{}:{color:a?d.neutral40:d.neutral80,marginLeft:c.baseUnit/2,marginRight:c.baseUnit/2})},r4=function(o){var s=o.children,a=o.isDisabled,l=o.innerProps;return Nt("div",Et({},Cn(o,"singleValue",{"single-value":!0,"single-value--is-disabled":a}),l),s)},s4=r4,tv={ClearIndicator:S3,Control:E3,DropdownIndicator:v3,DownChevron:Xx,CrossIcon:uh,Group:D3,GroupHeading:R3,IndicatorsContainer:g3,IndicatorSeparator:k3,Input:V3,LoadingIndicator:M3,Menu:t3,MenuList:o3,MenuPortal:u3,LoadingMessage:l3,NoOptionsMessage:a3,MultiValue:Q3,MultiValueContainer:q3,MultiValueLabel:G3,MultiValueRemove:P3,Option:J3,Placeholder:n4,SelectContainer:d3,SingleValue:s4,ValueContainer:p3},a4=function(o){return jt(jt({},tv),o.components)},pb=Number.isNaN||function(o){return typeof o=="number"&&o!==o};function l4(n,o){return!!(n===o||pb(n)&&pb(o))}function i4(n,o){if(n.length!==o.length)return!1;for(var s=0;s<n.length;s++)if(!l4(n[s],o[s]))return!1;return!0}function u4(n,o){o===void 0&&(o=i4);var s=null;function a(){for(var l=[],c=0;c<arguments.length;c++)l[c]=arguments[c];if(s&&s.lastThis===this&&o(l,s.lastArgs))return s.lastResult;var d=n.apply(this,l);return s={lastResult:d,lastArgs:l,lastThis:this},d}return a.clear=function(){s=null},a}var c4={name:"7pg0cj-a11yText",styles:"label:a11yText;z-index:9999;border:0;clip:rect(1px, 1px, 1px, 1px);height:1px;width:1px;position:absolute;overflow:hidden;padding:0;white-space:nowrap"},d4=function(o){return Nt("span",Et({css:c4},o))},hb=d4,f4={guidance:function(o){var s=o.isSearchable,a=o.isMulti,l=o.tabSelectsValue,c=o.context,d=o.isInitialFocus;switch(c){case"menu":return"Use Up and Down to choose options, press Enter to select the currently focused option, press Escape to exit the menu".concat(l?", press Tab to select the option and exit the menu":"",".");case"input":return d?"".concat(o["aria-label"]||"Select"," is focused ").concat(s?",type to refine list":"",", press Down to open the menu, ").concat(a?" press left to focus selected values":""):"";case"value":return"Use left and right to toggle between focused values, press Backspace to remove the currently focused value";default:return""}},onChange:function(o){var s=o.action,a=o.label,l=a===void 0?"":a,c=o.labels,d=o.isDisabled;switch(s){case"deselect-option":case"pop-value":case"remove-value":return"option ".concat(l,", deselected.");case"clear":return"All selected options have been cleared.";case"initial-input-focus":return"option".concat(c.length>1?"s":""," ").concat(c.join(","),", selected.");case"select-option":return d?"option ".concat(l," is disabled. Select another option."):"option ".concat(l,", selected.");default:return""}},onFocus:function(o){var s=o.context,a=o.focused,l=o.options,c=o.label,d=c===void 0?"":c,h=o.selectValue,p=o.isDisabled,m=o.isSelected,y=o.isAppleDevice,x=function(S,j){return S&&S.length?"".concat(S.indexOf(j)+1," of ").concat(S.length):""};if(s==="value"&&h)return"value ".concat(d," focused, ").concat(x(h,a),".");if(s==="menu"&&y){var v=p?" disabled":"",k="".concat(m?" selected":"").concat(v);return"".concat(d).concat(k,", ").concat(x(l,a),".")}return""},onFilter:function(o){var s=o.inputValue,a=o.resultsMessage;return"".concat(a).concat(s?" for search term "+s:"",".")}},p4=function(o){var s=o.ariaSelection,a=o.focusedOption,l=o.focusedValue,c=o.focusableOptions,d=o.isFocused,h=o.selectValue,p=o.selectProps,m=o.id,y=o.isAppleDevice,x=p.ariaLiveMessages,v=p.getOptionLabel,k=p.inputValue,w=p.isMulti,S=p.isOptionDisabled,j=p.isSearchable,C=p.menuIsOpen,T=p.options,R=p.screenReaderStatus,D=p.tabSelectsValue,L=p.isLoading,B=p["aria-label"],A=p["aria-live"],F=b.useMemo(function(){return jt(jt({},f4),x||{})},[x]),te=b.useMemo(function(){var P="";if(s&&F.onChange){var V=s.option,H=s.options,ce=s.removedValue,ke=s.removedValues,Ne=s.value,O=function(ue){return Array.isArray(ue)?null:ue},_=ce||V||O(Ne),q=_?v(_):"",je=H||ke||void 0,Ke=je?je.map(v):[],De=jt({isDisabled:_&&S(_,h),label:q,labels:Ke},s);P=F.onChange(De)}return P},[s,F,S,h,v]),ee=b.useMemo(function(){var P="",V=a||l,H=!!(a&&h&&h.includes(a));if(V&&F.onFocus){var ce={focused:V,label:v(V),isDisabled:S(V,h),isSelected:H,options:c,context:V===a?"menu":"value",selectValue:h,isAppleDevice:y};P=F.onFocus(ce)}return P},[a,l,v,S,F,c,h,y]),ae=b.useMemo(function(){var P="";if(C&&T.length&&!L&&F.onFilter){var V=R({count:c.length});P=F.onFilter({inputValue:k,resultsMessage:V})}return P},[c,k,C,F,T,R,L]),ne=s?.action==="initial-input-focus",me=b.useMemo(function(){var P="";if(F.guidance){var V=l?"value":C?"menu":"input";P=F.guidance({"aria-label":B,context:V,isDisabled:a&&S(a,h),isMulti:w,isSearchable:j,tabSelectsValue:D,isInitialFocus:ne})}return P},[B,a,l,w,S,j,C,F,h,D,ne]),Le=Nt(b.Fragment,null,Nt("span",{id:"aria-selection"},te),Nt("span",{id:"aria-focused"},ee),Nt("span",{id:"aria-results"},ae),Nt("span",{id:"aria-guidance"},me));return Nt(b.Fragment,null,Nt(hb,{id:m},ne&&Le),Nt(hb,{"aria-live":A,"aria-atomic":"false","aria-relevant":"additions text",role:"log"},d&&!ne&&Le))},h4=p4,Mp=[{base:"A",letters:"A"},{base:"AA",letters:""},{base:"AE",letters:""},{base:"AO",letters:""},{base:"AU",letters:""},{base:"AV",letters:""},{base:"AY",letters:""},{base:"B",letters:"B"},{base:"C",letters:"C"},{base:"D",letters:"D"},{base:"DZ",letters:""},{base:"Dz",letters:""},{base:"E",letters:"E"},{base:"F",letters:"F"},{base:"G",letters:"G"},{base:"H",letters:"H"},{base:"I",letters:"I"},{base:"J",letters:"J"},{base:"K",letters:"K"},{base:"L",letters:"L"},{base:"LJ",letters:""},{base:"Lj",letters:""},{base:"M",letters:"M"},{base:"N",letters:"N"},{base:"NJ",letters:""},{base:"Nj",letters:""},{base:"O",letters:"O"},{base:"OI",letters:""},{base:"OO",letters:""},{base:"OU",letters:""},{base:"P",letters:"P"},{base:"Q",letters:"Q"},{base:"R",letters:"R"},{base:"S",letters:"S"},{base:"T",letters:"T"},{base:"TZ",letters:""},{base:"U",letters:"U"},{base:"V",letters:"V"},{base:"VY",letters:""},{base:"W",letters:"W"},{base:"X",letters:"X"},{base:"Y",letters:"Y"},{base:"Z",letters:"Z"},{base:"a",letters:"a"},{base:"aa",letters:""},{base:"ae",letters:""},{base:"ao",letters:""},{base:"au",letters:""},{base:"av",letters:""},{base:"ay",letters:""},{base:"b",letters:"b"},{base:"c",letters:"c"},{base:"d",letters:"d"},{base:"dz",letters:""},{base:"e",letters:"e"},{base:"f",letters:"f"},{base:"g",letters:"g"},{base:"h",letters:"h"},{base:"hv",letters:""},{base:"i",letters:"i"},{base:"j",letters:"j"},{base:"k",letters:"k"},{base:"l",letters:"l"},{base:"lj",letters:""},{base:"m",letters:"m"},{base:"n",letters:"n"},{base:"nj",letters:""},{base:"o",letters:"o"},{base:"oi",letters:""},{base:"ou",letters:""},{base:"oo",letters:""},{base:"p",letters:"p"},{base:"q",letters:"q"},{base:"r",letters:"r"},{base:"s",letters:"s"},{base:"t",letters:"t"},{base:"tz",letters:""},{base:"u",letters:"u"},{base:"v",letters:"v"},{base:"vy",letters:""},{base:"w",letters:"w"},{base:"x",letters:"x"},{base:"y",letters:"y"},{base:"z",letters:"z"}],g4=new RegExp("["+Mp.map(function(n){return n.letters}).join("")+"]","g"),nv={};for(var Uf=0;Uf<Mp.length;Uf++)for(var Wf=Mp[Uf],Ff=0;Ff<Wf.letters.length;Ff++)nv[Wf.letters[Ff]]=Wf.base;var ov=function(o){return o.replace(g4,function(s){return nv[s]})},m4=u4(ov),gb=function(o){return o.replace(/^\s+|\s+$/g,"")},y4=function(o){return"".concat(o.label," ").concat(o.value)},Op=function(o){return function(s,a){if(s.data.__isNew__)return!0;var l=jt({ignoreCase:!0,ignoreAccents:!0,stringify:y4,trim:!0,matchFrom:"any"},o),c=l.ignoreCase,d=l.ignoreAccents,h=l.stringify,p=l.trim,m=l.matchFrom,y=p?gb(a):a,x=p?gb(h(s)):h(s);return c&&(y=y.toLowerCase(),x=x.toLowerCase()),d&&(y=m4(y),x=ov(x)),m==="start"?x.substr(0,y.length)===y:x.indexOf(y)>-1}},b4=["innerRef"];function x4(n){var o=n.innerRef,s=Mr(n,b4),a=GC(s,"onExited","in","enter","exit","appear");return Nt("input",Et({ref:o},a,{css:sh({label:"dummyInput",background:0,border:0,caretColor:"transparent",fontSize:"inherit",gridArea:"1 / 1 / 2 / 3",outline:0,padding:0,width:1,color:"transparent",left:-100,opacity:0,position:"relative",transform:"scale(.01)"},"","")}))}var v4=function(o){o.cancelable&&o.preventDefault(),o.stopPropagation()};function w4(n){var o=n.isEnabled,s=n.onBottomArrive,a=n.onBottomLeave,l=n.onTopArrive,c=n.onTopLeave,d=b.useRef(!1),h=b.useRef(!1),p=b.useRef(0),m=b.useRef(null),y=b.useCallback(function(j,C){if(m.current!==null){var T=m.current,R=T.scrollTop,D=T.scrollHeight,L=T.clientHeight,B=m.current,A=C>0,F=D-L-R,te=!1;F>C&&d.current&&(a&&a(j),d.current=!1),A&&h.current&&(c&&c(j),h.current=!1),A&&C>F?(s&&!d.current&&s(j),B.scrollTop=D,te=!0,d.current=!0):!A&&-C>R&&(l&&!h.current&&l(j),B.scrollTop=0,te=!0,h.current=!0),te&&v4(j)}},[s,a,l,c]),x=b.useCallback(function(j){y(j,j.deltaY)},[y]),v=b.useCallback(function(j){p.current=j.changedTouches[0].clientY},[]),k=b.useCallback(function(j){var C=p.current-j.changedTouches[0].clientY;y(j,C)},[y]),w=b.useCallback(function(j){if(j){var C=WC?{passive:!1}:!1;j.addEventListener("wheel",x,C),j.addEventListener("touchstart",v,C),j.addEventListener("touchmove",k,C)}},[k,v,x]),S=b.useCallback(function(j){j&&(j.removeEventListener("wheel",x,!1),j.removeEventListener("touchstart",v,!1),j.removeEventListener("touchmove",k,!1))},[k,v,x]);return b.useEffect(function(){if(o){var j=m.current;return w(j),function(){S(j)}}},[o,w,S]),function(j){m.current=j}}var mb=["boxSizing","height","overflow","paddingRight","position"],yb={boxSizing:"border-box",overflow:"hidden",position:"relative",height:"100%"};function bb(n){n.cancelable&&n.preventDefault()}function xb(n){n.stopPropagation()}function vb(){var n=this.scrollTop,o=this.scrollHeight,s=n+this.offsetHeight;n===0?this.scrollTop=1:s===o&&(this.scrollTop=n-1)}function wb(){return"ontouchstart"in window||navigator.maxTouchPoints}var Sb=!!(typeof window<"u"&&window.document&&window.document.createElement),Sl=0,ca={capture:!1,passive:!1};function S4(n){var o=n.isEnabled,s=n.accountForScrollbars,a=s===void 0?!0:s,l=b.useRef({}),c=b.useRef(null),d=b.useCallback(function(p){if(Sb){var m=document.body,y=m&&m.style;if(a&&mb.forEach(function(w){var S=y&&y[w];l.current[w]=S}),a&&Sl<1){var x=parseInt(l.current.paddingRight,10)||0,v=document.body?document.body.clientWidth:0,k=window.innerWidth-v+x||0;Object.keys(yb).forEach(function(w){var S=yb[w];y&&(y[w]=S)}),y&&(y.paddingRight="".concat(k,"px"))}m&&wb()&&(m.addEventListener("touchmove",bb,ca),p&&(p.addEventListener("touchstart",vb,ca),p.addEventListener("touchmove",xb,ca))),Sl+=1}},[a]),h=b.useCallback(function(p){if(Sb){var m=document.body,y=m&&m.style;Sl=Math.max(Sl-1,0),a&&Sl<1&&mb.forEach(function(x){var v=l.current[x];y&&(y[x]=v)}),m&&wb()&&(m.removeEventListener("touchmove",bb,ca),p&&(p.removeEventListener("touchstart",vb,ca),p.removeEventListener("touchmove",xb,ca)))}},[a]);return b.useEffect(function(){if(o){var p=c.current;return d(p),function(){h(p)}}},[o,d,h]),function(p){c.current=p}}var N4=function(o){var s=o.target;return s.ownerDocument.activeElement&&s.ownerDocument.activeElement.blur()},k4={name:"1kfdb0e",styles:"position:fixed;left:0;bottom:0;right:0;top:0"};function C4(n){var o=n.children,s=n.lockEnabled,a=n.captureEnabled,l=a===void 0?!0:a,c=n.onBottomArrive,d=n.onBottomLeave,h=n.onTopArrive,p=n.onTopLeave,m=w4({isEnabled:l,onBottomArrive:c,onBottomLeave:d,onTopArrive:h,onTopLeave:p}),y=S4({isEnabled:s}),x=function(k){m(k),y(k)};return Nt(b.Fragment,null,s&&Nt("div",{onClick:N4,css:k4}),o(x))}var j4={name:"1a0ro4n-requiredInput",styles:"label:requiredInput;opacity:0;pointer-events:none;position:absolute;bottom:0;left:0;right:0;width:100%"},M4=function(o){var s=o.name,a=o.onFocus;return Nt("input",{required:!0,name:s,tabIndex:-1,"aria-hidden":"true",onFocus:a,css:j4,value:"",onChange:function(){}})},O4=M4;function ch(n){var o;return typeof window<"u"&&window.navigator!=null?n.test(((o=window.navigator.userAgentData)===null||o===void 0?void 0:o.platform)||window.navigator.platform):!1}function T4(){return ch(/^iPhone/i)}function rv(){return ch(/^Mac/i)}function E4(){return ch(/^iPad/i)||rv()&&navigator.maxTouchPoints>1}function I4(){return T4()||E4()}function L4(){return rv()||I4()}var _4=function(o){return o.label},A4=function(o){return o.label},R4=function(o){return o.value},D4=function(o){return!!o.isDisabled},B4={clearIndicator:w3,container:c3,control:O3,dropdownIndicator:x3,group:L3,groupHeading:A3,indicatorsContainer:h3,indicatorSeparator:N3,input:z3,loadingIndicator:j3,loadingMessage:s3,menu:ZC,menuList:n3,menuPortal:i3,multiValue:U3,multiValueLabel:W3,multiValueRemove:F3,noOptionsMessage:r3,option:X3,placeholder:e4,singleValue:o4,valueContainer:f3},z4={primary:"#2684FF",primary75:"#4C9AFF",primary50:"#B2D4FF",primary25:"#DEEBFF",danger:"#DE350B",dangerLight:"#FFBDAD",neutral0:"hsl(0, 0%, 100%)",neutral5:"hsl(0, 0%, 95%)",neutral10:"hsl(0, 0%, 90%)",neutral20:"hsl(0, 0%, 80%)",neutral30:"hsl(0, 0%, 70%)",neutral40:"hsl(0, 0%, 60%)",neutral50:"hsl(0, 0%, 50%)",neutral60:"hsl(0, 0%, 40%)",neutral70:"hsl(0, 0%, 30%)",neutral80:"hsl(0, 0%, 20%)",neutral90:"hsl(0, 0%, 10%)"},H4=4,sv=4,$4=38,K4=sv*2,V4={baseUnit:sv,controlHeight:$4,menuGutter:K4},qf={borderRadius:H4,colors:z4,spacing:V4},U4={"aria-live":"polite",backspaceRemovesValue:!0,blurInputOnSelect:db(),captureMenuScroll:!db(),classNames:{},closeMenuOnSelect:!0,closeMenuOnScroll:!1,components:{},controlShouldRenderValue:!0,escapeClearsValue:!1,filterOption:Op(),formatGroupLabel:_4,getOptionLabel:A4,getOptionValue:R4,isDisabled:!1,isLoading:!1,isMulti:!1,isRtl:!1,isSearchable:!0,isOptionDisabled:D4,loadingMessage:function(){return"Loading..."},maxMenuHeight:300,minMenuHeight:140,menuIsOpen:!1,menuPlacement:"bottom",menuPosition:"absolute",menuShouldBlockScroll:!1,menuShouldScrollIntoView:!VC(),noOptionsMessage:function(){return"No options"},openMenuOnFocus:!1,openMenuOnClick:!0,options:[],pageSize:5,placeholder:"Select...",screenReaderStatus:function(o){var s=o.count;return"".concat(s," result").concat(s!==1?"s":""," available")},styles:{},tabIndex:0,tabSelectsValue:!0,unstyled:!1};function Nb(n,o,s,a){var l=iv(n,o,s),c=uv(n,o,s),d=lv(n,o),h=sc(n,o);return{type:"option",data:o,isDisabled:l,isSelected:c,label:d,value:h,index:a}}function Du(n,o){return n.options.map(function(s,a){if("options"in s){var l=s.options.map(function(d,h){return Nb(n,d,o,h)}).filter(function(d){return Cb(n,d)});return l.length>0?{type:"group",data:s,options:l,index:a}:void 0}var c=Nb(n,s,o,a);return Cb(n,c)?c:void 0}).filter(FC)}function av(n){return n.reduce(function(o,s){return s.type==="group"?o.push.apply(o,eh(s.options.map(function(a){return a.data}))):o.push(s.data),o},[])}function kb(n,o){return n.reduce(function(s,a){return a.type==="group"?s.push.apply(s,eh(a.options.map(function(l){return{data:l.data,id:"".concat(o,"-").concat(a.index,"-").concat(l.index)}}))):s.push({data:a.data,id:"".concat(o,"-").concat(a.index)}),s},[])}function W4(n,o){return av(Du(n,o))}function Cb(n,o){var s=n.inputValue,a=s===void 0?"":s,l=o.data,c=o.isSelected,d=o.label,h=o.value;return(!dv(n)||!c)&&cv(n,{label:d,value:h,data:l},a)}function F4(n,o){var s=n.focusedValue,a=n.selectValue,l=a.indexOf(s);if(l>-1){var c=o.indexOf(s);if(c>-1)return s;if(l<o.length)return o[l]}return null}function q4(n,o){var s=n.focusedOption;return s&&o.indexOf(s)>-1?s:o[0]}var Gf=function(o,s){var a,l=(a=o.find(function(c){return c.data===s}))===null||a===void 0?void 0:a.id;return l||null},lv=function(o,s){return o.getOptionLabel(s)},sc=function(o,s){return o.getOptionValue(s)};function iv(n,o,s){return typeof n.isOptionDisabled=="function"?n.isOptionDisabled(o,s):!1}function uv(n,o,s){if(s.indexOf(o)>-1)return!0;if(typeof n.isOptionSelected=="function")return n.isOptionSelected(o,s);var a=sc(n,o);return s.some(function(l){return sc(n,l)===a})}function cv(n,o,s){return n.filterOption?n.filterOption(o,s):!0}var dv=function(o){var s=o.hideSelectedOptions,a=o.isMulti;return s===void 0?a:s},G4=1,fv=(function(n){gk(s,n);var o=bk(s);function s(a){var l;if(pk(this,s),l=o.call(this,a),l.state={ariaSelection:null,focusedOption:null,focusedOptionId:null,focusableOptionsWithIds:[],focusedValue:null,inputIsHidden:!1,isFocused:!1,selectValue:[],clearFocusValueOnUpdate:!1,prevWasFocused:!1,inputIsHiddenAfterUpdate:void 0,prevProps:void 0,instancePrefix:"",isAppleDevice:!1},l.blockOptionHover=!1,l.isComposing=!1,l.commonProps=void 0,l.initialTouchX=0,l.initialTouchY=0,l.openAfterFocus=!1,l.scrollToFocusedOptionOnUpdate=!1,l.userIsDragging=void 0,l.controlRef=null,l.getControlRef=function(p){l.controlRef=p},l.focusedOptionRef=null,l.getFocusedOptionRef=function(p){l.focusedOptionRef=p},l.menuListRef=null,l.getMenuListRef=function(p){l.menuListRef=p},l.inputRef=null,l.getInputRef=function(p){l.inputRef=p},l.focus=l.focusInput,l.blur=l.blurInput,l.onChange=function(p,m){var y=l.props,x=y.onChange,v=y.name;m.name=v,l.ariaOnChange(p,m),x(p,m)},l.setValue=function(p,m,y){var x=l.props,v=x.closeMenuOnSelect,k=x.isMulti,w=x.inputValue;l.onInputChange("",{action:"set-value",prevInputValue:w}),v&&(l.setState({inputIsHiddenAfterUpdate:!k}),l.onMenuClose()),l.setState({clearFocusValueOnUpdate:!0}),l.onChange(p,{action:m,option:y})},l.selectOption=function(p){var m=l.props,y=m.blurInputOnSelect,x=m.isMulti,v=m.name,k=l.state.selectValue,w=x&&l.isOptionSelected(p,k),S=l.isOptionDisabled(p,k);if(w){var j=l.getOptionValue(p);l.setValue(k.filter(function(C){return l.getOptionValue(C)!==j}),"deselect-option",p)}else if(!S)x?l.setValue([].concat(eh(k),[p]),"select-option",p):l.setValue(p,"select-option");else{l.ariaOnChange(p,{action:"select-option",option:p,name:v});return}y&&l.blurInput()},l.removeValue=function(p){var m=l.props.isMulti,y=l.state.selectValue,x=l.getOptionValue(p),v=y.filter(function(w){return l.getOptionValue(w)!==x}),k=Cu(m,v,v[0]||null);l.onChange(k,{action:"remove-value",removedValue:p}),l.focusInput()},l.clearValue=function(){var p=l.state.selectValue;l.onChange(Cu(l.props.isMulti,[],null),{action:"clear",removedValues:p})},l.popValue=function(){var p=l.props.isMulti,m=l.state.selectValue,y=m[m.length-1],x=m.slice(0,m.length-1),v=Cu(p,x,x[0]||null);y&&l.onChange(v,{action:"pop-value",removedValue:y})},l.getFocusedOptionId=function(p){return Gf(l.state.focusableOptionsWithIds,p)},l.getFocusableOptionsWithIds=function(){return kb(Du(l.props,l.state.selectValue),l.getElementId("option"))},l.getValue=function(){return l.state.selectValue},l.cx=function(){for(var p=arguments.length,m=new Array(p),y=0;y<p;y++)m[y]=arguments[y];return BC.apply(void 0,[l.props.classNamePrefix].concat(m))},l.getOptionLabel=function(p){return lv(l.props,p)},l.getOptionValue=function(p){return sc(l.props,p)},l.getStyles=function(p,m){var y=l.props.unstyled,x=B4[p](m,y);x.boxSizing="border-box";var v=l.props.styles[p];return v?v(x,m):x},l.getClassNames=function(p,m){var y,x;return(y=(x=l.props.classNames)[p])===null||y===void 0?void 0:y.call(x,m)},l.getElementId=function(p){return"".concat(l.state.instancePrefix,"-").concat(p)},l.getComponents=function(){return a4(l.props)},l.buildCategorizedOptions=function(){return Du(l.props,l.state.selectValue)},l.getCategorizedOptions=function(){return l.props.menuIsOpen?l.buildCategorizedOptions():[]},l.buildFocusableOptions=function(){return av(l.buildCategorizedOptions())},l.getFocusableOptions=function(){return l.props.menuIsOpen?l.buildFocusableOptions():[]},l.ariaOnChange=function(p,m){l.setState({ariaSelection:jt({value:p},m)})},l.onMenuMouseDown=function(p){p.button===0&&(p.stopPropagation(),p.preventDefault(),l.focusInput())},l.onMenuMouseMove=function(p){l.blockOptionHover=!1},l.onControlMouseDown=function(p){if(!p.defaultPrevented){var m=l.props.openMenuOnClick;l.state.isFocused?l.props.menuIsOpen?p.target.tagName!=="INPUT"&&p.target.tagName!=="TEXTAREA"&&l.onMenuClose():m&&l.openMenu("first"):(m&&(l.openAfterFocus=!0),l.focusInput()),p.target.tagName!=="INPUT"&&p.target.tagName!=="TEXTAREA"&&p.preventDefault()}},l.onDropdownIndicatorMouseDown=function(p){if(!(p&&p.type==="mousedown"&&p.button!==0)&&!l.props.isDisabled){var m=l.props,y=m.isMulti,x=m.menuIsOpen;l.focusInput(),x?(l.setState({inputIsHiddenAfterUpdate:!y}),l.onMenuClose()):l.openMenu("first"),p.preventDefault()}},l.onClearIndicatorMouseDown=function(p){p&&p.type==="mousedown"&&p.button!==0||(l.clearValue(),p.preventDefault(),l.openAfterFocus=!1,p.type==="touchend"?l.focusInput():setTimeout(function(){return l.focusInput()}))},l.onScroll=function(p){typeof l.props.closeMenuOnScroll=="boolean"?p.target instanceof HTMLElement&&yc(p.target)&&l.props.onMenuClose():typeof l.props.closeMenuOnScroll=="function"&&l.props.closeMenuOnScroll(p)&&l.props.onMenuClose()},l.onCompositionStart=function(){l.isComposing=!0},l.onCompositionEnd=function(){l.isComposing=!1},l.onTouchStart=function(p){var m=p.touches,y=m&&m.item(0);y&&(l.initialTouchX=y.clientX,l.initialTouchY=y.clientY,l.userIsDragging=!1)},l.onTouchMove=function(p){var m=p.touches,y=m&&m.item(0);if(y){var x=Math.abs(y.clientX-l.initialTouchX),v=Math.abs(y.clientY-l.initialTouchY),k=5;l.userIsDragging=x>k||v>k}},l.onTouchEnd=function(p){l.userIsDragging||(l.controlRef&&!l.controlRef.contains(p.target)&&l.menuListRef&&!l.menuListRef.contains(p.target)&&l.blurInput(),l.initialTouchX=0,l.initialTouchY=0)},l.onControlTouchEnd=function(p){l.userIsDragging||l.onControlMouseDown(p)},l.onClearIndicatorTouchEnd=function(p){l.userIsDragging||l.onClearIndicatorMouseDown(p)},l.onDropdownIndicatorTouchEnd=function(p){l.userIsDragging||l.onDropdownIndicatorMouseDown(p)},l.handleInputChange=function(p){var m=l.props.inputValue,y=p.currentTarget.value;l.setState({inputIsHiddenAfterUpdate:!1}),l.onInputChange(y,{action:"input-change",prevInputValue:m}),l.props.menuIsOpen||l.onMenuOpen()},l.onInputFocus=function(p){l.props.onFocus&&l.props.onFocus(p),l.setState({inputIsHiddenAfterUpdate:!1,isFocused:!0}),(l.openAfterFocus||l.props.openMenuOnFocus)&&l.openMenu("first"),l.openAfterFocus=!1},l.onInputBlur=function(p){var m=l.props.inputValue;if(l.menuListRef&&l.menuListRef.contains(document.activeElement)){l.inputRef.focus();return}l.props.onBlur&&l.props.onBlur(p),l.onInputChange("",{action:"input-blur",prevInputValue:m}),l.onMenuClose(),l.setState({focusedValue:null,isFocused:!1})},l.onOptionHover=function(p){if(!(l.blockOptionHover||l.state.focusedOption===p)){var m=l.getFocusableOptions(),y=m.indexOf(p);l.setState({focusedOption:p,focusedOptionId:y>-1?l.getFocusedOptionId(p):null})}},l.shouldHideSelectedOptions=function(){return dv(l.props)},l.onValueInputFocus=function(p){p.preventDefault(),p.stopPropagation(),l.focus()},l.onKeyDown=function(p){var m=l.props,y=m.isMulti,x=m.backspaceRemovesValue,v=m.escapeClearsValue,k=m.inputValue,w=m.isClearable,S=m.isDisabled,j=m.menuIsOpen,C=m.onKeyDown,T=m.tabSelectsValue,R=m.openMenuOnFocus,D=l.state,L=D.focusedOption,B=D.focusedValue,A=D.selectValue;if(!S&&!(typeof C=="function"&&(C(p),p.defaultPrevented))){switch(l.blockOptionHover=!0,p.key){case"ArrowLeft":if(!y||k)return;l.focusValue("previous");break;case"ArrowRight":if(!y||k)return;l.focusValue("next");break;case"Delete":case"Backspace":if(k)return;if(B)l.removeValue(B);else{if(!x)return;y?l.popValue():w&&l.clearValue()}break;case"Tab":if(l.isComposing||p.shiftKey||!j||!T||!L||R&&l.isOptionSelected(L,A))return;l.selectOption(L);break;case"Enter":if(p.keyCode===229)break;if(j){if(!L||l.isComposing)return;l.selectOption(L);break}return;case"Escape":j?(l.setState({inputIsHiddenAfterUpdate:!1}),l.onInputChange("",{action:"menu-close",prevInputValue:k}),l.onMenuClose()):w&&v&&l.clearValue();break;case" ":if(k)return;if(!j){l.openMenu("first");break}if(!L)return;l.selectOption(L);break;case"ArrowUp":j?l.focusOption("up"):l.openMenu("last");break;case"ArrowDown":j?l.focusOption("down"):l.openMenu("first");break;case"PageUp":if(!j)return;l.focusOption("pageup");break;case"PageDown":if(!j)return;l.focusOption("pagedown");break;case"Home":if(!j)return;l.focusOption("first");break;case"End":if(!j)return;l.focusOption("last");break;default:return}p.preventDefault()}},l.state.instancePrefix="react-select-"+(l.props.instanceId||++G4),l.state.selectValue=ub(a.value),a.menuIsOpen&&l.state.selectValue.length){var c=l.getFocusableOptionsWithIds(),d=l.buildFocusableOptions(),h=d.indexOf(l.state.selectValue[0]);l.state.focusableOptionsWithIds=c,l.state.focusedOption=d[h],l.state.focusedOptionId=Gf(c,d[h])}return l}return hk(s,[{key:"componentDidMount",value:function(){this.startListeningComposition(),this.startListeningToTouch(),this.props.closeMenuOnScroll&&document&&document.addEventListener&&document.addEventListener("scroll",this.onScroll,!0),this.props.autoFocus&&this.focusInput(),this.props.menuIsOpen&&this.state.focusedOption&&this.menuListRef&&this.focusedOptionRef&&cb(this.menuListRef,this.focusedOptionRef),L4()&&this.setState({isAppleDevice:!0})}},{key:"componentDidUpdate",value:function(l){var c=this.props,d=c.isDisabled,h=c.menuIsOpen,p=this.state.isFocused;(p&&!d&&l.isDisabled||p&&h&&!l.menuIsOpen)&&this.focusInput(),p&&d&&!l.isDisabled?this.setState({isFocused:!1},this.onMenuClose):!p&&!d&&l.isDisabled&&this.inputRef===document.activeElement&&this.setState({isFocused:!0}),this.menuListRef&&this.focusedOptionRef&&this.scrollToFocusedOptionOnUpdate&&(cb(this.menuListRef,this.focusedOptionRef),this.scrollToFocusedOptionOnUpdate=!1)}},{key:"componentWillUnmount",value:function(){this.stopListeningComposition(),this.stopListeningToTouch(),document.removeEventListener("scroll",this.onScroll,!0)}},{key:"onMenuOpen",value:function(){this.props.onMenuOpen()}},{key:"onMenuClose",value:function(){this.onInputChange("",{action:"menu-close",prevInputValue:this.props.inputValue}),this.props.onMenuClose()}},{key:"onInputChange",value:function(l,c){this.props.onInputChange(l,c)}},{key:"focusInput",value:function(){this.inputRef&&this.inputRef.focus()}},{key:"blurInput",value:function(){this.inputRef&&this.inputRef.blur()}},{key:"openMenu",value:function(l){var c=this,d=this.state,h=d.selectValue,p=d.isFocused,m=this.buildFocusableOptions(),y=l==="first"?0:m.length-1;if(!this.props.isMulti){var x=m.indexOf(h[0]);x>-1&&(y=x)}this.scrollToFocusedOptionOnUpdate=!(p&&this.menuListRef),this.setState({inputIsHiddenAfterUpdate:!1,focusedValue:null,focusedOption:m[y],focusedOptionId:this.getFocusedOptionId(m[y])},function(){return c.onMenuOpen()})}},{key:"focusValue",value:function(l){var c=this.state,d=c.selectValue,h=c.focusedValue;if(this.props.isMulti){this.setState({focusedOption:null});var p=d.indexOf(h);h||(p=-1);var m=d.length-1,y=-1;if(d.length){switch(l){case"previous":p===0?y=0:p===-1?y=m:y=p-1;break;case"next":p>-1&&p<m&&(y=p+1);break}this.setState({inputIsHidden:y!==-1,focusedValue:d[y]})}}}},{key:"focusOption",value:function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"first",c=this.props.pageSize,d=this.state.focusedOption,h=this.getFocusableOptions();if(h.length){var p=0,m=h.indexOf(d);d||(m=-1),l==="up"?p=m>0?m-1:h.length-1:l==="down"?p=(m+1)%h.length:l==="pageup"?(p=m-c,p<0&&(p=0)):l==="pagedown"?(p=m+c,p>h.length-1&&(p=h.length-1)):l==="last"&&(p=h.length-1),this.scrollToFocusedOptionOnUpdate=!0,this.setState({focusedOption:h[p],focusedValue:null,focusedOptionId:this.getFocusedOptionId(h[p])})}}},{key:"getTheme",value:(function(){return this.props.theme?typeof this.props.theme=="function"?this.props.theme(qf):jt(jt({},qf),this.props.theme):qf})},{key:"getCommonProps",value:function(){var l=this.clearValue,c=this.cx,d=this.getStyles,h=this.getClassNames,p=this.getValue,m=this.selectOption,y=this.setValue,x=this.props,v=x.isMulti,k=x.isRtl,w=x.options,S=this.hasValue();return{clearValue:l,cx:c,getStyles:d,getClassNames:h,getValue:p,hasValue:S,isMulti:v,isRtl:k,options:w,selectOption:m,selectProps:x,setValue:y,theme:this.getTheme()}}},{key:"hasValue",value:function(){var l=this.state.selectValue;return l.length>0}},{key:"hasOptions",value:function(){return!!this.getFocusableOptions().length}},{key:"isClearable",value:function(){var l=this.props,c=l.isClearable,d=l.isMulti;return c===void 0?d:c}},{key:"isOptionDisabled",value:function(l,c){return iv(this.props,l,c)}},{key:"isOptionSelected",value:function(l,c){return uv(this.props,l,c)}},{key:"filterOption",value:function(l,c){return cv(this.props,l,c)}},{key:"formatOptionLabel",value:function(l,c){if(typeof this.props.formatOptionLabel=="function"){var d=this.props.inputValue,h=this.state.selectValue;return this.props.formatOptionLabel(l,{context:c,inputValue:d,selectValue:h})}else return this.getOptionLabel(l)}},{key:"formatGroupLabel",value:function(l){return this.props.formatGroupLabel(l)}},{key:"startListeningComposition",value:(function(){document&&document.addEventListener&&(document.addEventListener("compositionstart",this.onCompositionStart,!1),document.addEventListener("compositionend",this.onCompositionEnd,!1))})},{key:"stopListeningComposition",value:function(){document&&document.removeEventListener&&(document.removeEventListener("compositionstart",this.onCompositionStart),document.removeEventListener("compositionend",this.onCompositionEnd))}},{key:"startListeningToTouch",value:(function(){document&&document.addEventListener&&(document.addEventListener("touchstart",this.onTouchStart,!1),document.addEventListener("touchmove",this.onTouchMove,!1),document.addEventListener("touchend",this.onTouchEnd,!1))})},{key:"stopListeningToTouch",value:function(){document&&document.removeEventListener&&(document.removeEventListener("touchstart",this.onTouchStart),document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onTouchEnd))}},{key:"renderInput",value:(function(){var l=this.props,c=l.isDisabled,d=l.isSearchable,h=l.inputId,p=l.inputValue,m=l.tabIndex,y=l.form,x=l.menuIsOpen,v=l.required,k=this.getComponents(),w=k.Input,S=this.state,j=S.inputIsHidden,C=S.ariaSelection,T=this.commonProps,R=h||this.getElementId("input"),D=jt(jt(jt({"aria-autocomplete":"list","aria-expanded":x,"aria-haspopup":!0,"aria-errormessage":this.props["aria-errormessage"],"aria-invalid":this.props["aria-invalid"],"aria-label":this.props["aria-label"],"aria-labelledby":this.props["aria-labelledby"],"aria-required":v,role:"combobox","aria-activedescendant":this.state.isAppleDevice?void 0:this.state.focusedOptionId||""},x&&{"aria-controls":this.getElementId("listbox")}),!d&&{"aria-readonly":!0}),this.hasValue()?C?.action==="initial-input-focus"&&{"aria-describedby":this.getElementId("live-region")}:{"aria-describedby":this.getElementId("placeholder")});return d?b.createElement(w,Et({},T,{autoCapitalize:"none",autoComplete:"off",autoCorrect:"off",id:R,innerRef:this.getInputRef,isDisabled:c,isHidden:j,onBlur:this.onInputBlur,onChange:this.handleInputChange,onFocus:this.onInputFocus,spellCheck:"false",tabIndex:m,form:y,type:"text",value:p},D)):b.createElement(x4,Et({id:R,innerRef:this.getInputRef,onBlur:this.onInputBlur,onChange:oc,onFocus:this.onInputFocus,disabled:c,tabIndex:m,inputMode:"none",form:y,value:""},D))})},{key:"renderPlaceholderOrValue",value:function(){var l=this,c=this.getComponents(),d=c.MultiValue,h=c.MultiValueContainer,p=c.MultiValueLabel,m=c.MultiValueRemove,y=c.SingleValue,x=c.Placeholder,v=this.commonProps,k=this.props,w=k.controlShouldRenderValue,S=k.isDisabled,j=k.isMulti,C=k.inputValue,T=k.placeholder,R=this.state,D=R.selectValue,L=R.focusedValue,B=R.isFocused;if(!this.hasValue()||!w)return C?null:b.createElement(x,Et({},v,{key:"placeholder",isDisabled:S,isFocused:B,innerProps:{id:this.getElementId("placeholder")}}),T);if(j)return D.map(function(F,te){var ee=F===L,ae="".concat(l.getOptionLabel(F),"-").concat(l.getOptionValue(F));return b.createElement(d,Et({},v,{components:{Container:h,Label:p,Remove:m},isFocused:ee,isDisabled:S,key:ae,index:te,removeProps:{onClick:function(){return l.removeValue(F)},onTouchEnd:function(){return l.removeValue(F)},onMouseDown:function(me){me.preventDefault()}},data:F}),l.formatOptionLabel(F,"value"))});if(C)return null;var A=D[0];return b.createElement(y,Et({},v,{data:A,isDisabled:S}),this.formatOptionLabel(A,"value"))}},{key:"renderClearIndicator",value:function(){var l=this.getComponents(),c=l.ClearIndicator,d=this.commonProps,h=this.props,p=h.isDisabled,m=h.isLoading,y=this.state.isFocused;if(!this.isClearable()||!c||p||!this.hasValue()||m)return null;var x={onMouseDown:this.onClearIndicatorMouseDown,onTouchEnd:this.onClearIndicatorTouchEnd,"aria-hidden":"true"};return b.createElement(c,Et({},d,{innerProps:x,isFocused:y}))}},{key:"renderLoadingIndicator",value:function(){var l=this.getComponents(),c=l.LoadingIndicator,d=this.commonProps,h=this.props,p=h.isDisabled,m=h.isLoading,y=this.state.isFocused;if(!c||!m)return null;var x={"aria-hidden":"true"};return b.createElement(c,Et({},d,{innerProps:x,isDisabled:p,isFocused:y}))}},{key:"renderIndicatorSeparator",value:function(){var l=this.getComponents(),c=l.DropdownIndicator,d=l.IndicatorSeparator;if(!c||!d)return null;var h=this.commonProps,p=this.props.isDisabled,m=this.state.isFocused;return b.createElement(d,Et({},h,{isDisabled:p,isFocused:m}))}},{key:"renderDropdownIndicator",value:function(){var l=this.getComponents(),c=l.DropdownIndicator;if(!c)return null;var d=this.commonProps,h=this.props.isDisabled,p=this.state.isFocused,m={onMouseDown:this.onDropdownIndicatorMouseDown,onTouchEnd:this.onDropdownIndicatorTouchEnd,"aria-hidden":"true"};return b.createElement(c,Et({},d,{innerProps:m,isDisabled:h,isFocused:p}))}},{key:"renderMenu",value:function(){var l=this,c=this.getComponents(),d=c.Group,h=c.GroupHeading,p=c.Menu,m=c.MenuList,y=c.MenuPortal,x=c.LoadingMessage,v=c.NoOptionsMessage,k=c.Option,w=this.commonProps,S=this.state.focusedOption,j=this.props,C=j.captureMenuScroll,T=j.inputValue,R=j.isLoading,D=j.loadingMessage,L=j.minMenuHeight,B=j.maxMenuHeight,A=j.menuIsOpen,F=j.menuPlacement,te=j.menuPosition,ee=j.menuPortalTarget,ae=j.menuShouldBlockScroll,ne=j.menuShouldScrollIntoView,me=j.noOptionsMessage,Le=j.onMenuScrollToTop,P=j.onMenuScrollToBottom;if(!A)return null;var V=function(q,je){var Ke=q.type,De=q.data,Fe=q.isDisabled,ue=q.isSelected,ye=q.label,et=q.value,oe=S===De,z=Fe?void 0:function(){return l.onOptionHover(De)},U=Fe?void 0:function(){return l.selectOption(De)},se="".concat(l.getElementId("option"),"-").concat(je),fe={id:se,onClick:U,onMouseMove:z,onMouseOver:z,tabIndex:-1,role:"option","aria-selected":l.state.isAppleDevice?void 0:ue};return b.createElement(k,Et({},w,{innerProps:fe,data:De,isDisabled:Fe,isSelected:ue,key:se,label:ye,type:Ke,value:et,isFocused:oe,innerRef:oe?l.getFocusedOptionRef:void 0}),l.formatOptionLabel(q.data,"menu"))},H;if(this.hasOptions())H=this.getCategorizedOptions().map(function(_){if(_.type==="group"){var q=_.data,je=_.options,Ke=_.index,De="".concat(l.getElementId("group"),"-").concat(Ke),Fe="".concat(De,"-heading");return b.createElement(d,Et({},w,{key:De,data:q,options:je,Heading:h,headingProps:{id:Fe,data:_.data},label:l.formatGroupLabel(_.data)}),_.options.map(function(ue){return V(ue,"".concat(Ke,"-").concat(ue.index))}))}else if(_.type==="option")return V(_,"".concat(_.index))});else if(R){var ce=D({inputValue:T});if(ce===null)return null;H=b.createElement(x,w,ce)}else{var ke=me({inputValue:T});if(ke===null)return null;H=b.createElement(v,w,ke)}var Ne={minMenuHeight:L,maxMenuHeight:B,menuPlacement:F,menuPosition:te,menuShouldScrollIntoView:ne},O=b.createElement(JC,Et({},w,Ne),function(_){var q=_.ref,je=_.placerProps,Ke=je.placement,De=je.maxHeight;return b.createElement(p,Et({},w,Ne,{innerRef:q,innerProps:{onMouseDown:l.onMenuMouseDown,onMouseMove:l.onMenuMouseMove},isLoading:R,placement:Ke}),b.createElement(C4,{captureEnabled:C,onTopArrive:Le,onBottomArrive:P,lockEnabled:ae},function(Fe){return b.createElement(m,Et({},w,{innerRef:function(ye){l.getMenuListRef(ye),Fe(ye)},innerProps:{role:"listbox","aria-multiselectable":w.isMulti,id:l.getElementId("listbox")},isLoading:R,maxHeight:De,focusedOption:S}),H)}))});return ee||te==="fixed"?b.createElement(y,Et({},w,{appendTo:ee,controlElement:this.controlRef,menuPlacement:F,menuPosition:te}),O):O}},{key:"renderFormField",value:function(){var l=this,c=this.props,d=c.delimiter,h=c.isDisabled,p=c.isMulti,m=c.name,y=c.required,x=this.state.selectValue;if(y&&!this.hasValue()&&!h)return b.createElement(O4,{name:m,onFocus:this.onValueInputFocus});if(!(!m||h))if(p)if(d){var v=x.map(function(S){return l.getOptionValue(S)}).join(d);return b.createElement("input",{name:m,type:"hidden",value:v})}else{var k=x.length>0?x.map(function(S,j){return b.createElement("input",{key:"i-".concat(j),name:m,type:"hidden",value:l.getOptionValue(S)})}):b.createElement("input",{name:m,type:"hidden",value:""});return b.createElement("div",null,k)}else{var w=x[0]?this.getOptionValue(x[0]):"";return b.createElement("input",{name:m,type:"hidden",value:w})}}},{key:"renderLiveRegion",value:function(){var l=this.commonProps,c=this.state,d=c.ariaSelection,h=c.focusedOption,p=c.focusedValue,m=c.isFocused,y=c.selectValue,x=this.getFocusableOptions();return b.createElement(h4,Et({},l,{id:this.getElementId("live-region"),ariaSelection:d,focusedOption:h,focusedValue:p,isFocused:m,selectValue:y,focusableOptions:x,isAppleDevice:this.state.isAppleDevice}))}},{key:"render",value:function(){var l=this.getComponents(),c=l.Control,d=l.IndicatorsContainer,h=l.SelectContainer,p=l.ValueContainer,m=this.props,y=m.className,x=m.id,v=m.isDisabled,k=m.menuIsOpen,w=this.state.isFocused,S=this.commonProps=this.getCommonProps();return b.createElement(h,Et({},S,{className:y,innerProps:{id:x,onKeyDown:this.onKeyDown},isDisabled:v,isFocused:w}),this.renderLiveRegion(),b.createElement(c,Et({},S,{innerRef:this.getControlRef,innerProps:{onMouseDown:this.onControlMouseDown,onTouchEnd:this.onControlTouchEnd},isDisabled:v,isFocused:w,menuIsOpen:k}),b.createElement(p,Et({},S,{isDisabled:v}),this.renderPlaceholderOrValue(),this.renderInput()),b.createElement(d,Et({},S,{isDisabled:v}),this.renderClearIndicator(),this.renderLoadingIndicator(),this.renderIndicatorSeparator(),this.renderDropdownIndicator())),this.renderMenu(),this.renderFormField())}}],[{key:"getDerivedStateFromProps",value:function(l,c){var d=c.prevProps,h=c.clearFocusValueOnUpdate,p=c.inputIsHiddenAfterUpdate,m=c.ariaSelection,y=c.isFocused,x=c.prevWasFocused,v=c.instancePrefix,k=l.options,w=l.value,S=l.menuIsOpen,j=l.inputValue,C=l.isMulti,T=ub(w),R={};if(d&&(w!==d.value||k!==d.options||S!==d.menuIsOpen||j!==d.inputValue)){var D=S?W4(l,T):[],L=S?kb(Du(l,T),"".concat(v,"-option")):[],B=h?F4(c,T):null,A=q4(c,D),F=Gf(L,A);R={selectValue:T,focusedOption:A,focusedOptionId:F,focusableOptionsWithIds:L,focusedValue:B,clearFocusValueOnUpdate:!1}}var te=p!=null&&l!==d?{inputIsHidden:p,inputIsHiddenAfterUpdate:void 0}:{},ee=m,ae=y&&x;return y&&!ae&&(ee={value:Cu(C,T,T[0]||null),options:T,action:"initial-input-focus"},ae=!x),m?.action==="initial-input-focus"&&(ee=null),jt(jt(jt({},R),te),{},{prevProps:l,ariaSelection:ee,prevWasFocused:ae})}}]),s})(b.Component);fv.defaultProps=U4;var P4=b.forwardRef(function(n,o){var s=fk(n);return b.createElement(fv,Et({ref:o},s))}),jb=P4;function ju({containerClass:n,name:o,value:s,options:a,onChange:l,disabled:c=!1,hideLabel:d=!1,hasPin:h,isPinned:p=!1,onTogglePin:m,hasError:y=!1,forceModalOpen:x=!1,onModalClose:v}){const k=de(Q=>Q.setNodeTypes),S=wa(Q=>Q.theme)==="dark",[j,C]=b.useState(!1),T=b.useRef(null),R=b.useRef(null),[D,L]=b.useState([]),[B,A]=b.useState(!1),F=x||j,te=Nx(),ee=Q=>{if(!Array.isArray(a))return a?.[Q]},ae=Array.isArray(a)?a:ee("options")??[],ne=!!ee("image_upload"),me=ee("image_folder")??"input",Le=!!ee("stripSafetensorsSuffix"),P="__null__",V=ae.some(Q=>Q===null),H=ae.filter(Q=>Q!==null).map(Q=>String(Q)),ce=Array.from(new Set([...H,...D])),ke=s===null?P:String(s??""),Ne=ke.split(/[\\/]/).pop()??ke,O=Kl(s,ce),_=O===void 0?null:String(O),q=_!==null||ce.includes(ke)||ce.includes(Ne),je=s!=null&&ke!==""&&!q,Ke=q?_??(ce.includes(ke)?ke:Ne):ke,De=Q=>Le?Q.replace(/\.safetensors$/i,""):Q,Fe=[];(s===null||V)&&Fe.push({value:P,label:"None"}),je&&Fe.push({value:ke,label:De(ke),isMissing:!0}),Fe.push(...ce.map(Q=>({value:Q,label:De(Q)})));const ue=Fe.find(Q=>Q.value===Ke)??null,ye=ae.filter(Q=>Q!==null).length,et=x?!0:te&&!(ye>0&&ye<5),oe=ne&&me==="input",z=Q=>{const Me=Q.replace(/\\/g,"/"),K=Me.lastIndexOf("/"),Te=K>=0?Me.slice(K+1):Me,_e=K>=0?Me.slice(0,K):"";return bo(Te,_e,"input")},U=b.useMemo(()=>oe?{DropdownIndicator:null,IndicatorSeparator:null,Option:Me=>{const{data:K}=Me,_e=K.value!==P&&!K.isMissing&&!!K.value?z(K.value):null;return u.jsx(tv.Option,{...Me,children:u.jsxs("div",{className:"flex items-center gap-2",children:[_e&&u.jsx("img",{src:_e,alt:"",className:"w-[72px] h-[72px] rounded-sm object-cover bg-gray-100 shrink-0",loading:"lazy",decoding:"async"}),u.jsx("span",{className:"truncate",children:K.label})]})})}}:{DropdownIndicator:null,IndicatorSeparator:null},[oe]),se=["rs-container",h?"rs-has-pin":"rs-no-pin",y?"rs-error":"",je?"rs-missing":"",c?"rs-disabled":""].filter(Boolean).join(" "),fe=typeof document>"u"?null:document.body,M=()=>{C(!1),v?.()},re=Q=>{Q&&l(Q.value===P?null:Q.value)},W=Q=>{re(Q),M()},G=()=>{c||B||R.current?.click()},I=async Q=>{const Me=Q.target.files?.[0];if(Me){A(!0);try{const K=await Fb(Me,{type:me}),Te=K.subfolder?`${K.subfolder}/${K.name}`:K.name;L(_e=>_e.includes(Te)?_e:[..._e,Te]);try{const _e=await _p();k(_e)}catch{}l(Te)}catch(K){console.error("Failed to upload image:",K)}finally{A(!1),Q.target.value=""}}},$=ne?u.jsx("button",{type:"button",className:`w-full py-2 px-3 rounded-lg border text-sm font-medium transition-colors ${c||B?"opacity-60 cursor-not-allowed border-gray-200 text-gray-400 bg-white":"border-gray-200 text-gray-700 bg-white hover:border-gray-300 hover:text-gray-900"}`,onClick:G,disabled:c||B,children:u.jsxs("span",{className:"inline-flex items-center justify-center gap-2",children:[u.jsx(Io,{className:"w-4 h-4"}),B?"Uploading...":"Load from camera roll"]})}):null,Z=Dt.text.primary,Se=Dt.text.secondary;return et?u.jsxs("div",{className:`${n} combo-control-root combo-control-modal`,children:[!d&&u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:o}),u.jsxs("div",{className:`combo-control-trigger relative w-full p-3 comfy-input text-base flex items-center justify-between min-h-[46px] ${c?"opacity-60 cursor-not-allowed":""} ${y?"border-red-700 ring-1 ring-red-700":""}`,onClick:()=>!c&&C(!0),children:[u.jsx("span",{className:`combo-control-trigger-label truncate min-w-0 flex-1 ${ue?"text-gray-900":"text-gray-400 dark:text-gray-500"} ${h?"pr-16":"pr-6"}`,style:ue&&S?{color:Dt.text.onDark}:void 0,children:ue?ue.label:"Select..."}),u.jsxs("div",{className:"combo-control-trigger-icons flex items-center absolute right-0 top-0 bottom-0 pointer-events-none",children:[u.jsx("div",{className:"combo-control-chevron px-2 text-gray-400",children:u.jsx(Qu,{className:"w-5 h-5"})}),h&&u.jsx("div",{className:"combo-control-pin pointer-events-auto px-2",children:u.jsx(ma,{isPinned:p,onToggle:m})})]})]}),je&&u.jsx("div",{className:"mt-1 text-xs text-red-700",children:"Missing on ComfyUI server"}),ne&&u.jsxs("div",{className:"combo-control-upload mt-2",children:[$,u.jsx("input",{ref:R,type:"file",accept:"image/*",className:"hidden",onChange:I})]}),u.jsx(Jp,{title:o,isOpen:F,onClose:M,children:u.jsx(jb,{className:se,classNamePrefix:"rs",options:Fe,value:ue,onChange:W,isSearchable:!0,autoFocus:!x,menuIsOpen:x?void 0:!0,controlShouldRenderValue:!0,placeholder:"Search...",filterOption:Op({ignoreAccents:!0,ignoreCase:!0,trim:!0,matchFrom:"any"}),styles:{menu:Q=>({...Q,position:"static",boxShadow:"none",border:"none",marginTop:"0.5rem",borderRadius:0,backgroundColor:S?Dt.transparent:Dt.surface.white}),menuList:Q=>({...Q,maxHeight:"calc(100vh - 160px)",height:"auto",paddingBottom:"2rem",overflowY:"auto",overflowX:"auto",overscrollBehaviorY:"contain",overscrollBehaviorX:"contain",touchAction:"pan-y"}),option:(Q,Me)=>S?Q:{...Q,color:Z,backgroundColor:Me.isSelected?Dt.surface.gray200:Me.isFocused?Dt.surface.gray100:Dt.transparent},singleValue:Q=>({...Q,color:S?Q.color:Z}),input:Q=>({...Q,color:S?Q.color:Z}),placeholder:Q=>({...Q,color:S?Q.color:Se}),control:Q=>({...Q,borderColor:Dt.border.focusBlue,boxShadow:`0 0 0 1px ${Dt.border.focusBlue}`,backgroundColor:S?Q.backgroundColor:Dt.surface.white,color:S?Q.color:Z})},components:U,noOptionsMessage:()=>"No matches"})})]}):u.jsxs("div",{className:`${n} combo-control-root combo-control-inline`,children:[!d&&u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:o}),u.jsxs("div",{className:"combo-control-input-wrapper relative rs-scroll-target",ref:T,children:[u.jsx(jb,{className:se,classNamePrefix:"rs",options:Fe,value:ue,onChange:re,isSearchable:!0,isDisabled:c,filterOption:Op({ignoreAccents:!0,ignoreCase:!0,trim:!0,matchFrom:"any"}),menuPortalTarget:fe,menuPosition:"fixed",menuPlacement:"bottom",menuShouldScrollIntoView:!1,styles:{menuPortal:Q=>({...Q,zIndex:200}),menuList:Q=>({...Q,overflowY:"auto",overflowX:"auto",overscrollBehaviorY:"contain",overscrollBehaviorX:"contain",touchAction:"pan-y"}),option:(Q,Me)=>S?Q:{...Q,color:Z,backgroundColor:Me.isSelected?Dt.surface.gray200:Me.isFocused?Dt.surface.gray100:Dt.transparent},singleValue:Q=>({...Q,color:S?Q.color:Z}),input:Q=>({...Q,color:S?Q.color:Z}),placeholder:Q=>({...Q,color:S?Q.color:Se})},components:U,noOptionsMessage:()=>"No matches"}),u.jsxs("div",{className:"combo-control-icons absolute right-0 top-0 bottom-0 flex items-center pointer-events-none",children:[u.jsx("div",{className:"combo-control-chevron px-2 text-gray-400",children:u.jsx(Qu,{className:"w-5 h-5"})}),h&&u.jsx("div",{className:"combo-control-pin pointer-events-auto px-2",children:u.jsx(ma,{isPinned:p,onToggle:m})}),!h&&u.jsx("div",{className:"w-3"})]})]}),je&&u.jsx("div",{className:"mt-1 text-xs text-red-700",children:"Missing on ComfyUI server"}),ne&&u.jsxs("div",{className:"mt-2",children:[$,u.jsx("input",{ref:R,type:"file",accept:"image/*",className:"hidden",onChange:I})]})]})}function Bo({name:n,type:o,value:s,options:a,onChange:l,disabled:c=!1,hasError:d=!1,hideLabel:h=!1,compact:p=!1,forceModalOpen:m=!1,onModalClose:y,seedMode:x,onSeedModeChange:v,hasPin:k,isPinned:w=!1,onTogglePin:S,containerClass:j}){const[C,T]=b.useState(!1),R=()=>{c||T(!0)},D=()=>{T(!1),y?.()},L=o==="COMBO"||Array.isArray(a?.options),B=["INT","FLOAT"].includes(o.toUpperCase()),A=o.toUpperCase()==="STRING",F=n.replace(/_/g," "),te=k??(!!S||w),ee=j??"space-y-2 w-full",ae=j??(p?"mb-0":"mb-3"),ne={name:n,value:s,options:a,onChange:l,disabled:c,hideLabel:h,hasError:d,forceModalOpen:m,onModalClose:y,containerClass:ee,hasPin:te,isPinned:w,onTogglePin:S},me=()=>L?u.jsx(ju,{...ne}):B?u.jsx(ha,{...ne,type:o,seedMode:x,onSeedModeChange:v}):A?u.jsx(zf,{...ne}):u.jsxs("div",{className:"unsupported-widget-type text-xs text-gray-400 italic",children:["Unsupported: ",o]}),Le=m||C;if(o==="LM_LORA_HEADER"){const P=!!s;return u.jsx("div",{className:`${ae} lm-lora-header flex items-center justify-between p-3 bg-blue-50/50 dark:bg-blue-900/20 rounded-lg`,children:u.jsxs("div",{className:"lm-lora-header-content flex items-center gap-3",children:[u.jsx("button",{type:"button",role:"switch","aria-checked":P,onClick:()=>l(!P),className:`relative inline-flex h-6 w-11 items-center rounded-full transition ${P?"bg-blue-600":"bg-gray-300"} ${c?"opacity-60 cursor-not-allowed":"cursor-pointer"}`,disabled:c,children:u.jsx("span",{className:`inline-block h-5 w-5 transform rounded-full bg-white transition ${P?"translate-x-5":"translate-x-1"}`})}),u.jsx("span",{className:"lm-lora-header-label text-sm font-semibold text-blue-900 dark:text-blue-100 uppercase tracking-wider",children:"Toggle All Loras"})]})})}if(o==="LM_LORA"){const P=Vu(s||{name:"",strength:1,clipStrength:1,active:!0,expanded:!1}),V=a||{},H=Array.isArray(V.choices)?V.choices.map(O=>String(O)):[],ce=!!P.expanded||Math.abs(Number(P.clipStrength??P.strength)-Number(P.strength))>Number.EPSILON,ke=O=>{const _={...P,...O};_.expanded?_.clipStrength===void 0&&(_.clipStrength=_.strength):_.clipStrength=_.strength,l(_)},Ne=()=>{const O=!P.expanded;ke({expanded:O,clipStrength:O?P.clipStrength??P.strength:P.strength})};return u.jsxs("div",{className:`${ae} lm-lora-row flex flex-col gap-3 p-3 border border-gray-200 dark:border-gray-800 rounded-lg bg-gray-50/50 dark:bg-gray-900/50 ${P.active?"":"opacity-60"}`,children:[u.jsxs("div",{className:"lm-lora-row-actions flex items-center gap-2",children:[u.jsx("button",{type:"button",onClick:()=>ke({active:!P.active}),className:`lm-lora-enabled-button flex-1 py-2 rounded-lg text-sm font-semibold transition-colors ${P.active?"bg-blue-600 text-white":"bg-gray-700 text-white"} ${c?"opacity-60 cursor-not-allowed":""}`,disabled:c,children:P.active?"Enabled":"Disabled"}),u.jsx("button",{type:"button",onClick:()=>l(null),className:`lm-lora-remove-button flex-1 py-2 rounded-lg text-sm font-semibold bg-red-600 text-white hover:bg-red-700 transition-colors ${c?"opacity-60 cursor-not-allowed":""}`,disabled:c,children:"Remove"})]}),u.jsx("div",{className:"lm-lora-row-header flex items-center gap-3",children:u.jsx("div",{className:"lm-lora-select flex-grow min-w-0",children:H.length>0?u.jsx(ju,{containerClass:"space-y-0 w-full",name:"",hideLabel:!0,value:P.name,options:{options:H,stripSafetensorsSuffix:!0},onChange:O=>ke({name:String(O)}),disabled:c,hasPin:!1}):u.jsx(zf,{containerClass:"space-y-0 w-full",name:"",hideLabel:!0,value:P.name,options:{placeholder:"LoRA name"},onChange:O=>ke({name:String(O)}),disabled:c,hasPin:!1})})}),u.jsxs("div",{className:"lm-lora-strengths flex flex-col gap-2",children:[u.jsx(ha,{containerClass:"space-y-0",name:ce?"Model strength":"Strength",value:Number(P.strength),options:{min:-10,max:10,step:.01},onChange:O=>ke({strength:O}),disabled:c,type:"FLOAT"}),ce&&u.jsx(ha,{containerClass:"space-y-0",name:"Clip strength",value:Number(P.clipStrength??P.strength),options:{min:-10,max:10,step:.01},onChange:O=>ke({clipStrength:O}),disabled:c,type:"FLOAT"}),u.jsx("button",{type:"button",onClick:Ne,className:`lm-lora-clip-toggle py-2 px-3 border border-gray-200 rounded-lg text-sm font-medium text-gray-600 hover:text-blue-600 hover:border-blue-500 transition ${c?"opacity-60 cursor-not-allowed":""}`,disabled:c,children:ce?"Hide clip strength":"Separate clip strength"})]})]})}if(o==="LM_LORA_ADD"){const P=a||{},V=()=>{l(Pb(P.choices))};return u.jsx("div",{className:`${ae} lm-lora-add`,children:u.jsxs("button",{onClick:V,className:"w-full py-2 px-4 border-2 border-dashed border-gray-300 dark:border-gray-700 rounded-lg text-sm font-medium text-gray-500 hover:text-blue-500 hover:border-blue-500 transition-all flex items-center justify-center gap-2",disabled:c,children:[u.jsx(Io,{className:"w-5 h-5"}),"Add Lora"]})})}if(o==="TW_WORD"){const V=!!(a||{}).allowStrengthAdjustment,H=Eu(s||{text:"",active:!0,strength:null},{allowStrengthAdjustment:V}),ce=ke=>{const Ne={...H,...ke};V||(Ne.strength=null),l(Ne)};return u.jsxs("div",{className:`${ae} tw-word-row flex flex-col gap-2 p-3 border border-gray-200 dark:border-gray-800 rounded-lg bg-gray-50/60 dark:bg-gray-900/50 ${H.active?"":"opacity-60"}`,children:[u.jsxs("div",{className:"tw-word-header flex items-center justify-between gap-3",children:[u.jsx("div",{className:"min-w-0",children:u.jsx("div",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 break-words",children:H.text||"Trigger Word"})}),u.jsx("button",{type:"button",onClick:()=>ce({active:!H.active}),className:`tw-word-toggle px-3 py-1.5 rounded-lg text-xs font-semibold transition-colors ${H.active?"bg-blue-600 text-white":"bg-gray-700 text-white"} ${c?"opacity-60 cursor-not-allowed":""}`,disabled:c,children:H.active?"Enabled":"Disabled"})]}),V&&u.jsx(ha,{containerClass:"space-y-0",name:"Strength",value:Number(H.strength??1),options:{min:0,max:10,step:.01},onChange:ke=>ce({strength:ke}),disabled:c,type:"FLOAT"})]})}if(o==="POWER_LORA_HEADER")return u.jsx("div",{className:`${ae} power-lora-header flex items-center justify-between p-3 bg-blue-50/50 dark:bg-blue-900/20 rounded-lg`,children:u.jsxs("div",{className:"power-lora-header-content flex items-center gap-3",children:[u.jsx("input",{type:"checkbox",onChange:P=>l(P.target.checked),className:"w-5 h-5 rounded cursor-pointer",disabled:c}),u.jsx("span",{className:"power-lora-header-label text-sm font-semibold text-blue-900 dark:text-blue-100 uppercase tracking-wider",children:"Toggle All Loras"})]})});if(o==="POWER_LORA"){const P=s||{on:!0,lora:"",strength:1},V=a||{},H=V.choices,ce=V.showSeparate,ke=(Ne,O)=>{l({...P,[Ne]:O})};return u.jsxs("div",{className:`${ae} power-lora-row flex flex-col gap-2 p-3 border border-gray-200 dark:border-gray-800 rounded-lg bg-gray-50/50 dark:bg-gray-900/50 ${P.on?"":"opacity-60"}`,children:[u.jsxs("div",{className:"power-lora-row-actions flex items-center gap-2",children:[u.jsx("button",{type:"button",onClick:()=>ke("on",!P.on),className:`power-lora-enabled-button flex-1 py-2 rounded-lg text-sm font-semibold transition-colors ${P.on?"bg-blue-600 text-white":"bg-gray-700 text-white"} ${c?"opacity-60 cursor-not-allowed":""}`,disabled:c,children:P.on?"Enabled":"Disabled"}),u.jsx("button",{type:"button",onClick:()=>l(null),className:`power-lora-remove-button flex-1 py-2 rounded-lg text-sm font-semibold bg-red-600 text-white hover:bg-red-700 transition-colors ${c?"opacity-60 cursor-not-allowed":""}`,disabled:c,children:"Remove"})]}),u.jsx("div",{className:"power-lora-row-header flex items-center gap-3",children:u.jsx("div",{className:"power-lora-select flex-grow min-w-0",children:u.jsx(Bo,{name:"",hideLabel:!0,compact:!0,type:"COMBO",value:P.lora,options:H,onChange:Ne=>ke("lora",Ne),disabled:c})})}),u.jsxs("div",{className:"power-lora-strengths flex flex-col",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 ml-1",children:ce?"Model strength":"Strength"}),u.jsx("div",{className:"power-lora-strength-row flex items-center gap-3",children:u.jsx("div",{className:"power-lora-strength-input flex-grow",children:u.jsx(Bo,{name:"",hideLabel:!0,compact:!0,type:"FLOAT",value:P.strength,options:{min:-10,max:10,step:.01},onChange:Ne=>ke("strength",Ne),disabled:c})})}),ce&&u.jsx("label",{className:"block text-sm font-medium text-gray-700 ml-1",children:"Clip strength"}),ce&&u.jsx("div",{className:"power-lora-strength-row flex items-center gap-3",children:u.jsx("div",{className:"power-lora-strength-input flex-grow",children:u.jsx(Bo,{name:"",hideLabel:!0,compact:!0,type:"FLOAT",value:P.strengthTwo??P.strength,options:{min:-10,max:10,step:.01},onChange:Ne=>ke("strengthTwo",Ne),disabled:c})})})]})]})}if(o==="POWER_LORA_ADD"){const P=()=>{l({on:!0,lora:"None",strength:1,model_strength:1,clip_strength:1})};return u.jsx("div",{className:`${ae} power-lora-add`,children:u.jsxs("button",{onClick:P,className:"w-full py-2 px-4 border-2 border-dashed border-gray-300 dark:border-gray-700 rounded-lg text-sm font-medium text-gray-500 hover:text-blue-500 hover:border-blue-500 transition-all flex items-center justify-center gap-2",disabled:c,children:[u.jsx(Io,{className:"w-5 h-5"}),"Add Lora"]})})}return A?u.jsx(zf,{...ne}):L?u.jsx(ju,{...ne}):B?u.jsx(ha,{...ne,type:o,seedMode:x,onSeedModeChange:v}):o.toUpperCase()==="BOOLEAN"?u.jsx(ju,{...ne,value:String(!!s),options:["true","false"],onChange:P=>l(String(P).toLowerCase()==="true")}):u.jsxs("div",{id:`widget-control-${n}`,className:`widget-control-root ${p?"compact-control":""}`,children:[!h&&u.jsxs("div",{id:`widget-label-container-${n}`,className:"flex items-center justify-between mb-1.5 px-1",children:[u.jsx("label",{id:`widget-label-${n}`,className:"text-[10px] font-bold text-gray-500 uppercase tracking-wider truncate mr-2",children:F}),d&&u.jsx("div",{id:`widget-error-icon-${n}`,className:"text-red-500",title:"Error in this input",children:u.jsx(fx,{className:"w-3.5 h-3.5"})})]}),u.jsx("div",{id:`widget-trigger-${n}`,className:`
          control-trigger
          relative flex items-center justify-between
          bg-gray-50 border border-gray-200 rounded-xl px-3 py-2.5
          active:bg-gray-100 active:border-gray-300 transition-all
          ${c?"opacity-50 grayscale pointer-events-none":"cursor-pointer"}
          ${d?"border-red-300 bg-red-50/30":""}
        `,onClick:R,children:u.jsx("div",{id:`widget-value-display-${n}`,className:"value-display flex-1 truncate text-sm font-medium text-gray-900",children:L?s||"Select...":s!=null?String(s):"Empty"})}),u.jsx(Jp,{isOpen:Le,title:F,onClose:D,children:u.jsx("div",{id:`modal-control-wrapper-${n}`,className:"p-2",children:me()})})]})}const Y4="__mobile_origin";function Ml(n){if(!n)return null;const s=n.properties?.[Y4];if(!s||typeof s!="object")return null;const a=s.scope;if(a==="root"){const l=s.nodeId;return typeof l=="number"?{scope:"root",nodeId:l}:null}if(a==="subgraph"){const l=s.nodeId,c=s.subgraphId;if(typeof l=="number"&&typeof c=="string")return{scope:"subgraph",subgraphId:c,nodeId:l}}return null}function Mb(n,o,s){const a=s??"root",l=Ml(n);return l?.scope==="subgraph"?a!=="root"&&l.subgraphId===a&&l.nodeId===o:l?.scope==="root"?a==="root"&&l.nodeId===o:a==="root"&&n.id===o}function Q4(n){const o=Ml(n);return mn({type:"node",nodeId:n.id,subgraphId:o?.scope==="subgraph"?o.subgraphId:null})}function X4(n,o){if(!n)return null;if(n[o])return o;const s=Object.entries(n).find(([,a])=>a.display_name===o||a.name===o);return s?s[0]:null}function Ob(n){return vr(n)||Hu(n)||Dp(n)||Tu(n)||Cs(n)}function Z4(n,o){return n?.nodes.some(s=>Ob(s.type))?!0:o?Object.entries(o).some(([s,a])=>[s,a.name,a.display_name].filter(c=>typeof c=="string"&&c.length>0).some(c=>Ob(c))):!1}const yr=vo((n,o)=>{const s=()=>{const{workflow:v,nodeTypes:k}=de.getState(),w=Z4(v,k);return o().isLoraManagerAvailable!==w&&n({isLoraManagerAvailable:w}),w},a=v=>{if(typeof v.stableKey=="string"&&v.stableKey)return v.stableKey;const k=Q4(v);return de.getState().stableKeyByPointer[k]??null},l=v=>{if(typeof v=="number")return v;if(typeof v=="string"){const k=Number(v);return Number.isFinite(k)?k:null}return null},c=(v,k,w)=>{const S=k.node_id??k.id,j=typeof k.graph_id=="string"?k.graph_id:null,C=l(S);return C===null?[]:C===-1&&w?.allowBroadcastToLoraNodes?v.nodes.filter(R=>vr(R.type)):v.nodes.filter(R=>Mb(R,C,j))},d=(v,k=null)=>{if(!s())return;const{workflow:w,nodeTypes:S}=de.getState();if(!w)return;const j=w.nodes.find(P=>Mb(P,v,k));if(!j)return;const C=Hu(j.type),T=Tu(j.type),R=Dp(j.type);if(!C&&!T&&!R)return;const D=new Map(w.nodes.map(P=>[P.id,P])),L=new Map(w.links.map(P=>[P[0],P])),B=P=>!!P&&typeof P=="object"&&!Array.isArray(P),A=P=>P.mode===void 0||P.mode===0||P.mode===3,F=P=>{const V=Ml(P);return{node_id:V?.nodeId??P.id,graph_id:V?.scope==="subgraph"?V.subgraphId:"root"}},te=P=>{const V=[];for(const H of P.outputs??[]){const ce=H.links??[];for(const ke of ce){const Ne=L.get(ke);if(!Ne)continue;const O=D.get(Ne[3]);O&&Cs(O.type)&&V.push(O)}}return V},ee=(P,V)=>{const H=te(P);if(H.length===0)return;const ce=[],ke=new Set;for(const Ne of H){const O=F(Ne),_=`${O.graph_id}:${O.node_id}`;ke.has(_)||(ke.add(_),ce.push(O))}ce.length!==0&&qw(Array.from(V),ce).catch(Ne=>{console.warn("[LoraManager] Failed to request trigger words:",Ne)})},ae=P=>{const V=new Set;if(d2(P.type)){if(!Array.isArray(P.widgets_values))return V;const O=P.widgets_values;let _=null;if(S){const q=Vn(w,S,P,"cycler_config");q!==null&&(_=O[q])}if(_||(_=O.find(q=>B(q)&&(typeof q.current_lora_filename=="string"||typeof q.current_lora_name=="string"))),B(_)){const q=typeof _.current_lora_filename=="string"?_.current_lora_filename:typeof _.current_lora_name=="string"?_.current_lora_name:"";q&&V.add(q)}return V}if(!Array.isArray(P.widgets_values))return V;const H=S?Vn(w,S,P,"text"):null,ce=Ns(P,H);if(ce===null)return V;const ke=P.widgets_values[ce],Ne=Ku(ke)??(Array.isArray(ke)?ke:null);return Ne&&Ne.forEach(O=>{!O||typeof O.name!="string"||O.active!==!1&&V.add(O.name)}),V},ne=P=>{const V=[];for(const H of P.inputs??[]){if(H.name!=="lora_stack"||H.link==null)continue;const ce=$p(w,H.link);if(!ce)continue;const ke=D.get(ce.nodeId);ke&&Tu(ke.type)&&V.push(ke)}return V},me=(P,V=new Set)=>{if(V.has(P.id))return new Set;V.add(P.id);const H=new Set;A(P)&&ae(P).forEach(Ne=>H.add(Ne));const ce=ne(P);for(const ke of ce)me(ke,V).forEach(O=>H.add(O));return H},Le=(P,V=new Set)=>{if(!V.has(P.id)){V.add(P.id);for(const H of P.outputs??[]){const ce=H.links??[];for(const ke of ce){const Ne=L.get(ke);if(!Ne)continue;const O=D.get(Ne[3]);if(O){if(Hu(O.type)){const _=me(O);ee(O,_);continue}if(Tu(O.type)){Le(O,V);continue}(O.type==="Reroute"||O.mode===4)&&Le(O,V)}}}}};if(C){const P=me(j);ee(j,P);return}if(T){const P=A(j)?ae(j):new Set;ee(j,P),Le(j);return}if(R){const P=A(j)?ae(j):new Set;ee(j,P)}},h=v=>{const k=Ml(v),w=k?.nodeId??v.id,S=k?.scope==="subgraph"?k.subgraphId:"root";d(w,S)};return{isLoraManagerAvailable:!1,refreshLoraManagerAvailability:s,applyLoraCodeUpdate:v=>{if(!s())return;const{workflow:k,nodeTypes:w,updateNodeWidgets:S}=de.getState();if(!k)return;const j=typeof v.lora_code=="string"?v.lora_code:"",C=v.mode==="replace"?"replace":"append";if(!j)return;c(k,v,{allowBroadcastToLoraNodes:!0}).forEach(R=>{const D=w?Vn(k,w,R,"text"):null,L=Ns(R,D);if(D===null&&L===null)return;const B=Array.isArray(R.widgets_values)?R.widgets_values:[],A=D!==null?String(B[D]??""):"",F=C==="replace"?j:A.trim()?`${A.trim()} ${j}`:j,te=L!==null&&Array.isArray(B[L])?B[L]:[],ee=ap(F,te),ae={};if(D!==null&&(ae[D]=F),L!==null&&(ae[L]=ee),Object.keys(ae).length>0){const ne=a(R);if(!ne)return;S(ne,ae),h(R)}})},applyTriggerWordUpdate:v=>{if(!s())return;const{workflow:k,nodeTypes:w,updateNodeWidgets:S}=de.getState();if(!k||!w||typeof v.message!="string")return;const j=v.message;c(k,v).forEach(T=>{if(!Cs(T.type)||!Array.isArray(T.widgets_values))return;const R=Vn(k,w,T,"group_mode"),D=Vn(k,w,T,"default_active"),L=Vn(k,w,T,"allow_strength_adjustment"),B=R!==null?!!T.widgets_values[R]:!0,A=D!==null?!!T.widgets_values[D]:!0,F=L!==null?!!T.widgets_values[L]:!1,te=Vn(k,w,T,"toggle_trigger_words"),ee=te!==null?te:ac(T);if(ee===null)return;const ae=Hl(T.widgets_values[ee])??$l(T.widgets_values[ee])??[],ne=lp(j,{groupMode:B,defaultActive:A,allowStrengthAdjustment:F,existingList:ae}),me={[ee]:ne},Le=k.widget_idx_map?.[String(T.id)],P=Le?.originalMessage??Le?.orinalMessage,V=P!==void 0?P:Bp(T,ee);V!==null&&zp(T.widgets_values[V])!==j&&(me[V]=j);const H=a(T);H&&S(H,me)})},applyWidgetUpdate:v=>{if(!s())return;const{workflow:k,nodeTypes:w,updateNodeWidget:S,updateNodeWidgets:j}=de.getState();if(!k)return;const C=typeof v.widget_name=="string"?v.widget_name:"",T=v.value;if(!C)return;c(k,v).forEach(D=>{const L=a(D);if(!L)return;const B=ee=>{let ae=null;if(w&&(ae=Vn(k,w,D,ee)),ae===null){const me=k.widget_idx_map?.[String(D.id)]?.[ee];ae=me!==void 0?me:null}return ae===null&&ee==="loras"&&(ae=Ns(D)),ae};let A=T;if(w){const ee=w[D.type],ne=(ee?.input?.required?.[C]||ee?.input?.optional?.[C])?.[0];if(Array.isArray(ne)){const me=Kl(T,ne);me!==void 0&&(A=me)}}if(!Array.isArray(D.widgets_values)){S(L,0,A,C);return}const F=B(C),te=vr(D.type);if(te&&C==="text"&&typeof A=="string"){const ee=Ns(D,F);if(ee!==null){const ae=Array.isArray(D.widgets_values[ee])?D.widgets_values[ee]:[],ne=ap(A,ae),me={};F!==null&&(me[F]=A),me[ee]=ne,j(L,me),h(D);return}}if(te&&C==="loras"){const ee=F,ae=Ku(A)??(Array.isArray(A)?A:null),ne=B("text"),me={};if(ee!==null&&(me[ee]=A),ne!==null&&ae){const Le=typeof D.widgets_values[ne]=="string"?D.widgets_values[ne]:"";me[ne]=Yb(Le,ae)}if(Object.keys(me).length>0){j(L,me),h(D);return}}F!==null&&(S(L,F,A,C),te&&(C==="cycler_config"||C==="randomizer_config")&&h(D))})},syncTriggerWordsForNode:d,registerLoraManagerNodes:async()=>{if(!s())return;const{workflow:v,nodeTypes:k}=de.getState();if(!v)return;const w=new Set(["ckpt_name","unet_name"]),S=[];if(v.nodes.forEach(j=>{const C=Ml(j),T=C?.nodeId??j.id,R=C?.scope==="subgraph"?C.subgraphId:"root",D=vr(j.type),L=X4(k,j.type),B=L?k?.[L]:null,A=new Set,F=B?.input?.required??{},te=B?.input?.optional??{};Object.keys(F).forEach(Le=>A.add(Le)),Object.keys(te).forEach(Le=>A.add(Le)),D&&A.add("loras");const ee=Array.from(A).some(Le=>w.has(Le));if(!D&&!ee)return;const ae=j.title,ne=j.properties?.title,me=typeof ae=="string"&&ae.trim()?ae.trim():typeof ne=="string"&&ne.trim()?ne.trim():j.type;S.push({node_id:T,graph_id:R,graph_name:null,bgcolor:j.bgcolor??j.color??null,title:me,type:j.type,comfy_class:j.type,capabilities:{supports_lora:D,widget_names:Array.from(A)}})}),S.length!==0)try{await Fw(S)}catch(j){console.warn("[LoraManager] Failed to register nodes:",j)}}}});function J4({node:n,isBypassed:o,isKSampler:s,workflowExists:a,nodeTypesExists:l,visibleInputWidgets:c,visibleWidgets:d,errorInputNames:h,onUpdateNodeWidget:p,onUpdateNodeWidgets:m,getWidgetIndexForInput:y,findSeedWidgetIndex:x,setSeedMode:v,isWidgetPinned:k,toggleWidgetPin:w}){const S=Array.isArray(n.widgets_values)?n.widgets_values:[],j=de(M=>M.nodeTypes),C=de(M=>M.workflow),T=yr(M=>M.syncTriggerWordsForNode),R=de(M=>M.bypassAllInContainer),D=Qn(M=>M.seedModes[n.id]),L=Qn(M=>M.seedLastValues[n.id]??null),B=/fast\s+groups/i.test(n.type)&&/\(rgthree\)/i.test(n.type),A=vr(n.type),F=Cs(n.type),te=!s&&a&&l?x():null,ee=te!==null?te+1:null,ae=ee!==null?S[ee]:void 0,ne=typeof ae=="string",me=!s&&te!==null&&!ne,Le=me?c.filter(M=>M.name!=="seed"&&M.name!=="noise_seed"):c,P=me?d.filter(M=>M.name!=="seed"&&M.name!=="noise_seed"):d,V=d.length>0||c.length>0,H=b.useMemo(()=>{if(!B||!C)return[];const M=n.properties??{},re=(...he)=>{for(const Qe of he){const ut=M[Qe];if(typeof ut=="string")return ut}return""},W=(he,...Qe)=>{for(const ut of Qe){const it=M[ut];if(typeof it=="boolean")return it}return he},G=re("matchColors","match_colors"),I=re("matchTitle","match_title"),$=W(!0,"showAllGraphs","show_all_graphs"),Z=re("sort","sort_mode")||"position",Se=re("customSortAlphabet","custom_sort_alphabet"),Q=Dt.workflow.fastGroupBypassColors,Me=G.split(",").map(he=>he.trim()).filter(Boolean).flatMap(he=>Ry(he,Q)),K=new Set(Me),Te=Me.map(he=>Al(he)??bx(he)).filter(he=>!!he).map(he=>Dy(he)).filter(he=>!!he);let _e=null;if(I.trim())try{_e=new RegExp(I,"i")}catch(he){return console.error(he),[]}let qe=null;if(Z==="custom alphabet"){const he=Se.replace(/\n/g,"").trim().toLowerCase();he&&(qe=he.includes(",")?he.split(",").map(Qe=>Qe.trim()).filter(Boolean):he.split("")),qe?.length||(qe=null)}const Ge=new Map(C.nodes.map(he=>[he.id,he])),Ve=[],Je=he=>{if(K.size>0){const Qe=he.color?Ry(he.color,Q):[],ut=he.color?Al(he.color):null,it=ut?Dy(ut):null,_t=Qe.some(wt=>K.has(wt))||(ut?K.has(ut):!1),Ot=!!(it&&Te.some(wt=>{const It=Math.abs(wt.h-it.h);return Math.min(It,360-It)<=25}));if(!_t&&!Ot)return!1}return!(_e&&!_e.test(he.title||""))},Ue=(he,Qe)=>{if(!Je(he))return;const ut=rn(he.stableKey,`group ${he.id}${Qe?` in subgraph ${Qe}`:" in root graph"}`),it=dp(C,he.id,Qe);let _t=!1;for(const Ot of it){const wt=Ge.get(Ot);if(!(!wt||wt.mode===4)){_t=!0;break}}Ve.push({key:`${Qe??"root"}-${he.id}`,label:he.title?.trim()||`Group ${he.id}`,stableKey:ut,color:he.color,isEngaged:_t,isDisabled:it.size===0,group:he})},Xe=n.properties?.__mobile_origin,Pe=Xe?.scope==="subgraph"?Xe.subgraphId:null;if($){for(const he of C.groups??[])Ue(he,null);for(const he of C.definitions?.subgraphs??[])for(const Qe of he.groups??[])Ue(Qe,he.id)}else if(Pe){const he=C.definitions?.subgraphs?.find(Qe=>Qe.id===Pe);for(const Qe of he?.groups??[])Ue(Qe,Pe)}else for(const he of C.groups??[])Ue(he,null);return Z==="alphanumeric"?Ve.sort((he,Qe)=>he.label.localeCompare(Qe.label)):qe?.length?Ve.sort((he,Qe)=>{const ut=he.label.toLowerCase(),it=Qe.label.toLowerCase();let _t=-1,Ot=-1;for(const[wt,It]of qe.entries())if(_t<0&&ut.startsWith(It)&&(_t=wt),Ot<0&&it.startsWith(It)&&(Ot=wt),_t>-1&&Ot>-1)break;if(_t>-1&&Ot>-1){const wt=_t-Ot;return wt===0?ut.localeCompare(it):wt}return _t>-1?-1:Ot>-1?1:ut.localeCompare(it)}):Ve.sort((he,Qe)=>{const ut=he.group.bounding,it=Qe.group.bounding;return ut[1]!==it[1]?ut[1]-it[1]:ut[0]-it[0]}),Ve},[B,n.properties,C]),ce=M=>()=>{M.isDisabled||R(M.stableKey,M.isEngaged)},ke=M=>{typeof M=="string"&&["fixed","randomize","increment","decrement"].includes(M)&&v(n.id,M)},Ne=M=>re=>{p(M,re),ke(re)},O=M=>re=>{p(M,re,"seed"),v(n.id,"fixed")},_=M=>()=>{if(!j)return;const re=Ol(j,n);p(M,re,"seed"),v(n.id,"fixed")},q=M=>()=>{typeof L=="number"&&(p(M,L,"seed"),v(n.id,"fixed"))},je=(M,re)=>{const W={[M]:re};if(C&&j){const G=y("text");if(G!==null&&Array.isArray(n.widgets_values)){const I=n.widgets_values[G],$=Yb(typeof I=="string"?I:"",re);W[G]=$}}m(W),oe()},Ke=M=>{if(!Array.isArray(n.widgets_values))return[];const re=n.widgets_values[M];return Ku(re)??[]},De=(M,re,W)=>{const G={[M]:re,...W??{}};m(G)},Fe=M=>{if(!Array.isArray(n.widgets_values))return[];const re=n.widgets_values[M];return Hl(re)??$l(re)??[]},ue=M=>{if(!Array.isArray(n.widgets_values))return"";const re=C?.widget_idx_map?.[String(n.id)],W=re?.originalMessage??re?.orinalMessage,G=W!==void 0?W:Bp(n,M);if(G===null)return"";const I=n.widgets_values[G];return zp(I)??""},ye=()=>{const M=y("group_mode"),re=y("default_active"),W=y("allow_strength_adjustment"),G=M!==null?!!S[M]:!0,I=re!==null?!!S[re]:!0,$=W!==null?!!S[W]:!1;return{groupMode:G,defaultActive:I,allowStrengthAdjustment:$}},et=()=>{const M=y("toggle_trigger_words");return M!==null?M:ac(n)},oe=()=>{const M=n.properties?.__mobile_origin,re=M?.scope==="subgraph"?M.subgraphId??null:"root",W=typeof M?.nodeId=="number"?M.nodeId:n.id;T(W,re)},z=M=>re=>{p(M.widgetIndex,re,M.name)},U=(M,re)=>!(M.startsWith("LM_LORA")||M.startsWith("TW_")||A&&re==="text"),se=M=>re=>{if(M.type==="TW_WORD"){const W=M.widgetIndex,G=M.options?.entryIndex;if(G==null)return;const I=Fe(W);if(!I[G])return;if(typeof re=="object"&&re){const $=ye(),Z=[...I];Z[G]=Eu({...Z[G],...re},{defaultActive:$.defaultActive,allowStrengthAdjustment:$.allowStrengthAdjustment}),De(W,Z)}return}if(F&&M.name==="default_active"&&typeof re=="boolean"){const W=et();if(W!==null){const I=Fe(W).map($=>({...$,active:re}));De(W,I,{[M.widgetIndex]:re});return}}if(F&&M.name==="group_mode"&&typeof re=="boolean"){const W=et();if(W!==null){const G=Fe(W),I=ye(),$=ue(W),Z=$?lp($,{groupMode:re,defaultActive:I.defaultActive,allowStrengthAdjustment:I.allowStrengthAdjustment,existingList:G}):G.map(Se=>Eu(Se,{defaultActive:I.defaultActive,allowStrengthAdjustment:I.allowStrengthAdjustment}));De(W,Z,{[M.widgetIndex]:re});return}}if(F&&M.name==="allow_strength_adjustment"&&typeof re=="boolean"){const W=et();if(W!==null){const G=Fe(W),I=ye(),$=ue(W),Z=$?lp($,{groupMode:I.groupMode,defaultActive:I.defaultActive,allowStrengthAdjustment:re,existingList:G}):G.map(Se=>Eu(Se,{defaultActive:I.defaultActive,allowStrengthAdjustment:re}));De(W,Z,{[M.widgetIndex]:re});return}}if(M.type==="LM_LORA_HEADER"&&typeof re=="boolean"){const W=M.widgetIndex,G=Ke(W);if(G.length===0)return;const I=G.map($=>({...$,active:re}));je(W,I);return}if(M.type==="LM_LORA"){const W=M.widgetIndex,G=M.options?.entryIndex;if(G==null)return;const I=Ke(W);if(!I[G])return;if(re===null){const $=I.filter((Z,Se)=>Se!==G);je(W,$);return}if(typeof re=="object"&&re){const $=[...I];$[G]=Vu({...$[G],...re}),je(W,$)}return}if(M.type==="LM_LORA_ADD"){const W=M.widgetIndex,G=Ke(W),I=typeof re=="object"&&re?Vu(re):Pb(M.options?.choices);je(W,[...G,I]);return}if(A&&M.name==="text"&&typeof re=="string"){const W=Ns(n,M.widgetIndex);if(W!==null){const G=Ke(W),I=ap(re,G);m({[M.widgetIndex]:re,[W]:I}),oe();return}}if(M.type==="POWER_LORA_HEADER"&&typeof re=="boolean"){const{loraIndices:W}=M.options||{};if(W){const G={},I=n.widgets_values;Array.isArray(I)&&(W.forEach($=>{const Z=I[$];G[$]={...Z,on:re}}),m(G))}}else p(M.widgetIndex,re,M.name)},fe=(M,re)=>{const W=M.options;let G=null;if(W&&typeof W=="object"&&!Array.isArray(W)){const $=W.entryIndex;typeof $=="number"&&Number.isFinite($)&&(G=$)}const I=G!==null?G:M.name||M.type;return`${re}-${M.widgetIndex}-${M.type}-${I}`};return!V&&H.length===0?null:u.jsxs("div",{className:"node-parameters mb-2",children:[H.length>0&&u.jsxs("div",{className:"mb-4",children:[u.jsx("div",{className:"text-xs text-gray-400 dark:text-gray-300 mb-1.5 uppercase tracking-wide",children:"Groups"}),u.jsx("div",{className:"space-y-2",children:H.map(M=>u.jsxs("div",{className:`flex items-center justify-between gap-3 rounded-lg border px-3 py-2 bg-gray-50/40 dark:bg-gray-900/60 ${M.isDisabled?"border-gray-200 dark:border-white/10 opacity-60":"border-gray-200 dark:border-white/15"}`,children:[u.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[u.jsx("span",{className:"h-2.5 w-2.5 rounded-full",style:{backgroundColor:M.color||Dt.workflow.defaultGroupDot}}),u.jsx("span",{className:"text-sm font-medium text-gray-800 dark:text-gray-100 truncate",children:M.label})]}),u.jsx("button",{type:"button",role:"switch","aria-checked":M.isEngaged,onClick:ce(M),className:`relative inline-flex h-6 w-11 items-center rounded-full transition ${M.isEngaged?"bg-emerald-500":"bg-gray-300"} ${M.isDisabled?"cursor-not-allowed":"cursor-pointer"}`,children:u.jsx("span",{className:`inline-block h-5 w-5 transform rounded-full bg-white transition ${M.isEngaged?"translate-x-5":"translate-x-1"}`})})]},M.key))})]}),V&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"text-xs text-gray-500 mb-1.5 uppercase tracking-wide",children:"Parameters"}),s&&a&&l&&(()=>{const M=y("seed");if(M===null)return null;const re=S[M],W=M+1,G=S[W],I=["fixed","increment","decrement","randomize"],Z=!!n.inputs.find(Se=>Se.name==="noise_seed")?.link;return u.jsxs("div",{className:"mb-3",children:[u.jsx(Bo,{name:"seed",type:"INT",value:re,onChange:Se=>p(M,Se,"seed"),disabled:o,hasError:h.has("seed")}),W<S.length&&!Z&&u.jsx(Bo,{name:"Control mode",type:"COMBO",value:G,options:I,onChange:Ne(W)})]})})(),!s&&a&&l&&(()=>{const M=te;if(M===null)return null;const re=["fixed","randomize","increment","decrement"],W=typeof ae=="string"&&!re.includes(ae)?[...re,ae]:re;if(n.inputs.find(Ge=>Ge.name==="seed"||Ge.name==="noise_seed")?.link!=null)return null;if(ne){const Ge=M+1;return u.jsx("div",{className:"mb-3",children:u.jsx(Bo,{name:"Seed control",type:"COMBO",value:ae,options:W,onChange:Ne(Ge)})})}const $=c.find(Ge=>Ge.name==="seed"||Ge.name==="noise_seed")?.options??{},Z=typeof $.min=="number"?$.min:void 0,Se=typeof $.max=="number"?$.max:void 0,Q=typeof $.step=="number"?$.step:void 0,Me=Number(S[M]??0),K=Zb(Me),Te=D??K??"fixed",_e=Vp(Me)?typeof L=="number"?L:0:Me,qe=h.has("seed")||h.has("noise_seed");return u.jsxs("div",{className:"mb-3",children:[u.jsx(ha,{name:"seed",value:_e,onChange:O(M),disabled:o,min:Z,max:Se,step:Q,hasError:qe}),u.jsx(Bo,{name:"Seed control",type:"COMBO",value:Te,options:re,onChange:ke}),u.jsxs("div",{className:"grid gap-2 mt-2",children:[u.jsx("button",{type:"button",className:"w-full py-2 px-3 border border-gray-200 rounded-lg text-sm font-medium text-gray-600 hover:text-blue-600 hover:border-blue-500 transition",onClick:()=>v(n.id,"randomize"),disabled:o,children:"Randomize each time"}),u.jsx("button",{type:"button",className:"w-full py-2 px-3 border border-gray-200 rounded-lg text-sm font-medium text-gray-600 hover:text-blue-600 hover:border-blue-500 transition",onClick:_(M),disabled:o,children:"New fixed random"}),u.jsx("button",{type:"button",className:"w-full py-2 px-3 border border-gray-200 rounded-lg text-sm font-medium text-gray-600 hover:text-blue-600 hover:border-blue-500 transition",onClick:q(M),disabled:o||typeof L!="number",children:"Use last queued seed"})]})]})})(),Le.map(M=>u.jsx("div",{className:o?"opacity-80":"",children:u.jsx(Bo,{name:M.name,type:M.type,value:M.value,options:M.options,onChange:z(M),disabled:o,isPinned:U(M.type,M.name)?k(M.widgetIndex):!1,onTogglePin:U(M.type,M.name)?()=>w(M.widgetIndex,M.name,M.type,M.options):void 0,hasError:h.has(M.name)})},fe(M,"input-widget"))),P.map(M=>u.jsx("div",{className:o?"opacity-80":"",children:u.jsx(Bo,{name:M.name,type:M.type,value:M.value,options:M.options,onChange:se(M),disabled:o,isPinned:U(M.type,M.name)?k(M.widgetIndex):!1,onTogglePin:U(M.type,M.name)?()=>w(M.widgetIndex,M.name,M.type,M.options):void 0,hasError:h.has(M.name)})},fe(M,"widget"))),n.type==="PrimitiveNode"&&(()=>{const M=n.outputs?.[0]?.type,re=String(M).toUpperCase();if(re!=="INT"&&re!=="FLOAT"||S.length<2)return null;const W=S[1],G=["fixed","increment","decrement","randomize"];return u.jsx("div",{className:"mb-3",children:u.jsx(Bo,{name:"Control mode",type:"COMBO",value:W,options:G,onChange:I=>p(1,I),disabled:o})})})()]})]})}function e5(n,o,s){if(!o)return null;const a=Vn(n,o,s,"image")??Vn(n,o,s,"filename")??Vn(n,o,s,"file");if(a==null||!Array.isArray(s.widgets_values))return null;const l=s.widgets_values[a];return t5(l)}function t5(n){if(typeof n=="string"&&n.trim()){const{filename:h,subfolder:p}=Tb(n.trim());return{filename:h,subfolder:p,type:"input"}}if(!n||typeof n!="object")return null;const o=n,s=typeof o.filename=="string"?o.filename:typeof o.name=="string"?o.name:null;if(!s||!s.trim())return null;const a=typeof o.subfolder=="string"?o.subfolder:"",l=typeof o.type=="string"?o.type:"input",{filename:c,subfolder:d}=Tb(s.trim());return{filename:c,subfolder:a||d,type:l}}function Tb(n){const o=n.replace(/^\/+/,""),s=o.split("/").filter(Boolean);return s.length<=1?{filename:o,subfolder:""}:{filename:s.pop()??o,subfolder:s.join("/")}}const n5=[],o5=b.memo(function({node:o,isExecuting:s,isConnectionHighlighted:a=!1,errorBadgeLabel:l,onImageClick:c,inGroup:d=!1,onMoveNode:h}){const p=de(pe=>pe.nodeTypes),m=de(pe=>pe.workflow),y=de(pe=>pe.updateNodeWidget),x=de(pe=>pe.updateNodeWidgets),v=de(pe=>pe.updateNodeTitle),k=de(pe=>pe.toggleBypass),w=de(pe=>pe.setItemCollapsed),S=de(pe=>pe.setItemHidden),j=de(pe=>pe.collapsedItems),C=rn(o.stableKey,`node ${o.id}`),T=de(pe=>pe.setConnectionHighlightMode),R=de(pe=>pe.connectionHighlightModes[o.id]??"off"),D=Qn(pe=>pe.setSeedMode),L=de(pe=>pe.currentWorkflowKey),B=yo(pe=>pe.pinnedWidget?.nodeId===o.id?pe.pinnedWidget:null),A=yo(pe=>pe.setPinnedWidget),F=Xn(pe=>pe.bookmarkedItems),te=Xn(pe=>pe.toggleBookmark),ee=de(pe=>pe.nodeOutputs[String(o.id)]),ae=de(pe=>pe.nodeTextOutputs[String(o.id)]??null),ne=gn(pe=>pe.nodeErrors[String(o.id)]),me=de(pe=>pe.progress),Le=de(pe=>pe.executingPromptId),P=de(pe=>pe.workflowDurationStats),V=de(pe=>pe.isExecuting),H=Ht(pe=>pe.running),ce=Le||(H[0]?.prompt_id??null),ke=Gl({workflow:m,runKey:ce,isRunning:V||H.length>0,workflowDurationStats:P}),Ne=ke===100?100:me,O=b.useCallback((pe,xt)=>{D(pe,xt,{workflow:m,nodeTypes:p,updateNodeWidgets:(yt,Vt)=>x(C,Vt)})},[C,p,D,x,m]),_=b.useCallback(pe=>{A(pe,L)},[L,A]),q=ee??n5,[je,Ke]=b.useState(null),{errorPopoverOpen:De,setErrorPopoverOpen:Fe,resetErrorPopover:ue}=$N(),ye=b.useRef(null),[et,oe]=b.useState(!1),[z,U]=b.useState(!1),[se,fe]=b.useState(""),M=b.useRef(null),re=b.useRef(0),W=b.useRef(null),[G,I]=b.useState(null),[$,Z]=b.useState(!1),Se=de(pe=>pe.deleteNode);b.useEffect(()=>{const pe=xt=>{const yt=xt.detail;if(yt.nodeId===o.id){I(yt.label);const Vt=setTimeout(()=>I(null),1e3);return()=>clearTimeout(Vt)}};return window.addEventListener("node-show-label",pe),()=>window.removeEventListener("node-show-label",pe)},[o.id]);const Q=ne&&ne.length>0,Me=b.useMemo(()=>ne?new Set(ne.map(pe=>pe.inputName).filter(pe=>!!pe)):new Set,[ne]),K=q.length>0?q[q.length-1]:null,Te=K?`${K.filename}|${K.subfolder}|${K.type}`:null,_e=je?`${je.filename}|${je.subfolder}|${je.type}`:null;b.useEffect(()=>{if(!K||Te===_e)return;const pe=bo(K.filename,K.subfolder,K.type),xt=new Image;xt.onload=()=>Ke(K),xt.src=pe},[Te,_e,K]);const qe=p?.[o.type],Ge=b.useMemo(()=>{const pe=o.title;return typeof pe=="string"&&pe.trim()?pe.trim():null},[o]),Ve=Ge||qe?.display_name||o.type,Je=o.type==="KSampler",Ue=vr(o.type),Xe=o.mode===4,Pe=!!j[C],he=/LoadImage/i.test(o.type),ut=b.useMemo(()=>!he||!m||!p?null:e5(m,p,o),[he,o,p,m])??je,it=b.useMemo(()=>{const pe=Up(p,o);return Je?pe.filter(xt=>xt.name!=="seed"):pe},[p,o,Je]),_t=b.useMemo(()=>Wp(p,o),[p,o]),Ot=b.useMemo(()=>_t.filter(pe=>!pe.connected),[_t]),wt=b.useMemo(()=>it.filter(pe=>!pe.connected),[it]),It=b.useMemo(()=>{const pe=o.properties,xt=["text","note","description","label","title"];if(pe)for(const Vt of xt){const Rt=pe[Vt];if(typeof Rt=="string"&&Rt.trim())return Rt}if(/note|comment|sticky|label/i.test(o.type)&&Array.isArray(o.widgets_values)){const Vt=o.widgets_values.find(Rt=>typeof Rt=="string"&&Rt.trim());if(typeof Vt=="string"&&Vt.trim())return Vt}return null},[o.properties,o.widgets_values,o.type]),Kt=b.useMemo(()=>{if(!/note|comment|sticky|label/i.test(o.type)||!Array.isArray(o.widgets_values))return null;const xt=o.widgets_values.findIndex(yt=>typeof yt=="string"&&yt.trim());return xt>=0?xt:null},[o.type,o.widgets_values]),pt=pe=>!m||!p?null:Vn(m,p,o,pe),Lt=()=>!m||!p?null:ba(m,p,o),Gt=pe=>{Kt!==null&&y(C,Kt,pe)},xe=b.useMemo(()=>{if(!It)return null;const pe=[],xt=/(https?:\/\/[^\s]+)/g;let yt=0,Vt,Rt=0;for(;(Vt=xt.exec(It))!==null;){const[cn]=Vt,wn=Vt.index;wn>yt&&pe.push(It.slice(yt,wn)),pe.push(u.jsx("a",{href:cn,target:"_blank",rel:"noreferrer",className:"text-blue-600 underline break-all",children:cn},`note-link-${Rt++}`)),yt=wn+cn.length}return yt<It.length&&pe.push(It.slice(yt)),pe},[It]),J=()=>{const pe=Date.now();pe-re.current<300&&oe(!0),re.current=pe},be=b.useMemo(()=>{const pe=[],xt=(yt,Vt)=>!(yt.startsWith("LM_LORA")||yt.startsWith("TW_")||Ue&&Vt==="text");return Ot.forEach(yt=>{xt(yt.type,yt.name)&&pe.push({widgetIndex:yt.widgetIndex,name:yt.name,type:yt.type,options:yt.options})}),wt.forEach(yt=>{xt(yt.type,yt.name)&&pe.push({widgetIndex:yt.widgetIndex,name:yt.name,type:yt.type,options:yt.options})}),pe},[Ot,wt,Ue]),Ie=b.useCallback(pe=>{if(pe.link!=null)return!1;if(pe.widget)return!0;const xt=qe?.input?.required?.[pe.name]||qe?.input?.optional?.[pe.name];if(!xt)return!1;const[yt,Vt]=xt;if(Array.isArray(yt))return!0;const Rt=String(yt).toUpperCase(),cn=Object.prototype.hasOwnProperty.call(Vt??{},"default");return["INT","FLOAT","BOOLEAN","STRING"].includes(Rt)||Rt.includes("AUTOCOMPLETE_TEXT_LORAS")||Rt.includes("AUTOCOMPLETE_TEXT_PROMPT")||cn},[qe]),Be=b.useMemo(()=>o.inputs.filter(pe=>!(Ie(pe)||String(pe.type).toUpperCase()==="OPT_CONNECTION"&&pe.link==null)),[o.inputs,Ie]),We=b.useMemo(()=>o.outputs.filter(pe=>!((pe.name||"").toLowerCase().replace(/[_\s]/g,"")==="showhelp"||String(pe.type).toUpperCase()==="OPT_CONNECTION"&&!pe.links?.length)),[o.outputs]),Oe=o.outputs.some(pe=>String(pe.type).toUpperCase()==="IMAGE"),lt=!!(qe?.output_node||/PreviewImage|SaveImage|SaveAnimatedPNG|SaveAnimatedWEBP|SaveVideo/i.test(o.type)),st=pe=>B?.widgetIndex===pe,at=(pe,xt,yt,Vt)=>{st(pe)?_(null):_({nodeId:o.id,widgetIndex:pe,widgetName:xt,widgetType:yt,options:Vt})},ct=be.length===1?be[0]:null,dt=ct?st(ct.widgetIndex):!1,nt=!!B,bt=F.includes(C),kt=F.length<5||bt,Qt=(Oe||lt)&&!!ut,en=typeof ae=="string"&&ae.length>0,Yt=o.inputs?.filter(pe=>pe.link!=null).length??0,Y=o.outputs?.reduce((pe,xt)=>pe+(xt.links?.length??0),0)??0,Re=Yt>0||Y>0,ie=Math.min(3,Yt),ot=Math.min(3,Y),tt=ut?(()=>{const{filename:pe,subfolder:xt,type:yt}=ut,Vt=bo(pe,xt,yt),Rt=xt?`${xt}/${pe}`:pe,cn=Pl(pe);return[{src:Vt,alt:Ve,filename:pe,mediaType:cn,file:{id:`${yt}/${Rt}`,name:pe,type:cn==="video"?"video":"image",fullUrl:Vt}}]})():[];b.useEffect(()=>{if(!z)return;const pe=M.current;pe&&(pe.focus(),pe.select())},[z]);const Ze=()=>{fe(Ve),U(!0)},Ye=()=>{const pe=se.trim();v(C,pe.length>0?pe:null),U(!1)},Ct=b.useCallback((pe,xt,yt)=>{y(C,pe,xt,yt)},[C,y]),mt=b.useCallback(pe=>{x(C,pe)},[C,x]),Tt=!!(G&&!/^error\b/i.test(G));return u.jsxs("div",{id:`node-card-wrapper-${o.id}`,className:"relative node-card-outer",children:[u.jsx("div",{id:`node-anchor-${o.id}`,className:"absolute -top-3 left-0 right-0 h-0 node-scroll-anchor"}),Tt&&u.jsx(XN,{label:G??""}),l&&u.jsx("div",{className:"absolute top-2 right-2 z-[110] animate-in fade-in duration-150",children:u.jsx("div",{className:"bg-red-600 text-white text-[10px] font-black px-2 py-0.5 rounded-full shadow-lg whitespace-nowrap uppercase tracking-tighter ring-2 ring-white",children:l})}),u.jsxs("div",{id:`node-card-${o.id}`,className:`
        node-card-inner
        ${d?"rounded-lg shadow-sm py-1":"rounded-xl shadow-md px-2 py-1 mb-3"}
        border-2
        ${Q?"border-red-700 shadow-red-200":a?"border-orange-500 shadow-orange-200":s?"border-green-500 shadow-green-200":Xe?"border-purple-300":"border-transparent"}
        ${Xe?Pe?"bg-purple-200":"bg-purple-100/50":"bg-white"}
      `,style:{overflow:"visible"},children:[u.jsx(YN,{nodeId:o.id,displayName:Ve,isEditingLabel:z,labelValue:se,labelInputRef:M,onLabelChange:fe,onLabelBlur:Ye,isCollapsed:Pe,isBypassed:Xe,isExecuting:s,overallProgress:ke,hasErrors:Q,errorIconRef:W,errorPopoverOpen:De,setErrorPopoverOpen:Fe,toggleNodeFold:()=>{w(C,!Pe)},rightSlot:u.jsx(FN,{nodeId:o.id,nodeStableKey:C,isLoraManagerNode:Ue,isBypassed:Xe,onEditLabel:Ze,pinnableWidgets:be,singlePinnableWidget:ct,isSingleWidgetPinned:dt,hasPinnedWidget:nt,toggleWidgetPin:at,setPinnedWidget:_,isNodeBookmarked:bt,canAddNodeBookmark:kt,onToggleNodeBookmark:()=>te(C),toggleBypass:k,setItemHidden:S,onDeleteNode:()=>Z(!0),onMoveNode:h??(()=>{}),connectionHighlightMode:R,setConnectionHighlightMode:T,leftLineCount:ie,rightLineCount:ot})}),u.jsx("div",{className:`grid transition-[grid-template-rows] duration-200 ease-out ${Pe?"grid-rows-[0fr]":"grid-rows-[1fr]"}`,children:u.jsxs("div",{className:`collapse-container overflow-hidden transition-opacity px-1 duration-200 ease-out ${Pe?"opacity-0":"opacity-100"}`,children:[Ge&&u.jsx("div",{className:"node-card-subtitle text-[10px] text-center font-semibold uppercase tracking-wider text-gray-400 mb-2 px-1",children:qe?.display_name||o.type}),u.jsxs("div",{id:`node-content-${o.id}`,className:`node-expanded-content ${Xe?"opacity-60 grayscale":""}`,children:[u.jsx(rk,{nodeId:o.id,nodeType:o.type,inputs:Be,outputs:We,allInputs:o.inputs,allOutputs:o.outputs}),u.jsx(J4,{node:o,isBypassed:Xe,isKSampler:Je,workflowExists:!!m,nodeTypesExists:!!p,visibleInputWidgets:Ot,visibleWidgets:wt,errorInputNames:Me,onUpdateNodeWidget:Ct,onUpdateNodeWidgets:mt,getWidgetIndexForInput:pt,findSeedWidgetIndex:Lt,setSeedMode:O,isWidgetPinned:st,toggleWidgetPin:at}),It&&u.jsx(GN,{noteText:It,noteLinkified:xe,noteWidgetIndex:Kt,isEditingNote:et,setIsEditingNote:oe,onUpdateNote:Gt,noteTextareaRef:ye,onNoteTap:J}),u.jsx(PN,{show:Qt||en,previewImage:ut,previewText:en?ae:null,displayName:Ve,onImageClick:()=>c?.(tt,0),isExecuting:!!s,overallProgress:ke,displayNodeProgress:Ne})]})]})})]}),u.jsx(qN,{nodeId:o.id,open:De&&Q,errors:ne??[],anchorRef:W,onClose:ue}),$&&u.jsx(QN,{nodeId:o.id,displayName:Ve,hasConnections:Re,onCancel:()=>Z(!1),onDelete:pe=>{Se(C,pe),Z(!1)}})]})});function r5({onClick:n}){return u.jsxs("button",{type:"button",onClick:n,className:"w-full mb-3 py-4 rounded-xl border-2 border-dashed border-gray-300 flex items-center justify-center gap-2 text-sm font-medium text-gray-400 hover:border-gray-400 hover:text-gray-500 active:bg-gray-50 transition-colors",children:[u.jsx(Io,{className:"w-4 h-4"}),"Add node"]})}function Eb({id:n,headerId:o,title:s,nodeCount:a,backgroundColor:l,borderColor:c,textClassName:d,className:h=""}){const p=()=>{document.getElementById(o)?.scrollIntoView({behavior:"smooth",block:"start"})};return u.jsx("div",{id:n,className:`px-3 py-1.5 -mx-1 rounded-b-xl cursor-pointer ${h}`,onClick:p,style:{backgroundColor:l,borderColor:c},children:u.jsxs("div",{className:"flex items-center justify-between gap-3",children:[u.jsx("span",{className:`text-xs select-none ${d}`,children:s}),typeof a=="number"&&u.jsxs("span",{className:`text-xs select-none ${d}`,children:[a," node",a!==1?"s":""]})]})})}function Ib({containerType:n,containerId:o,title:s,nodeCount:a,isCollapsed:l,hiddenNodeCount:c,isBookmarked:d,canShowBookmarkAction:h,foldAllLabel:p,backgroundColor:m,borderColor:y,onToggleCollapse:x,onToggleFoldAll:v,onToggleBookmark:k,onBypassAll:w,onHide:S,onAddNode:j,onDelete:C,onShowHiddenNodes:T,onMove:R,onCommitTitle:D}){const[L,B]=b.useState(!1),[A,F]=b.useState(!1),[te,ee]=b.useState(""),ae=b.useRef(null),ne=b.useRef(null),me=b.useRef(null),{menuStyle:Le,resetMenuPosition:P}=Zp({open:L,buttonRef:me,menuRef:ne}),V=s.trim()||`${n} ${o}`,H=c>0,ce=d||h,ke=n==="subgraph"?"text-blue-600":"text-gray-500",Ne=()=>{B(!1),P()};Na({open:L,onDismiss:()=>{B(!1),P()},triggerRef:me,contentRef:ne,ignoreScrollWithinContent:!0}),b.useEffect(()=>{if(!A)return;const _=ae.current;_&&(_.focus(),_.select())},[A]);const O=()=>{A||x()};return u.jsxs("div",{id:`${n}-header-${o}`,className:`flex items-center justify-between cursor-pointer gap-3 px-3 py-2 ${l?"rounded-xl":"rounded-t-xl mb-2"}`,style:{backgroundColor:m,borderColor:y},onClick:O,children:[u.jsxs("div",{className:"flex items-center gap-1 min-w-0 flex-1",children:[u.jsx("button",{onClick:_=>{_.stopPropagation(),x()},className:"w-8 h-8 -ml-2 flex items-center justify-center text-gray-500 hover:text-gray-700 shrink-0",children:l?u.jsx(js,{className:"w-6 h-6"}):u.jsx(so,{className:"w-6 h-6"})}),A?u.jsx("input",{ref:ae,value:te,onChange:_=>ee(_.target.value),onBlur:()=>{D(te),F(!1)},onKeyDown:_=>{(_.key==="Enter"||_.key==="Escape")&&_.currentTarget.blur()},onClick:_=>_.stopPropagation(),className:"font-semibold text-gray-900 flex-1 min-w-0 text-sm bg-white border border-gray-200 rounded px-2 py-1"}):u.jsx("h3",{className:"font-semibold text-gray-900 select-none flex-1 min-w-0 whitespace-nowrap overflow-hidden text-ellipsis",children:V}),u.jsxs("span",{className:`text-sm shrink-0 ${ke}`,children:[a," node",a!==1?"s":""]})]}),u.jsx(ns,{onClick:_=>{_.stopPropagation(),P(),B(q=>!q)},ariaLabel:`${n} options`,buttonRef:me,buttonSize:8,iconSize:5,icon:d?u.jsx(ts,{className:"w-5 h-5 text-yellow-500"}):n==="subgraph"?u.jsx(Ts,{className:"w-5 h-5 -scale-x-100 text-blue-500"}):void 0}),L&&An.createPortal(u.jsx("div",{ref:ne,className:"fixed z-[1000] w-44",style:Le,children:u.jsx(Sr,{items:[{key:"edit-label",label:"Edit label",icon:u.jsx(Gp,{className:"w-4 h-4"}),onClick:_=>{_.stopPropagation(),ee(V),F(!0),Ne()}},{key:"add-node",label:"Add node",icon:u.jsx(Io,{className:"w-4 h-4"}),onClick:_=>{_.stopPropagation(),j(),Ne()}},{key:"fold-all",label:p,icon:p==="Fold all"?u.jsx(js,{className:"w-4 h-4"}):u.jsx(so,{className:"w-4 h-4"}),onClick:_=>{_.stopPropagation(),v(),Ne()}},{key:"bypass-all",label:"Bypass all nodes",icon:u.jsx(hp,{isBypassed:!0,className:"w-4 h-4"}),onClick:_=>{_.stopPropagation(),w(!0),Ne()}},{key:"unbypass-all",label:"Un-bypass all nodes",icon:u.jsx(hp,{isBypassed:!1,className:"w-4 h-4"}),onClick:_=>{_.stopPropagation(),w(!1),Ne()}},{key:"toggle-bookmark",label:d?"Remove bookmark":"Bookmark container",icon:d?u.jsx(ts,{className:"w-4 h-4 text-yellow-500"}):u.jsx(fc,{className:"w-4 h-4"}),onClick:_=>{_.stopPropagation(),k(),Ne()},hidden:!ce},{key:"show-hidden-nodes",label:"Show hidden nodes",icon:u.jsx(Yo,{className:"w-4 h-4"}),onClick:_=>{_.stopPropagation(),T(),Ne()},hidden:!H},{key:"hide-container",label:`Hide ${n}`,icon:u.jsx(Yo,{className:"w-4 h-4"}),onClick:_=>{_.stopPropagation(),S(),Ne()}},{key:"move-container",label:`Move ${n}`,icon:u.jsx(yx,{className:"w-4 h-4"}),onClick:_=>{_.stopPropagation(),R(),Ne()}},{key:"delete-container",label:`Delete ${n}`,icon:u.jsx(Ho,{className:"w-4 h-4"}),color:"danger",onClick:_=>{_.stopPropagation(),C(),Ne()}}]})}),document.body)]})}function Lb({containerType:n,containerId:o,hiddenNodeCount:s=0,borderColor:a,dashedBorderColor:l,onClick:c}){const d=n==="group"?"group":"subgraph";return u.jsx("div",{id:`${n}-placeholder-${o}`,className:"flex items-center justify-center px-4 pb-4 pt-2",style:{borderColor:a},children:u.jsxs("button",{type:"button",onClick:c,className:"w-full rounded-lg border-2 border-dashed flex flex-col items-center justify-center py-4 hover:bg-white/40 transition-colors",style:{borderColor:l},children:[u.jsx("span",{className:"text-sm text-gray-400 select-none",children:s>0?`${s} hidden node${s!==1?"s":""} in ${d}`:`No nodes in ${d}`}),u.jsxs("span",{className:"text-xs text-gray-500 select-none mt-1 inline-flex items-center gap-1",children:[u.jsx(Io,{className:"w-3 h-3"}),"Click to add a node"]})]})})}function s5({isOpen:n,onClose:o,addInGroupId:s=null,addInSubgraphId:a=null,onNodeAdded:l}){const c=de(k=>k.nodeTypes),d=de(k=>k.addNode),h=de(k=>k.scrollToNode),[p,m]=b.useState(""),y=b.useMemo(()=>c?Object.entries(c).map(([k,w],S)=>({index:S,name:k,displayName:Ss(w,k),pack:ws(String(w.python_module??w.category?.split("/")[0]??"Core")),category:String(w.category??"Other"),description:String(w.description??"")})):[],[c]),x=b.useMemo(()=>bp(y,p,k=>({displayName:k.displayName,typeName:k.name,category:k.category,pack:k.pack}),k=>k.index),[y,p]),v=k=>{const w=s==null&&a==null?void 0:{...s==null?{}:{inGroupId:s},...a==null?{}:{inSubgraphId:a}},S=d(k,w);if(o(),S!==null){l?.(S);const j=de.getState().workflow?.nodes.find(C=>C.id===S)?.stableKey??null;j&&h(j)}};return u.jsx(Sx,{isOpen:n,onClose:o,title:"Add node",searchQuery:p,onSearchQueryChange:m,searchPlaceholder:"Search node types...",children:u.jsxs("div",{className:"flex-1 overflow-auto bg-white",children:[x.length===0&&u.jsx(Nl,{query:p,message:"No matching node types found"}),u.jsx("div",{className:"px-3 pt-3 pb-20 flex flex-col gap-2",children:x.map(k=>u.jsx(xp,{title:k.displayName,subtitle:k.pack||"Core",onSelect:()=>v(k.name)},k.name))})]})})}function a5({containerTypeLabel:n,containerIdLabel:o,displayName:s,nodeCount:a,onCancel:l,onDeleteContainerOnly:c,onDeleteContainerAndNodes:d}){const h=n;return An.createPortal(u.jsx(Qo,{onClose:l,title:`Delete ${h}`,description:u.jsxs(u.Fragment,{children:[u.jsx("span",{className:"font-medium text-gray-700",children:s})," (",o,") has ",a," node",a===1?"":"s","."]}),actionsLayout:"stack",actions:[{label:`Delete ${h} only`,onClick:c,className:"w-full px-4 py-2.5 text-sm font-medium text-red-700 bg-red-50 rounded-lg hover:bg-red-100 active:bg-red-200"},{label:`Delete ${h} and nodes`,onClick:d,className:"w-full px-4 py-2.5 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700 active:bg-red-800"},{label:"Cancel",onClick:l,className:"w-full px-4 py-2.5 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 active:bg-gray-300"}]}),document.body)}function Mu(n){return String(n).split(",").map(o=>o.trim().toUpperCase()).filter(Boolean)}function _b(n){return n.toLowerCase().replace(/[_-]+/g," ").replace(/\s+/g," ").trim()}function l5(n,o){let s=0;for(const a of o)if(a===n[s]&&(s+=1,s>=n.length))return!0;return n.length===0}function Pf(n,o){if(!n.trim())return!0;const s=_b(o);return _b(n).split(" ").filter(Boolean).every(a=>s.includes(a)||l5(a,s))}function i5({visible:n,onImageClick:o}){const s=de(Y=>Y.workflow),a=de(Y=>Y.executingNodeId),l=de(Y=>Y.connectionHighlightModes),c=Xn(Y=>Y.bookmarkBarSide),d=Xn(Y=>Y.bookmarkBarTop),h=Xn(Y=>Y.setBookmarkBarPosition),p=Xn(Y=>Y.setBookmarkRepositioningActive),m=de(Y=>Y.setItemCollapsed),y=de(Y=>Y.scrollToNode),x=de(Y=>Y.revealNodeWithParents),v=de(Y=>Y.nodeTypes),k=gn(Y=>Y.nodeErrors),w=de(Y=>Y.searchOpen),S=de(Y=>Y.searchQuery),j=de(Y=>Y.setSearchQuery),C=de(Y=>Y.setSearchOpen),T=de(Y=>Y.addNodeModalRequest),R=de(Y=>Y.clearAddNodeModalRequest),D=de(Y=>Y.collapsedItems),L=de(Y=>Y.hiddenItems),B=de(Y=>Y.setItemHidden),A=de(Y=>Y.bypassAllInContainer),F=de(Y=>Y.deleteContainer),te=de(Y=>Y.updateContainerTitle),ee=de(Y=>Y.mobileLayout),ae=de(Y=>Y.stableKeyByPointer),ne=Xn(Y=>Y.bookmarkedItems),me=Xn(Y=>Y.toggleBookmark),Le=b.useRef(null),P=b.useRef(null),V=b.useRef(null),H=b.useRef(null),[ce,ke]=b.useState(0),[Ne,O]=b.useState(!1),[_,q]=b.useState(!1),[je,Ke]=b.useState(null),[De,Fe]=b.useState(!1),[ue,ye]=b.useState(null),[et,oe]=b.useState(null),[z,U]=b.useState(null),se=kN(),[fe,M]=b.useState({}),re=b.useRef(new Map),W=b.useRef(null),G=b.useRef(null),I=b.useRef(null),$=b.useRef(null),Z=b.useMemo(()=>new Map((s?.nodes??[]).map(Y=>[Y.id,rn(Y.stableKey,`node ${Y.id}`)])),[s]),Se=b.useMemo(()=>new Map((s?.definitions?.subgraphs??[]).map(Y=>[Y.id,rn(Y.stableKey,`subgraph ${Y.id}`)])),[s]),Q=()=>{j(""),C(!1)},Me=b.useMemo(()=>{const Y=new Map,Re=new Set,ie=new Set,ot=(tt,Ze)=>{tt.forEach(Ye=>{if(Ye.type==="node"){const Ct=rn(Z.get(Ye.id),`layout node ref ${Ye.id}`);Y.set(Ct,{stableKey:Ct,type:"node",nodeId:Ye.id,subgraphId:Ze,text:String(Ye.id)});return}if(Ye.type==="group"){const Ct=Ye.stableKey;if(Ct&&Y.set(Ct,{stableKey:Ct,type:"group",groupId:Ye.id,subgraphId:Ze,groupKey:Ye.stableKey,text:`G${Ye.id}`}),Re.has(Ye.stableKey))return;Re.add(Ye.stableKey),ot(ee.groups[Ye.stableKey]??[],Ze);return}if(Ye.type==="subgraph"){const Ct=rn(Se.get(Ye.id),`layout subgraph ref ${Ye.id}`);if(Y.set(Ct,{stableKey:Ct,type:"subgraph",subgraphId:Ye.id,text:"SG"}),ie.has(Ye.id))return;ie.add(Ye.id),ot(ee.subgraphs[Ye.id]??[],Ye.id)}})};return ot(ee.root,null),Y},[ee,Z,Se]),K=b.useMemo(()=>ne.map(Y=>Me.get(Y)).filter(Y=>Y!=null),[Me,ne]),Te=b.useCallback(Y=>{const Re=rx(ee,({ref:ie})=>ie.type==="node"?rn(Z.get(ie.id),`layout node ref ${ie.id}`)===Y:ie.type==="group"?ie.stableKey===Y:ie.type==="subgraph"?rn(Se.get(ie.id),`layout subgraph ref ${ie.id}`)===Y:!1);return Re?{groupKeys:Re.groupKeys,subgraphIds:Re.subgraphIds}:null},[ee,Z,Se]),_e=b.useCallback((Y,Re,ie)=>{x(Y),y(Y,ie),window.dispatchEvent(new CustomEvent("workflow-scroll-to-node",{detail:{nodeId:Re,label:ie}}))},[x,y]),qe=b.useCallback((Y,Re,ie,ot)=>{const tt=Te(Y);if(tt){for(const mt of tt.subgraphIds){const Tt=Se.get(mt)??null;Tt&&(B(Tt,!1),m(Tt,!1))}for(const mt of tt.groupKeys){const Tt=ae[mt];Tt&&(B(Tt,!1),m(Tt,!1))}}if(ot){const mt=Se.get(ot)??null;mt&&(B(mt,!1),m(mt,!1))}B(Y,!1),m(Y,!1);const Ye=`[data-group-id="${ie}"][data-subgraph-id="${ot??"root"}"]`,Ct=`[data-reposition-item="group-${Re}"]`;requestAnimationFrame(()=>{requestAnimationFrame(()=>{const mt=document.querySelector(Ye),Tt=document.querySelector(Ct);(mt??Tt)?.scrollIntoView({behavior:"smooth",block:"start"})})})},[Te,m,B,ae,Se]),Ge=b.useCallback((Y,Re)=>{const ie=Te(Y);if(ie){for(const Ze of ie.subgraphIds){const Ye=Se.get(Ze)??null;Ye&&(B(Ye,!1),m(Ye,!1))}for(const Ze of ie.groupKeys){const Ye=ae[Ze];Ye&&(B(Ye,!1),m(Ye,!1))}}B(Y,!1),m(Y,!1);const ot=`[data-subgraph-header-id="${Re}"]`,tt=`[data-reposition-item="subgraph-${Re}"]`;requestAnimationFrame(()=>{requestAnimationFrame(()=>{const Ze=document.querySelector(ot),Ye=document.querySelector(tt);(Ze??Ye)?.scrollIntoView({behavior:"smooth",block:"start"})})})},[Te,m,B,ae,Se]),Ve=b.useCallback((Y,Re)=>()=>{if(Ne){O(!1),q(!1),Ke(null);return}ke(Re),Y.type==="node"?_e(Y.stableKey,Y.nodeId):Y.type==="group"?qe(Y.stableKey,Y.groupKey,Y.groupId,Y.subgraphId):Ge(Y.stableKey,Y.subgraphId)},[Ne,qe,_e,Ge]),Je=b.useCallback(()=>{if(Ne){O(!1),q(!1),Ke(null);return}const Y=(ce+1)%K.length;ke(Y);const Re=K[Y];Re&&(Re.type==="node"?_e(Re.stableKey,Re.nodeId):Re.type==="group"?qe(Re.stableKey,Re.groupKey,Re.groupId,Re.subgraphId):Ge(Re.stableKey,Re.subgraphId))},[K,ce,Ne,qe,_e,Ge]),Ue=b.useCallback(()=>{W.current!=null&&(window.clearTimeout(W.current),W.current=null)},[]),Xe=b.useCallback(()=>{const Y=getComputedStyle(document.documentElement).getPropertyValue("--bottom-bar-offset"),Re=Number.parseFloat(Y);return Number.isFinite(Re)?Re:0},[]),Pe=b.useCallback(()=>{const Y=Le.current,Re=P.current;if(!Y||!Re)return null;const ie=Y.getBoundingClientRect().height,ot=Re.getBoundingClientRect().height,tt=16,Ze=Xe()+8,Ye=Math.max(tt,ie-ot-Ze);return{minTop:tt,maxTop:Ye}},[Xe]),he=b.useCallback(Y=>{const Re=Pe();return Re?Math.min(Math.max(Y,Re.minTop),Re.maxTop):Y},[Pe]),Qe=b.useCallback((Y,Re)=>{const ie=Le.current,ot=I.current;if(!ie||!ot)return;const tt=ie.getBoundingClientRect(),Ze=Y-tt.left-ot.x,Ye=he(Re-tt.top-ot.y);Ke({x:Ze,y:Ye})},[he]),ut=b.useCallback((Y,Re)=>{const ie=Le.current,ot=P.current;if(!ie||!ot)return;const tt=ot.getBoundingClientRect(),Ze=ie.getBoundingClientRect();I.current={x:Y-tt.left,y:Re-tt.top};const Ye=tt.left-Ze.left,Ct=he(tt.top-Ze.top);Ke({x:Ye,y:Ct}),q(!0)},[he]),it=b.useCallback(Y=>{Y.pointerType==="mouse"&&Y.button!==0||Y.target.closest("button")&&!Ne||(Y.preventDefault(),G.current={startX:Y.clientX,startY:Y.clientY,startTime:Date.now(),pointerId:Y.pointerId},Ne?ut(Y.clientX,Y.clientY):W.current=window.setTimeout(()=>{O(!0),ut(Y.clientX,Y.clientY)},500),Y.currentTarget.setPointerCapture(Y.pointerId))},[Ne,ut]),_t=b.useCallback(Y=>{if(_){Qe(Y.clientX,Y.clientY);return}const Re=G.current;if(!Re)return;const ie=Y.clientX-Re.startX,ot=Y.clientY-Re.startY;Math.hypot(ie,ot)>8&&Ue()},[Ue,_,Qe]),Ot=b.useCallback(()=>{const Y=Le.current,Re=P.current;if(!Y||!Re||!je)return;const ie=Y.getBoundingClientRect(),ot=Re.getBoundingClientRect().width,Ze=je.x+ot/2<ie.width/2?"left":"right",Ye=he(je.y);h({side:Ze,top:Ye}),Ke(null)},[je,he,h]),wt=b.useCallback(Y=>{Ue();const Re=G.current;if(G.current=null,_){Ot(),q(!1);return}if(Ne||!Re)return;const ie=Y.clientX-Re.startX,ot=Y.clientY-Re.startY,tt=Date.now()-Re.startTime;Math.abs(ie)>40&&Math.abs(ie)>Math.abs(ot)&&tt<500&&h({side:c==="left"?"right":"left"})},[c,Ue,Ot,_,Ne,h]),It=b.useCallback(()=>{Ue(),G.current=null,q(!1),Ke(null)},[Ue]),Kt=b.useMemo(()=>{if(!s)return[];const Y=nx(ee),Re=new Map(s.nodes.map(tt=>[tt.id,tt])),ie=[];for(const tt of Y){const Ze=Re.get(tt);Ze&&ie.push(Ze)}const ot=new Set(Y);for(const tt of s.nodes)ot.has(tt.id)||ie.push(tt);return Object.keys(L).length===0?ie:ie.filter(tt=>{const Ze=rn(tt.stableKey,`node ${tt.id}`);return!L[Ze]})},[s,L,ee]),pt=S.trim(),Lt=w&&pt.length>0,Gt=b.useMemo(()=>{if(!Lt||!s)return new Set;const Y=[...s.groups??[],...(s.definitions?.subgraphs??[]).flatMap(ie=>ie.groups??[])],Re=new Set;for(const ie of Y)Pf(pt,ie.title)&&Re.add(ie.id);return Re},[s,Lt,pt]),xe=b.useMemo(()=>{if(!Lt||!s)return new Set;const Y=s.definitions?.subgraphs??[],Re=new Set;for(const ie of Y){const ot=ie.name||ie.id;Pf(pt,`${ot} ${ie.id}`)&&Re.add(ie.id)}return Re},[s,Lt,pt]),J=b.useMemo(()=>Lt?Kt.filter(Y=>{const Re=v?.[Y.type],ie=Y.title,ot=[typeof ie=="string"?ie:"",Re?.display_name??"",Y.type,String(Y.id)];return Pf(pt,ot.join(" "))}):Kt,[Kt,Lt,pt,v]),be=b.useMemo(()=>new Set(J.map(Y=>Y.id)),[J]),Ie=b.useMemo(()=>s?CN(ee,s,D,L,ae):[],[ee,s,D,L,ae]),Be=b.useMemo(()=>{if(!s)return[];if(Lt){const Y=ie=>{let ot=0;for(const tt of ie)tt.type==="hiddenBlock"?ot+=tt.count:tt.type==="node"?ot+=1:ot+=Y(tt.children);return ot},Re=(ie,ot=!1)=>{const tt=[];for(const Ze of ie){if(Ze.type==="hiddenBlock")continue;if(Ze.type==="node"){(ot||be.has(Ze.node.id))&&tt.push(Ze);continue}if(ot){const mt=Re(Ze.children,!0);tt.push({...Ze,isCollapsed:!1,nodeCount:Y(mt),children:mt});continue}if(Ze.type==="group"){const mt=Gt.has(Ze.group.id),Tt=Re(Ze.children,mt);(mt||Tt.length>0)&&tt.push({...Ze,isCollapsed:!1,nodeCount:Y(Tt),children:Tt});continue}const Ye=xe.has(Ze.subgraph.id),Ct=Re(Ze.children,!1);(Ye||Ct.length>0)&&tt.push({...Ze,isCollapsed:!1,nodeCount:Y(Ct),children:Ct})}return tt};return Re(Ie)}return Ie},[Ie,be,Gt,xe,Lt,s]),We=b.useMemo(()=>{const Y=new Map;let Re=0;for(const ie of Kt){const ot=k[String(ie.id)];ot&&ot.length>0&&(Re+=1,Y.set(ie.id,Re))}return Y},[Kt,k]),Oe=b.useMemo(()=>{if(!s)return new Set;const Y=Object.entries(l).filter(([,Ye])=>Ye!=="off").map(([Ye,Ct])=>({id:Number(Ye),mode:Ct}));if(Y.length===0)return new Set;const Re=new Map(s.nodes.map(Ye=>[Ye.id,Ye])),ie=new Set,ot=Ye=>!!L[rn(Ye.stableKey,`node ${Ye.id}`)],tt=(Ye,Ct,mt)=>{if(Ct.has(Ye))return[];Ct.add(Ye);const Tt=Re.get(Ye);if(!Tt)return[];const pe=[];return Tt.outputs?.forEach((xt,yt)=>{const Vt=Mu(xt.type);if(mt.size>0&&!Vt.some(cn=>mt.has(cn)))return;Tl(s,Ye,yt).forEach(cn=>{const wn=cn.node;ot(wn)?pe.push(...tt(wn.id,Ct,mt)):pe.push(wn)})}),pe},Ze=(Ye,Ct,mt)=>{if(Ct.has(Ye))return[];Ct.add(Ye);const Tt=Re.get(Ye);if(!Tt)return[];const pe=[];return Tt.inputs?.forEach((xt,yt)=>{if(xt.link===null)return;const Vt=Mu(xt.type);if(mt.size>0&&!Vt.some(cn=>mt.has(cn)))return;const Rt=va(s,Ye,yt);Rt&&(ot(Rt.node)?pe.push(...Ze(Rt.node.id,Ct,mt)):pe.push(Rt.node))}),pe};return Y.forEach(({id:Ye,mode:Ct})=>{const mt=Re.get(Ye);mt&&((Ct==="inputs"||Ct==="both")&&mt.inputs?.forEach((Tt,pe)=>{if(Tt.link===null)return;const xt=va(s,mt.id,pe);if(!xt)return;if(!ot(xt.node)){ie.add(xt.node.id);return}const yt=new Set(Mu(Tt.type));Ze(xt.node.id,new Set,yt).forEach(Rt=>ie.add(Rt.id))}),(Ct==="outputs"||Ct==="both")&&mt.outputs?.forEach((Tt,pe)=>{const xt=new Set(Mu(Tt.type));Tl(s,mt.id,pe).forEach(Vt=>{const Rt=Vt.node;if(!ot(Rt)){ie.add(Rt.id);return}tt(Rt.id,new Set,xt).forEach(wn=>ie.add(wn.id))})}))}),ie},[s,l,L]);b.useEffect(()=>{const Y=Re=>{const ie=Re.detail,ot=typeof ie=="number"?ie:ie.nodeId,tt=typeof ie=="object"?ie.label:void 0;if(typeof ot!="number"||!J.some(pe=>pe.id===ot))return;const Ye=We.get(ot),Ct=tt??(Ye?`Error #${Ye}`:"Error");M(pe=>({...pe,[ot]:Ct}));const mt=re.current.get(ot);mt&&window.clearTimeout(mt);const Tt=window.setTimeout(()=>{M(pe=>{const xt={...pe};return delete xt[ot],xt}),re.current.delete(ot)},2e3);re.current.set(ot,Tt)};return window.addEventListener("workflow-label-error-node",Y),()=>window.removeEventListener("workflow-label-error-node",Y)},[J,We]),b.useEffect(()=>{const Y=re.current;return()=>{Y.forEach(Re=>window.clearTimeout(Re)),Y.clear()}},[]),b.useEffect(()=>{const Y=Re=>{const ie=Re.detail,ot=typeof ie=="number"?ie:ie.nodeId,tt=typeof ie=="object"?ie.label:void 0;if(typeof ot!="number")return;const Ze=s?.nodes.find(mt=>mt.id===ot);if(!Ze)return;const Ye=rn(Ze.stableKey,`node ${Ze.id}`);m(Ye,!1);const Ct=(typeof Ye=="string"?document.querySelector(`[data-stable-key="${Ye}"]`):null)??document.querySelector(`[data-reposition-item="node-${ot}"]`);Ct&&Ct.scrollIntoView({behavior:"smooth",block:"start"}),requestAnimationFrame(()=>y(Ye,tt))};return window.addEventListener("workflow-scroll-to-node",Y),()=>window.removeEventListener("workflow-scroll-to-node",Y)},[m,y,s]),b.useEffect(()=>{w&&(V.current&&V.current.scrollTo({top:0,behavior:"auto"}),requestAnimationFrame(()=>{H.current?.focus();const Y=Le.current,Re=P.current,ie=H.current?.closest(".node-search-bar");if(!Y||!Re||!ie)return;const ot=Y.getBoundingClientRect(),tt=ie.getBoundingClientRect(),Ze=Re.getBoundingClientRect(),Ye=tt.bottom-ot.top,Ct=Ze.top-ot.top,mt=8;Ct<Ye+mt&&h({top:Ye+mt})}))},[w,h]),b.useEffect(()=>(p(Ne),()=>p(!1)),[Ne,p]),b.useEffect(()=>{if(!K.length)return;const Y=window.requestAnimationFrame(()=>{const Re=Pe();if(!Re)return;const{minTop:ie,maxTop:ot}=Re;if(d==null)h({top:ot});else{const tt=Math.min(Math.max(d,ie),ot);tt!==d&&h({top:tt})}});return()=>window.cancelAnimationFrame(Y)},[K.length,d,Pe,h]),b.useEffect(()=>{if(!Ne)return;const Y=Re=>{const ie=P.current;!ie||!Re.target||ie.contains(Re.target)||(O(!1),q(!1),Ke(null),Ue())};return document.addEventListener("pointerdown",Y),()=>{document.removeEventListener("pointerdown",Y)}},[Ue,Ne]),b.useEffect(()=>{if(!T||$.current===T.id)return;$.current=T.id;const Y=window.requestAnimationFrame(()=>{ye(T.groupId),oe(T.subgraphId),Fe(!0),R()});return()=>window.cancelAnimationFrame(Y)},[T,R]);const lt=Y=>{for(const Re of Y)if(Re.type!=="hiddenBlock"){if(Re.type==="node"){const ie=rn(Re.node.stableKey,`node ${Re.node.id}`);if(!D[ie])return!0;continue}if(!Re.isCollapsed||lt(Re.children))return!0}return!1},st=b.useCallback((Y,Re)=>{const ie=ot=>{for(const tt of ot){if(tt.type==="hiddenBlock")continue;if(tt.type==="node"){const Ye=rn(tt.node.stableKey,`node ${tt.node.id}`);m(Ye,Re);continue}if(tt.type==="group"){const Ye=rn(tt.stableKey,`group ${tt.group.id}`);m(Ye,Re),ie(tt.children);continue}const Ze=rn(Se.get(tt.subgraph.id),`subgraph ${tt.subgraph.id}`);m(Ze,Re),ie(tt.children)}};ie(Y)},[m,Se]),at=b.useCallback(Y=>mp(Y,{layout:ee,hiddenItems:L,stableKeyByPointer:ae}),[L,ee,ae]),ct=b.useCallback(Y=>at(ee.groups[Y]??[]),[at,ee]),dt=b.useCallback(Y=>at(ee.subgraphs[Y]??[]),[at,ee]),nt=b.useCallback(Y=>{for(const Re of Y.hiddenGroupKeys){const ie=ae[Re];ie&&B(ie,!1)}for(const Re of Y.hiddenSubgraphIds){const ie=rn(Se.get(Re),`subgraph ${Re}`);B(ie,!1)}for(const Re of Y.hiddenNodeKeys){const ie=ae[Re];ie&&B(ie,!1)}},[B,ae,Se]),bt=(Y,Re)=>Y.map((ie,ot)=>{const tt=`${Re}-${ot}`;if(ie.type==="hiddenBlock")return null;if(ie.type==="group"){const Ze=ie.group,Ye=Do(Ze.color,.15),Ct=Do(Ze.color,.4),mt=lt(ie.children),Tt=ie.children.some(jn=>jn.type!=="hiddenBlock"),pe=rn(ie.stableKey,`group ${ie.group.id}`),xt=ct(pe),yt=ne.includes(pe),Vt=ne.length<5||yt,Rt=xt.hiddenNodeCount,cn=mt?"Fold all":"Unfold all",wn=()=>{mt||m(pe,!1),st(ie.children,mt)};return u.jsxs("div",{className:"group-wrapper shadow-md rounded-xl border mb-3",style:{backgroundColor:Ye,borderColor:Ct},"data-reposition-item":`group-${pe}`,"data-stable-key":pe,children:[u.jsx(Ib,{containerType:"group",containerId:Ze.id,title:Ze.title?.trim()||`Group ${Ze.id}`,nodeCount:ie.nodeCount,isCollapsed:ie.isCollapsed,backgroundColor:Do(Ze.color,.22),borderColor:Do(Ze.color,.4),hiddenNodeCount:Rt,isBookmarked:yt,canShowBookmarkAction:Vt,foldAllLabel:cn,onToggleCollapse:()=>m(pe,!ie.isCollapsed),onToggleBookmark:()=>me(pe),onShowHiddenNodes:()=>{Rt>0&&nt(xt)},onToggleFoldAll:wn,onBypassAll:jn=>A(pe,jn),onHide:()=>B(pe,!0),onAddNode:()=>{ye(ie.group.id),oe(ie.subgraphId??null),Fe(!0)},onDelete:()=>{if(ie.nodeCount===0){F(pe,{deleteNodes:!1});return}U({stableKey:pe,containerTypeLabel:"group",containerIdLabel:`#${ie.group.id}`,displayName:ie.group.title?.trim()||`Group ${ie.group.id}`,nodeCount:ie.nodeCount})},onMove:()=>se.openOverlay({type:"group",id:ie.group.id,subgraphId:ie.subgraphId??null}),onCommitTitle:jn=>te(pe,jn)}),u.jsx("div",{className:`grid transition-[grid-template-rows] duration-200 ease-out ${ie.isCollapsed?"grid-rows-[0fr]":"grid-rows-[1fr]"}`,children:u.jsxs("div",{className:`overflow-hidden px-1 transition-opacity duration-200 ease-out ${ie.isCollapsed?"opacity-0":"opacity-100"}`,children:[Rt>0&&ie.nodeCount>0&&u.jsxs("div",{className:"px-3 pb-2 -mt-1 text-xs text-gray-400 text-center",children:[Rt," hidden node",Rt===1?"":"s"]}),Tt?bt(ie.children,tt):!Lt||Gt.has(ie.group.id)?u.jsx(Lb,{containerType:"group",containerId:ie.group.id,hiddenNodeCount:Rt,borderColor:Do(ie.group.color,.3),dashedBorderColor:Do(ie.group.color,.4),onClick:()=>{ye(ie.group.id),oe(ie.subgraphId??null),Fe(!0)}}):null,u.jsx(Eb,{id:`group-footer-${ie.group.id}`,headerId:`group-header-${ie.group.id}`,title:ie.group.title,nodeCount:ie.nodeCount,backgroundColor:Do(ie.group.color,.15),borderColor:Do(ie.group.color,.3),textClassName:"text-gray-500 dark:text-gray-400",className:"group-footer"})]})})]},`group-${ie.group.id}-${tt}`)}if(ie.type==="subgraph"){const Ze=Dt.brand.subgraphBackground08,Ye=Dt.brand.subgraphBorder25,Ct=dt(ie.subgraph.id),mt=Ct.hiddenNodeCount,Tt=rn(Se.get(ie.subgraph.id),`subgraph ${ie.subgraph.id}`),pe=ne.includes(Tt),xt=ne.length<5||pe,yt=lt(ie.children),Vt=yt?"Fold all":"Unfold all",Rt=()=>{yt||m(Tt,!1),st(ie.children,yt)};return u.jsxs("div",{className:"subgraph-wrapper shadow-md rounded-xl border mb-3",style:{backgroundColor:`var(--subgraph-bg, ${Ze})`,borderColor:`var(--subgraph-border, ${Ye})`,"--subgraph-bg":Ze,"--subgraph-border":Ye},"data-reposition-item":`subgraph-${ie.subgraph.id}`,"data-stable-key":Tt,children:[u.jsx(Ib,{containerType:"subgraph",containerId:ie.subgraph.id,title:(ie.subgraph.name||ie.subgraph.id).trim(),nodeCount:ie.nodeCount,isCollapsed:ie.isCollapsed,backgroundColor:Dt.brand.subgraphBackground14,borderColor:Dt.brand.subgraphBorder25,hiddenNodeCount:mt,isBookmarked:pe,canShowBookmarkAction:xt,foldAllLabel:Vt,onToggleCollapse:()=>m(Tt,!ie.isCollapsed),onToggleBookmark:()=>me(Tt),onBypassAll:cn=>A(Tt,cn),onToggleFoldAll:Rt,onShowHiddenNodes:()=>{mt>0&&nt(Ct)},onHide:()=>B(Tt,!0),onDelete:()=>{if(ie.nodeCount===0){F(Tt,{deleteNodes:!1});return}U({stableKey:Tt,containerTypeLabel:"subgraph",containerIdLabel:ie.subgraph.id,displayName:ie.subgraph.name?.trim()||ie.subgraph.id,nodeCount:ie.nodeCount})},onAddNode:()=>{ye(null),oe(ie.subgraph.id),Fe(!0)},onMove:()=>se.openOverlay({type:"subgraph",id:ie.subgraph.id}),onCommitTitle:cn=>te(Tt,cn)}),u.jsx("div",{className:`grid transition-[grid-template-rows] duration-200 ease-out ${ie.isCollapsed?"grid-rows-[0fr]":"grid-rows-[1fr]"}`,children:u.jsxs("div",{className:`overflow-hidden px-1 transition-opacity duration-200 ease-out ${ie.isCollapsed?"opacity-0":"opacity-100"}`,children:[mt>0&&ie.nodeCount>0&&u.jsxs("div",{className:"px-3 pb-2 -mt-1 text-xs text-gray-400 text-center",children:[mt," hidden node",mt===1?"":"s"]}),ie.children.length>0?bt(ie.children,tt):!Lt||xe.has(ie.subgraph.id)?u.jsx(Lb,{containerType:"subgraph",containerId:ie.subgraph.id,hiddenNodeCount:mt,borderColor:Dt.brand.subgraphBorder20,dashedBorderColor:Dt.brand.subgraphBorder25,onClick:()=>{ye(null),oe(ie.subgraph.id),Fe(!0)}}):null,u.jsx(Eb,{id:`subgraph-footer-${ie.subgraph.id}`,headerId:`subgraph-header-${ie.subgraph.id}`,title:ie.subgraph.name||ie.subgraph.id,nodeCount:ie.nodeCount,backgroundColor:Dt.brand.subgraphBackground10,borderColor:Dt.brand.subgraphBorder20,textClassName:"text-blue-600 dark:text-blue-500",className:"subgraph-footer"})]})})]},`subgraph-${ie.subgraph.id}-${tt}`)}return u.jsx("div",{"data-reposition-item":`node-${ie.node.id}`,"data-stable-key":rn(ie.node.stableKey,`node ${ie.node.id}`),children:u.jsx(o5,{node:ie.node,isExecuting:a===String(ie.node.id),isConnectionHighlighted:Oe.has(ie.node.id),errorBadgeLabel:fe[ie.node.id]??null,onImageClick:o,onMoveNode:()=>se.openOverlay({type:"node",id:ie.node.id})})},`node-${ie.node.id}-${tt}`)});let gt;s?Kt.length===0?gt=u.jsx("div",{id:"node-list-empty",className:"flex items-center justify-center h-full text-gray-500",children:u.jsxs("div",{id:"empty-workflow-content",className:"text-center p-8",children:[u.jsx("div",{id:"empty-workflow-icon-container",className:"flex items-center justify-center mb-4",children:u.jsx(kS,{className:"w-10 h-10 text-gray-300"})}),u.jsx("p",{id:"empty-workflow-title",className:"text-lg font-medium",children:"Empty workflow"}),u.jsx("p",{id:"empty-workflow-description",className:"text-sm mt-2",children:"This workflow has no nodes"}),u.jsx("div",{className:"mt-6 w-64 max-w-full mx-auto",children:u.jsx(r5,{onClick:()=>{ye(null),oe(null),Fe(!0)}})})]})}):gt=u.jsxs("div",{id:"node-list-shell",className:"h-full flex flex-col",children:[w&&u.jsx("div",{className:"node-search-bar bg-gray-100 px-4 py-2",children:u.jsx(ql,{inputRef:H,value:S,onChange:j,onClear:Q,placeholder:"Search nodes...",inputClassName:"comfy-input border-gray-300"})}),u.jsx("div",{id:"node-list-container",ref:V,className:"flex-1 overflow-auto px-4 pt-4 overscroll-contain scroll-container",style:{paddingBottom:"10rem"},"data-node-list":"true",children:Be.length===0?u.jsx("div",{className:"flex items-center justify-center h-full text-gray-500",children:u.jsxs("div",{className:"text-center p-8",children:[u.jsx("p",{className:"text-sm font-medium",children:"No matching nodes"}),u.jsx("p",{className:"text-xs mt-2",children:"Try a different search."})]})}):u.jsx("div",{id:"node-list-inner",children:bt(Be,"root")})})]}):gt=u.jsx("div",{id:"node-list-no-workflow",className:"flex items-center justify-center h-full text-gray-500",children:u.jsxs("div",{id:"no-workflow-content",className:"text-center p-8",children:[u.jsx("div",{id:"no-workflow-icon-container",className:"flex items-center justify-center mb-4",children:u.jsx(SS,{className:"w-10 h-10 text-gray-300"})}),u.jsx("p",{id:"no-workflow-title",className:"text-lg font-medium",children:"No workflow loaded"}),u.jsx("p",{id:"no-workflow-description",className:"text-sm mt-2",children:"Open the menu to load a workflow"})]})});const kt=je?.y??d??0,Qt=je?`${je.x}px`:c==="left"?"0.75rem":void 0,en=je?void 0:c==="right"?"0.75rem":void 0,Yt={top:`${kt}px`,left:Qt,right:en,opacity:d==null&&je==null?0:1,touchAction:Ne?"none":"pan-y",pointerEvents:d==null&&je==null?"none":"auto"};return u.jsxs("div",{id:"node-list-wrapper",ref:Le,className:"absolute inset-x-0 top-[69px] bottom-0 bg-gray-100",style:{display:n?"block":"none"},children:[gt,u.jsx(s5,{isOpen:De,addInGroupId:ue,addInSubgraphId:et,onClose:()=>{Fe(!1),ye(null),oe(null)}}),z&&u.jsx(a5,{containerTypeLabel:z.containerTypeLabel,containerIdLabel:z.containerIdLabel,displayName:z.displayName,nodeCount:z.nodeCount,onCancel:()=>U(null),onDeleteContainerOnly:()=>{F(z.stableKey,{deleteNodes:!1}),U(null)},onDeleteContainerAndNodes:()=>{F(z.stableKey,{deleteNodes:!0}),U(null)}}),se.overlayOpen&&se.initialTarget&&u.jsx(HN,{mobileLayout:ee,initialTarget:se.initialTarget,initialViewportAnchor:se.initialViewportAnchor,onDone:se.commitAndClose,onCancel:se.cancelOverlay}),K.length>0&&u.jsx("div",{ref:P,className:`absolute z-[200] flex flex-col items-center gap-2 pointer-events-auto ${Ne?"rounded-2xl ring-2 ring-blue-400/70 bg-white/30 shadow-lg":""}`,style:Yt,onPointerDown:it,onPointerMove:_t,onPointerUp:wt,onPointerCancel:It,children:u.jsxs("div",{className:`flex flex-col items-center gap-2 ${Ne?"p-2 cursor-grab":""}`,children:[K.map((Y,Re)=>u.jsx("button",{type:"button",className:"w-10 h-10 rounded-full border border-transparent bg-gray-900/10 text-[11px] font-bold text-gray-800 shadow-sm backdrop-blur-sm dark:bg-white/10 dark:text-gray-100 select-none",onClick:Ve(Y,Re),children:Y.text},Y.stableKey)),K.length>1&&u.jsx("button",{type:"button",className:"w-10 h-10 rounded-full border border-transparent bg-gray-900/10 text-gray-600 shadow-sm backdrop-blur-sm flex items-center justify-center dark:bg-white/10 dark:text-gray-200 select-none","aria-label":"Cycle bookmarks",onClick:Je,children:u.jsx(so,{className:"w-4 h-4"})})]})})]})}function u5(){const n=ao(q=>q.currentPanel),o=Eo(q=>q.viewerOpen),s=de(q=>q.workflow),a=de(q=>q.isExecuting),l=de(q=>q.progress),c=de(q=>q.executingNodeId),d=de(q=>q.executingPromptId),h=de(q=>q.workflowDurationStats),p=gn(q=>q.error),m=gn(q=>q.nodeErrors),y=gn(q=>q.errorsDismissed),x=gn(q=>q.setErrorsDismissed),v=de(q=>q.scrollToNode),k=gn(q=>q.errorCycleIndex),w=gn(q=>q.setErrorCycleIndex),S=de(q=>q.revealNodeWithParents),j=de(q=>q.nodeTypes),C=Ht(q=>q.running),[T,R]=b.useState(null),B=!(n==="queue")&&!(n==="outputs")&&!o,A=Object.values(m).reduce((q,je)=>q+je.length,0),F=A>0,te=!!p?.startsWith("Workflow load error")||F,ee=te?"Workflow load error":"Prompt error",ae=te&&p?p.replace(/^Workflow load error:\s*/i,""):p??(F?`${A} inputs reference missing options.`:null),ne=(!!p||F)&&!y,me=b.useMemo(()=>{if(!s||!c)return null;const q=s.nodes.find(Ke=>String(Ke.id)===c);return q?j?.[q.type]?.display_name||q.type:`Node ${c}`},[s,c,j]),Le=d||(C[0]?.prompt_id??null),P=Gl({workflow:s,runKey:Le,isRunning:a||C.length>0,workflowDurationStats:h}),V=P===100?100:l,H=()=>{if(!s||!F)return;const q=s.nodes.filter(ye=>m[String(ye.id)]?.length);if(q.length===0)return;const je=k%q.length,Ke=q[je];if(!Ke)return;const De=Ke.id,Fe=Ke.stableKey;if(!Fe)return;const ue=`Error #${je+1}`;S(Fe),w((je+1)%q.length),window.dispatchEvent(new CustomEvent("workflow-label-error-node",{detail:{nodeId:De,label:ue}})),window.dispatchEvent(new CustomEvent("workflow-scroll-to-node",{detail:{nodeId:De,label:ue}})),v(Fe,ue)},ce=q=>{(q.key==="Enter"||q.key===" ")&&(q.preventDefault(),H())},ke=q=>{q.stopPropagation()},Ne=q=>{q.stopPropagation(),x(!0)},O=()=>{Le&&R(Le)},_=T!==null&&T===Le;return B?u.jsxs("div",{id:"bottom-status-overlay",className:"fixed inset-x-0 bottom-20 z-[2000] flex flex-col items-center gap-3 pointer-events-none",children:[ne&&u.jsxs("div",{id:"error-notification-wrapper",className:"relative pointer-events-auto",children:[u.jsx("div",{id:"error-notification-toast",className:"bg-red-100 text-red-900 rounded-xl shadow-lg px-4 py-3 w-[70vw] max-w-sm",role:"button",tabIndex:0,onClick:H,onKeyDown:ce,children:u.jsx("div",{className:"error-toast-content flex items-start justify-between gap-3",children:u.jsxs("div",{className:"error-text-container pr-16",children:[u.jsx("div",{className:"error-title text-sm font-semibold text-red-800",children:ee}),u.jsx("div",{className:"error-message mt-1 text-xs text-red-800 break-words",children:ae})]})})}),u.jsx("button",{id:"error-dismiss-button",type:"button","aria-label":"Dismiss error",className:"absolute top-3 right-3 shrink-0 px-3 py-1 text-xs font-semibold bg-red-700 text-white rounded-full z-10",onPointerDown:ke,onClick:Ne,children:"Dismiss"})]}),P!==null&&!_&&u.jsxs("div",{id:"execution-progress-card",className:"relative bg-white border border-gray-200 rounded-xl shadow-lg px-4 py-2 w-[70vw] max-w-sm pointer-events-auto",children:[u.jsx("button",{type:"button","aria-label":"Dismiss progress",className:"absolute top-2 right-2 w-7 h-7 rounded-full flex items-center justify-center text-gray-400 hover:text-gray-600",onClick:O,children:u.jsx(Ul,{className:"w-4 h-4"})}),u.jsx("div",{className:"executing-node-name text-sm font-semibold text-gray-900",children:me||"Running"}),u.jsxs("div",{className:"node-progress-info mt-2 flex items-center justify-between text-xs text-gray-500",children:[u.jsx("span",{children:"Progress"}),u.jsxs("span",{children:[V,"%"]})]}),u.jsx("div",{className:"node-progress-track mt-1 h-2 rounded-full bg-gray-200 overflow-hidden",children:u.jsx("div",{className:"node-progress-bar h-full bg-green-500 transition-none",style:{width:`${Math.min(100,Math.max(0,V))}%`}})}),P!==null&&u.jsxs("div",{className:"overall-progress-container",children:[u.jsxs("div",{className:"overall-progress-info mt-3 flex items-center justify-between text-xs text-gray-500",children:[u.jsx("span",{children:"Overall"}),u.jsxs("span",{children:[P,"%"]})]}),u.jsx("div",{className:"overall-progress-track mt-1 h-2 rounded-full bg-gray-200 overflow-hidden",children:u.jsx("div",{className:"overall-progress-bar h-full bg-blue-500 transition-none",style:{width:`${Math.min(100,Math.max(0,P))}%`}})})]})]})]}):null}function c5({viewerOpen:n,followQueue:o,queueSize:s,overallProgress:a,onToggleFollowQueue:l,onOpenFollowQueue:c}){const d=b.useCallback(()=>{n?l?.():c?.()},[n,l,c]),h=b.useMemo(()=>n?o?"Disable follow queue":"Enable follow queue":"Open image viewer",[n,o]),p=b.useMemo(()=>n&&o?"bg-green-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200",[n,o]);return u.jsxs("button",{onClick:d,className:`relative w-12 h-12 rounded-xl flex items-center justify-center text-2xl transition-colors ${p}`,"aria-label":h,children:[u.jsx("span",{className:"absolute inset-0 flex items-center justify-center",children:u.jsx(ux,{className:"w-6 h-6",showSlash:n&&!o})}),s>0&&u.jsxs("div",{className:`queue-badge absolute top-0 right-0 translate-x-[18px] -translate-y-[18px] w-6 h-6 rounded-full bg-blue-500 text-white
                     flex items-center justify-center font-bold text-xs border-2 border-white relative z-20`,children:[a!==null&&u.jsx(RS,{className:"absolute z-10 pointer-events-none",width:"24",height:"24",style:{top:"50%",left:"50%",transform:"translate(-50%, -50%) rotate(-90deg)"},progress:a}),s]})]})}function d5(){const n=de(p=>p.workflow),o=yo(p=>p.pinnedWidget),s=yo(p=>p.pinOverlayOpen),a=yo(p=>p.togglePinOverlay),l=de(p=>p.updateNodeWidget),c=b.useMemo(()=>{if(!o||!n)return;const p=n.nodes.find(m=>m.id===o.nodeId);if(p)return es(p,o.widgetName,o.widgetIndex)},[o,n]);if(!s||!o)return null;const h=n?.nodes.find(p=>p.id===o.nodeId)?.stableKey??null;return u.jsx("div",{id:"pin-overlay-hidden-anchor",className:"hidden",children:u.jsx(Bo,{name:o.widgetName,type:o.widgetType,value:c,options:o.options,onChange:p=>h?l(h,o.widgetIndex,p,o.widgetName):void 0,hideLabel:!0,compact:!0,forceModalOpen:!0,onModalClose:a})})}function f5(){const n=Jt(o=>o.setFilterModalOpen);return u.jsx("button",{onClick:()=>n(!0),className:"relative w-12 h-12 rounded-xl flex items-center justify-center text-2xl transition-colors bg-gray-100 text-gray-700 hover:bg-gray-200","aria-label":"Filter and sort",children:u.jsx(wS,{className:"w-6 h-6"})})}function p5(){const n=Jt(a=>a.selectedIds.length),o=Jt(a=>a.setSelectionActionOpen),s=n===0;return u.jsx("button",{onClick:()=>o(!0),disabled:s,className:`relative w-12 h-12 rounded-xl flex items-center justify-center text-2xl transition-colors ${s?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,"aria-label":"Selection actions",children:u.jsx("div",{className:`w-6 h-6 rounded-full border-2 flex items-center justify-center shadow-sm ${s?"border-gray-300 bg-transparent":"bg-blue-600 border-blue-600 text-white"}`,children:!s&&u.jsx(zo,{className:"w-4 h-4"})})})}function h5(){return Jt(o=>o.selectionMode)?u.jsx(p5,{}):u.jsx(f5,{})}function g5(){const n=yo(a=>a.pinnedWidget),o=yo(a=>a.pinOverlayOpen),s=yo(a=>a.togglePinOverlay);return n?u.jsx("button",{onClick:s,className:`relative w-12 h-12 rounded-xl flex items-center justify-center text-2xl transition-colors ${o?"bg-fuchsia-500 text-white":"bg-gray-100 text-fuchsia-500 hover:bg-gray-200"}`,"aria-label":o?"Close pin editor":"Open pin editor",children:u.jsx(_l,{className:"w-6 h-6"})}):null}function m5(){const n=de(c=>c.workflow),o=de(c=>c.runCount),s=de(c=>c.queueWorkflow),a=n!==null,l=()=>{a&&(s(o),"vibrate"in navigator&&navigator.vibrate(20))};return u.jsx("button",{onClick:l,disabled:!a,className:"flex-1 py-3 px-6 rounded-xl font-semibold text-lg min-h-[48px] transition-all "+(a?"bg-blue-500 text-white active:bg-blue-600":"bg-gray-300 text-gray-500 cursor-not-allowed"),children:"Run"})}function y5(){const n=de(l=>l.runCount),o=de(l=>l.setRunCount),s=()=>{o(n-1)},a=()=>{o(n+1)};return u.jsxs("div",{id:"run-count-selector",className:"flex items-center gap-1 bg-gray-100 rounded-lg p-1",children:[u.jsx("button",{onClick:s,disabled:n<=1,className:`w-10 h-10 rounded-lg bg-white shadow-sm flex items-center justify-center
                   text-lg font-medium text-gray-700 disabled:opacity-40 disabled:shadow-none`,children:""}),u.jsx("span",{className:"w-8 text-center font-semibold text-gray-900",children:n}),u.jsx("button",{onClick:a,className:`w-10 h-10 rounded-lg bg-white shadow-sm flex items-center justify-center
                   text-lg font-medium text-gray-700`,children:"+"})]})}function b5(n){const{currentPanel:o,viewerOpen:s=!1,followQueue:a=!1,onToggleFollowQueue:l,onOpenFollowQueue:c}=n,d=o==="outputs",h=de(C=>C.workflow),p=de(C=>C.isExecuting),m=de(C=>C.executingPromptId),y=de(C=>C.workflowDurationStats),x=Ht(C=>C.pending),v=Ht(C=>C.running),k=b.useRef(null),w=x.length+v.length,S=m||(v[0]?.prompt_id??null),j=Gl({workflow:h,runKey:S,isRunning:p||v.length>0,workflowDurationStats:y});return b.useEffect(()=>{const C=k.current;if(!C)return;const T=()=>{const R=C.getBoundingClientRect();document.documentElement.style.setProperty("--bottom-bar-offset",`${R.height}px`)};return T(),window.addEventListener("resize",T),()=>window.removeEventListener("resize",T)},[]),u.jsxs("div",{id:"bottom-bar-root",ref:k,className:"fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 shadow-lg safe-area-bottom z-[2200]",children:[u.jsxs("div",{id:"bottom-bar-content",className:"flex items-center gap-3 px-3 py-2 max-w-lg mx-auto",children:[u.jsx(y5,{}),u.jsx(m5,{}),d&&u.jsx(h5,{}),!d&&u.jsx(g5,{}),u.jsx(c5,{viewerOpen:s,followQueue:a,queueSize:w,overallProgress:j,onToggleFollowQueue:l,onOpenFollowQueue:c})]}),u.jsx(d5,{}),u.jsx(u5,{})]})}const Ab=n=>Symbol.iterator in n,Rb=n=>"entries"in n,Db=(n,o)=>{const s=n instanceof Map?n:new Map(n.entries()),a=o instanceof Map?o:new Map(o.entries());if(s.size!==a.size)return!1;for(const[l,c]of s)if(!a.has(l)||!Object.is(c,a.get(l)))return!1;return!0},x5=(n,o)=>{const s=n[Symbol.iterator](),a=o[Symbol.iterator]();let l=s.next(),c=a.next();for(;!l.done&&!c.done;){if(!Object.is(l.value,c.value))return!1;l=s.next(),c=a.next()}return!!l.done&&!!c.done};function v5(n,o){return Object.is(n,o)?!0:typeof n!="object"||n===null||typeof o!="object"||o===null||Object.getPrototypeOf(n)!==Object.getPrototypeOf(o)?!1:Ab(n)&&Ab(o)?Rb(n)&&Rb(o)?Db(n,o):x5(n,o):Db({entries:()=>Object.entries(n)},{entries:()=>Object.entries(o)})}function w5(n){const o=ga.useRef(void 0);return s=>{const a=n(s);return v5(o.current,a)?o.current:o.current=a}}function Yf(n){return!!n&&typeof n=="object"&&!Array.isArray(n)}function pv(n){return Array.isArray(n)&&n.length>=2&&(typeof n[0]=="string"||typeof n[0]=="number")&&typeof n[1]=="number"}function bc(n){return n.class_type??n.type??null}function dh(n,o){for(const s of o){const a=n.inputs?.[s];if(!pv(a)&&a!==void 0)return a}}function ya(n,o){const s=dh(n,o);if(s!=null)return typeof s=="string"?s:String(s)}function Qf(n,o){if(!pv(o))return null;const s=String(o[0]);return n[s]??null}function S5(n){if(!n)return;const o=ya(n,["sampler_name","sampler","name"]);if(o)return o;if(bc(n)==="KSamplerSelect"&&Array.isArray(n.widgets_values)){const a=n.widgets_values[0];return a==null?void 0:String(a)}}function N5(n){if(!n)return;const o=ya(n,["scheduler","scheduler_name","name"]);if(o)return o;if(bc(n)==="BasicScheduler"&&Array.isArray(n.widgets_values)){const a=n.widgets_values[0];return a==null?void 0:String(a)}}function k5(n){if(!n)return;const o=dh(n,["steps","step_count"]);if(o!==void 0)return o;if(bc(n)==="BasicScheduler"&&Array.isArray(n.widgets_values)){const a=n.widgets_values[1];return a??void 0}}function C5(n){if(!n)return;const o=dh(n,["cfg","guidance","guidance_scale"]);if(o!==void 0)return o;if(Array.isArray(n.widgets_values)){const s=n.widgets_values[0];return s??void 0}}function fh(n){const o={};if(!Yf(n)&&!Array.isArray(n))return o;let s=null;if(Array.isArray(n)&&n.length>=3&&Yf(n[2])?s=n[2]:Yf(n)&&(s=n),!s)return o;const l=Object.entries(s).sort((c,d)=>Number(c[0])-Number(d[0])).map(([,c])=>c);for(const c of l){const d=bc(c);if(d){if(d==="CheckpointLoaderSimple"||d==="CheckpointLoader"){const h=c.inputs?.ckpt_name;typeof h=="string"?o.model=h.replace(/\.(safetensors|ckpt|pt)$/i,""):h!=null&&(o.model=String(h).replace(/\.(safetensors|ckpt|pt)$/i,""))}if(d==="KSampler"||d==="KSamplerAdvanced"){if(o.steps===void 0&&c.inputs?.steps!==void 0&&(o.steps=c.inputs.steps),o.cfg===void 0&&c.inputs?.cfg!==void 0&&(o.cfg=c.inputs.cfg),o.sampler===void 0){const h=ya(c,["sampler_name"]);h&&(o.sampler=h)}if(o.scheduler===void 0){const h=ya(c,["scheduler"]);h&&(o.scheduler=h)}}if(d==="SamplerCustom"||d==="SamplerCustomAdvanced"){if(o.steps===void 0&&c.inputs?.steps!==void 0&&(o.steps=c.inputs.steps),o.cfg===void 0&&c.inputs?.cfg!==void 0&&(o.cfg=c.inputs.cfg),o.sampler===void 0){const h=ya(c,["sampler","sampler_name"]),p=Qf(s,c.inputs?.sampler),m=h??S5(p);m&&(o.sampler=m)}if(o.scheduler===void 0){const h=ya(c,["scheduler","scheduler_name"]),p=Qf(s,c.inputs?.sigmas??c.inputs?.scheduler),m=h??N5(p);m&&(o.scheduler=m)}if(o.steps===void 0){const h=Qf(s,c.inputs?.sigmas??c.inputs?.scheduler),p=k5(h);p!==void 0&&(o.steps=p)}}if(d==="FluxGuidance"&&o.cfg===void 0){const h=C5(c);h!==void 0&&(o.cfg=h)}}}return o}function ph(n,o={}){const{onlyOutput:s=!1,alt:a}=o,l=[];return n.forEach((c,d)=>{const h=c.outputs?.images??[],p=fh(c.prompt),m=c.durationSeconds,y=c.success!==!1;h.forEach((x,v)=>{if(s&&x.type!=="output")return;const k=typeof a=="function"?a(v,d):a,w=x.subfolder?`${x.subfolder}/${x.filename}`:x.filename,S=Pl(x.filename),j=S==="video"?"video":"image";l.push({src:bo(x.filename,x.subfolder,x.type),alt:k,mediaType:S,metadata:p,workflow:c.workflow,promptId:c.prompt_id,durationSeconds:m,success:y,filename:x.filename,file:{id:`${x.type}/${w}`,name:x.filename,type:j,fullUrl:bo(x.filename,x.subfolder,x.type)}})})}),l}function j5({menuState:n,unifiedList:o,onClose:s,onLoadWorkflow:a,onCopyWorkflow:l,onDownload:c,onBatchDownload:d,onDeleteHistory:h,getBatchSources:p}){const m=n?.promptId??"",y=Ht(C=>C.queueItemHideImages[m]),x=Ht(C=>C.toggleQueueItemHideImages),v=()=>{n?.workflow&&n.promptId&&a(n.workflow,n.promptId),s()},k=()=>{l(n?.workflow),s()},w=async()=>{const C=n?.promptId?p(n.promptId,o):[];C.length>1?await d(C):n&&await c(n.imageSrc),s()},S=()=>{x(m),s()},j=()=>{n?.promptId&&h(n.promptId),s()};return n?.open?An.createPortal(u.jsx("div",{id:"queue-image-menu",className:"fixed z-[1200] w-44",style:{top:n.top,right:n.right},children:u.jsx(Sr,{items:[{key:"load-workflow",label:"Load workflow",icon:u.jsx(Ts,{className:"w-4 h-4"}),onClick:v,disabled:!n.workflow},{key:"copy-workflow",label:"Copy workflow",icon:u.jsx(IS,{className:"w-4 h-4"}),onClick:k,disabled:!n.workflow},{key:"download",label:n.promptId&&p(n.promptId,o).length>1?"Download batch":"Download",icon:u.jsx(LS,{className:"w-4 h-4"}),onClick:w},{key:"toggle-images",label:y?"Show images":"Hide images",icon:y?u.jsx(br,{className:"w-4 h-4"}):u.jsx(Yo,{className:"w-4 h-4"}),onClick:S,hidden:!(n.hasVideoOutputs&&n.hasImageOutputs&&n.promptId)},{key:"delete",label:"Delete",icon:u.jsx(Ho,{className:"w-4 h-4"}),onClick:j,color:"danger"}]})}),document.body):null}function M5({message:n}){return n?An.createPortal(u.jsx("div",{className:"fixed top-20 left-1/2 -translate-x-1/2 z-[1300] bg-gray-800 text-white px-4 py-2 rounded-lg shadow-lg text-sm font-medium animate-in fade-in slide-in-from-top-2 duration-200",children:n}),document.body):null}function hv(n){return"outputs"in n}function O5(n,o){const s=o.find(l=>l.id===n);return!s||s.status!=="done"?[]:hv(s.data)?(s.data.outputs.images??[]).filter(l=>l.type==="output").map(l=>bo(l.filename,l.subfolder,l.type)):[]}async function gv(n,o="image.png",s){try{const l=await(await fetch(n)).blob(),c=URL.createObjectURL(l),d=document.createElement("a");d.href=c,d.download=o,document.body.appendChild(d),d.click(),d.remove(),URL.revokeObjectURL(c),s?.(n)}catch(a){console.error("Failed to download image:",a)}}async function T5(n,o){for(const s of n)await gv(s,"image.png",o)}async function E5(n){try{if(navigator.clipboard?.writeText)await navigator.clipboard.writeText(n);else{const o=document.createElement("textarea");o.value=n,o.style.position="fixed",o.style.opacity="0",document.body.appendChild(o),o.select(),document.execCommand("copy"),document.body.removeChild(o)}return!0}catch(o){return console.error("Failed to copy to clipboard:",o),!1}}function I5({item:n,isActuallyRunning:o,progress:s,overallProgress:a,executingNodeLabel:l,onDelete:c,onStop:d,onImageClick:h,viewerImages:p,runningImages:m,onOpenMenu:y,downloaded:x,isTopDoneItem:v}){const k=Ht(W=>W.previewVisibility),w=Ht(W=>W.previewVisibilityDefault),S=Ht(W=>W.showQueueMetadata),j=Ht(W=>W.queueItemExpanded[n.id]),C=Ht(W=>W.setQueueItemExpanded),T=Ht(W=>W.queueItemHideImages[n.id]),R=b.useRef(new Map),D=b.useRef(new Set),[L,B]=b.useState(new Set),A=n.status==="pending"&&!o,F=n.status==="running"||o,te=n.status==="done",ee=j!==void 0,ae=ee?j:!1,ne=b.useRef(te);b.useEffect(()=>{ee||C(n.id,!1)},[ee,n.id,C]),b.useEffect(()=>{!ne.current&&te&&C(n.id,!0),ne.current=te},[te,n.id,C]),b.useEffect(()=>{D.current.clear(),B(new Set)},[n.id]);const me=()=>{C(n.id,!ae)},Le=te&&hv(n.data)?n.data:null,P=b.useMemo(()=>Le?Le.outputs.images:F?m:[],[Le,F,m]),V=!!(n.data.prompt_id?k[n.data.prompt_id]??w:w),{savedImages:H,displayImages:ce}=b.useMemo(()=>{const W=P.filter(I=>I.type==="output"),G=V||W.length===0;return{savedImages:W,displayImages:G?P:P.filter(I=>I.type==="output")}},[V,P]),ke=b.useMemo(()=>P.some(W=>pa(W.filename)),[P]),Ne=b.useMemo(()=>P.some(W=>!pa(W.filename)),[P]),O=b.useMemo(()=>!T||!ke?ce:ce.filter(W=>pa(W.filename)),[ce,ke,T]),_=H.map(W=>({src:bo(W.filename,W.subfolder,W.type),alt:"Generation"})),q="aspect-square w-full bg-gray-100 flex flex-col items-center justify-center text-gray-400",je=Le?.durationSeconds,Ke=Le?Le.success!==!1:!0,De=L5(je),Fe=a===100?100:s,ue=b.useMemo(()=>!S||!n.data.prompt?null:fh(n.data.prompt),[S,n.data.prompt]),ye=b.useMemo(()=>F?O.map(W=>({src:bo(W.filename,W.subfolder,W.type),alt:"Generation",mediaType:Pl(W.filename)})):p,[F,p,O]);b.useEffect(()=>{ae&&O.forEach(W=>{if(!pa(W.filename))return;const G=bo(W.filename,W.subfolder,W.type);if(D.current.has(G))return;D.current.add(G);const I=R.current.get(G);if(!I)return;I.currentTime=0,B(Z=>{const Se=new Set(Z);return Se.delete(G),Se});const $=I.play();$&&typeof $.catch=="function"&&$.catch(()=>{})})},[ae,O]);const et=W=>{W.stopPropagation(),me()},oe=W=>{W.stopPropagation(),d()},z=W=>{W.stopPropagation(),c()},U=W=>{W.stopPropagation();const G=W.currentTarget.getBoundingClientRect(),I=Math.max(8,window.innerWidth-G.right),$=_[0]?.src||"";y({top:G.bottom+6,right:I,imageSrc:$,workflow:Le?.workflow,promptId:n.data.prompt_id||n.id,hasVideoOutputs:ke,hasImageOutputs:Ne})},se=W=>()=>{B(G=>new Set(G).add(W))},fe=W=>()=>{B(G=>{const I=new Set(G);return I.delete(W),I})},M=(W,G,I)=>()=>{const $=ye.findIndex(Z=>Z.src===W);h?.(ye,$>=0?$:G,I)},re=W=>G=>{G.stopPropagation();const I=R.current.get(W);if(!I)return;I.currentTime=0;const $=I.play();$&&typeof $.catch=="function"&&$.catch(()=>{})};return u.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden transition-all duration-300",children:[u.jsxs("div",{onClick:me,className:`px-3 py-2 border-b flex justify-between items-center cursor-pointer select-none ${F?"bg-blue-50 border-blue-100":"bg-gray-50 border-gray-100"}`,children:[u.jsxs("div",{className:"flex items-center gap-1 min-w-0",children:[u.jsx("button",{onClick:et,className:"w-8 h-8 -ml-2 flex items-center justify-center text-gray-400 hover:text-gray-600 shrink-0",children:ae?u.jsx(so,{className:"w-6 h-6"}):u.jsx(js,{className:"w-6 h-6"})}),F&&u.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"}),A&&u.jsx("span",{className:"text-xs font-bold text-gray-400",children:"PENDING"}),F&&u.jsx("span",{className:"text-xs font-bold text-blue-600",children:"GENERATING"}),te&&u.jsx("span",{className:"text-xs font-bold text-gray-500",children:new Date(n.timestamp||0).toLocaleTimeString()}),F&&!ae&&o&&a!=null&&u.jsxs("span",{className:"ml-1 text-xs font-semibold text-blue-600",children:[Math.min(100,Math.max(0,a)),"%"]})]}),u.jsx("div",{className:"flex items-center gap-2",children:F?u.jsx("button",{onClick:oe,className:"px-2 py-1 text-xs font-semibold text-white bg-red-600 rounded hover:bg-red-700",children:"Stop"}):te?u.jsx(ns,{onClick:U,ariaLabel:"Image options",buttonSize:7,iconSize:4}):u.jsx("button",{onClick:z,className:"text-gray-400 hover:text-red-500 px-2",title:A?"Remove from Queue":"Delete from History","aria-label":A?"Remove from Queue":"Delete from History",children:u.jsx(Ul,{className:"w-4 h-4"})})})]}),ae&&u.jsx("div",{className:"relative w-full animate-in fade-in duration-200",children:O.length>0?u.jsx("div",{className:"flex flex-col",children:(()=>{let W=0,G=0;return O.map((I,$)=>{const Z=I.type!=="output",Se=Z?++G:++W,Q=`${Z?"Preview":"Save"} #${Se}`,Me=bo(I.filename,I.subfolder,I.type),K=x[Me],Te=O.length>1;return u.jsxs("div",{className:"relative",children:[De&&u.jsxs("div",{className:`absolute top-2 left-2 flex items-center gap-1 px-2 py-1 rounded text-xs font-semibold ${Ke?"bg-green-600/90 text-white":"bg-red-600/90 text-white"}`,children:[Ke?u.jsx(zo,{className:"w-3.5 h-3.5"}):u.jsx(MS,{className:"w-3.5 h-3.5"}),u.jsx("span",{children:De})]}),pa(I.filename)?u.jsxs(u.Fragment,{children:[u.jsx("video",{src:Me,className:"w-full h-auto block",muted:!0,playsInline:!0,preload:"metadata",ref:_e=>{_e?R.current.set(Me,_e):R.current.delete(Me)},onEnded:se(Me),onPlay:fe(Me),onClick:M(Me,$,v)}),L.has(Me)&&u.jsx("button",{type:"button",className:"absolute inset-0 flex items-center justify-center bg-black/35 text-white",onClick:re(Me),"aria-label":"Replay video",children:u.jsx("span",{className:"flex h-12 w-12 items-center justify-center rounded-full bg-black/60 text-2xl",children:""})})]}):u.jsx("img",{src:Me,alt:"Generation",className:"w-full h-auto block",loading:"lazy",onClick:M(Me,$,v)}),K&&u.jsx("div",{className:"absolute bottom-2 right-2 w-7 h-7 rounded-full bg-black/60 text-white flex items-center justify-center",children:u.jsx(OS,{className:"w-4 h-4"})}),Te&&u.jsx("div",{className:"absolute bottom-2 left-2 px-2 py-1 bg-black/60 text-white text-xs font-medium rounded backdrop-blur-sm shadow-sm pointer-events-none",children:Q}),ue&&u.jsxs("div",{className:`absolute right-2 flex flex-col-reverse items-end gap-1 pointer-events-none ${K?"bottom-10":"bottom-2"}`,children:[ue.model&&u.jsxs("div",{className:"px-1.5 py-0.5 bg-black/50 text-white text-[10px] rounded backdrop-blur-sm",children:["model: ",ue.model]}),ue.sampler&&u.jsxs("div",{className:"px-1.5 py-0.5 bg-black/50 text-white text-[10px] rounded backdrop-blur-sm",children:["sampler: ",ue.sampler]}),ue.steps&&u.jsxs("div",{className:"px-1.5 py-0.5 bg-black/50 text-white text-[10px] rounded backdrop-blur-sm",children:["steps: ",ue.steps]}),ue.cfg&&u.jsxs("div",{className:"px-1.5 py-0.5 bg-black/50 text-white text-[10px] rounded backdrop-blur-sm",children:["cfg: ",ue.cfg]})]})]},$)})})()}):te?u.jsx("div",{className:q,children:u.jsx("span",{className:"text-sm",children:"No images saved"})}):F?u.jsx("div",{className:q,style:{minHeight:"300px"},children:o&&a!=null?u.jsxs("div",{className:"w-full max-w-xs px-4",children:[u.jsxs("p",{className:"font-semibold text-base text-gray-900 mb-3",children:["Executing: ",l||"Running"]}),u.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 mb-1",children:[u.jsx("span",{children:"Progress"}),u.jsxs("span",{children:[Fe,"%"]})]}),u.jsx("div",{className:"h-2 rounded-full bg-gray-200 overflow-hidden",children:u.jsx("div",{className:"h-full bg-green-500 transition-none",style:{width:`${Math.min(100,Math.max(0,Fe))}%`}})}),u.jsxs("div",{className:"mt-3 flex items-center justify-between text-xs text-gray-500 mb-1",children:[u.jsx("span",{children:"Overall"}),u.jsxs("span",{children:[a,"%"]})]}),u.jsx("div",{className:"h-2 rounded-full bg-gray-200 overflow-hidden",children:u.jsx("div",{className:"h-full bg-blue-500 transition-none",style:{width:`${Math.min(100,Math.max(0,a))}%`}})})]}):u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"w-12 h-12 border-4 border-blue-200 border-t-blue-500 rounded-full animate-spin mb-4"}),u.jsx("p",{className:"font-medium text-lg text-blue-600",children:"Generating..."})]})}):u.jsxs("div",{className:q,style:{minHeight:"100px"},children:[u.jsx(GS,{className:"w-8 h-8 text-gray-300"}),u.jsx("span",{className:"text-xs mt-2 opacity-40",children:"Waiting to start..."})]})})]})}function L5(n){const o=n===void 0||Number.isNaN(n)?0:n;return o<10?`${o.toFixed(1)}s`:`${Math.round(o)}s`}function _5({listRef:n,unifiedList:o,visibleCount:s,hasLoadedOnce:a,effectiveExecutingId:l,progress:c,overallProgress:d,executingNodeLabel:h,onDeleteItem:p,onStop:m,onImageClick:y,viewerImages:x,promptOutputs:v,onOpenMenu:k,downloaded:w,firstDoneItemId:S,onScroll:j}){return u.jsxs("div",{ref:n,className:"flex-1 overflow-y-auto p-4 space-y-4 overscroll-contain scroll-container","data-queue-list":"true",onScroll:j,children:[o.length===0&&!a&&u.jsx("div",{className:"flex items-center justify-center min-h-[calc(100vh-180px)] text-gray-400",children:u.jsxs("div",{className:"text-center",children:[u.jsx(Xp,{size:"lg",color:"gray",className:"mx-auto mb-4"}),u.jsx("p",{className:"text-lg",children:"Loading..."})]})}),o.length===0&&a&&u.jsx("div",{className:"flex items-center justify-center min-h-[calc(100vh-180px)] text-gray-500",children:u.jsxs("div",{className:"text-center p-8",children:[u.jsx("div",{className:"flex items-center justify-center mb-4",children:u.jsx(CS,{className:"w-10 h-10 text-gray-300"})}),u.jsx("p",{className:"text-lg font-medium",children:"Queue is empty"}),u.jsx("p",{className:"text-sm mt-2",children:"Run a workflow to see items here"})]})}),o.slice(0,s).map(C=>u.jsx(I5,{item:C,isActuallyRunning:C.id===l,progress:c,overallProgress:d,executingNodeLabel:h,onDelete:()=>p(C),onStop:m,onImageClick:y,viewerImages:x,runningImages:v[C.id]??[],onOpenMenu:k,downloaded:w,isTopDoneItem:C.id===S},C.id)),u.jsx("div",{className:"h-20"})]})}function A5(n,o,s){b.useEffect(()=>{if(!n)return;const a=()=>o(),l=c=>{const d=c.target,h=document.getElementById(s);h&&d&&h.contains(d)||o()};return document.addEventListener("scroll",a,!0),document.addEventListener("mousedown",l),()=>{document.removeEventListener("scroll",a,!0),document.removeEventListener("mousedown",l)}},[n,o,s])}function R5({visible:n,onImageClick:o}){const s=Ht(z=>z.running),a=Ht(z=>z.pending),l=Ht(z=>z.fetchQueue),c=Ht(z=>z.deleteItem),d=Ht(z=>z.interrupt),h=de(z=>z.loadWorkflow),p=ao(z=>z.setCurrentPanel),m=de(z=>z.workflow),y=de(z=>z.nodeTypes),x=de(z=>z.executingNodeId),v=de(z=>z.workflowDurationStats),k=de(z=>z.promptOutputs),w=qn(z=>z.history),S=qn(z=>z.fetchHistory),j=qn(z=>z.deleteItem),{isExecuting:C,progress:T,executingPromptId:R}=de(w5(z=>({isExecuting:z.isExecuting,progress:z.progress,executingPromptId:z.executingPromptId}))),D=R||(s.length===1?s[0].prompt_id:null),L=b.useMemo(()=>{if(!m||!x)return null;const z=m.nodes.find(se=>String(se.id)===x);return z?y?.[z.type]?.display_name||z.type:`Node ${x}`},[m,x,y]),B=Gl({workflow:m,runKey:R||D,isRunning:C||!!D,workflowDurationStats:v}),[A,F]=b.useState(null),[te,ee]=b.useState({}),[ae,ne]=b.useState(null),[me,Le]=b.useState(!1),[P,V]=b.useState(0),H=b.useRef(null),ce=b.useRef(0),ke=b.useRef(!1),Ne=b.useRef(!1);b.useEffect(()=>{n&&(ke.current||Ne.current&&H.current&&(H.current.scrollTop=0),Promise.all([l(),S()]).then(()=>{Le(!0)})),ke.current=n,Ne.current||(Ne.current=!0)},[n,l,S]),b.useEffect(()=>{!C&&n&&S()},[C,n,S]),A5(!!A?.open,()=>F(null),"queue-image-menu");const O=async z=>{if(!z)return;const U=JSON.stringify(z,null,2),se=await E5(U);ne(se?"Copied to clipboard":"Failed to copy"),setTimeout(()=>ne(null),2e3)},_=async z=>{await gv(z,"image.png",U=>{ee(se=>({...se,[U]:!0}))})},q=b.useMemo(()=>{const z={};w.forEach(se=>{z[se.prompt_id]={id:se.prompt_id,status:"done",data:se,timestamp:se.timestamp}}),s.forEach(se=>{z[se.prompt_id]||(z[se.prompt_id]={id:se.prompt_id,status:"running",data:se})}),a.forEach(se=>{z[se.prompt_id]||(z[se.prompt_id]={id:se.prompt_id,status:"pending",data:se})}),R&&z[R]&&(z[R].status="running");const U=Object.values(z);return U.sort((se,fe)=>{const M={pending:0,running:1,done:2};if(M[se.status]!==M[fe.status])return M[se.status]-M[fe.status];if(se.status==="pending"){const re=se.data.number;return fe.data.number-re}return se.status==="done"?(fe.timestamp||0)-(se.timestamp||0):0}),U},[a,s,w,R]),je=b.useMemo(()=>{if(q.length===0)return 0;const z=q.filter(M=>M.status==="pending").length,U=q.filter(M=>M.status==="running").length,fe=q.filter(M=>M.status==="done").length>0?1:0;return Math.min(q.length,z+U+fe)},[q]),Ke=b.useMemo(()=>{const z=q.filter(U=>U.status==="done").map(U=>U.data);return ph(z,{alt:"Generation"})},[q]),De=b.useMemo(()=>q.find(U=>U.status==="done")?.id??null,[q]);b.useEffect(()=>{n&&(ce.current=q.length,queueMicrotask(()=>{V(z=>Math.max(z,je))}))},[n,q.length,je]),b.useEffect(()=>{if(!n)return;const z=H.current;z&&(P>=q.length||z.scrollHeight<=z.clientHeight+20&&queueMicrotask(()=>{V(U=>Math.min(q.length,U+10))}))},[n,P,q.length]);const Fe=z=>{z.status==="pending"&&c(z.id),z.status==="done"&&j(z.id)},ue=z=>{const{top:U,right:se,imageSrc:fe,workflow:M,promptId:re,hasVideoOutputs:W,hasImageOutputs:G}=z;F({open:!0,top:U,right:se,imageSrc:fe,workflow:M,promptId:re,hasVideoOutputs:W,hasImageOutputs:G})},ye=()=>{const z=H.current;if(!z)return;z.scrollHeight-z.scrollTop-z.clientHeight<400&&V(se=>Math.min(ce.current,se+10))},et=(z,U)=>{h(z,`history-${U}.json`,{source:{type:"history",promptId:U}}),p("workflow")},oe=async z=>{await T5(z,U=>{ee(se=>({...se,[U]:!0}))})};return u.jsx("div",{id:"queue-panel-wrapper",className:"absolute inset-x-0 top-[69px] bottom-0",style:{display:n?"block":"none"},children:u.jsxs("div",{className:"flex flex-col bg-gray-100 min-h-full",children:[u.jsx(_5,{listRef:H,unifiedList:q,visibleCount:P,hasLoadedOnce:me,effectiveExecutingId:D,progress:T,overallProgress:B,executingNodeLabel:L,onDeleteItem:Fe,onStop:d,onImageClick:o,viewerImages:Ke,promptOutputs:k,onOpenMenu:ue,downloaded:te,firstDoneItemId:De,onScroll:ye}),u.jsx(j5,{menuState:A,unifiedList:q,onClose:()=>F(null),onLoadWorkflow:et,onCopyWorkflow:O,onDownload:z=>_(z),onBatchDownload:oe,onDeleteHistory:z=>j(z),getBatchSources:O5}),u.jsx(M5,{message:ae})]})})}let Xf=null,Bu=[];function Bb(n){return encodeURIComponent(n)}async function D5(){if(Bu.length===0)return;const n=[...Bu];Bu=[];const o=n.map(s=>{const a=new Date(s.timestamp).toISOString(),l=s.data!==void 0?` | ${JSON.stringify(s.data)}`:"";return`${a} ${s.message}${l}`}).join(`
`)+`
`;try{let s="";try{const l=await fetch(`${sn}/api/userdata/${Bb("mobile-debug.log")}`);l.ok&&(s=await l.text())}catch{}const a=s+o;await fetch(`${sn}/api/userdata/${Bb("mobile-debug.log")}?overwrite=true`,{method:"POST",headers:{"Content-Type":"text/plain"},body:a})}catch(s){console.error("[debugLog] Failed to write to server:",s)}}function B5(){Xf||(Xf=setTimeout(()=>{Xf=null,D5()},500))}function Tp(n,o){const s={timestamp:Date.now(),message:n,data:o};Bu.push(s),o!==void 0?console.log(`[DEBUG] ${n}`,o):console.log(`[DEBUG] ${n}`),B5()}function z5(n,o,s){const a=n.closest("[data-textarea-root]")?.querySelector("[data-textarea-header]"),l=getComputedStyle(document.documentElement),c=parseFloat(l.getPropertyValue("--top-bar-offset"))||0,d=window.visualViewport?.offsetTop??0,h=window.visualViewport?.height??window.innerHeight,p=c+8,m=mv(n),y=a?.getBoundingClientRect(),x=m===window?{type:"window",scrollY:window.scrollY}:(()=>{const B=m;return{type:"element",tag:B.tagName.toLowerCase(),scrollTop:B.scrollTop,height:B.clientHeight}})();Tp("textarea-scroll: start",{reason:s,behavior:o,headerTop:y?.top??null,layoutTopEdge:p,viewportTopEdge:d+c+8,viewportTop:d,viewportHeight:h,topBarOffset:c,container:x,selectionStart:n.selectionStart});const v=$5(n),k=d+c+h*.25,w=d+h-24,S=y?y.top-p:null,j=v-k,C=v>w?v-w:0;let T=0;const R=S!==null&&S>2,D=R?v-S:v,L=D<=w;R&&L?T=S??0:!R&&v<=w?T=0:(T=j,C>T&&(T=C)),T<0&&(T=0),y&&S!==null&&y.top>p+2&&T>S&&(T=S),Tp("textarea-scroll: align",{caretTop:v,targetTop:k,visibilityBottom:w,deltaHeader:S,deltaCaret:j,deltaCaretMin:C,caretAfterHeader:D,caretVisibleAfterHeader:L,canAlignHeader:R,delta:T}),Math.abs(T)>8&&yv(m,T,o)}function H5(n){const o=n.closest("[data-textarea-root]")?.querySelector("[data-textarea-header]");if(!o)return;const s=getComputedStyle(document.documentElement),l=(parseFloat(s.getPropertyValue("--top-bar-offset"))||0)+8,c=o.getBoundingClientRect(),d=c.top-l;if(Math.abs(d)<2)return;const h=mv(n);Tp("textarea-scroll: align-header-request",{headerTop:c.top,layoutTopEdge:l,delta:d}),yv(h,d,"auto")}function $5(n){const o=n.getBoundingClientRect(),s=K5(n);return o.top+s-n.scrollTop}function K5(n){const o=n.selectionStart??0,s=n.value,a=document.createElement("div"),l=getComputedStyle(n),c=a.style;c.position="absolute",c.top="0",c.left="-9999px",c.visibility="hidden",c.whiteSpace="pre-wrap",c.wordWrap="break-word",c.overflowWrap="break-word",c.boxSizing=l.boxSizing,c.width=`${n.clientWidth}px`,c.padding=l.padding,c.border=l.border,c.fontFamily=l.fontFamily,c.fontSize=l.fontSize,c.fontWeight=l.fontWeight,c.fontStyle=l.fontStyle,c.letterSpacing=l.letterSpacing,c.lineHeight=l.lineHeight,c.textTransform=l.textTransform,c.textIndent=l.textIndent,c.tabSize=l.tabSize;const d=document.createTextNode(s.slice(0,o)),h=document.createElement("span");h.textContent=s.slice(o,o+1)||" ",h.style.display="inline-block",h.style.width="1px",a.appendChild(d),a.appendChild(h),document.body.appendChild(a);const p=a.getBoundingClientRect(),y=h.getBoundingClientRect().top-p.top;return document.body.removeChild(a),y}function Zf(n){n?document.body.dataset.textareaFocus="true":delete document.body.dataset.textareaFocus}function mv(n){let o=n?.parentElement??null;for(;o;){const a=getComputedStyle(o).overflowY;if((a==="auto"||a==="scroll")&&o.scrollHeight>o.clientHeight)return o;o=o.parentElement}return window}function yv(n,o,s="smooth"){if(Math.abs(o)<1)return;if(n===window){window.scrollBy({top:o,behavior:s});return}const a=n;a.scrollTo({top:a.scrollTop+o,behavior:s})}function bv(){const[n,o]=b.useState(!1),s=b.useRef(null),a=b.useRef(null),l=b.useRef(null);return b.useEffect(()=>{const c=h=>{const p=h.target;if(!(p instanceof HTMLElement))return;const m=p.tagName.toLowerCase();if((p.isContentEditable||m==="input"||m==="textarea"||m==="select")&&o(!0),p instanceof HTMLTextAreaElement){Zf(!0);const y=()=>z5(p,"smooth","focus");s.current&&clearTimeout(s.current),a.current&&window.visualViewport&&(window.visualViewport.removeEventListener("resize",a.current),a.current=null),l.current&&(document.removeEventListener("selectionchange",l.current),l.current=null);const x=()=>{document.activeElement===p&&(y(),l.current&&(document.removeEventListener("selectionchange",l.current),l.current=null))};if(l.current=x,document.addEventListener("selectionchange",x),setTimeout(()=>{l.current&&(document.removeEventListener("selectionchange",l.current),l.current=null)},1200),window.visualViewport){let v=!1;const k=()=>{v=!0,y(),a.current&&(window.visualViewport?.removeEventListener("resize",a.current),a.current=null)};a.current=k,window.visualViewport.addEventListener("resize",k),s.current=setTimeout(()=>{v||y(),setTimeout(y,300),a.current&&(window.visualViewport?.removeEventListener("resize",a.current),a.current=null)},600)}else requestAnimationFrame(y)}},d=()=>{const h=document.activeElement;if(!(h instanceof HTMLElement)){o(!1),Zf(!1),l.current&&(document.removeEventListener("selectionchange",l.current),l.current=null);return}const p=h.tagName.toLowerCase(),m=h.isContentEditable||p==="input"||p==="textarea"||p==="select";o(m),Zf(h instanceof HTMLTextAreaElement)};return document.addEventListener("focusin",c),document.addEventListener("focusout",d),()=>{document.removeEventListener("focusin",c),document.removeEventListener("focusout",d),s.current&&clearTimeout(s.current),a.current&&window.visualViewport&&(window.visualViewport.removeEventListener("resize",a.current),a.current=null),l.current&&(document.removeEventListener("selectionchange",l.current),l.current=null)}},[]),b.useEffect(()=>{const c=d=>{const p=d.detail?.textarea;p&&H5(p)};return document.addEventListener("textarea-align-header",c),()=>{document.removeEventListener("textarea-align-header",c)}},[]),{isInputFocused:n}}function V5({index:n,total:o,displayName:s}){return u.jsx("div",{id:"media-viewer-header",className:"absolute top-0 inset-x-0 px-3 pt-3 pb-4 bg-gradient-to-b from-black/50 to-transparent",children:u.jsxs("div",{className:"grid grid-cols-3 items-center",children:[u.jsxs("div",{className:"flex items-center gap-3 text-white text-sm",children:[n+1," / ",o]}),u.jsx("div",{className:"justify-self-center text-white/90 text-sm font-medium max-w-[70vw] truncate",children:s}),u.jsx("div",{})]})})}function U5({onClick:n}){return u.jsx("button",{type:"button",onClick:n,"aria-label":"Delete output",className:"pointer-events-auto w-9 h-9 rounded-full bg-black/40 text-red-500 flex items-center justify-center hover:bg-black/60 transition-colors",children:u.jsx(Ho,{className:"w-5 h-5"})})}function W5({onClick:n}){return u.jsx("button",{type:"button",onClick:n,"aria-label":"Load workflow",className:"pointer-events-auto w-9 h-9 rounded-full bg-black/40 text-white flex items-center justify-center hover:bg-black/60 transition-colors",children:u.jsx(Ts,{className:"w-5 h-5"})})}function F5({onClick:n}){return u.jsx("button",{type:"button",onClick:n,"aria-label":"Use in workflow",className:"pointer-events-auto w-9 h-9 rounded-full bg-black/40 text-white flex items-center justify-center hover:bg-black/60 transition-colors",children:u.jsx(ix,{className:"w-5 h-5"})})}function q5({onClick:n,disabled:o}){return u.jsx("button",{type:"button",onClick:n,"aria-label":"Toggle metadata",className:`pointer-events-auto w-9 h-9 rounded-full bg-black/40 text-white flex items-center justify-center hover:bg-black/60 transition-colors ${o?"opacity-40":""}`,disabled:o,children:u.jsx(lx,{className:"w-5 h-5"})})}function G5({isVideo:n,canLoadWorkflow:o,showMetadataToggle:s,canToggleMetadata:a,onDelete:l,onLoadWorkflow:c,onUseInWorkflow:d,onToggleMetadata:h}){return u.jsxs("div",{className:"absolute inset-x-0 px-3 pb-2 pt-2 flex items-center justify-between",style:{bottom:"calc(var(--bottom-bar-offset, 0px) + 4px)"},children:[u.jsx(U5,{onClick:l}),u.jsxs("div",{className:"flex items-center gap-2",children:[o&&u.jsx(W5,{onClick:c}),!n&&u.jsxs(u.Fragment,{children:[u.jsx(F5,{onClick:d}),s&&u.jsx(q5,{onClick:h,disabled:!a})]})]})]})}function P5({isVideo:n,showMetadataToggle:o,showMetadataOverlay:s,metadataIsLoading:a,metadata:l,durationLabel:c}){return o?u.jsx("div",{className:`absolute right-3 flex flex-col items-end gap-1 pointer-events-none transition-opacity duration-300 ${s?"opacity-100":"opacity-0"}`,style:{bottom:n?"calc(var(--bottom-bar-offset, 0px) + 120px)":"calc(var(--bottom-bar-offset, 0px) + 64px)"},children:a?u.jsx("div",{className:"px-1.5 py-0.5 bg-black/50 text-white text-[10px] rounded backdrop-blur-sm",children:"Loading metadata..."}):l?u.jsxs(u.Fragment,{children:[l.model&&u.jsxs("div",{className:"px-1.5 py-0.5 bg-black/50 text-white text-[10px] rounded backdrop-blur-sm",children:["model: ",l.model]}),l.sampler&&u.jsxs("div",{className:"px-1.5 py-0.5 bg-black/50 text-white text-[10px] rounded backdrop-blur-sm",children:["sampler: ",l.sampler]}),l.steps&&u.jsxs("div",{className:"px-1.5 py-0.5 bg-black/50 text-white text-[10px] rounded backdrop-blur-sm",children:["steps: ",l.steps]}),l.cfg&&u.jsxs("div",{className:"px-1.5 py-0.5 bg-black/50 text-white text-[10px] rounded backdrop-blur-sm",children:["cfg: ",l.cfg]}),c&&u.jsxs("div",{className:"px-1.5 py-0.5 bg-black/50 text-white text-[10px] rounded backdrop-blur-sm",children:["time: ",c]})]}):u.jsx("div",{className:"px-1.5 py-0.5 bg-black/50 text-white text-[10px] rounded backdrop-blur-sm",children:"No metadata found"})}):null}function Os(n){return n.id.startsWith("input/")?"input":n.id.startsWith("temp/")?"temp":"output"}function kr(n,o){const a=`${o??Os(n)}/`;return n.id.startsWith(a)?n.id.slice(a.length):n.id}function xv(n){return`output-${n.replace(/[\\/]/g,"_")}.json`}function vv(n,o){const s=n.file&&o?o.get(n.file.id):null,a=n.workflow??s?.workflow,l=n.promptId??s?.promptId;if(!a)return null;const c=l?{type:"history",promptId:l}:{type:"other"},d=l?`history-${l}.json`:n.file?xv(kr(n.file,Os(n.file))):"workflow.json";return{workflow:a,filename:d,source:c}}async function wv(n){const{file:o,source:s,loadWorkflow:a,onLoaded:l,onError:c}=n;try{const d=s??Os(o),h=kr(o,d),p=await n2(h,d);a(p,xv(h),{source:{type:"other"}}),l?.()}catch(d){throw c?.(d),d}}function Y5(n){const{workflow:o,nodeTypes:s,nodeId:a}=n;if(!o||!s)return null;const l=o.nodes.find(d=>d.id===a);if(!l)return null;const c=["image","filename","file"];for(const d of c){const h=Vn(o,s,l,d);if(h!==null)return{node:l,index:h,name:d}}return null}function zb(n,o){const s=n.title,a=typeof s=="string"&&s.trim()?s.trim():null,l=o?.[n.type];return a||l?.display_name||n.type}const Q5={x:0,y:0},Ep=2100,Jf=Ep+10,ep=new Map;function X5(n,o){return`${n}:${o}`}function Sv({open:n,items:o,index:s,onIndexChange:a,onClose:l,onDelete:c,onLoadWorkflow:d,onLoadInWorkflow:h,showMetadataToggle:p=!1,showLoadingPlaceholder:m=!1,loadingProgress:y=0,loadingLabel:x,initialScale:v=1,initialTranslate:k=Q5,onTransformChange:w,zoomResetKey:S}){const j=b.useRef(null),C=b.useRef(null),T=b.useRef(null),R=b.useRef(null),D=b.useRef(null),[L,B]=b.useState(1),[A,F]=b.useState({x:0,y:0}),te=b.useRef(1),ee=b.useRef({x:0,y:0}),ae=b.useRef(null),ne=b.useRef(null),me=b.useRef(null),Le=b.useRef(null),[P,V]=b.useState(null),[H,ce]=b.useState(null),[ke,Ne]=b.useState(!1),[O,_]=b.useState(!1),q=b.useRef(null),je=b.useRef("fit"),[Ke,De]=b.useState({}),[Fe,ue]=b.useState({}),[ye,et]=b.useState({}),[oe,z]=b.useState({}),[U,se]=b.useState(!1),{isInputFocused:fe}=bv(),M=s>=0?o[s]??o[0]??null:null,re=M?.filename??M?.file?.name??M?.alt??M?.src??"",W=!!(M?.mediaType==="video"||M?.file?.type==="video"||re&&pa(re)),G=M?.file?.id??null,I=G?Ke[G]:void 0,$=M?.metadata??(I===void 0?void 0:I),Z=Z5(M?.durationSeconds),Se=M?.filename||M?.alt||"Output",Q=O&&!ke,Me=p,K=G?!!Fe[G]:!1,Te=G?Object.prototype.hasOwnProperty.call(ye,G):!1,_e=G?!!oe[G]:!1,qe=!W||!!M?.workflow||(G?!!ye[G]:!1),Ge=b.useCallback(()=>{Ne(!1),q.current&&clearTimeout(q.current),q.current=setTimeout(()=>{Ne(!0)},3e3)},[]),Ve=b.useCallback(()=>{Ge(),_(J=>!J)},[Ge]),Je=b.useCallback(()=>{M&&(Ge(),c(M))},[M,c,Ge]),Ue=b.useCallback(()=>{M&&(Ge(),d(M))},[M,d,Ge]),Xe=b.useCallback(()=>{M&&(Ge(),h(M))},[M,h,Ge]);b.useEffect(()=>(n?queueMicrotask(Ge):q.current&&clearTimeout(q.current),()=>{q.current&&clearTimeout(q.current)}),[n,Ge]),b.useLayoutEffect(()=>{n&&(B(v),F(k),te.current=v,ee.current=k,ae.current=null,ne.current=null,me.current=null,Le.current=null,je.current="fit")},[n,s,v,k]),b.useEffect(()=>{if(!n||!W||M?.workflow||!M?.file||!G||Te||_e)return;const J=Os(M.file),be=kr(M.file,J),Ie=X5(J,be),Be=ep.get(Ie);if(Be!==void 0){et(Oe=>({...Oe,[G]:Be}));return}const We=new AbortController;return z(Oe=>({...Oe,[G]:!0})),o2(be,J,{signal:We.signal}).then(Oe=>{ep.set(Ie,Oe),et(lt=>({...lt,[G]:Oe}))}).catch(()=>{We.signal.aborted||(ep.set(Ie,!1),et(Oe=>({...Oe,[G]:!1})))}).finally(()=>{We.signal.aborted||z(Oe=>({...Oe,[G]:!1}))}),()=>{We.abort()}},[n,W,M,G,Te,_e]),b.useEffect(()=>{D.current=null,V(null),se(!1)},[M?.src]),b.useEffect(()=>{if(n)return document.body.style.overflow="hidden",()=>{document.body.style.overflow=""}},[n]),b.useEffect(()=>{n&&w&&w(L,A)},[n,L,A,w]),b.useEffect(()=>{if(!n)return;const J=be=>{be.key==="Escape"&&l()};return document.addEventListener("keydown",J),()=>document.removeEventListener("keydown",J)},[n,l]),b.useEffect(()=>{if(!n||!p||!M?.file||M.metadata||!G||$!==void 0||K)return;const J=Os(M.file),be=kr(M.file,J);ue(Ie=>({...Ie,[G]:!0})),r2(be,J).then(Ie=>{const Be=Ie?.prompt?fh(Ie.prompt):null,We=Be&&Object.keys(Be).length>0?Be:null;De(Oe=>({...Oe,[G]:We}))}).catch(()=>{De(Ie=>({...Ie,[G]:null}))}).finally(()=>{ue(Ie=>({...Ie,[G]:!1}))})},[n,p,M,G,$,K]);const Pe=b.useMemo(()=>!P||!H?null:H.height/P.height,[P,H]),he=b.useMemo(()=>Pe===null?1:Math.min(1,Pe),[Pe]),Qe=b.useMemo(()=>Pe===null?1:Math.max(1,Pe),[Pe]),ut=(J=L,be=P)=>{if(!be||!H)return{x:0,y:0};const Ie=be.width*J,Be=be.height*J;return{x:Ie<H.width?(H.width-Ie)/2:0,y:Be<H.height?(H.height-Be)/2:0}},it=b.useCallback((J,be=L)=>{if(!P||!H)return J;const Ie=H.width,Be=H.height,We=P.width*be,Oe=P.height*be,lt=We<=Ie?0:Math.max(Ie-We,Math.min(0,J.x)),st=Oe<=Be?0:Math.max(Be-Oe,Math.min(0,J.y));return{x:lt,y:st}},[P,H,L]),_t=b.useRef(it),Ot=b.useCallback(J=>{let be=he;if(J==="cover"?be=Qe:be=he,je.current=J,te.current=be,B(be),!P||!H)ee.current={x:0,y:0},F({x:0,y:0});else{const Ie=P.width*be,Be=P.height*be,We={x:(H.width-Ie)/2,y:(H.height-Be)/2},Oe=it(We,be);ee.current=Oe,F(Oe)}},[P,it,H,Qe,he]),wt=b.useRef(Ot);b.useEffect(()=>{_t.current=it},[it]),b.useEffect(()=>{wt.current=Ot},[Ot]);const It=J=>{const be=J.currentTarget;D.current={width:be.naturalWidth,height:be.naturalHeight};const Ie=C.current;if(!Ie||be.naturalWidth===0)return;const Be=Ie.clientWidth,We=Ie.clientHeight,Oe=Be/be.naturalWidth;V({width:Be,height:be.naturalHeight*Oe}),ce({width:Be,height:We})};b.useEffect(()=>{if(W||!n)return;const J=T.current,be=C.current;if(!J||!be)return;const Ie=()=>{const We=D.current,Oe=be.clientWidth,lt=be.clientHeight;if(ce({width:Oe,height:lt}),!We||We.width===0)return;const st=Oe/We.width,at=We.height*st;V({width:Oe,height:at});const ct=_t.current(ee.current);ee.current=ct,F(ct)};Ie();const Be=new ResizeObserver(Ie);return Be.observe(be),()=>Be.disconnect()},[n,M?.src,W]),b.useEffect(()=>{W||!n||!P||!H||wt.current(je.current)},[n,M?.src,P,H,W]),b.useEffect(()=>{n&&S!==void 0&&wt.current(je.current)},[n,S]);const Kt=()=>{const J=T.current;if(!J)return;const be=te.current,Ie=ee.current,Be=ut(be);J.style.transform=`translate3d(${Be.x+Ie.x}px, ${Be.y+Ie.y}px, 0) scale(${be})`},pt=J=>{if(W){const Ie=R.current;if(Ie&&J.target===Ie){const Be=Ie.getBoundingClientRect();if(J.clientY>Be.bottom-60)return}}J.currentTarget.setPointerCapture(J.pointerId);const be=tp(C.current);if(be.set(J.pointerId,{x:J.clientX,y:J.clientY}),be.size===1){if(ne.current={x:J.clientX,y:J.clientY,time:Date.now()},!W){ae.current={x:J.clientX-ee.current.x,y:J.clientY-ee.current.y};const Ie=T.current;Ie&&(Ie.style.transition="none")}}else if(be.size===2&&!W){const[Ie,Be]=Array.from(be.values()),We=Math.hypot(Be.x-Ie.x,Be.y-Ie.y),Oe=(Ie.x+Be.x)/2,lt=(Ie.y+Be.y)/2,st=C.current?.getBoundingClientRect(),at=te.current,ct=ee.current,dt=ut(at),nt=st?{x:(Oe-st.left-dt.x-ct.x)/at,y:(lt-st.top-dt.y-ct.y)/at}:void 0;me.current={distance:We,scale:at,centerX:Oe,centerY:lt,imagePoint:nt}}},Lt=J=>{const be=tp(C.current);if(be.has(J.pointerId)){if(be.set(J.pointerId,{x:J.clientX,y:J.clientY}),be.size===2&&me.current&&!W){const Ie=me.current,[Be,We]=Array.from(be.values()),Oe=Math.hypot(We.x-Be.x,We.y-Be.y),st=Math.max(he,Math.min(5,Ie.scale*(Oe/Ie.distance)));te.current=st;const at=C.current?.getBoundingClientRect(),ct=(Be.x+We.x)/2,dt=(Be.y+We.y)/2;if(at&&Ie.imagePoint){const nt=ut(st),bt={x:ct-at.left-nt.x-Ie.imagePoint.x*st,y:dt-at.top-nt.y-Ie.imagePoint.y*st};ee.current=it(bt,st)}else ee.current=it(ee.current,st);Kt();return}if(be.size===1&&!W){const Ie=te.current;(Ie>1||P&&C.current&&P.height*Ie>C.current.clientHeight+1)&&ae.current&&(ee.current=it({x:J.clientX-ae.current.x,y:J.clientY-ae.current.y},Ie),Kt())}}},Gt=J=>{const be=tp(C.current);if(be.delete(J.pointerId),be.size<2){if(be.size===1&&me.current){const[Ie]=Array.from(be.values());ae.current={x:Ie.x-ee.current.x,y:Ie.y-ee.current.y}}me.current=null}if(be.size===0){const Ie=T.current;Ie&&(Ie.style.transition="transform 0.05s linear");const Be=Date.now(),We=Le.current,Oe=We?J.clientX-We.x:0,lt=We?J.clientY-We.y:0,st=!!(We&&Be-We.time<300&&Math.hypot(Oe,lt)<24);if(!W&&st){Le.current=null;const at=je.current;Ot(at==="fit"?"cover":"fit"),Ge()}else{Le.current={time:Be,x:J.clientX,y:J.clientY};const at=ne.current;if(!fe&&at){const ct=J.clientX-at.x,dt=J.clientY-at.y,nt=Date.now()-at.time,bt=Math.abs(ct),gt=Math.abs(dt),kt=te.current,Qt=Math.abs(kt-he)<.05||Math.abs(kt-Qe)<.05,en=nt<250&&bt<10&&gt<10;nt<=350&&bt>60&&bt>gt&&Qt?ct<0?s<o.length-1&&a(s+1):ct>0&&s>0&&a(s-1):en&&Ge()}B(te.current),F(ee.current)}ae.current=null}},xe=b.useCallback(J=>{if(W||!J.ctrlKey)return;J.preventDefault();const be=-J.deltaY*.005,Ie=Math.max(he,Math.min(5,te.current+be));te.current=Ie,B(Ie);const Be=it(ee.current,Ie);ee.current=Be,F(Be)},[it,he,W]);return b.useEffect(()=>{const J=j.current;if(J)return J.addEventListener("wheel",xe,{passive:!1}),()=>{J.removeEventListener("wheel",xe)}},[xe]),n?!M&&!m?An.createPortal(u.jsxs("div",{className:"fixed inset-0 bg-black flex flex-col items-center justify-center text-white",style:{zIndex:Ep},role:"dialog","aria-modal":"true",children:[u.jsx(Rl,{onClick:l,buttonSize:9,iconSize:6,zIndex:Jf}),u.jsx("p",{className:"text-gray-400 mb-2",children:"No images to display"}),u.jsxs("p",{className:"text-gray-500 text-sm",children:["images: ",o.length,", index: ",s]})]}),document.body):An.createPortal(u.jsxs("div",{ref:j,id:"media-viewer-overlay",className:"fixed inset-0 bg-black",style:{zIndex:Ep},children:[u.jsx("div",{ref:C,className:`absolute inset-x-0 top-0 overflow-hidden ${W?"":"touch-none"}`,style:{overscrollBehavior:"contain",height:"calc(100vh - var(--bottom-bar-offset, 0px))",zIndex:1},onPointerDown:pt,onPointerMove:Lt,onPointerUp:Gt,onPointerCancel:Gt,children:m?u.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center text-white",children:[u.jsx("div",{className:"w-12 h-12 border-4 border-gray-600 border-t-white rounded-full animate-spin"}),u.jsx("div",{className:"mt-4 w-48 h-2 rounded-full bg-gray-700 overflow-hidden",children:u.jsx("div",{className:"h-full bg-white transition-all duration-300",style:{width:`${Math.min(100,Math.max(0,y))}%`}})}),u.jsx("div",{className:"mt-2 text-sm text-gray-300",children:x??`${Math.min(100,Math.max(0,y))}%`})]}):M&&u.jsx(u.Fragment,{children:W?u.jsxs(u.Fragment,{children:[u.jsx("video",{ref:R,src:M.src,controls:!0,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,className:"w-full h-full object-contain select-none",onDragStart:J=>J.preventDefault(),onError:()=>se(!0)}),U&&u.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-white text-sm bg-black/60",children:"Unable to play this video."})]}):u.jsx("img",{ref:T,src:M.src,alt:M.alt||"Generation",className:"w-full h-auto block select-none relative",draggable:!1,onLoad:It,style:{transform:`translate3d(${ut(L).x+A.x}px, ${ut(L).y+A.y}px, 0) scale(${L})`,transformOrigin:"top left",willChange:"transform",backfaceVisibility:"hidden",WebkitBackfaceVisibility:"hidden"}})})}),u.jsx(Rl,{onClick:l,buttonSize:9,iconSize:6,isIdle:ke,zIndex:Jf}),u.jsx("div",{className:`absolute inset-0 pointer-events-none transition-opacity duration-300 ${ke?"opacity-0":"opacity-100"}`,style:{zIndex:Jf},children:M&&u.jsxs(u.Fragment,{children:[u.jsx(V5,{index:s,total:o.length,displayName:Se}),u.jsx(G5,{isVideo:W,canLoadWorkflow:qe,showMetadataToggle:p,canToggleMetadata:Me,onDelete:Je,onLoadWorkflow:Ue,onUseInWorkflow:Xe,onToggleMetadata:Ve}),u.jsx(P5,{isVideo:W,showMetadataToggle:p,showMetadataOverlay:Q,metadataIsLoading:K,metadata:$,durationLabel:Z})]})})]}),document.body):null}function tp(n){const o=n;return o?(o.__activePointers||(o.__activePointers=new Map),o.__activePointers):new Map}function Z5(n){const o=n===void 0||Number.isNaN(n)?0:n;return o===0?"":o<10?`${o.toFixed(1)}s`:`${Math.round(o)}s`}function Nv(){const n=qn(o=>o.history);return b.useMemo(()=>{const o=new Map;for(const s of n)if(s.workflow)for(const a of s.outputs.images??[]){const l=a.subfolder?`${a.subfolder}/${a.filename}`:a.filename,c=`${a.type}/${l}`;o.has(c)||o.set(c,{workflow:s.workflow,promptId:s.prompt_id})}return o},[n])}function J5(n){const o=n.replace(/^\/+/,""),s=o.split("/").filter(Boolean);return s.length<=1?{filename:o,subfolder:""}:{filename:s.pop()??o,subfolder:s.join("/")}}async function ej(n,o){if(o==="input")return kr(n,o);const s=kr(n,o),{filename:a,subfolder:l}=J5(s),c=n.fullUrl||bo(a,l,o),d=await fetch(c);if(!d.ok)throw new Error("Failed to fetch image data.");const h=await d.blob(),p=a||n.name||"image.png",m=new File([h],p,{type:h.type||"image/png"}),y=await Fb(m,{type:"input",overwrite:!0}),x=y.subfolder?`${y.subfolder}/${y.name}`:y.name;if(!(await fetch(bo(y.name,y.subfolder??"","input"))).ok)throw new Error("Uploaded image was not found in inputs.");return x}function kv({open:n,file:o,source:s,onClose:a,onLoaded:l}){const c=de(T=>T.workflow),d=de(T=>T.nodeTypes),h=de(T=>T.setNodeTypes),p=de(T=>T.updateNodeWidget),m=gn(T=>T.clearNodeError),y=de(T=>T.scrollToNode),x=ao(T=>T.setCurrentPanel),[v,k]=b.useState(null),[w,S]=b.useState(null),j=b.useMemo(()=>c?c.nodes.filter(T=>/loadimage/i.test(T.type)).map(T=>({node:T,stableKey:T.stableKey??null})).filter(T=>T.stableKey!==null):[],[c]);b.useEffect(()=>{n||(k(null),S(null))},[n]);const C=async T=>{if(!(!o||!c)){S(T),k(null);try{const R=c.nodes.find(B=>B.stableKey===T);if(!R)throw new Error("Could not resolve selected node.");const D=Y5({workflow:c,nodeTypes:d,nodeId:R.id});if(!D)throw new Error("Selected node does not accept image inputs.");const L=await ej(o,s);if(s!=="input")try{const B=await _p();h(B)}catch(B){console.warn("Failed to refresh node types after upload:",B)}p(T,D.index,L,D.name),m(D.node.id),x("workflow"),l?.(),setTimeout(()=>{y(T,zb(D.node,d))},150)}catch(R){console.error("Failed to load image into node:",R),k(R instanceof Error?R.message:"Failed to load image.")}finally{S(null)}}};return!n||!o?null:u.jsx("div",{id:"outputs-load-node-overlay",className:"fixed inset-0 z-[2150] bg-black/50 flex items-center justify-center p-4",onClick:a,role:"dialog","aria-modal":"true",children:u.jsxs("div",{id:"outputs-load-node-modal",className:"w-full max-w-sm bg-white border border-gray-200 rounded-xl shadow-lg overflow-hidden",onClick:T=>T.stopPropagation(),children:[u.jsx("div",{className:"px-4 py-3 text-sm font-semibold text-gray-700 border-b border-gray-100",children:"Load image into node"}),u.jsx("div",{className:"px-4 pt-3 text-xs text-gray-500",children:o.name}),u.jsxs("div",{className:"max-h-[50vh] overflow-y-auto",children:[j.length===0&&u.jsx("div",{className:"px-4 py-3 text-sm text-gray-400",children:"No Load Image nodes found in the current workflow."}),j.map(({node:T,stableKey:R})=>{const D=zb(T,d),L=w===R;return u.jsxs("button",{className:"w-full text-left px-4 py-3 text-sm hover:bg-gray-50 flex items-center gap-2 disabled:opacity-60 disabled:cursor-not-allowed",onClick:()=>C(R),disabled:w!==null,children:[u.jsxs("span",{className:"text-gray-500 dark:text-gray-300",children:["#",T.id]}),u.jsx("span",{className:"flex-1 text-gray-900 dark:text-gray-100 truncate",children:D}),L&&u.jsx("span",{className:"text-xs text-gray-400",children:"Loading"})]},`load-node-${R}`)})]}),v&&u.jsx("div",{className:"px-4 py-2 text-xs text-red-600 border-t border-gray-100",children:v}),u.jsx("div",{className:"px-4 py-3 border-t border-gray-100 flex justify-end",children:u.jsx("button",{className:"px-3 py-2 text-sm font-medium text-gray-600 hover:bg-gray-100 rounded-lg disabled:opacity-60",onClick:a,disabled:w!==null,children:"Close"})})]})})}function tj({onClose:n}){const o=Eo(ue=>ue.viewerOpen),s=Eo(ue=>ue.viewerImages),a=Eo(ue=>ue.viewerIndex),l=Eo(ue=>ue.viewerScale),c=Eo(ue=>ue.viewerTranslate),d=de(ue=>ue.followQueue),h=Eo(ue=>ue.setViewerState),p=de(ue=>ue.workflow),m=de(ue=>ue.originalWorkflow),y=de(ue=>ue.workflowDurationStats),x=de(ue=>ue.isExecuting),v=de(ue=>ue.executingPromptId),k=ao(ue=>ue.setCurrentPanel),w=de(ue=>ue.loadWorkflow),S=Ht(ue=>ue.running),j=qn(ue=>ue.history),[C,T]=b.useState(null),[R,D]=b.useState(null),[L,B]=b.useState(null),[A,F]=b.useState(!1),te=b.useRef(null),ee=b.useMemo(()=>!!(p&&m&&JSON.stringify(p)!==JSON.stringify(m)),[p,m]),ae=b.useMemo(()=>!o||!d?null:j[0]?.prompt_id??null,[o,d,j]),ne=v||(S.length===1?S[0].prompt_id:null),me=Gl({workflow:p,runKey:ne,isRunning:x||S.length>0,workflowDurationStats:y}),Le=x||S.length>0,P=Math.min(100,Math.max(0,me??0)),H=!(a>=0?s[a]??s[0]??null:null)&&(d||Le)||a<0&&Le,ce=Nv();b.useEffect(()=>{if(!o||!d){te.current=null;return}!te.current&&j[0]?.prompt_id&&(te.current=j[0]?.prompt_id??null)},[o,d,j]),b.useEffect(()=>{if(!o||!d||j.length===0)return;const ue=j[0];if(te.current===ue.prompt_id||ue.outputs.images.length===0)return;const ye=ph(j,{alt:"Generation"});ye.length!==0&&(te.current=ue.prompt_id,h({viewerImages:ye,viewerIndex:0,viewerScale:1,viewerTranslate:{x:0,y:0}}))},[o,d,j,h]);const ke=ue=>{h({viewerIndex:ue})},Ne=(ue,ye)=>{h({viewerScale:ue,viewerTranslate:ye})},O=ue=>{ue.file&&T(ue.file)},_=async()=>{if(!C)return;const ue=C;try{const ye=kr(ue);await sp(ye,Os(ue));const et=s.filter(U=>U.file?.id!==ue.id),oe=s.findIndex(U=>U.file?.id===ue.id),z=et.length===0?0:oe<0?a:oe<a?a-1:oe===a?Math.min(a,et.length-1):a;h({viewerImages:et,viewerIndex:z}),et.length===0&&n()}catch(ye){console.error("Failed to delete file:",ye),window.alert("Failed to delete file.")}finally{T(null)}},q=ue=>{if(!(!ue.file&&!ue.workflow)){if(ee){D(ue);return}je(ue)}},je=async ue=>{try{const ye=vv(ue,ce);if(ye){w(ye.workflow,ye.filename,{source:ye.source}),n(),queueMicrotask(()=>k("workflow"));return}if(!ue.file)return;await wv({file:ue.file,loadWorkflow:w,onLoaded:()=>{n(),queueMicrotask(()=>k("workflow"))}})}catch(ye){console.error("Failed to load workflow from file:",ye),window.alert("Failed to load workflow from file.")}finally{D(null)}},Ke=ue=>{!ue.file||ue.file.type!=="image"||(B(ue.file),F(!0))},De=()=>{F(!1),B(null)},Fe=()=>{De(),n(),queueMicrotask(()=>k("workflow"))};return o?u.jsxs(u.Fragment,{children:[u.jsx(Sv,{open:o,items:s,index:a,onIndexChange:ke,onClose:n,onDelete:O,onLoadWorkflow:q,onLoadInWorkflow:Ke,showMetadataToggle:!0,showLoadingPlaceholder:H,loadingProgress:P,loadingLabel:Le?`${P}%`:"Waiting for output",initialScale:l,initialTranslate:c,onTransformChange:Ne,zoomResetKey:ae}),R&&An.createPortal(u.jsx(Qo,{onClose:()=>D(null),title:"Unsaved changes",description:"Are you sure you want to load this workflow? You have unsaved changes.",actions:[{label:"Cancel",onClick:()=>D(null),className:"px-3 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-100"},{label:"Continue",onClick:()=>{(async()=>(await je(R),D(null)))()},className:"px-3 py-2 rounded-lg text-sm font-medium text-white bg-red-600 hover:bg-red-700"}]}),document.body),u.jsx(kv,{open:A,file:L,source:L?Os(L):"output",onClose:De,onLoaded:Fe}),C&&An.createPortal(u.jsx(Qo,{onClose:()=>T(null),title:"Delete file?",description:`This will permanently delete "${C.name}" from the server. This cannot be undone.`,actions:[{label:"Cancel",onClick:()=>T(null),className:"px-3 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-100"},{label:"Delete",onClick:()=>{_()},className:"px-3 py-2 rounded-lg text-sm font-medium text-white bg-red-600 hover:bg-red-700"}]}),document.body)]}):null}function nj(n){const o=["text","string","strings","result","value","__value__","ui"],s=new Set(["images","image","videos","video","gifs","audio","filename","filenames","subfolder","type"]),a=(l,c,d)=>{if(c>5||l==null||d&&s.has(d))return null;if(typeof l=="string"){const h=l.trim();return h||null}if(Array.isArray(l)){for(const h of l){const p=a(h,c+1,d);if(p)return p}return null}if(typeof l=="object"){const h=l;for(const p of o){if(!(p in h))continue;const m=a(h[p],c+1,p);if(m)return m}}return null};return a(n,0)}function oj(){const[n,o]=b.useState(!1),s=b.useRef(null),a=b.useRef(null),l=b.useRef({}),c=b.useRef({setExecutionState:de.getState().setExecutionState,setNodeOutput:de.getState().setNodeOutput,setNodeTextOutput:de.getState().setNodeTextOutput,clearNodeOutputs:de.getState().clearNodeOutputs,addPromptOutputs:de.getState().addPromptOutputs,clearPromptOutputs:de.getState().clearPromptOutputs,applyControlAfterGenerate:de.getState().applyControlAfterGenerate,applyLoraCodeUpdate:yr.getState().applyLoraCodeUpdate,applyTriggerWordUpdate:yr.getState().applyTriggerWordUpdate,applyWidgetUpdate:yr.getState().applyWidgetUpdate,registerLoraManagerNodes:yr.getState().registerLoraManagerNodes,updateFromStatus:Ht.getState().updateFromStatus,fetchQueue:Ht.getState().fetchQueue,addHistoryEntry:qn.getState().addHistoryEntry,fetchHistory:qn.getState().fetchHistory});b.useEffect(()=>{c.current={setExecutionState:de.getState().setExecutionState,setNodeOutput:de.getState().setNodeOutput,setNodeTextOutput:de.getState().setNodeTextOutput,clearNodeOutputs:de.getState().clearNodeOutputs,addPromptOutputs:de.getState().addPromptOutputs,clearPromptOutputs:de.getState().clearPromptOutputs,applyControlAfterGenerate:de.getState().applyControlAfterGenerate,applyLoraCodeUpdate:yr.getState().applyLoraCodeUpdate,applyTriggerWordUpdate:yr.getState().applyTriggerWordUpdate,applyWidgetUpdate:yr.getState().applyWidgetUpdate,registerLoraManagerNodes:yr.getState().registerLoraManagerNodes,updateFromStatus:Ht.getState().updateFromStatus,fetchQueue:Ht.getState().fetchQueue,addHistoryEntry:qn.getState().addHistoryEntry,fetchHistory:qn.getState().fetchHistory}},[]);const d=b.useRef(null);return b.useEffect(()=>{const h=v=>{if(v==null)return null;const k=Number(v);if(!Number.isFinite(k))return null;const S=de.getState().workflow;if(!S)return null;let j=S.nodes.filter(T=>T.id===k);return j.length===0&&(j=S.nodes.filter(T=>{const R=T.properties?.__mobile_origin;if(!R||typeof R!="object")return!1;const D=R.nodeId;return Number(D)===k})),j.length===0?null:(j.find(T=>T.stableKey)??j[0])?.stableKey??null},p=v=>{if(v==null)return[];const k=Number(v);if(!Number.isFinite(k))return[];const S=de.getState().workflow;if(!S)return[];const j=new Set,C=S.nodes.filter(R=>R.id===k);C.forEach(R=>{R.stableKey&&j.add(R.stableKey)}),S.nodes.filter(R=>{const D=R.properties?.__mobile_origin;if(!D||typeof D!="object")return!1;const L=D.nodeId;return Number(L)===k}).forEach(R=>{R.stableKey&&j.add(R.stableKey)});for(const R of C){const D=R.properties?.__mobile_origin;if(!D||typeof D!="object")continue;const L=Number(D.nodeId);Number.isFinite(L)&&S.nodes.filter(B=>B.id===L).forEach(B=>{B.stableKey&&j.add(B.stableKey)})}return Array.from(j)},m=v=>{const{setExecutionState:k,setNodeOutput:w,setNodeTextOutput:S,addPromptOutputs:j,clearPromptOutputs:C,updateFromStatus:T,fetchQueue:R,addHistoryEntry:D,fetchHistory:L,applyLoraCodeUpdate:B,applyTriggerWordUpdate:A,applyWidgetUpdate:F,registerLoraManagerNodes:te}=c.current,ee=v;switch(ee.type){case"status":{const ne=ee.data.status.exec_info.queue_remaining;T(ne),ne===0&&k(!1,null,null,0);break}case"progress":{const ae=ee,{value:ne,max:me,node:Le,prompt_id:P}=ae.data,V=Math.round(ne/me*100);k(!0,h(Le),P||null,V);break}case"executing":{const ae=ee,ne=ae.data.node,me=ae.data.prompt_id;if(ne===null){if(k(!1,null,null,0),c.current.applyControlAfterGenerate(),me){const Le=Ht.getState().running.find(V=>V.prompt_id===me),P=l.current[me]||[];Le&&D({prompt_id:me,timestamp:Date.now(),outputs:{images:P},prompt:Le.prompt}),delete l.current[me],C(me)}R(),L()}else{me&&me!==d.current&&(d.current=me),k(!0,h(ne),me||null,0);const Le=Ht.getState();me&&!Le.running.some(P=>P.prompt_id===me)&&R()}break}case"executed":{const ae=ee,{node:ne,prompt_id:me,output:Le}=ae.data,P=h(ne),V=p(ne),H=Le.images;H&&(l.current[me]||(l.current[me]=[]),l.current[me].push(...H),j(me,H),(V.length>0?V:P?[P]:[]).forEach(Ne=>{w(Ne,H)}));const ce=nj(Le);ce&&V.length>0&&V.forEach(ke=>{S(ke,ce)});break}case"execution_error":{k(!1,null,null,0),C(),R(),L();break}case"execution_cached":break;case"lora_code_update":{B?.(ee.data);break}case"trigger_word_update":{A?.(ee.data);break}case"lm_widget_update":{F?.(ee.data);break}case"lora_registry_refresh":{te?.();break}}},y=()=>{s.current?.readyState!==WebSocket.OPEN&&(s.current=e2(Vb,m,async()=>{o(!0);const{fetchQueue:v,fetchHistory:k,setExecutionState:w}=c.current;await v(),k();const S=Ht.getState(),j=de.getState();if(S.running.length>0&&!j.executingPromptId){const C=S.running[0];w(!0,null,C.prompt_id,0)}},()=>{o(!1),a.current=setTimeout(y,2e3)},()=>{o(!1)}))};y();const x=setInterval(()=>{const{fetchQueue:v,fetchHistory:k}=c.current;Ht.getState().running.length>0&&(v(),k())},2e3);return()=>{a.current&&clearTimeout(a.current),s.current&&s.current.close(),clearInterval(x)}},[]),{isConnected:n}}function rj({onSwipeLeft:n,onSwipeRight:o,onSwipeUp:s,onSwipeDown:a,enabled:l=!0,threshold:c=50,preventScroll:d=!0,deferResetOnSwipe:h=!1,deferResetDurationMs:p=350}){const[m,y]=b.useState(0),[x,v]=b.useState(!1),[k,w]=b.useState(l),S=b.useRef(null),j=b.useRef(null);b.useEffect(()=>{w(l)},[l]);const C=b.useCallback(()=>{S.current=null,v(!1),y(0)},[]),T=b.useCallback(R=>{w(R)},[]);return b.useEffect(()=>{if(!k)return;const R=A=>{if(!(A instanceof HTMLElement))return!1;if(A.isContentEditable)return!0;const F=A.tagName.toLowerCase();return F==="input"||F==="textarea"||F==="select"},D=A=>{if(R(A.target)||R(document.activeElement))return;j.current!==null&&(window.clearTimeout(j.current),j.current=null);const F=A.touches[0];S.current={startX:F.clientX,startY:F.clientY,currentX:F.clientX,currentY:F.clientY,isHorizontal:null,isTracking:!0}},L=A=>{const F=S.current;if(!F?.isTracking)return;const te=A.touches[0],ee=te.clientX-F.startX,ae=te.clientY-F.startY;if(F.isHorizontal===null){if(Math.abs(ee)>20||Math.abs(ae)>20){const ne=Math.abs(ee)>Math.abs(ae);F.isHorizontal=ne,ne?(ee>0?!!o:!!n)?v(!0):F.isTracking=!1:(ae>0?a:s)||(F.isTracking=!1)}return}F.isHorizontal?(d&&A.cancelable&&A.preventDefault(),F.currentX=te.clientX,y(te.clientX-F.startX)):F.currentY=te.clientY},B=()=>{const A=S.current;if(!A?.isTracking){C();return}const F=A.currentX-A.startX,te=A.currentY-A.startY,ee=c||window.innerWidth*.25;let ae=!1;A.isHorizontal===!0?F<-ee&&n?(n(),ae=!0):F>ee&&o&&(o(),ae=!0):A.isHorizontal===!1&&(te<-ee&&s?(s(),ae=!0):te>ee&&a&&(a(),ae=!0)),ae?h?(S.current=null,v(!1),j.current!==null&&window.clearTimeout(j.current),j.current=window.setTimeout(()=>{C(),j.current=null},p)):requestAnimationFrame(()=>{C()}):C()};return document.addEventListener("touchstart",D,{passive:!0}),document.addEventListener("touchmove",L,{passive:!1}),document.addEventListener("touchend",B,{passive:!0}),document.addEventListener("touchcancel",B,{passive:!0}),()=>{document.removeEventListener("touchstart",D),document.removeEventListener("touchmove",L),document.removeEventListener("touchend",B),document.removeEventListener("touchcancel",B),j.current!==null&&(window.clearTimeout(j.current),j.current=null),C()}},[k,n,o,s,a,c,d,h,p,C]),{swipeOffset:m,isSwiping:x,setSwipeEnabled:T,resetSwipeState:C}}function Hb({idPrefix:n,title:o,items:s,selectedValue:a,onSelect:l,gridClassName:c="grid grid-cols-2 gap-2",buttonClassName:d=""}){return u.jsxs("div",{id:`${n}-container`,children:[u.jsx("h4",{id:`${n}-label`,className:"text-sm font-medium text-gray-700 mb-2",children:o}),u.jsx("div",{id:`${n}-options`,className:c,children:s.map(h=>{const p=a===h.value;return u.jsxs("button",{className:`px-3 py-2 rounded-lg text-sm border ${d} ${p?"bg-blue-500 border-blue-500 text-white shadow-sm":"border-gray-200 text-gray-700 hover:bg-gray-50"}`,onClick:()=>l(h.value),children:[h.label,p&&h.suffix?h.suffix:""]},h.value)})})]})}function sj({checked:n,onChange:o}){return u.jsxs("div",{id:"favorites-toggle-container",className:"flex items-center gap-2",children:[u.jsx("input",{type:"checkbox",id:"favOnly",checked:n,onChange:s=>o(s.target.checked),className:"rounded text-blue-600 focus:ring-blue-500"}),u.jsx("label",{htmlFor:"favOnly",className:"text-sm text-gray-700",children:"Show Favorites Only"})]})}function aj({open:n,onClose:o,filter:s,sort:a,onChangeFilter:l,onChangeSort:c}){if(!n)return null;const d=a?.mode||"modified",h=d.includes("name")?"name":d.includes("size")?"size":"date",p=(()=>{const y=d.endsWith("reverse");return h==="date"?y?"asc":"desc":y?"desc":"asc"})(),m=(y,x)=>{let v;y==="name"?v=x==="asc"?"name":"name-reverse":y==="size"?v=x==="asc"?"size":"size-reverse":v=x==="desc"?"modified":"modified-reverse",c({mode:v})};return u.jsx("div",{id:"filter-modal-root",className:"fixed inset-0 z-[1600] bg-black/50 flex items-center justify-center p-4",onClick:o,children:u.jsxs("div",{id:"filter-modal-content",className:"bg-white rounded-xl shadow-lg w-full max-w-sm max-h-[90vh] overflow-y-auto",onClick:y=>y.stopPropagation(),children:[u.jsxs("div",{id:"filter-modal-header",className:"p-4 border-b border-gray-100 flex items-center justify-between",children:[u.jsx("h3",{id:"filter-modal-title",className:"font-semibold text-gray-900",children:"Filter & Sort"}),u.jsx(Rl,{variant:"plain",onClick:o,buttonSize:8,iconSize:6})]}),u.jsxs("div",{id:"filter-modal-body",className:"p-4 space-y-6",children:[u.jsx(Hb,{idPrefix:"sort-group",title:"Sort By",items:[{value:"name",label:"Name",suffix:h==="name"?p==="asc"?" ":" ":void 0},{value:"date",label:"Date",suffix:h==="date"?p==="asc"?" ":" ":void 0},{value:"size",label:"Size",suffix:h==="size"?p==="asc"?" ":" ":void 0}],selectedValue:h,onSelect:y=>{m(y,h===y?p==="asc"?"desc":"asc":y==="name"?"asc":"desc")}}),u.jsx(Hb,{idPrefix:"filter-type-group",title:"File Type",items:[{value:"all",label:"All"},{value:"image",label:"Image"},{value:"video",label:"Video"}],selectedValue:s.type,onSelect:y=>l({type:y}),gridClassName:"flex gap-2",buttonClassName:"flex-1"}),u.jsxs("div",{id:"search-input-container",children:[u.jsx("label",{id:"search-input-label",className:"block text-sm font-medium text-gray-700 mb-1",children:"Search"}),u.jsx(ql,{placeholder:"Search by filename...",value:s.search,onChange:y=>l({search:y})})]}),u.jsx(sj,{checked:s.favoritesOnly,onChange:y=>l({favoritesOnly:y})})]}),u.jsx("div",{id:"filter-modal-footer",className:"p-4 border-t border-gray-100 bg-gray-50 flex justify-end",children:u.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700",onClick:o,children:"Apply"})})]})})}function Ou({onClose:n,zIndex:o=2200,children:s}){return u.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4",style:{zIndex:o},onClick:n,role:"dialog","aria-modal":"true",children:u.jsx("div",{className:"w-full max-w-sm bg-white border border-gray-200 rounded-xl shadow-lg overflow-hidden",onClick:a=>a.stopPropagation(),children:s})})}function lj({breadcrumbs:n,selectionMode:o,selectedCount:s,onClearSelection:a}){return u.jsx("div",{id:"outputs-panel-header",className:"px-4 py-3 flex flex-col gap-3 border-b border-gray-100",children:u.jsxs("div",{id:"outputs-header-top-row",className:"flex items-center justify-between min-h-[24px]",children:[n,o&&u.jsxs("div",{className:"selection-status-container flex items-center gap-2 shrink-0 ml-2",children:[u.jsxs("span",{className:"text-[10px] font-bold text-blue-600 uppercase",children:[s," selected"]}),u.jsx("button",{onClick:a,className:"text-[10px] text-gray-500 underline uppercase font-bold",children:"Clear"})]})]})})}function Ip({file:n,viewMode:o,selectionMode:s,isSelected:a,isFavorited:l,onNavigateFolder:c,onOpen:d,onMenu:h,onToggleSelection:p}){const m=n.type==="folder",[y,x]=b.useState(!1);b.useEffect(()=>{x(!1)},[n.previewUrl,n.id]);const v=()=>{s?p(n.id):m?c(n.name):d(n)},k=w=>{w.stopPropagation(),h(n,w)};return o==="list"?u.jsxs("div",{className:`file-card-list-item flex items-center gap-3 p-2 hover:bg-gray-50 border-b border-gray-100 last:border-0 ${a?"bg-blue-50":""}`,onClick:v,children:[s&&u.jsx("div",{className:`selection-checkbox w-5 h-5 rounded border flex items-center justify-center flex-shrink-0 ${a?"bg-blue-600 border-blue-600 text-white":"border-gray-300 bg-white"}`,children:a&&u.jsx(zo,{className:"w-3.5 h-3.5"})}),u.jsx("div",{className:`file-preview-container w-10 h-10 flex-shrink-0 flex items-center justify-center rounded text-gray-500 overflow-hidden relative ${m?"":"bg-gray-100"}`,children:m?u.jsx(xr,{className:"w-6 h-6 text-amber-500"}):n.previewUrl&&!y?u.jsx("img",{src:n.previewUrl,className:"w-full h-full object-cover",loading:"lazy",onError:()=>x(!0)}):n.type==="video"?u.jsx(Iy,{className:"w-5 h-5 text-gray-500"}):u.jsx("span",{className:"text-xs font-bold",children:"IMG"})}),u.jsx("div",{className:"file-info-container flex-1 min-w-0",children:u.jsx("div",{className:"file-name text-sm font-medium text-gray-900 truncate",children:n.name})}),u.jsxs("div",{className:"file-actions-container flex items-center gap-2",children:[l&&u.jsx(ts,{className:"w-4 h-4 text-yellow-500"}),u.jsx(ns,{onClick:k,ariaLabel:"File options",buttonSize:8,iconSize:5})]})]}):u.jsxs("div",{className:"file-card-grid-item flex flex-col gap-1",children:[u.jsxs("div",{className:`relative aspect-square bg-gray-100 rounded-lg overflow-hidden transition-all ${a?"ring-4 ring-blue-500 ring-offset-2":""}`,onClick:v,children:[m?u.jsx("div",{className:"folder-grid-content w-full h-full flex flex-col items-center justify-center text-gray-500",children:u.jsx(xr,{className:"w-12 h-12 mb-2 text-amber-500"})}):n.previewUrl&&!y?u.jsx("img",{src:n.previewUrl,className:"w-full h-full object-cover",loading:"lazy",onError:()=>x(!0)}):u.jsx("div",{className:"media-placeholder w-full h-full flex items-center justify-center bg-gray-800 text-white font-bold",children:n.type==="video"?u.jsx(Iy,{className:"w-10 h-10 text-white/80"}):"IMG"}),s?u.jsx("div",{className:"selection-badge-container absolute top-2 left-2",children:u.jsx("div",{className:`selection-badge w-6 h-6 rounded-full border-2 flex items-center justify-center shadow-sm ${a?"bg-blue-600 border-blue-600 text-white":"border-white bg-black/20"}`,children:a&&u.jsx(zo,{className:"w-4 h-4"})})}):u.jsxs("div",{className:"file-menu-trigger-container absolute top-1 right-1 flex flex-col items-center gap-1 text-white",children:[u.jsx(ns,{onClick:k,ariaLabel:"File options",buttonSize:7,iconSize:4}),l&&u.jsx(ts,{className:"w-4 h-4 text-yellow-400 drop-shadow"})]}),n.type==="video"&&u.jsx("div",{className:"video-label absolute top-1 left-1 bg-black/50 px-1 rounded text-[10px] text-white",children:"VID"})]}),u.jsx("div",{className:"file-name text-xs text-gray-700 truncate px-1",children:n.name})]})}function ij({folders:n,foldersCollapsed:o,toggleFoldersCollapsed:s,selectionMode:a,selectedIds:l,favorites:c,setCurrentFolder:d,handleOpen:h,handleMenu:p,toggleSelection:m}){return n.length===0?null:u.jsxs("div",{id:"outputs-folders-section",className:"mb-4",children:[u.jsxs("button",{onClick:s,className:"flex items-center gap-2 w-full text-left mb-2 py-1 text-sm font-medium text-gray-600 hover:text-gray-900",children:[o?u.jsx(Qp,{className:"w-4 h-4"}):u.jsx(Qu,{className:"w-4 h-4"}),u.jsxs("span",{children:["Folders (",n.length,")"]})]}),!o&&u.jsx("div",{className:"flex flex-col border border-gray-200 rounded-lg overflow-hidden",children:n.map(y=>u.jsx(Ip,{file:y,viewMode:"list",selectionMode:a,isSelected:l.includes(y.id),isFavorited:c.includes(y.id),onNavigateFolder:d,onOpen:h,onMenu:p,onToggleSelection:m},y.id))})]})}function uj({fileSections:n,collapsedSections:o,viewMode:s,selectionMode:a,selectedIds:l,favorites:c,setCurrentFolder:d,handleOpen:h,handleMenu:p,toggleSelection:m,toggleSectionCollapsed:y,selectIds:x}){return u.jsx("div",{id:"outputs-files-section",className:"flex flex-col gap-4",children:n.map(v=>u.jsxs("div",{className:"flex flex-col gap-2",children:[u.jsxs("div",{className:"flex items-center justify-between gap-3",children:[u.jsxs("button",{className:"flex items-center gap-2 text-[11px] font-semibold uppercase tracking-wide text-gray-500 hover:text-gray-800",onClick:()=>y(v.key),children:[o[v.key]?u.jsx(Qp,{className:"w-3.5 h-3.5"}):u.jsx(Qu,{className:"w-3.5 h-3.5"}),u.jsxs("span",{children:[v.label," (",v.files.length,")"]})]}),a&&u.jsx("button",{className:"text-[10px] font-bold uppercase text-blue-600 hover:text-blue-700",onClick:()=>x(v.files.map(k=>k.id)),children:"Select all"})]}),!o[v.key]&&(s==="grid"?u.jsx("div",{className:"grid grid-cols-2 gap-4 auto-rows-min",children:v.files.map(k=>u.jsx(Ip,{file:k,viewMode:s,selectionMode:a,isSelected:l.includes(k.id),isFavorited:c.includes(k.id),onNavigateFolder:d,onOpen:h,onMenu:p,onToggleSelection:m},k.id))}):u.jsx("div",{className:"flex flex-col",children:v.files.map(k=>u.jsx(Ip,{file:k,viewMode:s,selectionMode:a,isSelected:l.includes(k.id),isFavorited:c.includes(k.id),onNavigateFolder:d,onOpen:h,onMenu:p,onToggleSelection:m},k.id))}))]},v.key))})}function cj({menuTarget:n,favorites:o,setMenuTarget:s,menuRef:a,menuStyle:l,handleFavorite:c,handleSelectSingle:d,handleMoveSingle:h,handleRenameRequest:p,handleLoadWorkflow:m,handleLoadInWorkflow:y,handleDeleteRequest:x}){if(!n)return null;const v=[{key:"favorite",label:o.includes(n.file.id)?"Unfavorite":"Favorite",icon:o.includes(n.file.id)?u.jsx(ts,{className:"w-4 h-4"}):u.jsx(fc,{className:"w-4 h-4"}),onClick:()=>c()},{key:"select",label:"Select",icon:u.jsx(zo,{className:"w-4 h-4"}),onClick:()=>d()},{key:"move",label:"Move",icon:u.jsx(xr,{className:"w-4 h-4"}),onClick:()=>h()},{key:"rename",label:"Rename",icon:u.jsx(Gp,{className:"w-4 h-4"}),onClick:()=>p()},{key:"load-workflow",label:"Load workflow",icon:u.jsx(Ts,{className:"w-4 h-4"}),onClick:()=>m(),hidden:n.file.type!=="image"},{key:"use-in-workflow",label:"Use in workflow",icon:u.jsx(ix,{className:"w-4 h-4"}),onClick:()=>y(),hidden:n.file.type!=="image"},{key:"delete",label:"Delete",icon:u.jsx(Ho,{className:"w-4 h-4"}),onClick:()=>x(),color:"danger"}];return u.jsxs(u.Fragment,{children:[u.jsx("div",{id:"outputs-context-menu-overlay",className:"fixed inset-0 z-[1690]",onClick:()=>s(null),onPointerDown:k=>k.stopPropagation()}),u.jsx("div",{id:"outputs-context-menu",ref:a,className:"fixed z-[1700] min-w-44 w-max",style:l,onPointerDown:k=>k.stopPropagation(),onClick:k=>k.stopPropagation(),children:u.jsx(Sr,{items:v})})]})}const $b="outputs-folders-collapsed",dj=1440*60*1e3;function fj(n){if(!n)return"Unknown date";const o=new Date,s=new Date(o.getFullYear(),o.getMonth(),o.getDate()),a=new Date(n),l=new Date(a.getFullYear(),a.getMonth(),a.getDate()),c=Math.round((s.getTime()-l.getTime())/dj);return c===0?"Today":c===1?"Yesterday":a.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})}function pj({visible:n}){const{source:o,currentFolder:s,isLoading:a,viewMode:l,showHidden:c,filter:d,sort:h,favorites:p,selectionMode:m,selectedIds:y,setCurrentFolder:x,navigateToPath:v,fetchFolders:k,fetchFiles:w,toggleFavorite:S,toggleSelection:j,getDisplayedFiles:C,refresh:T,selectIds:R,toggleSelectionMode:D,setFilter:L,setSort:B}=Jt(),A=Jt(Ee=>Ee.selectionActionOpen),F=Jt(Ee=>Ee.setSelectionActionOpen),te=Jt(Ee=>Ee.filterModalOpen),ee=Jt(Ee=>Ee.setFilterModalOpen),ae=Jt(Ee=>Ee.newFolderModalOpen),ne=Jt(Ee=>Ee.setNewFolderModalOpen),me=Jt(Ee=>Ee.setOutputsViewerOpen),Le=Jt(Ee=>Ee.addFavorites),P=Jt(Ee=>Ee.removeFavorites),V=Jt(Ee=>Ee.clearSelection),H=de(Ee=>Ee.loadWorkflow),ce=ao(Ee=>Ee.setCurrentPanel),ke=de(Ee=>Ee.workflow),Ne=de(Ee=>Ee.originalWorkflow),O=b.useMemo(()=>!!(ke&&Ne&&JSON.stringify(ke)!==JSON.stringify(Ne)),[ke,Ne]),[_,q]=b.useState(null),[je,Ke]=b.useState(null),[De,Fe]=b.useState(null),[ue,ye]=b.useState(null),[et,oe]=b.useState(!1),[z,U]=b.useState(null),[se,fe]=b.useState(""),[M,re]=b.useState(!1),[W,G]=b.useState(!1),[I,$]=b.useState(null),[Z,Se]=b.useState([]),[Q,Me]=b.useState(!1),[K,Te]=b.useState(""),[_e,qe]=b.useState([]),[Ge,Ve]=b.useState(null),[Je,Ue]=b.useState(""),[Xe,Pe]=b.useState(!1),[he,Qe]=b.useState([]),[ut,it]=b.useState(0),_t=b.useRef(null),Ot=b.useRef(null),wt=b.useRef(!1),[It,Kt]=b.useState(()=>localStorage.getItem($b)==="true"),[pt,Lt]=b.useState({}),Gt=b.useRef(null),xe=b.useRef(null),J=b.useRef(!1),be=()=>{Ke(null),Gt.current=null},Ie=()=>{oe(!1),Fe(null),xe.current=null},Be=(Ee,rt)=>{Gt.current=rt?.onDeleted??null,Ke(Ee)},We=(Ee,rt)=>{Ee.type==="image"&&(xe.current=rt?.onLoaded??null,Fe(Ee),oe(!0))},{menuStyle:Oe,resetMenuPosition:lt}=Zp({open:!!_,buttonRef:Ot,menuRef:_t,repositionToken:_?.file.id,menuWidth:176,horizontalAnchorOffset:160,viewportPadding:8,bottomBarReserve:104});Na({open:!!_,onDismiss:()=>{q(null),lt()},triggerRef:Ot,contentRef:_t}),b.useEffect(()=>{wt.current=!1},[o]),b.useEffect(()=>{n&&!wt.current&&!a&&(wt.current=!0,k(),w())},[n,k,w,a]),b.useEffect(()=>{!n&&Xe&&(Pe(!1),me(!1))},[n,Xe,me]),b.useEffect(()=>{!n&&te&&ee(!1)},[n,te,ee]);const st=C(),at=Jt(Ee=>Ee.sort.mode),ct=Nv(),dt=Ee=>{const vt=C().filter(Bt=>(Bt.type==="image"||Bt.type==="video")&&Bt.fullUrl),yn=vt.map(Bt=>{const er=ct.get(Bt.id);return{src:Bt.fullUrl,alt:Bt.name,mediaType:Pl(Bt.name),workflow:er?.workflow,promptId:er?.promptId,file:Bt,filename:Bt.name}}),Sn=vt.findIndex(Bt=>Bt.id===Ee.id);Sn>=0&&(Qe(yn),it(Sn),Pe(!0),me(!0))},nt=()=>{Pe(!1),me(!1)},bt=Ee=>{Ee.file&&Be(Ee.file,{onDeleted:rt=>{Qe(vt=>{const yn=vt.findIndex(Bt=>Bt.file?.id===rt.id),Sn=vt.filter(Bt=>Bt.file?.id!==rt.id);return it(Bt=>Sn.length===0?0:yn===-1?Bt:yn<Bt?Bt-1:yn===Bt?Math.min(Bt,Sn.length-1):Bt),Sn.length===0&&(Pe(!1),me(!1)),Sn})}})},gt=Ee=>{!Ee.file||Ee.file.type!=="image"||We(Ee.file,{onLoaded:()=>{Pe(!1),me(!1)}})},kt=Ee=>{const rt=vv(Ee,ct);if(rt){H(rt.workflow,rt.filename,{source:rt.source}),ce("workflow"),Pe(!1),me(!1);return}Ee.file&&Rt(Ee.file,{closeViewer:!0})},{folders:Qt,nonFolders:en}=b.useMemo(()=>{const Ee=[],rt=[];for(const vt of st)vt.type==="folder"?Ee.push(vt):rt.push(vt);return{folders:Ee,nonFolders:rt}},[st]),Yt=at.startsWith("name"),Y=at.startsWith("size"),Re=d.favoritesOnly||!Yt&&!Y,ie=b.useMemo(()=>{if(Yt){const rt=[];for(const vt of en){const yn=vt.name?.trim()?.charAt(0).toUpperCase()||"#",Sn=`Starting with ${yn}`,Bt=rt[rt.length-1];Bt&&Bt.key===yn?Bt.files.push(vt):rt.push({key:yn,label:Sn,files:[vt]})}return rt}if(Y){const rt=[];for(const vt of en){const Sn=(vt.size??0)/(1024*1024),Bt=Sn<1?0:Math.round(Sn),er=Bt===0?"<1MB":`${Bt}MB`,Ma=Bt===0?"<1MB":`${Bt}MB`,$o=rt[rt.length-1];$o&&$o.key===er?$o.files.push(vt):rt.push({key:er,label:Ma,files:[vt]})}return rt}if(!Re)return[{key:"all",label:"All files",files:en}];const Ee=[];for(const rt of en){const vt=rt.date?new Date(rt.date).toISOString().slice(0,10):"unknown",yn=fj(rt.date),Sn=Ee[Ee.length-1];Sn&&Sn.key===vt?Sn.files.push(rt):Ee.push({key:vt,label:yn,files:[rt]})}return Ee},[en,Re,Yt,Y]),ot=()=>{const Ee=!It;Kt(Ee),localStorage.setItem($b,String(Ee))},tt=Ee=>{Lt(rt=>({...rt,[Ee]:!rt[Ee]}))},Ze=Ee=>{dt(Ee)},Ye=(Ee,rt)=>{rt.preventDefault(),rt.stopPropagation(),Ot.current=rt.currentTarget,q({file:Ee})},Ct=()=>{_&&(S(_.file.id),q(null))},mt=()=>{_&&(m||D(),R([_.file.id],"replace"),q(null))},Tt=()=>{_&&_.file.type==="image"&&(Fe(_.file),oe(!0),q(null))},pe=()=>{_&&(Ke(_.file),q(null))},xt=()=>{_&&(U(_.file),fe(_.file.name),q(null))},yt=()=>{y.length!==0&&(F(!1),re(!0))},Vt=async(Ee,rt)=>{try{await wv({file:Ee,source:o,loadWorkflow:H,onLoaded:()=>{ce("workflow"),rt?.closeViewer&&(Pe(!1),me(!1))}})}catch(vt){console.error("Failed to load workflow from file:",vt),window.alert("Failed to load workflow from file.")}},Rt=(Ee,rt)=>{if(Ee.type==="folder"){window.alert("Workflow metadata is not available for folders.");return}if(O){J.current=!!rt?.closeViewer,ye(Ee);return}Vt(Ee,rt)},cn=()=>{if(!_)return;const Ee=_.file;q(null),Rt(Ee,{closeViewer:!1})},wn=async()=>{if(!ue)return;const Ee=ue,rt=J.current;J.current=!1,ye(null),await Vt(Ee,{closeViewer:rt})},jn=()=>{J.current=!1,ye(null)},Ql=async()=>{if(!je)return;const Ee=je;try{const rt=kr(je,o);await sp(rt,o),T(),Gt.current?.(Ee),Gt.current=null}catch(rt){console.error("Failed to delete file:",rt),window.alert("Failed to delete file.")}finally{Ke(null)}},xc=async()=>{if(y.length===0){re(!1);return}try{const Ee=`${o}/`,rt=y.map(vt=>vt.startsWith(Ee)?vt.slice(Ee.length):vt);await Promise.all(rt.map(vt=>sp(vt,o))),T(),V()}catch(Ee){console.error("Failed to delete selected files:",Ee),window.alert("Failed to delete selected files.")}finally{re(!1)}},Ca=()=>{if(y.length===0)return;y.every(rt=>p.includes(rt))?P(y):Le(y),F(!1)},Xl=()=>{y.length!==0&&(F(!1),qe([...y]),Ve(s),$(s),G(!0))},Es=()=>{_&&(qe([_.file.id]),Ve(s),$(s),G(!0),q(null))},Is=()=>{U(null),fe("")},Gn=async()=>{if(!z)return;const Ee=se.trim();if(Ee){if(Ee===z.name){Is();return}try{const rt=kr(z,o);await a2(rt,Ee,o),T(),Is()}catch(rt){console.error("Failed to rename item:",rt),window.alert("Failed to rename item.")}}},os=()=>{G(!1),qe([]),Ve(null)},Zl=async()=>{if(_e.length!==0)try{const Ee=`${o}/`,rt=_e.map(vt=>vt.startsWith(Ee)?vt.slice(Ee.length):vt);await s2(rt,I,o),T(),m&&(V(),D())}catch(Ee){console.error("Failed to move selected files:",Ee),window.alert("Failed to move selected files.")}finally{os()}},ja=async()=>{const Ee=K.trim();if(!Ee)return;const rt=I?`${I}/${Ee}`:Ee;try{await ay(rt,o),Te(""),Me(!0);const vt=await rp(o,1e3,0,"modified",!1,I,c);Se(vt.filter(yn=>yn.type==="folder"))}catch(vt){console.error("Failed to create folder:",vt),window.alert("Failed to create folder.")}finally{Me(!1)}},Zo=async()=>{const Ee=Je.trim();if(!Ee)return;const rt=s?`${s}/${Ee}`:Ee;try{await ay(rt,o),Ue(""),ne(!1),T()}catch(vt){console.error("Failed to create folder:",vt),window.alert("Failed to create folder.")}},Jo=b.useMemo(()=>{const rt=[{name:o==="output"?"Outputs":"Inputs",path:null}];if(s){const vt=s.split("/");vt.forEach((yn,Sn)=>{rt.push({name:yn,path:vt.slice(0,Sn+1).join("/")})})}return rt},[o,s]),Jl=()=>{const Ee=Jo.length,rt=[];return Ee<=3?Jo.forEach((vt,yn)=>{rt.push({...vt,isClickable:yn<Ee-1})}):(rt.push({...Jo[0],isClickable:!0}),rt.push({name:"...",path:Jo[Ee-3].path,isEllipsis:!0,isClickable:!0}),rt.push({...Jo[Ee-2],isClickable:!0}),rt.push({...Jo[Ee-1],isClickable:!1})),u.jsx("div",{id:"outputs-breadcrumb-trail",className:"flex items-center text-sm overflow-hidden whitespace-nowrap",children:rt.map((vt,yn)=>u.jsxs("div",{className:"flex items-center min-w-0",children:[yn>0&&u.jsx("span",{className:"mx-1.5 text-gray-400 shrink-0",children:"/"}),u.jsx("button",{onClick:()=>vt.isClickable&&v(vt.path),disabled:!vt.isClickable,className:`
                truncate transition-colors
                ${vt.isClickable?"text-blue-600 hover:text-blue-700 active:opacity-70":"text-gray-700 font-medium"}
                ${vt.isEllipsis?"px-1 bg-gray-100 rounded":""}
              `,title:vt.name,children:vt.name})]},yn))})};b.useEffect(()=>{if(!W)return;let Ee=!1;return(async()=>{Me(!0);try{const vt=await rp(o,1e3,0,"modified",!1,I,c);if(Ee)return;Se(vt.filter(yn=>yn.type==="folder"))}catch(vt){if(Ee)return;console.error("Failed to load folders:",vt),Se([])}finally{Ee||Me(!1)}})(),()=>{Ee=!0}},[W,I,o,c]),b.useEffect(()=>{A&&y.length===0&&F(!1)},[A,y.length,F]);const Or=()=>{const Ee=Jt.getState();Ee.clearSelection(),Ee.toggleSelectionMode()},vc=()=>{if(!I)return;const Ee=I.split("/");Ee.pop(),$(Ee.length?Ee.join("/"):null)},ei=Ee=>()=>{$(I?`${I}/${Ee}`:Ee)};return u.jsx("div",{id:"outputs-panel-wrapper",className:"absolute inset-x-0 top-[60px] bottom-0",style:{display:n?"block":"none"},children:u.jsxs("div",{id:"outputs-panel-root",className:"h-full bg-white flex flex-col pt-[4px] pb-[80px]",children:[u.jsx(lj,{breadcrumbs:Jl(),selectionMode:m,selectedCount:y.length,onClearSelection:Or}),u.jsxs("div",{id:"outputs-content-container",className:"flex-1 overflow-y-auto p-4",children:[u.jsx(ij,{folders:Qt,foldersCollapsed:It,toggleFoldersCollapsed:ot,selectionMode:m,selectedIds:y,favorites:p,setCurrentFolder:x,handleOpen:Ze,handleMenu:Ye,toggleSelection:j}),u.jsx(uj,{fileSections:ie,collapsedSections:pt,viewMode:l,selectionMode:m,selectedIds:y,favorites:p,setCurrentFolder:x,handleOpen:Ze,handleMenu:Ye,toggleSelection:j,toggleSectionCollapsed:tt,selectIds:R}),a&&u.jsx("div",{id:"outputs-loading-indicator",className:"py-4 flex justify-center",children:u.jsx("span",{className:"text-gray-400 text-sm",children:"Loading..."})}),!a&&st.length===0&&u.jsx("div",{id:"outputs-empty-message",className:"text-center text-gray-400 py-8",children:s?"No images in this folder":o==="output"?"No generated images yet":"No imported images"})]}),u.jsx(cj,{menuTarget:_,favorites:p,setMenuTarget:q,menuRef:_t,menuStyle:Oe,handleFavorite:Ct,handleSelectSingle:mt,handleMoveSingle:Es,handleRenameRequest:xt,handleLoadWorkflow:cn,handleLoadInWorkflow:Tt,handleDeleteRequest:pe}),A&&u.jsxs(Ou,{onClose:()=>F(!1),zIndex:1800,children:[u.jsxs("div",{className:"px-4 py-3 text-sm font-semibold text-gray-700 border-b border-gray-100",children:[y.length," selected"]}),u.jsxs("button",{className:"w-full text-left px-4 py-3 text-sm hover:bg-gray-50 flex items-center gap-2",onClick:Ca,children:[y.every(Ee=>p.includes(Ee))?u.jsx(fc,{className:"w-4 h-4"}):u.jsx(ts,{className:"w-4 h-4"}),y.every(Ee=>p.includes(Ee))?"Unfavorite":"Favorite"]}),u.jsxs("button",{className:"w-full text-left px-4 py-3 text-sm hover:bg-gray-50 flex items-center gap-2",onClick:Xl,children:[u.jsx(xr,{className:"w-4 h-4 text-gray-500"}),"Move"]}),u.jsxs("button",{className:"w-full text-left px-4 py-3 text-sm text-red-600 hover:bg-red-50 flex items-center gap-2",onClick:yt,children:[u.jsx(Ho,{className:"w-4 h-4"}),"Delete"]}),u.jsx("button",{className:"w-full text-left px-4 py-3 text-sm text-gray-600 hover:bg-gray-50",onClick:()=>F(!1),children:"Cancel"})]}),W&&u.jsxs(Ou,{onClose:os,zIndex:1850,children:[u.jsx("div",{className:"px-4 py-3 text-sm font-semibold text-gray-700 border-b border-gray-100",children:I!==Ge?u.jsxs(u.Fragment,{children:["Move to ",u.jsx(xr,{className:"w-4 h-4 text-amber-500 inline"})," ",I||"root"]}):"Move to..."}),u.jsxs("div",{className:"max-h-[50vh] overflow-y-auto",children:[Q&&u.jsx("div",{className:"px-4 py-3 text-sm text-gray-400",children:"Loading folders..."}),!Q&&I&&u.jsx("button",{className:"w-full text-left px-4 py-3 text-sm hover:bg-gray-50 flex items-center gap-2",onClick:vc,children:u.jsx("span",{className:"text-gray-500",children:".."})}),!Q&&Z.filter(Ee=>!_e.includes(Ee.id)).length===0&&u.jsx("div",{className:"px-4 py-3 text-sm text-gray-400",children:"No folders"}),!Q&&Z.filter(Ee=>!_e.includes(Ee.id)).map(Ee=>u.jsxs("button",{className:"w-full text-left px-4 py-3 text-sm hover:bg-gray-50 flex items-center gap-2",onClick:ei(Ee.name),children:[u.jsx(xr,{className:"w-4 h-4 text-amber-500"}),Ee.name]},Ee.id)),u.jsx("div",{className:"px-4 py-3 border-t border-gray-100",children:u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("input",{value:K,onChange:Ee=>Te(Ee.target.value),placeholder:"New folder",className:"flex-1 border border-gray-200 rounded-lg px-3 py-2 text-sm"}),u.jsx("button",{className:"px-3 py-2 text-sm font-medium text-blue-600 hover:text-blue-700",onClick:ja,children:"Create"})]})})]}),u.jsxs("div",{className:"px-4 py-3 border-t border-gray-100 flex justify-end gap-2",children:[u.jsx("button",{className:"px-3 py-2 text-sm font-medium text-gray-600 hover:bg-gray-100 rounded-lg",onClick:os,children:"Cancel"}),u.jsx("button",{className:`px-3 py-2 text-sm font-medium rounded-lg ${I!==Ge?"text-white bg-blue-600 hover:bg-blue-700":"text-gray-400 bg-gray-200 cursor-not-allowed"}`,onClick:Zl,disabled:I===Ge,children:"Submit"})]})]}),je&&u.jsx(Qo,{onClose:be,title:"Delete file?",description:je.type==="folder"?`This will permanently delete the folder "${je.name}" and all of its contents from the server. This cannot be undone.`:`This will permanently delete "${je.name}" from the server. This cannot be undone.`,actions:[{label:"Cancel",onClick:be,className:"px-3 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-100"},{label:"Delete",onClick:Ql,className:"px-3 py-2 rounded-lg text-sm font-medium text-white bg-red-600 hover:bg-red-700"}]}),M&&u.jsx(Qo,{onClose:()=>re(!1),title:"Delete selected files?",description:`This will permanently delete ${y.length} selected file${y.length===1?"":"s"} from the server. This cannot be undone.`,zIndex:1800,actions:[{label:"Cancel",onClick:()=>re(!1),className:"px-3 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-100"},{label:"Delete",onClick:xc,className:"px-3 py-2 rounded-lg text-sm font-medium text-white bg-red-600 hover:bg-red-700"}]}),z&&u.jsx(Ou,{onClose:Is,zIndex:1850,children:u.jsxs("div",{className:"p-4",children:[u.jsxs("div",{className:"text-gray-900 text-base font-semibold",children:["Rename ",z.type==="folder"?"folder":"file"]}),u.jsxs("div",{className:"text-gray-600 text-sm mt-1 truncate",children:["Current: ",z.name]}),u.jsx("input",{value:se,onChange:Ee=>fe(Ee.target.value),onKeyDown:Ee=>{Ee.key==="Enter"&&Gn()},placeholder:z.type==="folder"?"Folder name":"File name",className:"mt-3 w-full border border-gray-200 rounded-lg px-3 py-2 text-sm",autoFocus:!0}),u.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[u.jsx("button",{className:"px-3 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-100",onClick:Is,children:"Cancel"}),u.jsx("button",{className:`px-3 py-2 rounded-lg text-sm font-medium ${se.trim()&&se.trim()!==z.name?"text-white bg-blue-600 hover:bg-blue-700":"text-gray-400 bg-gray-200 cursor-not-allowed"}`,onClick:()=>{Gn()},disabled:!se.trim()||se.trim()===z.name,children:"Rename"})]})]})}),ae&&u.jsx(Ou,{onClose:()=>{ne(!1),Ue("")},zIndex:1850,children:u.jsxs("div",{className:"p-4",children:[u.jsx("div",{className:"text-gray-900 text-base font-semibold",children:"New folder"}),u.jsxs("div",{className:"text-gray-600 text-sm mt-1",children:["Create a new folder in ",s?u.jsxs(u.Fragment,{children:[u.jsx(xr,{className:"w-3.5 h-3.5 text-amber-500 inline"})," ",s]}):"root"]}),u.jsx("input",{value:Je,onChange:Ee=>Ue(Ee.target.value),onKeyDown:Ee=>{Ee.key==="Enter"&&Zo()},placeholder:"Folder name",className:"mt-3 w-full border border-gray-200 rounded-lg px-3 py-2 text-sm",autoFocus:!0}),u.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[u.jsx("button",{className:"px-3 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-100",onClick:()=>{ne(!1),Ue("")},children:"Cancel"}),u.jsx("button",{className:`px-3 py-2 rounded-lg text-sm font-medium ${Je.trim()?"text-white bg-blue-600 hover:bg-blue-700":"text-gray-400 bg-gray-200 cursor-not-allowed"}`,onClick:Zo,disabled:!Je.trim(),children:"Create"})]})]})}),u.jsx(kv,{open:et,file:De,source:o,onClose:Ie,onLoaded:()=>{oe(!1),Fe(null),xe.current?.(),xe.current=null}}),u.jsx(aj,{open:te,onClose:()=>ee(!1),filter:d,sort:h,onChangeFilter:L,onChangeSort:B}),ue&&An.createPortal(u.jsx(Qo,{onClose:jn,title:"Unsaved changes",description:"Are you sure you want to load this workflow? You have unsaved changes.",actions:[{label:"Cancel",onClick:jn,className:"px-3 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-100"},{label:"Continue",onClick:()=>{wn()},className:"px-3 py-2 rounded-lg text-sm font-medium text-white bg-red-600 hover:bg-red-700"}]}),document.body),u.jsx(Sv,{open:Xe,items:he,index:ut,onClose:nt,onIndexChange:it,onDelete:bt,onLoadInWorkflow:gt,onLoadWorkflow:kt,showMetadataToggle:!0})]})})}function hj(){const n=ao(H=>H.currentPanel),o=ao(H=>H.setCurrentPanel),s=fp(H=>H.appMenuOpen),a=Eo(H=>H.viewerOpen),l=Eo(H=>H.setViewerState),c=de(H=>H.followQueue),d=de(H=>H.setFollowQueue),h=Xn(H=>H.bookmarkRepositioningActive),p=b.useRef(null),{isInputFocused:m}=bv(),y=Jt(H=>H.outputsViewerOpen),x=Jt(H=>H.selectionMode),v=Jt(H=>H.filterModalOpen),k=Jt(H=>H.selectionActionOpen),w=Jt(H=>H.currentFolder),S=Jt(H=>H.navigateUp);oj();const j=b.useCallback(()=>{n==="workflow"?o("queue"):n==="outputs"&&o("workflow")},[n,o]),C=b.useCallback(()=>{n==="outputs"&&w?S():n==="workflow"?o("outputs"):n==="queue"&&o("workflow")},[n,w,S,o]),T=n==="workflow"||n==="outputs",R=n==="workflow"||n==="queue"||n==="outputs"&&!!w,{swipeOffset:D,isSwiping:L,setSwipeEnabled:B,resetSwipeState:A}=rj({onSwipeLeft:T?j:void 0,onSwipeRight:R?C:void 0,enabled:!m&&!a&&!s&&!y&&!h&&!x&&!v&&!k}),F=de(H=>H.setNodeTypes),te=de(H=>H.ensureStableKeysAndRepair),ee=wa(H=>H.theme),ae=de(H=>H.workflowLoadedAt),ne=Ht(H=>H.fetchQueue),me=qn(H=>H.history);b.useEffect(()=>{!L&&D!==0&&A()},[L,D,A]),b.useEffect(()=>{y&&A()},[y,A]);const Le=()=>{l({viewerOpen:!1}),d(!1),B(!0),A()};b.useEffect(()=>{_p().then(H=>{F(H)}).catch(H=>{console.error("Failed to load node types:",H)})},[F]),b.useEffect(()=>{ne()},[ne]);const P=(H,ce,ke=!0)=>{B(!1),A(),l({viewerImages:H,viewerIndex:ce,viewerScale:1,viewerTranslate:{x:0,y:0},viewerOpen:!0}),d(ke)},V=()=>{const H=ph(me,{alt:"Generation"});B(!1),A();const ce=H.length>0?0:-1;l({viewerImages:H,viewerIndex:ce,viewerScale:1,viewerTranslate:{x:0,y:0},viewerOpen:!0}),d(!0)};return b.useLayoutEffect(()=>{const H=document.documentElement;H.classList.toggle("dark",ee==="dark"),H.style.colorScheme=ee},[ee]),b.useEffect(()=>{ae&&queueMicrotask(()=>{d(!1)})},[ae,d]),b.useEffect(()=>{ae&&te()},[ae,te]),u.jsxs("div",{id:"app-root",className:"min-h-screen bg-gray-100",children:[u.jsx(NN,{mode:n}),u.jsxs("main",{id:"main-content",ref:p,className:"pt-[69px] pb-[80px] min-h-screen relative",children:[u.jsxs(u.Fragment,{children:[u.jsx(pj,{visible:n==="outputs"}),u.jsx(i5,{visible:n==="workflow",onImageClick:P}),u.jsx(R5,{visible:n==="queue",onImageClick:P})]}),u.jsx("div",{id:"bottom-bar-spacer",className:"fixed inset-x-0 bottom-0 bg-gray-100 pointer-events-none z-[1500]",style:{height:"var(--bottom-bar-offset, 80px)"}})]}),u.jsx(b5,{currentPanel:n,viewerOpen:a,followQueue:c,onToggleFollowQueue:()=>d(!c),onOpenFollowQueue:V}),u.jsx(tj,{onClose:Le})]})}Bw.createRoot(document.getElementById("root")).render(u.jsx(b.StrictMode,{children:u.jsx(hj,{})}));
//# sourceMappingURL=index-BDCuI_P4.js.map
